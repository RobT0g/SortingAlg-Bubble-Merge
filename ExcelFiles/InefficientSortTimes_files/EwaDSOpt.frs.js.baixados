/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[15],{1162:function(t,C,a){a.d(C,"a",function(){return c});const c=()=>{Type.registerNamespace("Common.App.InsertFile")}},1163:function(t,C,a){a.d(C,"a",function(){return c});const c=()=>{Type.registerNamespace("Common.App.InsertPicture")}},1164:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);C=a(965);var c=a(32);class b extends C.a{constructor(f=null,e=null){super(c.a.xc(f,"_"),e)}}Object(t.a)(b,"EwaCCPError",
C.a,[])},1165:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}")}},
1167:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1168:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1182:function(t,C,a){var c=a(0),b=a(2),f=a(14),e=a(228),d=a(34),h=a(29),r=a(361),l=a(181),u=a(364),v=a(6),x=a(25),w=a(1),m=a(40),n=a(9),z=a(295),y=a(15);class A extends z.a{constructor(Da){super(Da);this.f$g=()=>{f.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};f.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");this.Xb=0;this.yc(1,y.a.instance.ha(2260));Da=y.a.instance.ha(2258);const Cb=this.bN();this.initializeAndShow(Da,
this.f$g,Cb)}get uc(){return"ClipboardReadPermissionAskDialog"}bN(){const Da={};Da.id=this.uc;const Cb=y.a.instance.ha(2259);Da.DialogMessage=Cb;return Da}}Object(c.a)(A,"ClipboardReadPermissionAskDialog",z.a,[]);var F=a(55);const D=(Da,Cb,Zb,yc,Vc)=>{const jd=Da.Stopwatch,ld={};ld.a=Vc;ld.e=jd.id;ld.c="RearrangeRowColumn";ld.b="mouse";ld.d=Da.OperationId.toString();ld.f=Zb.toString();ld.g=yc.toString();ld.h=Cb.toString();ld.i=Da.DragDropIsShiftKeyDown;ld.j=!0;ld.o=jd.Jc;ld.q=!1;ld.r=Da.CopyPasteTargetType.toString();
ld.s=Da.EncounteredDeploymentErrors;return ld};class B{constructor(Da,Cb){this.yQh=()=>{const Zb={};Zb.SourceItem=this.toString();return Zb};this.sessionStateId=Da;this.sessionId=Cb;this.toJSON=this.yQh}plf(Da){return Da?this.sessionStateId===Da.sessionStateId&&this.sessionId===Da.sessionId:!1}isFromCurrentSession(Da){return this.sessionId===Da.xa.UserSessionId}}Object(c.a)(B,"SourceItem",null,[]);class M extends B{constructor(Da,Cb,Zb,yc,Vc){super(Zb,yc);this.activeFloatingObjectControlId=Da;this.sheetName=
Cb;this.type=Vc}isEqual(Da){return Da&&Object.getType(Da)===M?this.plf(Da)&&this.activeFloatingObjectControlId===Da.activeFloatingObjectControlId&&this.sheetName===Da.sheetName:!1}toString(){return this.type.toString()}}Object(c.a)(M,"ArtSourceItem",B,[]);var R;(function(Da){Da[Da.valid=0]="valid";Da[Da.notPairwiseDisjoint=1]="notPairwiseDisjoint";Da[Da.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";Da[Da.notValidForm=3]="notValidForm";Da[Da.temporarilyBlockedCopy=
4]="temporarilyBlockedCopy"})(R||(R={}));Object(c.b)("CopySourceValidationOptions",R);var P=a(45);class E extends B{constructor(Da,Cb,Zb,yc,Vc){super(yc,Vc);f.ULS.shipAssertTag(537167645,0,!!Cb&&0<Cb.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=Da;this.ranges=Cb;this.sheetName=Zb}isEqual(Da){return Da&&Object.getType(Da)===E?this.plf(Da)&&P.R(this.ranges,Da.ranges)&&this.sheetName===Da.sheetName:!1}toString(){return P.i(this.ranges,",",this.$,!1)}}Object(c.a)(E,"RangeSourceItem",
B,[]);const H=Da=>!!Da&&Object.getType(Da)===E;class G{}G.X9j="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(c.a)(G,"ExpectedErrorNames",null,[]);class N{}N.plainText="text/plain";N.html="text/html";N.png="image/png";N.shadowWorkbook="data/shadow-workbook";N.jwi="metadata/is-last-copy-was-external";N.ssi="metadata/is-last-copy-was-external-XLO-source";N.G8g="metadata/chrome-extension-id";N.Mtb="copyId";N.PTg="metadata/additional-signature-data-attributes";Object(c.a)(N,"ClipboardDataFormat",
null,[]);const I=Da=>Da.clipboardItems&&(Da=Da.clipboardItems.getItem(N.jwi))&&"1"===Da?!0:!1,O=Da=>I(Da)&&!(void 0===Da.clipboardItems||null===Da.clipboardItems)&&!!Da.clipboardItems.getItem(N.png)&&!Da.clipboardItems.getItem(N.plainText),U=Da=>Da.clipboardItems&&(Da=Da.clipboardItems.getItem(N.ssi))&&"1"===Da?!0:!1,ca=Da=>Da&&(Da=Da.getCachedMetadata(),null===Da||void 0===Da?0:Da.lastCopy)?Da.lastCopy:null;var Q=a(52),Y=a(21),la=a(36);class ea{constructor(Da,Cb,Zb,yc){this.$=Da;this.originalDestinations=
Cb;this.ybc=Zb;this.Awg=yc;this.EGg=this.originalDestinations;this.wAg=this.ybc;this.YDg="PasteRecoveryUI"}get OTg(){return this.Awg}get ftf(){return this.YDg}get okj(){return this.EGg}get $Ye(){return this.wAg}zwa(){return ea.n$i}AYh(){return this.ybc&&1===this.ybc.length?this.BYh(this.ybc[0]):null}Bid(){return"PasteRecoveryUI-Floatie"}BYh(Da){var Cb=Y.h(this.$);const Zb=Cb.lb.yi(Da);var yc=Cb.Mg(Da,Zb);Cb=Cb.rtl;if(!yc)return null;Da=Y.h(this.$).hg(Zb);const Vc=Da.Nm;if(!Vc.xd(yc))return null;yc=
Vc.ze(yc);const jd=yc.topLeft.y;var ld=yc.bottomRight.y;const Bd=Cb?yc.bottomRight.x:yc.topLeft.x;yc=Cb?yc.topLeft.x:yc.bottomRight.x;var Td=new Q.a(yc+(Cb?-81:81),ld+38+6);if(Vc.fja(Td))return this.k6a(Da,Vc,Zb,yc,ld,Cb?12:-3,66);Td=new Q.a(yc+(Cb?-81:81),ld);if(Vc.fja(Td))return this.k6a(Da,Vc,Zb,yc,ld,Cb?20:3,22);Td=new Q.a(yc,ld+38+6);if(Vc.fja(Td))return this.k6a(Da,Vc,Zb,yc,ld,-81+(Cb?18:0),66);yc=new Q.a(Bd+(Cb?81:-81),ld);if(Vc.fja(yc))return this.k6a(Da,Vc,Zb,Bd,ld,-81+(Cb?12:-6),22);ld=
new Q.a(Bd,jd-38-6);return Vc.fja(ld)?this.k6a(Da,Vc,Zb,Bd,jd,Cb?15:0,16):this.k6a(Da,Vc,Zb,Cb?Vc.topLeft.x:Vc.bottomRight.x,Vc.bottomRight.y,-81+(Cb?15:-6),22)}k6a(Da,Cb,Zb,yc,Vc,jd,ld){var Bd=Y.h(this.$);const Td=Bd.rtl;Da=Sys.UI.DomElement.getLocation(Da.domElement);yc=new Sys.UI.Point(yc+(Td?0:Da.x)-Cb.topLeft.x,Vc+Da.y-Cb.topLeft.y);Td&&(Bd=Bd.view.visibleArea,yc.x=Bd.bottomRight.x-Bd.topLeft.x-yc.x,2===Zb||4===Zb)&&(yc.x+=Cb.bottomRight.x);yc=la.a(this.$).gla(yc);return new Sys.UI.Point(yc.x+
jd,yc.y+ld)}}ea.n$i=["PasteRecoveryUI"];Object(c.a)(ea,"PasteRecoveryUI",null,[706]);var ha=a(80),X=a(277);class T{}T.GLg="ActiveSelection";T.shadowWorkbook="ShadowWorkbook";T.Dtg="GVML";T.plainText="PlainText";T.html="Html";T.g_g="Bitmap";Object(c.a)(T,"PayloadType",null,[]);class ua{}ua.LRj="Slice6";Object(c.a)(ua,"SliceName",null,[]);class Ha{}Ha.fRi="NotCalled";Ha.success="Success";Ha.failed="Failed";Object(c.a)(Ha,"SucceededPopulatingSystemClipboardOptions",null,[]);var Ca=a(345);const Ga=(Da,
Cb)=>Da?Cb&&Cb.xa?Da.sessionId!==Cb.xa.UserSessionId:(f.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(f.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),sa=Da=>{switch(Da){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},bb=Da=>{if(!Da)return"null";const Cb=[];for(const Zb of Da.get())Cb.push(`${Zb.clipboardDataFormat}(${Zb.data.length})`);Cb.sort();return Cb.join(",")};var Ba;(function(Da){Da[Da.valid=0]="valid";Da[Da.destinationRangesIsEmpty=
1]="destinationRangesIsEmpty";Da[Da.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";Da[Da.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";Da[Da.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";Da[Da.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";Da[Da.sourceAndDestinationAreOverlapping=
6]="sourceAndDestinationAreOverlapping";Da[Da.copySourceNotValid=7]="copySourceNotValid";Da[Da.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";Da[Da.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";Da[Da.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";Da[Da.unknown=100]="unknown"})(Ba||(Ba={}));Object(c.b)("PasteValidationOptions",Ba);var qa=a(53),pa=a(155),ya=a(39),za=a(167),cb=a(355),Pa=a(32),nb=a(248),Ma=a(12),Oa=a(23),
La=a(136),ra=a(121),V=a(575),ma=a(105),W=a(60),aa=a(109),ia=a(73),ka=a(353);class Xa extends Sys.EventArgs{constructor(Da,Cb,Zb){super();this.command=Da;this.destinationRange=Cb;this.sourceRange=Zb}}Object(c.a)(Xa,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var sb=a(130),ib=a(70),Ub=a(157),hc=a(41);class yb extends ea{constructor(Da,Cb,Zb,yc){super(Da,Cb,Zb,yc);this.UEi="DragRecoveryUI"}get ftf(){return this.UEi}zwa(){return yb.Qth}Bid(){return"DragRecoveryUI-Floatie"}}yb.Qth=["DragRecoveryUI"];
Object(c.a)(yb,"DragFillRecoveryUI",ea,[]);var Gb;(function(Da){Da[Da.source=0]="source";Da[Da.destination=1]="destination"})(Gb||(Gb={}));Object(c.b)("RangeType",Gb);class Sa extends m.a{constructor(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td=null){super();this.pasteShortcutManager=null;this.okf=w.EwaSettings.zb();this.lya=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7694407_CopyPasteWFEIncreasedLimits");this.iig=null;this.s9a=!1;this.Jvd=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6660890_Tag_aoi75RetryLoggingFix2");
this.eya=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7205979_DemoteDragDropNonEmptyRangeLogLevel");this.TFd=Jd=>{this.YKj(Jd)&&(this.Gn.khc(),f.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};this.OJi=(Jd,ce)=>{f.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${Jd}]. userPressedExtensionLink=${ce}`);
this.gridView.focus()};this.yd=(Jd,ce)=>{ce.zN||ce.Sf||this.Cr("OnWorkbookOpened",!1).catch(()=>{})};this.Fj=(Jd,ce)=>{Jd=ca(this.UK);const ie=this.Gn.p6a(Jd);ie&&(ce.na&&ce.na.sheetName===ie.sheetName&&ie.isFromCurrentSession(this.$)?this.Gn.Bff(ie.ranges,Jd.commandParameters.commandType):this.Gn.khc())};this.Mrc=(Jd,ce)=>{Jd=ca(this.UK);(Jd=this.Gn.p6a(Jd))&&ce.item&&ce.item.sheetName===Jd.sheetName&&Jd.isFromCurrentSession(this.$)&&this.Cr("OnItemDeleting",!1).catch(()=>{})};this.qAa=(Jd,ce)=>
{this.okf?this.iig(Jd,ce):this.DMf()};this.WR=(Jd,ce)=>{1===ce.er&&ce.Of.operation.flags&2&&this.Cr("OnQueueItemChanged/ItemRemoved",!1).catch(()=>{})};this.$=Da;this.eg=Zb;this.gridView=Y.h(Da);this.Gn=Vc;this.soi=jd;this.UK=Cb;this.Otb=yc;this.getStringifiedError=Td||copyPasteInfra.getStringifiedError;this.Jbg=1===Bd;this.Mi();this.copyPasteShortcutDialogFactory=this.$.da.Aa(85);f.ULS.shipAssertTag(537167825,0,!!this.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");
ld||(f.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),ld=Sa.Moh);this.userHash=d.a.Au(ld);this.WNi="CultureTag: "+y.a.instance.m9b+" HASH: ";this.UK.addMetadataChangeListener(Sa.hzf,this.TFd);this.KMi=X.a.eGb;this.Aza=this.lya?w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.xa.CopyPasteMaxPayloadLength):n.a.Aza;(this.ko=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7568646_PressEnterToPaste"))&&Da.da.kb(478,
Jd=>{this.pasteShortcutManager=Jd});this.okf&&(this.iig=nb.b(()=>{this.DMf()},1,this.$.ka,"CopyPasteInfrastructure.OnStartEditInternal",!0))}Ead(){var Da=ca(this.UK);return Da?(Da=Da.sourceItem)&&!Da.isFromCurrentSession(this.$)?(f.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1}get pasteIndicationManager(){return this.$.da.Aa(373)}iSg(Da){this.addHandler(Sa.QGd,Da)}Kqj(Da){this.removeHandler(Sa.QGd,
Da)}copy(Da){Da.stopwatch=this.$.Rb.Qc("UserAction",F.b().Sj(Da.ribbonCommandInfo.command)+"ClientSide");if(this.ko){const jd=qa.GetServiceTaskFactory.Sa(this.$.da,478,479,0);ya.TaskExtensions.za(jd,()=>{this.pasteShortcutManager=jd.result},this.ka,3)}const Cb=!!ca(this.UK);w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.vB&&(this.s9a=!1);this.Cr("Copy/before/"+r.a[Da.ribbonCommandInfo.method],!1,void 0,!0,Da.copyPasteTargetType).catch(()=>{});var Zb=
-1985798686===Da.ribbonCommandInfo.command;if(1===this.gridView.Se&&(Zb=this.Gn.Ekf(this.gridView.ga.qa.selectedRanges,Zb),0!==Zb)){const jd=Sa.Ldh(Zb);this.HAa(jd,R[Zb],!1);return Promise.reject(!1)}Da.userHash=this.userHash;Da.id=l.a.create().toString();let yc=this,Vc=this;return this.Otb.onCopy(Da).then(jd=>{jd.isAsyncCopy||Da.stopwatch.stop();yc.pasteIndicationManager.FQe();const ld=Ca.d(Da);f.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${ld}`);
yc.FHi(jd,Cb);jd=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6591921_CheckTargetTypeForEnterToPaste")?1===Da.copyPasteTargetType:!0;!Da.isFormatPainter&&yc.ko&&jd&&(yc.pasteShortcutManager?yc.pasteShortcutManager.mwh():f.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},jd=>{let ld=!1,Bd="none",Td=Sa.Wub,Jd=!0,ce=-1,ie=Sa.copyErrorName+Sa.SKa,we=!1,zc=null;if(jd){zc=jd.copyContext;ce=jd.reason;ie+=Sa.hMa(jd);jd.message&&(Td=jd.message);var Sc=Sa.Kdh(jd);
if(Sc)if(3===Sc.copyErrorName)ld=!0,Td=Bd="Async Copy canceled by the user.",Jd=!1;else if(Pa.a.Jq(Sc.ewaErrors))if(Td=Vc.rec(Sc.ewaErrors),Pa.a.fh(Sc.ewaErrors,Sa.operationSucceededWithAlert))we=ld=!0;else if(Pa.a.fh(Sc.ewaErrors,Sa.pasteDataLimitHit)||Pa.a.fh(Sc.ewaErrors,Sa.copyThrottlingError))ld=!0;13===jd.reason?(ld=!0,Jd=!1):11===jd.reason&&(Jd=!1)}Sc=jd?Vc.getStringifiedError(jd):"null";ld?(Sc=Ca.d(Da),f.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${Jd}, Friendly message: ${Bd}, Error Message: ${Td}, CommandParameters: ${Sc}`)):
f.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${Jd}, Error Message: ${Sc}, CommandParameters: ${Ca.d(Da)}`);Jd&&Vc.Cr("Copy/fail/"+r.a[Da.ribbonCommandInfo.method],!0,void 0,void 0,Da.copyPasteTargetType).catch(()=>{});Vc.EHi(Da,ld,Td,ie,ce,we,zc);return Promise.reject(jd)})}E$i(Da){if(this.Ead())return aa.a(this.Bic(Da.commandType,Da.ribbonCommandInfo));let Cb;Cb=P.d(this.gridView.ga.qa.selectedRanges);Da.originalDestinations=
Cb;Da.expandDestinations=this.M4b(Da.originalDestinations,Da.commandType);if(this.W4b(Da.commandType,Da.expandDestinations)||this.CCe())Da.userHash=this.userHash,Da.id=l.a.create().toString(),this.Otb.onPaste(Da).then(()=>Promise.resolve(!0),Zb=>Promise.reject(Zb));return Promise.resolve(!0)}eGf(Da){const Cb=new yb(this.$,P.d(this.gridView.ga.qa.selectedRanges),P.d(this.gridView.ga.qa.selectedRanges),null),Zb=qa.GetServiceTaskFactory.Sa(this.$.da,406,405,0);ya.TaskExtensions.za(Zb,()=>{const yc=Zb.result;
yc.Pze(Cb);yc.jdg(Da.method)},this.ka,8)}paste(Da){Da.stopwatch=this.$.Rb.Qc("UserAction",F.b().Sj(Da.ribbonCommandInfo.command)+"ClientSide");w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.vB&&(f.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.s9a=!1,Da.clipboardPicklingApiDataFormatsToRead=[N.shadowWorkbook]);Y.h(this.$).nh&&Y.h(this.$).nh.v1(this.vkd(Da.ribbonCommandInfo.command),
Da.stopwatch.id);if(Da.isPasteCommandFromRecoveryUI){var Cb=this.$.da.Aa(406);var Zb=P.d(Cb.lxd);Cb=Cb.axd;Da.pasteRecoveryCachedClipboardItems=Cb?Cb[Sa.LPf]:null}else Zb=P.d(this.gridView.ga.qa.selectedRanges);Da.originalDestinations=Zb;Da.expandDestinations=this.M4b(Da.originalDestinations,Da.commandType);if(this.W4b(Da.commandType,Da.expandDestinations)||this.CCe())return Da.userHash=this.userHash,Da.id=l.a.create().toString(),w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",
!1)&&!h.a.vB&&(Da.clipboardReadPermissionPromptShown=!1,Da.clipboardAsyncApiDataFormatsToRead=[N.plainText+"Async"],this.Otb.shouldShowClipboardReadPermissionDialog().then(yc=>{yc&&(Da.clipboardReadPermissionPromptShown=!0,new A(this.$));return Promise.resolve(!0)},()=>Promise.resolve(!0))),this.Otb.onPaste(Da).then(yc=>this.qsc(yc,Da),yc=>this.oIb(Da,yc));this.$.Xc(927125067,ha.a.Eb,30,null);Zb=P.i(Da.expandDestinations,",",this.$,!1);f.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${Zb}, CommandType: ${Da.commandType}, copyPasteTargetType="${Da.copyPasteTargetType}"`);
return Promise.resolve(!0)}vkd(Da){switch(Da){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;default:return 3}}CCe(){return!!Y.h(this.$).ga.Ra.activeFloatingObjectControlId&&this.$.wt(null,!1,470)}j$a(){const Da=ca(this.UK);return Da&&Da.commandParameters?Da.commandParameters.copyPasteTargetType:0}iwi(){return!!ca(this.UK)&&Ga(ca(this.UK),this.$)}Cr(Da,Cb,Zb=!1,yc=!1,Vc=0){try{this.ko&&this.pasteShortcutManager&&this.pasteShortcutManager.T9b();let jd=Vc;const ld=this.PDi();
if(!yc&&2===ld)return f.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${Cb}', isExplicit = '${Zb}', isForce = '${yc}', Current CCP operation copyPasteTargetType = '${Vc}', LastCopyPasteTargetType = '${ld}'`),Promise.reject(null);0===jd&&(jd=ld);const Bd=this.$.Rb.Qc("UserAction","ClearCopyState"),Td=Bd.id;f.ULS.sendTraceTag(537167820,0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${Cb}', isExplicit = '${Zb}', isForce = '${yc}', Current CCP operation copyPasteTargetType = '${Vc}', LastCopyPasteTargetType = '${ld}'`);
this.Gn.khc();this.uhj();return this.Otb.onCancelCopy(Cb).then(()=>{Cb&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.vB&&(this.s9a=!1);Bd.stop();this.Juf(Da,Td,!0,Zb,Cb,"","",Bd.Jc,jd);return Promise.resolve(!0)},Jd=>{var ce=Jd?this.getStringifiedError(Jd):"null";f.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${ce}`);Bd.stop();ce=Sa.S5g+Sa.SKa;let ie=Sa.Wub;Jd&&
(ce+=Sa.hMa(Jd),Jd.message&&(ie=Jd.message));this.Juf(Da,Td,!1,Zb,Cb,ie,ce,Bd.Jc,jd);return Promise.reject(Jd)})}catch(jd){return Promise.reject(null)}}k5c(Da,Cb,Zb=!1,yc=!1,Vc=0){return yc||this.Ead()?this.Cr(Da,Cb,Zb,yc,Vc):(f.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}HAa(Da,Cb,Zb){f.ULS.sendTraceTag(590705172,0,50,
`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${Cb}`);const yc=new ma.a;yc.ia("reason",Cb);V.a(La.a.discontinuousSelectionBlocking,[Zb?ra.a.g$i:ra.a.Feh],!0,!0,!1,!1,yc);Da=Pa.a.nd(1,1,751,Da,0,371863010,"DiscontinuousSelectionBlocking");w.EwaSettings.By()?new cb.a(this.$,Da):(Da=new za.ErrorDialog(this.$,Da),Da.initialize(),Da.qg())}PDi(){const Da=ca(this.UK);return Da&&Da.sourceItem?Object.getType(Da.sourceItem)===M?2:1:0}dragDropCells(Da,
Cb,Zb,yc,Vc=!1){Da.stopwatch=this.$.Rb.Qc("UserAction","DragDropClientSide");Da.isDragDrop=!0;this.Cr("DragDrop/before/"+r.a[Da.ribbonCommandInfo.method],!1,void 0,void 0,Da.copyPasteTargetType).catch(()=>{});const jd=Vc?2:1;let ld=0;ld=Vc?4:yc?256:128;const Bd={encounteredDeploymentErrors:!1};Bd.commandParameters=Da;Da.userHash=this.userHash;Da.id=l.a.create().toString();return this.Jvd?this.Gn.pasteRange(Da.ribbonCommandInfo,P.q(Cb,this.$),P.q(Zb,this.$),jd,ld,[Da.stopwatch],Bd,!1,()=>{f.ULS.sendTraceTag(537167818,
0,50,`CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="${Da.copyPasteTargetType}"`);this.B$a(Da,jd,Cb,Zb,Bd)},Td=>{const Jd=Td?this.getStringifiedError(Td):"null";this.eya||f.ULS.sendTraceTag(537167817,0,10,`CopyPasteInfrastructure.DragDropCells: ${Jd}, copyPasteTargetType="${Da.copyPasteTargetType}"`);this.Xab(Td,Da,jd,Cb,Zb,Bd)}).then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},Td=>Promise.reject(Td)):this.Gn.pasteRange(Da.ribbonCommandInfo,P.q(Cb,this.$),
P.q(Zb,this.$),jd,ld,[Da.stopwatch],Bd,!1,null,null).then(()=>{f.ULS.sendTraceTag(521410075,0,50,`CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="${Da.copyPasteTargetType}"`);this.gridView.ga.selectionType=-1;this.B$a(Da,jd,Cb,Zb,Bd);return Promise.resolve(!0)},Td=>{const Jd=Td?this.getStringifiedError(Td):"null";this.eya||f.ULS.sendTraceTag(521410074,0,10,`CopyPasteInfrastructure.DragDropCells: ${Jd}, copyPasteTargetType="${Da.copyPasteTargetType}"`);this.Xab(Td,Da,jd,Cb,Zb,
Bd);return Promise.reject(Td)})}Pth(Da,Cb,Zb,yc,Vc=!1){Da.stopwatch=this.$.Rb.Qc("UserAction","DragDropReplaceClientSide");Da.isDragDrop=!0;this.k5c("DragDropReplace/before/"+r.a[Da.ribbonCommandInfo.method],!1,void 0,void 0,Da.copyPasteTargetType).catch(()=>{});const jd=Vc?2:1;let ld=0;ld=Vc?4:yc?256:128;const Bd={encounteredDeploymentErrors:!1};Bd.commandParameters=Da;w.EwaSettings.getBooleanFeatureGate(X.a.C$b,!1)&&(Da.isDragInsert=!1);Da.userHash=this.userHash;Da.id=l.a.create().toString();return this.Jvd?
this.Gn.pasteRange(Da.ribbonCommandInfo,P.q(Cb,this.$),P.q(Zb,this.$),jd,ld,[Da.stopwatch],Bd,!1,()=>{f.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${Da.copyPasteTargetType}"`);this.B$a(Da,jd,Cb,Zb,Bd)},Td=>{const Jd=Td?this.getStringifiedError(Td):"null";this.eya||f.ULS.sendTraceTag(537167815,0,10,`CopyPasteInfrastructure.DragDropReplaceCells: ${Jd}, copyPasteTargetType="${Da.copyPasteTargetType}"`);return this.Xab(Td,Da,jd,Cb,Zb,Bd)}).then(()=>
{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},Td=>Promise.reject(Td)):this.Gn.pasteRange(Da.ribbonCommandInfo,P.q(Cb,this.$),P.q(Zb,this.$),jd,ld,[Da.stopwatch],Bd,!1,null,null).then(()=>{f.ULS.sendTraceTag(521410073,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${Da.copyPasteTargetType}"`);this.gridView.ga.selectionType=-1;this.B$a(Da,jd,Cb,Zb,Bd);return Promise.resolve(!0)},Td=>{const Jd=Td?this.getStringifiedError(Td):"null";this.eya||f.ULS.sendTraceTag(521410072,
0,10,`CopyPasteInfrastructure.DragDropReplaceCells: ${Jd}, copyPasteTargetType="${Da.copyPasteTargetType}"`);this.Xab(Td,Da,jd,Cb,Zb,Bd);return Promise.reject(Td)})}Oth(Da,Cb,Zb,yc,Vc=!1){Da.stopwatch=this.$.Rb.Qc("UserAction","DragDropInsertClientSide");this.k5c("DragDropInsert/before/"+r.a[Da.ribbonCommandInfo.method],!1,void 0,void 0,Da.copyPasteTargetType).catch(()=>{});const jd=Vc?2:1,ld=P.L(this.M4b([Zb],jd));var Bd=this.$.ea.na.sheetName;const Td=this.$.ea.na.sheetName,Jd=P.v(Cb,this.$);Jd.SheetName=
Bd;Bd=P.v(ld,this.$);Bd.SheetName=Td;yc=ld.isRow||Cb.isRow||yc?1:0;const ce={encounteredDeploymentErrors:!1};Da.isDragInsert=!0;ce.commandParameters=Da;Da.userHash=this.userHash;Da.id=l.a.create().toString();if(this.Jvd)return Vc=this.Gn.OQe(ce,Jd,Bd,Vc,yc,Da.ribbonCommandInfo,()=>{f.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${Da.copyPasteTargetType}"`);this.B$a(Da,jd,Cb,Zb,ce)},we=>{const zc=we?this.getStringifiedError(we):"null";
this.eya||f.ULS.sendTraceTag(537167813,0,10,`CopyPasteInfrastructure.DragDropInsertCells: ${zc}, copyPasteTargetType="${Da.copyPasteTargetType}"`);this.Xab(we,Da,jd,Cb,Zb,ce)}),aa.d(Vc.then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},we=>Promise.reject(we))).Fo(()=>!0);Vc=this.Gn.OQe(ce,Jd,Bd,Vc,yc,Da.ribbonCommandInfo,null,null);let ie=this;return aa.d(Vc.then(()=>{f.ULS.sendTraceTag(521410071,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${Da.copyPasteTargetType}"`);
this.gridView.ga.selectionType=-1;this.B$a(Da,jd,Cb,Zb,ce);return Promise.resolve(!0)},we=>{const zc=we?ie.getStringifiedError(we):"null";this.eya||f.ULS.sendTraceTag(521410070,0,10,`CopyPasteInfrastructure.DragDropInsertCells: ${zc}, copyPasteTargetType="${Da.copyPasteTargetType}"`);ie.Xab(we,Da,jd,Cb,Zb,ce);return Promise.reject(we)})).Fo(()=>!0)}Bic(Da,Cb,Zb,yc,Vc,jd){var ld=ca(this.UK);if(!ld)return f.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),
W.Task.Ua(!1);if(!H(ld.sourceItem))return f.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),W.Task.Ua(!1);var Bd=ld.sourceItem;if(!Bd)return f.ULS.shipAssertTag(537167810,0,!!Bd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),W.Task.Ua(!1);if(!Bd.isFromCurrentSession(this.$)&&!X.a.KCb)return f.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),W.Task.Ua(!1);if(1<Bd.ranges.length)return f.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.HAa(2192,"InsertCopiedCutCells",!0),W.Task.Ua(!1);ld=P.L(Bd.ranges);var Td=this.gridView.ga.qa.gd.clone();Da=P.L(this.M4b([Td],Da));const Jd=this.tsf();Bd=Bd.sheetName;Td=this.$.ea.na.sheetName;const ce=P.v(ld,this.$);ce.SheetName=Bd;const ie=P.v(Da,this.$);ie.SheetName=Td;Bd=this.gridView.ga.qa.activeRange;return(Da.Ng||ld.Ng||w.EwaSettings.isChangeGateEnabled("OfficeVSO:7578311_InsertCopiedCutCellsDefaultShiftInTable")&&
this.Gn.PMj(this.$,ld,Bd)?W.Task.Ua(0):Da.isRow||ld.isRow||w.EwaSettings.isChangeGateEnabled("OfficeVSO:7578311_InsertCopiedCutCellsDefaultShiftInTable")&&this.Gn.QMj(this.$,ld,Bd)?W.Task.Ua(1):this.soi.J7b(this.$,Y.h(this.$).rtl)).Fo(we=>!this.Ead()&&X.a.KCb?this.Gn.executeInsertCopiedCutCellsAcrossSession(ce,ie,Jd,we.result,Cb,null,null,Zb,yc,Vc,jd):this.Gn.executeInsertCopiedCutCellsOperation(ce,ie,Jd,we.result,Cb,null,null)).continueWith(()=>{!w.EwaSettings.isChangeGateEnabled("OfficeVSO:7646005_InsertCopiedCutCellsClearState")&&
Jd?this.Gn.khc():this.Cr("InsertCopiedCutCells/success/"+r.a[Cb.method],!0)})}ykc(){const Da=ca(this.UK),Cb=this.gridView.ga.qa.ph;return!!Da&&H(Da.sourceItem)&&Cb&&1===Da.sourceItem.ranges.length}tsf(){return this.usf(-911352779)}fnc(){return this.usf(-1985798686)}W4b(Da,Cb){var Zb=new pa.a(this.$.ua),yc=36===Da;const Vc=Zb.Zd(4);Da=2===this.j$a()&&Zb.Zd(1);yc=yc&&Vc;Zb=!Zb.di||!this.fnc()||!pa.a.p$b(Cb,Y.h(this.$));return yc||Da||this.$.wt(Cb,!0)&&Zb}BCb(Da,Cb){return this.Gn.BCb(Da,Cb)}dispose(){super.dispose();
this.Oi();this.UK.removeMetadataChangeListener(Sa.hzf)}zad(Da,Cb,Zb,yc,Vc,jd){if(!this.O9g(Da.commandParameters.ribbonCommandInfo.command))return Da.cseStatus=2,!1;if(jd&&Cb.xd(yc))return Da.cseStatus=4,!1;if(Zb!==Vc)return Da.cseStatus=6,!1;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&(yc.width%Cb.width||yc.height%Cb.height))return Da.cseStatus=16,!1;if(w.EwaSettings.getBooleanFeatureGate(X.a.oMe,!1)){if(Zb=Cb,yc=yc.ze(this.gridView.Ej),Cb=null===Cb.ze(this.gridView.Ej),
Vc=Da.commandParameters.ribbonCommandInfo.command,Cb&&1804571062!==Vc&&-185374993!==Vc||!yc)return Da.cseStatus=7,!1}else if(Zb=Cb.ze(this.gridView.Ej),yc=yc.ze(this.gridView.Ej),!Zb||!yc)return Da.cseStatus=7,!1;if(X.a.Xze){Cb=this.Wze(this.gridView,Da.commandParameters.ribbonCommandInfo.command,Zb,Gb.source);if(0!==Cb)return Da.cseStatus=Cb,!1;Cb=this.Wze(this.gridView,Da.commandParameters.ribbonCommandInfo.command,yc,Gb.destination);if(0!==Cb)return Da.cseStatus=Cb,!1}Cb=P.v(Zb,this.$);Cb=this.eg.l$i(this.gridView,
Cb,P.v(yc,this.$),Da.commandParameters.ribbonCommandInfo.command,Da.commandParameters.stopwatch);1===Cb&&(jd&&(this.eg.c5c(Zb,!1),this.eg.c5c(Zb,!0)),jd=new Xa(Da.commandParameters.ribbonCommandInfo.command,yc,Zb),Y.h(this.$).bhj(jd),this.pasteIndicationManager.tod(Da.commandParameters.id),this.rzc(Da.commandParameters.expandDestinations,Da.commandParameters.isPasteCommandFromRecoveryUI),this.CFe("DoPasteClientEstimation/"+r.a[Da.commandParameters.ribbonCommandInfo.method],Da));Da.cseStatus=Cb;return 1===
Cb}Wze(Da,Cb,Zb,yc){const Vc=new sb.a("CopyPasteInfrastructure.blockCseForPaste",Da,Zb);try{for(;Vc.moveNext();){let jd=Vc.get_current().cell;if(jd.Oz)return 8;if(237279923===Cb||-185374993===Cb){if(jd.aT&&w.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste"))return 18;if(jd.gN&&w.EwaSettings.isChangeGateEnabled("OfficeVSO:7327017_BlockCondFormattingForPaste"))return 19}if(yc===Gb.source){if(jd.Yca)return 23;if(jd.xvd)return 24;if(jd.hasIgnorableError)return 25;if((237279923===
Cb||1804571062===Cb)&&this.ryi(Da,Zb))return 20;if(237279923===Cb){if(jd.yla)return 22;if(jd.hasHyperlink||jd.mma)return 21}}}}finally{Vc&&Vc.dispose()}return 0}ZQf(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,!1,this.OJi)}sJi(Da,Cb,Zb,yc){Da=D(Da,Cb,Zb,yc,this.$.xa.UserSessionId);Da.k=!0;F.b().gf(45,Da,!0)}b3i(Da,Cb,Zb,yc,Vc){var jd=!1,ld=!1,Bd=Sa.Wub,Td=Sa.HQe+Sa.SKa;Da&&(Td+=Sa.hMa(Da),Pa.a.Jq(Da.ewaErrors)?(Bd=this.rec(Da.ewaErrors),Pa.a.fh(Da.ewaErrors,[-103190598])&&
(jd=!0)):Da.message&&(Bd=Da.message));ld||(ld=this.Jsd(Da));Cb=D(Cb,Zb,yc,Vc,this.$.xa.UserSessionId);Cb.k=!1;Cb.l=ld;Cb.n=Bd;Cb.p=Td;Cb.q=jd;F.b().gf(45,Cb,!0);return Promise.reject(Da)}ryi(Da,Cb){const Zb=Da.dk("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new x.Range(Cb.top,Cb.right,Cb.bottom,Cb.right,!0,!0));for(;Zb.$$mn();){let yc=Zb.$$cu();if(yc&&yc.sxa())return f.ULS.sendTraceTag(509436432,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0}for(Da=
Da.dk("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new x.Range(Cb.bottom,Cb.left,Cb.bottom,Cb.right,!0,!0));Da.$$mn();)if((Cb=Da.$$cu())&&Cb.oxa())return f.ULS.sendTraceTag(509436431,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0;return!1}O9g(Da){switch(Da){case 237279923:case 808159687:return w.EwaSettings.isChangeGateEnabled("OfficeVSO:7317055_PasteCse");case -185374993:return!0;case 1804571062:return!0;default:return!1}}usf(Da){const Cb=ca(this.UK);
if(!Cb)return!1;const Zb=Cb.sourceItem;return X.a.KCb||!Zb||Zb.isFromCurrentSession(this.$)?Cb.commandParameters.ribbonCommandInfo.command===Da:(f.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1)}YKj(Da){return Da&&Da.lastCopy?Ga(Da.lastCopy,this.$):!0}n5e(Da,Cb,Zb,yc,Vc){const jd={};jd.a=this.$.xa.UserSessionId;jd.e=Da.stopwatch.id;jd.c=F.b().Sj(Da.ribbonCommandInfo.command);jd.b=r.a[Da.ribbonCommandInfo.method];
jd.d=Da.id;jd.f=Zb.toString();jd.g=yc.toString();jd.h=Cb.toString();jd.o=Da.stopwatch.Jc;jd.q=!1;jd.r=Da.copyPasteTargetType.toString();jd.s=Vc.encounteredDeploymentErrors;w.EwaSettings.getBooleanFeatureGate(X.a.C$b,!1)&&(jd.i=Vc.commandParameters.dragDropIsShiftKeyDown,jd.j=Vc.commandParameters.isDragInsert);return jd}B$a(Da,Cb,Zb,yc,Vc){Da=this.n5e(Da,Cb,Zb,yc,Vc);Da.k=!0;F.b().gf(45,Da,!0)}NHi(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td){Da=this.n5e(Da,Cb,Zb,yc,Td);Da.k=!1;Da.l=Vc;Da.n=jd;Da.p=ld;Da.q=Bd;F.b().gf(45,
Da,!0)}Juf(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td){const Jd={};Jd.a=this.$.xa.UserSessionId;Jd.b=Cb;Jd.c=Da;Jd.f=Zb;Jd.e=yc;Jd.d=Vc;Jd.g=jd;Jd.h=ld;Jd.i=Bd;Jd.j=Td.toString();F.b().gf(46,Jd,!0)}FHi(Da,Cb){Da=this.K4e(Da.commandParameters,Da);Da.l=!0;Da.j=Cb;F.b().gf(43,Da,!0)}EHi(Da,Cb,Zb,yc,Vc,jd,ld){Da=this.K4e(Da,ld);Da.l=!1;Da.m=Cb;Da.o=Zb;Da.y=yc;Da.x=Vc;Da.z=jd;F.b().gf(43,Da,!0);f.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${Da.y},ErrorReason=${Da.x},IsExpectedError=${Da.m},IsSucceededWithAlert=${Da.z},ErrorMessage=${Da.o}`)}K4e(Da,
Cb){const Zb={};Zb.a=this.$.xa.UserSessionId;Zb.f=Da.stopwatch.id;Zb.g=Da.id;Zb.c=F.b().Sj(Da.ribbonCommandInfo.command);Zb.b=r.a[Da.ribbonCommandInfo.method];Zb.q=Da.stopwatch.Jc;Zb.bd=Sa.Gdc();Zb.bg=Da.copyPasteHandlerName;Zb.bj=void 0===Da.ribbonCommandInfo.af||null===Da.ribbonCommandInfo.af?null:u.a[Da.ribbonCommandInfo.af];Zb.bq=Da.uploadToClipService;Zb.br=Da.floatingObjectType;Zb.s=Da.copyPasteTargetType.toString();Zb.bc=sa(Da.copyPasteTargetType);Zb.z=!1;if(Cb){Zb.bk=Cb.id;Zb.bl=Cb.serverRequestTimeInMs;
Cb.requestTelemetryData&&(Zb.bm=Cb.requestTelemetryData.EcsOperationDuration,Zb.bn=Cb.requestTelemetryData.EcsRequestDuration,Zb.bo=Cb.requestTelemetryData.WfeRequestDuration);Zb.d=Cb.sourceItem?Cb.sourceItem.toString():null;Zb.e=-1;if(H(Cb.sourceItem)){Zb.e=0;Da=Cb.sourceItem.ranges;for(const yc of Da)Zb.e+=yc.Cw}Zb.h=Cb.isAsyncCopy;Zb.i=Cb.isFromCache;Zb.k=Cb.isSelectionAllowed;Zb.r=Cb.plainTextPayloadSize;Zb.u=Cb.htmlPayloadSize;Zb.v=Cb.htmlSizeExceedsLimit;Zb.w=Cb.copyTotalSizeExceedsLimit;Zb.t=
Cb.shadowWorkbookPayloadSize;Zb.p=Cb.clientSideCopyTime;Zb.ba=Cb.encounteredDeploymentErrors;Zb.bb=Cb.shadowWorkbookSizeExceedsLimit;Zb.be=Cb.syncClipboardItemsKeys;Zb.bf=Cb.asyncClipboardItemsKeys;Zb.bh=this.dJe(Cb.succeededPopulatingSystemClipboardSync);Zb.bi=this.dJe(Cb.succeededPopulatingSystemClipboardAsync)}return Zb}rzc(Da,Cb=!1){if(!this.gridView.jb&&!this.gridView.ni){var Zb=this.gridView.ga.qa,yc=!Cb&&1===Da.length&&P.R(Da,Zb.selectedRanges),Vc=yc?Zb.activeCell:Da[0].topLeft;Da[0].contains(Vc)||
(f.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${Zb.selectedRanges}, IndexOfActiveRange ${Zb.Xq}, ActiveCell ${Zb.activeCell}, calculatedDestinationRanges ${Da}, keepThePreviousActiveCell ${yc}, newActiveCell ${Vc}, isPasteCommandFromRecoveryUI ${Cb}`),Vc=Da[0].topLeft);this.gridView.ga.bE(Da,0,Vc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}M8e(Da,Cb){const Zb={};Zb.a=this.$.xa.UserSessionId;Zb.g=Da.stopwatch.id;Zb.t=Da.stopwatch.Jc;Zb.bz=
!1;Cb&&(Zb.bv=Cb.id,Zb.bw=Cb.serverRequestTimeInMs,Zb.n=Cb.commandParameters.clipboardFormatReadTimes,Zb.o=Cb.commandParameters.clipboardFormatReadStatus,Zb.p=Cb.commandParameters.clipboardReadPermissionPromptShown,Zb.q=Cb.commandParameters.asyncApiReadTimedOut,Cb.requestTelemetryData&&(Zb.cb=Cb.requestTelemetryData.EcsOperationDuration,Zb.cc=Cb.requestTelemetryData.EcsRequestDuration,Zb.cd=Cb.requestTelemetryData.WfeRequestDuration));Zb.x=Da.copyPasteTargetType.toString();Zb.bl=sa(Da.copyPasteTargetType);
Zb.br=Da.copyPasteHandlerName;Zb.i=P.i(Da.expandDestinations,",",this.$,!1);Zb.h=P.i(Da.originalDestinations,",",this.$,!1);Zb.e=Da.id;Zb.d=Da.commandType;Zb.c=F.b().Sj(Da.ribbonCommandInfo.command);Zb.b=r.a[Da.ribbonCommandInfo.method];Zb.bf=!1;Zb.bg=!1;Zb.bp=Sa.Gdc();Zb.bt=void 0===Da.ribbonCommandInfo.af||null===Da.ribbonCommandInfo.af?null:u.a[Da.ribbonCommandInfo.af];Zb.cj=Da.isPasteCommandFromEnterShortcut;if(Zb.ca=Da.isPasteCommandFromRecoveryUI)Zb.cf=Da.pasteRecoveryUndoStopwatch.id,Zb.cg=
Da.pasteRecoveryUndoStopwatch.Jc;if(Cb){if((Da=Cb.copyContextSnapshot)&&!Cb.wasLastCopyExternal){Zb.f=Da.commandParameters.id;Zb.j=Da.sourceItem.toString();Zb.k=-1;if(H(Da.sourceItem)){Zb.k=0;const yc=Da.sourceItem.ranges;for(const Vc of yc)Zb.k+=Vc.Cw}Zb.bg=1===Da.commandParameters.commandType}else Cb.clipboardItems?Zb.f=Cb.clipboardItems.getItem(N.Mtb):f.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");Zb.bz=Cb.pasteRecoveryUIDisplayed;
Zb.ci=Cb.cseStatus}else f.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Zb}ZIi(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td){Da=this.M8e(Da,Bd);Da.l=!1;Da.m=Cb;Da.s=Zb;Da.bc=yc;Da.be=Vc;Da.bd=jd;Da.bf=ld;Bd?(Da.y=I(Bd)||!Bd.copyContextSnapshot,Da.bi=!Da.y&&Ga(Bd.copyContextSnapshot,this.$),Da.bj=Bd.shadowWorkbookSizeExceedsLimit,Da.v=Bd.shadowWorkbookPayloadSize,Da.w=Bd.htmlPayloadSize,Da.bq=bb(Bd.clipboardItems),Da.bb=Bd.activeSelectionType,Da.bs=Bd.isSameSession,
Da.bn=Bd.payloadOrigin,Da.bo=Bd.payloadType,Da.bu=Bd.externalAppSource,Da.bx=Bd.indicationDisplayScheduled,Da.by=Bd.pasteIndicationDisplayStatus,Da.ck=Bd.pasteDestinationHasMergedCells):Da.bi=Ga(Td,this.$);F.b().gf(44,Da,!0);f.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${Da.be},ErrorReason=${Da.bd},IsExpectedError=${Da.m},IsSucceededWithAlert=${Da.bf},ErrorMessage=${Da.s}`)}$Ii(Da){const Cb=this.M8e(Da.commandParameters,Da);Cb.y=Da.wasLastCopyExternal;
Cb.l=!0;Cb.u=Da.plainTextPayloadSize;Cb.v=Da.shadowWorkbookPayloadSize;Cb.w=Da.htmlPayloadSize;Cb.z=Da.isClipboardDataContainShadowWorkbook;Cb.ba=Da.isShadowWorkbookParsedSuccessfully;Cb.bb=Da.activeSelectionType;Cb.bc=Da.pasteResult;Cb.bh=Da.encounteredDeploymentErrors;Cb.bj=Da.shadowWorkbookSizeExceedsLimit;Cb.bk=U(Da);Cb.bq=bb(Da.clipboardItems);Cb.bs=Da.isSameSession;Cb.bn=Da.payloadOrigin;Cb.bo=Da.payloadType;Cb.bu=Da.externalAppSource;Cb.bx=Da.indicationDisplayScheduled;Cb.by=Da.pasteIndicationDisplayStatus;
Cb.ck=Da.pasteDestinationHasMergedCells;Cb.bm=Da.clipboardItems?Da.clipboardItems.getItem(N.G8g):null;Cb.bi=!Da.isSameSession&&!Da.wasLastCopyExternal;F.b().gf(44,Cb,!0)}Mi(){this.$.ua.kg(this.Fj);this.$.ua.rRg(this.Mrc);this.$.userOperationManager.tr(this.WR);this.$.rl(this.yd);Y.h(this.$).hc.An(this.qAa)}Oi(){this.$&&this.$.ua&&(this.$.ua.Gg(this.Fj),this.$.ua.dqj(this.Mrc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.ro(this.WR);this.gridView&&this.gridView.hc&&this.gridView.hc.sn(this.qAa)}oIb(Da,
Cb){var Zb=null;let yc=!1;var Vc=null;let jd="UnknownFailure",ld=-1,Bd=Sa.Wub,Td=Sa.pasteErrorName+Sa.SKa,Jd=!1;this.pasteIndicationManager.tod(Da.id);this.pasteDestinationHasMergedCells(Da.expandDestinations)&&(Cb.pasteContext.pasteDestinationHasMergedCells=!0);const ce=ca(this.UK);(Da.clearStateOnFinish||Da.clearSystemClipboard)&&this.Cr("Paste/fail/"+r.a[Da.ribbonCommandInfo.method],!0,void 0,void 0,Da.copyPasteTargetType).catch(()=>{});if(Cb){ld=Cb.reason;Td+=Sa.hMa(Cb);Cb.message&&(Bd=Cb.message);
if(Zb=Sa.Ydh(Cb))if(1===Zb.pasteErrorName)yc=!0,jd="CopyPasteLengthTooLongPopup",Bd=Vc="The pasted content is too long. Popup a dialog to the user.",f.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${Da.copyPasteTargetType}"`),Zb=Pa.a.nd(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),w.EwaSettings.By()?new cb.a(this.$,Zb):(Zb=new za.ErrorDialog(this.$,Zb),Zb.initialize(),Zb.qg());else if(7===Zb.pasteErrorName)yc=!0,jd="No-Op",Bd=Vc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",
f.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${Da.copyPasteTargetType}"`);else if(8===Zb.pasteErrorName)yc=!0,jd="UseShortcutsPopup",Bd=Vc="Unable to paste content from the system clipboard. Popup dialog to the user.",f.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${Da.copyPasteTargetType}"`),this.ZQf();else if(18===Zb.pasteErrorName){yc=!0;jd="PasteExternalNotSupportMultipleSelectionPopup";
Bd="Paste external not support multiple selection.";Vc="Unknown";var ie=2192;100!==Zb.validationFailureReason&&(Vc=Ba[Zb.validationFailureReason],ie=Sa.WIe(Zb.validationFailureReason));this.HAa(ie,Vc,!0)}else 20===Zb.pasteErrorName||19===Zb.pasteErrorName?(yc=!0,20===Zb.pasteErrorName?(jd="PasteAcrossSessionNotSupportMultipleSelectionPopup",Bd="Paste across session does not support multiple selection."):(jd="PasteInSameSessionNotSupportMultipleSelectionPopup",Bd="This kind of multiple selection is not supported for same session paste."),
Vc="Unknown",ie=2192,100!==Zb.validationFailureReason&&(Vc=Ba[Zb.validationFailureReason],ie=Sa.WIe(Zb.validationFailureReason)),Zb=6===Zb.validationFailureReason,this.W4b(Da.commandType,Da.expandDestinations)&&Zb&&this.rzc(Da.expandDestinations),this.HAa(ie,Vc,!0)):6===Zb.pasteErrorName?(yc=!0,jd="No-Op",Bd=Vc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",f.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${Da.copyPasteTargetType}"`)):
17===Zb.pasteErrorName?(yc=!0,jd="No-Op",Bd=Vc="Paste text on Art is not yet a supported operation",f.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${Da.copyPasteTargetType}"`)):16===Zb.pasteErrorName?(yc=!0,jd="No-Op",Bd=Vc="Paste has failed because the previous copy has failed",Zb=this.getStringifiedError(Zb),f.ULS.sendTraceTag(537167771,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${Da.copyPasteTargetType}", error=${Zb}`)):
Pa.a.Jq(Zb.ewaErrors)?(Pa.a.maa(Zb.ewaErrors)||Pa.a.fh(Zb.ewaErrors,Pa.a.agc())?(yc=!0,jd="CommunicationError",Vc=Pa.a.xc(Zb.ewaErrors),f.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Bd} copyPasteTargetType="${Da.copyPasteTargetType}"`)):Pa.a.fh(Zb.ewaErrors,Sa.Hyj)?(yc=!0,jd="SavingWorkbookError",Vc=Pa.a.xc(Zb.ewaErrors),f.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Bd} copyPasteTargetType="${Da.copyPasteTargetType}"`)):Pa.a.fh(Zb.ewaErrors,
Sa.operationSucceededWithAlert)&&(Jd=yc=!0,jd="OperationSucceededWithAlert",Vc=Pa.a.xc(Zb.ewaErrors),f.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Bd} copyPasteTargetType="${Da.copyPasteTargetType}"`)),yc||(Bd=this.rec(Zb.ewaErrors),yc=this.Jsd(Cb))):11===Zb.pasteErrorName&&(yc=!0,jd="No-Op",Bd="Paste has failed because user try copy cross-session oart object");15===Cb.reason&&(yc=!0,jd="No-Op",Bd="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Oa.a.equals(Td,G.X9j,!1)&&(yc=!0,jd="No-Op",Bd="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}yc||(Zb=Cb?this.getStringifiedError(Cb):"null",f.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${Zb}, copyPasteTargetType="${Da.copyPasteTargetType}"`));this.ZIi(Da,yc,Bd,jd,Td,ld,Jd,Cb.pasteContext,ce);return Promise.reject(Cb)}qsc(Da,Cb){var Zb,yc,Vc;f.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${Cb.copyPasteTargetType}"`);
this.pasteIndicationManager.tod(Cb.id);if(this.q$i(Cb.copyPasteTargetType,Da)){w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.vB&&Da.wasLastCopyExternal&&Da.payloadType===T.shadowWorkbook&&(this.s9a=!0);let jd=null;(null===(Zb=Da.pastedRange)||void 0===Zb?0:Zb.Ranges)&&0<Da.pastedRange.Ranges.length?jd=P.g(Da.pastedRange.Ranges):Da.wasLastCopyExternal||(jd=Cb.expandDestinations);this.xAj(Da,jd);if(this.kNj(Da,jd)){let ld;Zb=P.d(Cb.originalDestinations);
ld=1028===Cb.commandType?P.d(Cb.expandDestinations):P.d(jd);let Bd=null;Da.wasLastCopyExternal&&(Cb.isKeyboardEvent||Cb.isPasteCommandFromRecoveryUI)&&(Bd={[Sa.LPf]:Da.clipboardItems});this.pasteDestinationHasMergedCells(Cb.expandDestinations)&&(Da.pasteDestinationHasMergedCells=!0);Da.pasteRecoveryUIDisplayed=!0;const Td=new ea(this.$,Zb,ld,Bd),Jd=qa.GetServiceTaskFactory.Sa(this.$.da,406,405,0);ya.TaskExtensions.za(Jd,()=>{const ce=Jd.result;ce.Pze(Td);ce.jdg(Cb.ribbonCommandInfo.method)},this.ka,
8)}Zb=[237279923,-875588320,-185374993,-958589048];if(!Da.pasteRecoveryUIDisplayed&&1===jd.length&&Zb.includes(null===(Vc=null===(yc=Da.commandParameters)||void 0===yc?void 0:yc.ribbonCommandInfo)||void 0===Vc?void 0:Vc.command)&&(yc=P.L(jd),v.AFrameworkApplication.Fs("XLS-SmartView-CutAndPaste-Treatment;XLS-SmartView-CutAndPaste-Control"),w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.CutAndPasteEnabled",!1)&&yc)){Vc=ia.d(this.$.ua.na);const ld=new ka.a(yc,Vc);w.EwaSettings.isChangeGateEnabled("OfficeVSO:7666056_SVConsistentGridOnCut")?
this.Cna(()=>{this.mFc(ld,"CutAndPaste")}):this.mFc(ld,"CutAndPaste")}}this.CFe("Paste/success/"+r.a[Cb.ribbonCommandInfo.method],Da);this.$Ii(Da);this.Jbg&&(!Cb.isKeyboardEvent||U(Da))&&this.$.ea.Lg.get(66)&&(f.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.Jbg=!1,this.Ffh());return Promise.resolve(!0)}kNj(Da,Cb){return!Cb||1!==Cb.length||Da.commandParameters.clearSystemClipboard||Da.commandParameters.clearStateOnFinish||Da.commandParameters.skipClipboardAccess?
!1:I(Da)&&(Cb=Da.clipboardItems.getItem(N.plainText),Da=Da.clipboardItems.getItem(N.html),void 0===Cb||null===Cb||Cb.length>this.KMi||void 0===Da||null===Da||Da.length>this.Aza)?(f.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}q$i(Da,Cb){return 1===Da||Cb.payloadType===T.plainText||w.EwaSettings.ya(151)&&Cb.payloadType===T.html||w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!h.a.vB&&Cb.payloadType===T.shadowWorkbook}pasteDestinationHasMergedCells(Da){const Cb=Y.h(this.$).Ca.uy();if(!Cb||!Cb.length)return!1;for(const Zb of Cb)if(Zb.Ku(Da[0]))return!0;return!1}CFe(Da,Cb){let Zb;({bJa:Zb}=this.psi(Cb)).returnValue&&this.Cr(Da,Zb,void 0,void 0,Cb.commandParameters.copyPasteTargetType).catch(()=>{})}Xab(Da,Cb,Zb,yc,Vc,jd){const ld=Da?this.getStringifiedError(Da):"null";this.eya||f.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${ld}`);
let Bd=!1,Td=!1,Jd=!1,ce=Sa.Wub,ie=Sa.HQe+Sa.SKa;Da&&(ie+=Sa.hMa(Da),Pa.a.Jq(Da.ewaErrors)?(ce=this.rec(Da.ewaErrors),Pa.a.fh(Da.ewaErrors,Sa.operationSucceededWithAlert)&&(Bd=!0),Pa.a.fh(Da.ewaErrors,Sa.dragDropNonEmptyRange)&&(Td=Jd=!0)):Da.message&&(ce=Da.message));Jd||(Jd=this.Jsd(Da));Td?this.gridView.ga.selectionType=-1:this.Gn.skj(Vc);this.eya&&!Jd&&f.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${ld}, copyPasteTargetType="${Cb.copyPasteTargetType}`);this.NHi(Cb,
Zb,yc,Vc,Jd,ce,ie,Bd,jd)}M4b(Da,Cb){let Zb=Da;const yc=this.S1h();if(null===yc||void 0===yc?0:yc.ranges)Zb=this.Gn.I4g(Cb,yc.ranges,Da);return Zb}S1h(){const Da=ca(this.UK);return Da&&H(Da.sourceItem)?Da.sourceItem:null}uhj(){this.raiseEvent(Sa.QGd,null)}xAj(Da,Cb){const Zb=Da.commandParameters.originalDestinations;Cb&&(P.R(this.gridView.ga.qa.selectedRanges,Zb)?(this.rzc(Cb),Da=Ma.HelperMethods.$qb(Cb),f.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${Da}`)):
Da.commandParameters.isPasteCommandFromRecoveryUI?(this.rzc(Cb,!0),f.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${Cb}, active cell: ${Cb[0].topLeft}`)):(Da=Ma.HelperMethods.$qb(Zb),f.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${Da}`)))}psi(Da){if(Da.isPlainTextPaste||
Da.isHtmlPaste||O(Da)||Da.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,bJa:!1};var Cb=Da.copyContextSnapshot;if(Da.commandParameters.clearStateOnFinish)return{returnValue:!0,bJa:!0};if(Cb&&H(Cb.sourceItem)){var Zb=Cb.sourceItem;if(!Zb.isFromCurrentSession(this.$))return{returnValue:!1,bJa:!0};Cb=-1985798686===Cb.commandParameters.ribbonCommandInfo.command;if(!(1<Zb.ranges.length||1<Da.commandParameters.expandDestinations.length)){const yc=P.L(Zb.ranges);Da=P.L(Da.commandParameters.expandDestinations);
const Vc=this.$.ea.na.sheetName;Zb=Zb.sheetName;if(Zb===Vc&&Da.equals(yc))return{returnValue:!1,bJa:!0};if(Zb===Vc&&Da.ze(yc))return{returnValue:!0,bJa:!1}}return{returnValue:Cb,bJa:!0}}return{returnValue:!1,bJa:!0}}DMf(){var Da=ca(this.UK);(Da=this.Gn.p6a(Da))&&Da.isFromCurrentSession(this.$)&&this.Cr("OnStartEdit",!1).catch(()=>{})}rec(Da){Da=Pa.a.pZh(Da,Sa.SKa);return this.WNi+d.a.Au(Da).toString()}Jsd(Da){Da=Sa.hMa(Da);return!!Da&&Oa.a.d4a(Da,Sa.VNi)}Ffh(){const Da=Pa.a.nd(1,2,327,328,h.a.Lo?
329:h.a.bI?330:331,530046625,"ActivateLocalStorage"),Cb=Object(ib.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(aa.d)(Ub.a.resolve(hc.f,{rb:0})):qa.GetServiceTaskFactory.Sa(this.$.da,5,4,0);ya.TaskExtensions.za(Cb,()=>{Cb.result.eh(43,Da)},this.ka,3)}dJe(Da){return void 0===Da||null===Da?Ha.fRi:Da?Ha.success:Ha.failed}static Ydh(Da){const Cb=Da.innerError;return Cb&&0!==Cb.pasteErrorName?Da.innerError:null}static Kdh(Da){const Cb=Da.innerError;return Cb&&0!==Cb.copyErrorName?Da.innerError:
null}static hMa(Da){let Cb="";if(!Da)return Sa.yNe;Da.errorName&&(Cb=Da.errorName,Da.innerError&&(Cb+=Sa.SKa+Sa.hMa(Da.innerError)));Cb||(Cb=Da&&Da.name?Da.name:Sa.yNe);return Cb}static Gdc(){Sa.Ab||(Sa.Ab=ua.LRj);return Sa.Ab}static WIe(Da){switch(Da){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return f.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${Da}`),
2199}}static Ldh(Da){switch(Da){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;default:return f.ULS.shipAssertTag(537167763,0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${Da}`),2199}}mFc(Da,Cb){ya.TaskExtensions.za(qa.GetServiceTaskFactory.Sa(this.$.da,426,427,1),Zb=>{void Zb.result.d9(Da,Cb);f.ULS.sendTraceTag(512615303,0,50,"CopyPasteInfrastructure.triggerTableInvitationHandRaise: IntelligentMetadataOverlayManager is triggered.")},
this.$.ka,3)}c6(){return this.gridView.Ca.xN(4,this.$.na)}Cna(Da){if(this.c6())Da();else{const Cb=()=>{this.c6()&&(Da(),this.gridView.HLb(Cb))};this.gridView.Vpb(Cb)}}}Sa.hzf="EwaJsMetadataChangeListenerId";Sa.QGd="cpiOSC";Sa.Moh="cpiDID";Sa.Wub="Unknown";Sa.yNe="UnknownError";Sa.SKa="_";Sa.HQe="DragAndDropError";Sa.pasteErrorName="PasteError";Sa.S5g="CancelError";Sa.copyErrorName="CopyError";Sa.VNi="MergedCellOverlap";Sa.LPf="PasteRecoveryCachedClipboardItems";Sa.Hyj=[1352631530,1679665408];Sa.operationSucceededWithAlert=
[-103190598];Sa.pasteDataLimitHit=[1306609195];Sa.copyThrottlingError=[-386183710];Sa.dragDropNonEmptyRange=[563945982];Sa.Ab=null;Object(c.a)(Sa,"CopyPasteInfrastructure",m.a,[656,657,2]);class db{constructor(){this.a2a=this.OFe=null}}Object(c.a)(db,"ClipboardPlatformInitializationResult",null,[]);var fb=a(198),ab=a(659),wb=a(562),kb=a(232),tb=a(128),hb=a(7),Fb=a(65);const va=(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td,Jd=null)=>{Td=Da.Oa(9,Td);Td.sourceRanges=Cb;Td.destinationRanges=Zb;Td.flags=yc;return Fb.g(Da,
"PasteRange",Td,Vc,jd,ld,Bd,64,Jd)},jb=(Da,Cb,Zb,yc,Vc,jd,ld,Bd=null)=>{ld=Da.Oa(1,ld);ld.pasteHtmlParameters=Cb;return Fb.g(Da,"PasteHtmlContent",ld,Zb,yc,Vc,jd,64,Bd)},Ab=(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td=null)=>{Bd=Da.Oa(9,Bd);Bd.destinationRange=Cb;Bd.source=Zb;return Fb.g(Da,"PasteString",Bd,yc,Vc,jd,ld,64,Td)},Qa=(Da,Cb,Zb,yc,Vc,jd,ld=null,Bd=null)=>{ld=Da.Oa(1,ld);ld.copyParameters=Cb;return Fb.g(Da,"Copy",ld,Zb,yc,Vc,jd,0,Bd)},Z=(Da,Cb,Zb,yc,Vc,jd,ld=null,Bd=null)=>{ld=Da.Oa(1,ld);ld.copyParameters=
Cb;return Fb.g(Da,"Cut",ld,Zb,yc,Vc,jd,0,Bd)},wa=(Da,Cb,Zb,yc,Vc,jd,ld=null,Bd=null)=>{ld=Da.Oa(1,ld);ld.pasteParameters=Cb;return Fb.g(Da,"Paste",ld,Zb,yc,Vc,jd,64,Bd)};class Ea{constructor(Da,Cb,Zb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=Da;this.destinationRange=Cb;this.pasteFlags=Zb}}Object(c.a)(Ea,"MacroRecorderPasteRangePayload",null,[145]);class fa{constructor(Da,Cb){this.content=this.destinationRange=null;this.destinationRange=Da;this.content=Cb}getContent(){return this.content}}
Object(c.a)(fa,"MacroRecorderPasteStringPayload",null,[145]);class Ua{constructor(Da){this.pasteParameters=null;this.pasteParameters=Da}}Object(c.a)(Ua,"MacroRecorderPastePayload",null,[145]);var Aa=a(599),Ib=a(787),Pb=a(199),Fa=a(33),da=a(215),K=a(120),xa=a(293);const rb=(Da,Cb,Zb,yc,Vc,jd,ld=null)=>{ld=Da.Oa(41,ld);ld.insertCopiedCutCellsParameters=Cb;return Fb.g(Da,"InsertCopiedCutCells",ld,Zb,yc,Vc,jd,4)},Qb=(Da,Cb,Zb,yc,Vc,jd,ld=null)=>{ld=Da.Oa(41,ld);ld.insertCopiedCutCellsParameters=Cb;return Fb.g(Da,
"InsertCopiedCutCellsV2",ld,Zb,yc,Vc,jd,0)},pc=(Da,Cb,Zb,yc,Vc,jd,ld=null)=>{ld=Da.Oa(41,ld);ld.insertCopiedCutCellsParameters=Cb;return Fb.g(Da,"InsertCopiedCutCellsCrossSession",ld,Zb,yc,Vc,jd,0)};class Lb{constructor(Da){this.parameters=null;this.parameters=Da}getParameters(){return this.parameters}}Object(c.a)(Lb,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[145]);var qb=a(380);class bc{constructor(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td){this.destinationRange=Da;this.Mtb=Zb;this.j$i=yc;this.Ld=Vc;
this.lSb=jd;this.pasteContext=ld;this.N5b=Bd;this.sjg=Td}}Object(c.a)(bc,"PasteHtmlRequestParams",null,[]);class sc{constructor(Da,Cb){this.Tmc=this.fPa=null;this.hRa=X.a.hRa;this.fId=X.a.fId;this.eGb=X.a.eGb;this.Fjc=w.EwaSettings.getBooleanFeatureGate(X.a.vub,!1);this.Rvi=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7316963_InsertCopiedCutCellsV2Enabled");this.krd=!1;this.lya=w.EwaSettings.isChangeGateEnabled("OfficeVSO:7694407_CopyPasteWFEIncreasedLimits");this.Lvi=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimitsForPasteString",
!1);this.Zz=(Zb,yc)=>{if(2===yc.er)this.Xv.clear(),this.fPa=null;else if(1===yc.er&&this.Xv&&this.Xv.contains(yc.Of)){Zb=tb.a(yc.Of.operation.operationName);const Vc=yc.Of.dequeueUtcTime.getTime()-yc.Of.enqueueUtcTime.getTime();f.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${Zb} returned, it took ${Vc} milliseconds to complete.`);this.Xv.remove(yc.Of);this.fPa=null}};this.$=Da;this.gridView=Cb;this.krd&&(this.$.userOperationManager.tr(this.Zz),this.Xv=new fb.a)}get Aza(){return this.lya?
w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.xa.CopyPasteMaxPayloadLength):n.a.Aza}copy(Da,Cb,Zb,yc=null,Vc=null){const jd=this.$.pa.va.ic();this.krd&&this.JY();this.Tmc=jd.ClientRequestId;var ld=new Pb.a(505,0,(Bd,Td,Jd)=>{const ce={CopyPasteTargetType:1};ce.SourceRanges=Da;ce.CopyOperationId=Cb.id;f.ULS.sendTraceTag(537167756,0,50,`CopyPasteInfrastructure.Copy served from CopyPasteProxy : ${this.lya}, CopyOperationId : ${ce.CopyOperationId}`);return this.fPa=
this.lya?Qa(this.$.pa.Dv,ce,xa.b(Bd,Zb),yc?xa.a(Td,yc):Td,Jd,Cb.ribbonCommandInfo,jd,Vc):Qa(this.$.pa.va,ce,xa.b(Bd,Zb),yc?xa.a(Td,yc):Td,Jd,Cb.ribbonCommandInfo,jd,Vc)},80);ld=this.$.userOperationManager.Tc(ld,Cb.ribbonCommandInfo);this.krd&&this.Xv.add(ld)}KPf(Da,Cb,Zb,yc,Vc,jd){return new Promise((ld,Bd)=>{var Td;const Jd=jd.commandParameters.stopwatch.Jc;let ce=2;20===jd.commandParameters.commandType&&(ce=16);36===jd.commandParameters.commandType&&(ce=32);68===jd.commandParameters.commandType&&
(ce=64);Fa.a.rwd(this.$)&&1028===jd.commandParameters.commandType&&(ce=1024);let ie=null;if(null===(Td=jd.copyContextSnapshot)||void 0===Td?0:Td.commandParameters)ie=jd.copyContextSnapshot.commandParameters.id;sc.GSd(this.$,Da,yc,Cb,Zb,null,we=>{sc.Bgc(we,jd,ld,Bd,Jd,this.$,null,!0,null,null)},we=>{jd.serverRequestTimeInMs=jd.commandParameters.stopwatch.Jc-Jd;we=K.a.Ye(we.data);Bd(new Ib.a(5,we))},Vc,ce,ie,jd.commandParameters.id)})}pasteRange(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td,Jd){return new Promise((ce,
ie)=>{const we=ld.commandParameters.stopwatch.Jc;sc.FBj(this.$,Da,Cb,Zb,yc|-5&Vc,zc=>{sc.Bgc(zc,ld,ce,ie,we,this.$,null,!0,Td,Jd)},zc=>{ld.serverRequestTimeInMs=ld.commandParameters.stopwatch.Jc-we;zc=K.a.Ye(zc.data);zc=new Ib.a(5,zc);null===Jd||void 0===Jd?void 0:Jd(zc);ie(zc)},jd,Bd)})}vej(Da,Cb,Zb,yc,Vc,jd,ld){return(new Promise((Bd,Td)=>{if(Cb)if(Cb.length>this.Aza){var Jd=ld.clipboardItems.getItem(N.plainText);let ce=-1;void 0!==Jd&&null!==Jd&&(ce=Jd.length);X.a.Alf&&Cb.length<this.fId&&Cb.length>
this.hRa&&(this.RQf(Cb),this.JW=new bc(Da,Cb,Zb,yc,Vc,jd,ld,0,this.Ktc.length),window.requestIdleCallback&&window.requestIdleCallback(()=>this.wId()));f.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${Cb.length}, MaxHtmlImportLength: ${this.Aza}, PlainTextLength: ${ce}`);Td(new Ib.a(1))}else Jd=new Pb.a(204,0,(ce,ie,we)=>{this.$.Oy();const zc=ld.commandParameters.stopwatch.Jc;ce=xa.b(ce,wd=>{sc.Bgc(wd,ld,Bd,Td,zc,this.$,
Cb,!1,null,null)});ie=xa.a(ie,wd=>{ld.serverRequestTimeInMs=ld.commandParameters.stopwatch.Jc-zc;wd=K.a.Ye(wd.data);Td(new Ib.a(3,wd))});const Sc=this.$.pa.va.ic(),td=P.v(Da,this.$),Md={};Md.SourceHtml=Cb;Md.DestinationRanges=td?P.s(td):null;Md.CopyOperationId=Zb;Md.PasteId=yc;f.ULS.sendTraceTag(537167755,0,50,`CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : ${this.lya}. PasteId : ${Md.PasteId}`);return this.lya?jb(this.$.pa.Dv,Md,ce,ie,we,null,Sc,jd):jb(this.$.pa.va,Md,ce,ie,
we,null,Sc,jd)},65),this.$.userOperationManager.Tc(Jd,Vc);else Bd("")})).then(()=>{X.a.Alf&&Cb.length>this.hRa&&(this.RQf(Cb),this.JW=new bc(Da,Cb,Zb,yc,Vc,jd,ld,0,this.Ktc.length),window.requestIdleCallback&&window.requestIdleCallback(()=>this.wId()))})}RQf(Da){const Cb=this.$.Rb.Qc("Task","pasteHtmlChunkOperation"),Zb=Math.floor(Da.length/this.hRa)+1;this.Ktc=Array(Zb);let yc=0;for(;yc<Zb;)this.Ktc[yc]=Da.substring(yc*this.hRa,(yc+1)*this.hRa),yc++;f.ULS.sendTraceTag(523257954,0,50,`CopyPasteUtils.populatePasteChunks Time taken for chunking: ${Cb.Jc}`)}wId(){this.i$i(this.JW.destinationRange,
this.Ktc[this.JW.N5b],this.JW.Mtb,this.JW.j$i,this.JW.Ld,this.JW.lSb,this.JW.pasteContext,this.JW.N5b,this.JW.sjg);this.JW.N5b++;this.JW.N5b<this.JW.sjg&&window.requestIdleCallback(()=>this.wId())}i$i(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td){const Jd=new Pb.a(204,0,(ce,ie,we)=>{const zc=ld.commandParameters.stopwatch.Jc;ce=xa.b(ce,()=>{f.ULS.sendTraceTag(512313415,0,15,`CopyPasteUtils.pasteHtmlServerCall succeeded serverRequestTimeInMs:${ld.commandParameters.stopwatch.Jc-zc},
             pasteid:${yc},
             chunkIndex:${Bd},
             totalChunks:${Td}`)});ie=xa.a(ie,()=>{ld.serverRequestTimeInMs=ld.commandParameters.stopwatch.Jc-zc;f.ULS.sendTraceTag(512313414,0,15,`CopyPasteUtils.pasteHtmlServerCall failed serverRequestTimeInMs:${ld.serverRequestTimeInMs},
               pasteid:${yc},
               chunkIndex:${Bd},
               totalChunks:${Td}`)});const Sc=this.$.pa.va.ic();var td=P.v(Da,this.$);td={SourceHtml:Cb,DestinationRanges:td?P.s(td):null,CopyOperationId:Zb,PasteId:`${yc}_chunk_${Bd}`,ChunkIndex:Bd,TotalChunks:Td};f.ULS.sendTraceTag(523257952,0,50,`CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : ${this.lya}. PasteId : ${td.PasteId}`);return jb(this.$.pa.Dv,td,ce,ie,we,null,Sc,jd)},65);this.$.userOperationManager.Tc(Jd,Vc)}wej(Da,Cb,Zb,yc,Vc){return new Promise((jd,ld)=>{f.ULS.sendTraceTag(537167754,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${Vc.id}`);Cb&&(Cb=Oa.a.trimEnd(Cb,"\n","\r"));f.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${Vc.id}`);if(Cb)if(Cb.length>this.eGb)f.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Cb.length,this.eGb),ld(new Ib.a(1));
else{let Td,Jd;const ce=P.v(Da,this.$);f.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${Vc.id}`);var Bd=!this.$.ea.isNamedObjectViewMode&&!Cb.includes("\n")&&!Cb.includes("\t");f.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${Vc.id}. treatAsLink=${Bd}`);Bd=Bd&&Oa.a.anf(Cb);f.ULS.sendTraceTag(537167750,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${Vc.id}. treatAsLink=${Bd}`);
const ie=this.$.pa.va.ic();if(Bd){Jd=526;f.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${Vc.id}`);const we=da.a.vfd(Cb);f.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${Vc.id}`);const zc=P.s(ce);Bd=(Sc,td,Md)=>{const wd=Vc.commandParameters.stopwatch.Jc;Sc=xa.b(Sc,Ta=>{f.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${Vc.id}`);
Vc.requestTelemetryData=Ta.RequestTelemetryData;Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.Jc-wd;Ta.Errors&&0<Ta.Errors.length?ld(new Ib.a(2,Ta.Errors)):jd(Cb)});td=xa.a(td,Ta=>{Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.Jc-wd;Ta=K.a.Ye(Ta.data);ld(new Ib.a(2,Ta))});this.$.Oy();f.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${Vc.id}`);return Fb.b(this.$.pa.va,zc,Cb,we,!1,!1,63,Sc,td,Md,Da,
ie,yc)};Td=()=>new Aa.a(zc,Cb,we)}else Jd=180,Bd=(we,zc,Sc)=>{this.$.Oy();const td=Vc.commandParameters.stopwatch.Jc;we=xa.b(we,Md=>{f.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${Vc.id}`);sc.Bgc(Md,Vc,jd,ld,td,this.$,Cb,!1,null,null)});zc=xa.a(zc,Md=>{Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.Jc-td;Md=K.a.Ye(Md.data);ld(new Ib.a(4,Md))});f.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${Vc.id}`);
return Ab(this.Lvi?this.$.pa.Dv:this.$.pa.va,ce,Cb,we,zc,Sc,null,ie,yc)},Td=()=>new fa(ce,Cb);f.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${Vc.id}`);Bd=new Pb.a(Jd,0,Bd,65,Td);f.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${Vc.id}`);this.$.userOperationManager.Tc(Bd,Zb)}else jd("")})}Bff(Da,Cb){Cb=[1===Cb?4:5];this.gridView.Jb.pA(ka.a.$Ca(ia.d(this.$.na),
Da),Cb,!0);this.gridView.Jb.jr(Cb);this.gridView.Jb.update(!0)}khc(){const Da=[4,5];this.gridView.Jb.ik(Da,!1,!1);this.gridView.Jb.Mk(null,Da,!1);1===this.gridView.ga.Se&&this.gridView.jr(!1,!1);this.gridView.Jb.update(!1,!1)}I4g(Da,Cb,Zb){const yc=[];for(const Vc of Zb)yc.push(this.O4g(Da,Cb,Vc));return yc}JY(){if(this.Xv)for(let Da of this.Xv)if(this.$&&this.$.userOperationManager){if(Da.operation){const Cb=tb.a(Da.operation.operationName);f.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${Cb}.`)}this.Q5g();
this.$.userOperationManager.fva(Da)}}Q5g(){if(this.fPa){const Da=this.fPa.xu;f.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${Da}`);K.a.gv(Da);!w.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.Tmc&&Fb.h(this.$.pa.va,this.Tmc,null,null,null);this.Tmc=this.fPa=null}}O4g(Da,Cb,Zb){f.ULS.shipAssertTag(537167713,0,!!Cb,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");f.ULS.shipAssertTag(537167712,0,0<Cb.length,
"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let yc=0,Vc=0;var jd=new Set;const ld=new Set;for(const Bd of Cb){Cb=`${Bd.left}_${Bd.right}`;const Td=`${Bd.top}_${Bd.bottom}`;ld.has(Cb)||(ld.add(Cb),Vc+=Bd.width);jd.has(Td)||(jd.add(Td),yc+=Bd.height)}if(36===Da)return Zb.isSingle?sc.XYe(Vc,yc,Zb):Zb.clone();516===Da&&(Da=yc,yc=Vc,Vc=Da);Da=!(Zb.width%Vc)&&!(Zb.height%yc);jd=Zb.jW&&!(Zb.height%yc);Zb.v6&&!(Zb.width%Vc)||jd?Zb=sc.XYe(Vc,yc,Zb):Da?Zb=Zb.clone():
(Zb=Zb.clone(),Zb.bottom=Math.min(n.a.Fg,Zb.top+yc-1),Zb.right=Math.min(n.a.Eg,Zb.left+Vc-1));return Zb}mXg(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td,Jd,ce){if(!yc||!yc.length)return 1;if(1<yc.length){if(!this.Fjc&&jd)return 3;if(Jd)return 0;if(Bd)return 9;if(Td)return 8;if(ce)return 2;if(1<Cb.length)return 4;const ie=Cb[0];if(!ld&&!kb.a.all(yc,we=>we.isSingle||!(we.width%ie.width)&&!(we.height%ie.height)))return 5;if((!this.Fjc||!jd)&&Oa.a.equals(Da,Zb,!0))for(const we of Vc)if(we.xd(ie)&&!we.equals(ie))return 6}else if(Cb&&
0<Cb.length){if(0!==this.Ekf(Cb,Td))return 7;if(1<Cb.length){if(!this.Fjc&&jd)return 3;if((!this.Fjc||!jd)&&Oa.a.equals(Da,Zb,!0))for(const ie of Cb)if(Da=Vc[0],ie.xd(Da)&&!ie.equals(Da))return 6}}return 0}Ekf(Da,Cb){if(!Da||1>=Da.length)return 0;if(Cb)return 2;if(!P.T(Da))return 1;Cb=new ab.a(wb.a.$h());for(const Zb of Da)for(const yc of Da){const Vc=Zb.top===yc.top&&Zb.bottom===yc.bottom,jd=Zb.left===yc.left&&Zb.right===yc.right,ld=Math.max(Zb.left,yc.left)<Math.min(Zb.right,yc.right);if(Math.max(Zb.top,
yc.top)<Math.min(Zb.bottom,yc.bottom)&&!Vc||ld&&!jd)return 3;Cb.add(`${Zb.top}-${Zb.bottom}-${yc.left}-${yc.right}`);Cb.add(`${yc.top}-${yc.bottom}-${Zb.left}-${Zb.right}`)}for(const Zb of Da)Cb.remove(`${Zb.top}-${Zb.bottom}-${Zb.left}-${Zb.right}`);return 0<Cb.count?3:0}skj(Da){const Cb=this.gridView.ga;Cb.updateSelection(Da,Da.topLeft,0);Cb.selectionType=-1}p6a(Da){if(null===Da||void 0===Da?0:Da.sourceItem){if(!H(Da.sourceItem))return null;if((Da=Da.sourceItem)&&P.db(Da.ranges,!0))return Da}return null}BCb(Da,
Cb){f.ULS.shipAssertTag(537167711,0,!!Da,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Cb&&hb.a.eE in Cb||Da.tabName?!1:1===Da.method}static FBj(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td){const Jd=Da.pa.va.ic(Td?{bna:!0,Tla:1}:{bna:!1,Tla:0});Td=new Pb.a(506,0,(ce,ie,we)=>{Da.Oy();return va(Da.pa.va,Zb,yc,Vc,xa.b(ce,jd),xa.a(ie,ld),we,null,Jd,Bd)},65,()=>new Ea(Zb,yc,Vc));Da.userOperationManager.Tc(Td,Cb)}static Bgc(Da,Cb,Zb,yc,Vc,jd,ld=null,Bd,Td,Jd){f.ULS.sendTraceTag(537167710,
0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${Cb.id}`);Cb.requestTelemetryData=Da.RequestTelemetryData;Cb.serverRequestTimeInMs=Cb.commandParameters.stopwatch.Jc-Vc;Pa.a.lg(Da.Errors)?Pa.a.hia(Da.Errors)?(Cb&&(Cb.encounteredDeploymentErrors=!0),Da=Pa.a.xc(Da.Errors),f.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Da}`)):
(Da=new Ib.a(5,Da.Errors),null===Jd||void 0===Jd?void 0:Jd(Da),yc(Da)):Da.Result?(yc=!!Da&&!!Da.RequestTelemetryData,Y.h(jd).nh.dna(Cb.commandParameters.stopwatch.id,Da.StateId,yc?Da.RequestTelemetryData.EcsOperationDuration:0,yc?Da.RequestTelemetryData.EcsRequestDuration:0,yc?Da.RequestTelemetryData.WfeRequestDuration:0),Cb.pastedRange=Da.Result.SheetMultiRange,f.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${Cb.id}`),
null===Td||void 0===Td?void 0:Td(),Zb(!0),w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&Bd&&!Cb.commandParameters.isDragDrop&&(Cb=jd.da.Aa(465))&&Cb.e9(6,Da)):(f.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${Cb.id}`),Zb(ld||!0))}static GSd(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td,Jd,ce,ie){const we=Da.pa.va.ic(),zc=sc.sLe(Zb,
yc,Vc,Jd,ce,ie);Zb=new Pb.a(503,0,(Sc,td,Md)=>{Da.Oy();return wa(Da.pa.va,zc,xa.b(Sc,ld),xa.a(td,Bd),Md,jd,we,Td)},65,()=>new Ua(zc));Da.userOperationManager.Tc(Zb,Cb)}static sLe(Da,Cb,Zb,yc,Vc,jd){const ld={};ld.ShadowWorkbookBase64=Da.shadowWorkbookBase64;ld.SourceRanges={};ld.SourceRanges.Ranges=Array(1);ld.SourceRanges.Ranges[0]={};ld.SourceRanges.Ranges[0].FirstRow=Da.rangeRowStart;ld.SourceRanges.Ranges[0].LastRow=Da.rangeRowEnd;ld.SourceRanges.Ranges[0].FirstColumn=Da.rangeColumnStart;ld.SourceRanges.Ranges[0].LastColumn=
Da.rangeColumnEnd;w.EwaSettings.getBooleanFeatureGate(X.a.vub,!1)?Zb?ld.DestinationRanges=P.u(Zb.SheetName,Zb.NamedObjectName,P.g(Zb.Ranges)):(f.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),ld.DestinationRanges=null):ld.DestinationRanges=Cb?P.s(Cb):null;ld.CopyPasteTargetType=1;ld.PasteType=yc;ld.CopyOperationId=Vc;ld.PasteId=jd;ld.SourceClientPath=Da.sourceClientPath;ld.SourceSheetName=Da.sourceSheetName;ld.SourceWorkbookName=Da.sourceWorkbookName;
if(!Da.originalSourceRangesCountExceedsLimit&&Da.originalSourceRanges&&0<Da.originalSourceRanges.length&&1024===yc){ld.OriginalSourceMultiRange={};Cb=Array(Da.originalSourceRanges.length);for(Zb=0;Zb<Cb.length;++Zb)Cb[Zb]={},Cb[Zb].FirstRow=Da.originalSourceRanges[Zb][0],Cb[Zb].FirstColumn=Da.originalSourceRanges[Zb][1],Cb[Zb].LastRow=Da.originalSourceRanges[Zb][2],Cb[Zb].LastColumn=Da.originalSourceRanges[Zb][3];ld.OriginalSourceMultiRange.Ranges=Cb}return ld}static XYe(Da,Cb,Zb){Zb=Zb.clone();Zb.height<
Cb&&(Zb.bottom=Math.min(n.a.Fg,Zb.top+Cb-1));Zb.width<Da&&(Zb.right=Math.min(n.a.Eg,Zb.left+Da-1));return Zb}QMj(Da,Cb,Zb){return(Da=Y.h(Da).wb.mh(Zb))?Cb.width===Da.usedRange.width&&Zb.left===Da.usedRange.left||Zb.left===Da.usedRange.left&&Zb.right===Da.usedRange.right&&0===Zb.width%Cb.width:!1}PMj(Da,Cb,Zb){return(Da=Y.h(Da).wb.mh(Zb))?Cb.height===Da.usedRange.height&&Zb.top===Da.usedRange.top||Zb.top===Da.usedRange.top&&Zb.bottom===Da.usedRange.bottom&&0===Zb.height%Cb.height:!1}executeInsertCopiedCutCellsOperation(Da,
Cb,Zb,yc,Vc,jd=null,ld=null){const Bd={};Bd.InsertDirection=yc;Bd.SourceRange=Da;Bd.DestRange=Cb;Bd.CopyCutOperation=Zb?0:1;const Td=this.$.pa.va,Jd=this.$.pa.va.ic(),ce=()=>new Lb(Bd);return qb.a(this.$.userOperationManager,(ie,we,zc)=>this.Rvi?Qb(Td,Bd,jd?xa.b(ie,jd):ie,ld?xa.a(we,ld):we,zc,Jd):rb(Td,Bd,jd?xa.b(ie,jd):ie,ld?xa.a(we,ld):we,zc,null),ie=>new Pb.a(104,0,ie,void 0,ce),Vc,w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}OQe(Da,
Cb,Zb,yc,Vc,jd,ld,Bd){return new Promise((Td,Jd)=>{this.executeInsertCopiedCutCellsOperation(Cb,Zb,yc,Vc,jd,ce=>{Da.requestTelemetryData=ce.RequestTelemetryData;if(ce.Errors&&0<ce.Errors.length){const ie=new Ib.a(21,ce.Errors);null===Bd||void 0===Bd?void 0:Bd(ie);Jd(new Ib.a(21,ce.Errors))}else null===ld||void 0===ld?void 0:ld(),Td(!0)},ce=>{ce=K.a.Ye(ce.data);ce=new Ib.a(21,ce);null===Bd||void 0===Bd?void 0:Bd(ce);Jd(ce)})})}executeInsertCopiedCutCellsAcrossSession(Da,Cb,Zb,yc,Vc,jd=null,ld=null,
Bd,Td,Jd,ce){let ie={};ie.PasteParameters=sc.sLe(Jd,Bd,Td,2,ce.copyContextSnapshot.commandParameters.id,ce.commandParameters.id);ie.InsertDirection=yc;ie.SourceRange=Da;ie.DestRange=Cb;ie.CopyCutOperation=Zb?0:1;const we=this.$.pa.va,zc=this.$.pa.va.ic(),Sc=()=>new Lb(ie);return qb.a(this.$.userOperationManager,(td,Md,wd)=>pc(we,ie,jd?xa.b(td,jd):td,ld?xa.a(Md,ld):Md,wd,zc),td=>new Pb.a(106,0,td,void 0,Sc),Vc)}}Object(c.a)(sc,"CopyPasteUtils",null,[655]);var Tb=a(502),$a;(function(Da){Da[Da.range=
0]="range";Da[Da.art=1]="art"})($a||($a={}));Object(c.b)("SourceItemType",$a);var Nb=a(98);class Ra{constructor(Da){this.bgg={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1};this.VPb={};this.Yfg={["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,
["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.b1c={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.agg={["RibbonCommand.Copy"]:-911352779,
["RibbonCommand.Cut"]:-1985798686};this.RQd={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut"};this.$fg={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.Rla={};this.Zfg={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.k5a={};this.cgg={["UILocation.Unknown"]:0,
["UILocation.UpperRibbon"]:1,["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,
["UILocation.ContextMenu"]:19,["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.Wr={};this.$=Da;this.Rla.notDefined="InputManager.InputMethod.NotDefined";this.Rla.unknown="InputManager.InputMethod.Unknown";this.Rla.keyboard="InputManager.InputMethod.Keyboard";this.Rla.mouse="InputManager.InputMethod.Mouse";this.Rla.touch="InputManager.InputMethod.Touch";this.Rla.crossSlide="InputManager.InputMethod.CrossSlide";
this.k5a.none="FrameMode.None";this.k5a.reading="FrameMode.Reading";this.k5a.edit="FrameMode.Edit";this.Wr.unknown="UILocation.Unknown";this.Wr.upperRibbon="UILocation.UpperRibbon";this.Wr.ribbon="UILocation.Ribbon";this.Wr.QAT="UILocation.QAT";this.Wr.jewel="UILocation.Jewel";this.Wr.navigationPane="UILocation.NavigationPane";this.Wr.keyboardShortcut="UILocation.KeyboardShortcut";this.Wr.statusBar="UILocation.StatusBar";this.Wr.dialog="UILocation.Dialog";this.Wr.floatie="UILocation.Floatie";this.Wr.notificationBar=
"UILocation.NotificationBar";this.Wr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Wr.taskPane="UILocation.TaskPane";this.Wr.heroDock="UILocation.HeroDock";this.Wr.singleLineRibbon="UILocation.SingleLineRibbon";this.Wr.multilineRibbon="UILocation.MultilineRibbon";this.Wr.overflow="UILocation.Overflow";this.Wr.tellMe="UILocation.TellMe";this.Wr.farPeripheralControls="UILocation.FarPeripheralControls";this.Wr.header="UILocation.Header";this.Wr.fileMenu="UILocation.FileMenu";this.Wr.contextMenu=
"UILocation.ContextMenu";this.Wr.dialogMenu="UILocation.DialogMenu";this.Wr.toolbar="UILocation.Toolbar";this.Wr.canvas="UILocation.Canvas";this.VPb.range="SourceItemType.Range";this.VPb.art="SourceItemType.Art"}serializeSourceItem(Da){const Cb={};if(Da&&Object.getType(Da)===E)Cb.sheetName=Da.sheetName,Cb.topArray=kb.a.map(Da.ranges,Zb=>Zb.top),Cb.leftArray=kb.a.map(Da.ranges,Zb=>Zb.left),Cb.bottomArray=kb.a.map(Da.ranges,Zb=>Zb.bottom),Cb.rightArray=kb.a.map(Da.ranges,Zb=>Zb.right),Cb.sessionStateId=
Da.sessionStateId,Cb.sessionId=Da.sessionId,Cb.sourceItemType=this.U6f(0);else if(Da&&Object.getType(Da)===M)Cb.activeFloatingObjectControlId=Da.activeFloatingObjectControlId,Cb.sheetName=Da.sheetName,Cb.sessionStateId=Da.sessionStateId,Cb.sessionId=Da.sessionId,Cb.floatingObjectType=this.fCj(Da.type),Cb.sourceItemType=this.U6f(1);else return f.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Cb)}serializeCommandParameters(Da){if(!Da)return f.ULS.shipAssertTag(537167704,
0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const Cb={};Cb.id=Da.id;Cb.commandType=Da.commandType;Cb.copyPasteTargetType=Da.copyPasteTargetType;Da.ribbonCommandInfo&&(Cb.ribbonCommandName=this.pCj(Da.ribbonCommandInfo.command),Cb.inputMethodName=this.jCj(Da.ribbonCommandInfo.method),Cb.frameModeName=this.hCj(Da.ribbonCommandInfo.mode),Cb.uiLocationName=this.tCj(Da.ribbonCommandInfo.af),Cb.tabName=Da.ribbonCommandInfo.tabName);return JSON.stringify(Cb)}deserializeSourceItem(Da){if(!Da)return null;
try{const Cb=JSON.parse(Da);if(!Cb)return f.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;let Zb=null;switch(this.Sph(Cb.sourceItemType)){case 0:Zb=new E(this.$,this.Pph(Cb),Cb.sheetName,Cb.sessionStateId,Cb.sessionId);break;case 1:Zb=new M(Cb.activeFloatingObjectControlId,Cb.sheetName,Cb.sessionStateId,Cb.sessionId,this.Mph(Cb.floatingObjectType))}return Zb}catch(Cb){return f.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${Da?
Da.length:0}, errror: ${Cb}`),null}}deserializeCommandParameters(Da){if(!Da)return null;try{const Cb=JSON.parse(Da);if(!Cb)return f.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const Zb=Ca.a();Zb.id=Cb.id;Zb.ribbonCommandInfo=this.Rph(Cb);Zb.commandType=Cb.commandType;Zb.copyPasteTargetType=Cb.copyPasteTargetType;return Zb}catch(Cb){return f.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${Da?
Da.length:0}, errror: ${Cb}`),null}}Pph(Da){const Cb=[];f.ULS.shipAssertTag(537167699,0,!!Da.topArray&&0<Da.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${Da.topArray?"empty":"null"}.`);f.ULS.shipAssertTag(537167698,0,!!Da.leftArray&&0<Da.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${Da.leftArray?"empty":"null"}.`);f.ULS.shipAssertTag(537167697,0,!!Da.bottomArray&&0<Da.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${Da.bottomArray?
"empty":"null"}.`);f.ULS.shipAssertTag(537167696,0,!!Da.rightArray&&0<Da.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${Da.rightArray?"empty":"null"}.`);if(!(Da.topArray&&Da.leftArray&&Da.bottomArray&&Da.rightArray))return Cb;f.ULS.shipAssertTag(537167695,0,Da.topArray.length===Da.bottomArray.length&&Da.topArray.length===Da.leftArray.length&&Da.topArray.length===Da.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${Da.topArray.length}), BottomArray(${Da.bottomArray.length}), LeftArray(${Da.leftArray.length}), RightArray(${Da.rightArray.length}) should be the same.`);
const Zb=Math.min(Da.topArray.length,Da.bottomArray.length,Da.leftArray.length,Da.rightArray.length);for(let yc=0;yc<Zb;yc++)Cb.push(new x.Range(Da.topArray[yc],Da.leftArray[yc],Da.bottomArray[yc],Da.rightArray[yc],!1,!1));return Cb}Rph(Da){return new Nb.a(this.Qph(Da.ribbonCommandName),this.Oph(Da.inputMethodName),this.Nph(Da.frameModeName),this.Uph(Da.uiLocationName),Da.tabName)}pCj(Da){return void 0!==Da&&null!==Da&&Da.toString()in this.RQd?this.RQd[Da.toString()]:(f.ULS.shipAssertTag(537167694,
0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${Da}`),this.RQd["-911352779"])}Qph(Da){return Da&&Da in this.agg?this.agg[Da]:(f.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${Da}`),-911352779)}jCj(Da){return void 0!==Da&&null!==Da&&r.a[Da]in this.Rla?
this.Rla[r.a[Da]]:(f.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${Da}`),this.Rla.unknown)}Oph(Da){return Da&&Da in this.$fg?this.$fg[Da]:(f.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${Da}`),0)}hCj(Da){return void 0!==Da&&null!==Da&&Tb.a[Da]in this.k5a?this.k5a[Tb.a[Da]]:(f.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${Da}`),
this.k5a.edit)}Nph(Da){return Da&&Da in this.Zfg?this.Zfg[Da]:(f.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${Da}`),2)}U6f(Da){return void 0!==Da&&null!==Da&&$a[Da]in this.VPb?this.VPb[$a[Da]]:(f.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${Da}`),this.VPb.range)}Sph(Da){return Da&&Da in this.bgg?this.bgg[Da]:(f.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${Da}`),
0)}fCj(Da){return void 0!==Da&&null!==Da&&Da.toString()in this.b1c?this.b1c[Da.toString()]:(f.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${Da}`),this.b1c["99"])}Mph(Da){return Da&&Da in this.Yfg?this.Yfg[Da]:(f.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${Da}`),99)}tCj(Da){return void 0!==Da&&null!==Da&&u.a[Da]in this.Wr?this.Wr[u.a[Da]]:(f.ULS.shipAssertTag(36229129,
0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${Da}`),this.Wr.ribbon)}Uph(Da){return Da&&Da in this.cgg?this.cgg[Da]:(f.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${Da}`),2)}}Object(c.a)(Ra,"EnvironmentSerializationHelper",null,[]);class ob{}ob.o4f="SameSession";ob.l9c="CrossSession";ob.htf="LegacyCrossSession";ob.external="External";Object(c.a)(ob,"PayloadOrigin",null,[]);const mb=Da=>Da?Da.shadowWorkbookSizeExceedsLimit&&
void 0!==Da.shadowWorkbookBlockedSize&&null!==Da.shadowWorkbookBlockedSize?Da.shadowWorkbookBlockedSize:Da.shadowWorkbookBase64?Da.shadowWorkbookBase64.length:0:0,gb=Da=>Da.shadowWorkbookSizeExceedsLimit?!0:mb(Da)>n.a.$oc;class lb{constructor(Da,Cb){this._name=Cb;this.$=Da;this.rm=y.a.instance;this.Gn=new sc(Da,Y.h(Da))}get name(){return this._name}get e1c(){return this.rm.Va(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}z2j(Da){let Cb;
Cb=null;try{const Zb=Da.getItem(N.shadowWorkbook);if(!Zb)return{returnValue:!1,BX:Cb};Cb=JSON.parse(Zb);return{returnValue:this.YBi(Cb),BX:Cb}}catch(Zb){return f.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+Zb),{returnValue:!1,BX:Cb}}}YBi(Da){return!!Da&&(!!Da.shadowWorkbookBase64||Da.shadowWorkbookSizeExceedsLimit)&&void 0!==Da.rangeRowStart&&void 0!==Da.rangeRowEnd&&void 0!==Da.rangeColumnStart&&void 0!==Da.rangeColumnEnd}Itc(Da){Da.wasLastCopyExternal=
!0;w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&Da.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(Da.commandParameters.commandType=-185374993===this.$.shortcutKeyManager.j9b?20:4);if(w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!h.a.vB&&516!==Da.commandParameters.commandType&&1028!==Da.commandParameters.commandType){var Cb=null;if(({BX:Cb}=this.z2j(Da.clipboardItems)).returnValue)return Da.isShadowWorkbookParsedSuccessfully=
!0,this.h$i(Da,Cb)}if(516!==Da.commandParameters.commandType&&36!==Da.commandParameters.commandType){if(w.EwaSettings.ya(151)&&20!==Da.commandParameters.commandType&&(Cb=Da.clipboardItems.getItem(N.html),void 0!==Cb&&null!==Cb&&Cb&&Cb.trim()!==this.e1c&&(Cb.startsWith("<")||h.a.Nf&&Cb.startsWith("\n<")))){const Zb=Da.clipboardItems.getItem(N.Mtb);return this.f$i(Da,Cb,void 0===Zb?null:Zb)}return this.GPf(Da)}return Promise.reject(new Ib.a(6))}h$i(Da,Cb){f.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");
Da.pasteResult="SystemClipboardShadowWorkbookPaste";Da.payloadType=T.shadowWorkbook;Da.payloadOrigin=ob.external;Da.shadowWorkbookPayloadSize=mb(Cb);Da.shadowWorkbookSizeExceedsLimit=gb(Cb);let Zb=null,yc=null;const Vc=Da.commandParameters.originalDestinations;w.EwaSettings.getBooleanFeatureGate(X.a.vub,!1)?Zb=P.r(Vc,this.$):yc=P.v(P.L(Vc),this.$);Cb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Da.originalSourceRangesCountExceedsLimit=Cb.originalSourceRangesCountExceedsLimit);if(Da.shadowWorkbookSizeExceedsLimit)return f.ULS.sendTraceTag(537167833,
0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${Da.shadowWorkbookPayloadSize}) is over the limit(${n.a.$oc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Cb.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new Ib.a(1));f.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${Da.commandParameters.id}`);return this.Gn.KPf(Da.commandParameters.ribbonCommandInfo,yc,Zb,Cb,
[Da.commandParameters.stopwatch],Da)}GPf(Da){var Cb=Da.clipboardItems.getItem(N.plainText);if(void 0!==Cb&&null!==Cb&&Cb.trim()===this.e1c)return Promise.reject(new Ib.a(7));void 0!==Cb&&null!==Cb&&(Da.plainTextPayloadSize=Cb.length);Da.isPlainTextPaste=!0;Da.pasteResult="SystemClipboardPaste";Da.payloadOrigin=U(Da)?ob.htf:ob.external;Da.payloadType=T.plainText;f.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${Da.id}, PasteOperationId=${Da.commandParameters.id}`);
Cb=this.Gn.wej(P.L(Da.commandParameters.originalDestinations),Cb,Da.commandParameters.ribbonCommandInfo,[Da.commandParameters.stopwatch],Da);f.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${Da.id}`);return Cb}f$i(Da,Cb,Zb){Da.htmlPayloadSize=Cb.length;Da.isHtmlPaste=!0;Da.pasteResult="SystemClipboardHtmlPaste";Da.payloadType=T.html;Da.payloadOrigin=U(Da)?ob.htf:ob.external;f.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${Da.commandParameters.id}`);
return this.Gn.vej(P.L(Da.commandParameters.originalDestinations),Cb,Zb,Da.commandParameters.id,Da.commandParameters.ribbonCommandInfo,[Da.commandParameters.stopwatch],Da)}NLe(Da){const Cb={};Da&&(Cb.shadowWorkbookBase64=Da.ShadowWorkbookBase64,Cb.shadowWorkbookSizeExceedsLimit=Da.ShadowWorkbookSizeExceedsLimit,Cb.originalSourceRangesCountExceedsLimit=Da.OriginalSourceRangesCountExceedsLimit,Cb.originalSourceRangesCount=Da.OriginalSourceRangesCount,Cb.shadowWorkbookBlockedSize=Da.ShadowWorkbookBlockedSize);
return Cb}Spg(Da,Cb){const Zb=I(Da),yc=32===(Da.commandParameters.commandType&32),Vc=1024===(Da.commandParameters.commandType&1024);let jd=!1,ld=null,Bd=null,Td=!1;if(!Zb){jd=-1985798686===Da.commandParameters.ribbonCommandInfo.command;var Jd=Da.copyContextSnapshot;if(Cb)Td=!Jd.sourceItem.isFromCurrentSession(this.$);else if(Jd=this.Gn.p6a(Jd))ld=Jd.ranges,Bd=Jd.sheetName,Td=!Da.isSameSession}return this.Gn.mXg(Bd,ld,this.$.na.sheetName,Da.commandParameters.originalDestinations,Da.commandParameters.expandDestinations,
Td,yc,Vc,jd,Cb,Zb)}}Object(c.a)(lb,"BaseCopyPasteHandler",null,[733,734,735]);class Xb{constructor(Da){this.clipboardItems=this.key=null;this.Oaa=Da}fxa(Da){return this.key&&this.key.isEqual(Da)?this.createClipboardItems(this.clipboardItems):null}setValue(Da,Cb){this.key=Da;this.clipboardItems=this.createClipboardItems(Cb)}createClipboardItems(Da){const Cb=this.Oaa.create();var Zb=Da.getItem(N.plainText);Zb&&Cb.setItem(N.plainText,Zb);(Zb=Da.getItem(N.shadowWorkbook))&&Cb.setItem(N.shadowWorkbook,
Zb);(Da=Da.getItem(N.html))&&Cb.setItem(N.html,Da);return Cb}}Object(c.a)(Xb,"CopyCache",null,[]);var Xd=a(71);class Qd extends lb{constructor(Da,Cb,Zb,yc,Vc=null){super(Da,yc);this.Keh=Cb;this.Oaa=Zb;this.u7c=Vc||new Xb(this.Oaa);this.gridView=Y.h(Da);this.ga=this.gridView.ga;this.clipboardRangeFactory=Da.da.Aa(169)}getSourceItem(){const Da=P.d(this.gridView.ga.qa.selectedRanges);return new E(this.$,Da,this.$.ea.na.sheetName,this.$.ea.Ee,this.$.xa.UserSessionId)}beforeSerialize(Da){Da.isSelectionAllowed=
!1;Da.isAsyncCopy=!1;Da.isFromCache=!1;Da.encounteredDeploymentErrors=!1;Da.plainTextPayloadSize=0;Da.shadowWorkbookPayloadSize=0;Da.htmlPayloadSize=0;Da.clientSideCopyTime=0;const Cb=new pa.a(this.$.ua),Zb=Da.sourceItem;Da.isSelectionAllowed=kb.a.all(Zb.ranges,yc=>this.isSelectionAllowed(Cb,yc));Da.isSelectionAllowed&&this.Gn.Bff(Zb.ranges,Da.commandParameters.commandType)}xOa(Da){return this.gridView.Ca.T5()&&Y.j(this.gridView,Da)}H$i(Da,Cb,Zb,yc){let Vc=!1,jd=1===Cb.commandParameters.commandType,
ld=yc[0].Cw;1===Zb.ranges.length&&1===yc.length?w.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&jd&&1!==ld&&ld!==Zb.ranges[0].Cw?Da.cseStatus=17:Vc=this.Keh.zad(Da,P.L(Zb.ranges),Zb.sheetName,P.L(Da.commandParameters.expandDestinations),this.$.ea.na.sheetName,jd):Da.cseStatus=5;Vc&&Y.h(this.$).nh.IS(Da.commandParameters.stopwatch.id,Xd.BasicTelemetryCalculator.pR);return this.o$i(Da,Zb,P.u(this.$.na.sheetName,null,yc),Cb.commandParameters.commandType,Vc)}isSelectionAllowed(Da,
Cb){return Da.FDb(Cb,this.gridView)}o$i(Da,Cb,Zb,yc,Vc){Cb=P.u(Cb.sheetName,null,Cb.ranges);Da.pasteResult="SameSessionPaste";Da.payloadOrigin=ob.o4f;Da.payloadType=T.GLg;f.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${Da.commandParameters.id}`);return this.Gn.pasteRange(Da.commandParameters.ribbonCommandInfo,Cb,Zb,yc,Da.commandParameters.commandType,[Da.commandParameters.stopwatch],Da,Vc,null,null)}}Object(c.a)(Qd,"BaseRangeCopyPasteHandler",
lb,[]);var te=a(37);class Pc{constructor(Da){this.SU=new te.a(!0);this.$=Da}onDeferredPasteStarted(Da){this.SU.nb(Da.id)||this.SU.add(Da.id,!0);if(0<this.SU.count){const Cb=Object(ib.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(aa.d)(Ub.a.resolve(hc.f,{rb:0})):qa.GetServiceTaskFactory.Sa(this.$.da,5,4,0);ya.TaskExtensions.za(Cb,()=>{Cb.result.eh(28,null)},this.$.ka,3)}}onDeferredPasteCompleted(Da){const Cb=0<this.SU.count;this.SU.nb(Da.id)&&this.SU.remove(Da.id);if(Cb&&!this.SU.count){const Zb=
Object(ib.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(aa.d)(Ub.a.resolve(hc.f,{rb:0})):qa.GetServiceTaskFactory.Sa(this.$.da,5,4,0);ya.TaskExtensions.za(Zb,()=>{Zb.result.removeEntry(28)},this.$.ka,3)}}}Object(c.a)(Pc,"DeferredPasteTracker",null,[]);var Ne;(function(Da){Da[Da.none=0]="none";Da[Da.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";Da[Da.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";Da[Da.asyncCopyCanceled=3]="asyncCopyCanceled";
Da[Da.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(Ne||(Ne={}));Object(c.b)("CopyErrorType",Ne);var Hb=a(965),pb=a(1164);class mc extends Hb.a{constructor(Da,Cb=null){super(Ne[Da]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=Da;this.ewaErrors=Cb;if(null===Cb||void 0===Cb?0:Cb.length)this.innerError=new pb.a(Cb,null)}}Object(c.a)(mc,"CopyInnerError",Hb.a,[]);var Kc=a(125);class Nc extends Qd{constructor(Da,Cb,Zb,yc=null){super(Da,Cb,Zb,"AcrossSessionRangeCopyPasteHandler",
yc);this.SU=new Pc(Da)}serialize(Da){const Cb=Da.sourceItem,Zb={};let yc=this.u7c.fxa(Cb);if(yc)Zb.synchronousResult=yc,Da.isFromCache=!0,Da.clientSideCopyTime=Da.commandParameters.stopwatch.Jc;else{let jd=null;var Vc=P.G(Cb.ranges);if(!Fa.a.vmf()&&this.xOa(Vc)){f.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Vc=this.clipboardRangeFactory.create(Vc);try{jd=Vc.toString(),yc=this.Oaa.create(),yc.setItem(N.plainText,
jd),this.u7c.setValue(Cb,yc),Zb.synchronousResult=yc,Da.clientSideCopyTime=Da.commandParameters.stopwatch.Jc}finally{Vc&&Vc.dispose()}}else Da.isAsyncCopy=!0,Zb.synchronousResult=this.Oaa.create(),Zb.synchronousResult.setItem(N.plainText,this.e1c);Zb.asynchronousResult=this.gid(Da,Cb,jd)}Da.syncClipboardItemsKeys=bb(Zb.synchronousResult);return Zb}shouldWaitForCopyToComplete(Da){if(!Da||!Da.copyContextSnapshot)return f.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),
!1;f.ULS.shipAssertTag(537167906,0,!!this.$.xa,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(Da.copyContextSnapshot.sessionId===this.$.xa.UserSessionId)return f.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;f.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(Da){this.SU.onDeferredPasteStarted(Da)}onDeferredPasteCompleted(Da){this.SU.onDeferredPasteCompleted(Da)}deserialize(Da){Da.isClipboardDataContainShadowWorkbook=
!(void 0===Da.clipboardItems.getItem(N.shadowWorkbook)||null===Da.clipboardItems.getItem(N.shadowWorkbook));if(Y.h(this.$).ga.Se&326)return I(Da)&&(Da.wasLastCopyExternal=!0),Promise.reject(new Ib.a(17));var Cb=this.Spg(Da,!1);if(0!==Cb)return Promise.reject(new Ib.a(I(Da)?18:Da.isSameSession?19:20,void 0,void 0,void 0,Cb));var Zb=Da.copyContextSnapshot,yc=this.Gn.p6a(Zb);if(I(Da))return this.Itc(Da);Cb=Da.commandParameters.originalDestinations;if(yc&&Da.isSameSession)return this.H$i(Da,Zb,yc,Cb);
if(516!==Da.commandParameters.commandType){if(({BX:Zb}=this.Qkg(Da.clipboardItems)).returnValue){Da.isShadowWorkbookParsedSuccessfully=!0;let Vc=yc=null;w.EwaSettings.getBooleanFeatureGate(X.a.vub,!1)?yc=P.r(Cb,this.$):Vc=P.v(P.L(Cb),this.$);return this.d$i(Da,Vc,yc,Zb)}if(Da.isClipboardInaccessible)return Promise.reject(new Ib.a(8));if(36!==Da.commandParameters.commandType)return this.GPf(Da)}return Promise.reject(new Ib.a(6))}beforePaste(Da){this.$.da.Aa(373).bzj(Da);Da.indicationDisplayScheduled=
!0}R1j(Da){let Cb;if(!(Da&&Da.SourceRanges&&Da.SourceRanges.Ranges&&Da.SourceRanges.Ranges.length&&(Da.OriginalSourceRangesCountExceedsLimit||Da.OriginalSourceMultiRange&&Da.OriginalSourceMultiRange.Ranges&&Da.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,BX:null};var Zb=Da.SourceRanges.Ranges[0];if(!Da.ShadowWorkbookBase64&&!Da.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,BX:null};Cb=this.NLe(Da);Cb.rangeRowStart=Zb.FirstRow;Cb.rangeRowEnd=Zb.LastRow;Cb.rangeColumnStart=
Zb.FirstColumn;Cb.rangeColumnEnd=Zb.LastColumn;Cb.sourceClientPath=Da.SourceClientPath;Cb.sourceSheetName=Da.SourceSheetName;Cb.sourceWorkbookName=Da.SourceWorkbookName;if(!Da.OriginalSourceRangesCountExceedsLimit)for(Da=Da.OriginalSourceMultiRange.Ranges,Cb.originalSourceRanges=Array(Da.length),Zb=0;Zb<Da.length;++Zb)Cb.originalSourceRanges[Zb]=[Da[Zb].FirstRow,Da[Zb].FirstColumn,Da[Zb].LastRow,Da[Zb].LastColumn];return{returnValue:!0,BX:Cb}}Qkg(Da){let Cb;Cb=null;Da=Da.getItem(N.shadowWorkbook);
if(!Da)return{returnValue:!1,BX:Cb};Cb=JSON.parse(Da);return{returnValue:this.XBi(Cb),BX:Cb}}XBi(Da){return!!Da&&(!!Da.shadowWorkbookBase64||Da.shadowWorkbookSizeExceedsLimit)&&void 0!==Da.rangeRowStart&&void 0!==Da.rangeRowEnd&&void 0!==Da.rangeColumnStart&&void 0!==Da.rangeColumnEnd}d$i(Da,Cb,Zb,yc){f.ULS.shipAssertTag(537167903,0,!!yc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");v.AFrameworkApplication.JR("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");
Da.pasteResult="CrossSessionPaste";Da.payloadOrigin=ob.l9c;Da.payloadType=T.shadowWorkbook;Da.shadowWorkbookPayloadSize=mb(yc);Da.shadowWorkbookSizeExceedsLimit=gb(yc);yc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Da.originalSourceRangesCountExceedsLimit=yc.originalSourceRangesCountExceedsLimit);if(Da.shadowWorkbookSizeExceedsLimit)return f.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${Da.shadowWorkbookPayloadSize}) is over the limit(${n.a.$oc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${yc.shadowWorkbookSizeExceedsLimit}`),
Promise.reject(new Ib.a(1));if(1028===Da.commandParameters.commandType&&Da.originalSourceRangesCountExceedsLimit)return f.ULS.sendTraceTag(572617859,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${yc.originalSourceRangesCount}) is over the limit(${n.a.LMi}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${yc.originalSourceRangesCountExceedsLimit}`),Promise.reject(new Ib.a(1));f.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${Da.commandParameters.id}`);
return this.Gn.KPf(Da.commandParameters.ribbonCommandInfo,Cb,Zb,yc,[Da.commandParameters.stopwatch],Da)}gid(Da,Cb,Zb){f.ULS.shipAssertTag(537167901,0,!!Da,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const yc=Da.commandParameters.stopwatch.Jc,Vc=P.u(Cb.sheetName,null,Cb.ranges);return new Promise((jd,ld)=>{f.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${Da.id}`);
this.Gn.copy(Vc,Da.commandParameters,Bd=>{Da.requestTelemetryData=Bd.RequestTelemetryData;Da.serverRequestTimeInMs=Da.commandParameters.stopwatch.Jc-yc;if(Pa.a.lg(Bd.Errors))if(Pa.a.hia(Bd.Errors))Da.encounteredDeploymentErrors=!0,Bd=Pa.a.xc(Bd.Errors),f.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Bd}. copy Id: ${Da.id}`);else{var Td=Pa.a.xc(Bd.Errors),Jd=[-591377245];
if(X.a.Ieh&&Pa.a.fh(Bd.Errors,Jd)&&(Jd=this.Rw(Vc))){Jd=String.format(this.rm.qb(218),Jd.toLocaleUpperCase());var ce=Kc.d(Bd.Errors,we=>-591377245===we.MessageId);Bd.Errors[ce].Description=Jd;f.ULS.sendTraceTag(509125507,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${Da.id}`)}f.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Td}. copy Id: ${Da.id}`);
ld(new mc(2,Bd.Errors))}else if(f.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${Da.id}`),Da.markForCancellation)ld(new mc(3,Bd.Errors));else{Td=Bd.Result;ce=Td.PlainTextResult;void 0!==Zb&&null!==Zb&&(ce=Zb);void 0!==ce&&null!==ce&&(Da.plainTextPayloadSize=ce.length);Jd=this.Oaa.create();if(({BX:ie}=this.R1j(Td)).returnValue){Da.shadowWorkbookPayloadSize=mb(ie);Da.shadowWorkbookSizeExceedsLimit=gb(ie);Da.originalSourceRangesCountExceedsLimit=
Td.OriginalSourceRangesCountExceedsLimit;var ie=JSON.stringify(ie);Jd.setItem(N.shadowWorkbook,ie)}Jd.setItem(N.plainText,ce);Fa.a.vmf()&&(ce=Td.HtmlResult,Da.htmlSizeExceedsLimit=Td.HtmlSizeExceedsLimit,void 0!==ce&&null!==ce&&(Da.htmlPayloadSize=ce.length),Jd.setItem(N.html,ce));Da.copyTotalSizeExceedsLimit=Td.CopyTotalSizeExceedsLimit;Jd.setItem(N.Mtb,Da.commandParameters.id);this.u7c.setValue(Cb,Jd);Da.asyncClipboardItemsKeys=bb(Jd);jd(Jd);w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!1)&&(Td=1===Da.commandParameters.commandType?8:7,(Jd=this.$.da.Aa(465))&&Jd.e9(Td,Bd))}},Bd=>{Da.serverRequestTimeInMs=Da.commandParameters.stopwatch.Jc-yc;Bd=K.a.Ye(Bd.data);const Td=Pa.a.xc(Bd);f.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Td}. copy Id: ${Da.id}`);ld(new mc(2,Bd))},[Da.commandParameters.stopwatch])})}Rw(Da){return null==Da||null==Da.Ranges||0===Da.Ranges.length?(f.ULS.sendTraceTag(509125506,
0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===Da.Ranges.length?P.C(Da.Ranges[0]):P.G(P.g(Da.Ranges))).toString()}}Object(c.a)(Nc,"AcrossSessionRangeCopyPasteHandler",Qd,[]);class pd{constructor(Da,Cb,Zb,yc,Vc,jd=null,ld=null){this.floatingObjectId=Da;this.commandParameters=Cb;this.gu=Zb;this.bnh=yc;this.Oba=jd;this.lSb=ld;this.zeh=Vc}}Object(c.a)(pd,"CopyArtRequest",null,[]);class Vd{constructor(Da,Cb,Zb,yc,Vc,jd,ld,Bd,Td){this.promise=null;this.ribbonCommandInfo=
Da;this.destination=Cb;this.rOe=Zb;this.lSb=Vc;this.BX=jd;this.item=ld;this.pasteContext=Bd;this.GPa=Zb||Cb.FirstRow+"_"+Cb.FirstColumn;this.Smf=!0;this.LFe=Td}}Object(c.a)(Vd,"PasteArtRequest",null,[]);class $d{constructor(Da,Cb){this.pMb=new ma.a;this.z0a=Da;this.$=Cb;this.Xej=Zb=>Promise.resolve(Zb);this.oIb=Zb=>Promise.reject(Zb)}cfi(Da){if(this.zxi(Da.GPa)){f.ULS.sendTraceTag(537167681,5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${Da.GPa}`);
const Cb=this.pMb.ma(Da.GPa);this.pMb.ia(Da.GPa,Da);const Zb=Cb.promise;Cb.Smf=!1;return this.Owh(Da,Zb)}this.pMb.ia(Da.GPa,Da);return this.NEi(Da)}zxi(Da){return this.pMb.nb(Da)}NEi(Da){return new Promise((Cb,Zb)=>{Da.promise=this.z0a.FPf(Da).then(yc=>{Cb(null);return this.qsc(Da,yc)},yc=>{Zb(null);return this.oIb(yc)})})}Owh(Da,Cb){return new Promise((Zb,yc)=>{Da.promise=Cb.then(Vc=>{this.T7j(Da,Vc);return this.z0a.FPf(Da).then(jd=>{Zb(null);return this.qsc(Da,jd)},jd=>{yc(null);return this.oIb(jd)})},
Vc=>this.oIb(Vc))})}qsc(Da,Cb){Da.Smf&&(this.m9g(Da.GPa),this.jSd(Da,Cb));return this.Xej(Cb)}m9g(Da){this.pMb.remove(Da)}jSd(Da,Cb){const Zb=this.P7h();Da.GPa===Zb&&this.z0a.jSd(Da.destination,Cb,Da.item.type)}P7h(){var Da=Y.h(this.$).ga.Ra.activeFloatingObjectControlId;Da||(Da=P.v(Y.h(this.$).ga.qa.activeCell,this.$),Da=Da.FirstRow+"_"+Da.FirstColumn);return Da}T7j(Da,Cb){Da.destination=null;Da.rOe=Cb}}Object(c.a)($d,"PasteArtRequestManager",null,[]);var ue=a(208),he=a(132),Ge=a(110);class Ad extends lb{constructor(Da,
Cb,Zb,yc,Vc=null){super(Da,"ArtCopyPasteHandler");this.g$g="XLO";this.h$g="3";this.SU=new Pc(Da);this.Oaa=Cb;this.z0a=Zb;this.ga=Y.h(Da).ga;this.t7c=Vc||new Xb(this.Oaa);this.e$i=new $d(Zb,Da);this.brb=yc}getSourceItem(){f.ULS.shipAssertTag(537167896,0,!!this.ga.Ra.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");f.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ga.Ra.activeFloatingObjectControlId}]`);
return new M(this.ga.Ra.activeFloatingObjectControlId,this.$.ea.na.sheetName,this.$.ea.Ee,this.$.xa.UserSessionId,this.ga.Ra.oc.floatingObject.type)}beforeSerialize(Da){Da&&Da.commandParameters?(Da?(Da.isAsyncCopy=!1,Da.isSelectionAllowed=!1,Da.isFromCache=!1,Da.plainTextPayloadSize=0,Da.shadowWorkbookPayloadSize=0,Da.htmlPayloadSize=0,Da.htmlSizeExceedsLimit=!1,Da.clientSideCopyTime=0,Da.encounteredDeploymentErrors=!1,Da.shadowWorkbookSizeExceedsLimit=!1,Da.originalSourceRangesCountExceedsLimit=
!1,Da.copyTotalSizeExceedsLimit=!1):f.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),Da.commandParameters.copyPasteTargetType=2):f.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(Da){const Cb=Da.sourceItem,Zb={};if(!Cb)return f.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Zb;if(!this.GAi())return f.ULS.sendTraceTag(36824456,
0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),Zb;f.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${Cb.activeFloatingObjectControlId}]`);this.uJd();let yc=this.t7c.fxa(Cb);if(yc)Zb.synchronousResult=yc,Da.isFromCache=!0,Da.isAsyncCopy=!1,Da.clientSideCopyTime=Da.commandParameters.stopwatch.Jc,1===Da.commandParameters.commandType&&this.$.Xc(2045211913,Da.commandParameters.ribbonCommandInfo.method,
Da.commandParameters.ribbonCommandInfo.af,null);else{Da.isFromCache=!1;Da.isAsyncCopy=!0;yc=this.Oaa.create();if(Da.commandParameters.uploadToClipService){const Vc={};Vc["data-clipservice-ccpid"]=Da.commandParameters.id;Vc["data-pkey"]=Da.commandParameters.pKey;Vc["data-clipservice-type"]=Da.commandParameters.clipServiceDataType;Vc["data-clipservice-count"]=Da.commandParameters.objectCount.toString();Vc["data-clipservice-dc"]=Da.commandParameters.clipServiceDataCenter;Vc["data-clipservice-client"]=
this.g$g;Vc["data-TimeStamp"]=(new Date).toUTCString();Vc["data-clipservice-version"]=this.h$g;yc.setItem(N.PTg,JSON.stringify(Vc))}Zb.synchronousResult=this.nNg(yc);Zb.asynchronousResult=this.gid(Da,Cb,yc)}Da.syncClipboardItemsKeys=bb(Zb.synchronousResult);return Zb}nNg(Da){f.ULS.shipAssertTag(537167891,0,!!this.ga.Ra.oc,"Expecting a floating object to be currently selected for copy");Da||(Da=this.Oaa.create());const Cb=this.ga.Ra.oc.Exb();Cb&&Da.setItem(N.html,`<img src='${Cb}'>`);return Da}uJd(){const Da=
this.ga.Ra.oc;this.brb.uJd(he.a.Zsb(Da.floatingObject),he.a.j$g(Da.Qq))}shouldWaitForCopyToComplete(){f.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(Da){this.SU.onDeferredPasteStarted(Da)}onDeferredPasteCompleted(Da){this.SU.onDeferredPasteCompleted(Da)}deserialize(Da){var Cb=I(Da),Zb=null;let yc=null;var Vc=!1;if(!Cb){Zb=Da.copyContextSnapshot;yc=Zb.sourceItem;if(!yc)return Promise.reject(new Ib.a(10));Vc=yc.isFromCurrentSession(this.$)}var jd=
this.Spg(Da,!0);if(0!==jd)return Promise.reject(new Ib.a(Cb?18:Vc?19:20,void 0,void 0,void 0,jd));if(Cb)return this.Itc(Da);if(!Vc&&!Ad.Usi(yc))return Da=`User attempted to paste art of type [${yc.type}] between sessions.`,f.ULS.sendTraceTag(537167889,0,50,Da),Promise.reject(new Ib.a(11,void 0,void 0,Da));if(Zb.isAsyncSerializeFailed)return Promise.reject(new Ib.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let ld;try{const Bd=Da.clipboardItems.getItem(N.shadowWorkbook);
ld=JSON.parse(Bd)}catch(Bd){return Da=copyPasteInfra.getStringifiedError(Bd),f.ULS.sendTraceTag(537167888,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${Da}`),Promise.reject(new Ib.a(12,void 0,Bd))}ld.floatingObjectId!==yc.activeFloatingObjectControlId?f.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${yc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${ld.floatingObjectId}]`):
f.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${yc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${ld.floatingObjectId}]`);if(!ld||!ld.shadowWorkbookBase64)return Promise.reject(new Ib.a(13,void 0,void 0,`shadowWorkbookPayload is null = ${!ld}`));Da.isShadowWorkbookParsedSuccessfully=!0;Da.shadowWorkbookPayloadSize=mb(ld);Da.shadowWorkbookSizeExceedsLimit=gb(ld);Da.payloadOrigin=Vc?ob.o4f:
ob.l9c;Da.payloadType=T.Dtg;if(gb(ld))return Da=`Shadow workbook size [${Da.shadowWorkbookPayloadSize}] is over the limit [${n.a.$oc}]. ShadowWorkbookSizeExceedsLimit: ${ld.shadowWorkbookSizeExceedsLimit}`,f.ULS.sendTraceTag(36304156,0,15,`ArtCopyPasteHandler.Deserialize: ${Da}`),Promise.reject(new Ib.a(1,void 0,void 0,Da));Zb=Cb=null;Y.h(this.$).ga.Se&326?Zb=Y.h(this.$).ga.Ra.activeFloatingObjectControlId:Cb=this.$.na&&this.$.na.activeCell?P.v(this.$.na.activeCell,this.$):P.v(P.L(Da.commandParameters.originalDestinations),
this.$);Vc=null;if(this.brb.hbg(yc))try{Vc=this.brb.zad()}catch(Bd){jd=copyPasteInfra.getStringifiedError(Bd),f.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${jd}`)}return this.e$i.cfi(new Vd(Da.commandParameters.ribbonCommandInfo,Cb,Zb,Da.commandParameters.commandType,[Da.commandParameters.stopwatch],ld,yc,Da,Vc))}Itc(Da){Da.wasLastCopyExternal=!0;if(Da.clipboardItems.getItem("image/png")){const Cb=Da.commandParameters.stopwatch.Jc;
Da.payloadType=T.g_g;return aa.c(this.$.Xc(1403967063,Da.commandParameters.ribbonCommandInfo.method,Da.commandParameters.ribbonCommandInfo.af,{["dataUrl"]:Da.clipboardItems.getItem("image/png")})).then(Zb=>{Da.serverRequestTimeInMs=Da.commandParameters.stopwatch.Jc-Cb;return Zb?Promise.resolve(null):Promise.reject(new Ib.a(15))},()=>{Da.serverRequestTimeInMs=Da.commandParameters.stopwatch.Jc-Cb;return Promise.reject(new Ib.a(15))})}f.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");
return super.Itc(Da)}GAi(){const Da=Y.h(this.$).ga;return Da.Ra.activeFloatingObjectControlId&&Da.Ra.oc&&Da.Ra.oc.floatingObject?Da.Ra.oc.floatingObject.CZd():!1}gid(Da,Cb,Zb){return new Promise((yc,Vc)=>{const jd=Da.commandParameters.stopwatch.Jc;f.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.z0a.Beh(new pd(Cb.activeFloatingObjectControlId,Da.commandParameters,ld=>{Da.requestTelemetryData=ld.RequestTelemetryData;
Da.serverRequestTimeInMs=Da.commandParameters.stopwatch.Jc-jd;if(Pa.a.lg(ld.Errors))if(Pa.a.hia(ld.Errors))Da.encounteredDeploymentErrors=!0,ld=Pa.a.xc(ld.Errors),f.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${ld}`);else{var Bd=Pa.a.xc(ld.Errors);f.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Bd}`);Vc(new mc(4,
ld.Errors))}else if(f.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${Cb.activeFloatingObjectControlId}].`),Da.markForCancellation)Vc(new mc(3,ld.Errors));else{if(Pa.a.Jq(ld.Errors)){var Td=Pa.a.xc(ld.Errors);f.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${Td}`)}if(Td=ld.Result){Td=this.NLe(Td);Td.floatingObjectId=Cb.activeFloatingObjectControlId;
Da.shadowWorkbookPayloadSize=mb(Td);Da.shadowWorkbookSizeExceedsLimit=gb(Td);try{Bd=JSON.stringify(Td)}catch(Jd){Vc(new Ib.a(14,void 0,Jd,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${Da.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${Td.floatingObjectId}]`));return}f.ULS.shipAssertTag(537167881,0,!!Zb,"Expecting syncClipboardItems to be defined");Zb.setItem(N.shadowWorkbook,Bd);1===Da.commandParameters.commandType&&(this.Lcj(Cb.type,Cb.activeFloatingObjectControlId,
ld.StateId),this.deleteFloatingObject(Cb.activeFloatingObjectControlId,Cb.type));this.t7c.setValue(Cb,Zb);Da.asyncClipboardItemsKeys=bb(Zb);yc(Zb)}else f.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${Cb.activeFloatingObjectControlId}`),yc(this.t7c.fxa(Cb))}},Da.commandParameters.commandType,Cb.type,ld=>{Da.serverRequestTimeInMs=Da.commandParameters.stopwatch.Jc-jd;ld=K.a.Ye(ld.data);1===Da.commandParameters.commandType&&
this.z0a.B3j(Cb.type,Cb.activeFloatingObjectControlId);const Bd=Pa.a.xc(ld);f.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Bd}`);Vc(new mc(4,ld))},[Da.commandParameters.stopwatch]))})}deleteFloatingObject(Da,Cb){Da=ue.a.Az(Cb,Da);if(Da=Ge.a(this.$).Hr(Da))Ge.a(this.$).deleteFloatingObject(Da,14,!0),Y.h(this.$).ga.Ra.aB=null}Lcj(Da,Cb,Zb){const yc=this.$.da.Aa(277);if(yc){let jd=null;Da=ue.a.Az(Da,Cb);Da=Ge.a(this.$).Hr(Da);
if(null===Da||void 0===Da?0:Da.kj)jd=Da.kj.block;if(jd){var Vc=Da.floatingObject.lh();yc.d1b(()=>!jd.Wi.nb(Vc),Zb,"CutArt")}}}static Usi(Da){return 1===Da.type||5===Da.type}}Object(c.a)(Ad,"ArtCopyPasteHandler",lb,[]);var Ie=a(59);class me extends Ua{constructor(Da,Cb,Zb,yc){super(Da);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=Cb;this.top=Zb;this.left=yc}}Object(c.a)(me,"MacroRecorderPasteArtPayload",Ua,[]);class cc{constructor(Da,Cb){this.$=Da;this.brb=Cb}Hki(Da,
Cb,Zb,yc,Vc,jd=null,ld=null){const Bd=this.$.pa.va.ic();let Td=null;const Jd={CopyPasteTargetType:2};Jd.FloatingObjectId=Da;Jd.CopyOperationId=Zb.id;Zb.floatingObjectType=Cb;Jd.UploadToClipService=Zb.uploadToClipService;Jd.PKey=Zb.pKey;Jd.ClipServiceDataCenter=Zb.clipServiceDataCenter;let ce=0;2===Vc?(Vc=505,ce=16,Td=(ie,we,zc)=>Qa(this.$.pa.va,Jd,xa.b(ie,yc),jd?xa.a(we,jd):we,zc,Zb.ribbonCommandInfo,Bd,ld)):(Vc=179,Td=(ie,we,zc)=>{this.Osh(Cb,Da);this.$.Oy();return Z(this.$.pa.va,Jd,xa.b(ie,yc),
jd?xa.a(we,jd):we,zc,Zb.ribbonCommandInfo,Bd,ld)});this.$.userOperationManager.Tc(new Pb.a(Vc,0,Td,ce|64),Zb.ribbonCommandInfo)}Osh(Da,Cb){var Zb=ue.a.Az(Da,Cb);(Zb=Ge.a(this.$).Hr(Zb))?(Y.h(this.$).ga.Ra.wH(Zb),Zb.isVisible=!1):f.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${Da}, FloatingObjectId: ${Cb}`)}B3j(Da,Cb){Da=ue.a.Az(Da,Cb);if(Da=Ge.a(this.$).Hr(Da))Da.isVisible=!0}Beh(Da){this.Hki(Da.floatingObjectId,Da.zeh,
Da.commandParameters,Da.gu,Da.bnh,Da.Oba,Da.lSb)}jli(Da,Cb,Zb,yc,Vc,jd,ld,Bd=null,Td=!0){return new Promise((Jd,ce)=>{const ie=jd.commandParameters.stopwatch.Jc;this.GSd(Da,Vc,Cb,Zb,we=>{jd.requestTelemetryData=we.RequestTelemetryData;jd.serverRequestTimeInMs=jd.commandParameters.stopwatch.Jc-ie;if(Pa.a.hia(we.Errors))jd&&(jd.encounteredDeploymentErrors=!0),we=Pa.a.xc(we.Errors),f.ULS.sendTraceTag(537167875,0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${we}`);
else if(Pa.a.lg(we.Errors)){var zc=Pa.a.xc(we.Errors);f.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${zc}`);ce(new Ib.a(9,we.Errors))}else we.Result?(zc=we.Result,f.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.Xcj(ld,zc.FloatingObjectId,we.StateId),Jd(cc.Dpd(zc.FloatingObjectId))):(f.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),ce(new Ib.a(9,we.Errors)))},
we=>{jd.serverRequestTimeInMs=jd.commandParameters.stopwatch.Jc-ie;we=K.a.Ye(we.data);f.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Pa.a.xc(we)}`);ce(new Ib.a(9,we))},yc,Bd,Td)})}Xcj(Da,Cb,Zb){const yc=this.$.da.Aa(277);if(yc){const Vc=ue.a.Az(Da,cc.Dpd(Cb));yc.d1b(()=>!!Ge.a(this.$).Hr(Vc),Zb,"PasteArt")}}I1d(Da,Cb){Cb&&this.brb.I1d(Da,ue.a.Az(Da.type,Cb))}FPf(Da){return this.jli(Da.ribbonCommandInfo,Da.destination,Da.rOe,Da.lSb,Da.BX,Da.pasteContext,Da.item.type,
Da.LFe,Da.item.isFromCurrentSession(this.$)).then(Cb=>Cb,Cb=>{this.I1d(Da.item,Da.LFe);return Promise.reject(Cb)})}jSd(Da,Cb,Zb){Da||(Da=P.v(Y.h(this.$).ga.qa.activeCell,this.$));Y.h(this.$).vlc(P.E(Da),1)?Ge.a(this.$).Roa(Zb,Cb,!0):Y.h(this.$).ga.Ra.YIa(Da,Cb,Zb).continueWith(yc=>{yc.result?f.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${Cb}]`):f.ULS.sendTraceTag(537167842,5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${Cb}]`)})}GSd(Da,
Cb,Zb,yc,Vc,jd,ld,Bd,Td=!0){const Jd=this.$.pa.va.ic(),ce={};ce.ShadowWorkbookBase64=Cb.shadowWorkbookBase64;ce.FloatingObjectId=yc;ce.DestinationRanges=Zb?P.s(Zb):null;ce.CopyPasteTargetType=2;ce.ClientEstimationFloatingObjectId=Bd;Zb=new Pb.a(503,0,(ie,we,zc)=>{Bd||this.$.Oy();return wa(this.$.pa.va,ce,xa.b(ie,Vc),xa.a(we,jd),zc,null,Jd,ld)},void 0,()=>{if(Td){let ie;ie=Ie.a.ri(Ie.a.Fc(ce));ie.FloatingObjectId=Cb.floatingObjectId;ce.DestinationRanges||(ie.DestinationRanges=P.p(this.$.ua.na.sheetName,
"",0,0,0,0));return new me(ie,Td,0,0)}return new me(ce,Td,0,0)});Zb.flags=65;this.$.userOperationManager.Tc(Zb,Da)}static Dpd(Da){return`${Da.length+2}.{${Da.toUpperCase()}}`}}Object(c.a)(cc,"ArtCopyPasteUtils",null,[788]);var $c=a(203);class rd{constructor(Da){this.r7c=this.Kua=null;this.$bb=15;this.$=Da}uJd(Da,Cb){this.Kua=Da;this.r7c=Cb}zad(){if(!this.Kua||!this.r7c)return f.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";const Da=he.a.Zsb(new ue.a(this.Kua));Da.Id=cc.Dpd(l.a.create().toString());Da.Version=-1;Da.Name="";Da.IsClientEstimation=!0;var Cb=this.Ami(Da);if(!Cb)return null;const Zb=new ue.a(Da);Cb.block.Wi.add(Zb);Zb.uMb();const yc=Ge.a(this.$);yc.H7b(Zb,Cb);Cb=yc.Hr(ue.a.o0h(Da));!Cb||Cb.floatingObject.gOa||Cb.floatingObject.GOa||Cb.wTa(this.r7c);yc.Roa(Da.Type,Da.Id,!0);return Da.Id}hbg(Da){return w.EwaSettings.ya(205)&&Da.isFromCurrentSession(this.$)&&!Y.h(this.$).rtl&&!Y.h(this.$).lb.mj}I1d(Da,Cb){this.hbg(Da)&&
(Da=Ge.a(this.$).Hr(Cb))&&(f.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${Cb}] of type [${Da.floatingObject.type}]`),Ge.a(this.$).deleteFloatingObject(Da,15,!0),Da.kj&&Da.Hdb(Da.kj,!1))}Ami(Da){if(!Da)return f.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(Y.h(this.$).ga.Ra.activeFloatingObjectControlId){var Cb=
Y.h(this.$).ga.Ra.aB.floatingObject;Da.OriginDeltaX=Cb.offsetX+this.$bb;Da.OriginDeltaY=Cb.offsetY+this.$bb;Da.AbsoluteLeft+=this.$bb;Da.AbsoluteTop+=this.$bb;Da.AbsoluteRight+=this.$bb;Da.AbsoluteBottom+=this.$bb;Da.ZOrder=Cb.jC+1;return Y.h(this.$).ga.Ra.aB.kj}if(!this.$.na||!this.$.na.activeCell)return f.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var Zb=this.$.na.activeCell;
Cb=Y.h(this.$).VX(Zb);if(!Cb)return f.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${Zb.toString()} is null.`),null;const yc=Ma.HelperMethods.Vyb(Cb.domElement,Cb.xj.domElement);Zb=Cb.gridView.Mg(Zb,2);if(!yc||!Zb)return f.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!yc}. cellPositionRelativeToGridOrigin is null: ${!Zb} .`),null;Da.OriginDeltaX=
Zb.topLeft.x-yc.x;Da.OriginDeltaY=Zb.topLeft.y-yc.y;Da.AbsoluteLeft=Zb.topLeft.x;Da.AbsoluteTop=Zb.topLeft.y;Da.AbsoluteRight=Da.AbsoluteLeft+Math.abs(this.Kua.AbsoluteRight-this.Kua.AbsoluteLeft);Da.AbsoluteBottom=Da.AbsoluteTop+Math.abs(this.Kua.AbsoluteBottom-this.Kua.AbsoluteTop);Da.ZOrder=this.Kua.ZOrder+100;return new $c.a(Cb.gridView.Ca.Ol(Cb.hashCode),Cb.hashCode)}}Object(c.a)(rd,"ArtPasteClientEstimation",null,[787]);class Nd{create(){const Da=window.clipboardPlatform;return Da?Da.createClipboardItems():
null}}Object(c.a)(Nd,"ClipboardItemsFactory",null,[786]);class ed{}ed.undefined="Undefined";Object(c.a)(ed,"CCPTelemetryConsts",null,[]);class yd{}yd.cells="Cells";yd.floatingObject="FloatingObject";yd.unknown="Unknown";Object(c.a)(yd,"ActiveSelection",null,[]);class Ed{}Ed.$rh="DisplayNotInvoked";Ed.rad="Displayed";Ed.gdj="PrerequisitesNotReady";Object(c.a)(Ed,"PasteIndicationDisplayStatus",null,[]);class Ud extends Nc{constructor(Da,Cb,Zb,yc=null){super(Da,Cb,Zb,yc);this.sZ=null}beforePaste(){f.ULS.sendTraceTag(509162378,
0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(Da){Da.isClipboardDataContainShadowWorkbook=!(void 0===Da.clipboardItems.getItem(N.shadowWorkbook)||null===Da.clipboardItems.getItem(N.shadowWorkbook));this.Gn.p6a(Da.copyContextSnapshot);const Cb=Da.commandParameters.originalDestinations;let Zb;if(({BX:Zb}=this.Qkg(Da.clipboardItems)).returnValue){Da.isShadowWorkbookParsedSuccessfully=!0;let yc=null,Vc=null;w.EwaSettings.getBooleanFeatureGate(X.a.vub,!1)?yc=P.r(Cb,this.$):Vc=
P.v(P.L(Cb),this.$);return this.C$i(Da,Vc,yc,Zb)}return Promise.reject(new Ib.a(6))}get copyPasteInfrastructure(){var Da;null!==(Da=this.sZ)&&void 0!==Da?Da:this.sZ=this.$.da.Aa(254,!0);return this.sZ}roi(Da,Cb,Zb,yc){return this.copyPasteInfrastructure?aa.a(this.copyPasteInfrastructure.Bic(null,yc.commandParameters.ribbonCommandInfo,Da,Cb,Zb,yc)):Promise.reject(new Ib.a(0))}C$i(Da,Cb,Zb,yc){Da.pasteResult="CrossSessionPaste";Da.payloadOrigin=ob.l9c;Da.payloadType=T.shadowWorkbook;Da.shadowWorkbookPayloadSize=
mb(yc);Da.shadowWorkbookSizeExceedsLimit=gb(yc);yc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Da.originalSourceRangesCountExceedsLimit=yc.originalSourceRangesCountExceedsLimit);return Da.shadowWorkbookSizeExceedsLimit?Promise.reject(new Ib.a(1)):1028===Da.commandParameters.commandType&&Da.originalSourceRangesCountExceedsLimit?Promise.reject(new Ib.a(1)):this.roi(Cb,Zb,yc,Da)}}Object(c.a)(Ud,"AcrossSessionInsertCopiedCutCellsHandler",Nc,[]);class fe{constructor(Da){this.iPc=this.TJc=
this.$Tc=null;this.$=Da}get vLd(){if(!this.$Tc){const Da=this.$.da.Aa(254,!0);Da&&(this.$Tc=new Nc(this.$,Da,new Nd))}return this.$Tc}get uoi(){if(!this.iPc){const Da=this.$.da.Aa(254,!0);Da&&(this.iPc=new Ud(this.$,Da,new Nd))}return this.iPc}get a1c(){if(!this.TJc&&this.$.da.Aa(254,!0)){const Da=new rd(this.$);this.TJc=new Ad(this.$,new Nd,new cc(this.$,Da),Da)}return this.TJc}getCopyFlowHandler(Da){const Cb=this.hXh(Y.h(this.$).Se);Da.commandParameters.copyPasteHandlerName=Cb.name;return Cb}getPasteFlowHandler(Da){var Cb=
Da.copyContextSnapshot;switch(Da.commandParameters.ribbonCommandInfo.command){case -160032004:case -1065525230:return Da=this.uoi;default:return Cb=O(Da)?this.a1c:I(Da)?this.vLd:(null===Cb||void 0===Cb?0:Cb.sourceItem)&&Object.getType(Cb.sourceItem)===M?this.a1c:this.vLd,Da.commandParameters.copyPasteHandlerName=Cb.name,Cb}}initializePasteContext(Da){if(Da&&(Da.isSameSession=!1,Da.isShadowWorkbookParsedSuccessfully=!1,Da.pasteResult=ed.undefined,Da.payloadOrigin=ed.undefined,Da.payloadType=ed.undefined,
Da.encounteredDeploymentErrors=!1,Da.shadowWorkbookSizeExceedsLimit=!1,Da.originalSourceRangesCountExceedsLimit=!1,Da.activeSelectionType=this.SSh(),Da.indicationDisplayScheduled=!1,Da.pasteDestinationHasMergedCells=!1,Da.pasteIndicationDisplayStatus=Ed.$rh,Da.copyContextSnapshot)){var Cb=Da.copyContextSnapshot;const ld=H(Cb.sourceItem);var Zb=Cb.sourceItem;var yc=!!Zb&&Object.getType(Zb)===M;Zb=0;var Vc=!1;ld?(Vc=Cb.sourceItem,Da.isSameSession=Vc.isFromCurrentSession(this.$),Zb=1,Vc=this.Axi(Vc,
Da)):yc&&(Da.isSameSession=Cb.sourceItem.isFromCurrentSession(this.$),Zb=2);if(Da.copyContextSnapshot.commandParameters){const Bd=-1985798686===Cb.commandParameters.ribbonCommandInfo.command;yc=Da.commandParameters;var jd=this.$;Cb?jd&&jd.xa?Cb=Cb.sessionId===jd.xa.UserSessionId:(f.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Cb=!1):(f.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Cb=!1);yc.clearSystemClipboard=Cb&&Bd&&ld&&!Vc;Da.commandParameters.copyPasteTargetType=
Zb}}}getSessionId(){return this.$.xa.UserSessionId}Axi(Da,Cb){const Zb=Kc.b(Da.ranges,yc=>yc.Ng)&&Kc.b(Cb.commandParameters.originalDestinations,yc=>1!==yc.top);return Kc.b(Da.ranges,yc=>yc.isRow)&&Kc.b(Cb.commandParameters.originalDestinations,yc=>1!==yc.left)||Zb}hXh(Da){switch(Da){case 1:return this.vLd;case 64:case 4:case 2:case 256:return this.a1c;default:throw Error.invalidOperation("Unsupported selection");}}SSh(){return Y.h(this.$).ga.Se&470?yd.floatingObject:1===Y.h(this.$).ga.Se?yd.cells:
yd.unknown}getDialogResponse(){}}Object(c.a)(fe,"ExcelCopyPasteApplicationHost",null,[654]);var We=a(170);class lf extends z.a{constructor(Da,Cb){super(Da);this.Ht=null;this.toi=(Zb,yc)=>{1===Zb?(Zb=lf.krh[yc[lf.jrh]],f.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===Zb?"Horizontal":"Vertical"}`),this.Ht.setResult(Zb)):(f.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),
this.Ht.Ps())};this.Cg(Cb)}get uc(){return"InsertCopiedCutCellsDialog"}Cg(Da){this.Ht=new We.a;const Cb=y.a.instance.ha(16);Da=this.bN(Da);this.initializeAndShow(Cb,this.toi,Da)}bN(Da){return{[lf.Gt]:this.uc,[lf.mzi]:Da}}}lf.jrh="direction";lf.mzi="isRtl";lf.krh={["Vertical"]:1,["Horizontal"]:0};Object(c.a)(lf,"InsertCopiedCutCellsDialog",z.a,[]);class Se{J7b(Da,Cb){return(new lf(Da,Cb)).Ht.task}}Object(c.a)(Se,"InsertCopiedCutCellsDialogFactory",null,[652]);var Ae=a(92),Qe=a(51),$e=a(47);class of{constructor(Da){this.E8b=
"";this.k3=this.xt=null;this.zuc=!1;this.dff=(Cb=null,Zb=null)=>{this.hide(Cb,Zb)};this.gridView=Y.h(Da);this.gridView.ga.IC(this.dff)}FQe(){this.zuc||(f.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.Fz(Da=>{Da.k5(0).then(()=>{this.zuc=!0})}))}bzj(Da){var Cb=Da.commandParameters.id;f.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${Cb}, cancelCtx is null = ${!this.xt}, PrerequisitesDownloaded = ${this.zuc}`);
this.FQe();this.E8b=Cb;Cb=!this.LAf();if(!this.xt||Cb)this.UCe(),this.xt=Qe.a.instance.create(()=>{this.Zrh(Da)},void 0===Da.timeoutToShowSpinnerInMs||null===Da.timeoutToShowSpinnerInMs?100:Da.timeoutToShowSpinnerInMs,$e.a.k$i);this.k3=Da.commandParameters.originalDestinations}Zrh(Da){this.zuc?(this.display(Da.commandParameters.originalDestinations),Da.pasteIndicationDisplayStatus=Ed.rad):(f.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),
this.hide(),Da.pasteIndicationDisplayStatus=Ed.gdj)}display(Da){f.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Jb.pA(ka.a.$Ca(ia.d(this.gridView.$.na),Da),of.Jtc,!0);this.gridView.Jb.jr(of.Jtc)}tod(Da){f.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${Da}, currentPasteCommandId = ${this.E8b}`);Da&&Oa.a.equals(Da,this.E8b,!1)&&this.hide()}hide(Da=null){this.k3&&Da&&this.LAf()&&f.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");
this.E8b="";this.UCe();this.k3=null;this.gridView.Jb.ik(of.Jtc);this.gridView.Jb.Mk(null,of.Jtc)}LAf(){return P.R(this.gridView.ga.qa.selectedRanges,this.k3)}UCe(){this.xt&&(Ae.a.Ja(this.xt),this.xt=null)}dispose(){this.hide();this.gridView.ga.UB(this.dff)}}of.Jtc=[30];Object(c.a)(of,"PasteIndicationManager",null,[653,2]);var re=a(1097),zf=a(54),Lf=a(721);class Ze extends e.a{constructor(Da){super();this.$=Da;this.rm=y.a.instance;this.Mb()}create(){const Da=zf.a.HR([75,76],4,this.Na,void 0,void 0,
void 0,Ze.Xoa);let Cb;Cb=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(aa.d)(Ub.a.resolve(hc.x,{rb:this.Na})):qa.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.Na);ya.TaskExtensions.za(ya.TaskExtensions.Pd([Cb,Da],this.ka),()=>{const Zb=new re.a;let yc=null;this.bch(Zb).then(Vc=>{yc=Vc.OFe;const jd=copyPasteInfra.createCopyPasteInfra(yc,new fe(this.$),Zb,{isChangeGateEnabled:w.EwaSettings.isChangeGateEnabled});f.ULS.shipAssertTag(537167762,
0,!!this.$.xa,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");f.ULS.shipAssertTag(537167761,0,!!this.$.xa&&!!this.$.xa.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");const ld=yc.getMetadataManager();var Bd=Object(Lf.a)(this.$.da,254,()=>new Sa(this.$,ld,Cb.result,jd,new sc(this.$,Y.h(this.$)),new Se,this.$.xa.DocumentHostInfo.UserId,yc.getInitializationError()));this.vb(Bd);
if(Vc.a2a){Bd=Sa.Gdc();const Td=JSON.stringify(Vc.a2a.dataClipboardCapabilities),Jd=Vc.a2a.clipboardStrategiesToInitialize[0].clipboardStrategyType===Vc.a2a.dataClipboardStrategyType,ce=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();f.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${Bd}, StrategyType=${Vc.a2a.dataClipboardStrategyType}, StrategyCapabilities=${Td}, IsBestStrategyTypeInitialized=${Jd}, InfraLoadTimeMS=${ce}`)}else f.ULS.shipAssertTag(537167760,
0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},Vc=>{const jd=Sa.Gdc();Vc=Vc?copyPasteInfra.getStringifiedError(Vc):"null";f.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${jd} error: ${Vc}`)})},this.ka,3)}dispose(){super.dispose()}bch(Da){let Cb=null;var Zb=window.clipboardPlatform;
Zb&&(Cb=Zb.getClipboardPlatformEnvironment());if(!Cb)return f.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);Zb=this.$.xa;const yc=[Zb.OfficeOnlineChromeExtensionId,Zb.ChromeClipboardAccessExtensionId],Vc=this.rm.Va(5);var jd=this.$.se.get(57);let ld=!jd&&this.$.se.get(5);const Bd=this.$.ea.nc;Bd&&(Bd.inWebPart||Bd.inViewerFromWebPart||Bd.isDivSyndicated)&&
(ld=!1);jd=this.hWh(ld,!jd);f.ULS.shipAssertTag(537167758,0,!!Zb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Cb.init({isChangeGateEnabled:w.EwaSettings.isChangeGateEnabled},Da,yc,Zb.SharedClipboardHostingApp,Zb.SharedClipboardHostingApps,Zb.SharedClipboardHostingEnvironments,Zb.SharedClipboardOverrideOrigin,Zb.SharedClipboardSchemaVersion,Zb.SharedClipboardExpirationInMinutes,Zb.ClipboardPromiseTimeoutInMinutes,
Vc,Zb.MachineCluster,new Ra(this.$),jd,Zb.DocumentHostInfo.UserId,Zb.ClipboardTtlInMS,w.EwaSettings.ya(273),Zb.UserSessionId,Zb.BulsEndpointUrl).then(Td=>Object(b.a)(new db,{OFe:Cb,a2a:Td}),Td=>Promise.reject(Td))}hWh(Da,Cb){const Zb=[];Da&&Cb&&Zb.push(this.Elh());Cb&&(Zb.push(this.e9c(7)),Zb.push(this.e9c(0)));Da&&Zb.push(this.SKe());Zb.push({clipboardStrategyType:4});const yc=Zb?Zb.map(Vc=>JSON.stringify(Vc)).join(","):"[]";f.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${Da}, isSystemClipboardAllowed=${Cb}, result = ${yc}`);
return Zb}SKe(){const Da=this.$.xa,Cb={clipboardStrategyType:5};Cb.sessionId=Da.UserSessionId;Cb.useSharedClipboardIframe=!0;Cb.sharedClipboardHostingApp=Da.SharedClipboardHostingApp;Cb.sharedClipboardHostingApps=Da.SharedClipboardHostingApps;Cb.sharedClipboardHostingEnvironments=Da.SharedClipboardHostingEnvironments;Cb.sharedClipboardOverrideOrigin=Da.SharedClipboardOverrideOrigin;Cb.sharedClipboardSchemaVersion=Da.SharedClipboardSchemaVersion;Cb.sharedClipboardExpirationInMinutes=Da.SharedClipboardExpirationInMinutes;
Cb.wacCluster=Da.MachineCluster;return Cb}Elh(){const Da={clipboardStrategyType:6};Da.localStorageStrategyParameters=this.SKe();Da.systemClipboardStrategyParameters=this.e9c(0);return Da}e9c(Da){const Cb={};Cb.clipboardStrategyType=Da;Cb.skipFilesIfPlainTextExists=!0;return Cb}static la(Da){Da.da.Ha(373,new of(Da));Da.da.Ha(Ze.Xoa,new Ze(Da))}}Ze.Xoa=255;Object(c.a)(Ze,"CopyPasteInfrastructureFactory",e.a,[]);var ec=a(10);a.d(C,"a",function(){return Lc});const Lc=()=>{ec.a.Fa(Da=>{Ze.la(Da)})}},1187:function(t,
C,a){var c=a(10),b=a(0),f=a(228),e=a(40);class d extends e.a{constructor(Lb){super();Lb.da.Ha(376,this)}eTg(Lb){this.addHandler("TAF",Lb)}Brj(Lb){this.removeHandler("TAF",Lb)}Dgj(){this.raiseEvent("TAF")}}Object(b.a)(d,"GridHighlightBehaviorEventManager",e.a,[447,2]);class h extends f.a{constructor(Lb){super();this.$=Lb;this.Mb()}create(){this.vb(this.$.da.Aa(376)||new d(this.$))}static la(Lb){Lb.da.Ha(377,new h(Lb))}}Object(b.a)(h,"GridHighlightBehaviorEventManagerFactory",f.a,[]);var r=a(53),l=
a(39),u=a(29),v=a(86),x=a(14),w=a(246),m=a(16),n=a(169),z=a(7),y=a(119),A=a(13);class F extends Sys.EventArgs{constructor(Lb,qb){super();this.start=Lb;this.B7a=qb}}Object(b.a)(F,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var D=a(33);class B extends e.a{constructor(Lb){super();this.Voc=[3];this.Kra=void 0;this.gridView=Lb;this.blg=D.a.aI(this.gridView.$);this.rN=D.a.aI(this.gridView.$)}get coloredReferencesManager(){const Lb=this.gridView.$.da.Aa(281);Lb||x.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return Lb}get kB(){if(this.Kra)return this.Kra;const Lb=this.gridView.$.da.Aa(464);Lb||x.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
Lb.kB||x.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.Kra=Lb.kB}JRg(Lb){this.addHandler("mrek",Lb)}oO(Lb,qb,bc){for(const sc of this.gridView.Un)w.a.instance.ta(m.a.vk,sc.domElement,Lb);w.a.instance.ta(m.a.og,document.documentElement,qb);this.gridView.cellTextEditBox.fac(!0);bc&&w.a.instance.ta(m.a.OB,this.gridView.Kj,qb)}T1d(Lb,qb,bc){for(const sc of this.gridView.Un)w.a.instance.Ba(m.a.vk,sc.domElement,Lb);w.a.instance.Ba(m.a.og,
document.documentElement,qb);this.gridView.cellTextEditBox.fac(!1);bc&&w.a.instance.Ba(m.a.OB,this.gridView.Kj,qb)}Hlj(Lb,qb){for(const bc of this.gridView.Un)n.a.instance.ta(m.a.wg,bc.domElement,Lb);n.a.instance.ta(m.a.Fe,document.documentElement,qb)}j4j(Lb,qb){for(const bc of this.gridView.Un)n.a.instance.Ba(m.a.wg,bc.domElement,Lb);n.a.instance.Ba(m.a.Fe,document.documentElement,qb)}$7c(Lb,qb,bc,sc){const Tb=document.createElement("div");Tb.className=qb;for(const $a of bc)Tb.classList.add($a);
Lb.appendChild(Tb);w.a.instance.ta(m.a.pointerDown,Tb,sc);return Tb}h$e(Lb){Lb=Lb.Vb.parentNode;if(!Lb)return x.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;Lb=parseInt(Lb.getAttribute(z.a.B7a),10);return isNaN(Lb)?(x.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Jb.rD(3,1,Lb)}xOb(Lb,qb,bc=!0){Lb=bc&&
(this.rN?!!this.kB&&this.kB.wwi(Lb):!!this.coloredReferencesManager&&this.coloredReferencesManager.vwi(Lb));for(const sc of qb)A.DOMElementExtensions.setVisible(sc,Lb)}udc(){return this.gridView.am?y.a(this.gridView.$):this.gridView.hc}vWf(){if(this.rN){var Lb=this.udc();Lb&&this.kB?this.blg?Lb.kE(null):this.kB.Ehb(Lb,null):(x.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Jb.ik(this.Voc),
this.gridView.Jb.Mk(null,this.Voc))}else this.rjj()}rjj(){const Lb=this.udc();Lb&&this.coloredReferencesManager?this.blg?Lb.kE(null):this.coloredReferencesManager.kE(Lb,null):(x.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Jb.ik(this.Voc),this.gridView.Jb.Mk(null,this.Voc))}DUf(Lb,qb){this.raiseEvent("mrek",new F(Lb,qb))}}Object(b.a)(B,"BehaviorHelperMethods",e.a,[]);var M=
a(92),R=a(43),P=a(101);class E extends P.a{constructor(Lb,qb=null){super(Lb,qb)}W_a(){}}Object(b.a)(E,"HighlightFlyweightBehavior",P.a,[]);var H=a(19),G=a(469),N=a(80),I=a(12),O=a(122),U=a(229),ca=a(50),Q=a(245),Y=a(9),la=a(76),ea=a(1),ha=a(36);class X extends Q.a{constructor(Lb,qb,bc){super(document.createElement("div"));this.F8b=null;this.JSb=!1;this.onPointerDown=sc=>{sc=ha.a(this.$)?ha.a(this.$).xe(sc):sc;this.JSb=!1;if(3===(N.a.Eb=sc.Cb)){const Tb=sc.Da.rawEvent,$a=Tb.srcElement||Tb.target;A.DOMElementExtensions.Mf(this.domElement,
$a)&&A.DOMElementExtensions.Mf(Tb.currentTarget,$a)&&(this.JSb=!0,this.F8b=sc.clientPoint)}return!1};this.qh=sc=>{sc=ha.a(this.$)?ha.a(this.$).xe(sc):sc;this.raiseEvent("GrPointerUp",sc);return this.JSb=!1};this.pj=sc=>{sc=ha.a(this.$)?ha.a(this.$).xe(sc):sc;3===sc.Cb&&this.JSb&&this.Hgi(sc.clientPoint)&&(this.raiseEvent("GrDrag"),this.JSb=!1);return!1};this.od=sc=>{ha.a(this.$)&&ha.a(this.$).xe(sc);return!0};this.$=bc;bc=!ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(bc?
la.a.OXe:la.a.NXe);this.domElement.classList.add(la.a.mbc);Lb.appendChild(this.domElement);A.DOMElementExtensions.setVisible(this.domElement,!1);this.PMa=document.createElement("div");this.PMa.classList.add(la.a.lbc);this.PMa.style.borderColor=qb;this.domElement.appendChild(this.PMa);w.a.instance.ta(m.a.pointerDown,this.domElement,this.onPointerDown);w.a.instance.ta(m.a.og,this.domElement,this.qh);n.a.instance.ta(m.a.Fe,this.domElement,this.qh);w.a.instance.ta(m.a.vk,this.domElement,this.pj);n.a.instance.ta(m.a.wg,
this.domElement,this.pj);U.a.instance.ta(m.a.click,this.domElement,this.od)}xte(Lb){this.addHandler("GrDrag",Lb)}f_f(Lb){this.removeHandler("GrDrag",Lb)}wte(Lb){this.addHandler("GrContxt",Lb)}e_f(Lb){this.removeHandler("GrContxt",Lb)}yte(Lb){this.addHandler("GrPointerUp",Lb)}g_f(Lb){this.removeHandler("GrPointerUp",Lb)}dispose(){ca.a.uoa(this.domElement);super.dispose()}x7f(){this.domElement.classList.remove(la.a.mbc);this.PMa.classList.remove(la.a.lbc);this.PMa.classList.add(la.a.PXe)}hmg(){this.PMa.classList.remove(la.a.PXe);
this.PMa.classList.add(la.a.lbc);this.domElement.classList.add(la.a.mbc)}Hgi(Lb){return!!this.F8b&&(3<Math.abs(Lb.x-this.F8b.x)||3<Math.abs(Lb.y-this.F8b.y))}static Yxb(Lb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(Lb=ha.a(Lb.$)?ha.a(Lb.$).zoom:Y.a.p0,Math.round(9/Math.max(Lb,1))):9}}X.NAd=0;Object(b.a)(X,"TouchGrippie",Q.a,[]);class T extends E{constructor(Lb,qb,bc,sc){super(qb);this.Vvd=this.Qqb=!1;this.E4b=null;this.Oca=this.Qvd=!1;this.lx=()=>{this.Qqb&&this.Qvd?
this.xpa():this.G5()};this.vHf=$a=>{3===$a.Cb&&(this.Qvd=!0,this.xpa());return!1};this.wHf=$a=>{if(3===$a.Cb){if(!$a.Vb||this.$ti($a))return!1;this.Qvd=!1;this.G5()}return!1};this.Ze=()=>{this.Oca&&this.X1d();this.xpa();this.Vvd=!1};this.Lr=()=>{this.G5();this.Vvd=!0};this.mAa=($a,Nb)=>{Nb.J5===this.J5&&(Nb.visible?this.Vvd||this.xpa():this.G5())};this.cNf=()=>{this.xHf(this.PS.domElement,!1)};this.BDf=()=>{this.xHf(this.dQ.domElement,!0)};this.Erc=($a,Nb)=>{this.ga.ZAa(Nb)};this.Frc=($a,Nb)=>{this.ga.ZAa(G.b(Nb))};
this.$Hb=()=>{3===N.a.Eb?this.xpa():this.G5();this.Oca&&1===N.a.Eb&&this.X1d()};this.dNf=()=>{this.iDj()};this.mRe=()=>{this.G5()};this.Tn=()=>{this.ga.Ra.oc&&this.G5()};this.pDf=()=>{this.G5()};this.pHf=($a,Nb)=>{this.X1d();3===Nb.Cb?this.xpa():this.G5()};this.rvc=()=>{this.Qqb&&(this.G5(),this.xpa())};const Tb=bc.$;this.it=bc;this.ga=bc.ga;this.xca=Lb;this.LAj=qb;this.paneType=sc;Lb=this.domElement.currentStyle;qb="#000000";Lb&&(qb=Lb.borderTopColor);this.PS=new X(this.z_e(),qb,Tb);this.dQ=new X(this.z_e(),
qb,Tb);this.PS.xte(this.cNf);this.PS.wte(this.Erc);this.PS.yte(this.Frc);this.dQ.xte(this.BDf);this.dQ.wte(this.Erc);this.dQ.yte(this.Frc);for(const $a of this.gridView.Un)n.a.instance.ta(m.a.Cf,$a.domElement,this.wHf),n.a.instance.ta(m.a.Fe,$a.domElement,this.vHf);bc.view.qt(this.lx);bc.hc.An(this.mRe);bc.Jb.dqb(this.mAa);bc.LZc(this.pDf);Tb.GC(this.rvc);bc.vv(this.rvc);this.ga.x3(this.Ze);this.ga.W$(this.Lr);bc.OE(this.Tn);this.ga.v1b(this.pHf);N.a.Gte(this.$Hb);l.TaskExtensions.za(r.GetServiceTaskFactory.Sa(Tb.da,
376,377,0),$a=>{$a.result.eTg(this.dNf)},Tb.ka,3)}get gridView(){return this.it}dispose(){M.a.wc([this.PS,this.dQ]);this.PS.f_f(this.cNf);this.PS.e_f(this.Erc);this.PS.g_f(this.Frc);this.dQ.f_f(this.BDf);this.dQ.e_f(this.Erc);this.dQ.g_f(this.Frc);for(var Lb of this.gridView.Un)n.a.instance.Ba(m.a.Cf,Lb.domElement,this.wHf),n.a.instance.Ba(m.a.Fe,Lb.domElement,this.vHf);this.gridView.view.hr(this.lx);this.gridView.hc.sn(this.mRe);this.gridView.Jb.RLb(this.mAa);this.gridView.WNd(this.pDf);this.gridView.$.gG(this.rvc);
this.gridView.My(this.rvc);this.ga.T0(this.Ze);this.ga.Mea(this.Lr);this.gridView.hG(this.Tn);this.ga.Iwc(this.pHf);N.a.n_f(this.$Hb);this.Oca&&x.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(Lb=this.gridView.$.da.Aa(376))&&Lb.Brj(this.dNf);super.dispose()}YTa(){if(!this.xca.range||!this.xca.range.equals(this.Qeb))return!1;const Lb=!this.gridView.uOa();return this.gridView.jb&&Lb&&(this.Qeb.isRow||this.Qeb.Ng)?!1:this.Oca?!0:3===N.a.Eb}G5(){this.Qqb&&
(this.PS.set_visible(!1),this.dQ.set_visible(!1),this.Qqb=!1)}xpa(){if(this.YTa()){var Lb=A.DOMElementExtensions.getBoundingClientRect(this.E4b);Lb||x.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.gridView.Kj,this.gridView.lb.mj);var qb=A.DOMElementExtensions.getBoundingClientRect(this.LAj),bc=new Sys.UI.Bounds(qb.x-Lb.x,qb.y-Lb.y,qb.width,qb.height),sc=this.Qeb,Tb=sc.topLeft,$a=sc.bottomRight,Nb=sc.isRow||sc.Ng;if(sc.Ng){var Ra=
this.cMh();sc=bc.x-2*X.Yxb(this.gridView);var ob=Ra;var mb=bc.x+qb.width}else sc.isRow?(sc=mb=this.bMh(),ob=bc.y-2*X.Yxb(this.gridView),Ra=bc.y+qb.height):(ob=bc.y,Ra=bc.y+qb.height,this.gridView.rtl?(sc=bc.x+qb.width,mb=bc.x):(sc=bc.x,mb=bc.x+qb.width));qb=X.NAd+(Nb?0:X.Yxb(this.gridView));this.PS.style.left=I.HelperMethods.Ic(sc-qb);this.PS.style.top=I.HelperMethods.Ic(ob-qb);this.dQ.style.left=I.HelperMethods.Ic(mb-qb);this.dQ.style.top=I.HelperMethods.Ic(Ra-qb);this.PS.set_visible(this.emf(ob,
sc,Tb,Nb,Lb));this.dQ.set_visible(this.emf(Ra,mb,$a,Nb,Lb));this.Qqb=!0}}emf(Lb,qb,bc,sc,Tb){const $a=A.DOMElementExtensions.getBoundingClientRect(this.gridView.hg(this.paneType).domElement);Tb=new Sys.UI.Bounds($a.x-Tb.x-3,$a.y-Tb.y-3,$a.width+6,$a.height+6);return(this.gridView.lb.yi(bc)===this.paneType||sc)&&R.a.vR(Tb,new Sys.UI.Point(qb,Lb))}cMh(){return(this.gridView.view.visibleArea.height+this.gridView.lb.height+X.NAd-X.Yxb(this.gridView))/2}bMh(){return(this.gridView.view.visibleArea.width+
this.gridView.lb.width+X.NAd-X.Yxb(this.gridView))/2}oLf(){this.xpa()}$ti(Lb){return A.DOMElementExtensions.RSa(Lb.Vb,H.a.ms)&&(this.fvi(Lb)||this.gvi(Lb))}gvi(Lb){if(this.gridView.rtl)Lb=Lb.clientPoint.x;else{const qb=A.DOMElementExtensions.getBoundingClientRect(Lb.Vb);Lb=Lb.clientPoint.x-(qb.x+qb.width-O.a.Xu)}return 0<Lb&&Lb<=O.a.Xu}fvi(Lb){const qb=A.DOMElementExtensions.getBoundingClientRect(Lb.Vb);Lb=Lb.clientPoint.y-(qb.y+qb.height-O.a.Xu);return 0<Lb&&Lb<=O.a.Xu}xHf(Lb,qb){this.Oca&&x.ULS.sendTraceTag(537159312,
0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ga.P3c(Lb,qb,this.Oca);this.G5()}iDj(){this.Oca||(x.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Oca=!0,this.PS.x7f(),this.dQ.x7f(),this.gridView.ga.sourceRange=this.gridView.ga.qa.gd,this.xpa())}X1d(){this.Oca&&(x.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Oca=!1,this.PS.hmg(),this.dQ.hmg())}z_e(){this.E4b||(this.E4b=this.gridView.Kj);
return this.E4b}}Object(b.a)(T,"SelectionTouchGrippiesBehaviorBase",E,[]);class ua extends T{constructor(Lb,qb,bc,sc){super(Lb,qb,bc,sc)}get J5(){return 19}get Qeb(){return this.gridView.ga.qa.activeRange}YTa(){const Lb=this.gridView.ni||this.gridView.jb;return!this.gridView.ga.qa.ph&&!Lb&&super.YTa()}}Object(b.a)(ua,"DiscontinuousSelectionTouchGrippiesBehavior",T,[]);var Ha=a(277);class Ca extends E{constructor(Lb){super(Lb);const qb=document.createElement("div");qb.className=la.a.lHh;Lb.appendChild(qb)}}
Object(b.a)(Ca,"SelectionBorderBehavior",E,[]);class Ga{}Ga.Kdd="ewr-selection-draghandle";Ga.Ldd="ewr-selection-draghandle-grab";Ga.eHh="ewr-selection-draghandle-top-ie";Ga.fHh="ewr-selection-draghandle-top-ie-enhanced";Ga.cHh="ewr-selection-draghandle-top";Ga.dHh="ewr-selection-draghandle-top-enhanced";Ga.TGh="ewr-selection-draghandle-bottom-ie";Ga.UGh="ewr-selection-draghandle-bottom-ie-enhanced";Ga.RGh="ewr-selection-draghandle-bottom";Ga.SGh="ewr-selection-draghandle-bottom-enhanced";Ga.XGh=
"ewr-selection-draghandle-left-ie";Ga.YGh="ewr-selection-draghandle-left-ie-enhanced";Ga.VGh="ewr-selection-draghandle-left";Ga.WGh="ewr-selection-draghandle-left-enhanced";Ga.aHh="ewr-selection-draghandle-right-ie";Ga.bHh="ewr-selection-draghandle-right-ie-enhanced";Ga.ZGh="ewr-selection-draghandle-right";Ga.$Gh="ewr-selection-draghandle-right-enhanced";Ga.gHh="ewr-selection-dragtooltip";Ga.hHh="ewr-selection-dragtooltip-updated";Ga.sHh="ewr_selection_rearrangeleft";Ga.tHh="ewr_selection_rearrangeright";
Ga.uHh="ewr_selection_rearrangetop";Ga.rHh="ewr_selection_rearrangebottom";Ga.selecting="selecting";Ga.vHh="ewr-selection-resizemarqueehandle";Ga.yHh="ewr-selection-resizemarqueehandle-topleft";Ga.zHh="ewr-selection-resizemarqueehandle-topright";Ga.wHh="ewr-selection-resizemarqueehandle-bottomleft";Ga.xHh="ewr-selection-resizemarqueehandle-bottomright";Ga.HGh="ewr-marquee-thick";Ga.LGh="ewr-resizemarqueehandle-thick";Object(b.a)(Ga,"CssClassNames",null,[]);var sa=a(261),bb=a(21);class Ba extends Ca{constructor(Lb,
qb,bc,sc){super(Lb);this.IUa=!1;this.kqe=this.lqe=null;this.mta=0;this.hq=ea.EwaSettings.getBooleanFeatureGate(Ha.a.C$b,!1);this.yti=ea.EwaSettings.getBooleanFeatureGate(Ha.a.Mth,!1);this.j4d=this.Mod=this.mZ=0;this.PW=this.Kb=this.sourceRange=this.ioa=null;this.qh=Tb=>{Tb=ha.a(this.$).xe(Tb);return this.$Jf(Tb)};this.onPointerDown=Tb=>{Tb=ha.a(this.$).xe(Tb);if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)&&!this.Vfb())return!1;if(2===Tb.Cb&&Tb.oo===Sys.UI.MouseButton.leftButton&&
!this.IUa){var $a=this.kld(Tb);if(!$a)return x.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Kb=$a.clone();this.sourceRange=this.Kb.clone();this.ioa=this.Kb;if($a=this.X2h(Tb))if(this.cn=5,this.j4d=$a.top-this.sourceRange.top,this.Mod=$a.left-this.sourceRange.left,bb.h(this.$).Wg.Gp(this.hq?Ba.Evb:Ba.IQe),this.mGd(Tb),this.IUa=!0,sa.b(this.$,!0),ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1))return!0}return!1};this.pj=Tb=>{Tb=ha.a(this.$).xe(Tb);if(this.hq&&this.nGd(Tb))return!0;if(Tb=this.ga.qq(Tb.clientPoint,Tb.Vb,5,void 0,void 0,!0)){Tb=this.msb(Tb);if(this.Kb.equals(Tb))return!0;this.Kb=Tb;if(!this.SS())return x.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Kbc(!0),!1}return!0};this.yd=(Tb,$a)=>{$a.zN||(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&!ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1)?this.vTa(this.$.isEditMode&&this.Vfb()):this.vTa(this.$.isEditMode))};this.Bz=[];this.$=qb;this.ga=bb.h(this.$).ga;this.paneType=bc;this.Co=sc;qb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tSd=this.yti?qb?[Ga.dHh,Ga.SGh,Ga.WGh,Ga.$Gh]:[Ga.fHh,Ga.UGh,Ga.YGh,Ga.bHh]:qb?[Ga.cHh,Ga.RGh,Ga.VGh,Ga.ZGh]:[Ga.eHh,Ga.TGh,Ga.XGh,Ga.aHh];if(!ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1))for(const Tb of this.tSd)qb=this.Co.$7c(Lb,
Tb,this.hq?[Ga.Ldd]:[Ga.Kdd],this.onPointerDown),this.Bz.push(qb);this.$.rl(this.yd);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.vTa(this.$.isEditMode)}get Jb(){return bb.h(this.$).Jb}get cn(){return this.ga.selectionType}set cn(Lb){this.ga.selectionType=Lb}dispose(){this.Bz.forEach(Lb=>{w.a.instance.Ba(m.a.pointerDown,Lb,this.onPointerDown)});this.Bz.length=0;this.ioa=this.sourceRange=this.Kb=null;x.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.mta}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.lm(this.yd),1===this.mta&&(x.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.XJ(this.kqe,this.lqe,!1)));super.dispose()}$Jf(Lb){if(5!==this.cn)return!1;(Lb=this.EQa(Lb))||this.Kbc(!1);sa.b(this.$,!1);return Lb}oO(Lb,qb){x.ULS.shipAssertTag(537159377,0,!this.mta,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.activeRegistrationCount}");this.mta+=
1;this.kqe=Lb;this.lqe=qb;this.Co.oO(Lb,qb,this.Q0d())}msb(Lb){if(!Lb||!this.Kb)return x.ULS.shipAssertTag(537159376,0,!!Lb,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),x.ULS.shipAssertTag(537159375,0,!!this.Kb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const qb=this.Kb.clone();1!==this.mZ&&(qb.left=Math.max(Lb.left-this.Mod,1),qb.right=qb.left+this.sourceRange.width-1);2!==this.mZ&&(qb.top=Math.max(Lb.top-this.j4d,1),qb.bottom=
qb.top+this.sourceRange.height-1);return this.qqb(qb)}XJ(Lb,qb,bc=!0,sc=!0){x.ULS.shipAssertTag(537159374,0,1===this.mta,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.activeRegistrationCount}");--this.mta;this.hq||bb.h(this.$).Wg.Gp(z.a.IV);this.Co.T1d(Lb,qb,this.Q0d());bc&&this.XEe(sc);this.mZ=0;this.IUa=!1}qqb(Lb){var qb=bb.h(this.$);let bc=Lb;if(qb.lb.y5){if(!qb.Ob(Lb.topLeft)){qb=qb.dk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",qb.SQ,
this.ioa.top!==Lb.top?1:2);try{qb.Xk=this.ioa.top<Lb.top||this.ioa.left<Lb.left,qb.Wv(Lb.topLeft),bc=qb.$$cu().range}finally{qb&&qb.dispose()}}bc.right=bc.left+Lb.width-1;bc.bottom=bc.top+Lb.height-1}return this.ioa=bc}vTa(Lb){this.Bz.forEach(qb=>{A.DOMElementExtensions.setVisible(qb,Lb)})}X2h(Lb){const qb=Lb.Vb;Lb=Lb.clientPoint;if(!qb||!Lb)return x.ULS.shipAssertTag(537159373,0,!!qb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),x.ULS.shipAssertTag(537159372,0,!!Lb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),
null;Lb.y+=qb===this.Bz[Ba.F$b]?2:qb===this.Bz[Ba.LQe]?-2:0;Lb.x+=qb===this.Bz[Ba.NQe]?2:qb===this.Bz[Ba.E$b]?-2:0;return this.ga.qq(Lb,qb,5,void 0,void 0,!0)}}Ba.IQe="move";Ba.v7c="copy";Ba.Evb="grabbing";Ba.F$b=0;Ba.LQe=1;Ba.NQe=2;Ba.E$b=3;Object(b.a)(Ba,"DragSelectionClickBehaviorBase",Ca,[]);class qa extends Ba{constructor(Lb,qb,bc,sc,Tb,$a){super(Lb,qb,bc,Tb);this.Db=this.lG=null;this.Tcf=()=>{this.Kbc(!0)};if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1))for(const Nb of this.tSd)qb=this.Co.$7c(Lb,Nb,this.hq?[Ga.Ldd]:[Ga.Kdd],this.onPointerDown),this.Bz.push(qb);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.vTa(this.$.isEditMode);this.gridView=bb.h(this.$);this.RF=sc;this.coloredReferencesManager=this.$.da.Aa(281);x.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.rN=
D.a.aI(this.$))Lb=this.$.da.Aa(464),x.ULS.shipAssertTag(512312961,0,!!Lb,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.kB=Lb.kB;for(const Nb of this.Bz)w.a.instance.ta(m.a.QW,Nb,this.RF.ggf),w.a.instance.ta(m.a.OB,Nb,this.RF.hgf);this.W_a($a)}W_a(Lb){this.Co.xOb(Lb,this.Bz);this.RF.Y0()}mGd(Lb){x.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.tNa=
!0;this.Db.XE(!1);this.cn=5;this.RF.PQe(Lb.Vb);this.Db.textBox.removeSelection();this.Db.F1b(this.Tcf);this.oO(this.pj,this.qh);this.mZ=this.sourceRange.isRow?1:this.sourceRange.Ng?2:0}EQa(){const Lb=this.zX();this.cn=-1;this.XJ(this.pj,this.qh);return Lb}XEe(){this.gridView.tNa=!1;this.RF.QQe(this.Bz[0]);this.Db.textBox.setCaretPositionToEnd();this.Db.Rwc(this.Tcf);this.Co.vWf()}Kbc(Lb){x.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
Lb&&this.XJ(this.pj,this.qh)}kld(Lb){this.Db=this.Co.udc();this.lG=this.Co.h$e(Lb);return this.Db&&this.lG&&this.lG.range?this.lG.range:(x.ULS.shipAssertTag(537159388,0,!!this.Db,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),x.ULS.shipAssertTag(537159387,0,!!this.lG,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),x.ULS.shipAssertTag(537159386,0,!!this.lG.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),
null)}zX(){return this.lG?this.rN?this.kB.yGb(this.Db,this.lG,this.Kb):this.coloredReferencesManager.yGb(this.Db,this.lG,this.Kb):(x.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)}SS(){return this.zX()}Q0d(){return!0}nGd(){return!1}Vfb(){return!0}}Object(b.a)(qa,"DragMarqueeClickBehavior",Ba,[]);var pa=a(91),ya=a(114),za=a(181),cb=a(84),Pa=a(425),nb=a(733),Ma=a(230),
Oa=a(32),La=a(49);class ra extends Ba{constructor(Lb,qb,bc,sc,Tb){super(Lb,qb,bc,Tb);this.wh=null;this.Ng=this.isRow=!1;this.Ze=()=>{this.domElement.classList.remove(Ga.selecting)};this.Lr=()=>{this.domElement.classList.add(Ga.selecting)};this.$c=()=>{if(this.$.isEditMode){const $a=this.Vfb();this.vTa($a)}};this.tableManager=sc;if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)){if(0===ra.uad.length)for(const $a of this.tSd)qb=document.createElement("div"),
qb.className=$a,qb.classList.add(this.hq?Ga.Ldd:Ga.Kdd),ra.uad.push(qb);for(const $a of ra.uad)Lb.appendChild($a),w.a.instance.ta(m.a.pointerDown,$a,this.onPointerDown),this.Bz.push($a)}ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&!ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)?this.vTa(this.Vfb()&&this.$.isEditMode):this.vTa(this.$.isEditMode);this.sm={};this.Kz=!1;this.ga.W$(this.Lr);this.ga.x3(this.Ze);ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",
!1)||this.ga.qM(this.$c);this.S3d=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ga&&(this.ga.Mea(this.Lr),this.ga.T0(this.Ze),ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)||this.ga.jS(this.$c),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ga.dxc(this.ubb));if(this.sm)for(let Lb=1;4>=Lb;Lb++)A.DOMElementExtensions.Hf(this.sm[Lb.toString()]);this.sm=this.wh=null;
super.dispose()}XEe(Lb){Lb&&(this.hq&&bb.h(this.$).Wg.Gp(z.a.IV),ya.KeyInputManager.instance.Ba(m.a.fc,this.domElement.ownerDocument.body,this.onKeyDown),this.Kz=!1);for(Lb=1;4>=Lb;Lb++){const qb=this.sm[Lb.toString()];qb&&qb.parentNode.removeChild(qb);this.sm[Lb.toString()]=null}this.wh=null}kld(){return this.ga.qa.gd}zX(){this.ga.updateSelection(this.Kb,this.Kb.topLeft,0);return!0}SS(Lb=!1){this.Jb.Mk(this.Kb,this.yl());this.Jb.jr(this.yl());this.dJ(Lb);return!0}qqa(Lb=!1){this.Jb.Mk(this.Kb,this.wh);
this.Jb.jr(this.wh);this.dJ(Lb)}Kbc(){x.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}Q0d(){return!1}D8(Lb,qb,bc,sc,Tb=!1){var $a=A.DOMElementExtensions.getBoundingClientRect(qb);let Nb=qb===this.Bz[Ba.F$b]||qb===this.Bz[Ba.LQe];if(this.hq){var Ra=qb===this.Bz[Ba.NQe]||qb===this.Bz[Ba.E$b];this.isRow&&Ra||this.Ng&&Nb?Ra="100px":(Nb=this.isRow||Nb,Ra=(Nb?Tb?ra.w_j:ra.B_j:Tb?ra.v_j:ra.y_j)+"px");qb=Nb?
qb===this.Bz[Ba.F$b]?"top":"bottom":qb===this.Bz[Ba.E$b]?"right":"left";Lb=100*(Nb?Lb.x-$a.x:Lb.y-$a.y)/(Nb?$a.width:$a.height);for($a=1;4>=$a;$a++){sc=document.createElement("div");var ob=document.createElement("div");const mb=document.createElement("div");sc.appendChild(ob);sc.appendChild(mb);Tb&&(ob=document.createElement("div"),sc.appendChild(ob),mb.style.fontWeight="bold");sc.className=Ga.hHh;this.sm[$a.toString()]=sc;this.Jb.rD(bc,$a).tg.appendChild(sc);sc=this.sm[$a.toString()];sc.style[qb]=
Ra;sc.style[Nb?"left":"top"]=Lb+"%"}}else for(Tb=(Nb?-ra.A_j:-ra.x_j)+"px",Ra=Nb?qb===this.Bz[Ba.F$b]?"top":"bottom":qb===this.Bz[Ba.E$b]||sc?"right":"left",qb=100*(Nb?sc?0:Lb.x-$a.x:Lb.y-$a.y)/(Nb?$a.width:$a.height),Lb=1;4>=Lb;Lb++)$a=document.createElement("div"),$a.className=Ga.gHh,this.sm[Lb.toString()]=$a,this.Jb.rD(bc,Lb).tg.appendChild($a),$a=this.sm[Lb.toString()],$a.style[Ra]=Tb,$a.style[Nb?"left":"top"]=qb+"%"}Png(Lb,qb,bc){const sc=bb.h(this.$),Tb=sc.Mg(Lb);var $a=sc.hg(this.paneType);
bc=nb.a.fv($a.view.Ai,this.domElement.parentNode,bc,sc.rtl);$a=!1;let Nb=2;qb&&bc.y-Tb.topLeft.y>Tb.height/2?($a=!0,Nb=1):!qb&&bc.x-Tb.topLeft.x>Tb.width/2&&($a=!0);if($a){qb=sc.dk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",sc.SQ,Nb);try{qb.Wv(Lb),qb.$$mn(),qb.$$cu()}finally{qb&&qb.dispose()}}}Ksb(Lb){this.Jb.ik(this.wh);this.XJ(this.Mna,this.Nna,void 0,Lb)}zU(Lb){this.Jb.ik(this.yl());this.XJ(this.pj,this.qh,void 0,Lb)}jyb(){return this.hq?48:6}yl(){return this.hq?ra.Nth:ra.Rth}g8a(Lb){return Lb.Da.keyCode===
pa.a.yqa||u.a.isMac&&Lb.Da.keyCode===pa.a.WVa}vBb(Lb){Lb=bb.h(this.$).getRangeInformation(Lb);for(let qb=0,bc=Lb.length;qb<bc;++qb)if(Object(Pa.a)(Ma.PivotTableRange,Lb[qb]))return Lb=Oa.a.nd(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),La.a(this.$).fu([Lb]),!0;return!1}}ra.x_j=50;ra.A_j=25;ra.y_j=-85;ra.B_j=-40;ra.v_j=-120;ra.w_j=-50;ra.Rth=[6];ra.Nth=[48];ra.uad=[];Object(b.a)(ra,"DragSelectionClickBehaviorTemporary",Ba,[]);var V=a(25),ma=a(787),W=a(45),aa=a(199),ia=a(120),ka=a(293),Xa=a(65);
const sb=(Lb,qb,bc,sc,Tb,$a,Nb,Ra=null)=>{Ra=Lb.Oa(41,Ra);Ra.sourceRange=qb;Ra.destinationRange=bc;return Xa.g(Lb,"RearrangeRowColumn",Ra,sc,Tb,$a,Nb,0)},ib=(Lb,qb,bc,sc,Tb,$a,Nb=null)=>{Nb=Lb.Oa(1,Nb);Nb.moveRange=qb;return Xa.g(Lb,"MoveLineItems",Nb,bc,sc,Tb,$a,0)};class Ub{constructor(Lb,qb){this.destinationRange=this.sourceRange=null;this.sourceRange=Lb;this.destinationRange=qb}}Object(b.a)(Ub,"MacroRecorderTableRowColumnRearrangedPayload",null,[145]);var hc=a(15);class yb extends ra{constructor(Lb,
qb,bc,sc,Tb){super(Lb,qb,bc,sc,Tb);this.sfa=null;this.CR=this.DR=!1;this.Nrf=0;this.oCa=this.rva=null;this.hK=0;this.G$b=hc.a.instance.ha(2269);this.RQe=hc.a.instance.ha(2270);this.iBc=hc.a.instance.ha(2271);this.uag=hc.a.instance.ha(2272);this.onKeyDown=$a=>{if(this.hq){if(this.g8a($a)||$a.Da.keyCode===pa.a.XVa)return this.nOa||(ya.KeyInputManager.instance.ta(m.a.Vd,this.domElement.ownerDocument.body,this.onKeyUp),this.nOa=!0),!this.E_&&this.g8a($a)&&(bb.h(this.$).Wg.Gp(Ba.v7c),this.E_=!0),this.F_||
$a.Da.keyCode!==pa.a.XVa||(bb.h(this.$).Wg.Gp(Ba.Evb),this.F_=!0,2===this.hK?(x.ULS.shipAssertTag(509159443,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150300,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.zU(!1),this.mZ=0,this.wh=this.CR?[11]:[12],this.DR=this.CR,this.PMd(),x.ULS.shipAssertTag(509159442,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.qqa()):
3===this.hK?(x.ULS.shipAssertTag(509159441,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150299,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Jsb(!1),this.mZ=this.isRow?1:2,this.roa(),x.ULS.shipAssertTag(509159440,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.SS()):1===this.hK&&(x.ULS.shipAssertTag(509159439,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
x.ULS.sendTraceTag(509150298,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Ksb(!1),this.roa(),x.ULS.shipAssertTag(509159438,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.SS())),!0}else if(!this.E_&&($a.Da.keyCode===pa.a.yqa||u.a.isMac&&$a.Da.keyCode===pa.a.WVa))return ya.KeyInputManager.instance.ta(m.a.Vd,this.domElement.ownerDocument.body,this.onKeyUp),bb.h(this.$).Wg.Gp(Ba.v7c),this.E_=!0;return!1};this.onKeyUp=
$a=>{if(this.hq){if(this.g8a($a)||$a.Da.keyCode===pa.a.XVa)return this.Nrf=this.g8a($a)?0:1,this.Kz&&bb.h(this.$).Wg.Gp(Ba.Evb),$a.Da.keyCode===pa.a.XVa&&(2===this.hK?(x.ULS.shipAssertTag(509159437,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150297,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Jsb(!1),this.mZ=0,this.roa(!0),x.ULS.shipAssertTag(509159436,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.SS(!0)):3===this.hK?(x.ULS.shipAssertTag(509159435,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150296,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.zU(!1),this.mZ=this.isRow?1:2,this.wh=this.isRow?[11]:[12],this.PMd(!0),x.ULS.shipAssertTag(509159434,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.qqa(!0)):1===this.hK&&(x.ULS.shipAssertTag(509159433,
0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150295,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.zU(!1),this.wh=this.CR?[11]:[12],this.ZKb(!0),x.ULS.shipAssertTag(509159432,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.qqa(!0))),this.IFc(this.Nrf),!0}else if($a.Da.keyCode===pa.a.yqa||u.a.isMac&&$a.Da.keyCode===pa.a.WVa)return this.IFc(),this.Kz&&bb.h(this.$).Wg.Gp(Ba.IQe),
!0;return!1};this.Nna=$a=>{$a=ha.a(this.$).xe($a);5===this.cn?this.$Jf($a):(this.Kz=!1,x.ULS.shipAssertTag(509159430,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jb.ik(this.wh),!this.$.wt([this.Kb],!1)||this.ojj()||this.Fnf()||(this.ga.sourceRange=this.sourceRange.clone(),this.hq?this.yej():this.JYe(),this.Zca()?this.Kb.top>this.sourceRange.top&&($a=this.Kb.height,this.Kb.top-=$a,this.Kb.bottom-=$a):this.Kb.left>this.sourceRange.left&&($a=this.Kb.width,
this.Kb.left-=$a,this.Kb.right-=$a),this.zX()),this.Pyd());x.ULS.sendTraceTag(509150292,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.XJ(this.Mna,this.Nna);this.tableRange=null;this.cn=-1;this.hq&&(this.sfa=null,this.hK=0);return!0};this.qIb=()=>{this.Kz=!1;this.hK=0;x.ULS.shipAssertTag(509159429,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.Jb.ik(this.wh);if(!this.$.wt([this.Kb],!1))return x.ULS.sendTraceTag(509150291,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XJ(this.pIb,this.qIb),this.cn=-1,!0;if(!(this.ga.qa.gd.equals(this.Kb)||this.vBb(this.Kb)||this.vBb(this.sourceRange)||this.Fnf()||(this.zX(),this.ga.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[z.a.CKa]:this.E_,[z.a.Oad]:!0,[z.a.Pad]:this.DR,[z.a.zba]:this.ga.sourceRange,[z.a.yba]:this.ga.qa.gd,[z.a.Bvb]:this.F_}),this.E_))){if(this.Kb.top>this.sourceRange.top&&(this.isRow||this.Kb.left===this.sourceRange.left&&
this.DR)){var $a=this.Kb.height;this.Kb.top-=$a;this.Kb.bottom-=$a}else this.Kb.left>this.sourceRange.left&&(this.Ng||this.Kb.top===this.sourceRange.top&&!this.DR)&&($a=this.Kb.width,this.Kb.left-=$a,this.Kb.right-=$a);this.zX()}x.ULS.sendTraceTag(509150290,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.XJ(this.pIb,this.qIb);this.sfa=this.tableRange=null;this.cn=-1;this.DR=!1;this.Pyd();return!0};this.Mna=$a=>{const Nb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Nb&&($a=ha.a(this.$).xe($a));var Ra=$a.clientPoint;Nb||($a=ha.a(this.$).xe($a));this.hq&&(this.PW=$a);if($a=this.ga.qq(Ra,$a.Vb,5,void 0,void 0,!0)){if(this.tableRange.contains($a.topLeft)){if(this.Png($a,this.Zca(),Ra),this.Kb=this.LIa($a),this.ga.sourceRange=this.Kb,this.Jb.Mk(this.Kb,this.wh),x.ULS.shipAssertTag(509159428,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jb.jr(this.wh),x.ULS.shipAssertTag(509159427,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.Jb.ik(this.yl()),6!==this.cn){for(Ra=1;4>=Ra;Ra++)$a=this.sm[Ra.toString()],$a.parentNode.removeChild($a),this.Jb.rD(this.Zca()?11:12,Ra).tg.appendChild($a);this.cn=6}}else if(this.Kb=this.msb($a),this.hq)this.tcf(!1);else if(this.Jb.Mk(this.Kb,this.yl()),x.ULS.shipAssertTag(509159426,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.Jb.jr(this.yl()),x.ULS.shipAssertTag(509159425,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
this.Jb.ik(this.wh),5!==this.cn){for(Ra=1;4>=Ra;Ra++)$a=this.sm[Ra.toString()],$a.parentNode.removeChild($a),this.Jb.rD(this.jyb(),Ra).tg.appendChild($a);this.cn=5}this.dJ()}return!0};this.pIb=$a=>{var Nb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Nb&&($a=ha.a(this.$).xe($a));var Ra=$a.clientPoint;Nb||($a=ha.a(this.$).xe($a));this.PW=$a;if(Nb=this.ga.qq(Ra,$a.Vb,5,void 0,void 0,!0)){if(this.Xdf(Nb))return this.Kb=this.msb(Nb),this.scf(!1),!0;var ob=bb.h(this.$),
mb=ob.Mg(Nb),gb=ob.hg(this.paneType);Ra=nb.a.fv(gb.view.Ai,this.domElement.parentNode,Ra,ob.rtl);gb=!1;let lb=2;this.DR=!1;if(this.isRow||this.Ng){this.isRow&&Ra.y-mb.topLeft.y>mb.height/2?(gb=!0,lb=1):this.Ng&&Ra.x-mb.topLeft.x>mb.width/2&&(gb=!0);if(gb){$a=ob.dk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ob.SQ,lb);try{$a.Wv(Nb),$a.$$mn(),Nb=$a.$$cu().range}finally{$a&&$a.dispose()}}this.Kb=this.msb(Nb)}else{Ra.x-mb.topLeft.x===mb.width?(this.DR=!1,gb=!0):Ra.y-mb.topLeft.y>
mb.height/2&&(this.DR=gb=!0,lb=1);this.sfa&&(this.DR=this.CR);if(gb){ob=ob.dk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ob.SQ,lb);try{ob.Wv(Nb),ob.$$mn(),Nb=ob.$$cu().range}finally{ob&&ob.dispose()}}x.ULS.shipAssertTag(509159424,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.Jb.ik(this.wh);this.wh=this.DR?[11]:[12];for(ob=1;4>=ob;ob++)(mb=this.sm[ob.toString()])&&mb.parentNode.removeChild(mb),this.sm[ob.toString()]=null;this.D8($a.clientPoint,
$a.Vb,this.DR?11:12,!0);this.Kb=this.LIa(Nb)}this.ga.sourceRange=this.Kb;this.Jb.Mk(this.Kb,this.wh);x.ULS.shipAssertTag(509159395,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.Jb.jr(this.wh);x.ULS.shipAssertTag(509159394,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.Jb.ik(this.yl());if(6!==this.cn){for($a=1;4>=$a;$a++)Nb=this.sm[$a.toString()],Nb.parentNode.removeChild(Nb),this.Jb.rD(this.isRow||this.DR?11:
12,$a).tg.appendChild(Nb);this.cn=6}this.dJ()}return!0};this.ubb=()=>{this.hq?this.Kz&&5<=this.cn&&(this.tableRange?this.F_?(x.ULS.shipAssertTag(509159381,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150281,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.zU(!0)):(x.ULS.shipAssertTag(509159380,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150280,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Ksb(!0)):this.F_?this.isRow||this.Ng?(x.ULS.shipAssertTag(509159385,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150285,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.zU(!0)):(x.ULS.shipAssertTag(509159384,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150284,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Jsb(!0)):this.isRow||this.Ng?(x.ULS.shipAssertTag(509159383,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150283,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Jsb(!0)):(x.ULS.shipAssertTag(509159382,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150282,0,50,
"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.zU(!0))):this.Kz&&5<=this.cn&&(this.tableRange?(x.ULS.shipAssertTag(509159378,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.Jb.ik(this.wh),x.ULS.sendTraceTag(509150278,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XJ(this.Mna,this.Nna)):(x.ULS.shipAssertTag(509159379,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
this.Jb.ik(this.yl()),x.ULS.sendTraceTag(509150279,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XJ(this.pj,this.qh)))};this.tableRange=null;this.nOa=this.E_=this.F_=!1;this.ga.t_c(this.ubb)}dispose(){ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ga&&this.ga.dxc(this.ubb);this.E_&&this.IFc();this.hq&&this.F_&&this.IFc(1);super.dispose()}mGd(Lb){this.hq&&(this.PW=Lb,this.sfa=null,this.CR=this.isRow=this.Ng=this.DR=
!1,ya.KeyInputManager.instance.ta(m.a.fc,this.domElement.ownerDocument.body,this.onKeyDown));this.Kz=!0;this.tableRange=this.P4g(this.tableManager.aq(this.sourceRange.topLeft));bb.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.hq?(this.sfa=this.tableRange,this.hK=1,this.wh=(this.CR=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.cn=6,x.ULS.sendTraceTag(509150305,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),
this.oO(this.Mna,this.Nna),this.rva=this.G$b,this.oCa=this.iBc,this.D8(Lb.clientPoint,Lb.Vb,this.CR?11:12,!0,!0),x.ULS.shipAssertTag(509159447,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.qqa(!0)):(this.wh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.cn=6,x.ULS.sendTraceTag(509150304,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.oO(this.Mna,
this.Nna),this.D8(Lb.clientPoint,Lb.Vb,this.isRow?11:12,!0)):(this.tableRange=null,this.hq?(this.isRow=this.sourceRange.isRow,this.Ng=this.sourceRange.Ng,this.isRow||this.Ng?(this.hK=3,this.mZ=this.isRow?1:2,this.cn=6,this.wh=this.isRow?[11]:[12],x.ULS.sendTraceTag(509150303,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.oO(this.pIb,this.qIb),this.rva=this.G$b,this.oCa=this.iBc,this.D8(Lb.clientPoint,Lb.Vb,this.isRow?11:12,!0,!0),x.ULS.shipAssertTag(509159446,
0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.qqa(!0)):(this.hK=2,this.mZ=0,x.ULS.sendTraceTag(509150302,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.oO(this.pj,this.qh),this.rva=this.RQe,this.oCa=this.uag,this.D8(Lb.clientPoint,Lb.Vb,this.jyb(),!1,!0),x.ULS.shipAssertTag(509159445,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.SS(!0))):(x.ULS.sendTraceTag(509150301,0,50,
"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.oO(this.pj,this.qh),ya.KeyInputManager.instance.ta(m.a.fc,this.domElement.ownerDocument.body,this.onKeyDown),this.mZ=this.sourceRange.isRow?1:this.sourceRange.Ng?2:0,this.D8(Lb.clientPoint,Lb.Vb,this.jyb(),!1),x.ULS.shipAssertTag(509159444,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.SS()))}EQa(){this.Kz=!1;this.hq&&(this.hK=0);x.ULS.shipAssertTag(509159431,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");
this.Jb.ik(this.yl());if(!this.$.wt([this.Kb],!1))return x.ULS.sendTraceTag(509150294,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XJ(this.pj,this.qh),this.cn=-1,!0;if(this.ga.qa.gd.equals(this.Kb)||this.vBb(this.Kb)||this.vBb(this.sourceRange))this.cn=-1;else{this.zX();this.ga.sourceRange=this.sourceRange.clone();const Lb=this.ga.sourceRange,qb=this.ga.qa.gd;this.hq?this.$.Xc(-694765314,2,30,{[z.a.CKa]:this.E_,[z.a.zba]:Lb,[z.a.yba]:qb,[z.a.Bvb]:this.F_}):this.$.Xc(-694765314,
2,30,{[z.a.CKa]:this.E_,[z.a.zba]:Lb,[z.a.yba]:qb})}if(this.hq||!this.tableRange)x.ULS.sendTraceTag(509150293,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.XJ(this.pj,this.qh);this.Pyd();return!0}nGd(Lb){const qb=this.ga.qq(Lb.clientPoint,Lb.Vb,5,void 0,void 0,!0);this.PW=Lb;return this.Xdf(qb)?(this.Kb=this.LIa(qb),this.scf(!0),!0):this.lgi(qb)?(this.Kb=this.msb(qb),this.tcf(!0),!0):!1}dJ(Lb=!1){const qb=this.Kb.toString();if(this.hq)for(var bc=1;4>=bc;bc++)if(this.S3d){const sc=
this.sm[bc.toString()];sc&&sc.childNodes&&0<sc.childNodes.length&&(sc.childNodes[0].innerText=qb,sc.childNodes[1].innerText=this.rva,Lb&&(sc.childNodes[2].innerText=this.oCa))}else this.sm[bc.toString()].childNodes[0].innerText=qb,this.sm[bc.toString()].childNodes[1].innerText=this.rva,Lb&&(this.sm[bc.toString()].childNodes[2].innerText=this.oCa);else for(Lb=1;4>=Lb;Lb++)if(this.S3d){if(bc=this.sm[Lb.toString()])bc.innerText=qb}else this.sm[Lb.toString()].innerText=qb}Xdf(Lb){return!!this.sfa&&1!==
this.hK&&!!Lb&&this.sfa.contains(Lb.topLeft)}lgi(Lb){return!!this.sfa&&1===this.hK&&!!Lb&&!this.sfa.contains(Lb.topLeft)}scf(Lb){this.tableRange=this.sfa;this.hK=1;const qb=!this.F_;Lb?(x.ULS.shipAssertTag(509159393,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150289,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.zU(!1),this.wh=this.CR?[11]:[12],this.ZKb(qb),x.ULS.shipAssertTag(509159392,0,!!this.wh,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.qqa(qb)):(x.ULS.shipAssertTag(509159391,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),x.ULS.sendTraceTag(509150288,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Jsb(!1),this.roa(qb),x.ULS.shipAssertTag(509159390,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.SS(qb))}tcf(Lb){this.tableRange=null;this.hK=
2;const qb=!this.F_;Lb?(x.ULS.shipAssertTag(509159389,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),x.ULS.sendTraceTag(509150287,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.zU(!1),this.wh=this.CR?[11]:[12],this.DR=this.CR,this.PMd(qb),x.ULS.shipAssertTag(509159388,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.qqa(qb)):(x.ULS.shipAssertTag(509159387,0,!!this.wh,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
x.ULS.sendTraceTag(509150286,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.Ksb(!1),this.roa(qb),x.ULS.shipAssertTag(509159386,0,!!this.yl(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.SS(qb))}Vfb(){if(!bb.h(this.$).ga.qa.ph)return!1;const Lb=bb.h(this.$).getRangeInformation(this.ga.qa.gd);for(const qb of Lb)if(Object(Pa.a)(Ma.PivotTableRange,qb))return!1;return!0}P4g(Lb){if(Lb&&Lb.contains(this.sourceRange)&&!Lb.equals(this.sourceRange)){if(Lb.Ala&&
this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===Lb.top){const qb=new V.Range(this.sourceRange.top,this.sourceRange.left,Lb.bottom,this.sourceRange.right,!1,!1);if(!qb.equals(Lb))return this.sourceRange=qb,this.ga.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),Lb}this.hq?this.CR=Lb.left===this.sourceRange.left&&Lb.right===this.sourceRange.right:this.isRow=Lb.left===this.sourceRange.left&&Lb.right===this.sourceRange.right;if(Lb.top===this.sourceRange.top&&Lb.bottom===
this.sourceRange.bottom||this.Zca())return Lb}return null}LIa(Lb){const qb=Lb.clone();this.Zca()?qb.left=Math.max(Lb.left-this.Mod,1):qb.top=Math.max(Lb.top-this.j4d,1);qb.right=qb.left+this.sourceRange.width-1;qb.bottom=qb.top+this.sourceRange.height-1;return this.qqb(qb)}Fnf(){const Lb=this.Kb.topLeft.xd(this.sourceRange);return Lb||this.hq&&!this.tableRange?Lb:this.Zca()?this.Kb.top===this.sourceRange.bottom+1:this.Kb.left===this.sourceRange.right+1}ojj(){if(this.Zca()&&this.Kb.left!==this.tableRange.left||
!this.Zca()&&this.Kb.top!==this.tableRange.top){const Lb=Oa.a.nd(1,1,0,918,0,2065438552,"RearrangeInvalidDest");La.a(this.$).fu([Lb]);return!0}return!1}yej(){const Lb=this.$.Rb.Qc("UserAction","RearrangeRowColumnClientSide"),qb={["CopyPasteTargetType"]:1,["OperationId"]:za.a.create().toString(),["Stopwatch"]:Lb,["DragDropIsShiftKeyDown"]:this.F_,["EncounteredDeploymentErrors"]:!1},bc=this.E_?2:1,sc=this.$.da.Aa(254);(new Promise((Tb,$a)=>{this.JYe(Nb=>{Nb.Errors&&0<Nb.Errors.length?$a(new ma.a(22,
Nb.Errors)):Tb(!0)},Nb=>{Nb=ia.a.Ye(Nb.data);$a(new ma.a(22,Nb))})})).then(()=>{x.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');sc&&sc.sJi(qb,bc,this.sourceRange,this.Kb);return Promise.resolve(!0)},Tb=>{x.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Tb?copyPasteInfra.getStringifiedError(Tb):"null"}, copyPasteTargetType="${1}"`);return sc?sc.b3i(Tb,qb,bc,this.sourceRange,
this.Kb):Promise.reject(Tb)})}JYe(Lb=null,qb=null){const bc={};this.Zca()?(bc.FirstRow=this.Kb.top-1,bc.FirstColumn=0,bc.DeltaColumn=0,bc.DeltaRow=this.Kb.bottom-this.Kb.top+1):(bc.FirstRow=0,bc.FirstColumn=this.Kb.left-1,bc.DeltaColumn=this.Kb.right-this.Kb.left+1,bc.DeltaRow=0);bc.LastRow=Y.a.CB;bc.LastColumn=Y.a.Cy;bc.SheetName=this.$.ua.na?this.$.ua.na.name:this.$.Hb.getItemByName(this.$.Hb.na.name).sheetName;const sc=W.v(this.sourceRange,this.$);this.$.userOperationManager.Tc(new aa.a(514,0,
(Tb,$a,Nb)=>sb(this.$.pa.va,sc,bc,Lb?ka.b(Tb,Lb):Tb,qb?ka.a($a,qb):$a,Nb,null),64,()=>new Ub(sc,bc)),null)}IFc(Lb=0){0===Lb?this.E_=!1:1===Lb&&(this.F_=!1);this.hq&&(this.E_||this.F_)||(ya.KeyInputManager.instance.Ba(m.a.Vd,this.domElement.ownerDocument.body,this.onKeyUp),this.nOa=!1)}roa(Lb=!1){this.cn=5;x.ULS.sendTraceTag(509150277,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.oO(this.pj,this.qh);this.rva=this.RQe;this.oCa=this.uag;this.D8(this.PW.clientPoint,
this.PW.Vb,this.jyb(),!1,Lb)}PMd(Lb=!1){this.cn=6;x.ULS.sendTraceTag(509150276,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.oO(this.pIb,this.qIb);this.rva=this.G$b;this.oCa=this.iBc;this.D8(this.PW.clientPoint,this.PW.Vb,this.isRow||this.CR?11:12,!0,Lb)}ZKb(Lb=!1){this.cn=6;x.ULS.sendTraceTag(509150275,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.oO(this.Mna,this.Nna);this.rva=this.G$b;this.oCa=this.iBc;this.D8(this.PW.clientPoint,
this.PW.Vb,this.Zca()?11:12,!0,Lb)}Zca(){return!this.hq&&this.isRow||this.hq&&this.CR}Jsb(Lb){this.Jb.ik(this.wh);this.XJ(this.pIb,this.qIb,void 0,Lb)}Pyd(){const Lb=cb.a.instance.$b("Common.ISystemInitiatedFeedback");Lb&&Lb.execute(qb=>{qb.logActivity("DragDrop",null)})}}Object(b.a)(yb,"DragSelectionClickBehaviorCellRangeAndTable",ra,[]);var Gb=a(328),Sa=a(155);class db extends ra{constructor(Lb,qb,bc,sc,Tb){super(Lb,qb,bc,sc,Tb);this.ubb=()=>{this.Kz&&(x.ULS.shipAssertTag(509159371,0,!!this.wh,
"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),x.ULS.sendTraceTag(509150340,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.Ksb(!0));5===this.cn&&(x.ULS.shipAssertTag(509159370,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150339,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.zU(!0))};this.Nna=$a=>{ha.a(this.$).xe($a);this.Kz=!1;x.ULS.shipAssertTag(509159369,
0,!!this.wh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.Jb.ik(this.wh);this.ga.sourceRange=this.sourceRange.clone();this.Cpf?this.$.Xc(927125067,N.a.Eb,30,null):this.aya?(this.zX(),this.ga.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[z.a.CKa]:!0,[z.a.zba]:this.ga.sourceRange,[z.a.yba]:this.ga.qa.gd,[z.a.Bvb]:!1}),x.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),bb.h(this.$).Wg.Gp(z.a.IV),
this.aya=!1):this.pej();x.ULS.sendTraceTag(509150338,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.XJ(this.Mna,this.Nna);this.cn=-1;return!0};this.Mna=$a=>{$a=ha.a(this.$).xe($a);const Nb=$a.clientPoint;this.PW=$a;let Ra=this.ga.qq(Nb,$a.Vb,5,void 0,void 0,!0);if(Ra){if(!this.Bud(Ra))return this.idi($a),!0;this.Png(Ra,this.isRow,Nb);if(this.isRow||this.Ng)this.Kb=this.LIa(Ra);this.ga.sourceRange=this.Kb;this.Jb.Mk(this.Kb,this.wh);x.ULS.shipAssertTag(509159368,
0,!!this.wh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.Jb.jr(this.wh);x.ULS.shipAssertTag(509159367,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null");this.Jb.ik(this.yl());this.dJ()}return!0};this.onKeyDown=$a=>this.g8a($a)?(this.nOa||(ya.KeyInputManager.instance.ta(m.a.Vd,this.domElement.ownerDocument.body,this.onKeyUp),this.nOa=!0),this.aya||(bb.h(this.$).Wg.Gp(Ba.v7c),this.aya=!0),!0):!1;this.onKeyUp=$a=>{this.g8a($a)&&(ya.KeyInputManager.instance.Ba(m.a.Vd,
this.domElement.ownerDocument.body,this.onKeyUp),this.nOa=!1,this.Kz?bb.h(this.$).Wg.Gp(Ba.Evb):bb.h(this.$).Wg.Gp(z.a.IV),this.aya=!1);return!0};this.dJf=$a=>{$a.Errors&&0<$a.Errors.length?(x.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${Oa.a.xc($a.Errors)}]`),this.Kb.left=this.sourceRange.left,this.Kb.right=this.sourceRange.right,this.Kb.top=this.sourceRange.top,this.Kb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=
this.Kb.top&&this.sourceRange.bottom>=this.Kb.top-1?(this.Kb.top=this.sourceRange.top,this.Kb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Kb.top||(this.Kb.top-=this.sourceRange.height),this.Kb.bottom=this.Kb.top+this.sourceRange.height-1):this.sourceRange.left<=this.Kb.left&&this.sourceRange.right>=this.Kb.left-1?(this.Kb.left=this.sourceRange.left,this.Kb.right=this.sourceRange.right):(this.sourceRange.left>this.Kb.left||(this.Kb.left-=this.sourceRange.width),this.Kb.right=this.Kb.left+
this.sourceRange.width-1);this.zX();this.cn=-1};this.cJf=$a=>{$a=ia.a.Ye($a.data);x.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${Oa.a.xc($a)}]`)};this.ga.t_c(this.ubb);this.aya=this.nOa=!1}dispose(){ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ga&&this.ga.dxc(this.ubb);super.dispose()}mGd(Lb){this.PW=Lb;this.isRow=this.Ng=!1;ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7642616_DraggingEntireColumnsBug")&&
(this.mZ=null!=this.Kb?this.Kb.isRow?1:this.Kb.Ng?2:0:0);this.Kz=!0;ya.KeyInputManager.instance.ta(m.a.fc,this.domElement.ownerDocument.body,this.onKeyDown);this.Tb=this.tableManager.ela(this.sourceRange);this.xkf=this.oyi(this.Kb);this.Tb||x.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.Cpf=(new Sa.a(this.$.ua)).di;bb.h(this.$);bb.h(this.$).Wg.Gp(Ba.Evb);this.Bud(this.Kb)?(this.isRow=this.izi(),
this.Ng=this.Bsi(),this.isRow||this.Ng?(this.V8a=!1,this.ZKb(Lb),this.Kb=this.LIa(this.Kb),x.ULS.shipAssertTag(509159377,0,!!this.wh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),this.qqa()):(this.V8a=!0,this.roa(Lb),x.ULS.shipAssertTag(509159376,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.SS())):(this.V8a=!0,this.roa(Lb),x.ULS.shipAssertTag(509159375,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),
this.SS())}EQa(){ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7657099_CleaningUpIsDragging")&&(this.Kz=!1);return this.Cpf?(this.$.Xc(927125067,N.a.Eb,30,null),x.ULS.shipAssertTag(509159374,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150343,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.zU(!0),this.V8a=!1,this.cn=-1,!0):this.aya||ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MovePivotTables",
!1)&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragDropSelectionBugFix",!1)&&this.xkf?(this.zX(),this.ga.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[z.a.CKa]:this.aya,[z.a.zba]:this.ga.sourceRange,[z.a.yba]:this.ga.qa.gd,[z.a.Bvb]:!1}),x.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.aya}"`),bb.h(this.$).Wg.Gp(z.a.IV),x.ULS.shipAssertTag(509159373,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),
x.ULS.sendTraceTag(509150342,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.zU(!0),this.V8a=!1,this.cn=-1,this.xkf=!1,!0):5===this.cn?(x.ULS.shipAssertTag(509159372,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),x.ULS.sendTraceTag(509150341,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.zU(!0),this.V8a=!1,this.NOj(),this.cn=-1,!0):!1}nGd(Lb){const qb=this.ga.qq(Lb.clientPoint,Lb.Vb,5,void 0,
void 0,!0);this.PW=Lb;return this.V8a?!1:this.Bud(qb)?(this.jdi(Lb),!0):!1}dJ(){let Lb=new V.Range(this.Kb.top,this.Kb.left,this.Kb.bottom,this.Kb.right,!1,!0);6===this.cn&&(this.isRow?(--Lb.top,Lb.bottom=Lb.top+this.Kb.height-1):(--Lb.left,Lb.right=Lb.left+this.Kb.width-1));for(let qb=1;4>=qb;qb++)if(this.S3d){const bc=this.sm[qb.toString()];bc&&bc.childNodes&&0<bc.childNodes.length&&(bc.childNodes[0].innerText=Lb.toString())}else this.sm[qb.toString()].childNodes[0].innerText=Lb.toString()}Vfb(){if(!bb.h(this.$).ga.qa.ph)return!1;
var Lb=bb.h(this.$).getRangeInformation(this.ga.qa.gd);for(var qb of Lb)if(Object(Pa.a)(Ma.PivotTableRange,qb)&&(Lb=this.tableManager.ela(qb)))return qb=!Lb.isOlap||!Lb.UOa(!0),x.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",Lb),Lb.isActionable&&qb;return!1}LIa(Lb){Lb=Lb.clone();this.isRow?(Lb.left=this.sourceRange.left,Lb.right=this.Tb.right,Lb.bottom=Lb.top+this.sourceRange.height-1):this.Ng?(Lb.top=this.sourceRange.top,
ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")&&!this.Tb.Ns?Lb.bottom=this.Tb.bottom:Lb.bottom=this.Tb.Ns.bottom,Lb.right=Lb.left+this.sourceRange.width-1):x.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.qqb(Lb)}pej(){const Lb={},qb=W.v(this.sourceRange,this.$);bb.h(this.$).getRangeInformation(this.Kb);if(this.isRow){qb.FirstColumn=Lb.FirstColumn=this.Kb.left-1;qb.LastColumn=Lb.LastColumn=
this.Kb.right-1;if(this.sourceRange.top<=this.Kb.top&&this.sourceRange.bottom>=this.Kb.top-1){x.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Kb.top?Lb.LastRow=Lb.FirstRow=this.Kb.top-1:(Lb.FirstRow=this.Kb.top-this.sourceRange.height-1,Lb.LastRow=Lb.FirstRow+this.sourceRange.height-1)}else{ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?Lb.FirstRow=Math.min(this.Kb.top,this.Kb.bottom-
1):Lb.FirstRow=this.Kb.top;Lb.LastRow=this.Kb.bottom-1;if(this.sourceRange.left<=this.Kb.left&&this.sourceRange.right>=this.Kb.left-1){x.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}Lb.LastColumn=this.sourceRange.left>this.Kb.left?Lb.FirstColumn=this.Kb.left-1:Lb.FirstColumn=this.Kb.left-this.sourceRange.width-1}const bc={};bc.SheetName=this.$.ua.na?this.$.ua.na.name:this.$.Hb.getItemByName(this.$.Hb.na.name).sheetName;bc.Ranges=Array(2);
bc.Ranges[0]=qb;bc.Ranges[1]=Lb;this.NIh(bc)}NIh(Lb){this.$.userOperationManager.Tc(new aa.a(265,0,(qb,bc,sc)=>ib(this.$.pa.va,Lb,this.dJf?ka.b(qb,this.dJf):qb,this.cJf?ka.a(bc,this.cJf):bc,sc,null),64),null)}Bud(Lb){return null!==this.Tb&&this.kwi(Lb)&&this.bzi(Lb)&&this.tBi(Lb)&&this.Iri(Lb)}kwi(Lb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.Tb.Ns?Lb.left>=this.Tb.Ns.left:this.Tb.Av?Lb.left>=this.Tb.Av.left:Lb.left>=this.Tb.left:null===this.Tb.Ns||Lb.left>=
this.Tb.Ns.left}bzi(Lb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.Tb.Av?Lb.right<=this.Tb.Av.right:this.Tb.Ns?Lb.right<=this.Tb.Ns.right:Lb.right<=this.Tb.right:null===this.Tb.Av||Lb.right<=this.Tb.Av.right}tBi(Lb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7666231_CannotSortColumnsInPivotTable")?this.isRow?null!==this.Tb.Ns&&Lb.top>=this.Tb.Ns.top:this.Ng?null!==this.Tb.Av&&Lb.top>=this.Tb.Av.top:null===this.Tb.top||Lb.top>=this.Tb.top:null===
this.Tb.Ns||Lb.top>=this.Tb.Ns.top}Iri(Lb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7696997_ManualSortIssueFix")?this.Tb.Ns?Lb.bottom<=this.Tb.Ns.bottom:this.Tb.Av?Lb.bottom<=this.Tb.Av.bottom:Lb.bottom<=this.Tb.bottom:null===this.Tb.Ns||Lb.bottom<=this.Tb.Ns.bottom}oyi(Lb){return null!==this.Tb&&this.Tb.left>=Lb.left&&this.Tb.right<=Lb.right&&this.Tb.top>=Lb.top&&this.Tb.bottom<=Lb.bottom}izi(){return null!==this.Tb&&null!==this.Tb.Ns&&this.Tb.Ns.top<=this.Kb.top&&this.Tb.Ns.left<=this.Kb.left&&
this.Tb.Ns.right>=this.Kb.left}Bsi(){return null!==this.Tb&&null!==this.Tb.Av&&this.Tb.Av.top===this.Kb.top&&this.Tb.Av.left<=this.Kb.left&&this.Tb.Av.right>=this.Kb.right}ZKb(Lb){this.cn=6;this.wh=this.isRow?[11]:[12];x.ULS.sendTraceTag(509150337,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.oO(this.Mna,this.Nna);this.D8(Lb.clientPoint,Lb.Vb,this.isRow?11:12,!0,!1)}roa(Lb){this.cn=5;x.ULS.sendTraceTag(509150336,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");
this.oO(this.pj,this.qh);this.D8(Lb.clientPoint,Lb.Vb,this.jyb(),!1,!1)}jdi(Lb){x.ULS.shipAssertTag(509159366,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange.handleDragWithinPivotTable: getDragHighlight is null");x.ULS.sendTraceTag(509150307,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.zU(!1);this.ZKb(Lb);this.Kb=this.LIa(this.Kb);x.ULS.shipAssertTag(509159365,0,!!this.wh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.qqa()}idi(Lb){x.ULS.shipAssertTag(509159364,
0,!!this.wh,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");x.ULS.sendTraceTag(509150306,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.Ksb(!1);this.roa(Lb);x.ULS.shipAssertTag(509159363,0,!!this.yl(),"DragSelectionClickBehaviorPivotTableRange.handleDragOutsidePivotTable: getDragHighlight is null");this.SS()}NOj(){if(!(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7563140_ClickingEdgeOfCellFix")&&null!=this.sourceRange&&null!=this.Kb&&this.sourceRange.Rw(!1)===
this.Kb.Rw(!1)||this.vBb(this.Kb))){var Lb=Oa.a.nd(1,0,904,903,0,2069074184,"PivotTableInvalidMove");Lb.HelpTopicId=Gb.a.FSj;Lb.HelpDescription=hc.a.instance.ha(913);La.a(this.$).fu([Lb])}}}Object(b.a)(db,"DragSelectionClickBehaviorPivotTableRange",ra,[]);var fb=a(381);class ab extends Ca{constructor(Lb,qb){super(Lb);this.Ze=()=>{this.domElement.classList.remove(Ga.selecting);fb.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Lr=()=>{this.domElement.classList.add(Ga.selecting)};
this.onPointerDown=bc=>{2===bc.Cb&&bc.oo===Sys.UI.MouseButton.leftButton&&(this.gridView.ga.selectionType=4,this.gridView.ga.sourceRange=this.gridView.ga.qa.gd,fb.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.Oda=()=>{this.gridView.$.Xc(1983983164,2,30,null);return!0};this.yd=()=>{A.DOMElementExtensions.setVisible(this.Qba,this.gridView.$.isEditMode)};this.B7=()=>{A.DOMElementExtensions.setVisible(this.Qba,!1)};this.A7=()=>{A.DOMElementExtensions.setVisible(this.Qba,
!0)};this.rHf=()=>{A.DOMElementExtensions.setVisible(this.Qba,!1)};this.qHf=()=>{A.DOMElementExtensions.setVisible(this.Qba,!0)};this.IHb=(bc,sc)=>{A.DOMElementExtensions.setVisible(this.Qba,!sc.nqe)};this.gridView=qb;qb=document.createElement("div");qb.className=la.a.kHh;this.Qba=qb;this.yd(null,null);Lb.appendChild(qb);w.a.instance.ta(m.a.pointerDown,this.Qba,this.onPointerDown);U.a.instance.ta(m.a.Gk,this.Qba,this.Oda);ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachSelectionFillHandleListener",
!1)||(this.gridView.ga.W$(this.Lr),this.gridView.ga.x3(this.Ze));this.gridView.$.rl(this.yd);this.gridView.$.ub.a2b(this.B7);this.gridView.$.ub.$1b(this.A7);this.gridView.Yse(this.IHb);this.gridView.cellTextEditBox.An(this.rHf);this.gridView.cellTextEditBox.Bm(this.qHf)}dispose(){w.a.instance.Ba(m.a.pointerDown,this.Qba,this.onPointerDown);U.a.instance.Ba(m.a.Gk,this.Qba,this.Oda);this.gridView.$&&(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachSelectionFillHandleListener",!1)||
(this.gridView.ga.Mea(this.Lr),this.gridView.ga.T0(this.Ze)),this.gridView.$.lm(this.yd),this.gridView.$.ub.ixc(this.B7),this.gridView.$.ub.hxc(this.A7),this.gridView.LZf(this.IHb),this.gridView.cellTextEditBox.sn(this.rHf),this.gridView.cellTextEditBox.km(this.qHf));super.dispose()}}Object(b.a)(ab,"FillHandleClickBehavior",Ca,[]);class wb extends E{constructor(Lb,qb){super(Lb);this.s4i=bc=>{const sc=I.HelperMethods.Ko(bc);var Tb=this.jxa.o4d(bc.clientPoint);if(!Tb)return!1;var $a=Tb.re,Nb=this.jxa.Ca.wyb($a.hashCode).xwa(Tb.rJ);
if(!Nb)return!1;bc=$a.xj.domElement;Tb=I.HelperMethods.Xre(I.HelperMethods.Vyb($a.domElement,bc),Tb.rJ);$a=0;Nb=this.jxa.Ob(Nb.getRange());for(let ob=0,mb=wb.LDe.length;ob<mb;++ob){const gb=wb.LDe[ob];if((128===gb||64===gb)&&this.jxa.$.isEditMode)continue;var Ra=Nb.lMa(gb);if(!Ra||!Ra.M7a||"none"===Ra.M7a.style.display)continue;Ra=Ra.M7a;const lb=I.HelperMethods.Vyb(Ra,bc);Ra=new Sys.UI.Bounds(lb.x,lb.y,Ra.offsetWidth,Ra.offsetHeight);if(R.a.vR(Ra,Tb)){$a=gb;break}}return 0!==$a?(Nb.invoke($a,sc),
!0):!1};this.FBg=qb;U.a.instance.ta(m.a.click,Lb,this.s4i)}get jxa(){return this.FBg}}wb.LDe=[1,2,32,256,128,64];Object(b.a)(wb,"IPadSelectionClickThroughBehavior",E,[]);var kb=a(23);class tb{constructor(Lb){this.ggf=qb=>{this.kGc(qb.Vb,1);return!0};this.hgf=qb=>{this.kGc(qb.Vb,-1);return!0};this.Ze=()=>{this.otd=!1};this.Lr=()=>{this.otd=!0};this.gridView=Lb;this.k7a=0;this.otd=this.wkc=!1;this.E6=Number.NaN;this.gridView.ga.W$(this.Lr);this.gridView.ga.x3(this.Ze);this.gridView.ga.t_c(this.Ze)}dispose(){this.gridView.ga.Mea(this.Lr);
this.gridView.ga.T0(this.Ze);this.gridView.ga.dxc(this.Ze)}Y0(){this.k7a=0;this.wkc=!1;this.E6=Number.NaN}PQe(Lb){this.wkc=!0;this.kGc(Lb,1)}QQe(Lb){this.wkc=!1;this.kGc(Lb,-1)}kGc(Lb,qb){if(Lb)if(Lb.parentNode)if(this.otd)isNaN(this.E6)||(this.BGc(this.E6,!1),this.E6=Number.NaN);else if(Lb=parseInt(Lb.parentNode.getAttribute(z.a.B7a),10),isNaN(Lb))x.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.E6)&&
Lb!==this.E6){if(this.wkc)return;this.BGc(this.E6,!1)}if(isNaN(this.E6)||Lb!==this.E6)this.E6=Lb,this.k7a=0;!this.k7a&&0<qb&&this.BGc(Lb,!0);this.k7a=Math.max(this.k7a+qb,0);!this.k7a&&0>qb&&(this.BGc(Lb,!1),this.E6=Number.NaN)}else x.ULS.shipAssertTag(537159367,0,!!Lb.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else x.ULS.shipAssertTag(537159368,0,!!Lb,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}BGc(Lb,qb){for(let sc=1;4>=sc;sc++){var bc=
this.gridView.Jb.rD(3,sc,Lb).tg;A.DOMElementExtensions.toggleCssClass(bc,Ga.HGh,qb);for(bc=bc.firstChild;bc;bc=bc.nextSibling)kb.a.contains(bc.className,"resizemarqueehandle",!0)&&A.DOMElementExtensions.toggleCssClass(bc,Ga.LGh,qb)}}}Object(b.a)(tb,"MarqueeHoveringManager",null,[]);var hb=a(190),Fb=a(89),va=a(851),jb=a(1288);class Ab extends E{constructor(Lb,qb){super(Lb);this.tsc=()=>{if(!this.Pv)return x.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),
!1;this.Pv.thj(this.vca);this.Pv.Hwh(this.wca);if(3===this.Pv.model.state)return!0;this.Pv.cpd(!0);return!0};this.Xda=()=>{if(!this.Pv)return!1;this.Pv.qUf(!1);this.Pv.gQd(this.wca,!1);if(3===this.Pv.model.state)return!0;this.Pv.cpd(!1);return!0};this.onPointerDown=bc=>this.Pv?2===bc.Cb&&bc.oo===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.gIb=()=>{if(!this.Pv)return!1;this.Pv.gQd(this.wca,!0);this.Pv.cpd(!1);this.Pv.uKa();return!0};this.onDoubleClick=bc=>{if(bc.Da)return bc.Da.stopPropagation(),!0;
x.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.Pv=Object(Fb.a)(jb.a,qb.metadata);this.wca=document.createElement("div");this.wca.id=`${Lb.id}-${z.a.BDe}`;this.wca.className=va.a.w6g;this.vca=document.createElement("div");this.vca.id=`${Lb.id}-${z.a.a4c}`;this.vca.className=va.a.a4c;this.hR=document.createElement("div");this.hR.appendChild(this.vca);this.hR.className=va.a.v6g;this.wca.appendChild(this.hR);Lb.appendChild(this.wca);
x.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");w.a.instance.ta(m.a.QW,this.hR,this.tsc);w.a.instance.ta(m.a.OB,this.hR,this.Xda);w.a.instance.ta(m.a.pointerDown,this.hR,this.onPointerDown);hb.a.instance.ta(m.a.click,this.hR,this.gIb);hb.a.instance.ta(m.a.Gk,this.hR,this.onDoubleClick);A.DOMElementExtensions.setVisible(this.hR,qb.isVisible)}dispose(){w.a.instance.Ba(m.a.QW,this.hR,this.tsc);
w.a.instance.Ba(m.a.OB,this.hR,this.Xda);w.a.instance.Ba(m.a.pointerDown,this.hR,this.onPointerDown);hb.a.instance.Ba(m.a.click,this.hR,this.gIb);hb.a.instance.Ba(m.a.Gk,this.hR,this.onDoubleClick);A.DOMElementExtensions.Hf(this.vca);this.vca=null;A.DOMElementExtensions.Hf(this.wca);this.Pv=this.wca=null;super.dispose()}W_a(Lb){this.Pv=Object(Fb.a)(jb.a,Lb.metadata);Lb.isVisible!==Lb.Xya&&(this.Pv.AIj(Lb.isVisible?1:0),A.DOMElementExtensions.setVisible(this.wca,Lb.isVisible))}}Object(b.a)(Ab,"RangeCatchUpActivityHighlightBehavior",
E,[]);class Qa extends T{constructor(Lb,qb,bc,sc){super(Lb,qb,bc,sc)}get J5(){return 16}get Qeb(){return this.gridView.ga.rangePicker.khd(!1)}YTa(){return(this.gridView.inRangePicker||this.gridView.ni)&&super.YTa()}}Object(b.a)(Qa,"RangePickerTouchGrippiesBehavior",T,[]);class Z extends E{constructor(Lb,qb){super(Lb);const bc=document.createElement("div"),sc=document.createElement("div");bc.className=qb?Ga.sHh:Ga.uHh;sc.className=qb?Ga.tHh:Ga.rHh;Lb.appendChild(bc);Lb.appendChild(sc)}}Object(b.a)(Z,
"RearrangeHighlightBehavior",E,[]);var wa;(function(Lb){Lb[Lb.topLeft=0]="topLeft";Lb[Lb.topRight=1]="topRight";Lb[Lb.bottomLeft=2]="bottomLeft";Lb[Lb.bottomRight=3]="bottomRight";Lb[Lb.error=4]="error"})(wa||(wa={}));Object(b.b)("Corner",wa);class Ea extends E{constructor(Lb,qb,bc,sc,Tb){super(Lb);this.Db=this.lG=null;this.p4=0;this.Kb=this.sourceRange=null;this.IUa=!1;this.onPointerDown=$a=>{$a=ha.a(this.$).xe($a);if(this.Vag($a)&&!this.IUa){this.Evf();this.Db=this.Co.udc();this.lG=this.Co.h$e($a);
if(!this.Db||!this.lG||!this.lG.range)return x.ULS.shipAssertTag(537159361,0,!!this.Db,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),x.ULS.shipAssertTag(537159360,0,!!this.lG,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),x.ULS.shipAssertTag(537159331,0,!!this.lG.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Kb=this.lG.range.clone();this.sourceRange=this.Kb.clone();this.p4=this.S5e($a);if(4===this.p4)return x.ULS.shipAssertTag(537159330,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Nb=this.O7e($a,!0);if(!Nb)return x.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.cLe(Nb))return x.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.tNa=!0;this.Db.XE(!1);this.RF.PQe($a.Vb);this.Co.DUf(!0,this.xca.BU);this.Db.textBox.removeSelection();
this.Db.F1b(this.Ucf);this.YXf();this.IUa=!0;sa.b(this.$,!0)}return!0};this.pj=$a=>{$a=ha.a(this.$).xe($a);$a=this.O7e($a,!1);if(!$a)return!0;$a=this.cLe($a);if(!$a)return x.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.scc(!0),!1;if(this.Kb.equals($a))return!0;this.Kb=$a;$a=this.SS();$a||(x.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.scc(!0));return $a};this.qh=$a=>{ha.a(this.$).xe($a);
$a=this.zX();x.ULS.shipAssertTag(537159325,0,$a,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.scc(!$a);return $a};this.Ucf=()=>{this.scc(!0)};this.gridView=qb;this.$=qb.$;this.rL=[];this.ga=this.gridView.ga;this.RF=bc;this.Co=sc;this.xca=Tb;this.coloredReferencesManager=this.$.da.Aa(281);x.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
if(this.rN=D.a.aI(this.$))qb=this.$.da.Aa(464),x.ULS.shipAssertTag(510255176,0,!!qb,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.kB=qb.kB;for(const $a of this.k2f())qb=this.Co.$7c(Lb,$a,this.Kue(),this.onPointerDown),this.rL.push(qb);for(const $a of this.rL)w.a.instance.ta(m.a.QW,$a,this.RF.ggf),w.a.instance.ta(m.a.OB,$a,this.RF.hgf);this.W_a(Tb)}dispose(){this.rL.forEach(Lb=>{w.a.instance.Ba(m.a.pointerDown,Lb,
this.onPointerDown)});this.rL.length=0;super.dispose()}W_a(Lb){this.xca=Lb;this.Tue(Lb);this.Co.xOb(Lb,this.rL,this.qWd());this.RF.Y0()}O7e(Lb,qb){const bc=Lb.Vb;Lb=Lb.clientPoint;if(!bc||!Lb)return x.ULS.shipAssertTag(537159324,0,!!bc,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),x.ULS.shipAssertTag(537159323,0,!!Lb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;qb&&(Lb=this.Jzf(Lb));qb=this.ga.qq(Lb,bc,0,!0,!1,!0);qb||(Lb=this.Jzf(Lb),qb=this.ga.qq(Lb,
bc,0,!0,!1,!0));return qb}Jzf(Lb){Lb.y+=0===this.p4||1===this.p4?2:-2;Lb.x+=0===this.p4||2===this.p4?2:-2;return Lb}cLe(Lb){if(!Lb||!this.sourceRange)return x.ULS.shipAssertTag(537159322,0,!!Lb,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),x.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.p4)return new V.Range(Lb.top,Lb.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.p4)return new V.Range(Lb.top,
this.sourceRange.left,this.sourceRange.bottom,Lb.right,!0,!1);if(2===this.p4)return new V.Range(this.sourceRange.top,Lb.left,Lb.bottom,this.sourceRange.right,!0,!1);if(3===this.p4)return new V.Range(this.sourceRange.top,this.sourceRange.left,Lb.bottom,Lb.right,!0,!1);x.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${wa[this.p4]}`);return null}zX(){return this.rN?this.kB.yGb(this.Db,this.lG,this.Kb):this.coloredReferencesManager.yGb(this.Db,
this.lG,this.Kb)}SS(){return this.zX()}scc(Lb){Lb&&x.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.RF.QQe(this.rL[0]);this.Co.DUf(!1,this.xca.BU);this.Db.textBox.setCaretPositionToEnd();this.Db.Rwc(this.Ucf);this.amg();this.IUa=this.gridView.tNa=!1;sa.b(this.$,!1);this.Co.vWf()}}Object(b.a)(Ea,"ResizeMarqueeBehaviorBase",E,[]);class fa extends Ea{constructor(Lb,qb,bc,sc,Tb){super(Lb,
qb,bc,sc,Tb)}k2f(){return[Ga.yHh,Ga.zHh,Ga.wHh,Ga.xHh]}Kue(){return[Ga.vHh]}S5e(Lb){Lb=Lb.Vb;if(Lb===this.rL[0])return 0;if(Lb===this.rL[1])return 1;if(Lb===this.rL[2])return 2;if(Lb===this.rL[3])return 3;x.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}YXf(){this.Co.oO(this.pj,this.qh,!0)}amg(){this.Co.T1d(this.pj,this.qh,!0)}Vag(Lb){return 2===(N.a.Eb=Lb.Cb)&&Lb.oo===Sys.UI.MouseButton.leftButton}qWd(){return!0}Evf(){x.ULS.sendTraceTag(537159317,
0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}Tue(Lb){for(const qb of this.rL)qb.style.backgroundColor=Lb.tg.style.borderColor}}Object(b.a)(fa,"ResizeMarqueeMouseBehavior",Ea,[]);class Ua extends Ea{constructor(Lb,qb,bc,sc,Tb){super(Lb,qb,bc,sc,Tb);this.$Hb=()=>{const $a=3===N.a.Eb;this.hxd&&!$a?this.Co.xOb(this.xca,this.rL,!1):!this.hxd&&$a&&this.Co.xOb(this.xca,this.rL,!0);this.hxd=$a};this.x3i=($a,Nb)=>{Nb.B7a===this.xca.BU&&this.Co.xOb(this.xca,
this.rL,!Nb.start&&this.qWd())};N.a.Gte(this.$Hb);this.hxd=3===N.a.Eb;this.Co.JRg(this.x3i)}dispose(){N.a.n_f(this.$Hb);super.dispose()}k2f(){return[la.a.AGh,la.a.zGh]}Kue(){const Lb=!ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[Lb?la.a.OXe:la.a.NXe,la.a.mbc,Lb?la.a.yGh:la.a.lbc]}S5e(Lb){Lb=Lb.Vb;if(Lb===this.rL[0])return 0;if(Lb===this.rL[1])return 3;x.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4}YXf(){u.a.Ww?this.Co.oO(this.pj,this.qh,!1):this.Co.Hlj(this.pj,this.qh)}amg(){u.a.Ww?this.Co.T1d(this.pj,this.qh,!1):this.Co.j4j(this.pj,this.qh)}Vag(Lb){return 3===(N.a.Eb=Lb.Cb)}qWd(){return 3===N.a.Eb}Evf(){x.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}Tue(){}}Object(b.a)(Ua,"ResizeMarqueeTouchBehavior",Ea,[]);class Aa extends E{constructor(Lb,qb){super(Lb);Aa.Ytb(Lb,H.a.QGh+" "+la.a.Nva,null===qb||void 0===
qb?void 0:qb.horizontal);Aa.Ytb(Lb,H.a.PGh+" "+la.a.Nva,null===qb||void 0===qb?void 0:qb.vertical);Aa.Ytb(Lb,H.a.MGh+" "+la.a.Nva,null===qb||void 0===qb?void 0:qb.horizontal);Aa.Ytb(Lb,H.a.OGh+" "+la.a.Nva,null===qb||void 0===qb?void 0:qb.vertical);Aa.Ytb(Lb,la.a.NGh)}static Ytb(Lb,qb,bc){const sc=document.createElement("div");sc.className=qb;bc&&(sc.style.backgroundImage=`url("${bc}")`);Lb.appendChild(sc)}}Object(b.a)(Aa,"SelectionCutCopyBehavior",E,[]);class Ib extends E{constructor(Lb){super(Lb);
appChrome.renderSpinner(Lb)}}Object(b.a)(Ib,"SelectionPasteBehavior",E,[]);class Pb extends E{constructor(Lb,qb){super(Lb);Pb.nub(Lb,H.a.qHh+" "+la.a.Nva,null===qb||void 0===qb?void 0:qb.horizontal);Pb.nub(Lb,H.a.pHh+" "+la.a.Nva,null===qb||void 0===qb?void 0:qb.vertical);Pb.nub(Lb,H.a.mHh+" "+la.a.Nva,null===qb||void 0===qb?void 0:qb.horizontal);Pb.nub(Lb,H.a.oHh+" "+la.a.Nva,null===qb||void 0===qb?void 0:qb.vertical);Pb.nub(Lb,la.a.nHh)}static nub(Lb,qb,bc){const sc=document.createElement("div");
sc.className=qb;bc&&(sc.style.backgroundImage=`url("${bc}")`);Lb.appendChild(sc)}}Object(b.a)(Pb,"SelectionRangePickerBehavior",E,[]);class Fa extends T{constructor(Lb,qb,bc,sc){super(Lb,qb,bc,sc)}get J5(){return 0}get Qeb(){return this.gridView.ga.qa.gd}YTa(){const Lb=this.gridView.ni||this.gridView.jb;return this.gridView.ga.qa.ph&&!Lb&&super.YTa()}}Object(b.a)(Fa,"SelectionTouchGrippiesBehavior",T,[]);var da=a(54);class K extends v.a{constructor(Lb,qb){super();this.D0a=(bc,sc)=>{bc=sc.J5;const Tb=
this.gridView;sc=sc.uii;const $a=sc.tg,Nb=sc.ZY;u.a.Xg&&Nb.push(new wb($a,Tb));switch(bc){case 24:sc.ZY.push(new Ab($a,sc));break;case 0:sc.ZY.push(new ab($a,Tb));u.a.yp||(Nb.push(new yb($a,this.gridView.$,sc.paneType,this.tableManager,this.Co)),ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Nb.push(new db($a,this.gridView.$,sc.paneType,this.tableManager,this.Co)));Nb.push(new Fa(sc,$a,Tb,sc.paneType));break;case 3:Nb.push(new Ca($a));u.a.yp||(Nb.push(new qa($a,
this.gridView.$,sc.paneType,this.RF,this.Co,sc)),Nb.push(new fa($a,this.gridView,this.RF,this.Co,sc)),Nb.push(new Ua($a,this.gridView,this.RF,this.Co,sc)));break;case 4:case 5:Nb.push(new Aa($a,this.ewe));break;case 30:Nb.push(new Ib($a));break;case 16:Nb.push(new Pb($a,this.ewe));Nb.push(new Qa(sc,$a,Tb,sc.paneType));break;case 11:case 12:Nb.push(new Z($a,11===bc));break;case 17:Nb.push(new Ca($a));break;case 19:Nb.push(new Ca($a)),Nb.push(new ua(sc,$a,Tb,sc.paneType))}sc.M3b=!0};this.$=Lb;this.gridView=
bb.h(Lb);this.tableManager=qb;this.RF=new tb(this.gridView);this.Co=new B(this.gridView);this.gridView.Jb&&(this.gridView.Jb.eRg(this.D0a),this.gridView.Jb.update(!1));Lb.da.Ha(64,this)}get ewe(){ea.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.dwe&&(this.dwe={vertical:da.a.current.io(105),horizontal:da.a.current.io(106)});return this.dwe}dispose(){this.gridView.Jb.Wpj(this.D0a);this.RF&&(this.RF.dispose(),this.RF=null);super.dispose()}}Object(b.a)(K,"GridHighlightsBehaviorManager",
v.a,[]);var xa=a(41),rb=a(157);class Qb extends f.a{constructor(Lb){super();this.$=Lb;this.Mb()}create(){const Lb=qb=>{this.vb(this.$.da.Aa(64)||new K(this.$,qb))};ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?void rb.a.resolve(xa.db,{rb:this.Na}).then(Lb):l.TaskExtensions.za(r.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Na),qb=>Lb(qb.result),this.ka,3)}static la(Lb){Lb.da.Ha(149,new Qb(Lb))}}Object(b.a)(Qb,"GridHighlightsBehaviorManagerFactory",
f.a,[]);a.d(C,"a",function(){return pc});const pc=()=>{c.a.Fa(Qb.la);c.a.Fa(h.la)}},1200:function(t,C,a){t=a(0);var c=a(14),b=a(708),f=a(562),e=a(88),d=a(89),h;(function(Ba){Ba[Ba.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";Ba[Ba.cloudPolicySettings=1]="cloudPolicySettings";Ba[Ba.alternateAuthToken=2]="alternateAuthToken"})(h||(h={}));Object(t.b)("ApplicationFeatureHelperRequestType",h);class r{constructor(){this.message=null;this.m7a=0}}Object(t.a)(r,"HttpRequstToPromiseRejectData",
null,[]);var l=a(104),u=a(83),v=a(247),x=a(585);class w{constructor(Ba,qa){this.$a=Ba;this.zh=qa}u8c(Ba,qa,pa,ya=null,za=null,cb=null,Pa=null,nb=null){const Ma=h[pa],Oa=Ma+"RequestFailure";l.Health.instance.recordKpiUsage(Oa,0,"jpittsdirects",null);return new Promise((La,ra)=>{c.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Ma);const V=null!=Pa?Pa:this.$a.Dd("ApplicationFeatureHelperRequestQueueTimeout",15E3),ma=null!=nb?nb:
this.$a.Dd("ApplicationFeatureHelperRequestSentTimeout",3E4);this.zh.Uha(Ba,1,null,this.A0h(pa,ya),cb,!1,1,W=>{c.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Ma);try{if(void 0===W||null===W||void 0===W.data||null===W.data||void 0===W.data.te||null===W.data.te){l.Health.instance.recordKpiFailure(Oa,"Invalid RequestSucceededEventArgs",!1,!0,null);let ia=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
Ma);ra(this.jzb(ia,W))}else if(W.data.httpStatus!==v.a.oP){l.Health.instance.recordKpiFailure(Oa,"HttpStatusCode_"+W.data.httpStatus.toString(),!1,!0,null);let ia=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",W.data.httpStatus,Ma);ra(this.jzb(ia,W))}else{void 0!==za&&null!==za&&void 0!==W.data.responseHeaders&&null!==W.data.responseHeaders&&za(W.data.responseHeaders);var aa=
qa(W.data.te);if(aa)c.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Ma),La(aa);else{l.Health.instance.recordKpiFailure(Oa,"Parse Failure",!1,!0,null);let ia=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Ma);ra(this.jzb(ia,W))}}}catch(ia){l.Health.instance.recordKpiFailure(Oa,"Unexpected Failure",!1,!0,null),aa=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
ia,Ma),ra(this.jzb(aa,W))}},W=>{if(W.data){l.Health.instance.recordKpiFailure(Oa,"HttpStatusCode_"+W.data.httpStatus.toString(),!1,!0,null);var aa=x.a.v6a(W.data.te||"No Data");aa=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",W.data.httpStatus,aa,Ma)}else l.Health.instance.recordKpiFailure(Oa,"Invalid RequestFailedEventArgs",!1,!0,null),aa=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
Ma);ra(this.jzb(aa,W))},null,void 0,void 0,V,ma)})}jzb(Ba,qa){const pa=new r;pa.message=Ba;pa.m7a=qa&&qa.data?qa.data.httpStatus:-1;return pa}A0h(Ba,qa){const pa={};pa["x-UserDataSignature"]=this.$a.Wa("UserDataSignature");pa["x-LicensingIsEnabled"]=this.$a.ra("LicensingIsEnabled").toString();pa["x-CacheIsEnabled"]=this.$a.ra("LicensingRedisIsEnabled").toString();pa["x-OcpsIsEnabled"]=this.$a.ra("OcpsIsEnabled").toString();pa["x-LicensingAADIdIsEnabled"]=this.$a.ra("LicensingAadIdIsEnabled").toString();
0===Ba&&(pa["x-LicenseCheckOnTenantEnabled"]="true",pa["x-SupportUserConsentDependentFeatures"]="true",pa["x-AFHUserConsentGroupValue"]="0",pa["x-UseShellServiceForUserConsentGroup"]="true",pa["x-SMBUserLicensingEnabled"]="true",pa["x-AFHPIPLComplianceEnabled"]=u.a.Pw(window.location.href,"wd_afhpipl")||"false");if(qa)for(let ya of qa.keys)pa[ya]=qa.ma(ya);return pa}}Object(t.a)(w,"HttpRequestToPromiseUtility",null,[]);var m=a(6),n;(function(Ba){Ba[Ba.loki=0]="loki";Ba[Ba.augloopACLP=1]="augloopACLP"})(n||
(n={}));Object(t.b)("AlternateAuthSupportApp",n);var z=a(566),y=a(42);class A{constructor(){this.Token=null;this.ExpirationTime=0}}Object(t.a)(A,"WacAlternateAuthToken",null,[]);class F{constructor(Ba,qa){this.k_j=3E5;if(void 0===Ba||null===Ba||void 0===qa||null===qa)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.$a=Ba;this.ETb=new b.a(f.a.$h());this.olb=new w(Ba,qa);void 0!==z.OAuthManagerSettings.Jzd&&null!==z.OAuthManagerSettings.Jzd&&void 0!==z.OAuthManagerSettings.qoc&&
null!==z.OAuthManagerSettings.qoc&&0<z.OAuthManagerSettings.qoc&&(Ba=new A,Ba.Token=z.OAuthManagerSettings.Jzd,Ba.ExpirationTime=z.OAuthManagerSettings.qoc,this.ETb.ia("loki",Ba))}DTh(){let Ba=null;this.ETb.nb(n[0])&&(Ba=this.ETb.ma(n[0]));return void 0===Ba||null===Ba||this.Pvd(Ba)?this.oKh():Promise.resolve(Ba.Token)}Pvd(Ba){return Ba.ExpirationTime-Date.now()<this.k_j}oKh(){const Ba=new b.a(f.a.$h());Ba.ia("X-AlternateAuthApp",n[0]);return this.olb.u8c(this.Dwa("/afhs/AlternateAuthHelperHandler.ashx"),
Object(e.a)(this,this.u9i,"parseAlternateAuthTokenResponse"),2,Ba).then(qa=>{c.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",n[0]);this.ETb.ia(n[0],qa);return qa.Token},qa=>{qa=Object(d.a)(r,qa);c.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",qa.message,qa.m7a);return null})}u9i(Ba){let qa=null;({Ft:qa}=y.d(Ba));c.ULS.sendTraceTag(545821457,3004,
qa?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",Ba);return qa}Dwa(Ba){return String.format("{0}{1}?{2}",this.$a.Wa("WebServiceBase"),Ba,m.AFrameworkApplication.Di)}}Object(t.a)(F,"AlternateAuthHelper",null,[313]);var D=a(464);class B{constructor(Ba,qa,pa){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=Ba;this.isEnabled=qa;this.tierName=pa}}Object(t.a)(B,"FeatureStateChangeArgs",null,[]);var M=a(145),R=a(264),P=a(29),E=a(117),H=a(181),G;
(function(Ba){Ba[Ba.Enabled=0]="Enabled";Ba[Ba.Disabled=1]="Disabled"})(G||(G={}));Object(t.b)("FeatureState",G);var N=a(84),I=a(26),O=a(200);class U{constructor(Ba,qa,pa=null,ya=null,za=null){this.Uva=this.dZb=this.Ike=this.csa=this.f_b=null;this.olb=new w(Ba,qa);this.$a=Ba;this.cEg=Ba.Dd("LicensingMaxRetryAttempts",0);this.LWb=Ba.ra("IsO365ConsumerHost");this.bQc=Ba.ra("IsO365CommercialHost");this.NPc=Ba.ra("PremiumUpsellIsEnabled");this.eYa=!1;this.iRc=0;this.Y8d=pa;this.Woe=ya;this.La=za;this.bsa=
Ba.ra("LicensingIsEnabled");this.hGa=Ba.ra("OcpsIsEnabled")&&this.bQc;this.wXc=Ba.ra("ShowPrivacyDialog")&&!!ya;this.oPc=Ba.ra("IsAnonymousUser");this.Nbc=new Promise(cb=>{cb(!1)});this.mDa=new Promise(cb=>{cb(!0)});this.Tva=new b.a(f.a.$h());this.V_b=!0;this.Vfe=this.e2h();this.Ttd()&&!this.oPc?(void 0!==m.AFrameworkApplication.sa&&null!==m.AFrameworkApplication.sa&&(this.f_b=m.AFrameworkApplication.sa.jE,void 0!==this.f_b&&null!==this.f_b&&(this.csa=this.f_b.Dg("WebServiceCall","ApplicationFeatureHelperService"))),
this.Uva=this.q1d()):this.Uva=new Promise(cb=>{cb({})});this.Uva.catch(cb=>{cb=Object(d.a)(r,cb);c.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",cb?cb.m7a.toString():"Unknown")});this.V_b&&this.isFeatureEnabled("FreemiumUpsell",!0).then(cb=>{this.eYa=cb;return null})}e2h(){const Ba=this.$a.Sp("AllLicensedFeatures")?this.$a.Ow("AllLicensedFeatures"):[],qa=new D.a;for(let pa=0;pa<Ba.length;pa++)qa.add(Ba[pa]);return qa}Ttd(){return this.bQc||this.LWb}q1d(Ba=
0,qa=!1){c.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",qa);const pa=M.a.gs();pa&&(pa.set("retryAttempt",Ba.toString()),pa.set("forceRefresh",qa.toString()),pa.set("isO365ConsumerHost",this.LWb.toString()),pa.set("isO365CommercialHost",this.bQc.toString()),pa.set("isFreemiumUpsellSettingEnabled",this.NPc.toString()));l.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",pa);l.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",
1,"waclicensing",pa);void 0!==this.csa&&null!==this.csa&&this.csa.start();let ya=null;qa&&(ya=new b.a(f.a.$h()),ya.ia("x-LicensingForceRefresh","true"));this.Ike=new Date;return(this.bsa?this.olb.u8c(this.Dwa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(e.a)(this,this.x9i,"parseApplicationFeatureHelperResponse"),0,ya,Object(e.a)(this,this.Zdj,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(za=>{const cb=Object.assign(new O.a,{durationMs:this.Bfg()});cb.extendedProperties=
pa;cb.extendedProperties&&za&&(cb.extendedProperties.set("featureCount",E.a.count(za).toString()),cb.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in za).toString()),cb.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in za).toString()),"FreemiumUpsell"in za&&cb.extendedProperties.set("isFreemiumUpsellEnabled",za.FreemiumUpsell.toString()),this.dZb&&cb.extendedProperties.set("fromCache",(this.dZb<this.Ike).toString()));l.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
cb);return za},za=>{const cb=Object.assign(new O.a,{durationMs:this.Bfg()}),Pa=Object(d.a)(r,za);if(!Pa)return c.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),l.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,cb),new Promise((nb,Ma)=>{Ma(za)});cb.extendedProperties=pa;cb.extendedProperties&&cb.extendedProperties.set("status",Pa.m7a.toString());l.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"RequestFailed",!1,!0,cb);return 408===Pa.m7a&&++Ba<=this.cEg?this.q1d(Ba):new Promise((nb,Ma)=>{Ma(Pa)})})}x9i(Ba){(Ba=y.b(Ba))?(c.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),c.ULS.sendTraceTag(50938594,3004,50,"{0}",Ba)):c.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Ba.Features}Dwa(Ba){var qa=String.format("{0}{1}",this.$a.Wa("WebServiceBase"),
Ba);this.$a.Sp("ApplicationFeatureHelperHttpCachingEnabled")&&this.$a.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(Ba=U.Pec(this.$a))&&0<Ba.length&&(this.V_b&&(Ba+="ucbf"),qa=new R.QueryStringBuilder(qa),qa.vj("afhskey",Ba),qa=qa.toString());return qa}isFeatureEnabled(Ba,qa){if(!this.hGa&&!this.wXc&&!this.bsa)return this.mDa;c.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",Ba);if("ConnectedServices"===Ba){var pa=
this.hGa?this.Y8d.YM("ControllerConnectedServicesEnabled"):this.mDa;const cb=this.wXc?this.Woe.getSettings().then(Pa=>2!==Pa.Cu,()=>qa):this.mDa;return pa.then(Pa=>Pa?cb:this.Nbc)}if("FreemiumUpsell"===Ba&&(!this.NPc||!this.LWb||this.oPc))return this.Nbc;pa=null;pa=this.hGa?this.Y8d.isFeatureEnabled(Ba):this.mDa;let ya=null;ya=this.bsa?this.fui(Ba,qa):this.mDa;let za=null;za=this.wXc?this.Woe.isFeatureEnabled(Ba):this.mDa;return pa.then(cb=>cb?za.then(Pa=>Pa?ya:this.Nbc):this.Nbc).then(cb=>{this.Suf(Ba,
cb,!0);return cb},()=>{this.Suf(Ba,qa,!1);return qa})}Suf(Ba,qa,pa){c.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",Ba,qa,pa)}getFeatureTier(Ba,qa){if(!this.bsa)return new Promise(pa=>{pa(2)});c.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",Ba);return this.Uva.then(pa=>this.Mfc(Ba,pa,qa),()=>qa)}isFreemiumUpsellEnabled(){if(this.NPc&&this.LWb&&!this.oPc){if(this.eYa&&2!==this.iRc||!this.eYa&&1!==this.iRc)c.ULS.sendTraceTag(509728161,
3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.eYa.toString()),this.iRc=this.eYa?2:1;return this.eYa}return!1}launchUpsellExperience(Ba,qa=null){c.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",Ba));var pa=M.a.gs();pa&&(pa.set("experienceId",Ba),qa&&pa.set("campaignId",qa));l.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",
pa);if(pa=N.a.instance.yg("Common.IInProductMessagingUIManager")){const ya=Object(e.a)(this,this.fdi,"handleDimeTaskComplete");pa.Usf(Ba,ya,qa)}else c.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),l.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.La.ie(I.a.bdc,2,{["experience"]:Ba})}kBa(Ba,qa){if(!this.bsa)return null;if(!Ba||!qa)return c.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const pa=H.a.create().toString();this.Tva.nb(Ba)||this.Tva.ia(Ba,new b.a(f.a.$h()));this.Tva.ma(Ba).add(pa,qa);c.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",pa,Ba));return pa}uNd(Ba,qa){this.bsa&&(Ba&&this.Tva.nb(Ba)?qa&&H.a.isValid(qa)?this.Tva.ma(Ba).nb(qa)?(c.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
qa,Ba)),this.Tva.ma(Ba).remove(qa)):c.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",qa,Ba)):c.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",qa,Ba)):c.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
Ba)))}Mfc(Ba,qa,pa){return this.V_b?Ba in qa?qa[Ba].LicenseTier:pa:Ba in qa?this.V9i(qa[Ba],pa):pa}V9i(Ba,qa){switch(Ba.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return qa}}fdi(){c.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Uva.then(Ba=>{this.nXf(Ba)}).catch(()=>{this.nXf({})})}nXf(Ba){c.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const qa=
this.q1d(0,!0);qa.then(pa=>{this.Uva=qa;E.a.count(pa)>E.a.count(Ba)?l.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):l.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let ya of this.Tva.keys)if(ya in pa){const za=this.Mfc(ya,pa,0);ya in Ba?this.Mfc(ya,Ba,0)!==za&&this.wDd(ya,!0,za):this.wDd(ya,!0,za)}else ya in Ba&&this.wDd(ya,!1,this.Mfc(ya,Ba,0))}).catch(pa=>{l.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",
!1,!0,null);c.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(pa))})}wDd(Ba,qa,pa){c.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",Ba,qa,pa);qa=new B(Ba,qa,pa);pa=this.Tva.ma(Ba);for(let ya of pa)try{ya.value(qa)}catch(za){c.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
Ba,ya.key,za.message))}}Zd(Ba,qa){if(this.bsa){const pa=this.Vfe.contains(Ba);let ya=!0,za="",cb=!1;return this.Uva.then(Pa=>{Ba in Pa?(Pa=Pa[Ba],za=G[Pa.FeatureState],ya=1!==Pa.FeatureState):ya=!pa;this.avf(Ba,pa,za,cb,qa,ya);return ya},()=>{cb=!0;pa&&(ya=qa);this.avf(Ba,pa,za,cb,qa,ya);return ya})}return this.mDa}avf(Ba,qa,pa,ya,za,cb){c.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",
Ba,qa,ya,pa,za,cb)}fui(Ba,qa){if(this.V_b)return this.Zd(Ba,qa);if(this.bsa){if(this.Vfe.contains(Ba))return this.Uva.then(pa=>Ba in pa,()=>qa);c.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",Ba)}return this.mDa}Zdj(Ba){try{Ba&&"Date"in Ba&&(this.dZb=new Date(Ba.Date),c.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.dZb.toString()))}catch(qa){c.ULS.sendTraceTag(578863818,
3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",qa)}}Bfg(){if(void 0!==this.csa&&null!==this.csa){const Ba=this.csa.Jc;this.csa.stop();return Ba}return null}static Pec(Ba){try{if(P.a.oWj){const qa=Ba.Wa("UserDataSignature").split(".");if(1<qa.length){const pa=window.self.atob(qa[1]),ya=JSON.parse(pa).LocalStorageKey;if(void 0!==ya&&null!==ya&&0<ya.length)return ya}}}catch(qa){c.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",qa.toString())}return null}}
Object(t.a)(U,"ApplicationFeatureHelper",null,[314]);var ca=a(198);class Q{constructor(Ba,qa){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=Ba.PolicySettings;Ba=new Date;Ba.setMinutes(Ba.getMinutes()+qa);this.ExpirationTime=Ba.getTime()}}Object(t.a)(Q,"CloudPolicySettingsCacheData",null,[]);var Y=a(812),la=a(384),ea=a(234);class ha{static Kdg(){return m.AFrameworkApplication.fa.ra("SideCarIsEnabled")?ha.czc&&ha.rsd?new Promise(Ba=>{Ba(!0)}):new Promise((Ba,qa)=>{ha.czc=ea.a.create(m.AFrameworkApplication.fa.Wa("SideCarUrl"));
la.a.Qja(ha.czc);ha.czc.U$((pa,ya)=>{(ha.rsd=ya.succeeded)?Ba(ya.succeeded):qa(ya.succeeded)})}):new Promise(Ba=>{Ba(!1)})}}ha.rsd=!1;ha.czc=null;Object(t.a)(ha,"SideCarLoader",null,[]);class X{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(t.a)(X,"CloudPolicySettingsData",null,[]);class T{constructor(Ba,qa){this.UKc=0;this.n6b=null;this.olb=new w(Ba,qa);this.$a=Ba;qa=Ba.Wa("HostAuthType");this.hGa=Ba.ra("OcpsIsEnabled")&&Ba.ra("IsO365CommercialHost")&&
!(void 0===qa||null===qa)&&"aad"===qa.toLowerCase();this.die=y.b(Ba.Wa("OcpsDefaultSettings")||"{}");this.jmb=this.Pec();qa=this.$a.Sp("ServicesControlsMicrosoftControllerServicesList")?this.$a.Ow("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.FUb=new D.a;for(let pa=0;pa<qa.length;pa++)this.FUb.add(qa[pa]);this.hGa&&!Ba.ra("IsAnonymousUser")&&Ba.ra("SideCarIsEnabled")?this.n6b=this.q2j():this.n6b=this.kqa(this.hGa,this.Dwa("/afhs/CloudPolicySettings.ashx"),Object(e.a)(this,this.y9i,
"parseCloudPolicySettingsResponse"));this.n6b.then(()=>null).catch(pa=>{pa=Object(d.a)(r,pa);c.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",pa?pa.m7a.toString():"Unknown")})}YM(Ba,qa=!0){if(!this.hGa){const cb=this;return new Promise(Pa=>{Pa(cb.Uyb(Ba))})}let pa=this,ya=this;const za=this.n6b.then(cb=>{try{let Pa=null;cb.PolicySettings&&"unknown"in cb.PolicySettings&&(Pa=cb.PolicySettings.unknown);if(Pa){if(Ba in Pa&&void 0!==Pa[Ba]&&null!==Pa[Ba])return new Promise(Ma=>
{Ma("0"!==Pa[Ba])});const nb=Ba.toLowerCase();if(nb in Pa&&void 0!==Pa[nb]&&null!==Pa[nb])return new Promise(Ma=>{Ma("0"!==Pa[nb])});c.ULS.sendTraceTag(51512667,3004,50,"Policy"+Ba+" not found, using default");return new Promise(Ma=>{Ma(pa.Uyb(Ba))})}return new Promise(nb=>{nb(pa.Uyb(Ba))})}catch(Pa){return c.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+Ba+" policy value. Error Message: {0}",Pa.message),pa.handleError(Pa.toString(),qa,pa.Uyb(Ba))}},cb=>ya.handleError(cb,qa,ya.Uyb(Ba)));za.then(cb=>
{c.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",Ba,cb);return null});return za}isFeatureEnabled(Ba,qa=!0){if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.hui(Ba,qa);let pa=new Promise(za=>{za(!0)}),ya="";this.FUb.contains(Ba)&&(ya="ControllerConnectedServicesEnabled",pa=this.YM(ya,qa));pa.then(za=>{c.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
Ba,za,ya);return null});return pa}hui(Ba,qa=!0){let pa=new Promise(za=>{za(!0)}),ya="";"mso_sendASmile"===Ba?ya="Enabled":"Survey"===Ba||"FloodgateSurvey"===Ba?ya="SurveyEnabled":this.FUb.contains(Ba)&&(ya="ControllerConnectedServicesEnabled");""!==ya&&(pa=this.YM(ya,qa));pa.then(za=>{c.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",Ba,za,ya);return null});return pa}handleError(Ba,qa,pa){return qa?new Promise(ya=>
{ya(pa)}):new Promise((ya,za)=>{za(Ba)})}kqa(Ba,qa,pa){if(!Ba)return Promise.resolve(new X);let ya=!1,za=null;l.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let cb=this.P7c("GetCloudPolicySettings");return(new Promise((Pa,nb)=>{if(void 0!==this.jmb&&null!==this.jmb&&0<this.jmb.length){const Ma=this.$1j();if(void 0!==Ma&&null!==Ma){ya=!0;Pa(Ma);return}}this.olb.u8c(qa,pa,1,null,Object(e.a)(this,this.dej,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],
this.$a.Dd("CloudPolicySettingsRequestQueueTimeout",15E3),this.$a.Dd("CloudPolicySettingsRequestSentTimeout",3E4)).then(Ma=>{c.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.P2j(Ma);Pa(Ma);return Ma},Ma=>{nb(Ma);return null})})).then(Pa=>{({stopwatch:cb,returnValue:za}=this.gDc(cb));var nb=M.a.gs();nb&&nb.set("FromCache",ya.toString());nb=Object.assign(new O.a,{durationMs:za,extendedProperties:nb});l.Health.instance.recordKpiSuccess("GetCloudPolicySettings",
nb);return Pa})}q2j(){return ha.Kdg().then(()=>{c.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Dwa(Ba){return String.format("{0}{1}",this.$a.Wa("WebServiceBase"),Ba)}y9i(Ba){let qa=null;({Ft:qa}=y.d(Ba));Ba=!!qa;c.ULS.sendTraceTag(50622687,3004,Ba?50:10,"ParseCloudPolicySettingsResponse: Success={0}",Ba);return qa}dej(Ba){try{if(void 0!==Ba&&null!==Ba&&"CheckIn-Interval"in
Ba){const qa=parseInt(Ba["CheckIn-Interval"]);void 0!==qa&&null!==qa&&0<qa&&(this.UKc=qa)}}catch(qa){c.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",qa)}}Uyb(Ba){return Ba in this.die?"0"!==this.die[Ba]:!0}$1j(){try{const Ba=Y.a.instance.getItem(this.jmb);if(void 0===Ba||null===Ba)return c.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;c.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",
Ba);const qa=JSON.parse(Ba);if(void 0===qa||null===qa)return c.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===qa.ExpirationTime||null===qa.ExpirationTime)return c.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(qa.ExpirationTime)).getTime()<Date.now())return c.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const pa=new X;pa.PolicySettings=qa.PolicySettings;pa.ControllerConnectedServicesFeatureNames=new ca.a;this.$a.Sp("ServicesControlsMicrosoftControllerServicesList")&&this.$a.Ow("ServicesControlsMicrosoftControllerServicesList");for(let ya of this.FUb)pa.ControllerConnectedServicesFeatureNames.add(ya);c.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return pa}catch(Ba){return c.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
Ba.toString()),null}}P2j(Ba){try{if(void 0===Ba||null===Ba||void 0===Ba.PolicySettings||null===Ba.PolicySettings)c.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.UKc)c.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const qa=new Q(Ba,this.UKc),pa=JSON.stringify(qa);c.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",pa);Y.a.instance.setItem(this.jmb,
pa);c.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(qa){c.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",qa.toString())}}Pec(){const Ba=U.Pec(this.$a);return Ba&&0<Ba.length?"OCPS"+Ba:null}P7c(Ba){const qa=N.a.instance.yg("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==qa&&null!==qa?qa.Qc("WebServiceCall",Ba):null}gDc(Ba){if(void 0!==Ba&&null!==Ba){const qa=Ba.Jc;Ba.stop();return{returnValue:qa,
stopwatch:null}}return{returnValue:null,stopwatch:Ba}}}Object(t.a)(T,"CloudPolicySettingsHelper",null,[311]);class ua{constructor(){this.zQe=this.lpg=this.Cu=0;this.AQe=this.mpg=this.CJa="";this.hWc=this.Tfa=2}clone(){const Ba=new ua;Ba.Cu=this.Cu;Ba.lpg=this.lpg;Ba.zQe=this.zQe;Ba.CJa=this.CJa;Ba.mpg=this.mpg;Ba.AQe=this.AQe;Ba.Tfa=this.Tfa;Ba.hWc=this.src;return Ba}get src(){return this.hWc}serialize(Ba=null){const qa={};if(!Ba||Ba.contains(ua.kQa))qa[ua.kQa]=this.Cu;if(!Ba||Ba.contains(ua.oHb))qa[ua.oHb]=
this.CJa;if(!Ba||Ba.contains(ua.pHb))qa[ua.pHb]=this.Tfa;return JSON.stringify(qa)}static create(Ba,qa=null){const pa=new ua;pa.hWc=Ba;void 0!==qa&&null!==qa&&(ua.kQa in qa&&(pa.Cu=qa[ua.kQa]),ua.oHb in qa&&(pa.CJa=qa[ua.oHb]),ua.pHb in qa&&(pa.Tfa=qa[ua.pHb]));return pa}static deserialize(Ba,qa){try{const pa=JSON.parse(Ba);if(void 0!==pa&&null!==pa)return ua.create(qa,pa);c.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",Ba);throw Error.argument("settingsData");
}catch(pa){throw c.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",pa.toString()),pa;}}}ua.kQa="CCS";ua.oHb="CCSTime";ua.pHb="OfficePrivacyRoamedNoticeShown";Object(t.a)(ua,"UserPrivacySettings",null,[]);var Ha=a(140);class Ca{constructor(Ba,qa){if(void 0===Ba||null===Ba||void 0===qa||null===qa)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.$a=Ba;this.zh=qa;this.AVc=this.we=null}Dwa(Ba){var qa=String.format("{0}RoamingServiceHandler.ashx?action=",
this.$a.appSettings.RoamingServiceHandlerWebServiceBase||"");qa=new Sys.StringBuilder(qa);qa.append(Ba);qa.append("&");qa.append(m.AFrameworkApplication.Di);return qa.toString()}executeRequest(Ba,qa,pa,ya=null){return this.zh.Jpb(Ba,qa,ya,null,pa,"33",!1,null,6E4)}saveSettings(Ba){return new Promise((qa,pa)=>{try{if(void 0===this.we||null===this.we||void 0===Ba||null===Ba)c.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),pa("Can't determine setting changes to save");
else{var ya=this.we.Cu!==Ba.Cu;if(2===this.we.src&&ya)this.vyj(Ba),qa(!0);else{var za=this.qCj(Ba);if(void 0===za||null===za||!za.length)c.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),pa("No changes to save");else if(1===this.we.src)qa(this.Vkg(za));else if(0===this.we.src){c.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",za);const cb=this.executeRequest(this.Dwa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
za);cb.continueWith(()=>{if(cb.Ah||cb.Tf)c.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),qa(!1);else{var Pa=cb.result;void 0!==Pa.Ug&&null!==Pa.Ug&&void 0!==Pa.Ug.data&&null!==Pa.Ug.data&&Pa.Ug.data.httpStatus===v.a.oP?(c.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),qa(!0)):(c.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),qa(!1))}})}}}}catch(cb){c.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",cb.toString()),qa(!1)}})}qCj(Ba){if(void 0===this.we||null===this.we||void 0===Ba||null===Ba)throw Error.invalidOperation("User Privacy settings have not been initialized");const qa=new ca.a;0===Ba.src?(this.we.Cu!==Ba.Cu&&(qa.add(ua.kQa),qa.add(ua.oHb)),this.we.Tfa!==Ba.Tfa&&qa.add(ua.pHb)):1===Ba.src&&this.we.Cu!==Ba.Cu&&qa.add(ua.kQa);return qa.count?Ba.serialize(qa):(c.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.AVc){const Ba=this;this.AVc=new Promise(qa=>{try{Ba.we?qa(Ba.we.clone()):Ba.i2j().then(pa=>{Ba.we=pa;qa(Ba.we.clone());return null},()=>{Ba.g2j().then(pa=>{Ba.we=pa;qa(Ba.we.clone());return null},()=>{Ba.h2j().then(pa=>{Ba.we=pa;qa(Ba.we.clone());return null},()=>{c.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");Ba.we=new ua;qa(Ba.we.clone());return null});return null});return null})}catch(pa){c.ULS.sendTraceTag(50860932,
3004,10,"UserPrivacySettings GetSettings: Exception = {0}",pa.toString()),Ba.we=new ua,qa(Ba.we.clone())}})}return this.AVc}i2j(){return new Promise((Ba,qa)=>{try{const ya=-1!==window.location.href.indexOf("&wd_pn=2");if(this.$a.ra("PrivacyDialogShouldCheckRoaming")||ya){var pa=this.executeRequest(this.Dwa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");pa.continueWith(()=>{try{if(pa.Ah||pa.Tf)c.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{const za=pa.result;if(za&&za.Ug&&za.Ug.data)if(za.Ug.data.httpStatus!==v.a.oP)c.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",za.Ug.data.httpStatus);else{if(za.Ug.data.te){Ba(Ca.parse(za.Ug.data.te,0));c.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",za.Ug.data.te);return}c.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else c.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");qa("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(za){c.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",za.toString()),qa("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else c.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),qa("Roaming should not be used")}catch(ya){c.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",ya.toString()),qa("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}g2j(){return new Promise((Ba,qa)=>{try{const pa=Ha.a.get("WacUPToggleState");let ya=null;void 0!==pa&&null!==pa&&0<pa.length&&(ya=decodeURIComponent(pa));if(void 0!==ya&&null!==ya&&0<ya.length){const za=Ca.parse(ya,1);c.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",za.toString());Ba(za)}else{const za=ua.create(1),
cb=new ca.a;cb.add(ua.kQa);const Pa=za.serialize(cb);this.Vkg(Pa)?(c.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Pa),Ba(za)):(c.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Pa),qa("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(pa){c.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
pa.toString()),qa("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}h2j(){return new Promise(Ba=>{try{var qa=-1!==window.location.href.indexOf("&wdccsoff=1");let pa=ua.create(2);qa?(pa.Cu=2,m.AFrameworkApplication.ePe(),c.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",pa.toString())):(pa.Cu=1,c.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",pa.toString()));Ba(pa)}catch(pa){c.ULS.sendTraceTag(50967431,
3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",pa.toString()),qa=ua.create(2),qa.Cu=1,Ba(qa)}})}vyj(Ba){c.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===Ba.Cu?m.AFrameworkApplication.ePe():m.AFrameworkApplication.hwh();c.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",Ba)}Vkg(Ba){try{c.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",Ba);const qa=
this.$a.Wa("PrivacyCookieDomain")||"";if(!qa||!qa.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");c.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",Ba);return Ha.a.LUd("WacUPToggleState",Ba,Ha.a.h0,"/",qa)}catch(qa){return c.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",qa.toString()),!1}}isFeatureEnabled(Ba){return this.getSettings().then(qa=>{const pa=this.$a.Sp("ServicesControlsMicrosoftControllerServicesList")?
this.$a.Ow("ServicesControlsMicrosoftControllerServicesList"):[],ya=new D.a;for(let za=0;za<pa.length;za++)ya.add(pa[za]);return ya.contains(Ba)?2!==qa.Cu:!0},()=>{c.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",Ba);return!0})}static parse(Ba,qa){try{return c.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",Ba,qa),ua.deserialize(Ba,qa)}catch(pa){throw c.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",pa.toString()),
pa;}}}Object(t.a)(Ca,"UserPrivacySettingsHelper",null,[312]);var Ga=a(260);class sa{constructor(){this.ib=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}ki(Ba){this.ib=Ba;this.ib.register(311,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").zc().Gc(()=>new T(m.AFrameworkApplication.fa,m.AFrameworkApplication.Od));this.ib.register(312,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").zc().Gc(()=>new Ca(m.AFrameworkApplication.fa,
m.AFrameworkApplication.Od));this.ib.register(313,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").zc().Gc(()=>new F(m.AFrameworkApplication.fa,m.AFrameworkApplication.Od));this.ib.register(314,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").zc().Gc(()=>new U(m.AFrameworkApplication.fa,m.AFrameworkApplication.Od,this.ib.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.ib.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
m.AFrameworkApplication.xb))}init(){m.AFrameworkApplication.fa.Nu(()=>{const Ba=this.ib.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");m.AFrameworkApplication.fa.ra("LicensingIsEnabled")&&(Ba.isFeatureEnabled("LicensingTestFeature",!1).then(qa=>{c.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",qa,m.AFrameworkApplication.fa.Wa("IsAnonymousUser"));return null}),Ba.getFeatureTier("LicensingTestFeature",
0).then(qa=>{c.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",qa,m.AFrameworkApplication.fa.Wa("IsAnonymousUser"));return null}));this.ib.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.NXj()})}dispose(){}NXj(){try{m.AFrameworkApplication.fa.ra("SideCarIsEnabled")&&ha.Kdg().then(Ba=>{c.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",
Ba);return Ba})}catch(Ba){}}static main(){Ga.a.instance.dj(new sa)}}Object(t.a)(sa,"ApplicationFeatureHelperPackage",null,[4,5]);a.d(C,"a",function(){return bb});const bb=()=>{Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");sa.main()}},1201:function(t,C,a){t={};a.r(t);a.d(t,"EmbeddedWorkbookReadoutHandler",function(){return La});var c={};a.r(c);a.d(c,"WorkbookReadoutHandler",function(){return ra});var b=a(10),f=a(1),e=a(0),d=a(228),h=a(14),r=a(35),l=
a(7),u=a(13),v=a(23),x=a(15),w=a(267),m=a(21),n=a(34);class z{constructor(W){this.Jyc=W||""}static get gSe(){return z.nae||(z.nae=new z(""))}static get Kzd(){return z.vge||(z.vge=z.vV(2).Jyc)}static FLa(W){W=n.a.Jh(W||"");return new z(W)}static Dka(W){return z.FLa(x.a.instance.ha(W))}static vV(W){return new z(x.a.instance.Va(W))}static wgd(W,...aa){return z.APh(x.a.instance.qb(W),...aa)}static APh(W,...aa){const ia=aa.length,ka=Array(ia);for(let Xa=0;Xa<ia;Xa++)ka[Xa]=(aa[Xa]||z.gSe).Jyc;return new z(String.format(W,
ka))}}z.nae=null;z.vge=null;Object(e.a)(z,"SafeHtml",null,[472]);const y=(W,aa)=>{aa&&(W.append(aa),W.append(z.Kzd))};var A=a(148),F=a(116),D=a(2),B=a(354),M=a(186),R=a(110),P=a(765);class E{constructor(W,aa,ia,ka=null){this.tEf=(Xa,sb)=>{this.OVf(sb.Ld.command)};this.u6f=()=>{if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&!this.$.ea.jc){var Xa={["AriaLiveOffCount"]:this.u7d,["AriaLivePoliteCount"]:this.v7d,["AriaLiveAssertiveCount"]:this.t7d,["AriaLiveRudeCount"]:this.w7d,
["ScreenReaderDivCount"]:this.Gle,["AlertScreenReaderDivCount"]:this.Z6d,["AuxScreenReaderDivCount"]:this.F7d,["AriaAlertCount"]:this.r7d,["ReadCommandOnCompletionCount"]:this.pke,["TotalAriaLiveRegionUpdates"]:this.moe};A.a.sendTelemetryEvent(Object(D.a)(new B.a,{name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:F.a.mi(Xa)}))}};this.$=W;this.Sb=ka;this.v9=document.createElement("div");this.v9.setAttribute(l.a.C3,l.a.Dk);this.v9.className=r.a.Tcd;aa.insertBefore(this.v9,ia);this.y$=
document.createElement("div");this.y$.setAttribute(l.a.C3,l.a.Dk);this.y$.className=r.a.Tcd;aa.insertBefore(this.y$,this.v9);this.sEg=x.a.instance.Va(2);this.E3=document.createElement("div");this.E3.setAttribute(l.a.Kd,l.a.kia);this.E3.setAttribute(l.a.lia,l.a.v0a);this.E3.className=r.a.Tcd;aa.insertBefore(this.E3,this.y$);this.moe=this.pke=this.r7d=this.F7d=this.Z6d=this.Gle=this.w7d=this.t7d=this.v7d=this.u7d=0;this.Nce=!0;this.register();this.$.da.Ha(211,this)}get iza(){return this.sEg}get isActive(){return!0}get CUg(){return this.v9}get nzj(){return this.y$}get activeCell(){return m.h(this.$).Ob(null)}get d8a(){return f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmationForFreewayScenarios",
!1)}dispose(){this.$&&this.unregister();u.DOMElementExtensions.Hf(this.E3);u.DOMElementExtensions.Hf(this.v9);u.DOMElementExtensions.Hf(this.y$);this.y$=this.v9=this.E3=this.$=null}setEnabled(W){this.m8f(this.y$,W)}uEj(){this.m8f(this.v9,!0)}readText(W){this.ldb(z.FLa(W),!0)}QRa(W){this.ldb(z.FLa(W),!1)}RVf(W,aa){if(1>aa||!W)h.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ia=new Sys.StringBuilder;W=String.format(x.a.instance.qb(34),aa,W);y(ia,W);y(ia,x.a.instance.ha(857));
this.ldb(z.FLa(ia.toString()),!1)}}Yij(W,aa,ia){if(1>ia||1>aa||aa>ia||!W)h.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var ka=new Sys.StringBuilder;y(ka,W);ka.append(String.format(x.a.instance.qb(55),aa,ia));this.ldb(z.FLa(ka.toString()),!1)}}OVf(W){this.d8a||(W=this.e7h(W),this.ldb(W,!1))}Wij(W){this.d8a&&(W=this.d7h(W),this.ldb(W,!1,!0))}ldb(W,aa,ia=!1){if(W=W?W.Jyc:null)aa=aa?this.y$:this.v9,v.a.equals(aa.innerHTML,W,!1)&&(W+=z.Kzd),this.Gjg(aa,ia),this.Sb.uh(aa,W)}kdb(W,
aa){this.E3.getAttribute(l.a.lia)!==aa&&this.E3.setAttribute(l.a.lia,aa);W=W?z.FLa(W).Jyc:"";this.Gjg(this.E3);this.Sb.uh(this.E3,W)}Zij(W,aa,ia,ka){const Xa=x.a.instance.qb(54);h.ULS.shipAssertTag(537153949,0,!(void 0===W||null===W));h.ULS.shipAssertTag(537153948,0,!(void 0===aa||null===aa));h.ULS.shipAssertTag(537153947,0,!(void 0===ia||null===ia));h.ULS.shipAssertTag(537153946,0,!(void 0===ka||null===ka));h.ULS.shipAssertTag(537153945,0,!(void 0===Xa||null===Xa));W=String.format(Xa,W||"",aa||"",
ia||"",ka||"");this.kdb(W,l.a.Rta)}m5j(W){var aa=this.y$.style;W?(W=w.a.r4b(W.cell,aa),aa=W.aC,aa.top=aa.left=aa.bottom=aa.right=null,W.y3()):aa.cssText=""}e7h(W){if(this.d8a)return null;switch(W){case -1985798686:return z.Dka(12);case -911352779:return z.Dka(11);case 237279923:return z.Dka(13);case -1502853784:return z.vV(81);case -111689794:return z.vV(78);case -287251124:return this.bld(1333,aa=>aa.bold);case -1925065947:return this.bld(1334,aa=>aa.italic);case 1764140053:return this.bld(1335,
aa=>aa.underline)}return null}d7h(W){if(!this.d8a||6!==W.af)return null;switch(W.command){case -1985798686:return z.Dka(12);case -911352779:return z.Dka(11);case 237279923:return z.Dka(13);case -1502853784:return z.vV(81);case -111689794:return z.vV(78);case 368460465:return W=this.$.ea.na.hasAutoFilter,this.Nce&&(W=!W,this.Nce=!1),this.t6a(2291,W,!1);case -1522760979:return this.t6a(1150,m.h(this.$).isFormulaView,!1);case 1941920197:return z.Dka(836);case 1051390410:return z.vV(589);case 1542466017:return z.vV(591);
case -706918724:return z.vV(590);case 369708605:return z.vV(592);case -1215659745:return z.vV(523);case 1783960667:return z.vV(521);case -1355155015:return z.vV(554);case -1158102843:return z.vV(522);case -287251124:return this.t6a(1333,this.dkc(W.command));case -1925065947:return this.t6a(1334,this.dkc(W.command));case 1764140053:return this.t6a(1335,this.dkc(W.command));case -1590502662:return this.t6a(1336,this.dkc(W.command));case 862890474:case 963349338:if(W=z.FLa(String(this.Hwa())),null!==
W)return z.wgd(214,W)}return null}register(){h.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(h.ULS.shipAssertTag(537153943,0,!!this.$.Ia,"Can't register to CommandHandlerManager's event"),this.$.Ia&&this.$.Ia.Xha(this.tEf),this.$.ea&&f.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&this.$.ea.HC(this.u6f))}unregister(){this.$&&(this.$.Ia.Jea(this.tEf),f.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")&&
this.$.ea.YD(this.u6f))}m8f(W,aa){const ia=W===this.v9;aa?(this.d8a&&ia||W.setAttribute(l.a.lia,l.a.Rta),ia&&W.setAttribute(l.a.Kd,l.a.kia),W.setAttribute(l.a.C3,l.a.vr),W.removeAttribute(l.a.C3),this.Sb.uh(W,W.innerHTML+" ")):(W.removeAttribute(l.a.lia),ia&&W.removeAttribute(l.a.Kd),W.setAttribute(l.a.C3,l.a.Dk))}bld(W,aa){const ia=this.activeCell;if(!ia)return null;const ka=f.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),Xa=[7,8];aa=aa(ia)?!0:!1;return z.wgd(ka?
Xa[+aa]:Xa[+!aa],z.Dka(W))}Gjg(W,aa=!1){if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7590512_SendAriaLiveNotifierTelemetry")){switch(W.getAttribute(l.a.lia)){case l.a.Zxe:++this.u7d;break;case l.a.Rta:++this.v7d;break;case l.a.v0a:++this.t7d;break;case l.a.FXg:++this.w7d}switch(W){case this.nzj:++this.Gle;break;case this.CUg:++this.Z6d;break;case this.E3:++this.F7d}W.getAttribute(l.a.Kd)===l.a.kia&&++this.r7d;aa&&++this.pke;this.moe++}}t6a(W,aa,ia=!0){return this.d8a&&this.activeCell?z.wgd(aa?
ia?7:216:ia?8:217,z.Dka(W)):null}dkc(W){return m.h(this.$).ga.Ra.YV?this.Cui(W):this.Dui(W)}Cui(W){const aa={};switch(W){case -287251124:W="QueryBold";break;case -1925065947:W="QueryItalics";break;case 1764140053:W="QueryUnderline";break;case -1590502662:W="QueryStrikethrough";break;default:return!1}const ia=R.a(this.$);return ia?(ia.RMa(W,aa),aa[P.a.On]):!1}Dui(W){var aa=m.h(this.$);const ia=M.a(aa.Ob(null));f.EwaSettings.zb()&&aa.jb&&(ia.Font=aa.Ih.Iwa(ia.Font));aa=ia.Font;switch(W){case -287251124:return aa.Bold;
case -1925065947:return aa.Italic;case 1764140053:return aa.Underline;case -1590502662:return aa.Strikethrough}return!1}Hwa(){let W=m.h(this.$);if(W.ga.Ra.YV)return null;const aa=M.a(W.Ob(null));f.EwaSettings.zb()&&W.jb&&(aa.Font=W.Ih.Iwa(aa.Font));return aa.Font.FontSize}}Object(e.a)(E,"AriaLiveNotifier",null,[466,433,2]);var H=a(39),G=a(109),N=a(157),I=a(41);class O extends d.a{constructor(W){super();this.$=W;this.Mb()}create(){const W=Object(G.d)(N.a.resolve(I.F,{rb:this.Na}));H.TaskExtensions.za(H.TaskExtensions.Pd([W],
this.$.ka),()=>{this.vb(this.$.da.Aa(211)||new E(this.$,this.$.Cv,this.$.Df,W.result))},this.ka,3)}static la(W){W.da.Ha(212,new O(W))}}Object(e.a)(O,"AriaLiveNotifierFactory",d.a,[]);var U=a(29),ca=a(221);class Q{constructor(W,aa){this.P0=this.eS=this.kL=null;this.wka=aa;this.xkh(W);this.Mcj();f.EwaSettings.zb()&&W.da.Ha(244,this)}get isActive(){return!!this.wka&&document.activeElement===this.wka}readText(W){W=f.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?
W:String.format(x.a.instance.qb(30),W);this.kL.setAttribute(l.a.wu,W);this.eS.setAttribute(l.a.wu,W);this.DWj()}dispose(){this.P0&&this.P0.parentNode&&this.P0.parentNode.removeChild(this.P0);this.eS=this.kL=this.P0=this.wka=null}xkh(W){var aa=W.Ib+"readoutElementWrapper";const ia=W.Ib+"readoutElement1",ka=W.Ib+"readoutElement2";this.P0=document.getElementById(aa);this.P0||(this.P0=document.createElement(ca.a.div),this.P0.id=aa,this.kL=document.createElement(ca.a.label),this.kL.id=ia,this.kL.setAttribute(l.a.Kd,
l.a.x0a),this.kL.setAttribute("aria-roledescription",""),this.kL.setAttribute("aria-multiline",!1),this.eS=document.createElement(ca.a.label),this.eS.id=ka,this.eS.setAttribute(l.a.Kd,l.a.x0a),this.eS.setAttribute("aria-roledescription",""),this.eS.setAttribute("aria-multiline",!1),this.kL.style.width="0px",this.kL.style.height="0px",this.eS.style.width="0px",this.eS.style.height="0px",this.kL.tabIndex=-1,this.eS.tabIndex=-1,this.P0.appendChild(this.kL),this.P0.appendChild(this.eS),W=W.Ib+l.a.f7b,
aa=document.getElementById(W),h.ULS.shipAssertTag(537153942,3,!!aa,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${W}`),aa&&aa.appendChild(this.P0))}Mcj(){this.wka&&this.kL&&this.eS&&(this.wka.setAttribute(l.a.B3,this.kL.id),this.wka.setAttribute(l.a.h3b,`${this.kL.id} ${this.eS.id}`))}DWj(){if(this.isActive){let W="";u.DOMElementExtensions.hasAttribute(this.wka,l.a.B3)&&(W=this.wka.getAttribute(l.a.B3).toString());this.wka.setAttribute(l.a.B3,W===this.kL.id?
this.eS.id:this.kL.id)}else h.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static dOa(){if(null==Q.ixb)if(f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!U.a.FOa)Q.ixb=!0,h.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(Q.ixb=!1,U.a.bI||U.a.Nf)Q.ixb=!0,h.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");
return Q.ixb}static la(W){Q.dOa()&&W.da.Ha(244,new Q(W,m.h(W).cellTextEditBox.textBox.Ke))}}Q.ixb=null;Object(e.a)(Q,"FocusBasedReadout",null,[433,2]);class Y extends d.a{constructor(W){super();this.$=W;this.Mb()}create(){Q.dOa()?m.h(this.$).cellTextEditBox.textBox.hQ(()=>{const W=this.$.da.Aa(244)||new Q(this.$,m.h(this.$).cellTextEditBox.textBox.Ke);this.vb(W)}):this.vb(null)}static la(W){W.da.Ha(315,new Y(W))}}Object(e.a)(Y,"FocusBasedReadoutFactory",d.a,[]);var la=a(53),ea=a(92),ha=a(89);const X=
W=>{switch(W){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;
case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var T=a(25),ua=a(45),Ha=a(218),Ca=a(51),Ga=a(47),sa=a(132);class bb{static get Ihj(){return bb.hke||(bb.hke=RegExp("([A-Z]+)","g"))}static get Hhj(){return bb.gke||(bb.gke=RegExp("([A-Z])","g"))}static get g8g(){return bb.K8d||(bb.K8d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Rkd(W){return bb.n9e(W.toString())}static n9e(W){return bb.g8g.test(W)?
W.replace(bb.Ihj,"$1 ").replace(bb.Hhj,' "$1"').trim():W}static xsj(W){const aa=W.lastIndexOf("!");return W.substring(0,-1<aa?aa+1:0)+bb.n9e(W.substring(-1<aa?aa+1:0,W.length))}}bb.hke=null;bb.gke=null;bb.K8d=null;Object(e.a)(bb,"RangeAriaExtensions",null,[]);class Ba{constructor(){this.activeItemName=null;this.kpf=!1;this.tableName=null;this.i2a=0;this.WDc=!1}}Object(e.a)(Ba,"SelectionReadoutState",null,[]);a(73);var qa=a(80);class pa{constructor(W,aa,ia,ka,Xa){this.gridReadoutNotifier=null;this.edb=
!1;this.gua=this.frb=null;this.vea=()=>{f.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?h.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):m.h(this.$).jb||this.n3b.rq()};this.rTi=()=>{if(!m.h(this.$).ga.Ra.bud){var sb,ib=({activeCell:sb}=this.PSh()).returnValue;this.readText(ib,sb)}};this.Wz=()=>{const sb=this.activeCell;this.readText("Editing",sb);f.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||
sb&&sb.Tgc&&!m.h(this.$).Mdf||this.n3b.cancel()};this.$c=()=>{f.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?h.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(this.vea(),this.edb&&m.h(this.$).inRangePicker&&1===qa.a.Eb&&(null===this.frb?this.frb=Ca.a.instance.create(this.WLd,pa.rYc,"readSelectedRanges"):this.frb.rq()))};this.$=aa;this.ariaLiveNotifier=W;this.sparklineManager=ka;this.tableManager=ia;this.WD=
new Ba;this.dOa=Q.dOa();this.edb=f.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.dOa&&(f.EwaSettings.zb()?this.gridReadoutNotifier=Xa:this.gridReadoutNotifier=aa.da.Aa(244),h.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),pa.rYc=700);this.n3b=Ca.a.instance.create(this.rTi,pa.rYc,Ga.a.VAj,!1);this.Mi()}get activeCell(){return m.h(this.$).Ob(null)}dispose(){this.$&&this.Oi();ea.a.Ja(this.n3b);
this.sparklineManager=this.$=this.n3b=null}R3e(W,aa,ia=!0){if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7449834_NoReadoutWhenFindAndReplaceDialogOpen")&&this.$.ub.$w&&null!==this.$.ub.vh&&null!==this.$.ub.vh.uc&&"FindAndReplaceDialog"===this.$.ub.vh.uc||!W)return"";var ka=this.$.da;const Xa=new Sys.StringBuilder;this.kWg(Xa,W,aa);if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var sb=this.tableManager.ela(W.range);(null===sb||void 0===sb?0:sb.LWd)&&this.zwe(Xa,sb);
sb=this.tableManager.aq(W.range);(null===sb||void 0===sb?0:sb.Ala)&&this.zwe(Xa,sb)}sb=W.rca?this.M6e(W):W.text;y(Xa,sb);sb=this.$.activeItemName;this.WD.activeItemName!==sb&&(y(Xa,sb),this.WD.activeItemName=sb);sb=1===aa.length?ua.L(aa).isSingle?"":x.a.instance.ha(853):String.format(x.a.instance.qb(31),aa.length);y(Xa,sb);for(var ib of aa)sb=this.dOa?ib.toString():bb.Rkd(ib),y(Xa,sb),1===aa.length&&pa.uBi(ib)&&(sb=m.h(this.$).Ca.rs(ib.bottomRight),void 0!==sb&&null!==sb&&sb.text&&(sb=sb.rca?this.L6e(sb,
sb.text):sb.text,y(Xa,sb)));ib=W.cell;ib=this.t4h(ib.exj,ib.eah);y(Xa,ib);this.UVg(Xa,W);ia&&(W.$8a?y(Xa,x.a.instance.ha(841)):W.wya&&y(Xa,x.a.instance.ha(842)));if(W.hasAutoFilter||W.z5)this.lWg(Xa,W.hasAutoFilter?W.cell.autoFilterType:W.cell.gaj),ia&&y(Xa,x.a.instance.ha(844));Ha.c(this.$,W.range)&&y(Xa,x.a.instance.ha(848));this.RVg(Xa,W);ia=(ia=ka.Aa(14))?ia.QTh():"";y(Xa,ia);W.oB&&(ia=m.h(this.$).Ca.rs(W.range),ia=!!ia&&ia.hasIgnorableError,pa.HKj(W)?pa.SVg(Xa,W):f.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
ia?y(Xa,x.a.instance.ha(846)):y(Xa,x.a.instance.ha(845)));W.gN&&(y(Xa,x.a.instance.ha(847)),W.Szb&&y(Xa,String.format(x.a.instance.qb(16),W.xnh)),y(Xa,W.iconName));W.hasRichValueIcon&&(ib=this.$.da.Aa(271),ia="",ib&&W.cell.xtf&&(ib=ib.XU(W.cell.xtf))&&ib.DomainId.Id!==pa.nck&&(ia=ib.Name),W.cell.eri?(y(Xa,String.format(x.a.instance.qb(187),ia)),y(Xa,x.a.instance.ha(1812))):(y(Xa,String.format(x.a.instance.qb(185),ia)),y(Xa,x.a.instance.ha(1811))));this.vgi(W)&&y(Xa,pa.M_h(W));(ka=ka.Aa(231))&&y(Xa,
ka.Z6e(aa,!0));1===aa.length&&aa[0].isSingle&&pa.GKj(W,aa[0],this.$)&&(aa=this.$.da.Aa(271))&&y(Xa,aa.bUh());W.gRb&&W.hRb&&y(Xa,W.hRb);(aa=W.cell.R6g)&&y(Xa,aa);W.tOa&&W.CJb&&(W=W.BId)&&(y(Xa,x.a.instance.ha(1985)),y(Xa,W));return Xa.toString()}NBe(W){this.gua=this.WD;this.WD=Object(D.a)(new Ba,{activeItemName:this.gua.activeItemName,WDc:W?this.gua.WDc:!1,tableName:W?this.gua.tableName:"",i2a:W?this.gua.i2a:-1})}E2f(){this.gua&&(this.WD=this.gua,this.gua=null)}t4h(W,aa){return 2===W||2===aa?x.a.instance.ha(875):
1===W||1===aa?x.a.instance.ha(876):""}M6e(W){return this.L6e(W.cell,W.text)}kWg(W,aa,ia){if(ia&&1===ia.length&&ia[0].isSingle){ia="";var ka=this.tableManager.ela(aa.range);if(ka){ia=ka.pivotTableName;this.u0c(W,ia);var Xa=ka.Tjc?x.a.instance.ha(835):"";f.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Xa+=(ka.altText?ka.altText+" . ":"")+(ka.altTextSummary?ka.altTextSummary:""));this.Bwe(W,!0,ia,Xa);y(W,this.tableManager.gzi(ka,aa.range)?x.a.instance.ha(838):
"");y(W,this.tableManager.Asi(ka,aa.range)?x.a.instance.ha(837):"")}else if(ka=this.tableManager.aq(aa.range)){ia=(Xa=m.h(this.$).wb.mh(aa.range))?Xa.name:"";this.u0c(W,ia);let sb="";Xa&&(sb=(Xa.WUa?Xa.WUa+" . ":"")+(Xa.XUa?Xa.XUa:""));this.Bwe(W,!1,ia,sb);y(W,this.tableManager.gmf(ka,aa.range)?x.a.instance.ha(837):"")}else this.u0c(W,ia),this.WD.tableName="",this.WD.i2a=-1}}u0c(W,aa){aa!==this.WD.tableName&&this.WD.tableName&&(W.append(x.a.instance.ha(this.WD.WDc?834:833)),y(W," "+this.WD.tableName))}Bwe(W,
aa,ia,ka){ia!==this.WD.tableName&&(W.append(x.a.instance.ha(aa?832:831)),y(W," "+ia),y(W,ka),this.WD.tableName=ia,this.WD.WDc=aa,this.WD.i2a=-1)}zwe(W,aa){const ia=m.h(this.$).ga.qa.activeCell;if(ia.top!==aa.top&&ia.left!==this.WD.i2a){W.append(x.a.instance.ha(837));aa=new T.Range(aa.top,ia.left,aa.top,ia.left,!0,!0);y(W,bb.Rkd(aa));if(aa=m.h(this.$).Ob(aa))aa=aa.rca?this.M6e(aa):aa.text,y(W,aa);this.WD.i2a=ia.left}}L6e(W,aa){const ia=W.o7a;return W.pxa?String.format(x.a.instance.qb(14),aa,ia):String.format(x.a.instance.qb(13),
aa,bb.xsj(ia))}Mi(){h.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var W=m.h(this.$);h.ULS.shipAssertTag(537153929,0,!!W,"Can't register to grid's events");W&&(W.hc.An(this.Wz),W.Ca.vw(this.vea),W.OE(this.vea),this.edb&&W.hc.Bm(this.Wf.bind(this)),W=W.ga,h.ULS.shipAssertTag(537153928,0,!!W,"Can't register to selectionManager's events"),W&&(W.IC(this.$c),W.FC(this.vea),W.Ra.w3(this.vea),this.edb&&(this.WLd=this.WLd.bind(this))))}}Oi(){if(this.$){var W=
m.h(this.$);W&&(W.hc.sn(this.Wz),W.Ca.sx(this.vea),W.hG(this.vea),this.edb&&W.hc.km(this.Wf),W=W.ga)&&(W.UB(this.vea),W.JI(this.vea),W.Ra.zoa(this.vea))}}readText(W,aa){this.dOa&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(W):(f.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(W),this.edb&&!aa||this.ariaLiveNotifier.m5j(aa))}Wf(){this.frb&&this.frb.cancel()}WLd(){this.readText(this.S7h())}S7h(){let W=
"";m.h(this.$).ga.rangePicker.fL.forEach(()=>{W+=void 0});return W+=" selected"}PSh(){let W;W=null;var aa=m.h(this.$).ga;if(1!==aa.Se&&!aa.Ra.oc)return h.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${aa.Se} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:W};switch(aa.Se){case 2:return{returnValue:this.UVh(aa),activeCell:W};case 64:var ia=aa.Ra.oc.floatingObject,ka="";if(aa=aa.Ra.oc.Ws||aa.Ra.oc.Sd)ka=(ka=aa.firstChild)?u.DOMElementExtensions.getTextContent(ka):
"";return{returnValue:String.format(x.a.instance.qb(53),pa.sdc(ia.altText,ia.altTextDescription,ia.name),ka,ia.altTextDescription),activeCell:W};case 4:return{returnValue:pa.dVg(aa.Ra.oc.floatingObject),activeCell:W};case 512:return{returnValue:sa.a.s5e(aa.Ra.oc.floatingObject.dbd),activeCell:W};case 8:return ia=aa.Ra.oc.floatingObject,{returnValue:String.format(x.a.instance.qb(51),ia?ia.name:""),activeCell:W};case 1:return W=this.activeCell,{returnValue:this.R3e(W,aa.qa.selectedRanges),activeCell:W}}return{returnValue:"",
activeCell:W}}UVh(W){const aa=new Sys.StringBuilder;aa.append(pa.y7g(W));const ia=this.$.da.Aa(231);ia&&y(aa,ia.Z6e(W.Ra.oc.floatingObject,!1));return aa.toString()}vgi(W){W=W.fkf();let aa=!1;this.WD.kpf!==W&&(this.WD.kpf=W,aa=!0);return aa}UVg(W,aa){if(aa.bAb)if(aa=this.sparklineManager.T8h(aa)){var ia=x.a.instance,ka=ia.ha;a:switch(aa.type){case 0:var Xa=828;break a;case 1:Xa=829;break a;default:Xa=830}ia=ka.call(ia,Xa);y(W,String.format(x.a.instance.qb(25),ia));aa=String.format(x.a.instance.qb(24),
bb.Rkd(aa.WSj));y(W,aa)}else h.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),y(W,String.format(x.a.instance.qb(25),""))}lWg(W,aa){switch(aa){case 1:case 11:y(W,x.a.instance.ha(849));break;case 6:y(W,x.a.instance.ha(849));y(W,x.a.instance.ha(851));break;case 7:y(W,x.a.instance.ha(849));y(W,x.a.instance.ha(852));break;case 2:y(W,x.a.instance.ha(850));y(W,x.a.instance.ha(851));break;case 3:y(W,x.a.instance.ha(850));y(W,x.a.instance.ha(852));break;default:y(W,
x.a.instance.ha(850))}}RVg(W,aa){var ia;const ka=this.$.da.Aa(65);aa=ka?ka.XLa(aa.range):null;let Xa="";const sb=Object(ha.a)(456,aa);if(aa)Xa=!aa.G8a&&sb&&sb.SAi?String.format(x.a.instance.qb(29),sb.vXj):String.format(x.a.instance.qb(23),aa.author);else if(null===(ia=null===ka||void 0===ka?void 0:ka.nn)||void 0===ia?0:ia.AF)Xa=String.format(x.a.instance.qb(28),ka.nn.ON.author);y(W,Xa)}static dVg(W){return String.format(x.a.instance.qb(52),pa.sdc(W.altText,W.altTextDescription,W.name),W.altTextDescription)}static M_h(W){return x.a.instance.ha(W.fkf()?
839:840)}static sdc(W,aa,ia){return W||aa?W:ia}static y7g(W){var aa=W.Ra.oc;W=aa.floatingObject;const ia=W.jd,ka=ia.ChartTitle,Xa=W.altText,sb=W.altTextDescription,ib=!!(ia.Attributes&4);return(aa=aa.getSelectionDescription())?aa:ia.DataRangeForDisplay?String.format(x.a.instance.qb(ib?49:47),pa.sdc(Xa,sb,W.name),sb,ka,x.a.instance.ha(X(ia.ChartCategory)),ia.DataRangeForDisplay):String.format(x.a.instance.qb(ib?50:48),pa.sdc(Xa,sb,W.name),sb,ka,x.a.instance.ha(X(ia.ChartCategory)))}static HKj(W){return f.EwaSettings.ya(101)&&
(W.fCb||W.Sjc)}static SVg(W,aa){aa.Jpa?aa.fCb?y(W,String.format(x.a.instance.qb(26),aa.Jpa.topLeft.toString())):aa.Sjc&&(aa=aa.Jpa.dP(),y(W,String.format(x.a.instance.qb(27),(aa.LastColumn-aa.FirstColumn+1).toString(),(aa.LastRow-aa.FirstRow+1).toString()))):h.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static GKj(W,aa,ia){return W.oB||!f.EwaSettings.ya(131)?!1:(W=ia.da.Aa(271))?
W.vjc(aa):!1}static uBi(W){return W.top===W.bottom&&W.left+1===W.right||W.top+1===W.bottom&&W.left===W.right}}pa.nck=268435712;pa.rYc=500;Object(e.a)(pa,"SelectionReadoutHandler",null,[457,2]);var ya=a(60),za=a(721),cb=a(70);class Pa extends d.a{constructor(W){super();this.$=W;this.Mb()}create(){const W=this.$.da,aa=la.GetServiceTaskFactory.Sa(W,211,212,this.Na),ia=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?Object(G.d)(N.a.resolve(I.db,{rb:this.Na})):la.GetServiceTaskFactory.Sa(W,
66,134,this.Na),ka=Object(cb.b)("OfficeVSO:7624512_MigrateSparklineManagerService")?Object(G.d)(N.a.resolve(I.cb,{rb:this.Na})):la.GetServiceTaskFactory.Sa(W,240,239,this.Na);let Xa=ya.Task.Ua(null);f.EwaSettings.zb()&&(Xa=la.GetServiceTaskFactory.Sa(W,244,315,this.Na));H.TaskExtensions.za(H.TaskExtensions.Pd([aa,ia,ka,Xa],this.ka),()=>{const sb=Object(za.a)(this.$.da,226,()=>new pa(aa.result,this.$,ia.result,ka.result,Xa.result));this.vb(sb)},this.$.ka,3)}static la(W){W.da.Ha(227,new Pa(W))}}Object(e.a)(Pa,
"SelectionReadoutHandlerFactory",d.a,[]);var nb=a(159);class Ma{constructor(W,aa){this.$=aa;this.ariaLiveNotifier=W}ZVf(){const W=this.STh();this.ariaLiveNotifier.kdb(W,l.a.v0a)}STh(){const W=new Sys.StringBuilder;this.$.workbookContext&&y(W,this.$.workbookContext.WorkbookFileName);y(W,x.a.instance.ha(855));y(W,this.UTh());y(W,this.TTh());y(W,x.a.instance.ha(856));return W.toString()}UTh(){return this.$.isEditMode?x.a.instance.ha(860):x.a.instance.ha(861)}TTh(){var W=this.ybk();const aa=this.$.ua.na;
W=1!==W?String.format(x.a.instance.qb(32),W):x.a.instance.ha(854);W=new Sys.StringBuilder(W);aa&&aa.sheetName&&(W.append(z.Kzd),W.append(String.format(x.a.instance.qb(33),aa.sheetName)));return W.toString()}ybk(){let W=0;for(const aa of this.$.ua.items)aa.visible&&W++;return W}}Object(e.a)(Ma,"WorkbookReadout",null,[]);var Oa=a(472);let La=class{constructor(W,aa,ia){this.jIf=()=>{this.$4d.ZVf();this.ariaLiveNotifier.setEnabled(!0)};this.$=aa;this.ariaLiveNotifier=W;this.$4d=new Ma(W,aa);this.Lcc=
ia.ykd(this.$);this.Lcc.xRg(this.jIf)}dispose(){this.Lcc&&this.Lcc.jqj(this.jIf);this.Lcc=this.ariaLiveNotifier=this.$=null}};La=Object(nb.b)([Object(N.d)(I.t),Object(nb.c)(0,Object(Oa.AriaLiveNotifierService)()),Object(nb.c)(1,Object(I.u)()),Object(nb.c)(2,Object(I.X)())],La);Object(e.a)(La,"EmbeddedWorkbookReadoutHandler",null,[2]);let ra=class{constructor(W,aa){this.DW=()=>{this.Ud||this.awe()};this.Ud=!1;this.BZ=aa.xZ;this.ariaLiveNotifier=W;this.$4d=new Ma(W,aa);this.BZ&&this.BZ.rR?this.awe():
this.Mi()}dispose(){this.Oi();this.ariaLiveNotifier=this.BZ=null;this.Ud=!0}Mi(){if(this.BZ){this.BZ.vv(this.DW);this.BZ.Ca.vw(this.DW);this.BZ.OE(this.DW);var W=Object(ha.a)(303,this.BZ);W&&(W.hc.An(this.DW),W.ga.IC(this.DW),W.ga.FC(this.DW),W.ga.Ra.w3(this.DW))}else h.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}Oi(){if(this.BZ){this.BZ.Ca.sx(this.DW);this.BZ.hG(this.DW);const W=Object(ha.a)(303,this.BZ);W&&(W.hc.sn(this.DW),W.ga.UB(this.DW),
W.ga.JI(this.DW),W.ga.Ra.zoa(this.DW))}}awe(){this.$4d.ZVf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.uEj();this.dispose()}};ra=Object(nb.b)([Object(N.d)(I.hb),Object(nb.c)(0,Object(Oa.AriaLiveNotifierService)()),Object(nb.c)(1,Object(I.u)())],ra);Object(e.a)(ra,"WorkbookReadoutHandler",null,[2]);class V extends d.a{constructor(W){super();this.$=W;this.Mb()}create(){const W=la.GetServiceTaskFactory.Sa(this.$.da,211,212,this.Na);if(this.$.MF){const aa=Object(cb.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?
Object(G.d)(N.a.resolve(I.X,{rb:this.Na})):la.GetServiceTaskFactory.Sa(this.$.da,12,477,this.Na);H.TaskExtensions.za(H.TaskExtensions.Pd([W,aa],this.$.ka),()=>{const ia=Object(za.a)(this.$.da,228,()=>new La(W.result,this.$,aa.result));this.vb(ia)},this.$.ka,3)}else H.TaskExtensions.za(W,aa=>{const ia=Object(za.a)(this.$.da,228,()=>new ra(aa.result,this.$));this.vb(ia)},this.$.ka,3)}static la(W){W.da.Ha(229,new V(W))}}Object(e.a)(V,"WorkbookReadoutHandlerFactory",d.a,[]);a.d(C,"a",function(){return ma});
const ma=()=>{b.a.Fa(W=>{O.la(W);f.EwaSettings.zb()?Y.la(W):Q.la(W);Pa.la(W);Object(cb.b)("OfficeVSO:7641163_MigratingWorkbookReadoutHandlerService")||V.la(W)})};String(c);String(t);window.___1680633022278_closurehack=c;window.___1680633022278_closurehack=t},1205:function(t,C,a){var c=a(10);t=a(0);var b=a(228),f=a(159),e=a(14),d=a(1417),h=a(652),r=a(558),l=a(29),u=a(92),v=a(34),x=a(170),w=a(9),m=a(59),n=a(167),z=a(355),y=a(51),A=a(47),F=a(32),D=a(1),B=a(23),M=a(15),R=a(110),P=a(89),E=a(88),H=a(160),
G=a(6),N=a(16),I=a(102),O=a(50),U=a(1166);class ca extends H.a{constructor(yb,Gb=!0){super(!1,!1,ca.jv);this.$Ya=null;this.Sae=!1;this.yn=[];this.Uj=null;this.P_b=yb;this.IHg=Gb;this.Hx=this.Jne=!1;this.Fha=null;this.dNc=!1;this.dg=this.Pqh;this.ye="InsertFileDialog";this.yc(1,this.l0b);ca.jv?(this.$Ya={["id"]:this.ye,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(E.a)(this,this.z6i,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,
["onFrameReady"]:Object(E.a)(this,this.sYi,"onFrameReady")},this.initializeAndShow(this.titleText,Object(E.a)(this,this.Cic,"insertDialogHandler"),this.$Ya),this.gVb=!0):(this.showDialog(this.titleText,Object(E.a)(this,this.Cic,"insertDialogHandler")),Gb&&this.s$f(),(yb=this.vK(1))&&this.yn.push(yb),(yb=this.vK(0))&&this.yn.push(yb),this.Kng(),this.gVb=!1)}get y9j(){return this.P_b}validate(){this.Uj.rF||e.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Uj.rF.value?
!0:(ca.rA(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}sYi(yb){this.IHg&&(this.Uj=this.r$f(yb,this.P_b))}z6i(){this.Uj&&this.Uj.rF&&(this.Sae||(this.Uj.emj(Object(E.a)(this,this.jFd,"onFileChosen")),this.Sae=!0),this.Uj.MZe())}jFd(yb){this.$Ya.uploadStatusLabel=yb;this.DVa(this.titleText,Object(E.a)(this,this.Cic,"insertDialogHandler"),this.$Ya)}Cic(yb){1===yb&&this.isEnabled()?ca.jv&&this.Uj.rF&&!this.Uj.rF.value?(this.$Ya.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.DVa(this.titleText,
Object(E.a)(this,this.Cic,"insertDialogHandler"),this.$Ya)):(this.yAb(),this.P_b.finalizeUpload(this.Uj,Object(E.a)(this,this.dispose,"dispose"))):0===yb&&this.hide()}s$f(){this.dNc=!1;this.Uj=this.r$f(document.getElementById("uploadFrameContainer"),this.P_b);G.AFrameworkApplication.fa.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Fha=Object(E.a)(this,this.WGd,"onUploadFrameLoad"),O.a.addHandler(this.Uj.iFrame,"load",this.Fha));this.Uj.rF||e.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");
this.bTf()}WGd(){this.bTf()}bTf(){if(this.Uj&&!this.dNc){var yb=this.Uj.rF;yb&&(O.a.addHandler(yb,N.a.fc,Object(E.a)(this,this.onKeyDown,"onKeyDown")),yb=[yb],this.yn=yb.concat.apply(yb,this.yn),this.Kng(),this.dNc=!0)}}dispose(){if(this.Uj&&!ca.jv){const yb=this.Uj.rF;yb&&O.a.removeHandler(yb,N.a.fc,Object(E.a)(this,this.onKeyDown,"onKeyDown"));this.Fha&&O.a.removeHandler(this.Uj.iFrame,"load",this.Fha)}this.Uj=null;super.dispose()}Kng(){if(0<this.yn.length){const yb=new U.a(this.yn),Gb=I.FocusManager.instance().WQ();
Gb&&(this.yn[0].focus(),Gb.uf=yb,Gb.d0=!0)}}onKeyDown(yb){4!==I.FocusManager.instance().eTf(yb)&&yb.preventDefault()}static get jv(){return G.AFrameworkApplication.sa.Pa.Uv&&G.AFrameworkApplication.sa.Pa.xof}static rA(yb){const Gb=document.getElementById("errorText");Gb.innerText=yb;Gb.style.display="inline-block"}}Object(t.a)(ca,"InsertFileDialog",H.a,[]);class Q{static get dg(){return H.a.Wp(Q.vl,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Q.vl="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(t.a)(Q,"InsertImageDialogHtml",null,[]);class Y extends ca{constructor(yb,Gb=!0){super(yb,Gb)}get l0b(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get Pqh(){return Q.dg}validate(){this.Uj.rF||e.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");const yb=Object(P.a)(d.a,this.y9j),Gb=yb.Qpg(this.Uj.rF.value);return 0!==Gb?(ca.rA(yb.B5e(Gb)),!1):!0}}Object(t.a)(Y,"InsertImageDialog",ca,[]);var la=a(563);const ea=
(yb,Gb,Sa)=>{if(yb){var db=0;do{try{yb();break}catch(fb){if(e.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",db,Sa,fb.message,fb.stack),db>=Gb)break}db++}while(1)}};var ha=a(113),X=a(93),T=a(42),ua=a(264),Ha=a(182),Ca=a(83),Ga=a(470),sa=a(181);class bb{constructor(yb,Gb,Sa,db,fb,ab,wb,kb,tb=!0,hb=null,Fb=!1){this.TZe="FileUpload.ashx";this.xo=null;this._initialized=!1;this.Tg=this.Lkb=this.cNc=this.Fha=this.FVb=this.mr=this.ht=
null;this.Wm=!1;this.rE=this.GVb=this.sXc=null;this._parent=yb;this.wCg=Gb;this.$Gg=Sa;this.ybe=fb;this.xVc=wb;this.y6d=kb;this.B8d=hb;this.rXc=!1;this.UCg=db.ra("CanaryRenewalForFileUploadIsEnabled");this.apg=!1;(this.rsa=Fb)||this.yfh(ab);tb&&this.Zhf()}get y2f(){return this.$Gg}get sessionId(){return this.xVc}get iFrame(){return this.xo}get rF(){return this.mr}get mab(){return G.AFrameworkApplication.fa?G.AFrameworkApplication.fa.ra("NativeFileOpenDialogIsEnabled"):!1}get NZe(){return G.AFrameworkApplication.fa?
G.AFrameworkApplication.fa.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}get nwi(){return this.rsa?!1:Ha.b(this.xo.contentWindow.location.pathname,this.TZe,0)}get XUg(){return!l.a.nya&&G.AFrameworkApplication.fa.ra("AllowMultipleImageInsertFromLocalDevice")}Zhf(){this.rE=sa.a.create().toString();this.rsa?this.Xbd():this.aWg()}yfh(yb){this.xo=document.createElement("iframe");this.xo.className=yb;this.xo.id=yb;this.ybe&&(this.xo.style.visibility="visible",this.xo.style.height="30px",this.xo.setAttribute("frameborder",
"0"));this.Fha=Object(E.a)(this,this.WGd,"onUploadFrameLoad");O.a.addHandler(this.xo,"load",this.Fha)}n$b(yb=null){G.AFrameworkApplication.sa.wuc();if(!this.mr)return e.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";O.a.addHandler(this.mr,"change",()=>{this.HKh(yb)});ea(Object(E.a)(this,this.MZe,"fileInputClick"),1,"DoFileOpenDialog");return this.mr.value}HKh(yb){yb&&yb(this.mr.value)}IKh(){this.FVb&&(this.FVb.innerText=this.W6e())}emj(yb){O.a.addHandler(this.mr,"change",()=>{yb(this.W6e())})}W6e(){let yb=
null;if(this.mr.value){const Gb=this.mr.value,Sa=Gb.lastIndexOf("\\");0<Sa&&(yb=Gb.substring(Sa+1,Gb.length))}return yb?yb:""}MZe(){try{e.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.mr.click()}catch(yb){throw e.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",yb.message),yb;}}DVj(){this.Kzi()?this.ngg():(this.h3d(),this.ht.submit())}Kzi(){return(this.UCg||this.rsa)&&!(void 0===window.self.FormData||null===window.self.FormData)}L6f(yb){if(yb){const Gb=
this.AJe();this.Tg=new XMLHttpRequest;this.Tg.open("POST",Gb);this.Tg.setRequestHeader("X-CorrelationId",this.rE);this.bIi(yb);this.Tg.onreadystatechange=Object(E.a)(this,this.wqa,"uploadResponseReceived");this.Tg.send(yb)}}bIi(yb){if(!l.a.nya&&yb.get){var Gb=yb.get("ImageId");yb=window.self.navigator;Gb={["CorrelationId"]:this.rE,["Canary"]:G.AFrameworkApplication.canary,["ImageNodeId"]:Gb};yb&&(yb=yb.connection?yb.connection:yb.mozConnection?yb.mozConnection:yb.webkitConnection?yb.webkitConnection:
null)&&(Gb.effectiveType=yb.effectiveType,Gb.downlink=yb.downlink,Gb.type=yb.type,Gb.rtt=yb.rtt);e.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Gb)}}ngg(){try{this.h3d();e.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const yb=new (Type.parse("FormData"))(this.ht);this.L6f(yb)}catch(yb){e.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+yb.message),this.zbb(null)}}mgg(yb){try{if(this.h3d(),
e.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.sak(yb)){this.GVb=yb;this.ht.contains(this.mr)&&this.ht.removeChild(this.mr);var Gb=new (Type.parse("FormData"))(this.ht);Gb.append("applicationfileInput",yb.blob,yb.filename);this.L6f(Gb)}else this.zbb(null)}catch(Sa){e.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+Sa.message),this.zbb(null)}}sak(yb){return yb&&void 0!==yb.blob&&null!==yb.blob&&
void 0!==yb.filename&&null!==yb.filename&&""!==yb.filename?void 0===window.self.FormData||null===window.self.FormData?(e.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(yb=yb?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===yb.blob||null===yb.blob,void 0===yb.filename||null===yb.filename||""===yb.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",e.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",
yb)),!1)}wqa(){if(4===this.Tg.readyState)if(200===this.Tg.status){e.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.rE);const yb=this.Tg.getResponseHeader("X-NewKey"),Gb=this.Zri(this.Tg);let Sa=!1;if(void 0!==yb&&null!==yb&&Gb&&(Sa=this.fak(yb),!this.rXc&&Sa)){e.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.rE);this.rXc=!0;void 0!==this.GVb&&
null!==this.GVb?this.mgg(this.GVb):this.ngg();return}e.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.rXc,Gb,!(void 0===yb||null===yb),Sa,this.rE);this.zbb(this.Tg.responseText)}else e.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Tg.status,this.Tg.responseText?!1:!0,this.rE),this.zbb(null)}Zri(yb){try{const Gb=
T.a(yb.responseText).Responses;if(void 0!==Gb&&null!==Gb&&1===Gb.length){const Sa=Gb[0];if(void 0!==Sa&&null!==Sa&&2===Sa.length&&28===Sa[1].StatusCode)return!0}}catch(Gb){}return!1}fak(yb){Ga.a.Gmg(yb);return G.AFrameworkApplication.canary!==yb?!1:!0}h3d(){this.sXc||(this.sXc=new Date)}dispose(){this.Wm||(this.rsa?this._parent.removeChild(this.ht):(this._parent.removeChild(this.xo),O.a.removeHandler(this.xo,"load",this.Fha),this.Fha=null),this.cNc&&(O.a.removeHandler(this.mr,"change",this.cNc),this.cNc=
null),this.NZe&&(this.Lkb&&(O.a.removeHandler(this.mr,"change",this.Lkb),this.Lkb=null),this.FVb=null),this.mr=this.ht=this._parent=this.xo=null,this.Wm=!0,this.sXc=null,e.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}cih(yb){if(this.ht){var Gb;(Gb=this.ht.querySelector("input[name=__REQUESTDIGEST]"))?Gb.value=yb:(Gb=this.x8c(),Gb.type="hidden",Gb.id="__REQUESTDIGEST",Gb.name="__REQUESTDIGEST",Gb.value=yb,this.ht.appendChild(Gb))}}x8c(){return this.rsa?
document.createElement("input"):this.xo.contentWindow.document.createElement("input")}WGd(){try{if(!this.xo.contentWindow.document.body)return}catch(Gb){this.Sfi();return}if(!(this._initialized||this.mab&&l.a.NF))this.Xbd();else if(!this.mab||!l.a.NF||this.nwi){let Gb;Gb=l.a.Sv?this.xo.contentWindow.document.body.innerText:this.apg?this.xo.contentWindow.document.body.firstChild.innerText:this.xo.contentWindow.document.body.firstChild.innerHTML;var yb=this.xo.contentWindow.document.body.innerText.toLowerCase();
const Sa=0<=yb.indexOf("responses")||0<=yb.indexOf("wopisrc");yb=0<=yb.indexOf("http error");!Sa&&yb&&e.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.xo.contentWindow.document.body.innerText);this.zbb(Gb)}}Xbd(){if(!this._initialized){var yb=this.ha("uploadForm");const Gb=this.ha("fileInput"),Sa=this.AJe();this.Khh();this.ht.id=yb;this.ht.method="post";this.ht.encoding="multipart/form-data";this.ht.action=Sa;this.mr.type="file";this.y6d&&(this.mr.accept=
this.y6d,this.B8d&&(this.mr.capture=this.B8d));this.mr.id=Gb;this.mr.name=Gb;this.XUg&&(this.mr.multiple=!0);!this.NZe||l.a.Sv||l.a.bI||(this.Lkb=Object(E.a)(this,this.IKh,"fileInputChangedHandleAccessibility"),O.a.addHandler(this.mr,"change",this.Lkb),this.FVb=X.a.Dwe(this.ht,this.mr,"InputFileDescription"));this.ybe&&(this.rsa||(yb=this.xo.contentWindow.document.body,yb.style.margin="0",yb.style.overflow="hidden"),yb=G.AFrameworkApplication.sa,this.mr.style.fontFamily=yb.L1,this.mr.style.fontSize=
yb.wFc,this.mr.style.margin="0");(yb=document.getElementById("__REQUESTDIGEST"))&&this.cih(yb.value);this.ht.appendChild(this.mr);this._initialized=!0;this.wCg(this)}}Khh(){if(this.rsa)this.ht=document.createElement("form"),this._parent.appendChild(this.ht),this.mr=document.createElement("input");else{this.ht=this.xo.contentWindow.document.createElement("form");const yb=this.xo.contentWindow.document;yb.body.appendChild(this.ht);this.mr=yb.createElement("input")}}aWg(){this._parent.appendChild(this.xo);
this.mab&&l.a.NF&&this.Xbd()}AJe(){var yb=new ua.QueryStringBuilder(this.TZe);G.AFrameworkApplication.r_a(yb);this.dDj(yb);yb=yb.toString();if(l.a.Nf||l.a.NF||l.a.bI)yb=Ca.a.chd(yb);return yb}kre(){const yb=new ha.a(2,1,0,Object(E.a)(this,this.delayedDispose,"delayedDispose"),4);G.AFrameworkApplication.ji.Kf(yb)}}Object(t.a)(bb,"UploadFrame",null,[2]);var Ba=a(45),qa=a(120),pa=a(21);class ya extends bb{constructor(yb,Gb,Sa,db,fb,ab,wb=!1){super(yb,Gb,Sa,db,fb,"UploadFrame",ab.ea.sessionId,"image/*",
!1,null,wb);this.$=ab;this.apg=!0;this.Zhf()}ha(yb){return yb}dDj(yb){e.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");qa.a.w0c(yb,this.$.xa);yb.P$(w.a.sessionId,this.sessionId);var Gb=pa.h(this.$).ga;Gb=Ba.o(Gb.qa.h5,this.$);yb.P$(w.a.nfj,this.$.ua.na.name);yb.P$(w.a.mfj,Gb.FirstRow.toString());yb.P$(w.a.lfj,Gb.FirstColumn.toString())}Sfi(){this.y2f("ServerUploadError")}zbb(yb){this.y2f(yb)}static dui(yb){return!yb||B.a.equals(yb,"ServerUploadError",!1)}}Object(t.a)(ya,
"UploadFrameWrapper",bb,[]);class za extends Y{constructor(yb,Gb,Sa,db){super(yb,!1);this.hV=null;this.HCa=!1;this.Sb=null;this.frc=()=>{this.s2d("");this.MFc();return!1};this.$=Gb;this.$Gc=yb;this.mR=la.a.instance;this.fa=Sa;this.Sb=db;this.s$f();this.qqd();this.$.ub.$w=!0}r$f(yb,Gb){return new ya(yb,Object(E.a)(Gb,Gb.KIb,"onUploadFrameInitialized"),Object(E.a)(Gb,Gb.wqa,"uploadResponseReceived"),this.fa,!0,this.$)}dispose(){this.MFc();this.mR=this.$Gc=null;super.dispose()}hide(){super.hide();this.$.ub.$w=
!1}validate(){var yb=this.$Gc.Q3d(this.Uj.rF.value,this.$Gc.zkg(this.Uj));return 0!==yb?(yb=this.$Gc.Qid(yb).Description,this.s2d(yb),this.oZd(),!1):!0}isEnabled(){return!0}s2d(yb){var Gb;null===(Gb=this.Sb)||void 0===Gb?void 0:Gb.q8f(this.hV,yb)}qqd(){this.hV=document.getElementById("errorText");this.hV.style.display="inline-block";this.HCa=!1;this.s2d("");this.nKa.style.maxWidth=this.nKa.currentStyle.minWidth}oZd(){this.mR.ta(N.a.click,this.Uj.rF,this.frc);this.mR.ta(N.a.fc,this.Uj.rF,this.frc);
this.HCa=!0}MFc(){this.HCa&&(this.mR.Ba(N.a.click,this.Uj.rF,this.frc),this.mR.Ba(N.a.fc,this.Uj.rF,this.frc),this.HCa=!1)}}Object(t.a)(za,"InsertImageDialogWrapper",Y,[]);var cb=a(55),Pa=a(60),nb=a(39),Ma=a(109),Oa=a(157),La=a(41);class ra extends d.a{constructor(yb,Gb,Sa,db,fb=!0){super(null,Gb,Sa);this.bka=this.gu=null;this.E9a=!1;this.DId=null;this.wqa=ab=>{this.M4d.stop();this.r3b.cancel();if(ya.dui(ab))this.KEc?this.wcf(4):(ab=new h.a(0,2,null,null,!1,null,null,null),ab.status=8,this.S0d(new r.a(ab),
null,"InsertPictureWebMethod")),e.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.KEc}`);else{const wb=ra.zak(ab);0!==wb?(e.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${ab}`),this.wcf(wb)):this.Efi(ab)}this.Xsc();this.dispose()};this.KXi=ab=>{this.HDa(ab,this.Uj)&&this.finalizeUpload(this.Uj,null)};this.KIb=ab=>{e.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.Uj=ab;if(!this.D3a){if(this.p3d){if(this.BCe()||this.mab&&l.a.NF){ab.n$b(this.KXi);
return}const wb=ab.n$b(null);if(!this.HDa(wb,ab))return}this.finalizeUpload(ab,null)}};this.X5i=()=>{this.KEc=!0};this.pb=yb;this.M4d=yb.Rb.Dg("WebServiceCall","InsertPictureOperation");this.r3b=y.a.instance.create(this.X5i,1E5,A.a.HZg,!1);this.KEc=!1;this.Woc=this.$.xa.InsertPictureMaxFileSizeBytes;db&&(this.E9a="TestOnly"in db);fb&&this.showDialog()}get $(){return this.pb}get AMi(){return this.Woc/1024/1024}dispose(){u.a.Ja(this.r3b);this.Uj&&this.Uj.kre();this.Uj=this.r3b=this.pb=null}ejj(yb){if(!this.$)return e.ULS.sendTraceTag(526399119,
0,50,"ReadPictureAsDataURLTask: EwaControl is null"),Pa.Task.Ua(!0);if(!this.$.Qca)return Pa.Task.Ua(!0);const Gb=new x.a,Sa=new FileReader;yb=yb.rF.files[0];const db=()=>{Gb.Bx(!0)};Sa.onload=()=>{this.DId=Sa.result;Gb.Bx(!0)};Sa.onerror=db;Sa.onabort=db;Sa.readAsDataURL(yb);return Gb.task}zkg(yb){let Gb=-1;yb=yb.rF;(null===yb||void 0===yb?0:yb.files)&&0<yb.files.length&&(Gb=yb.files[0].size);return Gb}Q3d(yb,Gb){let Sa=ra.seh(d.a.HDa(yb));0===Sa?-1!==Gb&&(e.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${Gb}, maxAllowedSize: ${this.Woc}, remainingWorkbookSize: ${this.$.ea.zsf}`),
Gb>this.Woc?Sa=3:Gb>this.$.ea.zsf&&(Sa=7)):6===Sa&&this.mKi(yb);e.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${Sa}`);return Sa}HDa(yb,Gb){yb=this.Q3d(yb,this.zkg(Gb));return 0!==yb?(this.D3a||1===yb||this.bXd(yb),!1):!0}Tjg(yb){yb.DVj()}Qid(yb){let Gb=0,Sa=1,db=-1100324317,fb="InsertPictureUnknownError",ab=null;switch(yb){case 1:Gb=1758;Sa=0;db=940870981;fb="InsertPictureNoFileSelected";break;case 3:Sa=0;db=1250467391;fb="InsertPicturePictureTooBig";ab=String.format(M.a.instance.qb(181),
this.AMi.toLocaleString());break;case 6:Gb=1762;Sa=0;db=1380041209;fb="InsertPictureUnsupportedFormat";break;case 7:Gb=1759;Sa=0;db=-903115058;fb="InsertPictureExceedWorkbookSize";break;case 4:Gb=1760;Sa=0;db=1218352119;fb="InsertPictureUploadTimeout";break;case 5:Gb=1761,Sa=0,db=1979899005,fb="InsertPictureServiceNonDeterministicError"}yb=ra.nd(Gb,Sa,db,fb);ab&&(yb.Description=ab);return yb}showDialog(){if(this.BCe())this.D3a=!1,this.Uj=new ya(this.$.domElement,this.KIb,this.wqa,this.fa,!1,this.$,
!0);else if(e.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.E9a&&(l.a.Ww||l.a.NF&&72>l.a.PEe))this.D3a=!1,this.Uj=new ya(this.$.domElement,this.KIb,this.wqa,this.fa,!1,this.$);else{this.D3a=!0;const yb=Object(Ma.d)(Oa.a.resolve(La.F,{rb:0}));nb.TaskExtensions.za(yb,()=>{this.Uj=(new za(this,this.$,this.fa,yb.result)).Uj},this.$.ka,3)}}Efi(yb){let Gb={};try{if(Gb=m.a.ri(yb),cb.b().DC(this.M4d.id,Gb.ServerCorrelationId,"actions","ServerActions"),!F.a.lg(Gb.Errors)&&Gb.Result){this.$.ea.PX(Gb.StateId,
"BasePictureUploaderWrapper.UploadResponseReceived");const Sa=Gb.Result;R.a(this.$).Roa(1,Sa);const db=this.$.da.Aa(277);db&&db.jZc(this.$,1,Gb.Result,Gb,"InsertPicture");e.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(Sa){e.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${yb?yb.length:-1}, errror: ${Sa}`)}this.kFc(Gb,null,"InsertPictureWebMethod")}wcf(yb){yb=this.Qid(yb);
const Gb={};Gb.Errors=[yb];this.kFc(Gb,null,"InsertPictureWebMethod")}kFc(yb,Gb,Sa){this.gu(yb,Gb,Sa)}S0d(yb,Gb,Sa){this.bka(yb,Gb,Sa)}bXd(yb){yb=this.Qid(yb);D.EwaSettings.By()?new z.a(this.$,yb):(new n.ErrorDialog(this.$,yb)).qg()}mKi(yb){const Gb=this.$.xa.InsertPicturUnsupportedExtensionsForLogging;yb=v.a.Ok(yb);for(let Sa=0;Sa<Gb.length;++Sa)if(yb.endsWith(Gb[Sa])){e.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${Gb[Sa]}`);break}}static zak(yb){return!yb||B.a.equals(yb,
w.a.insertPictureUnknownError,!0)?2:B.a.equals(yb,w.a.insertPictureNoFileSelectedError,!0)?1:B.a.equals(yb,w.a.Eoi,!0)?3:B.a.equals(yb,w.a.Foi,!0)?5:0}static nd(yb,Gb,Sa,db){return F.a.nd(1,0,0,yb,Gb,Sa,db)}static seh(yb){switch(yb){case 1:return 1;case 2:return 6}return 0}BCe(){return this.E9a||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(t.a)(ra,"BasePictureUploaderWrapper",d.a,[2]);class V extends ra{constructor(yb,Gb,Sa,db,fb,ab=!0){super(yb,Gb,Sa,db,!1);this.NKh=fb;
this.bcc=yb.Rb.Dg("LoadResource","FileReaderUploaderLoadResource");ab&&this.showDialog()}YOj(){this.Woc=28E5;this.bXd(3)}Qed(yb){e.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const Gb=new FileReader;yb=yb.rF.files;if(0==yb.length)e.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var Sa=yb[0];Gb.onload=()=>{this.bcc.stop();this.NKh.t5i(Gb.result,this);e.ULS.sendTraceTag(526399109,0,50,
`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${Sa.type}, Size:${Sa.size.toString()}`)};Gb.onerror=()=>{this.bcc.stop();e.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${Sa.type}, Size:${Sa.size.toString()}`)};Gb.onabort=()=>{this.bcc.stop();e.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${Sa.type}, Size:${Sa.size.toString()}`)};this.bcc.start();Gb.readAsDataURL(Sa)}}finalizeUpload(yb,
Gb){this.Qed(yb,Gb)}}Object(t.a)(V,"FileReaderUploaderWrapper",ra,[578]);var ma=a(380),W=a(199);class aa{constructor(yb,Gb){this.dataUri=this.sheetName=null;this.sheetName=yb;this.dataUri=Gb}getSheetName(){return this.sheetName}}Object(t.a)(aa,"MacroRecorderPictureInsertedPayload",null,[145]);class ia extends ra{constructor(yb,Gb,Sa,db,fb,ab=!0){super(yb,Sa,db,fb,!1);this.Ld=Gb;ab&&this.showDialog()}Qed(yb,Gb){super.finalizeUpload(yb,Gb);ma.a(this.$.userOperationManager,(Sa,db)=>{this.gu=Sa;this.bka=
db;this.M4d.start();this.r3b.rq();this.KEc=!1;this.Tjg(yb);return this.ejj(yb)},Sa=>{const db={};this.$.gk(db);const fb=db.SheetName;Sa=new W.a(510,0,Sa,72,()=>new aa(fb,this.DId?this.DId:""));Sa.gCa(()=>!0);Sa.Ld=this.Ld;return Sa},this.Ld)}finalizeUpload(yb,Gb){this.Qed(yb,Gb)}}Object(t.a)(ia,"PictureUploaderWrapper",ra,[]);class ka{constructor(yb,Gb){this.filename=yb;this.blob=Gb}}Object(t.a)(ka,"UploadBlobParameters",null,[]);class Xa extends ia{constructor(yb,Gb,Sa,db,fb,ab,wb){super(yb,Gb,Sa,
db,fb,!1);this.p3d=!1;this.iJ=wb;this.Vhc=Xa.LQh(ab);yb=this.Q3d(this.Vhc.name,this.Vhc.size);0!==yb?(this.bXd(yb),this.iJ.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),this.dispose()):this.Uj=new ya(this.$.domElement,this.KIb,this.wqa,db,!1,this.$)}S0d(yb,Gb,Sa){super.S0d(yb,Gb,Sa);this.iJ.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}kFc(yb,Gb,Sa){super.kFc(yb,Gb,Sa);F.a.lg(yb.Errors)?this.iJ.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${F.a.xc(yb.Errors)}`)):
this.iJ.setResult(!0)}Tjg(yb){const Gb=new ka(this.Vhc.name,this.Vhc);yb.mgg(Gb)}static LQh(yb){var Gb=yb.split(",");yb=Gb[0].includes("base64")?window.self.atob(Gb[1]):window.self.decodeURI(Gb[1]);Gb=Gb[0].split(":")[1].split(";")[0];const Sa=new Uint8Array(yb.length);for(let db=0;db<yb.length;db++)Sa[db]=yb.charCodeAt(db);yb=new Blob([Sa],{type:Gb});yb.name="Image.png";return yb}}Object(t.a)(Xa,"DataUrlUploaderWrapper",ia,[]);let sb=class{constructor(){}nni(yb,Gb,Sa,db,fb){new ia(yb,Gb,Sa,db,fb,
!0)}lmi(yb,Gb,Sa,db,fb,ab){new Xa(yb,null,Gb,Sa,db,fb,ab)}xmi(yb,Gb,Sa,db,fb){new V(yb,Gb,Sa,db,fb,!0)}};sb=Object(f.b)([Object(Oa.d)(La.gb)],sb);Object(t.a)(sb,"UploaderCreator",null,[551]);class ib extends b.a{constructor(yb){super();this.$=yb;this.Mb()}static la(yb){yb.da.Ha(485,new ib(yb))}create(){var yb;this.vb(null!==(yb=this.$.da.Aa(484))&&void 0!==yb?yb:this.$.da.Ha(484,new sb))}}Object(t.a)(ib,"UploaderCreatorFactory",b.a,[]);var Ub=a(70);a.d(C,"a",function(){return hc});const hc=()=>{c.a.Fa(yb=>
{Object(Ub.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")||ib.la(yb)})}},1208:function(t,C,a){t=a(0);var c=a(88),b=a(561),f=a(14);class e{constructor(){this.cJc={}}sLg(Ga){this.cJc[Ga.id.toString()]=Ga}qRi(Ga){const sa=this.cJc;for(let bb in sa)sa[bb].notify(Ga,!1);this.cJc={}}ufj(Ga,sa){sa&&this.sLg(sa);return this.RKf(Ga,sa)}Bbd(Ga){this.qRi(Ga)}cSe(Ga,sa){Ga.notify(sa,!0)}}Object(t.a)(e,"AEventEmitter",null,[509]);var d;(function(Ga){Ga[Ga.notStarted=0]="notStarted";Ga[Ga.waiting=
1]="waiting";Ga[Ga.shouldRetry=2]="shouldRetry";Ga[Ga.complete=3]="complete"})(d||(d={}));Object(t.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(Ga){f.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[Ga]},"ResultType",this.K9e());this._state=Ga}}Object(t.a)(h,"AEventResult",null,[559]);class r extends h{constructor(){super();this.qWc=this.hnb=null;this.state=0;this.lPc=this.Zce=!1}get aS(){return this.hnb}get Npa(){return this.qWc}get Woi(){return this.Zce}K9e(){return"GetMoreInfo Result"}}
Object(t.a)(r,"GetMoreInfoResult",h,[560,559]);var l=a(6),u=a(83),v=a(43),x=a(710),w=a(382),m=a(175),n=a(663),z=a(587),y=a(112),A=a(26);class F{constructor(Ga,sa,bb,Ba,qa,pa,ya,za){this.La=Ga;this.zh=sa;this.Uwg=bb;this.h2=Ba;this.de=qa;this.PNc=pa;this.KBg=ya;this.m_b=za}dlj(){this.sab.Wb(A.a.openUrlInNewTab,y.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.sab.Wb(A.a.UQa,y.a.frame,Object(c.a)(this,this.UQa,"openDocumentUrl"));l.AFrameworkApplication.NM?this.fvf():this.sab.Ne(A.a.x$b,
y.a.frame,Object(c.a)(this,this.x$b,"documentLoaded"),96)}openUrlInNewTab(Ga,sa,bb,Ba,qa){qa&&qa.MenuItemId&&(f.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:qa.SourceControlId,["AppType"]:z.a[this.c7]}),v.a.vf(qa.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}UQa(Ga,sa,bb,Ba,qa){if(qa&&qa.MenuItemId){const pa=l.AFrameworkApplication.fa.ra("WacInTabOpenMRUIsEnabledForUiHost"),ya=l.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");
f.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",pa,ya);if(pa&&ya){f.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:qa.SourceControlId,["AppType"]:z.a[this.c7]});Ga=qa.MenuItemId.toString();const za={};za[w.a.TRa]="1";za[w.a.documentUrl]=Ga;za[w.a.reason]=n.a.open;f.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");l.AFrameworkApplication.dR().execute(cb=>{cb.hi(m.a.JZ,za)})}else this.openUrlInNewTab(Ga,
sa,bb,Ba,qa)}return 32}x$b(){this.fvf();return 32}BPa(Ga,sa,bb=""){if(sa&&sa.HF){const Ba=x.a[sa.status];sa=sa.HF.getTime();const qa=this.Nw()-sa;f.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:Ga,["RequestStatus"]:Ba,["ElapsedMs"]:qa,["StartTime"]:sa,["Notes"]:bb})}else f.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:Ga})}fvf(){var Ga=l.AFrameworkApplication.fa.ra("QPGVCI"),sa=u.a.Pw(document.URL,
"wdNewAndOpenCt",Ga);if(sa){sa=parseInt(sa);var bb=u.a.Pw(document.URL,"wdPreviousSession",Ga);Ga=u.a.Pw(document.URL,"wdPreviousCorrelation",Ga);var Ba=l.AFrameworkApplication.fa.ra("NAOPLP");if(l.AFrameworkApplication.NM){var qa=l.AFrameworkApplication.NM.getTime();!sa||sa>qa?f.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:sa,["DocumentLoadedTime"]:qa,["SessionId"]:bb,["Correlation"]:Ga}):f.ULS.sendTraceTag(5849683,202,
Ba?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:qa-sa,["ClickTimestamp"]:sa,["SessionId"]:bb,["Correlation"]:Ga})}else f.ULS.sendTraceTag(5849681,202,Ba?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:sa,["SessionId"]:bb,["Correlation"]:Ga})}}get sab(){return this.La.value}get PGb(){return this.zh.value}get CAf(){return this.Uwg.value}get c7(){return this.h2.value}get Ypc(){return this.de.value}get Nw(){return this.PNc}get n0(){return this.KBg.value}get supportsGetMoreInfoForPersonalStorage(){return this.m_b.value}static get instance(){return F.Ma||
(F.Ma=F.XM())}static XM(){return new F(new b.a(()=>l.AFrameworkApplication.xb),new b.a(()=>l.AFrameworkApplication.Od),new b.a(()=>l.AFrameworkApplication.sa),new b.a(()=>l.AFrameworkApplication.sa.Pa.$i),new b.a(()=>l.AFrameworkApplication.ji),()=>(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.sa.Pa.n0),new b.a(()=>l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}F.Ma=null;Object(t.a)(F,"NewAndOpenCommonHelpers",null,[508]);var D=a(113);class B{constructor(Ga,sa,bb){this.xZb=
this.jj=null;this.EUc=0;this.DHg=Ga;this.de=sa;this.u$d=bb}kUg(){this.EUc=this.yeb+1}kQd(Ga){this.jj&&(this.de.np(this.jj),this.jj=null);Ga&&(this.EUc=0)}dUj(Ga){const sa=this.rZj;0<=sa?(this.kUg(),this.kQd(!1),this.jj=new D.a(4,1,sa,Ga,107),this.de.Kf(this.jj)):(this.kQd(!0),f.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.u$d}))}get yeb(){return this.EUc}get rZj(){return this.yeb>=this.a7f.length?-1:this.a7f[this.yeb]}get a7f(){if(!this.xZb){const Ga=(this.DHg.value||"0").split(",");
this.xZb=[];for(let sa=0;sa<Ga.length;sa++){const bb=parseInt(Ga[sa]);isNaN(bb)?f.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.u$d,["Entry"]:Ga[sa]}):Array.add(this.xZb,bb)}}return this.xZb}}Object(t.a)(B,"RetryHelper",null,[]);var M=a(42),R=a(34);class P extends e{constructor(Ga,sa){super();this.P2=Ga;this.Gnb=new B(sa,this.tGb.Ypc,"GetMoreInfo");this.cp=new r}ALi(){this.GAd("Document opened")}Lih(Ga){return()=>{this.GAd(Ga,!0)}}RKf(Ga,sa=
null){f.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:Ga});3===this.cp.state?(sa&&this.cSe(sa,this.cp),f.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:Ga})):this.GAd(Ga);return this.cp}GAd(Ga,sa=!1){this.Gnb.kQd(!sa);1===this.cp.state?f.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:Ga,["RetryIndex"]:this.Gnb.yeb}):(f.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",
{["Trigger"]:Ga,["RetryIndex"]:this.Gnb.yeb}),this.cp.state=1,sa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.tGb.n0,l.AFrameworkApplication.Di),this.tGb.PGb.Uha(sa,1,null,null,[P.rje,P.sne],!1,5,this.Rhh(),this.Qhh(Ga),null))}Rhh(){return Ga=>{var sa=!1;let bb=!1;var Ba=!1,qa;l.AFrameworkApplication.fa.ra("GetMoreInfoDataFromResponseBody")&&(Ga.data.te?({Ft:qa}=M.d(Ga.data.te)).returnValue?qa?(Ba=!0,this.cp.qWc=qa.StorageServiceDisplayName,this.cp.hnb=P.Jqf(qa.PersonalFileStorageUrl)?qa.PersonalFileStorageUrl:
"",""===this.cp.aS&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Wa("FileSource")&&(this.cp.hnb=u.a.Fea(l.AFrameworkApplication.breadcrumbFolderUrl)),sa=""===this.cp.aS&&""!==this.cp.Npa):f.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):f.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):f.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));Ba||((qa=Ga.data.responseHeaders)?(this.cp.qWc=(qa[P.sne]||"").toString(),sa=(qa[P.rje]||"").toString(),this.cp.hnb=P.Jqf(sa)?sa:"",""===this.cp.aS&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Wa("FileSource")?(this.cp.hnb=u.a.Fea(l.AFrameworkApplication.breadcrumbFolderUrl),sa=""===this.cp.aS&&""!==this.cp.Npa):sa=""===sa&&""!==this.cp.Npa):(f.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),bb=!0));Ba=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.Gnb.yeb,bb,sa,Ba);this.tGb.BPa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Ga.data,Ba);this.r7f(3,sa,bb)}}Qhh(Ga){return sa=>{this.tGb.BPa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",sa.data,"Failure");this.r7f(2);this.Gnb.dUj(this.Lih(Ga))}}r7f(Ga,sa=!1,bb=!1){this.cp.state=Ga;this.cp.Zce=
sa;this.cp.lPc=bb;this.Bbd(this.cp)}get tGb(){return this.P2.value}static get instance(){return P.Ma||(P.Ma=P.XM())}static XM(){return new P(new b.a(()=>F.instance),new b.a(()=>l.AFrameworkApplication.V2h))}static Jqf(Ga){if(!Ga)return f.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(R.a.Ok(Ga).startsWith("https://"))return!0;f.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}P.rje="PersonalFileStorageUrl";P.sne=
"StorageServiceDisplayName";P.Ma=null;Object(t.a)(P,"GetMoreInfoActor",e,[]);var E=a(108),H=a(103);class G{constructor(Ga,sa,bb,Ba,qa){this.qCg=6E4;this.Xgf="inactive";this.eqe="active";this.uT=!0;this.de=Ga;this.qBg=sa;this.PNc=bb;this.D_b=Ba;this.Za=new H.a;qa&&this.WTj();this.cfe=this.i7e()}Uqe(Ga){this.Za.addHandler(this.eqe,Ga)}PNg(Ga){this.Za.addHandler(this.Xgf,Ga)}WTj(){const Ga=new D.a(5,2,this.qCg,Object(c.a)(this,this.Xji,"inactiveLoop"),108);this.Yji.Kf(Ga)}Xji(){const Ga=this.i7e(),sa=
this.Nw()-Ga;sa>this.HEc&&this.uT&&(f.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:sa}),this.uT=!1,this.Za.raiseEvent(this.Xgf));Ga-this.cfe>this.HEc&&(this.uT=!0,this.Za.raiseEvent(this.eqe));this.cfe=Ga}get Yji(){return this.de.value}get i7e(){return this.qBg}get Nw(){return this.PNc}get HEc(){return this.D_b.value}static get instance(){return G.Ma||(G.Ma=G.XM())}static XM(){return new G(new b.a(()=>E.a.instance),()=>l.AFrameworkApplication.Cxd.getTime(),()=>
(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.HEc),!0)}}G.Ma=null;Object(t.a)(G,"InactivityManager",null,[]);var N=a(89),I=a(946);class O extends h{constructor(){super();this.phe=this.rhe=this.qhe=null;this.state=this.joe=0;this.lPc=!1}get cCd(){return this.qhe}get Nzf(){return this.rhe}get bCd(){return this.phe}get xZj(){return this.joe}K9e(){return"MruActor Result"}}Object(t.a)(O,"MruResult",h,[558,559]);var U=a(247);class ca{constructor(Ga,sa,bb){this.task=null;this.oic=Ga;this.jNi=
sa;this.taskManager=bb;this.retryCount=this.uBb=0;this.PTc=this.BEb=null}Dxi(Ga,sa){return Ga===U.a.Wfd||20===sa||18===sa||3===sa}Yyi(Ga){return 3===Ga||5===Ga||6===Ga||7===Ga||9===Ga||10===Ga||11===Ga||12===Ga||13===Ga||14===Ga||15===Ga||16===Ga||23===Ga||26===Ga||27===Ga||28===Ga}get Nuc(){return this.PTc}reset(){this.uBb=this.retryCount=0;this.PTc=this.BEb=null;this.task&&(this.taskManager.np(this.task),this.task=null)}doi(Ga,sa,bb,Ba){this.PTc=String.format("{0}_{1}",bb,Ba);if(this.retryCount>=
this.jNi)return f.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Dxi(bb,Ba))return f.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Yyi(Ba)&&1<=this.uBb)return this.BEb=bb,!1;sa=Math.max(sa,this.oic*Math.pow(2,this.uBb));if(26===Ba)sa=Math.max(sa,3E4);else if(27===Ba||28===Ba)sa=Math.max(sa,6E4);9===Ba||412===bb&&(null==this.BEb||412!==this.BEb)?sa=500:this.uBb+=1;this.BEb=bb;this.retryCount+=1;this.task&&this.taskManager.np(this.task);
f.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",sa);this.task=new D.a(2,1,sa,Ga,107);this.taskManager.Kf(this.task);return!0}}Object(t.a)(ca,"RetryManager",null,[]);var Q=a(104),Y=a(145),la=a(131);class ea{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(t.a)(ea,"WriteOptions",null,[]);var ha=a(568),X=a(200);class T extends e{constructor(Ga,sa,bb,Ba,qa,pa,ya){super();this.P2=Ga;this.lEg=sa;this.Fsa=new ca(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.PD.Ypc);this.hta=new ca(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.PD.Ypc);this.DGg=bb;this.Ape=Ba;this.NKg={};this.xT=new O;this.mBg=qa;this.HXb="";this.mw=pa;this.qae=ya}get jIc(){return this.NKg}Ymj(){this.PD.sab.Wb(A.a.renameMostRecentlyUsedFileEntry,
y.a.frame,Object(c.a)(this,this.Qrj,"renameMruEntry"))}Qrj(){return this.g5d("Rename")}KLi(){this.Nxf("File Opened")}LLi(){this.Nxf("IntervalUpdate")}Nxf(Ga){f.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:Ga});this.g5d(Ga)}n5(Ga){(Ga=R.a.n5(Ga))&&Ga.startsWith(".")&&(Ga=Ga.substring(1,Ga.length));return Ga}g3e(){switch(this.PD.c7){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}zai(Ga){var sa=
this.mBg();if(!sa)return null;const bb=new ea;bb.documentUrl=this.qae.value?encodeURI(sa):sa;bb.mruItemId=this.HXb;bb.app=this.g3e();if(sa=this.mw())bb.folderName=sa.breadcrumbFolderName,sa=sa.Bn,bb.documentName=R.a.Zp(sa),bb.documentExt=this.n5(sa);Ga&&(bb.documentName?bb.documentName.length?255<=bb.documentName.length?Ga.set("DocumentNameLength","Long"):2084<=bb.documentName.length&&Ga.set("DocumentNameLength","VeryLong"):Ga.set("DocumentNameLength","0"):Ga.set("DocumentNameLength","Null"));return JSON.stringify(bb)}g5d(Ga,
sa=!1){if(4===this.PD.c7&&!l.AFrameworkApplication.nva)return 2;var bb=Y.a.gs();bb&&(bb.set("Trigger",Ga),bb.set("IsRetry",sa?"true":"false"),bb.set("MruIdSent",this.HXb?"true":"false"),bb.set("URLEncoded",this.qae.value?"true":"false"));Q.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",bb);Ga=this.zai(bb);if(!Ga)return sa=!l.AFrameworkApplication.webEditingEnabled,bb&&(bb.set("WebEditingIsEnabled",l.AFrameworkApplication.webEditingEnabled?"true":"false"),bb.set("ProtectedFile",l.AFrameworkApplication.Yuc?
"true":"false")),Q.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",sa,!1,Object.assign(new X.a,{extendedProperties:bb})),2;this.hta&&!sa&&this.hta.reset();bb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.PD.n0,this.localeName);this.Ape?this.jIc["X-FileId"]=l.AFrameworkApplication.Di:bb+=String.format("&{0}",l.AFrameworkApplication.Di);l.AFrameworkApplication.Yb&&(this.jIc["X-Office-AudienceGroup"]=Object(N.a)(String,l.AFrameworkApplication.Yb.AudienceGroup)||"");this.jIc["X-Timeout"]=
15E3;return this.PD.PGb.Zm(bb,2,Ga,this.jIc,!0,5,Object(c.a)(this,this.Zck,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.tmh,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}Zck(Ga){this.Zcf(Ga.data)}Zcf(Ga){const sa=Y.a.gs();this.hta&&(sa&&this.hta.Nuc&&(sa.set("LastError",this.hta.Nuc),sa.set("NumRetries",this.hta.retryCount.toString())),this.hta.reset());const bb=I.c(Ga.te);bb&&bb.diagnostics_data&&(this.HXb=bb.diagnostics_data.mru_id);Ga=
+Ga.g4-+Ga.HF;sa&&sa.set("RequestDuration",Ga.toString());Q.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new X.a,{extendedProperties:sa}))}tmh(Ga){if(Ga.data.httpStatus===U.a.tub)this.Zcf(Ga.data);else{var sa=Ga.data.httpStatus===U.a.TJb,bb=Y.a.gs();this.kdf(this.hta,Ga,this.gmh(),bb);bb&&(bb.set("StatusCode",Ga.data.httpStatus.toString()),sa||this.aZc(Ga.data,bb));Q.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ga.data.httpStatus),sa,!1,Object.assign(new X.a,
{extendedProperties:bb}))}}gmh(){return()=>{this.g5d("Retry",!0)}}a3h(){this.Poc("Polling")}$2h(){this.Poc("Retry",!0)}CLi(){this.Poc("Open")}BLi(){this.Poc("Activity")}Poc(Ga,sa=!1){f.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:Ga});const bb=Y.a.gs();bb&&(bb.set("Trigger",Ga),bb.set("IsRetry",sa?"true":"false"));Q.Health.instance.recordKpiUsage("GetMru",0,"smartfio",bb);this.Fsa&&!sa&&this.Fsa.reset();this.Shh(Object(c.a)(this,this.c3h,"getMruV2FromServerSuccessCallback"),
Object(c.a)(this,this.Z2h,"getMruFromServerFailureCallback"))}aZc(Ga,sa){Ga&&Ga.responseHeaders&&(Ga=Ga.responseHeaders["X-CorrelationId"])&&sa.set("ServerCorrelationId",Ga)}lIi(Ga,sa){Ga&&(sa&&sa.set("RequestDuration",(+Ga.g4-+Ga.HF).toString()),Q.Health.instance.recordKpiSuccess("GetMru",Object.assign(new X.a,{extendedProperties:sa})))}c3h(Ga){this.d3h(Ga)}d3h(Ga){var sa="";let bb=null,Ba=null,qa=null;const pa=I.c(Ga.data.te);pa&&(bb=pa.places?pa.places.items:[],Ba=pa.documents?pa.documents.items:
[],(qa=I.a(pa,!1))&&(sa=M.c(qa)));l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Pa.O_&&la.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(sa,!0));sa=Y.a.gs();this.Fsa&&(sa&&this.Fsa.Nuc&&(sa.set("LastError",this.Fsa.Nuc),sa.set("NumRetries",this.Fsa.retryCount.toString())),this.Fsa.reset());qa||bb||Ba?(this.PD.BPa("MruActor.GetMruV2FromServerSuccessCallback",Ga.data,"Success"),this.HGc(3,qa,bb,Ba),this.lIi(Ga.data,sa)):(this.PD.BPa("MruActor.GetMruV2FromServerSuccessCallback",
Ga.data,"Failure: Invalid JSON"),sa&&this.aZc(Ga.data,sa),Q.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new X.a,{extendedProperties:sa})),this.HGc(3,null,null,null,!0));this.Bbd(this.xT)}kdf(Ga,sa,bb,Ba){let qa=0,pa=0;const ya=I.c(sa.data.te);ya&&(null!=ya.response_code&&(qa=ya.response_code,Ba&&Ba.set("MruResponseCode",qa.toString()),9===qa&&(this.HXb="")),ya.error_data&&null!=ya.error_data.retry_after_ms&&(pa=ya.error_data.retry_after_ms,Ba&&Ba.set("ExpectedRetryAfter",
pa.toString())));Ga&&(sa=Ga.doi(bb,pa,sa.data.httpStatus,qa),Ba&&(Ba.set("CurrentRetryCount",Ga.retryCount.toString()),Ba.set("RetryScheduled",sa?"true":"false")))}Z2h(Ga){this.b3h(Ga)}b3h(Ga){const sa=Ga.data.httpStatus===U.a.TJb,bb=Y.a.gs();bb&&(bb.set("StatusCode",Ga.data.httpStatus.toString()),sa||this.aZc(Ga.data,bb));this.PD.BPa("MruActor.GetMruFromServerFailureCallback",Ga.data,"Failure");this.HGc(2);this.kdf(this.Fsa,Ga,Object(c.a)(this,this.$2h,"getMruFromServerRetryTask"),bb);Q.Health.instance.recordKpiFailure("GetMru",
String.format("RequestFailed_{0}",Ga.data.httpStatus),sa,!1,Object.assign(new X.a,{extendedProperties:bb}));this.Bbd(this.xT);l.AFrameworkApplication.sa&&l.AFrameworkApplication.sa.Pa.O_&&la.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}HGc(Ga,sa=null,bb=null,Ba=null,qa=!1){if(3!==this.xT.state||3===Ga)this.xT.qhe=sa,this.xT.rhe=bb,this.xT.phe=Ba,this.xT.state=Ga,this.xT.lPc=qa,this.xT.joe=this.PD.Nw()}RKf(Ga,
sa){f.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:Ga,["ResultState"]:this.xT.state});sa&&3===this.xT.state&&this.cSe(sa,this.xT);return this.xT}Shh(Ga,sa){this.HGc(1);let bb;const Ba={};bb=String.format(this.PD.n0+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.g3e(),this.localeName);this.DGg.value||(bb+="&entity=docs");l.AFrameworkApplication.Yb&&(Ba["X-Office-AudienceGroup"]=Object(N.a)(String,l.AFrameworkApplication.Yb.AudienceGroup)||"");this.Ape?
Ba["X-FileId"]=l.AFrameworkApplication.Di:bb+=String.format("&{0}",l.AFrameworkApplication.Di);this.PD.PGb.Zm(bb,1,null,Ba,!0,5,Ga,sa,null)}get PD(){return this.P2.value}get localeName(){return this.lEg.value}static get instance(){return T.Ma||(T.Ma=T.XM())}static XM(){return new T(new b.a(()=>F.instance),new b.a(()=>ha.a.KH(l.AFrameworkApplication.lcid).name),new b.a(()=>l.AFrameworkApplication.sa.Pa.Uv),l.AFrameworkApplication.fa.ra("MruWriteFileIdInHeader"),()=>l.AFrameworkApplication.sa.Pa.rz,
()=>l.AFrameworkApplication.Fm,new b.a(()=>l.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled")))}}T.Ma=null;Object(t.a)(T,"MruActor",e,[]);class ua{constructor(){this.Iob=this.rke=this.ib=null;this.Wm=!1}get name(){return"Common.App.NewAndOpen.Core"}ki(Ga){this.ib=Ga;Ga.register(508,"Common.INewAndOpenCommonHelpers").zc().Gc(()=>F.instance);Ga.register(509,"Common.IEventEmitter<Common.IGetMoreInfoResult>").zc().Gc(()=>P.instance);Ga.register(509,"Common.IEventEmitter<Common.IMruResult>").zc().Gc(()=>
T.instance)}init(){l.AFrameworkApplication.fa.Nu(()=>{this.eBb()})}eBb(){this.ib.resolve("Common.INewAndOpenCommonHelpers");this.ib.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.ib.resolve("Common.IEventEmitter<Common.IMruResult>");var Ga=!1;F.instance.dlj();l.AFrameworkApplication.lna&&(Ga=!0);l.AFrameworkApplication.QVf&&(T.instance.CLi(),0<l.AFrameworkApplication.Ozf&&this.zre(),this.zJj(),Ga=!0);l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Ga&&P.instance.ALi();
l.AFrameworkApplication.y7j&&(Ga=T.instance,Ga.Ymj(),Ga.KLi(),E.a.instance.Kf(this.z7j))}zJj(){G.instance.Uqe(Object(c.a)(T.instance,T.instance.BLi,"makeGetMruRequestActivityTrigger"));G.instance.Uqe(Object(c.a)(this,this.zre,"addGetMruFromServerTask"));G.instance.PNg(Object(c.a)(this,this.lph,"deleteGetMruFromServerTask"))}lph(){E.a.instance.np(this.Pzf)}zre(){E.a.instance.Kf(this.Pzf)}get Pzf(){return this.rke||(this.rke=new D.a(5,2,l.AFrameworkApplication.Ozf,Object(c.a)(T.instance,T.instance.a3h,
"getMruFromServerTask"),109))}get z7j(){return this.Iob||(this.Iob=new D.a(2,2,6E4*l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(T.instance,T.instance.LLi,"makeUpdateMruTask"),197))}dispose(){this.Wm||(this.Wm=!0,this.Iob&&(E.a.instance.np(this.Iob),this.Iob=null))}}Object(t.a)(ua,"CorePackageManager",null,[4,5,2]);var Ha=a(260);a.d(C,"a",function(){return Ca});const Ca=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");
Ha.a.instance.dj(new ua)}},1225:function(t,C,a){var c=a(10);t=a(0);var b=a(718),f=a(170),e=a(108),d=a(6),h=a(197),r=a(14),l=a(1417),u=a(34),v=a(104),x=a(84),w=a(568),m=a(181),n=a(45),z=a(380),y=a(199),A=a(294),F=a(32),D=a(258),B=a(12),M=a(15),R=a(293),P=a(110),E=a(21),H=a(160),G=a(148),N=a(93),I=a(102),O=a(175),U=a(194),ca;(function(aa){aa[aa.unknown=0]="unknown";aa[aa.bing=1]="bing";aa[aa.M365=2]="M365"})(ca||(ca={}));Object(t.b)("InsertMediaProviders",ca);var Q=a(95),Y=a(167),la=a(355),ea=a(1),
ha=a(879),X=a(83);class T extends ha.a{constructor(aa,ia){super(aa,X.a.BK(ia))}YKb(aa,ia){this.isEnabled()&&this.QP(this.targetOrigin)&&(this.Am(aa),this.Lk(aa,ia))}}Object(t.a)(T,"InsertMediaCrossDocumentMessenger",ha.a,[609,186,2]);var ua=a(2);class Ha{}Object(t.a)(Ha,"OnlineMediaSearchResult",null,[]);var Ca=a(325),Ga=a(849),sa=a(354),bb;(function(aa){aa[aa.OK=0]="OK";aa[aa.cancel=1]="cancel";aa[aa.error=2]="error";aa[aa.open=3]="open"})(bb||(bb={}));Object(t.b)("HubbleAction",bb);var Ba=a(68);
class qa extends H.a{constructor(aa,ia,ka,Xa,sb,ib){super();this.zkc=!1;this.correlationId=this.Eic=this.ayd=this.QB=this.Lxa=null;this.GUi=()=>{this.Sva(this.d1a);this.Fzc(1)};this.Swd=Ub=>{Ub.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==Ub.target.id||Ub.shiftKey?"KeepFocusStartDiv"===Ub.target.id&&Ub.shiftKey&&(Ub.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(Ub.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.L0i=()=>{this.Eqb&&(this.Eqb.launchUpsellExperience("stockimages"),
r.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.g2i=Ub=>{Ub&&Ub.Values&&(Ub=Ub.Values,delete Ub.m_Origin,delete Ub.m_Source,delete Ub.m_ReceivedTime,r.ULS.sendTraceTag(0,352,50,"Received OTel event: "+Ub.eventName||!1),G.a.sendOtelEvent(Object.assign(new Ga.a,{otelEvent:Ub})))};this.el=ib;this.$=aa;this.lif=ia;this.Eqb=ka;this.rX=[];this.UPa=Xa;this.Qqh=sb;this.Cve=this.$.xa.InsertOnlinePictureMaxCountOfImagesToInsert;this.Eic=this.$.xa.InsertPictureTelemetryEndpoint;
this.dg=this.pih()}yPj(aa){this.zkc=!1;this.showDialog(this.el,null);this.Lxa=document.getElementById(this.Sh("InsertMediaFrame"));if(!this.Lxa)throw this.Sva(this.d1a),Error.invalidOperation("Couldn't get InsertMediaIframe.");var ia=document.getElementById(this.Sh("WACDialogPanel"));ia&&ia.setAttribute(N.a.Kd,N.a.w0a);ia=document.createElement("div");ia.id="KeepFocusStartDiv";ia.tabIndex=0;ia.className="keep-focus-start";this.Lxa.parentNode.insertBefore(ia,this.Lxa.parentNode.firstChild);ia=document.createElement("div");
ia.id="KeepFocusDiv";ia.tabIndex=0;ia.className="keep-focus";this.correlationId=m.a.create();this.Lxa.parentNode.appendChild(ia);$addHandler(this.nKa,"keydown",this.Swd);this.Lxa.src=this.lif;this.Lxa.frameBorder="0";ia=document.getElementById(this.Sh("WACDialogButtonPanel"));if(!ia)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");ia.className="display-none";ia=document.getElementById(this.Sh("WACDialogTitleText"));if(!ia)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");
ia.className="display-none";2===this.UPa&&(document.getElementById(this.Sh("WACDialogTitlePanel")).className="display-none",document.getElementById(this.Sh("WACDialogBodyPanel")).className="padding-zero");I.FocusManager.instance().WQ().scope.EN=!0;this.QB=new T(this.Lxa.contentWindow,this.lif);this.QB.QP("https://osiziwuspersimmon002.blob.core.windows.net");this.QB.QP("https://osizewuspersimmon001.blob.core.windows.net");this.QB.QP("https://osizpscuspersimmon000.blob.core.windows.net");this.QB.QP("https://cdn.hubblecontent.msit.osi.office.net");
this.QB.QP("https://cdn.hubblecontent.osi.office.net");this.QB.YKb(O.a.tNg,ka=>{this.vTi(ka,aa.wqa)});this.QB.YKb(O.a.insert,()=>{this.Y_i(aa.wqa)});this.QB.YKb(O.a.F3c,this.GUi);this.QB.YKb(O.a.UNg,ka=>{this.g2i(ka)});2===this.UPa&&0===this.Qqh&&(this.QB.YKb(O.a.DEi,this.L0i),this.ayd=this.Eqb.kBa("MsoPremiumStockImages",ka=>{r.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");ka.isEnabled?this.QB.hi(O.a.s9j,{["LicenseTier"]:ka.toString()}):r.ULS.sendTraceTag(537155810,
0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.Fzc(3)}dispose(){this.rX=null;this.Eqb&&this.ayd&&this.Eqb.uNd("MsoPremiumStockImages",this.ayd);this.QB&&(this.QB.dispose(),this.QB=null);super.dispose()}hide(){super.hide();Q.a.qAc(this.$)}get i5(){return U.a.F9b+"/InsertMediaDialog"}get dZ(){return!1}vTi(aa,ia){aa=aa&&aa.Values?(aa=aa.Values)?Object(ua.a)(new Ha,{Action:aa.action||"",Caption:aa.caption||"",ContentType:aa.contentType||"",FileExtension:aa.extension||
"",PageUrl:aa.pageUrl||"",SourceUrl:aa.sourceUrl||"",ThumbnailUrl:aa.thumbnailUrl||"",LicenseUrl:aa.licenseUrl||"",LicenseDisplayName:aa.licenseDisplayName||"",Height:aa.height||0,Width:aa.width||0}):null:null;aa&&(this.rX.push(aa),this.zkc&&(r.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),ia(this.rX),this.zkc=!1,this.Sva(this.d1a)))}Y_i(aa){this.rX&&0<this.rX.length?this.rX.length<=this.Cve?(aa(this.rX),this.Fzc(0),this.Sva(this.d1a)):(this.rA(),
r.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.rX.length=0,this.Fzc(2)):this.zkc=!0}pih(){const aa=document.createElement("div");aa.id="InsertMediaDialog";aa.className=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";const ia=document.createElement("div");ia.id="InsertMediaPanel";ia.className=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",
!0)?"insert-media-panel":"insert-media-panel-old";const ka=document.createElement("iframe");ka.id="InsertMediaFrame";ka.className="insert-media-frame";aa.appendChild(ia);ia.appendChild(ka);return Ca.b(aa)}rA(){const aa=F.a.nd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");aa.Description=String.format(M.a.instance.qb(206),this.Cve.toLocaleString());ea.EwaSettings.By()?new la.a(this.$,aa):(new Y.ErrorDialog(this.$,aa)).qg()}A7e(){return 2===this.UPa?"M365":"bing"}$cj(){const aa=new XMLHttpRequest;
aa.open("POST",this.Eic,!0);aa.setRequestHeader("Content-Type","");return aa}Fzc(aa){var ia,ka,Xa=RegExp("hubble","gi");if(this.Eic&&0<this.Eic.search(Xa)&&this.correlationId){Xa=d.AFrameworkApplication.Yb;var sb={};sb.InsertedFiles=this.rX.length;sb.MediaDetails=this.rX;sb.DialogResult=bb[aa];sb.DialogMode=this.A7e();sb.CorrelationId="{"+this.correlationId.toString()+"}";sb.Platform="Wac";sb.Provider=ca[this.UPa]||"Unknown";sb.AudienceGroup=Xa&&"AudienceGroup"in Xa?Xa.AudienceGroup.toString():"Unknown";
sb.AudienceGroup=Xa&&"AudienceGroup"in Xa?Xa.AudienceGroup.toString():"Unknown";sb.Ring=Xa&&"Ring"in Xa?Xa.Ring.toString():"Unknown";sb.AppId=1;sb.Build=d.AFrameworkApplication.buildVersion;sb.Locale=w.a.KH(d.AFrameworkApplication.lcid).name;this.$cj().send(JSON.stringify(sb))}2===this.UPa&&(sb=d.AFrameworkApplication.fa.Wa("InsertMediaDialogAriaTenantNameSpace"))&&""!==sb&&(Xa=[],2===this.UPa&&(Array.add(Xa,Object.assign(new Ba.a,{name:"DialogMode",string:this.A7e()})),Array.add(Xa,Object.assign(new Ba.a,
{name:"Provider",string:ca[this.UPa]})),Array.add(Xa,Object.assign(new Ba.a,{name:"InsertedFiles",int64:null===(ia=this.rX)||void 0===ia?void 0:ia.length})),Xa.push(Object.assign(new Ba.a,{name:"MediaDetails",string:this.rX?JSON.stringify(this.rX.map(ib=>ib.SourceUrl)):null})),Array.add(Xa,Object.assign(new Ba.a,{name:"DialogResult",string:bb[aa]})),Array.add(Xa,Object.assign(new Ba.a,{name:"CorrelationId",string:null===(ka=this.correlationId)||void 0===ka?void 0:ka.toString()})),G.a.sendTelemetryEvent(Object.assign(new sa.a,
{name:String.format("{0}.{1}",sb,"InsertM365Images"),dataFields:Xa}))))}}Object(t.a)(qa,"InsertMediaDialog",H.a,[]);var pa=a(386),ya=a(301);class za extends l.a{constructor(aa,ia,ka,Xa,sb,ib){super(null,ka,Xa);this.iwf=0;this.wqa=Ub=>{if(Ub){var hc=Array(Ub.length);for(var yb=0;yb<Ub.length;yb++){const db=Ub[yb];hc[yb]={};hc[yb].SourceUrl=db.SourceUrl;u.a.pya(db.LicenseUrl)&&u.a.pya(db.PageUrl)&&(hc[yb].LicenseUrl=db.LicenseUrl,hc[yb].LicenseDisplayName=db.LicenseDisplayName,hc[yb].PageUrl=db.PageUrl);
hc[yb].AltText=-2053056795===this.Ld.command?db.Caption:""}var Gb=-2009825598===this.Ld.command?"bing":"M365";yb=E.h(this.$);var Sa=n.o(yb.ga.qa.activeCell,this.$);z.a(this.$.userOperationManager,(db,fb,ab)=>A.s(this.$.pa.va,Sa,hc,Gb,R.b(db,this.w2i),R.a(fb,this.v2i),ab,null),db=>new y.a(595,0,db),this.Ld);B.HelperMethods.J_?(yb=new Map,yb.set("MediaProvider",Gb),yb.set("ImagesCount",Ub.length.toString()),yb.set("TimeTakenToOpenDialog",this.iwf.toString()),v.Health.instance.recordKpiUsage(ya.a.Boi,
1,pa.a.Hhg,yb)):r.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Xsc()}else r.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};this.w2i=Ub=>{D.a(Ub)?r.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${F.a.xc(Ub.Errors)}`):(r.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),
Ub.Result?P.a(this.$).Roa(1,Ub.Result):r.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};this.v2i=()=>{r.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=aa;this.Ld=ia;this.iJ=ib;this.lwe=x.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let aa=null;aa=this.$.Rb.Qc("UserAction","showOnlineImagesDialogTimeStopwatch");
switch(this.Ld.command){case -2009825598:this.HOj();break;case -2053056795:this.lwe.execute(ia=>{ia.isFeatureEnabled("MsoPremiumStockImages",!1).catch(ka=>r.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${ka}`)).then(ka=>{this.IOj(ka);return null})})}aa.stop();this.iwf=aa.Jc}HOj(){let aa=this.$.xa.BingPictureEndpoint;const ia=w.a.KH(d.AFrameworkApplication.lcid),ka=m.a.create();aa?(aa=0<aa.search(RegExp("insertmedia.bing.office.net",
"gi"))?String.format(aa,1,1):String.format(aa,1,d.AFrameworkApplication.lcid,ia?ia.name:"en-us",d.AFrameworkApplication.buildVersion,ka.toString(),1,this.$.xa.DocumentHostInfo.LoggableUserId),this.J7b(aa,1,-1,M.a.instance.ha(1764))):(r.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.iJ.setException(Error.create("Failed to access the Bing service endpoint")))}IOj(aa){var ia=this.$.xa.M365PictureEndpoint,ka=m.a.create();
if(ia){var Xa=this.$.xa.DocumentHostInfo.UserId;Xa=Xa?u.a.Au(Xa).toString():"0";var sb=this.lwe.instance.isFreemiumUpsellEnabled();aa=aa?1:sb?0:-1;ka=ka.toString();sb=w.a.KH(d.AFrameworkApplication.lcid).name;ia=String.format(ia,d.AFrameworkApplication.lcid,sb,d.AFrameworkApplication.buildVersion,ka,1,Xa,aa,1);this.J7b(ia,2,aa,M.a.instance.ha(1763))}else r.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.iJ.setException(Error.create("Failed to access the M365 service endpoint"))}J7b(aa,
ia,ka,Xa){try{(new qa(this.$,aa,x.a.instance.yg("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),ia,ka,Xa)).yPj(this),this.iJ.setResult(!0)}catch(sb){r.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${sb}] [MediaProvider : ${ia}] [DialogLicenseTier : ${ka}]`),this.iJ.setException(sb)}}}Object(t.a)(za,"OnlinePictureUploaderWrapper",l.a,[2]);var cb=a(60);class Pa{constructor(aa,ia){this.$=aa;this.uploaderCreator=ia}executeCommand(aa,
ia,ka){aa=ia.command;switch(aa){case 1403967063:if(ka&&"dataUrl"in ka)return ia=new f.a,this.uploaderCreator&&this.uploaderCreator.lmi(this.$,e.a.instance,d.AFrameworkApplication.fa,ka,ka.dataUrl,ia),ia.task;this.uploaderCreator&&this.uploaderCreator.nni(this.$,ia,e.a.instance,d.AFrameworkApplication.fa,ka);return cb.Task.Ua(!0);case -2053056795:case -2009825598:return aa=new f.a,new za(this.$,ia,e.a.instance,d.AFrameworkApplication.fa,ka,aa),aa.task;default:return h.a(aa)}}Ac(aa,ia){if(aa=this.$.isEditMode)switch(ia.command){case 1403967063:aa=
!0;break;case -2053056795:aa=!0;break;case -2009825598:aa=!0;break;default:aa=!1}return aa}Vc(){return!1}Oc(){return!1}}Object(t.a)(Pa,"PictureCommandHandler",null,[233]);var nb=a(39),Ma=a(53),Oa=a(109),La=a(157),ra=a(41),V=a(70);class ma extends b.a{constructor(aa){super(aa)}Fd(){nb.TaskExtensions.za(Object(V.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?Object(Oa.d)(La.a.resolve(ra.gb,{rb:this.Na})):Ma.GetServiceTaskFactory.Sa(this.$.da,484,485,1),aa=>{this.qd([new Pa(this.$,aa.result)])},
this.$.ka,3)}static la(aa){b.a.Yd(90,new ma(aa))}}Object(t.a)(ma,"PictureCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return W});const W=()=>{c.a.Fa(aa=>{ma.la(aa)})}},1226:function(t,C,a){t=a(0);var c=a(14),b=a(198),f=a(88),e=a(89),d=a(393),h=a(105),r=a(50);class l{constructor(){this.yea=this.G2e=null}}Object(t.a)(l,"GestureAdapterInfo",null,[]);var u=a(6),v=a(384),x=a(234);class w{constructor(){this.iMc=null}$Fi(){if(!this.iMc){var O="hammer.min.js";u.AFrameworkApplication.fa.Sp("IsServerFlavorDebug")&&
(O=u.AFrameworkApplication.fa.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");O=u.AFrameworkApplication.BO(String.format("{0}",O),5);O=x.a.create(O,null,null);v.a.Qja(O);this.iMc=O.z$a}return this.iMc}static get instance(){w.Ma||(w.Ma=new w);return w.Ma}}w.Ma=null;Object(t.a)(w,"HammerJsDependencyLoader",null,[580]);var m=a(16);const n=(O,U,ca=null)=>{if(void 0===U||null===U)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Q=
null;switch(O){case m.a.pinch:Q=new Hammer.Pinch(ca);break;case m.a.pan:Q=new Hammer.Pan(ca)}Q&&(Q.manager=U);return Q};var z;(function(O){O[O.none=-1]="none";O[O.pinch=0]="pinch";O[O.pan=1]="pan";O[O.swipe=2]="swipe"})(z||(z={}));Object(t.b)("GestureEvent",z);var y=a(81);class A extends y.a{constructor(O,U,ca,Q,Y,la,ea,ha){super(O,ca,Q,la);this.Ajb=U;this.sha=ea;this.iY=ha;this.jBg=Y}get shiftKey(){return this.sha}get ctrlKey(){return this.iY}get clientPoint(){return this.Ajb}get nwa(){return this.jBg}static create(O,
U,ca,Q,Y,la){if(ca.rawEvent)if(la){var ea=ca.rawEvent;ea=new Sys.UI.Point(ea.clientX,ea.clientY)}else ea=y.a.Zxb(ca);else ea=new Sys.UI.Point(ca.clientX,ca.clientY);return new A(O,ea,U,ca,Q,Y,ca.shiftKey,ca.ctrlKey,la)}}Object(t.a)(A,"GestureEventArgs",y.a,[]);class F{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(t.a)(F,"GestureManagerData",null,[]);class D{}D.Iug=2;D.Jug=4;D.Kug=8;D.Lug=8;Object(t.a)(D,"HammerConstants",null,[]);var B=a(100),M=a(212),R=a(34),P=a(85);class E extends r.a{constructor(O,U){super();this.Qra=d.a.ySh;this.ITc=!!window.PointerEvent;this.noe=window.hasOwnProperty("ontouchstart");this.PXa=this.Qmb=null;this.b$=!1;this.yT=
new h.a;this.jnb=new h.a;this.kBg=new b.a;this.ora=null;this.PWa=this.YNc=this.J8d=this.TKc=this.CRc=this.Kke=this.P8d=this.Kob=!1;this.umb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.pWc=null;this.Wd=B.EventHandlerManager.instance;this.ITc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Qmb=Object(f.a)(this,this.DQa,"onPointerEvent"),this.PXa=m.a.ASh):this.noe?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Qmb=Object(f.a)(this,this.rAa,"onTouchEvent"),
this.PXa=m.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Qmb=Object(f.a)(this,this.csc,"onMouseEvent"),this.PXa=m.a.zSh);this.Fh=U;this.tga=O;u.AFrameworkApplication.fa&&(this.Kob=u.AFrameworkApplication.fa.ra("UsePointerCaptureIsEnabled"),this.P8d=u.AFrameworkApplication.fa.ra("ClearCacheOnPrimaryPointerIsEnabled"),this.Kke=u.AFrameworkApplication.fa.ra("ResetHandledBeforeInputHandlerIsEnabled"),this.CRc=u.AFrameworkApplication.fa.ra("LogCoalescedEventsIsEnabled"),
this.TKc=u.AFrameworkApplication.fa.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.J8d=u.AFrameworkApplication.fa.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),this.YNc=u.AFrameworkApplication.fa.ra("HammerJsPerformanceTimersIsEnabled"),this.PWa=this.Kob&&u.AFrameworkApplication.fa.ra("CancelDragFromGestureInputManagerIsEnabled")&&u.AFrameworkApplication.fa.ra("UseGestureInputManagerPointerCacheIsEnabled"))}Z_h(){return this.ITc?0:this.noe?1:2}Ln(O){super.Ln(O);this.Wd.Pla(this.PXa,O,0,
this.Qmb)}Em(O){super.Em(O);this.Wd.hKa(O,this.PXa)}Blj(O,U,ca=null){u.AFrameworkApplication.Qkc()?w.instance.$Fi().continueWith(Q=>{this.nUj();if(Q.Tf||Q.Ah)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Q.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Q.status);if(this.J8d){Q=window.Hammer;if("undefined"===typeof Q){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.nDc();return}if("undefined"===typeof Q.inputHandler){c.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.nDc();return}}if(!O)throw this.nDc(),Error.argumentNull("source element can not be null");Q=M.a.Swa(O,this.Qra);if(void 0===Q||null===Q)Q=new h.a,M.a.ofb(O,this.Qra,Q),this.Clj(O);var Y=null;Q.nb(z[0])||(Y=Object.assign(new l,{yea:n(z[0],this,null),G2e:U}),Q.add(z[0],Y));if(void 0!==ca&&null!==ca)for(let la=0;la<ca.length;la++)if(Q.nb(z[ca[la]])){const ea=Q.ma(z[ca[la]]);Y.yea.recognizeWith(ea.yea)}}this.nDc()}):c.ULS.sendTraceTag(42256219,310,10,
"Multi Touch is not enabled either from common BRS or from your app BRS")}nUj(){this.YNc&&(this.Fh?this.pWc=this.Fh.Qc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}nDc(){this.YNc&&(this.pWc?this.pWc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Clj(O){this.kBg.add(O);this.Wd.Pla(this.PXa,O,0,this.Qmb)}recognize(O){var U=Array(O.pointers.length);for(var ca=0;ca<O.pointers.length;ca++)U[ca]=
O.pointers[ca].target;ca=null;for(this.ora=this.w2h(U);void 0!==this.ora&&null!==this.ora&&(ca=M.a.Swa(this.ora,this.Qra),void 0===ca||null===ca);this.ora=this.ora.parentNode);if(void 0!==ca&&null!==ca){this.curRecognizer&&this.curRecognizer.state===D.Lug&&(this.curRecognizer=null);U=ca.keys;for(let Q of U){U=ca.ma(Q);void 0!==U&&null!==U&&void 0!==U.yea&&null!==U.yea&&(void 0===this.curRecognizer||null===this.curRecognizer||U.yea===this.curRecognizer||U.yea.canRecognizeWith(this.curRecognizer))&&
U.yea.recognize(O);const Y=U.yea.state;this.curRecognizer||D.Iug!==Y&&D.Jug!==Y&&D.Kug!==Y||(this.curRecognizer=U.yea)}}}emit(O,U){if("hammer.input"!==O){this.b$=!1;U=A.create(O,this.ora,U.srcEvent,U,3,this.ITc);var ca=M.a.Swa(this.ora,this.Qra);if(this.Gxi(O))var Q=0;else if(this.wxi(O))Q=1;else if(this.LAi(O))Q=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:ca}=ca.Mc(z[Q]));void 0!==ca&&null!==ca&&((ca=ca.G2e,ca.Yui())?O.endsWith("start")?
this.b$=ca.CYi(U):O.endsWith("end")?(ca.AYi(U),this.b$=!0):O.endsWith("cancel")?(ca.zYi(U),this.b$=!0):O.endsWith("move")&&(this.b$=ca.BYi(U)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",O))}}get(O){return Object(e.a)(Hammer.Recognizer,O)}w2h(O){if(1>O.length)return null;if(1===O.length)return O[0];var U=O[0],ca=!0;for(let Q=1;Q<O.length;Q++){if(!O[Q])return null;if(U!==O[Q]){ca=!1;break}}if(ca)return U;U=this.Z2e(O[0]);ca=0;for(const Q of O){O=this.Z2e(Q);if(U.ma(U.count-
1)!==O.ma(O.count-1))return null;for(let Y=U.count-2,la=O.count-2;Y>=ca&&0<=la;Y--,la--)if(U.ma(Y)!==O.ma(la)){ca=Y+1;break}}return U.ma(ca)}Z2e(O){const U=new b.a;for(;void 0!==O&&null!==O;O=O.parentNode)U.add(O);return U}X6e(O){switch(O){case m.a.Cf:case m.a.waa:return 1;case m.a.wg:case m.a.zia:return 2;case m.a.Fe:case m.a.BIa:return 4;case m.a.aFc:case m.a.z2c:return 8}return 0}rAa(O,U,ca){O=this.X6e(O);U=this.$0h(ca);Hammer.inputHandler(this,O,U);this.b$&&ca.preventDefault();return this.b$}Cdf(){return 1<
this.yT.count}b5b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Kob)for(let O of this.yT)this.gZf(O.key);else this.yT=new h.a;this.session=null}QNg(O,U,ca){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",O);if(!this.jnb.nb(O)){try{U.setPointerCapture(O)}catch(Q){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Q)}this.jnb.add(O,U)}this.yT.ia(O,ca);this.PWa&&1<this.yT.count&&this.tga&&!this.tga.ssb&&(this.tga.ssb=!0)}gZf(O){c.ULS.sendTraceTag(594055957,
310,50,"RemovePointerFromCaches: pointerId: {0}",O);if(this.jnb.nb(O)){try{this.jnb.ma(O).releasePointerCapture(O)}catch(U){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",U)}this.jnb.remove(O)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",O);this.yT.remove(O);this.PWa&&1>=this.yT.count&&this.tga&&this.tga.ssb&&(this.tga.ssb=!1)}DQa(O,U,ca){var Q=ca.rawEvent.pointerType.toString();const Y=ca.rawEvent.pointerId.toString();if("touch"!==Q)return!1;
O=this.X6e(O);if(1!==O&&!this.yT.nb(Y))return!1;this.P8d&&1===O&&ca.rawEvent.isPrimary&&this.yT.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.b5b());this.Kob?this.QNg(Y,U,ca):this.yT.ia(Y,ca);this.CRc&&2===O&&(!this.TKc||this.TKc&&"function"===typeof ca.rawEvent.getCoalescedEvents)&&(U=ca.rawEvent.getCoalescedEvents())&&this.Cdf()&&(this.umb=Math.max(this.umb,U.length));this.Kke&&(this.b$=!1);Q=this.Z0h(this.yT,ca,Q);Hammer.inputHandler(this,O,Q);if(4===O||8===
O)this.Kob?this.gZf(Y):this.yT.remove(Y),this.yT.count||(this.session=null,this.CRc&&-1!==this.umb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.umb),this.umb=-1));this.b$&&ca.preventDefault();return this.b$}csc(){return!1}$0h(O){const U=new F;var ca=O.rawEvent;const Q=ca.touches;ca=ca.changedTouches;U.pointers=Array.clone(Q);U.pointers=Array.clone(0<Q.length?Q:ca);U.changedPointers=Array.clone(ca);U.srcEvent=O;U.pointerType="touch";return U}Z0h(O,U,ca){const Q=
new F;Q.pointers=P.toArray(O.values);Q.changedPointers=[U];Q.pointerType=ca;Q.srcEvent=U;return Q}Gxi(O){return R.a.startsWith(O,m.a.pinch)}wxi(O){return R.a.startsWith(O,m.a.pan)}LAi(O){return R.a.startsWith(O,m.a.swipe)}}Object(t.a)(E,"GestureInputManager",r.a,[555,556]);var H=a(289),G=a(260);class N{constructor(){this.ib=null;this.Jx=!1}get name(){return"Common.App.GestureInputManager"}ki(O){O.register(E,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").zc().Gc(()=>
new E(H.a.instance,u.AFrameworkApplication.sa.jE));this.ib=O}init(){this.Jx||(this.ib.resolve("Common.App.GestureManager.GestureInputManager"),this.Jx=!0)}dispose(){}static main(){G.a.instance.dj(new N)}}Object(t.a)(N,"GestureInputManagerPackage",null,[4,5]);a.d(C,"a",function(){return I});const I=()=>{Type.registerNamespace("Common.App.GestureManager");N.main()}},1250:function(t,C,a){t=a(0);var c=a(88),b=a(160);class f extends b.a{constructor(A){super(!1,!1,!0);this.oTb=A}start(){const A={["id"]:"AccessibilitySettingsDialog",
["bodyControls"]:{["tooltipPersistenceEnabled"]:this.oTb.fpd}};this.initializeAndShow("",Object(c.a)(this,this.Qvj,"resultHandler"),A)}Qvj(A,F){1===A&&(this.oTb.fpd=F.tooltipPersistenceEnabled)}}Object(t.a)(f,"AccessibilitySettingsDialog",b.a,[]);var e=a(112),d=a(26);class h{constructor(A,F){this.La=A;this.oTb=F}Pg(){this.La.Wb(d.a.aOj,e.a.frame,Object(c.a)(this,this.bOj,"showAccessibilitySettingsDialogHandler"))}bOj(){(new f(this.oTb)).start();return 32}}Object(t.a)(h,"AccessibilitySettingsDialogActor",
null,[342]);var r=a(170),l=a(6);const u=A=>{const F=new r.a;l.AFrameworkApplication.Od.Zm(v(A),1,null,null,!0,2,D=>{200===D.data.httpStatus?F.setResult("true"===D.data.te.toLowerCase()):F.setResult(!1)},()=>{F.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return F.task},v=A=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",A,l.AFrameworkApplication.Di);var x=a(131);class w{constructor(){this.WXa=null}get fpd(){return!!this.WXa}set fpd(A){A!==
this.WXa&&(this.WXa=A,x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A),this.Vof()&&l.AFrameworkApplication.Od.Zm(v("saveHoverableRibbonTooltipIsEnabled"),2,A.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}fGi(){const A=new r.a;if(this.WXa)A.setResult(this.WXa);else if(this.Vof()){const F=u("getHoverableRibbonTooltipIsEnabled");F.continueWith(()=>{this.WXa=F.result;x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(F.result);
A.setResult(F.result)},8)}else A.setResult(!1)}Vof(){const A=l.AFrameworkApplication.fa.ra("IsRoamingServiceEnabled"),F=l.AFrameworkApplication.fa.ra("IsAnonymousUser");return A&&!F}}Object(t.a)(w,"AccessibilitySettingsInfo",null,[341]);var m=a(260),n=a(146);class z{constructor(){this.ib=null}get name(){return"Common.App.AccessibilitySettings"}ki(A){this.ib=A;this.ib.register(w,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Gc(()=>
new w).zc();this.ib.register(h,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Gc(()=>new h(l.AFrameworkApplication.xb,this.ib.yg("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).zc()}init(){const A=this.ib.yg("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),F=this.ib.yg("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");A&&F?(F.Pg(),A.fGi()):n.a(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){m.a.instance.dj(new z)}}Object(t.a)(z,"AccessibilitySettingsPackage",null,[4,5]);a.d(C,"a",function(){return y});const y=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");z.main()}},1251:function(t,C,a){t={};a.r(t);a.d(t,"TableManager",function(){return cb});var c=a(10),b=a(0),f=a(228),e=a(159),d=a(14),h=a(92),r=a(29),l=a(425),u=a(485),
v=a(530),x=a(176),w=a(230),m=a(25),n=a(73),z=a(45),y=a(184),A=a(218),F=a(51),D=a(47),B=a(13),M=a(77),R=a(138),P=a(1),E=a(12),H=a(21),G=a(353),N=a(246),I=a(16),O=a(169),U=a(101),ca=a(7),Q=a(261),Y=a(80),la=a(49),ea=a(36);class ha extends U.a{constructor(Ma,Oa,La,ra){super(Ma);this.mhg=[6];this.ihg=[26];this.Kq=null;this.VCb=this.lmc=!1;this.Cs=this.qca=null;this.onPointerDown=V=>{if(1!==this.$.Ia.LH())return!0;V=ea.a(this.$).xe(V);if(this.xB)return!0;var ma=la.a(this.$).ltd||la.a(this.$).iq();if(this.ivd||
ma)return this.leb(),!0;this.Cs=this.un;this.tNd();this.Fod();ma=2===V.Cb&&V.oo===Sys.UI.MouseButton.leftButton;const W=3===V.Cb;if(ma||W)V=this.ga.qq(V.clientPoint,V.Vb,5,void 0,void 0,!0),V||(V=this.Cs),this.VCb=ma,this.lmc=W,this.Cs=this.Naf(V),this.Fod(),ma?this.Zlj():W&&this.Pmj(),Q.b(this.$,!0);return!0};this.pj=V=>{V=ea.a(this.$).xe(V);if(!this.xB)return!1;let ma=this.VCb?this.ga.qq(V.clientPoint,V.Vb,5,void 0,void 0,!0):this.ga.qq(V.clientPoint,V.Vb,5,!0,!1,!0);ma||(ma=this.ga.Nqb(V.clientPoint,
V.Vb,5));ma&&(V=this.Naf(this.qqb(ma)),this.h4b(V.bottomRight),this.Cs.equals(V)||(this.Cs=V,this.pLb(!1),this.tNd(!1),this.Fod(!1),this.oii(),this.Jb.update(!1)),this.d6j(this.Cs));return!0};this.qh=V=>{ea.a(this.$).xe(V);if(!this.xB)return!1;this.resizeTable();this.leb();return!0};this.HIb=V=>{ea.a(this.$).xe(V);if(!this.xB)return d.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.leb();return!0};this.Xda=
V=>{ea.a(this.$).xe(V);this.leb();return!0};this.KDf=()=>{this.xB&&this.leb()};this.gridView=Oa;this.$=Oa.$;this.tableManager=ra;this.ga=Oa.ga;this.Jb=Oa.Jb;this.parentElement=Ma;this.P2g();r.a.yp||r.a.Tca||N.a.instance.ta(I.a.pointerDown,this.qca,this.onPointerDown);this.un=La;this.uQc=this.ivd=!1;this.tableManager.ZPg(this.KDf)}get xB(){return this.VCb||this.lmc}get Zpf(){return this.uQc}dispose(){this.leb();this.tableManager.Zoj(this.KDf);this.Zpf||r.a.yp||r.a.Tca||N.a.instance.Ba(I.a.pointerDown,
this.qca,this.onPointerDown);if(this.xB){Q.b(this.$,!1);try{this.hw()}catch(Ma){d.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${Ma}`)}}this.parentElement&&this.parentElement.contains(this.qca)&&this.parentElement.removeChild(this.qca);this.qca=this.parentElement=null;super.dispose()}Naf(Ma){const Oa=Ma.bottom-this.un.topLeft.bottom-1;return 0<=Ma.right-this.un.topLeft.right+1&&0<=Oa&&Ma.bottom>=this.un.top&&Ma.right>=this.un.left?new m.Range(this.un.top,
this.un.left,Ma.bottom,Ma.right,!1,!1):this.Cs}Fod(Ma=!0){this.sAc([this.Cs],6,Ma);this.Jb.jr(this.mhg)}pLb(Ma=!0){this.Jb.ik(this.mhg);this.sAc([null],6,Ma)}tNd(Ma=!0){this.Jb.ik(this.ihg);this.sAc([null],26,Ma)}oii(){const Ma=this.iXj();0<Ma.length&&(this.sAc(Ma,26,!1),this.Jb.jr(this.ihg))}iXj(){const Ma=[];this.un.contains(this.Cs)&&(this.un.right!==this.Cs.right&&Ma.push(new m.Range(this.un.top,this.Cs.right+1,this.Cs.bottom,this.un.right,!1,!1)),this.un.bottom!==this.Cs.bottom&&Ma.push(new m.Range(this.Cs.bottom+
1,this.un.left,this.un.bottom,this.un.right,!1,!1)));return Ma}resizeTable(){if(!this.Cs.equals(this.un)){const Ma=new m.Range(this.un.top,this.un.left,this.Cs.bottom,this.Cs.right,!1,!1);this.l1j(Ma);this.ivd=!0}}onKeyDown(Ma){ea.a(this.$).xe(Ma);return!0}eFd(){this.Zpf&&(r.a.yp||r.a.Tca||(N.a.instance.ta(I.a.pointerDown,this.qca,this.onPointerDown),this.qca.classList.remove("ewr-table-resize-default-cursor"),this.uQc=this.qca.disabled=!1),this.uQc=!1)}P2g(){const Ma=document.createElement("div");
Ma.className="ewr-table-resize-handle";const Oa=document.createElement("div");Oa.className="ewr-table-resize-fillhandle-higher";const La=document.createElement("div");La.className="ewr-table-resize-fillhandle-broader";Ma.appendChild(Oa);Ma.appendChild(La);this.qca=Ma;this.parentElement.appendChild(this.qca)}h4b(Ma){let Oa=60;const La=this.Cs.contains(Ma);let ra=Ma.top,V=Ma.bottom,ma=Ma.left,W=Ma.right,aa=null;if(La){if(this.gridView.wN(this.un.topLeft)&&!this.un.yCa)return;Ma.bottom<this.Cs.bottom?
(ra=Math.max(1,V-2,this.un.top),Oa=16):(ma=Math.max(1,W-2,this.un.left),Oa=4);V=ra;W=ma;aa=new m.Range(ra,ma,ra,ma,!1,!1)}else Ma.right>=this.un.right?(W+=2,Oa=8):Ma.bottom>=this.un.bottom&&(V+=2,Oa=32),ra=V,ma=W,aa=new m.Range(V,W,V,W,!1,!1),Oa=16;this.gridView.wN(aa)||(this.Kq?this.Kq.lo||(this.Kq=F.a.instance.create(()=>{this.gridView.Nv(aa,Oa,"TableResizeBehavior.BringRangeIntoView")},40,D.a.khg)):this.Kq=F.a.instance.create(()=>{this.gridView.Nv(aa,Oa,"TableResizeBehavior.BringRangeIntoView")},
40,D.a.khg))}qqb(Ma){let Oa=Ma;if(this.gridView.lb.y5){if(!this.gridView.Ob(Ma.topLeft)){const La=this.gridView.dk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.SQ,this.Cs.top!==Ma.top?1:2);try{La.Xk=this.Cs.top<Ma.top||this.Cs.left<Ma.left,La.Wv(Ma.topLeft),Oa=La.$$cu().range}finally{La&&La.dispose()}}Oa.right=Oa.left+Ma.width-1;Oa.bottom=Oa.top+Ma.height-1}return Oa}sAc(Ma,Oa,La=!0){const ra=[];for(const V of Ma)ra.push(new G.a(V,n.d(this.$.na)));this.Jb.pA(ra,[Oa],!0,void 0,La)}Zlj(){N.a.instance.ta(I.a.vk,
document.documentElement,this.pj);for(const Ma of this.gridView.Un)N.a.instance.ta(I.a.vk,Ma.domElement,this.pj);N.a.instance.ta(I.a.og,document.documentElement,this.qh);this.jPe()}Pmj(){O.a.instance.ta(I.a.wg,document.documentElement,this.pj);for(const Ma of this.gridView.Un)O.a.instance.ta(I.a.wg,Ma.domElement,this.pj);O.a.instance.ta(I.a.Fe,document.documentElement,this.HIb);this.jPe()}hw(){this.VCb&&this.o4j();this.lmc&&this.B4j()}o4j(){N.a.instance.Ba(I.a.vk,document.documentElement,this.pj);
for(const Ma of this.gridView.Un)N.a.instance.Ba(I.a.vk,Ma.domElement,this.pj);N.a.instance.Ba(I.a.og,document.documentElement,this.qh);this.bXf()}B4j(){O.a.instance.Ba(I.a.wg,document.documentElement,this.pj);for(const Ma of this.gridView.Un)O.a.instance.Ba(I.a.wg,Ma.domElement,this.pj);O.a.instance.Ba(I.a.Fe,document.documentElement,this.HIb);this.bXf()}jPe(){this.gridView.cellTextEditBox.fac(!0)}bXf(){this.gridView.cellTextEditBox.fac(!1)}l1j(Ma){this.$.Xc(-1400250766,Y.a.Eb,30,{["ResizeTableRange"]:Ma,
["OriginalTableRange"]:this.un})}d6j(Ma){if(!this.un.contains(Ma)){Ma=this.hXj();for(const Oa of Ma)if(this.tableManager.Hvd(Oa)){this.gridView.Wg.Gp(ca.a.eRi);return}}this.gridView.rtl?this.gridView.Wg.Gp(ca.a.nQi):this.gridView.Wg.Gp(ca.a.ASi)}leb(){if(this.xB){Q.b(this.$,!1);try{this.hw()}catch(Ma){d.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${Ma}`)}}this.Kq&&(this.Kq.cancel(),this.Kq.dispose());this.lmc=this.VCb=!1;this.pLb();
this.tNd();Q.b(this.$,!1);this.gridView.Wg.Gp(ca.a.IV)}hXj(){const Ma=[];this.un.right!==this.Cs.right&&Ma.push(new m.Range(this.un.top,this.un.right+1,this.Cs.bottom,this.Cs.right,!1,!1));this.un.bottom!==this.Cs.bottom&&Ma.push(new m.Range(this.un.bottom+1,this.un.left,this.Cs.bottom,this.un.right,!1,!1));return Ma}static createInstance(Ma,Oa,La,ra){if(!Oa)return null;const V=Ma.Jb;V.pA(La,[27],!0);V.jr(ha.$Wj);La=V.rD(27,Ma.lb.yi(Oa.bottomRight),ha.CYh(Oa,La)).tg;return new ha(La,Ma,Oa,ra)}static CYh(Ma,
Oa){var La;for(let ra=0;ra<Oa.length;ra++)if((null===(La=Oa[ra])||void 0===La?0:La.range)&&Oa[ra].range.equals(Ma))return ra;return 0}}ha.$Wj=[27];Object(b.a)(ha,"TableResizeBehavior",U.a,[]);var X=a(2);U=a(245);class T{}T.YDh="ewa-ttrd-buttonarea";Object(b.a)(T,"CssClassNames",null,[]);var ua=a(52),Ha=a(134),Ca=a(98),Ga=a(23),sa=a(15),bb=a(267),Ba=a(135),qa=a(276),pa=a(157),ya=a(41);class za extends U.a{constructor(Ma){super(document.createElement("div"));this.uYc=this.tsd=this.qPf=this.fR=!1;this.BNb=
null;this.Vf=()=>{A.c(this.$,this.gridView.ga.qa.activeCell)?(this.HNa=!0,this.Utb(!1)):(this.G_=this.HNa=!1,this.mmg())};this.Vt=()=>{this.HNa?this.Utb(!0):this.G_=!1};this.Yza=()=>{this.uYc=!0;this.HNa&&(this.G_=!1)};this.onContentReady=()=>{this.$.isEditMode?A.c(this.$,this.gridView.ga.qa.activeCell)&&(this.HNa=!0,this.Utb(!1)):this.G_=!1};this.k7=()=>{this.uYc=!1;this.HNa?this.Utb(!1):this.G_=!1};this.xf=(Oa,La)=>{this.HNa&&(Oa=this.gridView.Vbb(La.hd.block.pe.BlockCachePosition.PaneType).hC(La.hd.hash))&&
(Oa.MOd(this.Fef),Oa.E_c(this.Fef))};this.Fef=()=>{this.i0f()};this.$=Ma;this.gridView=H.h(this.$);this.parentElement=this.domElement;this.parentElement.className=T.YDh;this.KMa=this.gridView.Kj;this.ufd=P.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.HNa=!0;this.Kmi();this.ufd&&this.Dki();this.hYg();this.Utb(!1);d.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get G_(){return this.tsd}set G_(Ma){this.tsd!==Ma&&(this.tsd=this.isVisible=
Ma)}get TDb(){return!!(this.$.Nd&16)}get hwi(){const Ma=this.gridView.ga.qa.activeCell;return Ma.right===Ma.maxColumns}get fpb(){const Ma=this.gridView.Ob(null);return Ma&&this.gridView.Vca(Ma.range)?this.Twa(Ma):(Ma&&d.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.bqh();this.$=this.gridView=this.parentElement=this.KMa=null;super.dispose()}xWh(Ma){const Oa=this.K$h(this.gridView.Ob(null).range);return Oa?
this.ufd?`=${this.daf()}(${Ma}${this.$.listSeparator}${Oa})`:`=SUBTOTAL(${Ma},${Oa})`:null}daf(){var Ma,Oa,La;return null!==(La=null===(Oa=null===(Ma=this.calcManager)||void 0===Ma?void 0:Ma.localeInfo)||void 0===Oa?void 0:Oa.getWorksheetFuncName(344))&&void 0!==La?La:"SUBTOTAL"}K$h(Ma){var Oa=H.h(this.$).wb.mh(Ma);if(!Oa)return null;Oa=y.a(Oa,!1);Oa.right=Oa.left=Ma.left;return Oa.toString()}Kmi(){za.RJ={};za.RJ["100"]=sa.a.instance.ha(1105);za.RJ["101"]=sa.a.instance.ha(1108);za.RJ["102"]=sa.a.instance.ha(1107);
za.RJ["103"]=sa.a.instance.ha(1112);za.RJ["104"]=sa.a.instance.ha(1109);za.RJ["105"]=sa.a.instance.ha(1110);za.RJ["109"]=sa.a.instance.ha(1106);za.RJ["107"]=sa.a.instance.ha(1113);za.RJ["110"]=sa.a.instance.ha(1115);za.RJ["111"]=sa.a.instance.ha(1166)}Dki(){(P.EwaSettings.LF()?Ma=>pa.a.resolve(ya.g).then(Oa=>setTimeout(()=>Ma(Oa),0)):Ma=>this.$.da.kb(266,Ma))(Ma=>{this.calcManager=Ma})}s9i(){var Ma=this.gridView.Ob(null);if(Ma&&(Ma=Ma.oB?Ma.formulaBarText:null))if(this.ufd){const Oa="="+this.daf()+
"(",La=Oa.length;if(Ma.toUpperCase().startsWith(Oa)){if(Ma=Ma.substring(La,La+3),Ma in za.RJ)return Ma}else return"111"}else if("=SUBTOTAL("===Ma.substring(0,10)){if(Ma=Ma.substring(10,13),Ma in za.RJ)return Ma}else return"111";return"100"}hYg(){this.gridView.Ca.uu(this.xf);this.gridView.ga.FC(this.Vf);this.gridView.vv(this.onContentReady);this.gridView.cellTextEditBox.An(this.Yza);this.gridView.cellTextEditBox.Bm(this.k7)}bqh(){this.gridView&&(this.gridView.ga&&(this.gridView.ga.JI(this.Vf),this.gridView.Ca.Ls(this.xf)),
this.gridView.My(this.onContentReady),this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.sn(this.Yza),this.gridView.cellTextEditBox.km(this.k7)),this.mmg())}Utb(Ma){this.o6j(Ma);this.TDb&&(this.GVj(),this.fpb?(this.qPf||this.sYg(),this.uYc?this.G_=!1:(this.G_=!0,this.i0f())):(d.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.G_=!1))}i0f(){appChrome.renderTableTotalRowOptions(this.parentElement,za.RJ,
za.RJ[this.s9i()].toString(),Math.round(ea.a(this.$).Ph(17)),Ma=>{d.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${Ma}`);let Oa={["SelectedOption"]:za.RJ[Ma],["FunctionKeyCode"]:Ma,["Location"]:"canvas"};Ba.b(this.$).rd(Ha.a.mXj,Oa,null,!0);if("111"===Ma)return this.gqi(),!0;if("100"!==Ma){this.BNb=this.xWh(Ma);if(!this.BNb)return d.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),
!0;this.rTa(this.BNb)}else this.rTa("");B.DOMElementExtensions.setFocus(this.gridView.hc.textBox.domElement);return!0})}gqi(){d.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const Ma=new Ca.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ia.Nb(Ma)}Twa(Ma){if(!Ma)return null;var Oa=this.gridView.cellTextEditBox.textBox.domElement;var La=0<B.DOMElementExtensions.getHeight(Oa)&&0<B.DOMElementExtensions.getWidth(Oa)&&0<=Oa.offsetTop&&
0<=Oa.offsetLeft;if(La)Oa=B.DOMElementExtensions.Twa(Oa,this.gridView.Kj);else{Oa=this.gridView.getCellBounds(Ma.cell);var ra=B.DOMElementExtensions.getBoundingClientRect(this.gridView.Kj);Oa=new Sys.UI.Bounds(Oa.x-ra.x,Oa.y-ra.y,Oa.width,Oa.height)}if(Oa)if(La)2<Oa.height&&2<Oa.height&&(Oa.x+=1,Oa.y+=1,Oa.height-=2,Oa.width-=2);else if(La=H.h(this.$).wK(Ma.cell))La=La.width,ra=Ga.a.equals(bb.a.dyb(Ma.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&ra&&(Oa.x=Oa.x+Oa.width-La),Ma.Yca&&this.gridView.rtl===
ra&&(Oa.width=La);else return null;return Oa}o6j(Ma){var Oa=this.fpb;if(Oa){var La=17>=Oa.height?Oa.y:Oa.y+Oa.height-17-2;Oa=this.hwi?this.gridView.rtl?Oa.x:Oa.x+Oa.width-(17<Oa.height?17:Oa.height):this.gridView.rtl?Oa.x-(17<Oa.height?17:Oa.height):Oa.x+Oa.width;var ra=ea.a(this.$).gla(new Sys.UI.Point(Oa,La));this.parentElement.style.top=E.HelperMethods.Ic(ra.y);this.parentElement.style.left=E.HelperMethods.Ic(ra.x);ea.a(this.$).wGj(this.parentElement);Ma&&(this.G_=this.gridView.wmc(new ua.a(Oa,
La)))}else this.G_=!1}sYg(){this.KMa.insertBefore(this.parentElement,this.KMa.firstChild);this.qPf=!0}GVj(){this.fR||(this.gridView.view.qt(this.Vt),this.fR=!0)}mmg(){this.fR&&this.gridView.view&&(this.gridView.view.hr(this.Vt),this.fR=!1)}rTa(Ma){const Oa=this.gridView.hc,La=this.gridView.Ob(null);La&&(Ma=Object(X.a)(new qa.a,{Text:Ma}),this.gridView.setCell(Ma,La.range,0,127,null),Oa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}za.lXj="TableTotalRowDropDownIconButtonId";za.RJ=null;Object(b.a)(za,
"TableTotalRowOptions",U.a,[2]);let cb=class extends u.a{constructor(Ma){super(H.h(Ma));this.lsb=this.D1=this.$Dc=this.jsb=null;this.iwe=!1;this.bfe=null;this.OUb=0;this.M8b=null;this.x3b=()=>{const Oa={},La=this.Vkd();for(let V in La){const ma=La[V];if(!ma)continue;const W=this.M9h(ma);if(W){if(W in this.sHa){var ra=this.sHa[W];if(ra.xB){ra.un.equals(ma)||(ra.un=ma);delete this.sHa[W];Oa[W]=ra;continue}}(ra=ha.createInstance(H.h(this.$),ma,this.qTh(),this))?Oa[W]=ra:d.ULS.sendTraceTag(537151239,
0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${ma.Rw(!1)}`)}}this.Q5b(null,null);this.sTb=Oa};this.Q5b=()=>{const Oa=this.sHa;for(let V in Oa){var La=V,ra=Oa[V];ra&&(ra.dispose(),delete this.sHa[La])}this.sTb={}};this.lVf=()=>{this.Q5b(null,null);this.x3b(null,null)};this.onFocus=()=>{this.bfe=H.h(this.$).ga.qa.activeCell};this.i7=()=>{this.$.isEditMode&&this.Vf(null,null)};this.Vf=()=>{!this.iwe&&A.c(this.$,this.gridView.ga.qa.activeCell)&&this.qGi()};this.xW=
()=>{this.hBb(1);this.$.ea.rn(this.xW)};this.OJb=()=>{this.iwe=!0;this.$Dc=new za(this.$)};this.$=Ma;this.gridView=H.h(this.$);P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)||this.$.da.Ha(66,this);this.sTb={};this.x3b(null,null);this.$.ua&&this.$.ua.kg(this.lVf);this.n_c(this.x3b);this.$.ea.u3(this.i7);this.gridView.ga.FC(this.Vf);this.$.isEditMode&&this.Vf(null,null)}n_c(Ma){this.addHandler(u.a.bdb,Ma)}AOd(Ma){this.removeHandler(u.a.bdb,Ma)}ZPg(Ma){this.addHandler("tce",
Ma)}Zoj(Ma){this.removeHandler("tce",Ma)}get sHa(){return this.sTb}get $wd(){return this.bfe}get bKa(){return this.OUb}get lj(){const Ma=H.h(this.$);return Ma.wb.mh(Ma.ga.qa.activeCell,!1)}get eKd(){return this.$wd?H.h(this.$).wb.mh(this.$wd,!1):null}Hvd(Ma){return!!this.I8e(Ma)}aq(Ma){return this.e6h(this.q9e(Ma))}Oxb(Ma){return this.q9e(Ma)}Mmj(Ma){Ma?(this.lsb?this.lsb!==Ma&&(h.a.Ja(this.D1),this.D1=null,this.lsb=Ma):this.lsb=Ma,this.D1||(this.D1=R.a.instance.ke(this.lsb)),this.D1.Xi("focusin")||
this.D1.la("focusin",this.onFocus)):d.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}gmf(Ma,Oa){return Ma?Ma.Ala&&Ma.top===Oa.top:(d.ULS.shipAssertTag(537151244,0,!!Ma,"autofilterRange can't be null"),!1)}ela(Ma){Ma=this.jsb?z.J(Ma,this.jsb):this.view.getRangeInformation(Ma);return 0<Ma.length&&Object(l.a)(w.PivotTableRange,Ma[0])?Ma[0]:null}Asi(Ma,Oa){return Ma?!Ma.Tjc&&!!Ma.Av&&Ma.Av.xd(Oa):(d.ULS.shipAssertTag(537151243,0,!!Ma,"Pivot table can't be null"),
!1)}gzi(Ma,Oa){return Ma?!Ma.Tjc&&!!Ma.Ns&&Ma.Ns.xd(Oa):(d.ULS.shipAssertTag(537151242,0,!!Ma,"Pivot table can't be null"),!1)}l1b(Ma){super.l1b(Ma);if((Ma=E.HelperMethods.T8e(Ma))&&0<Ma.length){this.jsb=Array(Ma.length);for(let Oa=0;Oa<Ma.length;Oa++)this.jsb[Oa]=x.a.RQ(Ma[Oa])}}iLb(){super.iLb();this.jsb=null}Seh(Ma,Oa){return this.uJe(Ma,Oa).returnValue}uJe(Ma,Oa){var La=!1;if(!Ma||!Oa)return{returnValue:!1,$Y:La};Ma=Ma.clone();Ma.right+=1;Ma.left=Ma.right;return!Ma.Qz||Ma.top<Oa.lb.Vi&&(La=Ma.clone(),
La.bottom>=Oa.lb.Vi&&(La.bottom=Oa.lb.Vi-1),!({$Y:La}=this.tJe(La,Oa)).returnValue)||Ma.bottom>=Oa.lb.Vi&&(La=Ma.clone(),La.top<=Oa.lb.Vi&&(La.top=Oa.lb.Vi),!({$Y:La}=this.tJe(La,Oa)).returnValue)?{returnValue:!1,$Y:La}:{returnValue:!0,$Y:La}}lhg(Ma){(Ma=this.aq(Ma.topLeft))&&Ma.toString()in this.sHa&&(this.sHa[Ma.toString()].ivd=!1)}pgj(){this.raiseEvent("tce")}ai(Ma,Oa){if(!this.$Dc)return!1;switch(Oa){case -569786022:case 541421805:if(this.$Dc.G_){const La=document.getElementById(za.lXj);La&&F.a.instance.create(()=>
{B.DOMElementExtensions.Qic(La,null)},0,D.a.dXj,!0,!0)}return!0;default:return!1}}dispose(){this.Q5b(null,null);this.AOd(this.x3b);this.$.ua.Gg(this.lVf);this.$.ll(this.Q5b);this.sTb=null;this.$.ea&&this.$.ea.d8(this.i7);this.gridView.ga.JI(this.Vf);this.$Dc=null;this.D1&&(h.a.Ja(this.D1),this.D1=null);super.dispose()}Jfi(Ma,Oa,La,ra){const V=this.gridView.wb.mh(new m.Range(Oa,La,Oa,La,!1,!1));if(this.M8b=V){var ma=V.usedRange,W=Ma.ctrlKey||r.a.isMac&&M.b(Ma),aa=!Ma.shiftKey&&W;Ma=Ma.shiftKey&&!W;
P.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(H.h(this.$).ga.selectionType=3);switch(ra){case 0:this.OUb=0;P.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Oa=this.g9c(Ma,ma.top,La,ma.bottom,La),this.AUd(Oa,aa,Ma)):this.BUd(ma.top,La,ma.bottom,La,y.d(V),y.g(V),aa);break;case 1:this.OUb=1;P.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Oa=this.g9c(Ma,Oa,ma.left,Oa,ma.right),this.AUd(Oa,
aa,Ma)):this.BUd(Oa,ma.left,Oa,ma.right,!1,!1,aa);break;case 2:this.OUb=2;P.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Oa=this.g9c(Ma,ma.top,ma.left,ma.bottom,ma.right),this.AUd(Oa,aa,Ma)):this.BUd(ma.top,ma.left,ma.bottom,ma.right,y.d(V),y.g(V),aa);break;default:d.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${ra.toString()}`);return}P.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&
(H.h(this.$).ga.selectionType=3);d.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else d.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}gLj(Ma){const Oa=this.M8b.usedRange;return this.sof(Ma)||1!==this.bKa&&this.sof(new m.Range(Oa.top,Ma.left,Oa.bottom,Ma.right,!1,!1))?!0:!1}wLd(Ma){return Ma.Autofilters}tJe(Ma,Oa){let La;La=!1;const ra=
Oa.lb.yi(Ma),V=Oa.hg(ra).Ej;if(!V)return d.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${ra}`),{returnValue:!1,$Y:La};if(!V.ze(Ma))return{returnValue:!0,$Y:La};Ma=Oa.dk("TableManager.CouldExpandImpl",Ma,2);try{for(;Ma.$$mn();){if(Ma.$$cu().text||Ma.Dm.eef)return La=!0,{returnValue:!1,$Y:La};if(Ma.$$cu().dI)return{returnValue:!1,$Y:La}}}finally{Ma&&Ma.dispose()}return{returnValue:!0,$Y:La}}e6h(Ma){if(!Ma)return null;const Oa=new v.AutofilterRange(Ma.top,
Ma.left,Ma.bottom,Ma.right,null,null,null,Ma.id,Ma.Ala);Oa.yCa=Ma.yCa;const La=this.gridView.wb.mh(Ma,!0);if(!La)return null;for(let ra=0,V=this.rangeList.length;ra<V;ra++){const ma=this.rangeList[ra],W=this.gridView.wb.mh(ma,!0);W&&W.name===La.name&&ma!==Ma&&this.gyi(ma)&&(Oa.union(ma),ma.yCa&&(Oa.yCa=!0))}return Oa}gyi(Ma){return!!H.h(this.$).wb.mh(Ma)}qTh(){const Ma=[];for(const Oa of this.rangeList){const La=new G.a(this.aq(Oa.topLeft),n.d(this.$.na));Ma.push(La)}return Ma}Vkd(){const Ma={};for(const Oa of this.rangeList){if(!Oa)continue;
const La=this.aq(Oa.topLeft);La&&(Ma[La.toString()]=this.aq(Oa.topLeft))}return Ma}qGi(){this.$.ea.Bf?this.hBb(0):this.$.ea.mk(this.xW)}hBb(Ma){this.$.Fz(Oa=>{Oa.k5(Ma).then(this.OJb)})}M9h(Ma){const Oa=this.gridView.wb.mh(Ma);return Oa?Oa.name:Ma.toString()}BUd(Ma,Oa,La,ra,V,ma,W){const aa=Ma+(V?1:0),ia=La-(ma?1:0),ka=this.gridView.inRangePicker||this.gridView.ni;let Xa=!1;const sb=new m.Range(aa,Oa,ia,ra,!1,!1);if(V||ma){V=ka?G.a.mub(this.gridView.ga.rangePicker.fL):this.gridView.ga.qa.selectedRanges;
for(const ib of V){Xa=this.qtb(ib,aa,Oa,ia,ra);V=this.qtb(ib,Ma,Oa,La,ra);if(ka&&Xa)break;if(!ka&&(Xa||V)){this.gridView.ga.updateSelection(ib,ib.topLeft,0,1);if(W&&V)return;break}}}Xa&&(sb.top=Ma,sb.bottom=La);Ma=sb.topLeft;W?this.gridView.ga.updateSelection(sb,Ma,0,1):ka?this.gridView.ga.bE([sb],0,Ma,0):this.gridView.ga.updateSelection(sb,Ma,0,3)}AUd(Ma,Oa,La){Ma&&(La=La?H.h(this.$).ga.qa.activeCell:Ma.topLeft,Oa?this.gridView.ga.updateSelection(Ma,La,0,1):this.gridView.ga.bE([Ma],0,La,0))}g9c(Ma,
Oa,La,ra,V){const ma=y.d(this.M8b),W=y.g(this.M8b),aa=Oa+(1!==this.bKa&&ma?1:0),ia=ra-(1!==this.bKa&&W?1:0),ka=this.gridView.inRangePicker||this.gridView.ni;if(Ma){var Xa=P.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&ka&&!G.a.mub(this.gridView.ga.rangePicker.fL).length?new m.Range(aa,La,ia,V,!1,!1):ka?this.gridView.ga.rangePicker.activeCell:this.gridView.ga.qa.activeCell;Xa=new m.Range(Xa.top<aa?Xa.top:aa,Xa.left<La?Xa.left:La,Xa.bottom>ia?Xa.bottom:ia,Xa.right>V?
Xa.right:V,!1,!1)}else Xa=new m.Range(aa,La,ia,V,!1,!1);if(1!==this.bKa&&(ma||W)&&(!Ma||Ma&&this.qtb(Xa,aa,La,ia,V))){Ma=ka?G.a.mub(this.gridView.ga.rangePicker.fL):this.gridView.ga.qa.selectedRanges;for(const sb of Ma)if(this.qtb(sb,aa,La,ia,V)){Xa.top=Oa;Xa.bottom=ra;break}}return Xa}sof(Ma){const Oa=this.gridView.inRangePicker||this.gridView.ni?G.a.mub(this.gridView.ga.rangePicker.fL):this.gridView.ga.qa.selectedRanges;for(const La of Oa)if(this.qtb(La,Ma.top,Ma.left,Ma.bottom,Ma.right))return!0;
return!1}qtb(Ma,Oa,La,ra,V){return!!Ma&&Ma.top===Oa&&Ma.bottom===ra&&Ma.left===La&&Ma.right===V}};cb=Object(e.b)([Object(pa.d)(ya.db),Object(e.c)(0,Object(ya.u)())],cb);Object(b.a)(cb,"TableManager",u.a,[424,2]);class Pa extends f.a{constructor(Ma){super();this.tableManager=null;this.$=Ma;this.Mb()}create(){this.vb(this.tableManager||(this.tableManager=new cb(this.$)))}}Object(b.a)(Pa,"TableManagerFactory",f.a,[]);a.d(C,"a",function(){return nb});const nb=()=>{c.a.Fa(Ma=>{P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",
!1)||Ma.da.Ha(134,new Pa(Ma))})};String(t);window.___1680633024398_closurehack=t},1262:function(t,C,a){var c=a(10);t=a(0);var b=a(228),f=a(14),e=a(89),d=a(123),h=a(32),r=a(38);class l extends d.a{constructor(E,H){super(E,H)}execute(E){const H=Object(e.a)(7,E.Oe);f.ULS.shipAssertTag(537153921,0,h.a.Rqb(E.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");H.FI(!0,!0);E.activityState[r.a.P0b]=H.ea.sessionId;E.activityState[r.a.mpb]=!0;E.activityState[r.a.V0b]=
!0;f.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(t.a)(l,"SessionReloadActivity",d.a,[]);var u=a(8);class v extends b.a{constructor(){super();this.Mb()}create(){this.vb(new l(u.a.$eb,u.a.vz))}static la(E){E.da.Ha(142,new v)}}Object(t.a)(v,"SessionReloadActivityFactory",b.a,[]);var x=a(59),w=a(279),m=a(125),n=a(51),z=a(47),y=a(37),A=a(1),F=a(46),D=a(257),B=a(124);class M extends d.a{constructor(E,H,G,N,I){super(E,H);
M.xAd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];M.wAd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];M.zxf=[-1468309555,611268539,-1750576502,61029505];M.yxf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.pCc=G;this.gRj=N;this.L_j=I}execute(E){var H=Object(e.a)(7,E.Oe);E.activityState[r.a.ota]=!0;var G=M.J8h(E);if(M.VKj(E,G))return M.oMi(E),G=50,0<E.errors.length&&(G=15),f.ULS.sendTraceTag(537153891,
0,G,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.xc(E.errors)}`),E.activityState[r.a.ota]=!1,this.yh(u.a.idle),3;switch(G){case 1:case 3:this.foi(E,G);break;case 2:this.eoi(E);break;case 0:E.activityState[r.a.o_a]=null}f.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${G}. activityName:${this.activityName}. NextActivityName:${this.o0}. TimeFromLastStatefulResponse:${H.ea.LX}.`);var N=y.a.xg(E.activityState,
B.a.vhb);f.ULS.shipAssertTag(40502925,0,!N||N&&(1===G||3===G),`triggerSilentReloadAfterTokenRefresh: ${N}, silentReloadType: ${G}`);H=H.kl.reloadCount;return 0!==G&&0<H?(N=w.a.xMa(H,200),f.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${G}] retryNum [${H}] delayInMs [${N}] activityName [${this.activityName}]`),n.a.instance.create(()=>{M.FM(E)},N,z.a.KCj),1):3}foi(E,H){f.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");
const G=Object(e.a)(7,E.Oe);E.activityState[r.a.mpb]=!0;G.fjc||F.PageLoadTrackingInfo.instance.Yj("ReopenOnLoad");!M.isEditMode(E)&&h.a.Rqb(E.errors)&&(f.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),E.activityState[r.a.P0b]=G.ea.sessionId,E.activityState[r.a.V0b]=!0);E.OAd();3===H?(G.ea.Sf()||G.ea.ORi(),G.FI(!0,!0),this.yh(this.L_j),E.activityState[r.a.Dqe]=G.workbookContext.CalcMode):(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===H&&G.FI(!0,!0),E.activityState[r.a.LYc]=!1,this.yh(this.pCc))}eoi(E){f.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");E.activityState[r.a.o_a]=null;E.OAd();this.yh(this.gRj);E=Object(e.a)(7,E.Oe);E.fjc||(F.PageLoadTrackingInfo.instance.Yj("RefreshOnLoad"),E.eMb())}static FM(E){E.FM()}static J8h(E){const H=Object(e.a)(7,E.Oe),G=H.ea,N=M.isEditMode(E);var I=h.a.fh(E.errors,N?M.wAd:M.xAd);const O=h.a.fh(E.errors,N?M.yxf:M.zxf),U=H.qR,
ca=H.kl.reloadCount,Q=H.xa.MaxConsecutiveSilentReloadAllowed,Y=H.kl.gef(),la=h.a.xc(E.errors),ea=h.a.xc(E.SAa),ha=0<h.a.TM(Ha=>!Ha.triggerSilentReopenOnly,E.errors).length;let X=I;const T=y.a.xg(E.activityState,B.a.vhb);T&&(X=!0);const ua={name:"SessionReloadSilentActivity.GetSilentReloadType"};ua.editMode=N;ua.isSilentReopenError=I;ua.isSilentRefreshError=O;ua.reloadSequenceCount=H.kl.gSa;ua.reloadCount=ca;ua.maxReloads=Q;ua.stopSilentReloads=Y;ua.errorNames=la;ua.processedErrorNames=ea;ua.isClientDirty=
U;ua.errorsForSilentReopenOnly=ha;ua.triggerSilentReloadAfterTokenRefresh=T;ua.IsReopenDisabled=H.BOa;I=x.a.Fc(ua);f.ULS.sendTraceTag(21837004,0,50,I);if(!Y){if(X&&(N?M.LKj(E):M.OKj(E)))return D.a.Eag(E,H)?3:H.BOa?2:1;if(O&&(N||!G.pdb))return 2}return 0}static VKj(E,H){for(const G of E.errors)if(-1337545025===G.MessageId||-238814601===G.MessageId)return!1;return h.a.TM(G=>!G.triggerSilentReopenOnly,E.errors).length?3!==H:!1}static oMi(E){const H=h.a.TM(G=>!G.triggerSilentReopenOnly,E.errors);for(const G of H)E.yda(G)}static isEditMode(E){const H=
Object(e.a)(7,E.Oe);return H.ea.jc?H.St&&!!(H.Nd&64):y.a.xg(E.activityState,r.a.cs)}static OKj(E){const H=Object(e.a)(7,E.Oe),G=h.a.Y4(E.errors,M.xAd);if(m.b(G,N=>N.ForceVersionUpgrade))return!1;E=h.a.Rqb(E.errors);return!H.ea.pdb||E?!0:!1}static LKj(E){E=h.a.Y4(E.errors,M.wAd);return!m.b(E,H=>H.ForceVersionUpgrade)}}M.xAd=null;M.wAd=null;M.zxf=null;M.yxf=null;Object(t.a)(M,"SessionReloadSilentActivity",d.a,[]);class R extends b.a{constructor(E,H){super();this.activityName=E;this.lK=H;this.Mb()}create(){this.vb(new M(this.activityName,
this.lK,u.a.vz,u.a.aj,u.a.lRb))}static la(E){E.da.Ha(143,new R(u.a.$oa,u.a.F3b));E.da.Ha(144,new R(u.a.Uzc,u.a.VQa));E.da.Ha(145,new R(u.a.Vzc,u.a.jHd));E.da.Ha(154,new R(u.a.afb,u.a.jP))}}Object(t.a)(R,"SessionReloadSilentActivityFactory",b.a,[]);a.d(C,"a",function(){return P});const P=()=>{c.a.Fa(E=>{v.la(E);R.la(E)})}},1278:function(t,C,a){t=a(0);var c=a(228),b=a(14),f=a(175),e=a(259),d=a(382),h=a(6),r=a(664),l=a(93),u=a(101),v=a(272),x=a(174),w=a(82),m=a(429),n=a(53),z=a(39),y=a(98),A=a(77),F=
a(1),D=a(586),B=a(21),M=a(33);class R extends u.a{constructor(U,ca){super(U);this.wT=[];this.Xee=null;this.DMb=Q=>{let Y="forward";Q.Values[d.a.direction]?Y=Q.Values[d.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Q=0;let la=!0;"backward"===Y?(Q=this.Vwd.length-1,la=!1):"forward"===Y?(Q=0,la=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${Y}`);this.Hzf(la,Q,!1)};this.iIf=()=>{this.wT=[]};this.AQa=Q=>{-411645385===
this.$.shortcutKeyManager.Kt(Q,!0)&&this.Qmf()&&(this.$.Ia.Nb(new y.a(-411645385,1,this.$.Bc,6,null),{["event"]:Q},Q),Q.stopPropagation())};this.A0i=Q=>{this.Jna(Q)};this.pb=ca;this.it=B.h(this.pb);this.Pc.la("keydown",this.A0i);this.Pc.la("keyup",this.AQa);v.a(ca).PSg(this.iIf);w.a(ca.xa,27)&&z.TaskExtensions.za(n.GetServiceTaskFactory.Sa(ca.da,21,137,1),Q=>{Q=Q.result;Q.Am(f.a.Off);Q.Lk(f.a.Off,this.DMb)},ca.ka)}get $(){return this.pb}get Vwd(){this.wT.length||(this.wT=this.f7e());return this.wT}get Jma(){return this.Xee}set Jma(U){this.Xee=
U;this.wT=this.f7e()}dispose(){this.$&&v.a(this.$).orj(this.iIf);this.pb=null;this.wT.length=0;super.dispose()}iej(U){this.Jna(U)}Hzf(U,ca,Q=!0,Y=null){var la=this.yWj(U,ca,Q,Y);if(!la){Q=ca;var ea=U?1:-1,ha=this.Vwd;do{la=!1;if(w.a(this.$.xa,27)){if(Q+=ea,Q>=ha.length||0>Q)la=!0}else Q=(Q+ea+ha.length)%ha.length;if(la){this.AKi(U,ca,Y);break}else if(la=this.Ygg(U,ca,Q,!1,Y))break}while(Q!==ca)}}yWj(U,ca,Q=!0,Y=null){let la=null;0<=ca&&(la=this.wT[ca]);return(null===la||void 0===la?0:la.Qf)&&la.pg(U,
Q)?(Y&&A.g(Y),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${la.je} into a sub region`),la.Bj(),!0):!1}Ygg(U,ca,Q,Y,la=null){Q=this.wT[Q];if(F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const ea=v.a(this.pb).Sw(e.a.bwa),ha=v.a(this.pb).Sw(e.a.Azb),X=this.it.ga.Ra.YV;if(Q===ha&&X||Q===ea&&!Y&&!X)return!1}if((null===Q||void 0===Q?0:Q.Qf)&&Q.pg(U,!1)){la&&A.g(la);Q.Bj();if(U=this.wT[ca])U.hk(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${U.je} to ${Q.je}`);
return!0}return!1}AKi(U,ca,Q=null){Q&&A.g(Q);if(ca=this.wT[ca])ca.hk(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${ca.je}`);z.TaskExtensions.za(n.GetServiceTaskFactory.Sa(this.$.da,21,137,0),Y=>{Y.result.hi(f.a.Uob,{[d.a.direction]:U?"forward":"backward"})},this.$.ka)}Jna(U){var ca=this.$.isEditMode?x.a(this.$):null;if(!this.$.ub.tya||R.Ivi(ca))if(117===U.keyCode&&(U.ctrlKey||A.b(U))){ca=this.d$e(U.target);var Q=!U.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${ca}`);
if(F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var Y=v.a(this.pb).Sw(e.a.JMb);Y=this.wT.indexOf(Y);h.AFrameworkApplication.sa.Pa.Zw&&this.$.P_&&-1!==Y&&ca===Y&&r.ShyRibbon.VJ(this.$.hgb,0)}else h.AFrameworkApplication.sa.Pa.Zw&&this.$.P_&&1===ca&&r.ShyRibbon.VJ(this.$.hgb,0);this.Hzf(Q,ca,!0,U)}else 117!==U.keyCode||R.oZe?-411645385===this.$.shortcutKeyManager.Kt(U)?this.Qmf()&&(this.$.Ia.Nb(new y.a(-411645385,1,this.$.Bc,6,null),{["event"]:U},U),U.stopPropagation()):
1588554917===this.$.shortcutKeyManager.Kt(U)?0===this.mode?(D.a(this.$)||this.$.Ia.Nb(new y.a(1588554917,1,this.$.Bc,6,null),{["event"]:U},U),U.preventDefault(),U.stopPropagation()):3===this.mode&&(U.preventDefault(),U.stopPropagation()):F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.Kt(U)?(ca=this.d$e(U.target),Y=v.a(this.pb).Sw(e.a.JMb),Q=v.a(this.pb).Sw(e.a.bwa),Y=this.wT.indexOf(Y),Q=this.wT.indexOf(Q),h.AFrameworkApplication.sa.Pa.Zw&&
this.$.P_&&-1!==Y&&ca===Y&&1===this.$.hgb&&r.ShyRibbon.VJ(1,0),-1!==Q&&ca!==Q&&this.Ygg(!0,ca,Q,!0,U)):this.Cdi(U):(U=m.a.LJ.notificationBar.dba(l.a.xZh(),!1),M.a.mDb()?U.image=3:U.image=0,m.a.LJ.notificationBar.JE(U),R.oZe=!0)}d$e(U){const ca=this.Vwd;for(let Q=0,Y=ca.length;Q<Y;++Q){const la=ca[Q];if(la&&la.Gh(U))return Q}return-1}f7e(){const U=[];for(let ca=0,Q=this.Jma.length;ca<Q;ca++){const Y=v.a(this.$).Sw(this.Jma[ca]);Y&&U.push(Y)}return U}Qmf(){return 0===this.mode||4===this.mode}static Ivi(U){return U?
U.inKeytipMode:!1}}R.oZe=!1;Object(t.a)(R,"AccessibilityManager",u.a,[479,2]);var P=a(163),E=a(23),H=a(15);class G extends R{constructor(U){super(document.documentElement,U);this.tC=0;this.GZg=[e.a.iJe,e.a.rDd,e.a.ehc,e.a.o0d,e.a.JMb,e.a.S2c,e.a.jgd,e.a.Obf,e.a.e2c,e.a.eEc,e.a.HRj,e.a.Azb,e.a.X3c,e.a.bwa,e.a.AVd,e.a.c4c,e.a.ufg,e.a.Ftf,e.a.x2c];this.abk=[e.a.ehc,e.a.oqg,e.a.nqg,e.a.pqg];this.Ldj=[e.a.ehc,e.a.ASf,e.a.BSf,e.a.ESf];this.L6g=[e.a.r1e,e.a.Nbf,e.a.hgd,e.a.ggd,e.a.cNe];this.odj=[e.a.iJe,
e.a.rDd,e.a.S2c,e.a.jgd,e.a.e2c,e.a.eEc,e.a.Azb,e.a.X3c,e.a.bwa,e.a.AVd,e.a.XRf,e.a.c4c,e.a.x2c];this.Adj=[e.a.Azb,e.a.w1e];const ca=H.a.instance.Va(253);this.$Ej=this.$.shortcutKeyManager.zyb(ca);this.mode=0;U.da.Ha(15,this);z.TaskExtensions.za(n.GetServiceTaskFactory.Sa(U.da,21,137,1),Q=>{Q=Q.result;Q.Am(f.a.Uob);Q.Lk(f.a.Uob,this.DMb)},U.ka)}get mode(){return this.tC}set mode(U){this.tC=U;switch(U){case 0:this.Jma=this.GZg;break;case 2:this.Jma=this.abk;break;case 3:this.Jma=this.Ldj;break;case 4:this.Jma=
this.L6g;break;case 5:this.Jma=this.odj;break;case 6:this.Jma=this.Adj;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Jna(U){this.$.Nd&65536&&super.Jna(U)}Cdi(U){if(E.a.equals(this.$Ej,this.$.shortcutKeyManager.yjd(U),!1)){const ca=P.b(this.$);if(null===ca||void 0===ca?0:ca.Qf)A.g(U),ca.pg(!0,!1)}}}Object(t.a)(G,"EwaAccessibilityManager",R,[]);class N extends c.a{constructor(U){super();this.$=U;this.Mb()}create(){this.vb(this.$.da.Aa(15)||new G(this.$))}static la(U){U.da.Ha(157,
new N(U))}}Object(t.a)(N,"AccessibilityManagerFactory",c.a,[]);var I=a(10);a.d(C,"a",function(){return O});const O=()=>{I.a.Fa(N.la)}},1303:function(t,C,a){t=a(0);var c=a(114),b=a(228),f=a(14),e=a(16),d=a(40),h=a(98),r=a(1),l=a(21),u=a(7);class v extends d.a{constructor(z,y,A){super();this.statusBarManager=null;this.lPe=()=>{this.T9b()};this.srh=()=>{this.T9b()};this.kPe=F=>{10===F&&this.T9b()};this.onKeyDown=F=>13===F.Da.keyCode?(F=new h.a(237279923,1,2,6,null),this.$.Ia.Nb(F,{[u.a.skipClipboardAccess]:!0,
[u.a.mTe]:!0}),!0):!1;this.$=z;this.Mo=y;this.Tm=A;this.jcd=!1;(this.Kbg=r.EwaSettings.isChangeGateEnabled("OfficeVSO:7568646_PressEnterToPaste"))&&this.$.da.kb(29,F=>{this.statusBarManager=F;F.OJ(this)})}dispose(){this.Oi();this.Tm=this.Mo=this.$=null;this.statusBarManager&&(this.statusBarManager.fG(this),this.statusBarManager=null)}Qn(){return this.Kbg}ns(z,y){if("QueryPasteShortcutEnabledLabel"!==z&&!v.NUj.includes(z))return!1;const A=this.ko();"QueryPasteShortcutEnabledLabel"===z?(y.Visible=A,
f.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${A} for commandId ${z}`)):(y.Visible=!A,f.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!A} for commandId ${z}`));return!0}mwh(){this.Mi();this.raiseEvent("pasteShortcutStatusChanged")}T9b(){this.Oi();this.raiseEvent("pasteShortcutStatusChanged")}ko(){return this.jcd}Iq(z){this.addHandler("pasteShortcutStatusChanged",z)}gr(z){this.removeHandler("pasteShortcutStatusChanged",
z)}Mi(){if(!this.ko()){this.jcd=!0;l.h(this.$).Ih.An(this.lPe);this.Tm.la("blur",this.srh);const z=this.$.da.Aa(65);z&&z.qZ&&z.qZ.registerForCommentEvents(this.kPe);this.Mo.Js(e.a.fc,this.$.Cv,this.onKeyDown,!0)}}Oi(){if(this.ko()){this.jcd=!1;l.h(this.$).Ih.sn(this.lPe);this.Tm.detach("blur");const z=this.$.da.Aa(65);z&&z.qZ&&z.qZ.unregisterForCommentEvents(this.kPe);this.Mo.Us(e.a.fc,this.$.Cv,this.onKeyDown,!0)}}}v.NUj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(t.a)(v,"PasteShortcutManager",
d.a,[643,229,230,2]);var x=a(138);class w extends b.a{constructor(z){super();this.$=z;this.Mb()}create(){const z=this.$;this.vb(z.da.Aa(478)||this.$.da.Ha(478,new v(z,c.KeyInputManager.instance,x.a.instance.uH())))}static la(z){z.da.Ha(479,new w(z))}}Object(t.a)(w,"PasteShortcutManagerFactory",b.a,[]);var m=a(10);a.d(C,"a",function(){return n});const n=()=>{m.a.Fa(z=>{w.la(z)})}},1304:function(t,C,a){var c=a(10);t=a(0);var b=a(718),f=a(14),e=a(108),d=a(6),h=a(1398),r=a(1),l=a(197),u=a(60);class v{constructor(D,
B,M){this.Oub=null;this.$=D;B?(f.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.Oub=new h.a(D,B,M)):f.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Oc(){return!1}executeCommand(D,B,M){D=!1;switch(B.command){case 73979048:this.Oub&&this.Oub.Scj(B,e.a.instance,d.AFrameworkApplication.fa,M),D=!0}return D?u.Task.Ua(!0):l.a(B.command)}Ac(D,
B){return 73979048===B.command&&r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Vc(){return!1}dispose(){this.Oub&&this.Oub.dispose()}}Object(t.a)(v,"DataFromPictureCommandHandler",null,[233,2]);var x=a(39),w=a(53),m=a(109),n=a(157),z=a(41),y=a(70);class A extends b.a{constructor(D){super(D)}Fd(){const D=w.GetServiceTaskFactory.Sa(this.$.da,328,327,1),B=Object(y.b)("OfficeVSO:7625189_MoveUploaderCreatorToNewServiceInfra")?Object(m.d)(n.a.resolve(z.gb,{rb:this.Na})):
w.GetServiceTaskFactory.Sa(this.$.da,484,485,1);x.TaskExtensions.za(x.TaskExtensions.Pd([D,B],this.$.ka),()=>{this.qd([new v(this.$,D.result,B.result)])},this.$.ka,3)}static la(D){b.a.Yd(452,new A(D))}}Object(t.a)(A,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return F});const F=()=>{c.a.Fa(D=>{A.la(D)})}},1305:function(t,C,a){t={};a.r(t);a.d(t,"SparklineManager",function(){return v});var c=a(10),b=a(70),f=a(0),e=a(228),d=a(159),h=a(485),r=a(21),l=a(157),u=a(41);let v=class extends h.a{constructor(m){super(Object(r.h)(m));
Object(b.b)("OfficeVSO:7624512_MigrateSparklineManagerService")||m.da.Ha(240,this)}T8h(m){for(const n of this.rangeList)if(m.range.contains(n))return n;return null}wLd(m){return m.GridBlockModel&&(m=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(m.GridBlockModel))?m.getSparklineRanges():null}};v=Object(d.b)([Object(l.d)(u.cb),Object(d.c)(0,Object(u.u)())],v);Object(f.a)(v,"SparklineManager",h.a,[425]);class x extends e.a{constructor(m){super();this.sparklineManager=null;this.$=m;this.Mb()}create(){this.vb(this.sparklineManager||
(this.sparklineManager=new v(this.$)))}static la(m){m.da.Ha(239,new x(m))}}Object(f.a)(x,"SparklineManagerFactory",e.a,[]);a.d(C,"a",function(){return w});const w=()=>{c.a.Fa(m=>{Object(b.b)("OfficeVSO:7624512_MigrateSparklineManagerService")||x.la(m)})};String(t);window.___1680633023911_closurehack=t},1306:function(t,C,a){t=a(0);var c=a(561),b=a(88),f=a(14),e=a(170),d=a(6),h=a(42),r=a(83),l=a(791);class u{constructor(m,n){this.IVc=this.HVc=null;this.CZa=new e.a;this.zh=m;this.iHa=n.appSettings[u.$bk]||
""}get xKj(){return this.CZa.task}get b4(){return this.zh.value}auj(){const m={};m[u.$fi]=d.AFrameworkApplication.Di;m["Content-Type"]="application/json; charset=utf-8";f.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const n=r.a.ql(this.iHa+u.yKj,u.NSi,d.AFrameworkApplication.sa.Pa.$i.toString());this.b4.Zm(n,1,"",m,!0,2,Object(b.a)(this,this.CIb,"onSuccessCallback"),Object(b.a)(this,this.PHb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,
"20")}PIi(m){try{const n={};n.FlightName=m.FlightName;n.SessionID=m.SessionID;f.ULS.sendTraceTag(594883776,215,50,h.c(n))}catch(n){f.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}CIb(m){if((m=m.data.te)&&m.length)try{const n=h.a(m);this.HVc=n.NavBarDataJson;f.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.HVc?({Ft:this.IVc}=h.d(n.NavBarDataJson)).returnValue?(this.PIi(this.IVc),this.CZa.setResult(this.IVc)):(f.ULS.sendTraceTag(7660113,
215,10,"Failed to deserialize : {0}",{["ShellData"]:l.a.Ahb(this.HVc)}),this.CZa.Ps()):(f.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.CZa.Ps())}catch(n){f.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.CZa.Ps()}else f.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}PHb(){this.CZa.Ps();f.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return u.Ma||(u.Ma=u.Kka())}static Kka(){return new u(new c.a(()=>
d.AFrameworkApplication.Od),d.AFrameworkApplication.fa,d.AFrameworkApplication.sa.Pa.$i)}}u.$fi="X-qs";u.NSi="at";u.yKj="O365ShellServiceProxy.ashx";u.Ma=null;u.$bk="ShellWebServiceBase";Object(t.a)(u,"O365ShellActor",null,[344]);var v=a(260);class x{constructor(){this.ib=null}get name(){return"Common.App.O365Shell"}ki(m){this.ib=m;this.ib.register(u,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").zc().Gc(()=>new u(new c.a(()=>d.AFrameworkApplication.Od),d.AFrameworkApplication.fa,
d.AFrameworkApplication.sa.Pa.$i))}init(){d.AFrameworkApplication.fa.Nu(Object(b.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){d.AFrameworkApplication.useO365ShellService&&d.AFrameworkApplication.sa.Pa.Ou&&this.ib.resolve("Common.App.O365Shell.O365ShellActor").auj()}dispose(){}static main(){v.a.instance.dj(new x)}}Object(t.a)(x,"PackageManager",null,[4,5]);a.d(C,"a",function(){return w});const w=()=>{Type.registerNamespace("Common.App.O365Shell");x.main()}},1398:function(t,C,a){(function(c){a.d(C,
"a",function(){return D});var b=a(0),f=a(14),e=a(181),d=a(89),h=a(1404),r=a(40),l=a(261),u=a(45),v=a(380),x=a(199),w=a(65),m=a(98),n=a(15),z=a(21),y=a(42),A=a(1405),F=a(1);class D extends r.a{constructor(B,M,R){super();this.Lji=h.a.getTypeName();this.NAb=this.CU=this.Ld=null;this.imageHeight=this.imageWidth=0;this.sNa=this.errorMessage=this.tableData=null;this.hpd=0;this.dYc=!1;this.UMe=P=>{if(P){var E={};if(({Ft:E}=y.d(this.aoh(P.data))).returnValue&&(P=Object(d.a)(Object,E),"."===P.DataFromPictureWildcard))if(P.SessionId!==
this.sNa)f.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(f.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),P.CmdType){case "ACK":this.dYc=!0;this.Ahg.stop();f.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");
this.wBj();0<this.errorMessage.length?this.y6f():0<this.tableData.length&&this.Q6f();break;case "insert_html":const G=this.$.pa.va;E={};var H=z.h(this.$).ga.qa.gd.clone();E.PasteId=e.a.create().toString();E.DestinationRanges=u.s(u.v(H,this.$));H=P.Parameters.split("|",3);F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",!1)||f.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${H[0]}|${H[1]}|${H[2]}.`);
H=P.Parameters.indexOf("|");H=P.Parameters.indexOf("|",H+1);H=P.Parameters.indexOf("|",H+1);E.SourceHtml=P.Parameters.substring(H+1);E.CopyOperationId=null;const N=G.Oa(1,G.ic());N.pasteHtmlParameters=E;v.a(this.$.userOperationManager,(I,O,U)=>w.g(G,"pasteHtmlContent",N,I,O,U,null,64),I=>new x.a(204,0,I,1),null);this.hpd++;f.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.hpd.toString()}`)}}};this.Kji=
(P,E)=>{if(P=E.jH)if(!E.parentPath||1>=E.parentPath.length||E.parentPath[1]!==this.sNa)f.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{f.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");E=P.errorCode;switch(E){case null:case -1:this.errorMessage=n.a.instance.ha(2273);break;case 1:this.errorMessage=n.a.instance.ha(2274);
break;case 2:this.errorMessage=n.a.instance.ha(2275)}0<this.errorMessage.length&&f.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${E?E.toString():"null"}.`);this.Zve.stop();this.tableData=P.html;this.dYc&&(0<this.errorMessage.length?this.y6f():0<this.tableData.length&&this.Q6f())}else f.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=B;this.augmentationLoopManager=
M;this.uploaderCreator=R;this.initialize()}dispose(){window.removeEventListener("message",this.UMe,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}t5i(B,M){f.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let R=new Image;R.onload=()=>{var P=document.createElement("canvas");P.width=R.width;P.height=R.height;const E=P.getContext("2d");try{E.drawImage(R,0,0,R.width,R.height)}catch(N){f.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${N.message}`);
return}let H;try{H=P.toDataURL("image/jpeg")}catch(N){f.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${N.message}`);return}P=H.split(",");if(2>P.length)f.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{P=P[1];try{var G=window.self.atob(P)}catch(N){f.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${N.message}`);
return}28E5<G.length?(f.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),M.YOj()):(this.Bxj(this.Ld,this.CU,P,R.width,R.height),URL.revokeObjectURL(R.src),R=null,f.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};R.src=B}Scj(B,M,R,P){this.Ld=B;this.CU=P;this.uploaderCreator.xmi(this.$,M,R,P,this)}Bxj(B,M,R,P,E){this.sNa=e.a.create().toString();this.hpd=0;this.NAb=R;this.imageWidth=P;this.imageHeight=
E;this.errorMessage=this.tableData="";this.dYc=!1;this.Ahg=this.$.Rb.Dg("LoadResource","DataFromPictureTaskpaneLaunch");this.Ahg.start();this.X7i(B,M);this.Zve=this.$.Rb.Dg("LoadResource","DataFromPictureAnnotation");this.Zve.start();this.v9j()}v9j(){if(this.NAb.length){var B=window.self.atob(this.NAb);var M=new Uint8Array(B.length);for(let R=0;R<B.length;R++)M[R]=B.charCodeAt(R);this.augmentationLoopManager.u9j(M,this.sNa,this.imageWidth,this.imageHeight)}else f.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}X7i(B,
M){M.SessionID=this.sNa;M.DataFromPictureAssetId="FA000000050";M.LoadDataFromPictureTaskpane=!0;B=new m.a(-859308420,B.method,B.mode,B.af,B.tabName);this.$.Ia.Nb(B,M)}Gbd(B){try{const M=c.from(B,"utf16le").toString("base64");return A.a.DJa(this.sNa,M)}catch(M){return f.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}aoh(B){try{const M=A.a.DJa(this.sNa,B);return c.from(M,"base64").toString("utf16le")}catch(M){return f.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}wBj(){if(this.NAb.length){var B=l.a(this.$).Sba("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.imageData=this.Gbd(this.NAb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(B,"onCustomMessage",M,R=>{R&&f.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else f.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}Q6f(){if(this.tableData.length){var B=
l.a(this.$).Sba("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.tableHtml=this.Gbd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(B,"onCustomMessage",M,R=>{R&&f.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else f.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}y6f(){if(this.errorMessage.length){var B=
l.a(this.$).Sba("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.errorMessage=this.Gbd(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(B,"onCustomMessage",M,R=>{R&&f.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else f.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.UMe,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.l5().B8("DataFromPicture").A8(()=>{}).activateAnnotation({annotationType:this.Lji,Ay:!1,TR:this.Kji}).build())}}Object(b.a)(D,"DataFromPictureManager",r.a,[579])}).call(this,a(1399).rsg)},1399:function(t,C,a){(function(c){function b(){try{var E=new Uint8Array(1);E.__proto__={__proto__:Uint8Array.prototype,Yek:function(){return 42}};return"function"===typeof E.subarray&&0===E.subarray(1,1).byteLength}catch(H){return!1}}
function f(E,H){if((e.pP?2147483647:1073741823)<H)throw new RangeError("Invalid typed array length");e.pP?(E=new Uint8Array(H),E.__proto__=e.prototype):(null===E&&(E=new e(H)),E.length=H);return E}function e(E,H,G){if(!(e.pP||this instanceof e))return new e(E,H,G);if("number"===typeof E){if("string"===typeof H)throw Error("If encoding is specified then the first argument must be a string");return r(this,E)}return d(this,E,H,G)}function d(E,H,G,N){if("number"===typeof H)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&H instanceof ArrayBuffer){H.byteLength;if(0>G||H.byteLength<G)throw new RangeError("'offset' is out of bounds");if(H.byteLength<G+(N||0))throw new RangeError("'length' is out of bounds");H=void 0===G&&void 0===N?new Uint8Array(H):void 0===N?new Uint8Array(H,G):new Uint8Array(H,G,N);e.pP?(E=H,E.__proto__=e.prototype):E=l(E,H);H=E}else if("string"===typeof H){N=E;E=G;if("string"!==typeof E||""===E)E="utf8";if(!e.mlf(E))throw new TypeError('"encoding" must be a valid string encoding');
G=x(H,E)|0;N=f(N,G);H=N.write(H,E);H!==G&&(N=N.slice(0,H));H=N}else H=u(E,H);return H}function h(E){if("number"!==typeof E)throw new TypeError('"size" argument must be a number');if(0>E)throw new RangeError('"size" argument must not be negative');}function r(E,H){h(H);E=f(E,0>H?0:v(H)|0);if(!e.pP)for(var G=0;G<H;++G)E[G]=0;return E}function l(E,H){var G=0>H.length?0:v(H.length)|0;E=f(E,G);for(var N=0;N<G;N+=1)E[N]=H[N]&255;return E}function u(E,H){if(e.isBuffer(H)){var G=v(H.length)|0;E=f(E,G);if(0===
E.length)return E;H.copy(E,0,0,G);return E}if(H){if("undefined"!==typeof ArrayBuffer&&H.buffer instanceof ArrayBuffer||"length"in H)return(G="number"!==typeof H.length)||(G=H.length,G=G!==G),G?f(E,0):l(E,H);if("Buffer"===H.type&&M(H.data))return l(E,H.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function v(E){if(E>=(e.pP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(e.pP?2147483647:
1073741823).toString(16)+" bytes");return E|0}function x(E,H){if(e.isBuffer(E))return E.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(E)||E instanceof ArrayBuffer))return E.byteLength;"string"!==typeof E&&(E=""+E);var G=E.length;if(0===G)return 0;for(var N=!1;;)switch(H){case "ascii":case "latin1":case "binary":return G;case "utf8":case "utf-8":case void 0:return y(E).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
G;case "hex":return G>>>1;case "base64":return F(E).length;default:if(N)return y(E).length;H=(""+H).toLowerCase();N=!0}}function w(E,H,G){var N=!1;if(void 0===H||0>H)H=0;if(H>this.length)return"";if(void 0===G||G>this.length)G=this.length;if(0>=G)return"";G>>>=0;H>>>=0;if(G<=H)return"";for(E||(E="utf8");;)switch(E){case "hex":E=H;H=G;G=this.length;if(!E||0>E)E=0;if(!H||0>H||H>G)H=G;N="";for(G=E;G<H;++G)E=N,N=this[G],N=16>N?"0"+N.toString(16):N.toString(16),N=E+N;return N;case "utf8":case "utf-8":return z(this,
H,G);case "ascii":E="";for(G=Math.min(this.length,G);H<G;++H)E+=String.fromCharCode(this[H]&127);return E;case "latin1":case "binary":E="";for(G=Math.min(this.length,G);H<G;++H)E+=String.fromCharCode(this[H]);return E;case "base64":return 0===H&&G===this.length?B.D1e(this):B.D1e(this.slice(H,G));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":H=this.slice(H,G);G="";for(E=0;E<H.length;E+=2)G+=String.fromCharCode(H[E]+256*H[E+1]);return G;default:if(N)throw new TypeError("Unknown encoding: "+
E);E=(E+"").toLowerCase();N=!0}}function m(E,H,G,N,I){if(0===E.length)return-1;"string"===typeof G?(N=G,G=0):2147483647<G?G=2147483647:-2147483648>G&&(G=-2147483648);G=+G;isNaN(G)&&(G=I?0:E.length-1);0>G&&(G=E.length+G);if(G>=E.length){if(I)return-1;G=E.length-1}else if(0>G)if(I)G=0;else return-1;"string"===typeof H&&(H=e.from(H,N));if(e.isBuffer(H))return 0===H.length?-1:n(E,H,G,N,I);if("number"===typeof H)return H&=255,e.pP&&"function"===typeof Uint8Array.prototype.indexOf?I?Uint8Array.prototype.indexOf.call(E,
H,G):Uint8Array.prototype.lastIndexOf.call(E,H,G):n(E,[H],G,N,I);throw new TypeError("val must be string, number or Buffer");}function n(E,H,G,N,I){function O(Y,la){return 1===U?Y[la]:Y.jjj(la*U)}var U=1,ca=E.length,Q=H.length;if(void 0!==N&&(N=String(N).toLowerCase(),"ucs2"===N||"ucs-2"===N||"utf16le"===N||"utf-16le"===N)){if(2>E.length||2>H.length)return-1;U=2;ca/=2;Q/=2;G/=2}if(I)for(N=-1;G<ca;G++)if(O(E,G)===O(H,-1===N?0:G-N)){if(-1===N&&(N=G),G-N+1===Q)return N*U}else-1!==N&&(G-=G-N),N=-1;else for(G+
Q>ca&&(G=ca-Q);0<=G;G--){ca=!0;for(N=0;N<Q;N++)if(O(E,G+N)!==O(H,N)){ca=!1;break}if(ca)return G}return-1}function z(E,H,G){G=Math.min(E.length,G);for(var N=[];H<G;){var I=E[H],O=null,U=239<I?4:223<I?3:191<I?2:1;if(H+U<=G)switch(U){case 1:128>I&&(O=I);break;case 2:var ca=E[H+1];128===(ca&192)&&(I=(I&31)<<6|ca&63,127<I&&(O=I));break;case 3:ca=E[H+1];var Q=E[H+2];128===(ca&192)&&128===(Q&192)&&(I=(I&15)<<12|(ca&63)<<6|Q&63,2047<I&&(55296>I||57343<I)&&(O=I));break;case 4:ca=E[H+1];Q=E[H+2];var Y=E[H+
3];128===(ca&192)&&128===(Q&192)&&128===(Y&192)&&(I=(I&15)<<18|(ca&63)<<12|(Q&63)<<6|Y&63,65535<I&&1114112>I&&(O=I))}null===O?(O=65533,U=1):65535<O&&(O-=65536,N.push(O>>>10&1023|55296),O=56320|O&1023);N.push(O);H+=U}E=N.length;if(E<=R)N=String.fromCharCode.apply(String,N);else{G="";for(H=0;H<E;)G+=String.fromCharCode.apply(String,N.slice(H,H+=R));N=G}return N}function y(E,H){H=H||Infinity;for(var G,N=E.length,I=null,O=[],U=0;U<N;++U){G=E.charCodeAt(U);if(55295<G&&57344>G){if(!I){if(56319<G){-1<(H-=
3)&&O.push(239,191,189);continue}else if(U+1===N){-1<(H-=3)&&O.push(239,191,189);continue}I=G;continue}if(56320>G){-1<(H-=3)&&O.push(239,191,189);I=G;continue}G=(I-55296<<10|G-56320)+65536}else I&&-1<(H-=3)&&O.push(239,191,189);I=null;if(128>G){if(0>--H)break;O.push(G)}else if(2048>G){if(0>(H-=2))break;O.push(G>>6|192,G&63|128)}else if(65536>G){if(0>(H-=3))break;O.push(G>>12|224,G>>6&63|128,G&63|128)}else if(1114112>G){if(0>(H-=4))break;O.push(G>>18|240,G>>12&63|128,G>>6&63|128,G&63|128)}else throw Error("Invalid code point");
}return O}function A(E){for(var H=[],G=0;G<E.length;++G)H.push(E.charCodeAt(G)&255);return H}function F(E){var H=B,G=H.DZj;E=(E.trim?E.trim():E.replace(/^\s+|\s+$/g,"")).replace(P,"");if(2>E.length)E="";else for(;0!==E.length%4;)E+="=";return G.call(H,E)}function D(E,H,G,N){for(var I=0;I<N&&!(I+G>=H.length||I>=E.length);++I)H[I+G]=E[I];return I}var B=a(1401);a(1402);var M=a(1403);C.rsg=e;C.oek=function(E){+E!=E&&(E=0);return e.sve(+E)};C.Vdk=50;e.pP=void 0!==c.pP?c.pP:b();C.gfk=e.pP?2147483647:1073741823;
e.from=function(E,H,G){return d(null,E,H,G)};e.pP&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0}));e.sve=function(E){h(E);return f(null,E)};e.PUg=function(E){return r(null,E)};e.isBuffer=function(E){return!(null==E||!E.SCg)};e.compare=function(E,H){if(!e.isBuffer(E)||!e.isBuffer(H))throw new TypeError("Arguments must be Buffers");if(E===H)return 0;
for(var G=E.length,N=H.length,I=0,O=Math.min(G,N);I<O;++I)if(E[I]!==H[I]){G=E[I];N=H[I];break}return G<N?-1:N<G?1:0};e.mlf=function(E){switch(String(E).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};e.concat=function(E,H){if(!M(E))throw new TypeError('"list" argument must be an Array of Buffers');if(0===E.length)return e.sve(0);var G;if(void 0===H)for(G=H=
0;G<E.length;++G)H+=E[G].length;H=e.PUg(H);var N=0;for(G=0;G<E.length;++G){var I=E[G];if(!e.isBuffer(I))throw new TypeError('"list" argument must be an Array of Buffers');I.copy(H,N);N+=I.length}return H};e.byteLength=x;e.prototype.SCg=!0;e.prototype.toString=function(){var E=this.length|0;return 0===E?"":0===arguments.length?z(this,0,E):w.apply(this,arguments)};e.prototype.equals=function(E){if(!e.isBuffer(E))throw new TypeError("Argument must be a Buffer");return this===E?!0:0===e.compare(this,
E)};e.prototype.compare=function(E,H,G,N,I){if(!e.isBuffer(E))throw new TypeError("Argument must be a Buffer");void 0===H&&(H=0);void 0===G&&(G=E?E.length:0);void 0===N&&(N=0);void 0===I&&(I=this.length);if(0>H||G>E.length||0>N||I>this.length)throw new RangeError("out of range index");if(N>=I&&H>=G)return 0;if(N>=I)return-1;if(H>=G)return 1;H>>>=0;G>>>=0;N>>>=0;I>>>=0;if(this===E)return 0;var O=I-N,U=G-H,ca=Math.min(O,U);N=this.slice(N,I);E=E.slice(H,G);for(H=0;H<ca;++H)if(N[H]!==E[H]){O=N[H];U=E[H];
break}return O<U?-1:U<O?1:0};e.prototype.includes=function(E,H,G){return-1!==this.indexOf(E,H,G)};e.prototype.indexOf=function(E,H,G){return m(this,E,H,G,!0)};e.prototype.lastIndexOf=function(E,H,G){return m(this,E,H,G,!1)};e.prototype.write=function(E,H,G,N){if(void 0===H)N="utf8",G=this.length,H=0;else if(void 0===G&&"string"===typeof H)N=H,G=this.length,H=0;else if(isFinite(H))H|=0,isFinite(G)?(G|=0,void 0===N&&(N="utf8")):(N=G,G=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var I=this.length-H;if(void 0===G||G>I)G=I;if(0<E.length&&(0>G||0>H)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");N||(N="utf8");for(I=!1;;)switch(N){case "hex":H=Number(H)||0;N=this.length-H;G?(G=Number(G),G>N&&(G=N)):G=N;N=E.length;if(0!==N%2)throw new TypeError("Invalid hex string");G>N/2&&(G=N/2);for(N=0;N<G;++N){I=parseInt(E.substr(2*N,2),16);if(isNaN(I))break;this[H+N]=I}return N;case "utf8":case "utf-8":return D(y(E,this.length-H),this,H,G);case "ascii":return D(A(E),
this,H,G);case "latin1":case "binary":return D(A(E),this,H,G);case "base64":return D(F(E),this,H,G);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":N=E;I=this.length-H;for(var O=[],U=0;U<N.length&&!(0>(I-=2));++U){var ca=N.charCodeAt(U);E=ca>>8;ca%=256;O.push(ca);O.push(E)}return D(O,this,H,G);default:if(I)throw new TypeError("Unknown encoding: "+N);N=(""+N).toLowerCase();I=!0}};e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.tek||this,0)}};var R=4096;
e.prototype.slice=function(E,H){var G=this.length;E=~~E;H=void 0===H?G:~~H;0>E?(E+=G,0>E&&(E=0)):E>G&&(E=G);0>H?(H+=G,0>H&&(H=0)):H>G&&(H=G);H<E&&(H=E);if(e.pP)H=this.subarray(E,H),H.__proto__=e.prototype;else{G=H-E;H=new e(G,void 0);for(var N=0;N<G;++N)H[N]=this[N+E]}return H};e.prototype.jjj=function(E){if(0!==E%1||0>E)throw new RangeError("offset is not uint");if(E+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[E]<<8|this[E+1]};e.prototype.copy=function(E,
H,G,N){G||(G=0);N||0===N||(N=this.length);H>=E.length&&(H=E.length);H||(H=0);0<N&&N<G&&(N=G);if(N===G||0===E.length||0===this.length)return 0;if(0>H)throw new RangeError("targetStart out of bounds");if(0>G||G>=this.length)throw new RangeError("sourceStart out of bounds");if(0>N)throw new RangeError("sourceEnd out of bounds");N>this.length&&(N=this.length);E.length-H<N-G&&(N=E.length-H+G);var I=N-G;if(this===E&&G<H&&H<N)for(N=I-1;0<=N;--N)E[N+H]=this[N+G];else if(1E3>I||!e.pP)for(N=0;N<I;++N)E[N+H]=
this[N+G];else Uint8Array.prototype.set.call(E,this.subarray(G,G+I),H);return I};e.prototype.fill=function(E,H,G,N){if("string"===typeof E){"string"===typeof H?(N=H,H=0,G=this.length):"string"===typeof G&&(N=G,G=this.length);if(1===E.length){var I=E.charCodeAt(0);256>I&&(E=I)}if(void 0!==N&&"string"!==typeof N)throw new TypeError("encoding must be a string");if("string"===typeof N&&!e.mlf(N))throw new TypeError("Unknown encoding: "+N);}else"number"===typeof E&&(E&=255);if(0>H||this.length<H||this.length<
G)throw new RangeError("Out of range index");if(G<=H)return this;H>>>=0;G=void 0===G?this.length:G>>>0;E||(E=0);if("number"===typeof E)for(N=H;N<G;++N)this[N]=E;else for(E=e.isBuffer(E)?E:y((new e(E,N)).toString()),I=E.length,N=0;N<G-H;++N)this[N+H]=E[N%I];return this};var P=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1400))},1400:function(t){var C=function(){return this}();try{C=C||(new Function("return this"))()}catch(a){"object"===typeof window&&(C=window)}t.exports=C},1401:function(t,C){function a(e){var d=
e.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");-1===e&&(e=d);return[e,e===d?0:4-e%4]}C.byteLength=function(e){e=a(e);var d=e[1];return 3*(e[0]+d)/4-d};C.DZj=function(e){var d=a(e);var h=d[0];d=d[1];var r=new f(3*(h+d)/4-d),l=0,u=0<d?h-4:h,v;for(v=0;v<u;v+=4)h=b[e.charCodeAt(v)]<<18|b[e.charCodeAt(v+1)]<<12|b[e.charCodeAt(v+2)]<<6|b[e.charCodeAt(v+3)],r[l++]=h>>16&255,r[l++]=h>>8&255,r[l++]=h&255;2===d&&(h=b[e.charCodeAt(v)]<<2|b[e.charCodeAt(v+1)]>>
4,r[l++]=h&255);1===d&&(h=b[e.charCodeAt(v)]<<10|b[e.charCodeAt(v+1)]<<4|b[e.charCodeAt(v+2)]>>2,r[l++]=h>>8&255,r[l++]=h&255);return r};C.D1e=function(e){for(var d=e.length,h=d%3,r=[],l=0,u=d-h;l<u;l+=16383){for(var v=r,x=v.push,w,m=e,n=l+16383>u?u:l+16383,z=[],y=l;y<n;y+=3)w=(m[y]<<16&16711680)+(m[y+1]<<8&65280)+(m[y+2]&255),z.push(c[w>>18&63]+c[w>>12&63]+c[w>>6&63]+c[w&63]);w=z.join("");x.call(v,w)}1===h?(e=e[d-1],r.push(c[e>>2]+c[e<<4&63]+"==")):2===h&&(e=(e[d-2]<<8)+e[d-1],r.push(c[e>>10]+c[e>>
4&63]+c[e<<2&63]+"="));return r.join("")};var c=[],b=[],f="undefined"!==typeof Uint8Array?Uint8Array:Array;for(t=0;64>t;++t)c[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;b[45]=62;b[95]=63},1402:function(t,C){C.read=function(a,c,b,f,e){var d=8*e-f-1;var h=(1<<d)-1,r=h>>1,l=-7;e=b?e-1:0;var u=b?-1:1,v=a[c+e];e+=u;b=v&(1<<-l)-1;v>>=-l;for(l+=d;0<l;b=256*b+a[c+e],e+=u,l-=8);d=b&(1<<-l)-1;
b>>=-l;for(l+=f;0<l;d=256*d+a[c+e],e+=u,l-=8);if(0===b)b=1-r;else{if(b===h)return d?NaN:Infinity*(v?-1:1);d+=Math.pow(2,f);b-=r}return(v?-1:1)*d*Math.pow(2,b-f)};C.write=function(a,c,b,f,e,d){var h,r=8*d-e-1,l=(1<<r)-1,u=l>>1,v=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;d=f?0:d-1;var x=f?1:-1,w=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,f=l):(f=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-f))&&(f--,h*=2),c=1<=f+u?c+v/h:c+v*Math.pow(2,1-u),2<=c*h&&(f++,h/=2),f+
u>=l?(c=0,f=l):1<=f+u?(c=(c*h-1)*Math.pow(2,e),f+=u):(c=c*Math.pow(2,u-1)*Math.pow(2,e),f=0));for(;8<=e;a[b+d]=c&255,d+=x,c/=256,e-=8);f=f<<e|c;for(r+=e;0<r;a[b+d]=f&255,d+=x,f/=256,r-=8);a[b+d-x]|=128*w}},1403:function(t){var C={}.toString;t.exports=Array.isArray||function(a){return"[object Array]"==C.call(a)}},1404:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);C=a(746);var c=a(722);class b extends C.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,
{T_:b.getTypeName(),B_:b.Td()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Td(){return["AugLoop_Core_Annotation"]}}Object(t.a)(b,"DetectedHtmlTableAnnotation",C.a,[])},1405:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{static DJa(b,f){if(!(b&&f&&b.length&&f.length)||256<b.length)return"";const e=Array(256),d=Array(256);let h,r=0,l=0;let u,v="";for(h=0;256>h;h++)e[h]=h;for(h=0;256>h;h++){var x=b.charCodeAt(h%b.length);if(256<=x)return"";r=
(r+e[h]+x)%256;x=e[h];e[h]=e[r];e[r]=x}for(h=0;256>h;h++)d[h]=e[256-h-1];r=h=0;for(b=0;b<f.length;b++){h=(h+1)%256;r=(r+e[h])%256;x=e[h];e[h]=e[r];e[r]=x;x=f.charCodeAt(b);if(256<=x)return"";u=x^e[(e[h]+e[r])%256];l=(l+d[h])%256;x=d[h];d[h]=d[l];d[l]=x;v+=String.fromCharCode(u^e[(d[h]+d[l])%256])}return v}}Object(t.a)(c,"RC4A",null,[])},1417:function(t,C,a){t=a(0);var c=a(14),b=a(88);a(113);var f=a(29);class e{constructor(x,w,m){this.Uj=this.VGd=null;this.EGa=this.x$=0;this.HVb=null;this.jT=x;this.de=
w;this.$a=m;this.D3a=!1;this.p3d=!0;this.Huj();this.mab=this.fa.ra("NativeFileOpenDialogIsEnabled")}get context(){return this.jT}get fa(){return this.$a}get retryCount(){return this.x$}get eyc(){return this.EGa}KIb(x){this.Uj=x;if(!this.D3a){if(this.p3d){if(this.mab&&f.a.NF){this.HVb=x.n$b(Object(b.a)(this,this.jFd,"onFileChosen"));return}this.HVb=x.n$b(null);if(!this.HDa(this.HVb,x))return}this.finalizeUpload(x,null)}}jFd(x){if(this.HDa(x,this.Uj)){if(f.a.NF||f.a.Nf)this.HVb=x;this.finalizeUpload(this.Uj,
null)}}Xsc(){this.VGd&&this.VGd()}Huj(){this.x$=0;this.EGa=this.fa.Dd("Box4UploadRetryDelayStart",200);this.Uj&&(this.Uj.dispose(),this.Uj=null)}}Object(t.a)(e,"FileUploader",null,[]);var d=a(6),h=a(329),r=a(809),l=a(143),u=a(34);a.d(C,"a",function(){return v});class v extends e{constructor(x,w,m){super(x,w,m);this.qYb=this.dta=null}get PO(){return d.AFrameworkApplication.sa.jE}B5e(x){switch(x){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;
default:return""}}Qpg(x){return v.HDa(x,this.Aai())}Aai(){return v.Zoe}HDa(x,w=null){x=this.Qpg(x);return 0!==x?(w&&w.kre(),2===x&&this.Ij(0,this.B5e(x)),!1):!0}finalizeUpload(x,w){c.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.VGd=w;this.FPj();h.a.mark(5576);this.qYb=this.PO.Qc("LoadResource","PictureUploadTime")}Ij(x,w){const m=new l.StandardDialog;m.Xb=0;m.rA(x,CommonUIStrings.l_ImageUploadFailedTitle,w,null)}Xsc(){c.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");
super.Xsc();this.qYb&&(this.qYb.stop(),this.qYb=null);this.r$g()}FPj(){this.dta=(new r.a).create();this.dta.message=CommonUIStrings.l_ImageUploadWait;this.dta.Xb=5;this.dta.Ot=!1;this.dta.wCa(null,null,null)}r$g(){this.dta&&(this.dta.close(),this.dta=null)}static ahi(x,w){x=u.a.Ok(x);for(let m=0;m<w.length;++m)if(x.endsWith(w[m]))return!0;return!1}static HDa(x,w=null){w||(w=v.Zoe);return x?v.ahi(x,w)?0:2:1}}v.Zoe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(t.a)(v,"PictureUploader",e,
[])},1482:function(t,C,a){a.r(C);t=a(1200);C=a(1162);var c=a(1163),b=a(1182),f=a(1303),e=a(1304),d=a(1165),h=a(1225),r=a(1205),l=a(1226),u=a(1250),v=a(1201),x=a(1305),w=a(1167),m=a(1187),n=a(1208),z=a(1306),y=a(1168),A=a(1251),F=a(1278);a=a(1262);Object(t.a)();Object(C.a)();Object(c.a)();Object(b.a)();Object(f.a)();Object(e.a)();Object(d.a)();Object(h.a)();Object(r.a)();Object(l.a)();Object(u.a)();Object(v.a)();Object(x.a)();Object(w.a)();Object(m.a)();Object(n.a)();Object(z.a)();Object(y.a)();Object(A.a)();
Object(F.a)();Object(a.a)()},787:function(t,C,a){t=a(0);var c;(function(d){d[d.none=0]="none";d[d.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";d[d.applyLinkFailed=2]="applyLinkFailed";d[d.pasteHtmlFailed=3]="pasteHtmlFailed";d[d.pasteStringFailed=4]="pasteStringFailed";d[d.pasteRangeFailed=5]="pasteRangeFailed";d[d.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";d[d.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";
d[d.clipboardIsInaccessible=8]="clipboardIsInaccessible";d[d.pasteArtFailed=9]="pasteArtFailed";d[d.noArtSourceItem=10]="noArtSourceItem";d[d.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";d[d.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";d[d.invalidShadowWorkbook=13]="invalidShadowWorkbook";d[d.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";d[d.failedToPasteExternalImage=15]="failedToPasteExternalImage";d[d.lastAsyncSerializeFailed=16]=
"lastAsyncSerializeFailed";d[d.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";d[d.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";d[d.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";d[d.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";d[d.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";
d[d.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed"})(c||(c={}));Object(t.b)("PasteErrorType",c);var b=a(965),f=a(1164);a.d(C,"a",function(){return e});class e extends b.a{constructor(d,h=null,r=null,l="",u=100){super(c[d]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=d;this.ewaErrors=h;this.validationFailureReason=u;this.innerError=h?new f.a(h,r):r;this.message=l}}Object(t.a)(e,"PasteInnerError",b.a,[])},965:function(t,C,a){a.d(C,
"a",function(){return c});t=a(0);class c{constructor(b,f=null){this.errorName=this.innerError=null;this.errorName=b;this.innerError=f}}Object(t.a)(c,"CCPError",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.frs.js.map/afe05c223c3b6094dbc233220fb489bf/EwaDSOpt.frs.js.map
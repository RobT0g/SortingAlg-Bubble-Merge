'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[19],{1174:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi(".ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-text-box,.ewa-fb-presence-cover{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-monospace-experiment{overflow:hidden;border:1px solid #e6e7e8;outline:none;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0 0 0 0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-text-box,.ewa-root-ltr .ewa-fb-presence-cover{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#217346}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0 !important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit !important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000 !important;border:1px solid #000 !important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor *::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130 !important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886 !important}.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .cancelbox{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb,.ewr-presentMode-transition .functionbox.button-disabled{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb-fix{flex:0 0 auto !important}.ewa-fb-nb .cui-cb{flex:0 1 auto;align-self:center;z-index:101}.ewa-fb-refactor.ewa-fb-nb .cui-cb{align-self:baseline;top:4px}@media screen and (-ms-high-contrast:active){.ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button path,.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button .ewa-svg-icon path,.ewa-fb-nb .cui-cb-focus .cui-dd-arrow-button .ewa-svg-icon path{fill:HighlightText}.ewa-fb-nb .cui-cb .cui-cb-input{border-color:WindowText;background-color:Window !important}.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button{background-color:Highlight}.ewa-fb-nb .cui-dd-arrow-button .ewa-svg-icon path{fill:ButtonText}}.ewa-root-ltr .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 0 0 4px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 4px 0 0}.ewa-fb-nb .cui-cb-input{height:14px;font-size:14.7px;font-family:Calibri}.ewa-fb-full-width .ewa-rteTextElement{width:100%}.grid-visual-refresh .ewa-fb-nb .cui-cb-input{height:18px}.ewa-fb-nb .cui-dd-arrow-button{height:18px;background-color:#fff}.grid-visual-refresh .ewa-fb-nb .cui-dd-arrow-button{height:18px;padding-top:2px;padding-bottom:2px}.ewr-presentMode-on .ewa-fb-nb .cui-cb-input{background-color:#3c3c3c;color:#f3f2f1;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-cb-input{background-color:#3c3c3c !important;border:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-cb-input{border-color:#37a660 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-cb-input{background-color:#292827;border:1px solid #292827}.ewr-presentMode-on .ewa-fb-nb .cui-dd-arrow-button{background-color:#3c3c3c;border-top:1px solid #3c3c3c;border-right:1px solid #3c3c3c;border-bottom:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{background-color:#3c3c3c !important;border-top:1px solid #3c3c3c !important;border-right:1px solid #3c3c3c !important;border-bottom:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button{border-color:#37a660 !important}.ewr-presentMode-on .ewa-fb-nb-dropdown-button-img{fill:#e1dfdd}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button .ewa-fb-nb-dropdown-button-img{fill:#8a8886 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-dd-arrow-button{background-color:#292827;border-top:1px solid #292827;border-right:1px solid #292827;border-bottom:1px solid #292827}#presentModeNamedObjectsMenu{z-index:1056 !important;background-color:#3c3c3c !important;border:1px solid #323130 !important}#presentModeNamedObjectsMenu .cui-ctl-mediumlabel{color:#e1dfdd !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover .cui-ctl-mediumlabel,#presentModeNamedObjectsMenu .cui-ctl-menu:focus .cui-ctl-mediumlabel{color:#f3f2f1 !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover,#presentModeNamedObjectsMenu .cui-ctl-menu:focus{background-color:#484644 !important;border-color:#484644 !important}.ewr-presentMode-transition .ewa-fb-nb .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-dd-arrow-button,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{transition:background-color .4s linear,color .4s linear}")}},
1175:function(t,C,a){a.d(C,"d",function(){return r});a.d(C,"c",function(){return l});a.d(C,"b",function(){return u});a.d(C,"a",function(){return v});var c=a(23),b=a(886),f=a(1176),e=a(121),d=a(136),h=a(575);const r=w=>255<w.length||!x(w)||c.a.rG(w,"_xl")?!1:!0,l=(w,m)=>{var n=m.ga;m=n.qa.ph;n=n.qa.activeRange;return w.ua.na&&m?b.b(w.Hb,n,w.ua.na.name):null},u=w=>{let m=null;w=w.ga.Ra;w.YV&&(m=w.oc.floatingObject);return m},v=(w,m=!0)=>{const n=f.a.getInstance(w),z=n.t3h();z&&!w.Hb.Ik(z)&&h.a(d.a.V$g,
[e.a.dAf],!0,!0,!1,!1,null);n.stop(m)},x=w=>{if(!w.length)return!1;for(let m=0;m<w.length;m++){const n=w.charAt(m),z=w.charCodeAt(m);if(!m){if("\\"!==n&&"_"!==n&&!c.a.isLetter(z))return!1}else if("_"!==n&&"."!==n&&!c.a.Xmf(z)&&!c.a.isNumeral(z))return!1}return!0}},1176:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(14);class b{constructor(f){this.start=e=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):
(this.ii.start(),this.inProgress=!0,this.PAf=e)};this.stop=(e=!0)=>{this.inProgress&&(this.ii.stop(),e&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.ii.Jc}}`),this.inProgress=!1,this.PAf=void 0)};this.t3h=()=>this.PAf;this.ii=f.Rb.Dg("UserAction","CreateNamedObjectTimer");this.inProgress=!1}}b.getInstance=f=>{void 0===b.instance&&(b.instance=new b(f));return b.instance};Object(t.a)(b,"NameBoxTelemetry",null,[])},1222:function(t,C,a){var c=a(10);t=a(0);var b=a(718),
f=a(53),e=a(39),d=a(198),h=a(14),r=a(818),l=a(140),u=a(273),v=a(73),x=a(80),w=a(134),m=a(33),n=a(119),z=a(9),y=a(25),A=a(45),F=a(886),D=a(120),B=a(389),M;(function(V){V[V.NONE=0]="NONE";V[V.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";V[V.PRINT_AREA=2]="PRINT_AREA";V[V.DISCONTINUOUS_RANGES=3]="DISCONTINUOUS_RANGES";V[V.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";V[V.INVALID_NAME=5]="INVALID_NAME";V[V.EMPTY_RANGE=6]="EMPTY_RANGE";V[V.GENERIC_ERROR=7]="GENERIC_ERROR"})(M||(M={}));Object(t.b)("NameBoxInvalidOperation",
M);var R=a(125),P=a(32),E=a(23),H=a(15),G=a(121),N=a(136),I=a(575),O=a(105);class U extends B.a{constructor(V,ma,W=null){super(V,ma);this.APi=W;this.gza();this.Rr()}get uc(){return"NameBoxErrorDialog"}Rr(){super.Rr();const V=this.error.Caption,ma=this.nZh(this.error),W=this.mZh(this.error);this.Xb=0;this.pta(W);this.Tl(V,ma,2,this.P8)}nZh(V){return E.a.equals(V.MessageIdName,U.QFc,!0)?String.format(V.Description):E.a.equals(V.MessageIdName,U.yBb,!0)?"":V.Description}mZh(V){const ma=[];E.a.equals(V.MessageIdName,
U.yBb,!0)&&(V=String.format(H.a.instance.ha(2253)),ma.push(...R.f(V.split("-"),W=>W.trim())));return ma}gza(){if(this.error.MessageIdName===U.yBb)h.ULS.sendTraceTag(528053385,0,50,this.error.Caption);else{let V=this.error.Caption;this.error.MessageIdName===U.QFc&&(V=`Unsupported Operation: ${M[this.APi]}`);const ma=new O.a;ma.ia("errorCaption",V);I.a(N.a.jJh,[G.a.dAf],!0,!0,!1,!1,ma)}}static nd(V){switch(V){case 3:case 1:case 2:return P.a.nd(1,0,2254,2255,0,-1280789630,U.QFc);case 5:case 4:return P.a.nd(1,
0,2252,2253,0,875859818,U.yBb);case 7:return P.a.nd(1,0,0,1,0,424201999,U.yBb);case 6:return P.a.nd(1,0,2256,2257,0,-1280789630,U.QFc);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}U.QFc="NameBoxUnsupportedOperation";U.yBb="NameBoxInvalidName";Object(t.a)(U,"NameBoxErrorDialog",B.a,[]);class ca{constructor(){this.type=this.location=this.name=this.key=null}}Object(t.a)(ca,"NamedObjectOption",null,[]);const Q=(V,ma,W,aa)=>{const ia=
new ca;ia.key=V;ia.name=ma;ia.location=W;a:switch(aa){case 2:V="Table";break a;case 3:V=E.a.d4a(ma,"Print_Area")?"Print Area":"Named Range";break a;default:V="Unknown"}ia.type=V;return ia};var Y=a(1175),la=a(1),ea=a(21),ha=a(135),X=a(1176);class T{constructor(V,ma){this.printArea="Print_Area";this.fxj="R";this.fah="C";this.zPi="Value";this.$=V;this.gridView=ea.h(this.$);this.Kza=ma;this.BPi=X.a.getInstance(this.$)}qbj(){var V=this.$.Hb.items,ma=this.$.na.name;const W={};for(var aa of V){V=F.a(aa.name);
var ia=V.Ffb;if(v.h(aa)&&(!ia||E.a.equals(V.scope,ma,!1))){const ka=V.name in W;if(!ka||ka&&ia)W[V.name]={["namedObjectDetails"]:V,["namedObjectItem"]:aa}}}ma=[];for(let ka in W)V=W[ka],aa=V.namedObjectItem,V=V.namedObjectDetails,ia=`${aa.sheetName}!${aa.usedRange.topLeft.Rw(!1)}:${aa.usedRange.bottomRight.Rw(!1)}`,ma.push(Q(aa.name,V.name,ia,aa.type));ma.sort((ka,Xa)=>ka.name.localeCompare(Xa.name));this.Kza.rbj(ma);Y.a(this.$,!1);this.sPd(ma.length)}rei(V){V=F.a(V[this.zPi].toString());const ma=
V.name,W=V.scope.length?V.scope:null;var aa=this.m8g(V);this.zAj(V)||(this.GHi(V),0!==aa?(this.Kza.IPe(this.$,aa),this.Y2f()):Y.d(ma)?(aa=A.r(ea.h(this.$).ga.qa.selectedRanges,this.$),this.Kza.Zih(this.$,ma,aa,W,T.uTi,T.tTi),this.BPi.start(V.name)):(this.Kza.IPe(this.$,5),this.Y2f()))}Lfd(){this.Kza.Lfd()}zAj(V){const ma=V.fullName,W=V.name,aa=V.scope;let ia,ka,Xa=!1;!({sheetName:ia,range:ka}=A.ab(ma,this.$.ua)).returnValue||!ka.Qz&&la.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?
E.a.equals(W,this.fxj,!0)?(this.AAj(aa),this.uSa(2)):E.a.equals(W,this.fah,!0)?(this.rAj(aa),this.uSa(2)):this.$.Hb.Ik(ma)?(this.Y5f(ma),this.uSa(V.Ffb?1:0)):this.$.Hb.Ik(W)?(this.Y5f(W),this.uSa(0)):Xa=!0:(this.sAj(ia,ka),this.uSa(3));return!Xa}sAj(V,ma){V=V||this.$.ua.na.name;var W=F.b(this.$.Hb,ma,V);F.c(W)||(W=A.v(ma,this.$),W.SheetName=V,ea.h(this.$).Bg(W,ma.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.gridView.focus())}AAj(V=null){const ma=this.gridView.ga.qa.activeCell;
this.$De(V)&&(V=new y.Range(ma.top,0,ma.bottom,z.a.Eg,!0,!1),this.gridView.ga.bE([V],0,V,0))}rAj(V=null){const ma=this.gridView.ga.qa.activeCell;this.$De(V)&&(V=new y.Range(0,ma.left,z.a.Fg,ma.right,!0,!1),this.gridView.ga.bE([V],0,V,0))}$De(V){return V?(V=this.$.ua.getItemByName(V),(null===V||void 0===V?0:V.visible)?(V.activate(),!0):!1):!0}Y5f(V){V=this.$.Hb.getItemByName(V);F.c(V);this.gridView.focus()}m8g(V){return this.vui()?1:E.a.equals(V.name,this.printArea,!0)?2:this.Drh()?3:this.Bji(V)?4:
this.Oti()?6:0}Y2f(){var V=Y.b(this.gridView);null!=V?this.Kza.q4c("",V.name):(V=Y.c(this.$,this.gridView))?this.Kza.q4c(V.name,V.name):this.Kza.q4c("",this.gridView.ga.qa.activeCell.toString())}vui(){return!!this.gridView.ga.Ra.activeFloatingObjectControlId}Drh(){return 1<this.gridView.ga.qa.selectedRanges.length}Bji(V){return V.Ffb&&!this.$.iW(V.scope)}Oti(){return this.gridView.wb.wma(this.gridView.ga.qa.selectedRanges[0])}static uTi(V){return ma=>{P.a.lg(ma.Errors)&&(new U(V,ma.Errors[0]),X.a.getInstance(V).stop(!1))}}static tTi(V){return ma=>
{(ma=D.a.Ye(ma.data))&&0<ma.length?new U(V,ma[0]):new U(V,U.nd(7));X.a.getInstance(V).stop(!1)}}GHi(V){const ma=null!=Y.c(this.$,this.gridView);V.Ffb?this.uSa(ma?7:6):this.uSa(ma?5:4)}uSa(V){ha.b(this.$).rd(w.a.EVj,{type:V.toString()},null,!0)}sPd(V){ha.b(this.$).rd(w.a.QQf,{hek:V},null,!0)}}Object(t.a)(T,"NameBoxCommandHandler",null,[]);var ua=a(380),Ha=a(199),Ca=a(65);const Ga=(V,ma,W,aa,ia,ka,Xa,sb,ib,Ub,hc=null)=>{hc=V.Oa(9,hc);hc.name=ma;hc.selectedRanges=W;hc.sheetName=aa;hc.formula=ia;hc.comment=
ka;return Ca.g(V,"AddDefinedName",hc,Xa,sb,ib,Ub,0)};var sa=a(293),bb=a(131);class Ba{rbj(V){bb.c()&&appChrome.populateNameBoxMenu(V)}Zih(V,ma,W,aa,ia,ka){ua.a(V.userOperationManager,(Xa,sb,ib)=>Ga(V.pa.va,ma,W,aa,"","",sa.b(Xa,ia(V)),sa.a(sb,ka(V)),ib,V),Xa=>new Ha.a(1020,0,Xa),null)}IPe(V,ma){new U(V,U.nd(ma),ma)}Lfd(){appChrome.updateNameBoxState({["focus"]:!0})}q4c(V,ma){appChrome.setNamedObjectOrActiveCellRange(V,ma)}}Object(t.a)(Ba,"NamedObjectsService",null,[859]);var qa=a(197),pa=a(381),ya=
a(60),za=a(7);class cb{constructor(V,ma){this.$=V;this.gridView=ea.h(this.$);this.Xa=ma;this.mCd=(this.yOa=la.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1))?new T(V,new Ba):null}Oc(){return!1}executeCommand(V,ma,W){ma=ma.command;V=null;switch(ma){case 1726517890:this.yOa?this.mCd.rei(W):W[r.a.IsFreeForm]||((W=this.$.Hb.getItemByName(W[x.a.Uc].toString()))?W.activate():h.ULS.sendTraceTag(537161937,0,15,"FormulaBarCommandHandler.ExecuteCommand: Can't find named Object related to selected item in ComboBox"));
break;case 2045896573:W=n.a(this.$);(null===W||void 0===W?0:W.DLa)?W.DLa.WYe():h.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.mCd.Lfd();break;case -1790328692:W=n.a(this.$);ma=!this.$.zCb;W.isVisible=ma;W.textBox.isVisible=ma;this.$.zCb=ma;this.$.zf();try{l.a.Qs(za.a.Zlf,ma.toString(),u.AFrame.hP)}catch(aa){h.ULS.sendTraceTag(509216780,0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${aa.message}`)}break;
default:V=qa.a(ma)}return V||ya.Task.Ua(!0)}Ac(V,ma,W){V=!1;switch(ma.command){case 1726517890:V=!!W;break;case -1003645154:V=!0;break;case 2045896573:V=m.a.tN();break;case -1790328692:V=la.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisplaySettings",!1)}return V}Vc(V,ma,W){if("PopulateNameBoxMenu"!==ma)return!1;V=this.$.Rb.Qc("UserAction","PopulateNameBoxMenuTimer");if(this.yOa)this.mCd.qbj();else{ma=cb.S8h(this.$.Hb.items,this.$.na.name);const ia=this.Xa.Nq();pa.a(this.$)&&(ia.id=
"presentModeNamedObjectsMenu");const ka=this.Xa.Nc();ka.Tp="Menu";for(var aa of ma){const Xa=this.Yih(aa);ka.buttons.push(Xa)}ma.count||(aa=this.Xa.A8c("EmptyMenuLabel",H.a.instance.ha(711)),ka.buttons.push(aa));ia.Cc.push(ka);W.PopulationXML=this.Xa.ibf(ia);la.EwaSettings.isChangeGateEnabled("OfficeVSO:5404120_NameboxTelemetry")&&this.sPd(ma.count)}V.stop();return!0}Yih(V){let ma=V;V.includes("!")&&(ma=V.split("!")[1]);V=this.Xa.rQ(222,V,1726517890,null,3,"None",0,0,V,!1,0);V.label=ma;V.yS(ma);return V}sPd(V){V=
{["NamedObjectsCount"]:V};ha.b(this.$).rd(w.a.QQf,V,null,!0)}static S8h(V,ma){const W=new d.a;for(let aa=0,ia=V.length;aa<ia;aa++){const ka=V[aa];if(v.h(ka)){if(ka.name.includes("!")){const Xa=ka.name.split("!"),sb=Xa[1];if(Xa[0]!==ma)continue;W.contains(sb)&&W.remove(sb)}W.add(ka.name)}}W.sort();return W}}Object(t.a)(cb,"FormulaBarCommandHandler",null,[233]);class Pa extends b.a{constructor(V){super(V)}Fd(){e.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.Na),V=>{this.qd([new cb(this.$,
V.result)])},this.$.ka)}static la(V){b.a.Yd(280,new Pa(V))}}Object(t.a)(Pa,"FormulaBarCommandHandlerFactory",b.a,[]);B=a(228);var nb=a(872),Ma=a(46),Oa=a(721);class La extends B.a{constructor(V){super();this.$=V;this.Mb()}create(){Ma.PageLoadTrackingInfo.instance.$Ba(za.a.Bka);const V=f.GetServiceTaskFactory.Sa(this.$.da,388,387,this.Na);e.TaskExtensions.za(e.TaskExtensions.Pd([V],this.ka),()=>{this.vb(Object(Oa.a)(this.$.da,172,()=>new nb.FormulaBar(this.$,V.result)))},this.$.ka,3)}}Object(t.a)(La,
"FormulaBarFactory",B.a,[]);a.d(C,"a",function(){return ra});const ra=()=>{c.a.Fa(V=>{V.da.Ha(186,new La(V));Pa.la(V)})}},1488:function(t,C,a){a.r(C);t=a(1174);a=a(1222);Object(t.a)();Object(a.a)()},872:function(t,C,a){a.r(C);t=a(0);var c=a(14),b=a(91),f=a(6),e=a(114),d=a(16),h=a(92),r=a(714),l=a(29),u=a(372),v=a(67),x=a(139),w=a(97);class m{}m.MAh="ewa-fb";m.SAh="ewa-fb-placeholder";m.TAh="ewa-fb-text-box";m.UAh="ewa-fb-text-box-monospace-experiment";m.VAh="ewa-fb-text-box-new";m.OUe="ewa-fb-refactor";
m.MUe="ewa-fb-extended";m.iRi="not-ie";m.S1e="functionbox";m.aci="green-fill-paths";m.DQ="drop-down";m.Aqc="ok-cancel-buttons-container";m.xCf="okbox";m.qDe="cancelbox";m.NUe="ewa-fb-nb";m.RAh="ewa-fb-name-box-placeholder";m.xBe="button-disabled";m.PAh="ewa-fb-expand-button-img";m.OAh="ewa-fb-expand-button-container";m.WAh="ewa-fb-text-div-container";m.LUe="ewa-fb-drag-resize";m.NAh="ewa-fb-drag-handler";m.IVe="ewa-svg-icon";m.QAh="ewa-fb-full-width";m.JU="cui-disabled";Object(t.a)(m,"CssClassNames",
null,[]);var n=a(7),z=a(272),y=a(629),A=a(627),F=a(486),D=a(163),B=a(134),M=a(53),R=a(86),P=a(101);class E extends P.a{constructor(Ea,fa,Ua,Aa,Ib,Pb){super(Ea);this.YN=()=>{this.domElement.disabled||(this.x6b.className=this.g9b+" "+this.Dzf)};this.XN=()=>{this.domElement.disabled||(this.x6b.className=this.g9b+" "+this.TOi)};this.WIf=Fa=>{if(!this.domElement.disabled){const da=Fa.keyCode;if("mousedown"===Fa.type||13===da||32===da)this.x6b.className=this.g9b+" "+this.rdj}};this.XIf=()=>{this.domElement.disabled||
(this.x6b.className=this.g9b+" "+this.Dzf)};this.g9b=Ua;this.Dzf=Aa;this.TOi=Ib;this.rdj=Pb;this.Pc.la("mouseover",this.YN);this.Pc.la("mouseout",this.XN);this.Pc.la("focus",this.YN);this.Pc.la("blur",this.XN);this.Pc.la("mousedown",this.WIf);this.Pc.la("keydown",this.WIf);this.Pc.la("mouseup",this.XIf);this.Pc.la("keyup",this.XIf);this.x6b=fa}}Object(t.a)(E,"PseudoClassBehavior",P.a,[]);var H=a(13);class G extends R.a{constructor(Ea){super();this.Qqd=[];this.$=Ea}dispose(){h.a.wc(this.Qqd);this.Qqd.length=
0;this.$=null;super.dispose()}w3b(Ea,fa,Ua,Aa,Ib){const Pb=H.DOMElementExtensions.getElementById(this.$.domElement,this.$.Ib+Ea);Ea=Ea===fa?Pb:H.DOMElementExtensions.getElementById(this.$.domElement,this.$.Ib+fa);if(!Pb)return null;Ua=new E(Pb,Ea,Ua,Aa,"",Ib);this.Qqd.push(Ua);return Ua}}G.v3g="ewa-menu-btn-hover";G.x3g="ewa-menu-btn-pressed";Object(t.a)(G,"InitializePseudoClasses",R.a,[]);var N=a(33),I=a(259),O=a(202),U=a(155),ca=a(39),Q=a(34),Y=a(818),la=a(15),ea=a(73),ha=a(45),X=a(886),T=a(184);
class ua{constructor(Ea="",fa=""){this.menuItemId=Ea;this.commandValueId=fa}ica(){return""}Oka(){return this.commandValueId}v5(){return this.menuItemId}Fy(){}}Object(t.a)(ua,"NotSelectedMenuItem",null,[94,102]);var Ha=a(138),Ca=a(32),Ga=a(1),sa=a(110),bb=a(21),Ba=a(49),qa=a(736);class pa{constructor(Ea,fa,Ua,Aa,Ib=null){this.G7a=this.nZ=this.Uaa=this.Yq=null;this.mah=la.a.instance.ha(710);this.arb="EditableNamedObjectDropdownArrowId";this.LAa=this.ova=null;this.xQa=()=>{const Pb=this.gridView.ga,
Fa=Pb.qa.V6a()?Pb.qa.y3a:Pb.qa.activeRange;this.Yq.value=Fa.isSingle?Pb.qa.activeCell.toString():Fa.r9e()};this.k1=()=>{let Pb=this.S7e();this.B1d(Pb)||(this.Uaa.gTa&&(Pb=this.$.Hb.getItemByName(this.Uaa.gTa.Oka()))&&Pb.deactivate(),this.aw(this.gridView.ga.qa.activeCell.toString()))};this.h7=(Pb,Fa)=>{if(Pb=Fa.na){Fa=Pb.usedRange;2===Pb.type&&(Fa=T.a(Pb));if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6303839_AvoidReselectionWithViewPortJumpForTableSelectorsFixed")){var da=this.gridView.ga.qa.ph;
const K=this.gridView.inRangePicker||this.gridView.ni;let xa=!1;2===Pb.type&&da&&!K&&(da=this.gridView.ga.qa.activeRange,xa=Pb.sheetName===this.$.ua.na.name&&!!da&&da.top===Fa.top&&da.left===Fa.left&&da.bottom===Fa.bottom&&da.right===Fa.right);xa||(Fa=ha.v(Fa,this.$),Fa.NamedObjectName=Pb.name,Fa.SheetName=Pb.sheetName,this.gridView.Bg(Fa,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged"))}else Fa=ha.v(Fa,this.$),Fa.NamedObjectName=Pb.name,Fa.SheetName=Pb.sheetName,this.gridView.Bg(Fa,
null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged");Fa=Pb.name.split("!")[1];this.aw(Fa||Pb.name,Pb.name)}};this.ND=()=>{this.gridView.ga.Ra.oc&&this.aw(this.gridView.ga.Ra.oc.floatingObject.name)};this.SHb=(Pb,Fa)=>{this.xQa(Pb,Fa)};this.B7=()=>{this.Uaa.enabled=!1};this.A7=()=>{this.Uaa.enabled=!0};this.Ut=()=>{this.Uaa.enabled=this.$.isEditMode};this.$F=(Pb,Fa)=>{this.Uaa.enabled=Fa.iM?!1:this.$.isEditMode};this.Sci=()=>{this.Z5f()};this.Xdi=Pb=>{if(Pb.keyCode!==b.a.Wh)Pb.keyCode===
b.a.DG&&this.PYe();else{var Fa=this.Yq.value;c.ULS.sendTraceTag(39653979,0,50,"FormulaBarCommandHandler.HandleInputCommit: Name Box commit input value.");if(!({sheetName:Pb,range:da}=ha.ab(Fa,this.$.ua)).returnValue||!da.Qz&&Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown"))if(this.$.Hb.Ik(Fa)){var da=this.$.Hb.getItemByName(Fa);this.B1d(da);this.gridView.focus()}else c.ULS.sendTraceTag(39653980,0,15,"FormulaBarCommandHandler.HandleInputCommit: Input value is not a valid range or a Named Range."),
da=Ca.a.nd(1,0,84,83,0,-1137246675,"GotoInvalidReference"),ca.TaskExtensions.za(Ba.a(this.$).Ij(da),()=>{this.PYe()},this.$.ka);else Pb=Pb||this.$.ua.na.name,Fa=X.b(this.$.Hb,da,Pb),this.B1d(Fa)||(Fa=ha.v(da,this.$),Fa.SheetName=Pb,bb.h(this.$).Bg(Fa,da.topLeft,null,null,60,"EditableNamedObjectsDropdownList.HandleInputCommit"),this.gridView.focus())}};this.$=Ea;this.gridView=bb.h(Ea);this.l2a=this.$.Ib+n.a.lCd;this.lah=this.$.Ib+"NameBoxMenu";this.ygb=fa.RQb;this.svgIconProvider=Ib;Ea=null;Ib&&(Ea=
document.createElement("div"),Ea.style.display="none",this.ova=Ib.ila(qa.a.cbh,8),this.ova.id=this.arb,Ea.appendChild(this.ova),document.body.appendChild(Ea));this.E2c(Ua,Aa)&&(this.Yq=H.DOMElementExtensions.getElementById(this.nZ,this.l2a),c.ULS.shipAssertTag(537161952,0,!!this.Yq,"EditableNamedObjectDropdownList: InputElement inside ComboBoxElement is null"),this.Yq.setAttribute(x.a.spellcheck,v.a.Bqa),this.aw(this.gridView.ga.qa.activeCell.toString()),this.Uaa.enabled=!Ba.a(this.$).iq()&&this.$.isEditMode,
this.Mi(),Ea&&(c.ULS.shipAssertTag(537161951,0,this.ova.parentNode!==Ea,"EditableNamedObjectDropdownList: SVG element was not extraced from invisible DIV."),document.body.removeChild(Ea)))}dispose(){this.ygb&&this.ygb.pNd(this.l2a);this.$&&(this.$.ub.ixc(this.B7),this.$.ub.hxc(this.A7),this.$.ea.qO(this.Ut),sa.a(this.$).FLb(this.SHb),sa.a(this.$).cxc(this.ND),Ba.a(this.$).ig.Lea(this.$F));this.$.Hb&&(this.$.Hb.Gg(this.h7),this.$.Hb.JLb(this.k1));this.$.ua&&this.$.ua.Gg(this.k1);if(this.gridView){const Ea=
this.gridView.ga;Ea.T0(this.k1);Ea.jS(this.xQa);Ea.Ra.zoa(this.ND)}this.$&&this.G7a&&this.G7a.detach("keyup");h.a.Ja(this.G7a);this.ygb=null;H.DOMElementExtensions.cF(this.Yq);this.Yq.className="";this.LAa=this.ova=this.Yq=null}K6j(Ea){!this.LAa&&this.svgIconProvider&&(this.LAa=this.svgIconProvider.ila(qa.a.ebh,8))&&(this.ova.parentNode.appendChild(this.LAa),this.LAa.classList.add("ewa-fb-nb-dropdown-button-img"));this.ova&&this.LAa&&(H.DOMElementExtensions.setVisible(this.ova,!Ea),H.DOMElementExtensions.setVisible(this.LAa,
Ea))}Mi(){this.$.ub.a2b(this.B7);this.$.ub.$1b(this.A7);this.$.ea.RP(this.Ut);const Ea=this.gridView.ga;this.$.Hb.kg(this.h7);this.$.ua.kg(this.k1);Ea.x3(this.k1);Ea.qM(this.xQa);Ea.Ra.w3(this.ND);sa.a(this.$).T1b(this.ND);sa.a(this.$).Tpb(this.SHb);this.G7a=Ha.a.instance.ke(this.Yq);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4696898_DisableFormulaFunctionBoxAndNamedObjectsDropdownDuringPI")&&Ba.a(this.$).ig.V$(this.$F);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4619995_NamedRangeHandleBlur")&&
this.G7a.la("blur",this.Sci);this.G7a.la("keyup",this.Xdi);this.$.Hb.Wpb(this.k1)}E2c(Ea,fa){const Ua=Ea.Okh(this.l2a,this.lah,Q.a.kf(this.mah),pa.nah,this.arb);if(!Ua)return c.ULS.sendTraceTag(537161950,0,10,"EditableNamedObjectDropdownList.BuildAndAttachComboBox: ribbonComboBox is null"),!1;Ea=Ea.ibf(Ua);this.ygb.q3(this.l2a,Ea);this.nZ=this.ygb.Z4e(this.l2a,n.a.cAf);c.ULS.shipAssertTag(537161949,0,!!this.nZ,"EditableNamedObjectDropdownList: ComboBoxElement was not Created after BuildAndAttachComboBox called");
Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5663983_NameBoxOverFlowFix")&&this.nZ.classList.add(pa.yPi);this.Uaa=this.ygb.imd(this.l2a);Ea=document.getElementById(this.$.Ib+n.a.lgd);void 0!==Ea&&null!==Ea&&fa.removeChild(Ea);fa.insertBefore(this.nZ,fa.firstChild);return!0}PYe(){this.Z5f();this.gridView.focus()}Z5f(){const Ea=this.S7e();Ea?this.aw(Ea.name):this.aw(this.gridView.ga.qa.activeCell.toString())}S7e(){var Ea=this.gridView.ga;const fa=Ea.qa.ph;Ea=Ea.qa.activeRange;return this.$.ua.na&&
fa?X.b(this.$.Hb,Ea,this.$.ua.na.name):null}aw(Ea,fa=""){Ea=new ua(Ea,fa);this.Uaa.aw(Ea);this.Uaa.Qb[Y.a.Value]=Ea.v5()}B1d(Ea){return Ea&&ea.h(Ea)?(Ea.activate(),!0):!1}}pa.nah="102px";pa.yPi="ewa-fb-nb-fix";Object(t.a)(pa,"EditableNamedObjectDropdownList",null,[2]);class ya{constructor(Ea,fa){this.$=Ea;this.Db=fa;z.a(this.$).ti(this)}get rc(){return this.Db.textBox.Ke}get Qf(){return bb.h(this.$).jb&&bb.h(this.$).am}get je(){return I.a.r1e}pg(Ea,fa){fa||H.DOMElementExtensions.setFocus(this.rc);
return!fa}Gh(Ea){return H.DOMElementExtensions.Mf(this.rc,Ea)}Bj(){}hk(){}dispose(){z.a(this.$).gA(this)}}Object(t.a)(ya,"FormulaBarFocusManager",null,[36,2]);var za=a(229),cb=a(246),Pa=a(19),nb=a(54),Ma=a(98),Oa=a(166);class La extends R.a{constructor(Ea,fa,Ua,Aa=null){super();this.ARa=this.q7a=null;this.yGf=()=>{const Ib=new Ma.a(753860909,2,this.$.Bc,2,null);this.$.Ia.Nb(Ib);return!0};this.zGf=Ib=>Ib.Da.keyCode===b.a.Wh?(Ib=new Ma.a(753860909,1,this.$.Bc,2,null),this.$.Ia.Nb(Ib),!0):!1;this.AGf=
()=>{if(this.gridView.jb){const Ib=this.gridView.Ih;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7561900_InsertFunctionPositionBugFix")?Ib.textBox.Z3b():Ib.textBox.DF=!0}return!1};this.$=Ua;this.gridView=bb.h(Ua);this.svgIconProvider=Aa;this.MPh=fa.ha(1035);this.LPh=m.S1e+" "+m.DQ;this.I0=Ea.w3b(n.a.igd,n.a.igd,this.LPh,m.aci,"");this.q7a=Aa?Aa.Fca(qa.a.JPh,13,13,this.I0.domElement,void 0,void 0,void 0,fa.ha(1035)):Oa.createClusteredImageFromClusterWithImageClass(13,13,Pa.a.vEh,nb.a.mf(0),null,null,
!0,fa.ha(1035));this.I0.domElement.appendChild(this.q7a);za.a.instance.ta(d.a.click,this.I0.domElement,this.yGf);e.KeyInputManager.instance.ta(d.a.fc,this.I0.domElement,this.zGf);cb.a.instance.ta(d.a.pointerDown,this.I0.domElement,this.AGf)}dispose(){this.I0&&(za.a.instance.Ba(d.a.click,this.I0.domElement,this.yGf),e.KeyInputManager.instance.Ba(d.a.fc,this.I0.domElement,this.zGf),cb.a.instance.Ba(d.a.pointerDown,this.I0.domElement,this.AGf));h.a.Ja(this.I0);this.I0=null;H.DOMElementExtensions.Hf(this.q7a);
this.ARa=this.q7a=null;super.dispose()}J6j(Ea){!this.ARa&&this.svgIconProvider&&(this.ARa=this.svgIconProvider.Fca(qa.a.WPh,13,13,this.I0.domElement,void 0,void 0,void 0,this.MPh))&&this.ARa.classList.add("ewa-fb-function-button-img");this.q7a&&this.ARa&&(H.DOMElementExtensions.setVisible(this.q7a,!Ea),H.DOMElementExtensions.setVisible(this.ARa,Ea))}}Object(t.a)(La,"FormulaBarFunctionControl",R.a,[]);var ra=a(190),V=a(169),ma=a(50),W=a(9),aa=a(147),ia=a(12);class ka{constructor(Ea){this.sva=this.Yja=
this.DNc=this.CNc=this.BNc=null;this.Plc=this.wsd=this.b6=!1;this.Lke=this.emb=this.RBe=this.m2f=0;this.orc=fa=>{this.WYe();fa.Da.rawEvent.preventDefault();return!0};this.krc=fa=>{this.wsd=!0;this.m2f=fa.clientPoint.y;document.body.classList.add(m.LUe);this.b6||(this.BSa=0);this.S3a.la("mousemove",this.wFf,!0);this.S3a.la("touchmove",this.wFf);this.S3a.la("mouseup",this.cFd);this.S3a.la("touchend",this.cFd);this.S3a.la("mouseleave",this.cFd);return!0};this.cFd=()=>{this.wsd=!1;this.BSa=this.ho.clientHeight-
aa.c;document.body.classList.remove(m.LUe);this.S3a.iD();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.ho.clientHeight} pixel`)};this.wFf=fa=>{this.wsd?(fa=ia.HelperMethods.Rdc(fa).y,fa=this.W7e(this.BSa+Math.min(fa,this.$.domElement.clientHeight-75)-this.m2f),this.b6=fa>=this.lineHeight,H.DOMElementExtensions.toggleCssClass(this.ho,m.MUe,this.b6),fa=aa.c+Math.round(Math.max(fa-2,0)),this.ho.clientHeight!==fa&&(this.ho.style.height=
fa+"px",this.$.BBa())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.$N=fa=>{this.b6&&(this.ELa=Math.round((Math.round(this.ELa/this.lineHeight)+(0<fa.SDa?1:-1))*this.lineHeight));fa.Da.preventDefault();return!1};this.w7=()=>{this.Muj();this.Plc&&(ra.a.instance.Ba(d.a.vI,document.body,this.w7),ra.a.instance.Ba(d.a.Dza,document.body,this.w7),V.a.instance.Ba(d.a.Fe,document.body,this.w7),this.Plc=!1);return!1};
this.Vf=()=>{this.ELa=0};this.onScroll=fa=>{this.Plc||(ra.a.instance.ta(d.a.vI,document.body,this.w7),ra.a.instance.ta(d.a.Dza,document.body,this.w7),V.a.instance.ta(d.a.Fe,document.body,this.w7),this.Plc=!0);fa.preventDefault()};this.L5i=fa=>{this.ELa=this.RBe;fa.preventDefault()};this.$=Ea;this.S3a=Ha.a.instance.IJa(document.body.ownerDocument)}get lineHeight(){return this.emb?this.emb:W.a.kgd}set lineHeight(Ea){this.emb=Ea}get ho(){const {FormulaBar:Ea}=a(872);this.BNc||(this.BNc=Ea.zec(this.$));
return this.BNc}get Ycc(){this.CNc||(this.CNc=document.getElementById(n.a.j5a));return this.CNc}get Cka(){this.DNc||(this.DNc=document.getElementById(n.a.j5a+"_"+n.a.wEc));return this.DNc}get ELa(){return this.Cka.scrollTop}set ELa(Ea){this.RBe=Ea;this.Cka.scrollTop!==Ea&&(this.Cka.scrollTop=Ea)}get QOh(){return 2*this.lineHeight-2}get BSa(){return this.Lke}set BSa(Ea){this.Lke=Ea}WYe(){this.b6=!this.b6;H.DOMElementExtensions.toggleCssClass(this.ho,m.MUe,this.b6);this.b6&&!this.BSa&&(this.BSa=this.QOh);
this.ho.style.height=aa.c+(this.b6?this.BSa:0)+"px";this.Yja.setAttribute(n.a.wu,this.b6?"Collapse the formula bar":"Expand the formula bar");this.$.BBa();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.b6?"expanded":"collapsed"}`)}Klh(Ea){const fa=document.createElement("div");fa.id=this.$.Ib+n.a.u1e;fa.className=m.WAh;this.Yja=ka.Lhh(this.$.Ib,Ea);fa.appendChild(this.Yja);this.sva=ka.jhh(this.$.Ib);fa.appendChild(this.sva);return fa}xmj(){ra.a.instance.ta(d.a.Dp,
this.Yja,this.orc);V.a.instance.ta(d.a.Cf,this.Yja,this.orc);ra.a.instance.ta(d.a.Dp,this.sva,this.krc);V.a.instance.ta(d.a.Cf,this.sva,this.krc)}Amj(){ra.a.instance.ta(d.a.HD,this.Ycc,this.$N);ma.a.addHandler(this.Cka,d.a.scroll,this.onScroll);ma.a.addHandler(this.Cka,d.a.focus,this.L5i);bb.h(this.$).ga.FC(this.Vf)}w4j(){void 0!==this.Yja&&null!==this.Yja&&(ra.a.instance.Ba(d.a.Dp,this.Yja,this.orc),V.a.instance.Ba(d.a.Cf,this.Yja,this.orc));void 0!==this.sva&&null!==this.sva&&(ra.a.instance.Ba(d.a.Dp,
this.sva,this.krc),V.a.instance.Ba(d.a.Cf,this.sva,this.krc));void 0!==this.Ycc&&null!==this.Ycc&&ra.a.instance.Ba(d.a.HD,this.Ycc,this.$N);bb.h(this.$).ga.JI(this.Vf)}Muj(){this.ELa=Math.round(this.W7e(this.ELa))}W7e(Ea){return Math.round(Ea/this.lineHeight)*this.lineHeight}static Lhh(Ea,fa){const Ua=document.createElement("a");Ua.id=Ea+n.a.TOh;Ua.classList.add(m.OAh);H.DOMElementExtensions.Yu(Ua,n.a.rt);Ua.setAttribute(n.a.wu,"Expand the formula bar");fa.Fca(qa.a.dbh,12,12,Ua).classList.add(m.PAh);
return Ua}static jhh(Ea){const fa=document.createElement("div");fa.id=Ea+n.a.ROh;fa.className=m.NAh;return fa}}Object(t.a)(ka,"FormulaBarResizeControl",null,[]);P=a(245);var Xa=a(1175);class sb{}sb.disabled="disabled";sb.ATj="stale";sb.ndj="presentationMode";Object(t.a)(sb,"NameBoxStateUpdateKey",null,[]);class ib extends P.a{constructor(Ea,fa){super(document.createElement("div"));this.qe=null;this.b1j=()=>{this.$.Ia.Izb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.xQa=()=>{var Ua=this.gridView.ga;
const Aa=Ua.qa.V6a()?Ua.qa.y3a:Ua.qa.activeRange;Ua=Aa.isSingle?Ua.qa.activeCell.toString():Aa.r9e();this.aw(Ua)};this.Fj=(Ua,Aa)=>{this.zea(Ua,Aa);this.k1(Ua,Aa)};this.k1=()=>{let Ua=Xa.c(this.$,this.gridView);X.c(Ua,Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7317913_FixFocusLostOnQuerySelection"))||(this.qe&&(Ua=this.$.Hb.getItemByName(this.qe))&&Ua.deactivate(),this.aw(this.gridView.ga.qa.activeCell.toString()))};this.h7=(Ua,Aa)=>{if(Ua=Aa.na){var Ib=Ua.usedRange;2===Ua.type&&(Ib=T.a(Ua));if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6303839_AvoidReselectionWithViewPortJumpForTableSelectorsFixed")){var Pb=
this.gridView.ga.qa.ph;const Fa=this.gridView.inRangePicker||this.gridView.ni;let da=!1;2===Ua.type&&Pb&&!Fa&&(Pb=this.gridView.ga.qa.activeRange,da=Ua.sheetName===this.$.ua.na.name&&!!Pb&&Pb.top===Ib.top&&Pb.left===Ib.left&&Pb.bottom===Ib.bottom&&Pb.right===Ib.right);Ib=ha.v(Ib,this.$),Ib.NamedObjectName=Ua.name,Ib.SheetName=Ua.sheetName,Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7317913_FixFocusLostOnQuerySelection")?this.gridView.Bg(Ib,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",
0,!0,!0,null,Aa.disableAutoFocusOnGrid):this.gridView.Bg(Ib,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged");Aa=X.a(Ua.name);this.aw(Aa.name,Aa.fullName)}}};this.ND=()=>{const Ua=Xa.b(this.gridView);null!=Ua&&this.aw(Ua.name)};this.SHb=(Ua,Aa)=>{this.xQa(Ua,Aa)};this.WKf=()=>{this.tKa(this.$.isEditMode&&this.gridView.Ih.jCb())};this.Wf=()=>{this.tKa(!1)};this.B7=()=>{this.tKa(!0)};this.A7=()=>{this.tKa(!1)};this.Ut=()=>{this.tKa(!this.$.isEditMode)};this.$F=(Ua,Aa)=>
{this.tKa(Aa.iM?!0:!this.$.isEditMode)};this.onKeyDown=Ua=>Ua.Da.keyCode===b.a.zqa?(this.gridView.focus(),!0):!1;this.zea=()=>{this.J2d({[sb.ATj]:!0})};this.$=Ea;this.gridView=bb.h(Ea);this.E2c(fa)&&(this.aw(this.gridView.ga.qa.activeCell.toString()),this.tKa(Ba.a(this.$).iq()||!this.$.isEditMode),this.Mi(),e.KeyInputManager.instance.ta(d.a.fc,this.domElement,this.onKeyDown.bind(this)))}dispose(){this.$&&(this.$.ub.ixc(this.B7.bind(this)),this.$.ub.hxc(this.A7.bind(this)),this.$.ea.qO(this.Ut.bind(this)),
sa.a(this.$).FLb(this.SHb.bind(this)),sa.a(this.$).cxc(this.ND.bind(this)),Ba.a(this.$).ig.Lea(this.$F.bind(this)),Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRangePLTFix",!1)||(this.$.ULb(this.WKf.bind(this)),this.gridView.Ih.km(this.Wf.bind(this))),this.$.Hb&&(this.$.Hb.Gg(this.h7.bind(this)),this.$.Hb.JLb(this.k1.bind(this)),this.$.Hb.JLb(this.cXf.bind(this)),this.$.Hb.g8(this.zea.bind(this)),this.$.Hb.Aoa(this.zea.bind(this)),this.$.Hb.oSa(this.zea.bind(this)),this.$.Hb.ILb(this.zea.bind(this))),
this.$.ua&&this.$.ua.Gg(this.Fj.bind(this)));if(this.gridView){const Ea=this.gridView.ga;Ea.T0(this.k1.bind(this));Ea.jS(this.xQa.bind(this));Ea.Ra.zoa(this.ND.bind(this))}super.dispose()}H6j(Ea){this.J2d({[sb.ndj]:Ea})}E2c(Ea){const fa=document.getElementById(this.$.Ib+n.a.lgd);void 0!==fa&&null!==fa&&Ea.removeChild(fa);appChrome.renderNameBoxUI(this.domElement,this.b1j.bind(this));Ea.insertBefore(this.domElement,Ea.firstChild);return!0}Mi(){this.$.ub.a2b(this.B7.bind(this));this.$.ub.$1b(this.A7.bind(this));
this.$.ea.RP(this.Ut.bind(this));const Ea=this.gridView.ga;this.$.Hb.kg(this.h7.bind(this));this.$.ua.kg(this.Fj.bind(this));Ea.x3(this.k1.bind(this));Ea.qM(this.xQa.bind(this));Ea.Ra.w3(this.ND.bind(this));sa.a(this.$).T1b(this.ND.bind(this));sa.a(this.$).Tpb(this.SHb.bind(this));Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRangePLTFix",!1)||(this.$.gqb(this.WKf.bind(this)),this.gridView.Ih.Bm(this.Wf.bind(this)));Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4696898_DisableFormulaFunctionBoxAndNamedObjectsDropdownDuringPI")&&
Ba.a(this.$).ig.V$(this.$F.bind(this));this.$.Hb.Wpb(this.k1.bind(this));this.$.Hb.Wpb(this.cXf.bind(this));this.$.Hb.TY(this.zea.bind(this));this.$.Hb.Yha(this.zea.bind(this));this.$.Hb.FHa(this.zea.bind(this));this.$.Hb.F_a(this.zea.bind(this))}aw(Ea,fa=""){this.qe=""!==fa?fa:this.qe;appChrome.setNamedObjectOrActiveCellRange(fa,Ea)}tKa(Ea){this.J2d({[sb.disabled]:Ea})}cXf(Ea,fa){Xa.a(this.$,!0);this.zea(Ea,fa)}J2d(Ea){appChrome.updateNameBoxState(Ea)}}Object(t.a)(ib,"NameBox",P.a,[2]);var Ub=a(183);
const hc=m.xCf+" "+m.DQ,yb=m.qDe+" "+m.DQ;class Gb extends R.a{constructor(Ea,fa,Ua,Aa){super();this.tsb=this.tHb=this.PIa=this.pQa=null;this.$H=this.zlc=!1;this.ZXf=()=>{this.gridView.jK.An(this.Ki);this.gridView.jK.Bm(this.Wf);this.zlc=!0};this.Ki=()=>{this.rCb?this.djg(!0):this.Aqc.style.display="flex"};this.Wf=()=>{this.rCb?this.djg(!1):this.Aqc.style.display="none"};this.xJf=Pb=>this.Pqc(!0,`OkCancelEditControl.OnOkClick: ${Pb.Cb}`,ia.HelperMethods.Ko(Pb));this.yJf=Pb=>this.Pqc(!0,`OkCancelEditControl.OnOkKeyDown: ${Pb.Cb}`);
this.IDf=Pb=>this.Pqc(!1,`OkCancelEditControl.OnCancelClick: ${Pb.Cb}`,ia.HelperMethods.Ko(Pb));this.LDf=Pb=>this.Pqc(!1,`OkCancelEditControl.OnCancelKeyDown: ${Pb.Cb}`);this.onPointerDown=()=>{this.gridView.jb&&(this.gridView.Ih.textBox.DF=!0);return!1};const {FormulaBar:Ib}=a(872);this.$=Ua;this.gridView=bb.h(Ua);this.$H=N.a.$H();this.Aqc=Gb.Y3h(Ua);this.rCb=N.a.tN();Aa?(this.pQa=Aa.ila(qa.a.z8g,16),this.PIa=Aa.ila(qa.a.mph,16),this.rCb&&(this.tHb=Aa.ila(qa.a.A8g,16),this.tsb=Aa.ila(qa.a.nph,16),
this.pQa.style.display="none",this.PIa.style.display="none")):(this.pQa=Oa.createClusteredImageFromClusterWithImageClass(16,16,Pa.a.nEh,nb.a.mf(1),null,null,!0,fa.ha(1041)),this.PIa=Oa.createClusteredImageFromClusterWithImageClass(16,16,Pa.a.pEh,nb.a.mf(1),null,null,!0,fa.ha(1042)));this.g7=Ea.w3b(Ib.aEd,Ib.aEd,hc,"","");this.g7.domElement.appendChild(this.pQa);this.U3=Ea.w3b(Ib.E3c,Ib.E3c,yb,"","");this.U3.domElement.appendChild(this.PIa);this.rCb&&(this.g7.domElement.appendChild(this.tHb),this.U3.domElement.appendChild(this.tsb));
this.gridView.cellTextEditBox.An(this.Ki);this.gridView.cellTextEditBox.Bm(this.Wf);za.a.instance.ta(d.a.click,this.g7.domElement,this.xJf);e.KeyInputManager.instance.ta(d.a.fc,this.g7.domElement,this.yJf);cb.a.instance.ta(d.a.pointerDown,this.g7.domElement,this.onPointerDown);za.a.instance.ta(d.a.click,this.U3.domElement,this.IDf);e.KeyInputManager.instance.ta(d.a.fc,this.U3.domElement,this.LDf);cb.a.instance.ta(d.a.pointerDown,this.U3.domElement,this.onPointerDown);this.$H&&this.gridView.wQg(this.ZXf)}dispose(){this.gridView&&
this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.sn(this.Ki),this.gridView.cellTextEditBox.km(this.Wf));this.gridView&&this.$H&&(this.gridView.wpj(this.ZXf),this.zlc&&(this.gridView.jK.sn(this.Ki),this.gridView.jK.km(this.Wf),this.zlc=!1));this.g7&&(za.a.instance.Ba(d.a.click,this.g7.domElement,this.xJf),e.KeyInputManager.instance.Ba(d.a.fc,this.g7.domElement,this.yJf),cb.a.instance.Ba(d.a.pointerDown,this.g7.domElement,this.onPointerDown));this.U3&&(za.a.instance.Ba(d.a.click,this.U3.domElement,
this.IDf),e.KeyInputManager.instance.Ba(d.a.fc,this.U3.domElement,this.LDf),cb.a.instance.Ba(d.a.pointerDown,this.U3.domElement,this.onPointerDown));h.a.Ja(this.g7);this.g7=null;h.a.Ja(this.U3);this.U3=null;H.DOMElementExtensions.Hf(this.PIa);this.PIa=null;H.DOMElementExtensions.Hf(this.pQa);this.pQa=null;this.rCb&&(H.DOMElementExtensions.Hf(this.tsb),this.tsb=null,H.DOMElementExtensions.Hf(this.tHb),this.tHb=null);super.dispose()}Pqc(Ea,fa,Ua=null){const Aa=this.gridView.Ih;if(Ua){const Ib=this.gridView.am?
"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let Pb=void 0;Ga.EwaSettings.W8a&&(Pb=[Object(Ub.a)(this.gridView.cellTextEditBox.textBox.SCa)]);Ub.b(this.$).jDa(Ua.rawEvent,Ib,Pb)}this.zlc&&this.gridView.jK.iF?this.gridView.jK.endEdit(Ea,fa,0):Aa.endEdit(Ea,fa,0);this.gridView.focus();return!0}djg(Ea){const fa=Ea?"block":"none";Ea=Ea?"none":"block";this.pQa.style.display=fa;this.PIa.style.display=fa;this.tHb.style.display=Ea;this.tsb.style.display=Ea}static Y3h(Ea){const {FormulaBar:fa}=
a(872);return document.getElementById(Ea.Ib+fa.wCf)}}Object(t.a)(Gb,"OkCancelEditControl",R.a,[]);var Sa=a(298),db=a(270),fb=a(77),ab=a(197),wb=a(263),kb=a(222),tb=a(296),hb=a(135),Fb=a(173),va=a(46),jb=a(325),Ab=a(248),Qa=a(186),Z;(function(Ea){Ea[Ea.loaded=0]="loaded";Ea[Ea.error=1]="error";Ea[Ea.loading=2]="loading";Ea[Ea.unloaded=3]="unloaded";Ea[Ea.missing=4]="missing"})(Z||(Z={}));Object(t.b)("LoadStatus",Z);a.d(C,"FormulaBar",function(){return wa});class wa extends u.a{constructor(Ea,fa=null){super(bb.h(Ea));
this.lig=null;this.nCd=["nameBox","nameBoxData"];this.vbe=this.Tq=this.clearContentNotifier=this.nameBox=this.dQa=this.ho=null;this.E4d=!1;this.Cka=null;this.gnf=this.Tvf=this.Uzb=!1;this.Ki=()=>{this.fkc&&(this.E4d=!1);this.DUd()};this.Wf=()=>{this.DUd();this.zb||this.eFe()};this.OMf=()=>{this.jb||this.textBox.disabled||this.startEdit(!0,!1,null)};this.Tn=()=>{this.hCa()};this.$F=(Aa,Ib)=>{this.hCa();wa.kwa&&(Ib.iM?wa.kwa.classList.add(m.xBe):this.P_c())};this.Su=(Aa,Ib)=>{Aa=this.grid;this.fkc&&
(this.E4d=!0);this.jb?(this.C8a||(Ib.eCb||this.kE(null),this.raiseEvent(u.a.Bsb,Ib)),this.zb&&this.C8a||(this.zb?Aa.cellTextEditBox.textBox.isCursorAttached()&&!this.textBox.isCursorAttached()&&Aa.cellTextEditBox.textBox.clearCursorFormatLocation():this.zb||this.Nhb())):Aa.jb&&this.hCa()};this.xf=(Aa,Ib)=>{(Aa=this.grid.ga.qa.activeCell)&&(Ib=this.grid.hC(Ib.hd.hash))&&Aa.xd(Ib.Ge)&&this.hCa()};this.iGd=(Aa,Ib)=>{-185374993===Ib.command&&(c.ULS.sendTraceTag(537161939,0,50,"FormulaBar: OnPasteCSERendered updated instantaneously"),
this.hCa())};this.he=()=>{this.hCa();ca.TaskExtensions.za(O.a(this.$.da),()=>{this.K8f()},this.ka,11)};this.Lda=()=>{this.K8f();va.PageLoadTrackingInfo.instance.U0(n.a.Bka,["formulaButton","textbox","textboxData"]);va.PageLoadTrackingInfo.instance.iX(n.a.Bka,["formulaButton","textbox","textboxData"]);va.PageLoadTrackingInfo.instance.hX(n.a.Bka,["formulaButton"])};this.onKeyDown=Aa=>{if(!this.zb){var Ib=this.$.shortcutKeyManager.Kt(Aa.Da);this.hSf(Aa.Da,Ib)}if(Aa.Da.keyCode===b.a.Xy){var Pb=this.Gwa();
Ib=H.DOMElementExtensions.Pl(Pb);Pb=H.DOMElementExtensions.mB(Pb);return H.DOMElementExtensions.eCa(Aa.Da,Ib,Pb)}return!1};this.WN=()=>{this.P_c()};this.lBb=()=>{this.ho?(this.nameBox=new ib(this.$,this.ho),this.Z0f()):this.tPd()};this.Zmi=(Aa,Ib,Pb,Fa,da)=>{this.ho?(this.dQa=new pa(Aa,Ib,Pb,Fa,da),this.Z0f()):this.tPd()};fa||c.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");N.a.tN()?(this.vbe=new ka(Ea),this.initialize(this.WTd(Ea,fa)),this.DLa.xmj()):(this.initialize(wa.GFj(Ea)),
this.ho=wa.zec(Ea));if(f.AFrameworkApplication.sa.Pa.tf){var Ua=document.getElementById("AdditionalBarsRegion");Ua&&(Ua.style.height="")}this.Kui()&&H.DOMElementExtensions.getElementById(this.ho,n.a.j5a).classList.add(m.QAh);this.esd=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.NC=new Sa.a(this.ho,1);this.yOa=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1);this.Jui=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");
this.Iui=N.a.ZV(this.$);this.I9a=this.aI&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",!1);this.fkc=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarTabbingBehaviorChangeXLO",!1);this.gnf=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7367969_formulaEditingLogLoadedFontStatus");this.wic=new G(Ea);this.wic.w3b(n.a.bjg,n.a.bjg,n.a.$Zj+" cui-TabRowRight",G.v3g,G.x3g);this.s1e=new La(this.wic,la.a.instance,Ea,fa);this.hTi=new Gb(this.wic,la.a.instance,
Ea,fa);this.lig=Ab.b(()=>{this.j$f()},1,this.$.ka,"FormulaBar.setTextBoxForActiveItem",!0);Ea.ua.kg(this.he);Ua=this.grid;Ua.cellTextEditBox.An(this.Ki);Ua.cellTextEditBox.Bm(this.Wf);Ua.cellTextEditBox.C_a(this.Su);Ua.OE(this.Tn);Ua.Ca.uu(this.xf);Ua.Ca.R$(this.xf);Ua.due(this.iGd);Ba.a(Ea).ig.V$(this.$F);Ea.ea.u3(this.WN);sa.a(Ea).T1b(this.Tn);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&Ea.da.kb(313,Aa=>{this.clearContentNotifier=Aa;this.clearContentNotifier.Tse(this.Su)});
e.KeyInputManager.instance.ta(d.a.fc,this.rc,this.onKeyDown);Ua=this.textBox.style;wb.c(Ua,Ea.isChromeRtl,"0px");Ua.textAlign=this.Ojf?"right":"left";this.isVisible=!1;this.esd&&(this.textBox.isVisible=!1);D.a(this.$).GHa(this.Lda);this.$.ea.bma&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.Lda(null,null));this.hCa();this.P_c();this.textBox.kbg=!0;this.hni(Ea,fa);z.a(Ea).ti(this);this.textBox.ote(this.OMf);this.C8a=
!1;this.Tq=new ya(this.$,this);N.a.Ylf()&&this.Fli();this.textBox.hQ(()=>{va.PageLoadTrackingInfo.instance.hX(n.a.Bka,["textbox","textboxData"]);this.toggleEditingEvents(!1)})}set text(Ea){this.zb&&this.jb?this.textBox.setPlainText(Ea):super.text=Ea}get jb(){return super.jb}set jb(Ea){super.jb=Ea;this.toggleEditingEvents(Ea)}get mQb(){return!0}get formattedText(){return this.zb?this.textBox.getFormattedText():super.formattedText}set formattedText(Ea){this.zb?this.textBox.setFormattedText(Ea):super.formattedText=
Ea}get p8a(){return this.jb}get isVisible(){return H.DOMElementExtensions.isVisible(this.ho)}set isVisible(Ea){this.esd?H.DOMElementExtensions.setVisible(this.ho,Ea):(H.DOMElementExtensions.setVisible(this.ho,Ea),this.textBox.isVisible=Ea)}get rc(){return this.ho}get Qf(){return this.isVisible}get je(){return I.a.jgd}get DLa(){return this.vbe}pg(Ea,fa){Ea=!1;fa||(Ea=this.bOh());return Ea}dispose(){const Ea=this.$;if(Ea){Ea.ua.Gg(this.he);var fa=this.grid;fa.cellTextEditBox.sn(this.Ki);fa.cellTextEditBox.km(this.Wf);
fa.cellTextEditBox.Odb(this.Su);fa.hG(this.Tn);fa.Ca.Ls(this.xf);fa.Ca.nSa(this.xf);Ba.a(this.$).ig.Lea(this.$F);Ea.ea.d8(this.WN);sa.a(Ea).cxc(this.Tn);fa=D.a(this.$);e.KeyInputManager.instance.Ba(d.a.fc,this.rc,this.onKeyDown);N.a.tN()&&this.DLa.w4j();fa&&fa.pSa(this.Lda);z.a(Ea).gA(this);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.YNd(this.Su),Ea.da.TU(313))}this.textBox&&this.textBox.YZf(this.OMf);
this.yOa&&this.nameBox&&this.$.ea.rn(this.lBb);h.a.wc([this.NC,this.s1e,this.hTi,this.wic,this.dQa,this.nameBox]);h.a.Ja(this.Tq);this.ho&&(H.DOMElementExtensions.cF(this.ho),this.ho.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.ho=null;super.dispose()}endEdit(Ea,fa,Ua,Aa=null){this.textBox.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:Ea,["Caller"]:fa});this.ICa(!1);if(this.jb){var Ib=null;this.fkc&&Aa&&(Ib=this.$.shortcutKeyManager.Kt(Aa));
if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")){var Pb=this.grid.cellTextEditBox.textBox.domElement;c.ULS.sendTraceTag(537161945,0,50,`FormulaBar.EndEdit: gridKeyboardHandler is: ${Pb.id}, parent is: ${Pb.parentNode?Pb.parentNode.id:"null"}`)}Pb=this.grid.hc;this.zb||this.textBox.clear("FormulaBar.EndEdit");this.jb=!1;this.XE(!0);this.Eya()&&this.grid.hs&&this.grid.hs.hwa&&this.grid.hs.Web(n.a.VAb);if(Ea){var Fa=new y.a(this.grid.ga.qa.activeCell,
Pb.text,Pb.text,!1,this.grid.$.ua.na);this.oUf(Fa);null!==Fa&&(Pb.text=Fa.newValue)}else this.textBox.setPlainText(this.text);Fa=new A.a(this.grid.ga.qa.activeCell,Pb.text,Ea);this.dLd(Fa);Pb.endEdit(Ea,`${fa}->FormulaBar.EndEdit`,Ua,Aa);this.Xpf(Ib)||Pb.textBox.focus();this.textBox.Egb("FormulaBar.EndEdit")}else this.textBox.Egb("FormulaBar.EndEdit",{["IsEditing"]:"false"})}g5(Ea,fa,Ua,Aa=!0,Ib=!0){super.g5(Ea,fa,Ua,Aa,Ib);this.zb&&this.grid.hc.g5(Ea,fa,Ua,Aa,Ib)}jSf(Ea){if(this.zb){const fa=this.grid.hc,
Ua=this.textBox.selection;Ua.length&&fa.g5(Ua.index,Ua.length,Ea,!1,!1)}}Gh(Ea){return H.DOMElementExtensions.Mf(this.ho,Ea)}Bj(){f.AFrameworkApplication.sa.We.zk(this.je)}hk(){}rng(Ea){this.yOa?this.nameBox.H6j(Ea):this.dQa.K6j(Ea);this.s1e.J6j(Ea)}zog(){if(this.Cka){var Ea=Object(Qa.g)(this.text);this.Uzb!==Ea&&(this.k$f(Ea),this.Uzb=Ea)}}wHb(){this.textBox.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const Ea=this.grid.hc;if(this.zb){if(!Ea.jb||!this.jb)return;Ea.formattedText=
this.formattedText}else Ea.text=this.text;Ea.setCaretPosition(this.textBox.caretPosition)}EIb(Ea){this.textBox.disabled||(this.grid.cellTextEditBox.textBox.DF=!0,this.zb&&this.jb||this.startEdit(!1,!0,Ea),this.jZ())}OQa(Ea){this.zb?(this.iL&&(this.eM=this.textBox.caretPosition,this.DT=this.textBox.xS.length),this.aI&&this.kE(null)):super.OQa(Ea);this.Qea();this.dlg()}Qna(Ea){var fa=this.$.shortcutKeyManager.Kt(Ea);const Ua=this.zb&&this.C8a;1872288872===fa||125627505===fa||267796030===fa?this.Iui?
super.Qna(Ea):fb.g(Ea):Ua?fb.g(Ea):this.jb&&this.grid.hc.jb&&(fa=this.grid.hc,this.zb?fa.formattedText=this.formattedText:fa.text=this.text,fa.setCaretPosition(this.textBox.caretPosition),this.oGc(),this.I9a&&0===this.textBox.selection.length&&this.kE(null,null),this.Jui&&this.inRangePicker&&this.CYd(),super.Qna(Ea))}$c(Ea,fa){this.jb&&super.$c(Ea,fa)}Lr(Ea,fa){this.jb&&super.Lr(Ea,fa)}Fli(){const Ea=this.grid.Ob(void 0);Ea?(this.Uzb=Ea.oB||Object(Qa.g)(Ea.text),this.k$f(this.Uzb)):c.ULS.sendTraceTag(509720320,
0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}k$f(Ea){H.DOMElementExtensions.toggleCssClass(this.Cka,m.UAh,Ea);this.gnf&&!this.Tvf&&this.Uzb&&(this.Tvf=!0,this.iIi())}iIi(){setTimeout(()=>{const Ea=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(["Consolas","Monaco","Menlo","Courier New","monospace"]);let fa="FormulaBar: Formula fonts load status: ";for(const Ua of Ea)fa+=`${Ua.font}: ${Z[Ua.status]}; `;c.ULS.sendTraceTag(509642332,0,50,fa)},2E3)}WTd(Ea,fa){this.ho=wa.zec(Ea);
this.ho.classList.add(m.NUe);this.ho.classList.add(m.OUe);const Ua=this.DLa.Klh(fa);fa=wa.i8b(this.zb,!0);Ua.appendChild(fa);wa.kwa=wa.CKe(Ea.Ib);const Aa=wa.yKe(),Ib=wa.gLe(Ea.Ib),Pb=wa.fLe(Ea.Ib),Fa=wa.ZJe(Ea.Ib);Pb.tabIndex=-1;Fa.tabIndex=-1;Ib.appendChild(Fa);Ib.appendChild(Pb);Ib.appendChild(wa.kwa);Aa.appendChild(Ib);Aa.appendChild(Ua);Ea=wa.YKe(Ea.Ib);this.ho.appendChild(Ea);this.ho.appendChild(Aa);const da=new tb.a(fa,this.zb,!1);this.Cka=fa;this.DLa.lineHeight=da.H_h();da.hQ(()=>{jb.c(da.Ke,
r.a.ariaLabel,"formula bar")});da.hQ(()=>{this.DLa.Amj()});da.isVisible=!1;return da}NQa(Ea){this.lvc(Ea);super.NQa(Ea);hb.b(this.$).rd(B.a.XOh,{["Location"]:"canvas"});l.a.Xg&&window.focus();const fa=this.$.shortcutKeyManager.Kt(Ea);this.zb&&this.hSf(Ea,fa);this.textBox.disabled||this.zb&&this.jb||this.startEdit(!0,!1,Ea);let Ua;Ua={};Ua.wasEditing=this.jb;Ua.formulaBar=!0;let Aa=this.ai(Ea,fa);!Aa&&ab.d(fa,this.Q8a,!0)&&(Aa=this.Xpf(fa)?!0:this.grid.ga.ai(Ea,fa,Ua));Aa||Fb.a(this.$).zzd(Ea,0,7)}startEdit(Ea,
fa,Ua){const Aa=this.grid;if(!this.jb||!Aa.jb){this.textBox.Egb("FormulaBar.StartEdit");this.textBox.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:Ea,["IsOnMouseDown"]:fa});hb.b(Aa.$).rd(B.a.VOh,{["Location"]:"canvas"});this.jb=this.C8a=!0;Aa.fr&&Aa.fr.aAc(this);Aa.cellTextEditBox.XE(!1);Aa.cellTextEditBox.WPd();this.E9f(!1);if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")){const Pb=this.grid.cellTextEditBox.textBox.domElement;
c.ULS.sendTraceTag(537161940,0,50,`FormulaBar.StartEdit: gridKeyboardHandler is: ${Pb.id}, parent is: ${Pb.parentNode?Pb.parentNode.id:"null"}`)}var Ib=()=>{var Pb=Aa.$.ua.na;const Fa=Aa.Ob(null);Pb=new F.a(Fa,Pb,void 0,void 0,void 0,this.Mjd(Fa));this.eLd(Pb);this.zb&&this.hAc(Aa.cellTextEditBox.textBox.kF);!this.zb&&Fa&&Fa.XWd&&(this.text="");this.zb?(window.setTimeout(()=>{if(this.jb&&Aa.jb){Aa.jb&&Aa.cellTextEditBox.textBox.detachCursorFormat();if(!this.kE(null)){const K=Aa.cellTextEditBox.formattedText;
var da=this.textBox.caretPosition;const xa=K.Text.length;da=this.textBox.text.length!==xa?xa:da;this.formattedText=K;this.textBox.caretPosition=da}this.C8a=!1;this.textBox.clearHistory()}else this.jb=!1},0),Aa.cellTextEditBox.bQd()):(fa||(this.Nhb(),this.kE(null)),Aa.cellTextEditBox.bQd(),this.C8a=!1)};if(Aa.jb)Aa.nF=1,Ib();else if(this.textBox.DF=!0,ca.TaskExtensions.za(Aa.startEdit(!1,1,Ua,!1,void 0,fa,1),Pb=>{Pb.result?(Aa.jb||(this.textBox.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),
c.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.jb&&Aa.jb?(Aa.cellTextEditBox.textBox.DF=!0,Pb=Aa.Ob(null),this.textBox.U0e(Number.NaN,this.Mjd(Pb)),Ea&&this.textBox.setCaretPositionToEnd(),Ib()):this.jb=!1):this.jb=!1},this.ka,11),this.textBox.DF=!1,Ua=Aa.Ob(null),null===Ua||void 0===Ua?0:Ua.wtd)this.textBox.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=ia.HelperMethods.ggg(this.text)}}Vf(Ea,
fa){super.Vf(Ea,fa);this.DUd()}OTa(Ea){Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&c.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!Ea}`);super.OTa(Ea)}DUd(){const Ea=this.grid;Ea.jb&&2===Ea.nF||this.hCa()}Ze(){var Ea=this.grid;this.jb&&Ea.jb&&(Ea=Ea.hc,Ea.text=this.text,Ea.setCaretPosition(this.textBox.caretPosition),this.inRangePicker&&this.textBox.focus())}hCa(){this.zb?this.lig():
this.j$f()}j$f(){if(this.textBox){var Ea=this.grid;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.jb,["TextBox.Initialized"]:this.textBox.initialized,["Grid.IsEditing"]:Ea.jb});if(!this.jb){var fa=Ba.a(this.$).iq();this.ho.disabled=fa||!this.$.isEditMode;var Ua=(fa=this.$.xZ===Ea)&&1===Ea.ga.Se;this.textBox.initialized&&(this.textBox.disabled=this.ho.disabled||fa&&!Ua);fa=new kb.a(this.textBox.style);var Aa=!1;if(Ua)if(Ea.jb)this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",
{["ActiveCellContents"]:"CellTextEditBox.Text"}),Ua=Ea.cellTextEditBox.text;else{Aa=Ea.Ob(null);Ua=new U.a(this.$.ua);if(!Aa||!Ua.FDb(Aa.range,Ea))return;Ea=Ua.di;Ua=Aa.oi;var Ib=Aa.formulaBarText;const Pb=Aa.text;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:Ea,["activeCell.IsHidden"]:Ua,["activeCell.FormulaBarText"]:!!Ib,["activeCell.Text"]:!!Pb});Ua=Ea&&Ua?"":Ib||Pb;Aa=Aa.XWd}else Ua="",Ib=Ea.ga.Ra.oc,Ib=(null===
Ib||void 0===Ib?0:Ib.floatingObject)?Ib.floatingObject.Gb:null,64===Ea.ga.Se&&Ib&&Ib.IsShapeFormulaPresent&&((Ea=(Ea=Ib.ShapeText)?Ea.substring(Ea.indexOf("\nFormula:")+9,Ea.indexOf(";FormulaVal:")):null)?(this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),Ua="="+Ea):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));
this.E9f(Aa);this.uWb=this.p3c();fa.aC.direction=this.j8a?w.a.rtl:w.a.J$a;fa.aC.textAlign=this.j8a?w.a.right:w.a.left;fa.y3();this.text=Ua}}}K8f(){var Ea=this.$.xZ;if(this.esd){const fa=!!this.grid.jK&&this.grid.jK.iF;this.isVisible=Ea=!!Ea&&this.$.mgd&&!this.$.ea.nc.inEmbedView;fa||(this.textBox.isVisible=Ea)}else this.isVisible=!!Ea&&this.$.mgd&&!this.$.ea.nc.inEmbedView;this.$.qB(n.a.NPb);this.$.MI()}E9f(Ea){H.DOMElementExtensions.toggleCssClass(this.textBox.domElement,m.SAh,Ea)}Gwa(){return this.ho.querySelectorAll(H.DOMElementExtensions.Uq+
", div[tabindex]")}Pl(){return H.DOMElementExtensions.Pl(this.Gwa())}bOh(){const Ea=this.Pl();return Ea?(H.DOMElementExtensions.setFocus(Ea),!0):!1}hSf(Ea,fa){fa=-287251124===fa||-1925065947===fa||1764140053===fa;db.a.QOa()&&fa&&Ea.preventDefault()}P_c(){wa.kwa&&H.DOMElementExtensions.toggleCssClass(wa.kwa,m.xBe,!this.$.isEditMode)}hAc(Ea){this.zb&&(this.textBox.kF=Ea)}Kui(){return this.zb&&!N.a.tN()}toggleEditingEvents(Ea){this.textBox.toggleEditingEvents(Ea)}hni(Ea,fa=null){this.ho?this.yOa?Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InitNameBoxEagerly",
!1)?this.lBb():Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7134788_FixingNameBoxReliabliity")?this.$.ea.Bf?this.lBb():this.$.ea.mk(this.lBb):this.$.ea.mk(this.lBb):Ea.da.kb(53,Ua=>{ca.TaskExtensions.za(M.GetServiceTaskFactory.create(Ea.da,102,this.ka,1),Aa=>{this.Zmi(Ea,Ua,Aa.result,this.ho,fa)},this.ka)}):this.tPd()}Z0f(){va.PageLoadTrackingInfo.instance.U0(n.a.Bka,this.nCd);va.PageLoadTrackingInfo.instance.iX(n.a.Bka,this.nCd);va.PageLoadTrackingInfo.instance.hX(n.a.Bka,this.nCd)}tPd(){c.ULS.sendTraceTag(537161947,
0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}Xpf(Ea){return this.fkc&&!this.E4d&&(125627505===Ea||706199415===Ea)}get text(){return super.text}static zec(Ea){return document.getElementById(Ea.Ib+n.a.o3a)}static GFj(Ea){const fa=Ga.EwaSettings.zb(),Ua=wa.zec(Ea);Ua.classList.add(m.NUe);wa.kwa=wa.CKe(Ea.Ib);const Aa=wa.i8b(fa,!0),Ib=wa.yKe();Ib.appendChild(wa.kwa);Ib.appendChild(Aa);const Pb=wa.gLe(Ea.Ib),Fa=wa.fLe(Ea.Ib),da=wa.ZJe(Ea.Ib);Pb.appendChild(Fa);Pb.appendChild(da);
Ib.appendChild(Pb);Ea=wa.YKe(Ea.Ib);Ua.appendChild(Ea);Ua.appendChild(Ib);const K=new tb.a(Aa,fa,!1);K.hQ(()=>{jb.c(K.Ke,r.a.ariaLabel,"formula bar")});K.isVisible=!1;return K}static yKe(){const Ea=document.createElement("div");Ea.className=m.MAh;Ea.classList.add(m.DQ);return Ea}static gLe(Ea){const fa=document.createElement("div");fa.id=Ea+wa.wCf;fa.className=m.Aqc;fa.classList.add(m.DQ);return fa}static i8b(Ea,fa){const Ua=db.a.QOa(),Aa=document.createElement(Ua?"div":"textarea");Aa.className=m.TAh;
fa&&Ea&&Aa.classList.add(m.VAh);Ea?Aa.classList.add(m.iRi):(Aa.setAttribute(x.a.autoCorrect,v.a.off),Aa.setAttribute(x.a.wrap,v.a.virtual),Aa.setAttribute(x.a.spellcheck,v.a.Bqa),H.DOMElementExtensions.Yu(Aa,n.a.x0a),Aa.tabIndex=0);Ua?(Aa.id=n.a.j5a,Ea||Aa.setAttribute(x.a.contentEditable,v.a.$3d)):(Aa.cols=20,Aa.rows=2);return Aa}static CKe(Ea){const fa=document.createElement("div");fa.id=Ea+n.a.igd;fa.className=m.S1e;H.DOMElementExtensions.Yu(fa,n.a.rt);fa.setAttribute(n.a.wu,"insert function");
fa.tabIndex=0;fa.classList.add(m.DQ);return fa}static fLe(Ea){const fa=document.createElement("div");fa.id=Ea+wa.aEd;fa.className=m.xCf;H.DOMElementExtensions.Yu(fa,n.a.rt);fa.setAttribute(n.a.wu,"commit edit");fa.tabIndex=0;fa.classList.add(m.DQ);return fa}static ZJe(Ea){const fa=document.createElement("div");fa.id=Ea+wa.E3c;fa.className=m.qDe;H.DOMElementExtensions.Yu(fa,n.a.rt);fa.setAttribute(n.a.wu,"cancel edit");fa.tabIndex=0;fa.classList.add(m.DQ);return fa}static YKe(Ea){const fa=document.createElement("div");
fa.id=Ea+n.a.lgd;fa.className=m.RAh;return fa}}wa.wCf="okCancelButtonContainer";wa.aEd="okboxButton";wa.E3c="cancelboxButton";wa.kwa=null;Object(t.a)(wa,"FormulaBar",u.a,[36])},886:function(t,C,a){var c=a(73);t=a(0);class b{constructor(){this.Ffb=!1;this.fullName=this.name=this.scope=null}}Object(t.a)(b,"NamedObjectDetails",null,[]);var f=a(184),e=a(125),d=a(23);a.d(C,"b",function(){return h});a.d(C,"a",function(){return r});a.d(C,"c",function(){return l});const h=(u,v,x,w=!1)=>{for(let m=0,n=u.count;m<
n;m++){const z=u.getItem(m),y=2===z.type?f.a(z):z.usedRange,A=w&&2===z.type?z.usedRange:null;if((y.equals(v)||v.equals(A))&&z.sheetName===x)return z}return null},r=u=>{const v=new b;v.fullName=u;u=e.c(u.split(RegExp("[!']")),x=>!d.a.equals(x,"",!0));2===u.length?(v.Ffb=!0,v.scope=u[0],v.name=u[1]):(v.Ffb=!1,v.scope="",v.name=u[0]);return v},l=(u,v=!1)=>u&&c.h(u)?(u.activate(v),!0):!1}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.vrd.js.map/a4e4b27a957e21105557d7d8a3d290e4/EwaDSOpt.vrd.js.map
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1079:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.uIc="b-ring_Apc_Trans";c.ssg="cdn_static_resource_ewa_image";Object(t.a)(c,"ResourceHosts",null,[])},1080:function(t,C,a){a.d(C,"a",function(){return f});t=a(0);var c=a(59),b=a(1347);class f{static Vgd(e,d,h,r=null){f.Wpc||(f.Wpc=Array.isArray(c.a.ri(h.xa.NetworkMeasurementUrlList))?c.a.ri(h.xa.NetworkMeasurementUrlList):null);const l=[];
for(let u=0;u<f.Wpc.length;u++){const v=f.Wpc[u];let x=v.key;x||(x=v.Key);if(r&&!r.includes(x))continue;let w=v.value;w||(w=v.Value);x&&w&&l.push(new b.a(h,x,w,e,d))}return l}}f.Wpc=null;Object(t.a)(f,"NetworkConnectionHelpers",null,[])},1082:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1083:function(t,C,a){a.d(C,"a",function(){return e});t=a(0);var c=a(14),b=a(43),f=a(83);a=a(731);class e extends a.a{constructor(d,h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=e.nza;this.rxa=!0}get linkText(){return e.hxf}Kna(d){super.Kna(d);b.a.openWindow(4,f.a.NH(e.gxf))}LD(d){super.LD(d);e.cAd&&e.cAd(null)}static initialize(d,h,r,l){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
e.nza=d;e.hxf=h;e.gxf=r;e.cAd=l}}e.nza=null;e.hxf=null;e.gxf=null;e.cAd=null;Object(t.a)(e,"WacGdprNoticeBusinessBarEntry",a.a,[])},1084:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.Eyh="ewa-bb";c.Fyh="ewa-bb-entry";c.Gyh="ewa-bb-react";c.XTe="ewa-bb-entry-body";c.cUe="ewa-bb-icon";c.ZTe="ewa-bb-entry-icon";c.bUe="ewa-bb-entry-title";c.aUe="ewa-bb-entry-message";c.Lac="ewa-bb-entry-button";c.$Te="ewa-bb-entry-link";c.YTe="ewa-bb-entry-close";c.Mac="ewa-bb-entry-button-holder";
c.WTe="ewa-bb-content";Object(t.a)(c,"CssClassNames",null,[])},1085:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(731);class c extends a.a{constructor(b,f){super(b,f);this.Ir=!0;this.title=c.d2;this.message=c.c2}get actionButton(){return c.b2}pn(b){super.pn(b);(b=c.Mqa)&&b(null)}static initialize(b,f,e,d){c.d2=b;c.c2=f;c.b2=e;c.Mqa=d}}c.d2=null;c.c2=null;c.b2=null;c.Mqa=null;Object(t.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1086:function(t,C,a){a.d(C,"a",function(){return c});
t=a(0);a=a(731);class c extends a.a{constructor(b,f){super(b,f);this.Ir=!0;this.title=c.d2;this.message=c.c2}get actionButton(){return c.b2}pn(b){super.pn(b);(b=c.Mqa)&&b(null)}static initialize(b,f,e,d){c.d2=b;c.c2=f;c.b2=e;c.Mqa=d}}c.d2=null;c.c2=null;c.b2=null;c.Mqa=null;Object(t.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1087:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(863);class c extends a.a{constructor(b,f,e){super(b,f,e);this.Ir=!0;this.title=c.d2;this.message=
c.c2}get actionButton(){return c.b2}static initialize(b,f,e){c.d2=b;c.c2=f;c.b2=e}}c.d2=null;c.c2=null;c.b2=null;Object(t.a)(c,"DataCleansingBusinessBarEntry",a.a,[])},1088:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(731);class c extends a.a{constructor(b,f){super(b,f);this.Ir=!0;this.title=c.d2;this.message=c.c2}get actionButton(){return c.b2}pn(b){super.pn(b);(b=c.Mqa)&&b(null)}static initialize(b,f,e,d){c.d2=b;c.c2=f;c.b2=e;c.Mqa=d}}c.d2=null;c.c2=null;c.b2=null;c.Mqa=null;Object(t.a)(c,
"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1089:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(731);class c extends a.a{constructor(b,f){super(b,f);this.Ir=!0;this.title=c.WFb;this.message=c.nza}get actionButton(){return c.N$a}pn(b){super.pn(b);c.pza&&c.pza(null)}static initialize(b,f,e,d){c.WFb=b;c.nza=f;c.N$a=e;c.pza=d}}c.WFb=null;c.nza=null;c.N$a=null;c.pza=null;Object(t.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1090:function(t,C,a){a.d(C,"a",
function(){return c});t=a(0);a=a(731);class c extends a.a{constructor(b,f){super(b,f);c.N$a&&c.pza&&(this.Ir=!0);this.title=c.WFb;this.message=c.nza}get actionButton(){return c.N$a}pn(b){super.pn(b);c.pza&&c.pza(null)}static initialize(b,f,e,d){c.WFb=b;c.nza=f;c.N$a=e;c.pza=d}}c.WFb=null;c.nza=null;c.N$a=null;c.pza=null;Object(t.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1092:function(t,C,a){a.d(C,"a",function(){return v});t=a(0);C=a(228);var c=a(785),b=a(53),f=a(426),e=a(39),
d=a(721),h=a(109),r=a(157),l=a(41),u=a(70);class v extends C.a{constructor(x){super();this.$=x;this.Mb()}create(){const x=b.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.Na),w=Object(u.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(h.d)(r.a.resolve(l.f,{rb:this.Na})):b.GetServiceTaskFactory.Sa(this.$.da,5,4,this.Na),m=b.GetServiceTaskFactory.Sa(this.$.da,388,387,this.Na),n=Object(h.d)(r.a.resolve(l.F,{rb:this.Na})),z=b.GetServiceTaskFactory.Sa(this.$.da,257,258,this.Na),
y=f.a(this.$);e.TaskExtensions.za(e.TaskExtensions.Pd([x,z,y,w,m,n],this.ka),()=>{this.vb(Object(d.a)(this.$.da,271,()=>new c.ConvertToLinkedEntityManager(this.$,x.result,m.result,z.result,y.result,w.result,n.result)))},this.$.ka,3)}static la(x){x.da.Ha(272,new v(x))}}Object(t.a)(v,"ConvertToLinkedEntityManagerFactory",C.a,[])},1093:function(t,C,a){a.d(C,"a",function(){return c});const c=b=>{const f=Array(b.length);for(let e=0,d=b.length;e<d;e++)f[e]=b[e].cloneNode(!0);return f}},1094:function(t,
C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1098:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1101:function(t,C,a){function c(l,u){this.ID=l;this.type=u}function b(l,u){this.value=l;this.contextId=u}function f(l,u,v,x,w,m,n,z){this.type=l;this.startTime=null==v||void 0==v.value?new b(v,null):v;this.endTime=null==x||void 0==x.value?new b(x,null):x;null!=w&&void 0!=w.value||new b(w,null);null!=m&&void 0!=m.value||new b(m,null);this.operationType=z}function e(l){this.ID=l}function d(){this.gf=[];this.Aqb=[];this.m0c=0;this.duration=this.startTime=null;this.Y$b={};this.bBd=this.HBd=this.N1c=-1}
function h(l){var u;return(null!=document.body.style.msTransform?u=l.style.msTransform:null!=document.body.style.webkitTransform?u=l.style.webkitTransform:null!=document.body.style.mozTransform?u=l.style.ofk:null!=document.body.style.oTransform?u=l.style.rfk:null!=document.body.style.transform&&(u=l.style.transform),u)?(u=u.replace("rotate(",""),u=u.replace("deg)",""),parseFloat(u)):0}a.d(C,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,
3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,.2,1);new c(21,3,.8,0,.2,1);f.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),Nfk:new b(0,null),Tek:new b(0,
null),operationType:0};t=Array(1);t[0]=new b(0,0);new e(0,[new f(5,0,0,0,null,1,1,0)]);new e(1,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,50,null,1,1,0)]);new e(2,[new f(1,3,0,167,null,0,1,1),new f(2,3,0,167,null,0,1,1)]);new e(3,[new f(3,3,0,167,null,0,1,1),new f(4,3,0,167,null,0,1,1)]);new e(4,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,167,null,1,1,0)]);new e(5,[new f(5,2,0,167,null,0,1,0)]);new e(6,[new f(1,3,0,100,null,0,1,1),new f(2,3,0,100,null,0,1,1)]);new e(7,[new f(3,3,0,100,null,0,1,1),new f(4,
3,0,100,null,0,1,1)]);new e(8,[new f(5,2,0,100,null,1,1,0)]);new e(9,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,100,null,1,1,0)]);new e(10,[new f(5,2,0,100,null,0,1,0)]);new e(11,[new f(1,3,0,267,null,0,1,1),new f(2,3,0,267,null,0,1,1)]);new e(12,[new f(3,3,0,267,null,0,1,1),new f(4,3,0,267,null,0,1,1)]);new e(13,[new f(5,2,0,267,null,1,1,0)]);new e(14,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,267,null,1,1,0)]);new e(15,[new f(5,2,0,267,null,0,1,0)]);new e(16,[new f(6,3,0,267,null,0,1,1),new f(7,3,0,267,
null,0,1,1)]);new e(17,[new f(1,3,0,750,null,0,1,1),new f(2,3,0,750,null,0,1,1)]);new e(18,[new f(3,3,0,750,null,0,1,1),new f(4,3,0,750,null,0,1,1)]);new e(19,[new f(5,2,0,750,null,1,1,0)]);new e(20,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,750,null,1,1,0)]);new e(21,[new f(6,3,0,1E3,null,0,1,1),new f(7,3,0,1E3,null,0,1,1)]);new e(22,[new f(1,3,0,367,null,0,1,1),new f(2,3,0,367,null,0,1,1)]);new e(23,[new f(3,3,0,367,null,0,1,1),new f(4,3,0,367,null,0,1,1)]);new e(24,[new f(5,2,0,367,null,1,1,0)]);new e(25,
[new f(5,2,0,0,null,0,2,0),new f(5,2,0,367,null,1,1,0)]);new e(26,[new f(5,2,0,367,null,0,1,0)]);new e(27,[new f(6,2,0,t[0],null,0,1,1),new f(7,2,0,t[0],null,0,1,1)]);new e(28,[new f(5,2,0,0,null,1,1,0),new f(5,2,0,50,null,0,1,0)]);new e(29,[new f(1,3,0,433,null,0,1,1),new f(2,3,0,433,null,0,1,1)]);new e(30,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,50,null,1,1,0),new f(2,3,0,0,null,40,1,1),new f(2,3,0,100,null,0,1,1)]);new e(31,[new f(2,0,0,0,null,32,1,1),new f(2,0,0,100,null,32,1,1),new f(2,3,101,350,
null,0,1,1),new f(3,0,0,0,null,0,2,1),new f(3,0,0,100,null,0,2,1),new f(3,3,101,350,null,0,1,1),new f(5,0,0,0,null,0,2,0),new f(5,0,0,100,null,1,1,0)]);new e(32,[new f(2,3,0,267,null,32,1,1),new f(3,3,0,267,null,0,2,1),new f(5,2,0,0,null,1,0,0),new f(5,2,0,267,null,0,2,0)]);new e(33,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,100,null,0,2,0),new f(5,2,101,267,null,1,1,0)]);new e(34,[new f(1,10,0,300,null,0,1,1),new f(2,10,0,300,null,0,1,1)]);new e(35,[new f(3,10,0,300,null,0,1,1),new f(4,10,0,300,null,
0,1,1)]);new e(36,[new f(1,8,0,750,null,0,1,1),new f(2,8,0,750,null,0,1,1)]);new e(37,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,200,null,0,2,0),new f(5,3,201,500,null,1,1,0)]);new e(38,[new f(1,2,0,0,null,0,2,1),new f(2,2,0,0,null,0,2,1),new f(1,2,0,200,null,0,2,1),new f(2,2,0,200,null,0,2,1),new f(1,3,201,267,null,0,1,1),new f(2,3,201,267,null,0,1,1)]);new e(39,[new f(1,3,0,267,null,0,1,1),new f(2,3,0,267,null,0,1,1)]);new e(40,[new f(5,2,0,0,null,0,2,0),new f(5,2,0,267,null,1,1,0)]);new e(41,[new f(5,
2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(l){window.setTimeout(l,16)}}();d.prototype={gf:null,uVg:5,Aqb:null,m0c:0,startTime:null,duration:null,Y$b:null,N1c:-1,HBd:-1,bBd:-1};d.prototype.Start=function(){this.startTime=new Date;this.Y$b={}};d.prototype.GetRecentAnimationStats=
function(){var l,u=[],v=0;for(l=r.m0c;l<r.uVg;l++)null!=r.Aqb[l]&&(u[v]=r.Aqb[l],v++);for(l=0;l<r.m0c;l++)null!=r.Aqb[l]&&(u[v]=r.Aqb[l],v++);return u};d.prototype.GetAnimationSqmStats=function(){var l=[];return l[0]=0>r.N1c?0:r.N1c,l[1]=0>r.HBd?0:r.HBd,l[2]=0>r.bBd?0:r.bBd,l};var r=new d},1102:function(t,C,a){a.d(C,"a",function(){return b});var c=a(1103);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},1105:function(t,
C,a){a.d(C,"a",function(){return r});t=a(0);var c=a(6);C=a(191);var b=a(163),f=a(10),e=a(61),d=a(53),h=a(39);class r extends C.a{constructor(l){super();this.WN=()=>{this.zqd()};this.Lda=()=>{this.zqd()};this.$=l}dispose(){this.$&&b.a(this.$)&&(b.a(this.$).pSa(this.Lda),this.$.ea.d8(this.WN));this.$=null;super.dispose()}Gth(){c.AFrameworkApplication.h9a()&&!this.zqd()&&(b.a(this.$).GHa(this.Lda),this.$.ea.u3(this.WN))}zqd(){return this.$.isEditMode&&(c.AFrameworkApplication.K3a||e.a.Ag.Ou)?(b.a(this.$).pSa(this.Lda),
h.TaskExtensions.za(d.GetServiceTaskFactory.create(this.$.da,119,this.ka,1),l=>{l.result.initialize()},this.ka,3),!0):!1}static main(){f.a.Fa(l=>{(new r(l)).Gth()})}}Object(t.a)(r,"FileOpSliceDownloaderBootStraper",C.a,[])},1189:function(t,C,a){t=a(0);var c=a(88),b=a(561),f=a(14),e=a(143);class d{constructor(W,aa,ia){this.dXd=this.eXd=this.fXd=!1;this.sXd=!W&&!aa;this.tXd=!W&&!ia;this.sXd||this.tXd||(this.fXd=!W,this.eXd=!aa,this.dXd=!ia)}}Object(t.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends e.StandardDialog{constructor(W,
aa,ia,ka,Xa){super();this.A_d=[];this.D2=new d(W,aa,ia);this.eta=ka;this.Vra=Xa;this.ye="RenameDisabledDialog";this.Xb=0;this.yc(1,CommonUIStrings.l_DialogClose);this.iIj();this.Yrj()}iIj(){this.D2.sXd?this.BPb(this.eta?this.Vra?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.D2.tXd?this.BPb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.wNg();this.pta(this.A_d)}BPb(W){Array.add(this.A_d,
W)}wNg(){const W=[];this.D2.fXd||Array.add(W,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.D2.eXd||Array.add(W,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.D2.dXd||Array.add(W,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<W.length&&Array.add(this.A_d,W)}}Object(t.a)(h,"ReactRenameDisabledDialogBase",e.StandardDialog,[]);class r extends h{constructor(W,aa,ia,ka,Xa){super(W,aa,ia,ka,Xa)}Yrj(){this.mGb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}
Object(t.a)(r,"ReactRenameDisabledDialog",h,[]);var l=a(160);class u{static get dg(){return l.a.Wp(u.vl,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}u.vl="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(t.a)(u,"RenameDisabledDialogHtml",null,[]);class v extends l.a{constructor(W,aa,ia,ka,Xa){super();this.D2=new d(W,aa,ia);this.eta=ka;this.Vra=Xa;this.ye="RenameDisabledDialog";this.Xb=0;this.yc(1,CommonUIStrings.l_DialogClose);this.dg=u.dg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.xX("RenameRow")}bbb(){if(this.D2.sXd){let W;W=this.eta?this.Vra?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;
v.BPb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),W)}else this.D2.tXd?v.BPb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.gii()}gii(){this.D2.fXd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.D2.eXd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.D2.dXd&&
(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static BPb(W,aa,ia){W.style.display="none";aa.innerText=ia}}Object(t.a)(v,"RenameDisabledDialog",l.a,[]);var x=a(6),w=a(34),m=a(112),n=a(26);class z{constructor(W,aa){this.WFa=0;this.La=W;this.P9=aa}initialize(W){if(!this.La||!this.P9)return!1;this.WFa=W;this.Pg();return!0}Pg(){this.La.Wb(n.a.aja,m.a.frame,Object(c.a)(this,this.aja,"commitNewDocumentTitle"))}aja(W,aa,ia,ka,Xa){if(1===ia)return this.La.processAction(n.a.renameFile,
1);W=w.a.Zp(this.P9.Bn);Xa=(0,Xa.getNewDocumentTitle)();Xa.length>this.WFa&&(Xa=Xa.substr(0,this.WFa));if(32!==this.La.ie(n.a.renameFile,2,Xa))return this.QX(W),8;this.QX(Xa);return 32}QX(W){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(W))}static Rjd(){return new z(x.AFrameworkApplication.xb,x.AFrameworkApplication.Fm)}}Object(t.a)(z,"ReactRenameUIHandler",null,[375]);var y=a(96),A=a(529),F=a(563),D=a(16),B=a(114),M=a(246),R=a(93),P=a(43),E=a(29),H=a(84);class G{constructor(W,aa,ia,
ka,Xa,sb,ib,Ub,hc,yb,Gb,Sa){this._initialized=!1;this._element=null;this.WFa=0;this.qVc=this.NOc=!1;this.La=W;this.gKc=aa;this.oe=ia;this.MA=ka;this.P9=Xa;this.Dle=sb;this.sZb=ib;this.$Kc=Ub;this.c$=hc;this.eee=yb;this.gYa=Gb;this.JPc=Sa}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(W,aa,ia){if(!(this.La&&this.P9&&this.Dle&&this.sZb&&this.$Kc&&aa)||0>=W)return!1;this._element=aa;this._element.title=ia;this._element.setAttribute(R.a.Kd,R.a.rt);this._element.setAttribute("Unselectable",
"on");this.WFa=W;this.au();return this._initialized=!0}au(){this.gKc&&(this.gKc.ta(D.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.gKc.ta(D.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.oe.ta(D.a.fc,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.MA.ta(D.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.MA.ta(D.a.og,this._element,Object(c.a)(this,this.qh,"onPointerUp"))}onBlur(){this.isActive&&!this.NOc&&
(this.eee||this.$Kc(this._element),this.vHe(),this.k$c(!1));return this.NOc=!1}onPaste(){f.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(W){return this.isActive?this.B0i(W):this.C0i(W)}B0i(W){let aa=!1;switch(W.Da.keyCode){case Sys.UI.Key.enter:this.vHe();this.k$c(this.gYa||this.JPc);aa=!0;break;case Sys.UI.Key.tab:this.eee&&this.$Kc(this._element);break;case Sys.UI.Key.esc:this.BQd(),this.k$c(this.gYa||this.JPc),aa=!0}return aa}C0i(W){let aa=!1;
switch(W.Da.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.ikg(this.JPc),this.isActive&&this.sZb(this._element),aa=!0}return aa}onPointerDown(){this.isActive||(this.ikg(!1),this.isActive&&(this._element.focus(),this.sZb(this._element),this.qVc=!0));return!1}qh(){return this.qVc?(this.sZb(this._element),this.qVc=!1,!0):!1}g9a(){return 32===this.La.processAction(n.a.renameFile,1)}vHe(){const W=w.a.Zp(this.P9.Bn);let aa=this._element.innerText.trim();aa.length>this.WFa&&(aa=aa.substr(0,this.WFa));
aa!==W&&""!==aa?32!==this.La.ie(n.a.renameFile,2,aa)?this.BQd():this.QX(aa):this.BQd()}BQd(){this.QX(w.a.Zp(this.P9.Bn))}QX(W){this._initialized&&(this._element.innerText=W,this.Dle())}ikg(W){this.g9a()?this.isActive||(W&&(this.NOc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(R.a.Kd,R.a.$0c),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,y.CuiHelper.pRe),this.c$&&
this.c$.execute(aa=>{aa.QUf(!0)}),W&&this._element.focus(),f.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(n.a.egb,2)}k$c(W){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(R.a.Kd,R.a.rt);Sys.UI.DomElement.removeCssClass(this._element,y.CuiHelper.pRe);this.c$&&this.c$.execute(aa=>{aa.QUf(!1)});W&&(this._element.blur(),this._element.focus())}static mA(){A.a.mA(x.AFrameworkApplication.isRtl)}static Rjd(){return new G(x.AFrameworkApplication.xb,
F.a.instance,B.KeyInputManager.instance,M.a.instance,x.AFrameworkApplication.Fm,G.mA,P.a.oAj,P.a.A9g,H.a.instance.$b("Common.App.Header.HeaderEventSource"),E.a.rma,E.a.Xg,E.a.Nf)}}Object(t.a)(G,"RenameUIHandler",null,[375]);class N{static get instance(){return x.AFrameworkApplication.sa.Pa.Ou?N.Ma||(N.Ma=z.Rjd()):N.Ma||(N.Ma=G.Rjd())}}N.Ma=null;Object(t.a)(N,"RenameUIHandlerFactory",null,[]);var I=a(104),O=a(145);class U{constructor(){this.AQi=this.wQi=this.Mmh=null}}Object(t.a)(U,"RenameMruEntryProperties",
null,[]);var ca=a(382),Q=a(175),Y=a(663),la;(function(W){W[W.unknown=-1]="unknown";W[W.success=0]="success";W[W.renameInvalidFileName=1]="renameInvalidFileName";W[W.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";W[W.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";W[W.permissionDenied=4]="permissionDenied";W[W.serverCommunicationFailure=5]="serverCommunicationFailure";W[W.fileNameTooLong=6]="fileNameTooLong"})(la||(la={}));Object(t.b)("CommonOperationResult",la);class ea{constructor(W,
aa,ia,ka,Xa,sb,ib,Ub,hc,yb,Gb,Sa){this.ree=W;this.La=aa;this.jLc=ia;this.mw=ka;this.QFa=Xa;this.lKg=sb;this.eta=ib;this.Foe=Ub;this.MGg=hc;this.Vra=yb;this.$a=Gb;this.LGg=Sa}Pg(){x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Pa.Ou||this.Yh.Wb(n.a.mBb,m.a.frame,Object(c.a)(this,this.mBb,"initializeRenameUIHandler"));this.Yh.Wb(n.a.egb,m.a.frame,Object(c.a)(this,this.egb,"showRenameDisabledDialog"));this.Yh.Wb(n.a.renameFile,m.a.frame,Object(c.a)(this,this.renameFile,"renameFile"));this.Yh.Ne(n.a.fileNameUpdate,
m.a.frame,Object(c.a)(this,this.Fkj,"refreshFilename"),64);this.Yh.Ne(n.a.Ipc,m.a.frame,Object(c.a)(this,this.Ipc,"moveToFolderCompleteByHost"),64);this.Yh.Wb(n.a.cQa,m.a.frame,Object(c.a)(this,this.cQa,"moveToFolder"));(x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||x.AFrameworkApplication.sa&&(x.AFrameworkApplication.fa.ra("PostMessageEmbedded")||x.AFrameworkApplication.fa.ra("IsJsApi"))&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&x.AFrameworkApplication.dR().execute(W=>{W.Am(Q.a.Kzf);W.Lk(Q.a.Kzf,ea.ujj);W.Am(Q.a.Ked);W.Lk(Q.a.Ked,ea.sjj)})}g9a(){return 0===this.LGg.A9e()?32:8}Q9j(){return this.wz?this.eta?this.wz.mQe:this.wz.Lxb:!0}mBb(){return N.instance.initialize(x.AFrameworkApplication.acc,x.AFrameworkApplication.K3a,x.AFrameworkApplication.SOd||CommonUIStrings.l_RenameFileTooltip)?32:8}egb(){const W=this.Q9j(),aa=this.lKg();f.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.QFa,aa,W,this.eta);x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Pa.Uv&&x.AFrameworkApplication.fa.ra("ReactRenameDisabledDialogIsEnabled")?new r(this.QFa,!aa,!W,this.eta,this.Vra()):new v(this.QFa,!aa,!W,this.eta,this.Vra());return 32}renameFile(W,aa,ia,ka,Xa){if(1===ia)return this.g9a();if(!x.AFrameworkApplication.vbc)return 8;if(8===this.g9a())return this.Yh.processAction(n.a.egb,2),8;f.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");x.AFrameworkApplication.vbc(Xa,Object(c.a)(this,
this.sIb,"onRenameFileSuccess"),Object(c.a)(this,this.k3i,"onRenameFileFailure"));x.AFrameworkApplication.Orj=!0;return 32}sIb(W,aa){W?0!==W.OperationResult?this.Dcf(W.OperationResult):(this.DBj(aa,W.NewName),this.l5j(W,Object(c.a)(x.AFrameworkApplication.sa.Pa,x.AFrameworkApplication.sa.Pa.Tng,"updateOpenInClientDocumentUrl")),x.AFrameworkApplication.fa.ra("DocumentNameInJewelInfoMenuIsEnabled")&&x.AFrameworkApplication.sa.updateCommandUI(),this.MGg.smg()):this.Dcf(5)}DBj(W,aa){const ia={};ia[ca.a.PKh]=
aa;W.hi(Q.a.Ked,ia)}l5j(W,aa){this.z5j(W);x.AFrameworkApplication.O9b=W.DirectInvokeDavUrl;aa=aa(W.EditDocInClientUrl);const ia=new U;ia.AQi=this.mw.Bn;ia.Mmh=aa;ia.wQi=W.EditDocInClientUrl;this.Yh.ie(n.a.renameMostRecentlyUsedFileEntry,2,ia)}Dcf(W){switch(W){case 1:W=new e.StandardDialog,W.Xb=0,W.FS(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.H2f()}}z5j(W){this.mw.Bn=ea.VVg(this.mw.Bn,W.NewName);W.BreadcrumbFolderName&&(this.mw.breadcrumbFolderName=
W.BreadcrumbFolderName);W.BreadcrumbFolderUrl&&(this.mw.breadcrumbFolderUrl=W.BreadcrumbFolderUrl);this.Foe(W.NewName)}k3i(W){const aa=new e.StandardDialog;aa.Xb=0;switch(W){case 1:f.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");aa.ypa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:f.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");aa.ypa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:f.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:W}),aa.ypa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}x.AFrameworkApplication.dR().execute(ia=>{ia.hi(Q.a.OKh,{["FailureMessage"]:la[W]})});this.H2f()}Fkj(W,aa,ia){if(1===ia)return this.g9a();if(!x.AFrameworkApplication.dLa)return 8;x.AFrameworkApplication.dLa(Object(c.a)(this,this.vsc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.usc,"onRefreshFilenameFailure"),
!1);return 32}cQa(W,aa,ia,ka,Xa){if(1===ia)return x.AFrameworkApplication.fa.ra("UiHostSupportsMoveToFolder")?32:8;if(2===ia){const sb={};W=x.AFrameworkApplication.ada;aa=x.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");W=(!W||W&&aa)&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);sb[ca.a.cWj]=W;Xa&&Xa.MoveButtonClickedTime&&(sb[ca.a.XOi]=Xa.MoveButtonClickedTime.getTime());x.AFrameworkApplication.dR().execute(ib=>{ib.hi(Q.a.cQa,
sb)});if(Xa&&Xa.MoveButtonClickedTime){if(W=O.a.gs())Xa=(new Date).getTime()-Xa.MoveButtonClickedTime.getTime(),W.set("MovePostDuration",Xa.toString());I.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",W)}return 32}return 8}Ipc(W,aa,ia,ka,Xa){if(1===ia)return x.AFrameworkApplication.fa.ra("UiHostSupportsMoveToFolder")?this.g9a():8;if(2===ia){if(!x.AFrameworkApplication.A6f)return I.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!Xa)return I.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Xa[ca.a.Vsi])if(Xa[ca.a.Rog])if(W=Xa[ca.a.Rog].toLowerCase(),aa=x.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures"),ia=x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),aa&&x.AFrameworkApplication.ada&&ia){const sb={};sb[ca.a.TRa]="1";sb[ca.a.documentUrl]=W;sb[ca.a.reason]=Y.a.saveAs;I.Health.instance.recordKpiSuccess("MoveToFolder",null);
x.AFrameworkApplication.dR().execute(ib=>{ib.hi(Q.a.JZ,sb)})}else if(!x.AFrameworkApplication.ada&&ia)I.Health.instance.recordKpiSuccess("MoveToFolder",null),P.a.vf(W,P.a.WX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return I.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else I.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else x.AFrameworkApplication.dLa(Object(c.a)(this,this.vsc,"onRefreshFilenameSuccess"),Object(c.a)(this,
this.usc,"onRefreshFilenameFailure"),!1),x.AFrameworkApplication.A6f(),I.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}QNj(W,aa){return W&&aa?W!==this.mw.breadcrumbFolderName||aa!==this.mw.breadcrumbFolderUrl:!1}vsc(W,aa){W&&(W.NewName!==w.a.Zp(this.mw.Bn)||this.QNj(W.BreadcrumbFolderName,W.BreadcrumbFolderUrl))&&this.sIb(W,aa)}usc(){}H2f(){this.Foe(w.a.Zp(this.mw.Bn))}get Yh(){return this.La.value}get wz(){return this.jLc.value}static get instance(){return ea.Ma||(ea.Ma=ea.Kka())}static Kka(){return new ea(x.AFrameworkApplication.h9a,
new b.a(()=>x.AFrameworkApplication.xb),new b.a(()=>x.AFrameworkApplication.wz),x.AFrameworkApplication.Fm,x.AFrameworkApplication.limitedEdit,()=>x.AFrameworkApplication.userCanRename,x.AFrameworkApplication.jxc,Object(c.a)(N.instance,N.instance.QX,"updateTitle"),H.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.fa,H.a.instance.resolve("Common.IRenameProps"))}static VVg(W,aa){W=w.a.n5(W);return aa+W}static ujj(W){const aa=
W.Values[ca.a.Rwi];f.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",aa);aa?x.AFrameworkApplication.xb.ie(n.a.Ipc,2,W.Values):I.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static sjj(W){x.AFrameworkApplication.xb.ie(n.a.renameFile,2,W.Values.NewName)}}ea.Ma=null;Object(t.a)(ea,"RenameActor",null,[]);a(580);class ha{}Object(t.a)(ha,"ActivityEventName",null,[]);class X{}X.compatMode="CompatMode";X.noSelection="NoSelection";
Object(t.a)(X,"ActivityEventReason",null,[]);var T=a(661);class ua{constructor(W,aa){this.La=W;this.jXa=aa}Pg(){this.La.Wb(n.a.ldg,m.a.frame,Object(c.a)(this,this.uQj,"showRenameDialogAction"))}uQj(W,aa,ia){W=32;if(1===ia)return T.SessionStatusManager.instance.W6a||x.AFrameworkApplication.i6?8:32;2===ia&&(32!==this.La.processAction(n.a.renameFile,1)?(this.La.processAction(n.a.egb,2),W=8):32===this.La.processAction(n.a.APb,1)?this.La.processAction(n.a.APb,2):this.jXa.value.create().PBc());return W}}
Object(t.a)(ua,"RenameDialogActor",null,[379]);class Ha{constructor(W,aa,ia){this.dialog=null;this.La=W;this.mw=aa;this.Hra=ia}G6h(){const W={};W.nameInputProps={["type"]:"AppInputProps",["id"]:Ha.J3a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:w.a.Zp(this.mw.Bn),["maxLength"]:this.Hra};return W}PBc(){const W={["id"]:"RenameDialog",["bodyControls"]:this.G6h()};this.dialog=new l.a(!1,!1,!0);this.dialog.Xb=1;this.dialog.ye="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,
Object(c.a)(this,this.QOd,"renameDialogHandler"),W)}QOd(W,aa){aa&&1===W&&aa[Ha.J3a]&&(W=w.a.Zp(this.mw.Bn),aa=(aa[Ha.J3a]||"").trim(),aa!==W&&""!==aa&&this.La.ie(n.a.renameFile,2,aa))}}Ha.J3a="txtDocumentName";Object(t.a)(Ha,"ReactRenameDialog",null,[389]);class Ca{static get dg(){return l.a.Wp(Ca.vl,CommonUIStrings.l_RenameDialogLabel)}}Ca.vl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(t.a)(Ca,"RenameDialogHtml",null,[]);class Ga extends l.a{constructor(W,aa,ia){super();this.La=W;this.mw=aa;this.Hra=ia;this.ye="RenameDialog";this.dg=Ca.dg}PBc(){var W={["txtDocumentName"]:w.a.Zp(this.mw.Bn)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.QOd,"renameDialogHandler"),W);W=document.getElementById(Ga.J3a);0<this.Hra&&(W.maxLength=this.Hra);W.focus()}QOd(W,aa){1===W&&(W=w.a.Zp(this.mw.Bn),aa=(aa[Ga.J3a]||"").trim(),aa!==W&&""!==aa&&this.La.ie(n.a.renameFile,
2,aa))}}Ga.J3a="txtDocumentName";Object(t.a)(Ga,"RenameDialog",l.a,[389]);class sa{constructor(W){this.P9=null;this.Hra=0;this.La=W;this._initialized=!1}initialize(W,aa){this.P9=W;this.Hra=aa;this._initialized=!0}create(){return this._initialized?x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Pa.Uv&&x.AFrameworkApplication.fa.ra("ReactRenameDialogIsEnabled")?new Ha(this.La,this.P9,this.Hra):new Ga(this.La,this.P9,this.Hra):null}}Object(t.a)(sa,"RenameDialogFactory",null,[380]);var bb=a(273),
Ba=a(154),qa=a(131),pa=a(113),ya=a(108);class za{constructor(W,aa){this.La=W;this.lc=aa}Pg(){this.La.Wb(n.a.APb,m.a.frame,Object(c.a)(this,this.vQj,"showRenameFlyoutAction"))}C5g(){return qa.d("setDocumentTitleFlyoutOpened")&&x.AFrameworkApplication.sa.Pa.Ou}vQj(W,aa,ia){if(1===ia)return this.C5g()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}IOg(){za.Yzi&&x.AFrameworkApplication.T8a&&ya.a.instance.Kf(new pa.a(5,1,5E3,()=>{32===this.La.processAction(n.a.APb,
1)&&this.lc&&this.lc.li.name===bb.AFrame.y4&&(Ba.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(n.a.APb,2))}))}static get Yzi(){za.RWb&&null!=za.RWb||(x.AFrameworkApplication.hza("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),za.RWb=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return za.RWb}}za.RWb=null;Object(t.a)(za,"RenameFlyoutActor",null,
[378]);class cb{constructor(W,aa,ia,ka,Xa){this.jLc=Xa;this.see=ia;this.ree=ka;this.pKg=W;this.Vra=aa}get wz(){return this.jLc.value}A9e(){if(!this.ree())return 5;if(this.Vra())return 1;if(this.wz){if(this.see&&!this.wz.mQe)return 3;if(!this.see&&!this.wz.Lxb)return 4}return this.pKg()?0:2}}Object(t.a)(cb,"RenameProps",null,[367]);a(198);var Pa=a(105);class nb{constructor(W,aa,ia,ka,Xa,sb){this.Ix=!1;this.eRc=new Pa.a;this.qXa=aa;this.UL=ia;this.pyg=ka;this.$a=Xa;this.nne=sb}enable(){this.Ix||(this.smg(),
this.OYd(),this.Ix=!0)}generateKey(W,aa,ia){return String.format("{0}/{1}/{2}",ia,W,aa)}C1h(){const W=w.a.Zp(this.qXa().Bn);return this.generateKey(this.qXa().breadcrumbFolderName,this.qXa().breadcrumbFolderUrl,W)}D1h(W,aa,ia){return W&&aa?this.generateKey(W,aa,ia):ia}arh(W,aa,ia){return W&&W!==this.qXa().breadcrumbFolderName||aa&&aa!==this.qXa().breadcrumbFolderUrl?!0:ia!==w.a.Zp(this.qXa().Bn)}smg(){const W=this.C1h();this.eRc.ia(W,new Date)}xId(W){this.pMj(W)&&this.Qpe(W)}pMj(W){const aa=this.pyg();
return aa?this.nne&&this.nne.NCb||!aa.Dlf||!x.AFrameworkApplication.dLa?(this.Lfg(W),this.Ix=!1):!0:!1}xMf(W,aa,ia,ka){const Xa=this.arh(W,aa,ia);W=this.D1h(W,aa,ia);aa=this.eRc.Mc(W).returnValue;Xa&&!aa&&(this.Ecf(ka),f.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.fzd));Xa||this.eRc.ia(W,this.UL())}}Object(t.a)(nb,"ARenamedFileChecker",null,[350]);class Ma extends nb{constructor(W,aa,ia,ka,Xa,sb,ib,Ub){super(W,aa,ia,ka,Xa,sb);this.wke=Xa;this.KGg=ib;this.dCg=Ub}get fzd(){return"RenamedFileCheckerUsingSettingsRefresh"}OYd(){this.wke.j_c(Object(c.a)(this,
this.odf,"handleSettingsRefresh"))}odf(W,aa){aa&&aa.RGb&&aa.iTi&&(aa.r9a("BreadcrumbDocName")||aa.r9a("BreadcrumbFolderName")||aa.r9a("BreadcrumbFolderUrl")||aa.r9a("DirectInvokeDAVUrl")||aa.r9a("EditDocInClientUrl"))&&(f.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.fzd),this.xId(aa))}Lfg(){this.wke.x_f(Object(c.a)(this,this.odf,"handleSettingsRefresh"))}Qpe(W){if(W&&W.RGb){const aa=W.RGb;this.xMf(aa.Wa("BreadcrumbFolderName"),aa.Wa("BreadcrumbFolderUrl"),aa.Wa("BreadcrumbDocName"),
W)}}Ecf(W){const aa={OperationResult:0,classId:1};W=W.RGb;aa.BreadcrumbFolderName=W.Wa("BreadcrumbFolderName");aa.BreadcrumbFolderUrl=W.Wa("BreadcrumbFolderUrl");aa.DirectInvokeDavUrl=W.Wa("DirectInvokeDAVUrl");aa.EditDocInClientUrl=W.Wa("EditDocInClientUrl");W=W.Wa("BreadcrumbDocName");aa.NewName=x.AFrameworkApplication.nva?W:w.a.Zp(W);this.dCg.execute(ia=>{this.kqi(aa,ia)})}kqi(W,aa){this.KGg().sIb(W,aa)}}Object(t.a)(Ma,"RenamedFileCheckerUsingSettingsRefresh",nb,[]);class Oa extends nb{constructor(W,
aa,ia,ka,Xa,sb,ib,Ub,hc,yb){super(W,ia,ka,Xa,sb,hc);this.Bnb=this.Z_b=null;this.UFg=aa;this.La=ib;this.de=Ub;yb&&yb.execute(Gb=>{this.Wmj(Gb)})}get fzd(){return"RenamedFileCheckerUsingTask"}Wmj(W){this.Z_b=W;this.Z_b.bue(Object(c.a)(this,this.Lzb,"handleVisibilityChange"))}Lzb(W,aa){!this.Ix||0!==aa.newState&&1!==aa.newState||this.Bnb||(this.OYd(),this.xId(this.Bnb))}OYd(){this.Bnb=new pa.a(3,2,this.UFg(),Object(c.a)(this,this.xId,"performRenameFileCheckTick"),89);this.de.Kf(this.Bnb)}Lfg(W){this.de.np(W)}Qpe(W){this.Z_b&&
2===this.Z_b.Eek?this.Znj(W):x.AFrameworkApplication.dLa(Object(c.a)(this,this.vsc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.usc,"onRefreshFilenameFailure"),!0)}Znj(W){this.de.np(W);this.Bnb=null}vsc(W){W&&this.xMf(W.BreadcrumbFolderName,W.BreadcrumbFolderUrl,W.NewName,null)}Ecf(){this.La.processAction(n.a.fileNameUpdate,2)}usc(){}}Object(t.a)(Oa,"RenamedFileCheckerUsingTask",nb,[]);var La=a(102);class ra{constructor(){this.$a=this.ib=null}get name(){return"Common.App.RenameFile"}ki(W){this.ib=
W;this.$a=x.AFrameworkApplication.fa;this.ib.register(ua,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Gc(()=>new ua(x.AFrameworkApplication.xb,this.ib.vQd("Common.App.Rename.IRenameDialogFactory"))).zc();this.ib.register(sa,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Gc(()=>new sa(x.AFrameworkApplication.xb)).zc();this.ib.register(350,"Common.App.Rename.IRenamedFileChecker").Gc(()=>this.Akh()).zc();this.ib.register(za,
"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Gc(()=>new za(x.AFrameworkApplication.xb,La.FocusManager.instance())).zc()}Akh(){if(this.$a.ra("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const W=this.ib.yg("Common.IRefreshableAppSettings");if(W&&W.Dof)return new Ma(()=>W.Dd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>x.AFrameworkApplication.Fm,()=>new Date,()=>x.AFrameworkApplication.wz,W,this.ib.yg("Common.ISessionStatus"),()=>ea.instance,this.ib.$b("Postmessage.IHostPostmessenger"))}return new Oa(()=>
this.$a.Dd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.$a.Dd("RenamedFileCheckerPingIntervalInMs",12E4),()=>x.AFrameworkApplication.Fm,()=>new Date,()=>x.AFrameworkApplication.wz,x.AFrameworkApplication.fa,x.AFrameworkApplication.xb,x.AFrameworkApplication.ji,this.ib.yg("Common.ISessionStatus"),this.ib.$b("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.$a.Nu(Object(c.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){const W=x.AFrameworkApplication.sa.Pa.Ou;x.AFrameworkApplication.h9a()&&
N.instance.initialize(x.AFrameworkApplication.acc,W?null:x.AFrameworkApplication.K3a,W?null:x.AFrameworkApplication.SOd||CommonUIStrings.l_RenameFileTooltip)&&(this.ib.register(cb,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Gc(()=>new cb(()=>x.AFrameworkApplication.userCanRename,()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.jxc,x.AFrameworkApplication.h9a,new b.a(()=>x.AFrameworkApplication.wz))).zc(),ea.instance.Pg(),this.$a.ra("RenameDialogIsEnabled")&&
(this.ib.resolve("Common.App.Rename.RenameDialogFactory").initialize(x.AFrameworkApplication.Fm,x.AFrameworkApplication.acc),this.ib.resolve("Common.App.Rename.IRenameDialogActor").Pg()),this.ib.resolve("Common.App.Rename.IRenameFlyoutActor").Pg(),x.AFrameworkApplication.jxc&&this.ib.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.ib.resolve("Common.App.Rename.IRenameFlyoutActor").IOg())}dispose(){}}Object(t.a)(ra,"PackageManager",null,[4,5]);var V=a(260);a.d(C,"a",function(){return ma});
const ma=()=>{Type.registerNamespace("Common.App.Rename");V.a.instance.dj(new ra,7)}},1190:function(t,C,a){function c(fb,ab,wb,kb=N){const {iB:tb,success:hb}=fb.FOh(wb,ab,kb.width,kb.font);return hb?tb:(w.ULS.sendTraceTag(512508562,0,10,"formatValue: Failed to acquire friendly format string"),"")}function b(fb,ab){return Object(z.a)(this,void 0,void 0,function*(){if(Object(A.m)(fb.na)){const wb=fb.na.sheetProcessedData;Object(I.a)(wb);return ab.map(kb=>P(kb,!0)).filter(kb=>wb.value.dDb(kb))}return[]})}
function f(fb){return fb.reduce((ab,wb)=>{var kb=wb.tableRange;wb=wb.suggestions;kb&&wb&&(kb=P(kb,!1).Rw(!1),ab[kb]=e(ab[kb],wb));return ab},{})}function e(fb,ab){return ab.reduce((wb,{type:kb})=>{kb in wb?wb[kb]++:kb&&(wb[kb]=1);return wb},null!==fb&&void 0!==fb?fb:{})}function d(fb,ab,wb){return Object(z.a)(this,void 0,void 0,function*(){try{switch(null===ab||void 0===ab?void 0:ab.type){case 0:return h(fb,ab,wb);case 2:return l(fb,ab,wb);case 1:return r(fb,ab,wb);default:w.ULS.sendTraceTag(509617686,
0,10,`applySuggestion: Unknown suggestion type ${null===ab||void 0===ab?void 0:ab.type}`)}}catch(kb){w.ULS.sendTraceTag(509617685,0,10,`applySuggestion: ${kb}`)}return null})}function h(fb,ab,wb){return Object(z.a)(this,void 0,void 0,function*(){const kb=ab.variations.filter(jb=>jb.isSelected&&jb.value!==ab.replacementValue).map(jb=>jb.value),tb={["SheetName"]:fb.na.sheetName,["MatchCase"]:!1,["MatchEntireCell"]:Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7684583_DataCleansingMatchEntireCell"),
["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:kb},{cGd:hb,bGd:Fb,qHd:va}=u(ab);Object(ea.a)(fb.userOperationManager,(jb,Ab,Qa)=>Ha.x(fb.pa.va,tb,Object(la.u)(fb.na.sheetName,null,wb),ab.replacementValue,Object(ha.b)(jb,hb),Object(ha.a)(Ab,Fb),Qa,null),jb=>new X.a(258,0,jb),null);yield va;return{result:kb.length,successful:!0}})}function r(fb,ab,wb){return Object(z.a)(this,void 0,void 0,function*(){if(null===wb||void 0===wb||!wb.length)return w.ULS.sendTraceTag(509617684,
0,10,"applyNumberFormatInconsistencySuggestion: empty changeRanges."),Promise.resolve({result:0,successful:!1});const kb=Object(la.u)(fb.na.sheetName,null,wb),tb={},hb=ab.formats.find(({key:Z})=>Z===ab.replacementFormat).format;tb.NumberFormatOptions=Object(D.a)(new Q.a,{NumberFormatCategory:-1,CustomFormatString:hb});tb.ValidMembers=32;tb.NumberFormat=15;const Fb=Object(la.o)(H.h(fb).ga.qa.activeCell,fb),va=fb.pa.va.ic({bna:!0,Tla:1}),{cGd:jb,bGd:Ab,qHd:Qa}=u(ab);Object(ea.a)(fb.userOperationManager,
(Z,wa,Ea)=>T.l(fb.pa.va,kb,Fb,tb,!1,null,null,!0,!1,Object(ha.b)(Z,jb),Object(ha.a)(wa,Ab),Ea,null,va,null),Z=>new X.a(11,0,Z),null);yield Qa;return{result:-1,successful:!0}})}function l(fb,ab,wb){return Object(z.a)(this,void 0,void 0,function*(){const {cGd:kb,bGd:tb,qHd:hb}=u(ab);Object(ea.a)(fb.userOperationManager,(Fb,va,jb)=>{var Ab=fb.pa.va,Qa=Object(la.u)(fb.activeItemName,null,wb);a:{var Z=ab.extraSpacesType;switch(Z){case 0:Z=1;break a;case 2:Z=2;break a;case 1:Z=4;break a;default:throw w.ULS.sendTraceTag(509617683,
0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${Z}`),Error.argument("illegal ExtraSpacesPaddingType");}}return ua(Ab,Qa,Z,Object(ha.b)(Fb,kb),Object(ha.a)(va,tb),jb,null)},Fb=>new X.a(253,0,Fb),null);return{result:(yield hb).Result,successful:!0}})}function u(fb){const ab=new ca.a;return{cGd(wb){if(wb&&Y.a.lg(wb.Errors))w.ULS.sendTraceTag(509617682,0,10,`DataCleansing onOperationSuccess: Ewa result contains error messages after applying type [${fb.type}]`),ab.setResult(null);
else{var kb=w.ULS,tb=kb.sendTraceTag,hb=fb.type;var Fb=(Fb=fb.tableName)?Fb.includes(":")?"Range":"Ctrl-T":"";tb.call(kb,537163359,0,20,`DataCleansing onOperationSuccess: Suggestion of type [${hb}] applied successfully in tableType [${Fb}]`);ab.setResult(wb)}},bGd(wb){w.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages for type [${fb.type}], HttpStatus [${wb.data.httpStatus}]`);ab.setResult(null)},qHd:m.e(ab.task)}}function v(fb){return fb.find(ab=>
za.a.UAd(ab,[Ma.getTypeName()]))}function x(fb){return fb.filter(ab=>za.a.UAd(ab,[nb.getTypeName()]))}t=a(0);var w=a(14),m=a(109),n=a(228),z=a(159),y=a(40),A=a(73),F=a(353),D=a(2),B=a(25);class M{constructor(){this.bottom=this.top=this.right=this.left=0}}Object(t.a)(M,"RangeAddress",null,[]);const R=fb=>P(fb,!1).Rw(!1),P=(fb,ab=!1)=>{fb=new B.Range(fb.top,fb.left,fb.bottom,fb.right,!1,ab);if(ab&&(1>fb.top||fb.top>fb.maxRows||1>fb.bottom||fb.bottom>fb.maxRows||fb.top>fb.bottom||1>fb.left||fb.left>
fb.maxColumns||1>fb.right||fb.right>fb.maxColumns||fb.left>fb.right))throw w.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return fb};var E=a(938),H=a(21),G=a(783);const N={width:244,font:"12px sans-serif"};var I=a(62);const O={[0]:[45],[1]:[46]};class U{constructor(fb,ab){this.$=fb;this.eg=ab;this.doUndo=()=>Object(z.a)(this,void 0,void 0,function*(){yield Object(E.d)(this.$)});this.highlightRangesOnGrid=(wb,kb,tb)=>
Object(z.a)(this,void 0,void 0,function*(){this.Iz(wb,kb,O[tb])});this.openCustomNumberFormat=()=>Object(z.a)(this,void 0,void 0,function*(){return new Promise(wb=>{Object(E.a)(this.$,kb=>{wb(kb);w.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${kb?"OK":"Cancel"}"`)})})});this.openFeedback=wb=>Object(z.a)(this,void 0,void 0,function*(){Object(E.e)(this.$,wb)});this.sendOtelEvent=wb=>Object(z.a)(this,void 0,void 0,function*(){Object(G.b)(wb)});this.formatRanges=
(wb=[])=>Object(z.a)(this,void 0,void 0,function*(){return wb.map(R)});this.formatValues=wb=>Object(z.a)(this,void 0,void 0,function*(){return wb.map(kb=>c(this.eg,kb.format,kb.value))});this.containsHiddenCells=wb=>b(this.$,wb)}get grid(){return H.h(this.$)}Iz(fb,ab,wb=[45]){const kb=this.grid.Jb;kb.ik(wb,!1,!0);kb.Mk(null,wb,!1);if(null===fb||void 0===fb?0:fb.length){const tb=F.a.$Ca(A.d(this.$.na),fb.map(hb=>P(hb,!1)));kb.pA(tb,wb,!0,void 0,!1);ab&&this.iPi(fb)}kb.update(!1)}iPi(fb){if(null===
fb||void 0===fb?0:fb.length){const ab=this.grid;[fb]=fb.sort((wb,kb)=>wb.top<kb.top?-1:wb.top>kb.top?1:0);fb=B.Range.Lc(fb.top,fb.left);ab.wN(fb)||(w.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),ab.Nv(fb,0,"DataCleansing"))}else w.ULS.sendTraceTag(509617690,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(t.a)(U,"HostAppCallbacks",null,[602]);var ca=a(170),Q=a(795),Y=a(32),la=a(45),ea=a(380),ha=a(293),X=a(199),
T=a(65);const ua=(fb,ab,wb,kb,tb,hb,Fb,va=null)=>{va=fb.Oa(9,va);va.ranges=ab;va.trimWhitespaceType=wb;return T.g(fb,"TrimWhitespace",va,kb,tb,hb,Fb,0)};var Ha=a(294),Ca;(function(fb){fb[fb.textInconsistency=0]="textInconsistency";fb[fb.numberFormatInconsistency=1]="numberFormatInconsistency";fb[fb.extraSpaces=2]="extraSpaces"})(Ca||(Ca={}));Object(t.b)("SuggestionType",Ca);var Ga=a(1),sa=a(937);class bb{constructor(fb){this.$=fb;this.applySuggestion=(ab,wb=[])=>Object(z.a)(this,void 0,void 0,function*(){const kb=
wb.map(tb=>P(tb,!1));return d(this.$,ab,kb)});this.onPaneLifecycleEvent=ab=>Object(z.a)(this,void 0,void 0,function*(){sa.a(ab)})}}Object(t.a)(bb,"DataCleansingCallbacks",null,[603]);class Ba{constructor(){this.isInErrorState=!1;this.errorState=null;this.isInCoauthoring=this.isInViewMode=!1}}Object(t.a)(Ba,"HostState",null,[]);class qa{constructor(){this.sheetName=this.sheetId=null;this.isProtected=this.isInNamedSheetView=!1}}Object(t.a)(qa,"WorksheetState",null,[]);class pa{constructor(){this.annotations=
[];this.hostState=new Ba;this.worksheetState=new qa}}Object(t.a)(pa,"DataCleansingHostState",null,[]);class ya{constructor(fb){this.$=fb;this.ZOe=!1}get isEnabled(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)}show(fb){this.isEnabled&&!this.ZOe&&(2>fb?w.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${fb}) is below threshold to show teaching callout`):(Object(E.b)(this.$,fb),this.ZOe=!0))}}Object(t.a)(ya,"TeachingCallout",
null,[]);var za=a(741);Ca=a(746);var cb=a(722);class Pa extends Ca.a{constructor(){super();this.columnIdentifier=this.tableIdentifier=this.tableRange=this.tableName=this.worksheetName=this.worksheetId=null;this.H_=Object.assign(new cb.a,{T_:Pa.getTypeName(),B_:Pa.Td()})}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static Td(){return["AugLoop_Core_Annotation"]}}Object(t.a)(Pa,"TableLintAnnotationBase",Ca.a,[]);class nb extends Pa{constructor(){super();this.investigationTelemetry=
this.suggestions=this.columnName=this.columnTitle=null;this.H_=Object.assign(new cb.a,{T_:nb.getTypeName(),B_:nb.Td()})}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static Td(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(t.a)(nb,"TableLintColumnAnnotation",Pa,[]);class Ma extends Ca.a{constructor(){super();this.worksheetId=null;this.errorCount=this.suggestionsCount=0;this.aggregatedAnnotations=this.unsupportedFeaturesSet=null;this.H_=
Object.assign(new cb.a,{T_:Ma.getTypeName(),B_:Ma.Td()})}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static Td(){return["AugLoop_Core_Annotation"]}}Object(t.a)(Ma,"TableLintWorksheetAggregateAnnotation",Ca.a,[]);var Oa=a(936),La=a(98),ra=a(80),V=a(41),ma=a(70),W=a(157),aa=a(53),ia=a(15),ka=a(187);class Xa{constructor(fb){this.$=fb;this.YOe=!1}$fb(fb){return Object(z.a)(this,void 0,void 0,function*(){if(this.YOe)w.ULS.sendTraceTag(509089825,0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");
else{var ab=String.format(ia.a.instance.qb(213),fb),wb=ka.a.ha(1952),kb=ka.a.ha(1954);this.businessBarManager||(this.businessBarManager=Object(ma.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?yield W.a.resolve(V.f,{rb:1}):yield aa.GetServiceTaskFactory.bR(this.$.da,5,4,1));this.businessBarManager.GOj(ab,kb,wb);this.YOe=!0;w.ULS.sendTraceTag(509089824,0,50,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${fb} suggestions.`)}})}}Object(t.a)(Xa,"BusinessBar",null,
[]);const sb=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDisableTaskPaneWhenALSessionClose",!1);class ib extends y.a{constructor(fb,ab,wb){super();this.$=fb;this.bIa=ab;this.R9b=!1;this.T6=new pa;this.cMf=(kb,tb)=>Object(z.a)(this,void 0,void 0,function*(){this.fJi(tb.sheetId,tb.annotations);this.stateChanged();yield this.rcf()});this.Fj=(kb,tb)=>Object(z.a)(this,void 0,void 0,function*(){this.lmg(tb.RB);this.ygg(tb.na);this.stateChanged();yield this.rcf()});this.Ze=
()=>Object(z.a)(this,void 0,void 0,function*(){this.gridView.inRangePicker||this.gridView.ni||this.ga.Se&470||(yield this.gdi())});this.Lna=()=>{this.stateChanged()};this.JB=()=>{this.stateChanged()};this.i7=()=>{this.stateChanged()};this.kNf=(kb,[tb,hb])=>{w.ULS.sendTraceTag(509613389,0,50,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Oa.a[tb],["errorCode"]:hb})}`);sb&&(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7514489_AddSpecificErrorMessage")?
this.T6.hostState.errorState=hb:this.T6.hostState.isInErrorState=!0,this.stateChanged())};this.x7=(kb,tb)=>{A.m(tb.item)&&tb.item.di!==this.T6.worksheetState.isProtected&&(w.ULS.sendTraceTag(509613388,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${tb.item.di}.`),this.stateChanged())};this.callbacks=new bb(this.$);this.BVg=new U(this.$,wb);this.kEc=new ya(this.$);this.businessBar=new Xa(this.$);ab.WSg(this.cMf);ab.jTg(this.kNf);void ab.oYc();fb.Qi.kg(this.Fj);
fb.ea.X$(this.JB);fb.ea.u3(this.i7);this.gridView=H.h(this.$);this.ga=this.gridView.ga;this.ga.QJ(this.Ze);this.ygg(this.$.na)}B_c(fb){this.addHandler(ib.SYd,fb)}L_f(fb){this.removeHandler(ib.SYd,fb)}dispose(){this.bIa.urj(this.cMf);this.bIa.Frj(this.kNf);this.$.Qi.Gg(this.Fj);this.$.ea.i8(this.JB);this.$.ea.d8(this.i7);this.lmg(this.$.na);this.ga.LI(this.Ze);super.dispose()}get state(){this.T6.annotations=this.bIa.FUg();if(A.m(this.$.na)){const fb=this.$.na.di,ab=this.$.na.sheetId,wb=this.$.na.sheetName;
this.T6.worksheetState.isInNamedSheetView=this.$.na.Be.wB;this.T6.worksheetState.isProtected=fb;this.T6.worksheetState.sheetId=ab;this.T6.worksheetState.sheetName=wb}this.T6.hostState.isInViewMode=!this.$.ea.isEditMode;this.T6.hostState.isInCoauthoring=this.isInCoauthoring();return this.T6}AZd(fb){return this.DYc(fb)}BZd(fb){return this.wLh(fb)}gXj(fb){if(A.m(this.$.na)){var ab=this.bIa.NOb(this.$.na.sheetId);if(v(ab)&&(ab=x(ab).filter(wb=>fb.ze(P(wb.tableRange))),0<ab.length))return ab=P(ab[0].tableRange),
w.ULS.sendTraceTag(509219845,0,50,`DataCleansingHostManager.getTableRange: Table range is ${ab}, selected cell range is ${fb}.`),ab}}d_d(){if(!A.m(this.$.na))return 0;var fb=this.bIa.NOb(this.$.na.sheetId);if(!v(fb))return 0;fb=new Set(x(fb).map(ab=>ab.tableName));w.ULS.sendTraceTag(509211032,0,50,`DataCleansingHostManager.tablesWithSuggestionsCount: ${fb.size} tables with suggestions found.`);return fb.size}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(ib.SYd,this.state)}ygg(fb){A.m(fb)&&
(fb.Be.I_a(this.Lna),fb.L_a(this.x7))}lmg(fb){A.m(fb)&&(fb.Be.LLb(this.Lna),fb.fxc(this.x7))}gFc(){if(this.kEc.isEnabled){const fb=this.DYc();0<fb&&this.kEc.show(fb)}}DYc(fb){if(!A.m(this.$.na))return 0;const ab=this.bIa.NOb(this.$.na.sheetId),wb=v(ab);if(!wb)return 0;if(fb)return this.afh(ab,fb);fb=this.$eh(ab);fb!==wb.suggestionsCount&&w.ULS.sendTraceTag(509613387,0,50,`DataCleansingHostManager.activeSheetSuggestionsCount: suggestionsCount is ${wb.suggestionsCount}, but we have ${fb} suggestions.`);
return fb}$eh(fb){return x(fb).reduce((ab,wb)=>{var kb,tb;return ab+(null!==(tb=null===(kb=null===wb||void 0===wb?void 0:wb.suggestions)||void 0===kb?void 0:kb.length)&&void 0!==tb?tb:0)},0)}afh(fb,ab){fb=x(fb).map(wb=>{var kb;return null===(kb=null===wb||void 0===wb?void 0:wb.suggestions)||void 0===kb?void 0:kb.filter(tb=>!(null===ab||void 0===ab||!ab.ze(P(tb.suggestionRange))))}).reduce((wb,kb)=>wb+kb.length,0);w.ULS.sendTraceTag(509219844,0,50,`DataCleansingHostManager.countSuggestionsForRange: ${fb} suggestions found for range: ${ab}`);
return fb}wLh(fb){if(!A.m(this.$.na))return[];const ab=this.bIa.NOb(this.$.na.sheetId);return v(ab)?x(ab).filter(wb=>{var kb;return 0<(null===(kb=null===wb||void 0===wb?void 0:wb.suggestions)||void 0===kb?void 0:kb.filter(tb=>!(null===fb||void 0===fb||!fb.ze(P(tb.suggestionRange)))).length)}).map(wb=>wb.tableName):[]}fJi(fb,ab){ab=f(x(ab));w.ULS.sendTraceTag(509698241,0,50,`DataCleansingHostManager.logPotentialSuggestionsInfo: ${JSON.stringify({["sheetId"]:fb,["suggestionsInfo"]:ab})}`)}gHd(fb,ab){if(this.fad===
ab){const wb=new La.a(-1190551534,ra.a.Eb,this.$.Bc,0,null);this.$.Ia.Nb(wb,{["discoverabilityOptions"]:{type:ab,range:fb}});w.ULS.sendTraceTag(0,0,50,`DataCleansingHostManager:openDataCleansingTaskPane discoverability type: ${ab}. with active range: ${fb}.`)}}get fad(){return Ga.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverability",0)}get vPe(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",!1)}get uPe(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityBusinessBar",
!1)}gdi(){return Object(z.a)(this,void 0,void 0,function*(){if(!this.R9b&&2===this.fad){const [fb]=this.ga.qa.selectedRanges;if(fb){const ab=this.AZd(fb),wb=this.d_d();0<ab&&1===wb&&(this.vPe?this.gFc():this.uPe?yield this.businessBar.$fb(ab):this.gHd(fb,2),this.R9b=!0)}}})}rcf(){return Object(z.a)(this,void 0,void 0,function*(){if(!this.R9b){const fb=this.DYc();0<fb&&(this.uPe&&0===this.fad?(yield this.businessBar.$fb(fb),this.R9b=!0):!this.vPe&&this.kEc.isEnabled&&this.kEc.show(fb))}})}}ib.SYd=
"scek";Object(t.a)(ib,"DataCleansingHostManager",y.a,[]);class Ub extends Pa{constructor(){super();this.errorCategory=this.errorType=this.investigationTelemetry=this.columnName=this.columnTitle=null;this.H_=Object.assign(new cb.a,{T_:Ub.getTypeName(),B_:Ub.Td()})}static getTypeName(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}static Td(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(t.a)(Ub,"TableLintErrorAnnotation",Pa,[]);class hc extends Pa{constructor(){super();
this.unsupportedFeatures=this.investigationTelemetry=this.columnName=this.columnTitle=null;this.H_=Object.assign(new cb.a,{T_:hc.getTypeName(),B_:hc.Td()})}static getTypeName(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}static Td(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}}Object(t.a)(hc,"TableLintUnsupportedFeatureAnnotation",Pa,[]);class yb extends y.a{constructor(fb,ab){super();this.iia=!1;this.aXj=(wb,kb)=>{if(wb=kb.jH)switch(kb.operationType){case 1:case 2:this.raiseEvent("carek",
wb);break;case 3:this.raiseEvent("caiek",wb);break;default:w.ULS.sendTraceTag(537163396,306,15,`TableLintManager.TableLintColumnAnnotationHandler Received unexpected OperationType:${kb.operationType}`)}else w.ULS.sendTraceTag(537163397,306,50,"TableLintManager.TableLintColumnAnnotationHandler TableLintColumnAnnotation is null.")};this.cXj=(wb,kb)=>{if(kb.jH)switch(kb.operationType){case 1:case 2:this.raiseEvent("aarek",kb.jH);break;case 3:break;default:w.ULS.sendTraceTag(537163394,306,15,`TableLintManager.TableLintAnnotationHandler Received unexpected OperationType:${kb.operationType}`)}else w.ULS.sendTraceTag(537163395,
306,50,"TableLintManager.TableLintWorksheetAggregateAnnotationHandler TableLintWorksheetAggregateAnnotation is null.")};this.bXj=(wb,kb)=>{w.ULS.sendTraceTag(537163393,306,50,`TableLintManager.TableLintColumnAnnotationStateUpdateHandler Received state update: ${wb}->${kb}`)};this.augmentationLoopManager=fb;this.ZTi=ab}oYc(){this.iia?w.ULS.sendTraceTag(537163398,0,50,"TableLintManager.ActivateEvents: Events are already registered"):(this.Emj(),this.iia=!0)}dispose(){this.iia&&(this.y4j(),this.iia=
!1)}kQg(fb){this.addHandler("carek",fb)}jpj(fb){this.removeHandler("carek",fb)}LPg(fb){this.addHandler("aarek",fb)}Roj(fb){this.removeHandler("aarek",fb)}Emj(){w.ULS.sendTraceTag(574482312,0,50,"TableLintManager.RegisterTableLintEvents: activate annotations");this.augmentationLoopManager.register(this.augmentationLoopManager.l5().B8("DataCleansing").A8(this.ZTi).activateAnnotation({annotationType:nb.getTypeName(),Ay:!0,Yve:this.bXj,oib:this.aXj}).activateAnnotation({annotationType:Ma.getTypeName(),
Ay:!0,oib:this.cXj}).activateAnnotation({annotationType:Ub.getTypeName(),Ay:!0}).activateAnnotation({annotationType:hc.getTypeName(),Ay:!0}).build())}y4j(){this.augmentationLoopManager.unregister("DataCleansing")}}Object(t.a)(yb,"TableLintManager",y.a,[2]);class Gb extends y.a{constructor(fb){super();this.$=fb;this.bBc=new Map;this.V5c=new Map;this.U5c=new Map;this.Mab=(ab="Unknown",wb)=>{w.ULS.sendTraceTag(520987272,0,50,`DataCleansingAnnotationsManager.onAugmentationLoopSessionClose: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Oa.a[ab],
["errorCode"]:wb})}`);this.raiseEvent(Gb.L1d,[ab,wb])};this.rEf=(ab,wb)=>{this.V5c.set(wb.id,wb);w.ULS.sendTraceTag(512354457,0,100,`DataCleansingAnnotationsManager.onColumnAnnotationReceived: Received ${wb.id}`)};this.RCf=(ab,wb)=>{ab=this.bBc.get(wb.worksheetId);w.ULS.sendTraceTag(512354456,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received ${JSON.stringify({["id"]:wb.id,["sheetId"]:wb.worksheetId,["previous"]:null===ab||void 0===ab?void 0:ab.id,["errorCount"]:wb.errorCount,
["suggestionsCount"]:wb.suggestionsCount})}`);(null===ab||void 0===ab?void 0:ab.id)===wb.id&&w.ULS.sendTraceTag(512354455,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received duplicate ${wb.id}`);this.bBc.set(wb.worksheetId,wb);ab=this.z6h(wb);ab.forEach(kb=>{this.V5c.delete(kb.id)});this.U5c.set(wb.id,ab);this.vVg(wb.worksheetId)}}WSg(fb){this.addHandler(Gb.sVd,fb)}urj(fb){this.removeHandler(Gb.sVd,fb)}jTg(fb){this.addHandler(Gb.L1d,fb)}Frj(fb){this.removeHandler(Gb.L1d,
fb)}dispose(){this.YUa&&(this.YUa.jpj(this.rEf),this.YUa.Roj(this.RCf),this.YUa.dispose());super.dispose()}oYc(){return Object(z.a)(this,void 0,void 0,function*(){const fb=yield aa.GetServiceTaskFactory.bR(this.$.da,328,327,1);fb?(this.YUa=new yb(fb,this.Mab),this.YUa.kQg(this.rEf),this.YUa.LPg(this.RCf),this.YUa.oYc(),w.ULS.sendTraceTag(520987274,0,50,"DataCleansingAnnotationsManager.activateEvents: events activated")):w.ULS.sendTraceTag(520987273,0,10,"DataCleansingAnnotationsManager.activateEvents: no augmentationLoopManager")})}NOb(fb){var ab;
if(fb=this.bBc.get(fb)){const wb=null!==(ab=this.U5c.get(fb.id))&&void 0!==ab?ab:[];return[fb,...wb]}return[]}FUg(){const fb=[];this.bBc.forEach(ab=>{var wb;const kb=null!==(wb=this.U5c.get(ab.id))&&void 0!==wb?wb:[];fb.push(ab,...kb)});return fb}vVg(fb){fb={sheetId:fb,annotations:this.NOb(fb)};this.raiseEvent(Gb.sVd,fb)}z6h(fb){var ab=Array.from(this.V5c.values()).filter(tb=>tb.worksheetId===fb.worksheetId);if(!Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7403186_DataCleansingUseAggregatedAnnotations"))return ab;
if(!ab.length)return w.ULS.sendTraceTag(509682374,0,50,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No pending sheet annotations"),[];if(!Array.isArray(fb.aggregatedAnnotations))return w.ULS.sendTraceTag(509682373,0,20,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No aggregated annotations IDs"),ab;const wb=new Set(fb.aggregatedAnnotations),kb=ab.filter(tb=>wb.has(tb.id));ab=ab.filter(tb=>!wb.has(tb.id));ab.length&&w.ULS.sendTraceTag(509682372,0,50,`DataCleansingAnnotationsManager.getRelatedPendingAnnotations: Found ${ab.length} unrelated annotations`);
return kb}}Gb.sVd="sacek";Gb.L1d="ueoek";Object(t.a)(Gb,"DataCleansingAnnotationsManager",y.a,[]);var Sa=a(721);a.d(C,"a",function(){return db});class db extends n.a{constructor(fb){super();this.$=fb;this.Mb()}create(){this.hih().then(fb=>{const ab=Object(Sa.a)(this.$.da,494,()=>{const wb=new Gb(this.$);return new ib(this.$,wb,fb)});this.vb(ab)},()=>{w.ULS.sendTraceTag(509613385,0,10,"DataCleansingHostManagerFactory.Create: failed to create formatCellsAction")})}hih(){return Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",
!1)?W.a.resolve(V.x,{rb:this.Na}):m.e(aa.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.Na))}static la(fb){fb.da.Ha(495,new db(fb))}}Object(t.a)(db,"DataCleansingHostManagerFactory",n.a,[])},1192:function(t,C,a){a.r(C);t=a(0);var c=a(14),b=a(91),f=a(114),e=a(16),d=a(92),h=a(57),r=a(34),l=a(29),u=a(13),v=a(245),x=a(1084),w=a(7),m=a(272),n=a(1085),z=a(731),y=a(979),A=a(863);class F extends A.a{constructor(wb,kb,tb){super(wb,kb,tb)}LD(wb){super.LD(wb)}}Object(t.a)(F,"EditAttemptReadOnlyBusinessBarEntry",
A.a,[]);var D=a(49);class B extends z.a{constructor(wb,kb,tb,hb){super(wb,kb);this.error=tb;this.options=hb;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.Ir=!(hb&4)}pn(wb){super.pn(wb);this.error.Appearance&=-33;D.a(this.businessBar.$).fu([this.error])}}Object(t.a)(B,"ErrorBusinessBarEntry",z.a,[]);var M=a(98);class R extends B{constructor(wb,kb,tb,hb,Fb){super(wb,kb,tb,hb);this.command=Fb;this.NV=!0}wW(wb){super.wW(wb);
this.businessBar.$.Ia.Nb(new M.a(this.command,wb,this.businessBar.$.Bc,10,null))}}Object(t.a)(R,"ErrorAndCommandBusinessBarEntry",B,[]);var P=a(15);class E{constructor(wb,kb,tb,hb,Fb,va,jb,Ab,Qa,Z){this.zJ=this.w9=this.qP=0;this.Qxg=wb;this.zZj=kb;this.AJ=tb;this.fCg=jb;this.hlb=r.a.Au(Qa);this.lAg=Qa;this.e8d=Ab;this.gCg=Z;0!==hb&&(this.qP=hb);0!==Fb&&(this.w9=Fb);0!==va&&(this.zJ=va)}get title(){return E.ha(this.zZj)}get message(){return E.ha(this.AJ)}get messageId(){return this.AJ}get iconName(){return this.gCg}get l1a(){return this.Qxg}get actionButton(){return E.ha(this.qP)}get Gta(){return E.ha(this.w9)}get link(){return E.ha(this.zJ)}get tk(){return this.fCg}get businessBarType(){return this.e8d}get hash(){return this.hlb}get alt(){const {BusinessBarControl:wb}=
a(1192);switch(this.tk){case wb.Sja:return E.ha(26);case wb.Zy:return E.ha(25);case wb.Ii:return E.ha(24);default:return E.ha(0)}}get RKa(){return this.lAg}set businessBarType(wb){this.e8d=wb}static ha(wb){return P.a.instance.ha(wb)}}Object(t.a)(E,"EwaBusinessBarEntry",null,[]);class H extends E{constructor(wb,kb,tb,hb,Fb,va,jb,Ab){super(wb,0,kb,tb,hb,Fb,va,jb,Ab)}get title(){return""}}Object(t.a)(H,"EwaNoTitleBusinessBarEntry",E,[]);var G=a(77);class N extends z.a{constructor(wb,kb){super(wb,kb);
this.NV=this.Ir=!0}pn(wb){super.pn(wb);this.set_visible(!1);this.businessBar.$.MI();this.businessBar.$.Ia.Nb(new M.a(1038998010,wb,this.businessBar.$.Bc,10,null))}wW(wb){super.wW(wb);this.businessBar.$.Ia.Nb(new M.a(-722953877,wb,this.businessBar.$.Bc,10,null))}LD(wb){this.businessBar.removeEntry(55);G.g(wb)}}Object(t.a)(N,"ExternalLinksEnableContentBusinessBarEntry",z.a,[]);class I extends z.a{constructor(wb,kb){super(wb,kb);this.Ir=!0;this.NV=!1}pn(wb){super.pn(wb);this.businessBar.$.Ia.Nb(new M.a(-722953877,
wb,this.businessBar.$.Bc,10,null))}LD(wb){this.businessBar.removeEntry(5);G.g(wb)}}Object(t.a)(I,"ExternalLinksShowErrorBusinessBarEntry",z.a,[]);var O=a(12);class U extends z.a{constructor(wb,kb,tb){super(wb,kb);this.qAb=tb;this.Ir=!0}pn(wb){super.pn(wb);O.HelperMethods.FW(this.businessBar.$.AG,this.qAb,this.businessBar.$.WS)}}Object(t.a)(U,"HelpButtonBusinessBarEntry",z.a,[]);class ca extends z.a{constructor(wb,kb,tb){super(wb,kb);this.qAb=tb;this.rxa=!0}Kna(wb){super.Kna(wb);O.HelperMethods.FW(this.businessBar.$.AG,
this.qAb,this.businessBar.$.WS)}}Object(t.a)(ca,"HelpTextBusinessBarEntry",z.a,[]);var Q=a(80);class Y extends z.a{constructor(wb,kb,tb,hb){super(wb,kb);this.qAb=tb;this.command=hb;this.rxa=!0;this.Ir=1461300262!==hb}pn(wb){super.pn(wb);this.businessBar.$.Ia.Nb(new M.a(this.command,wb,this.businessBar.$.Bc,10,null))}Kna(wb){super.Kna(wb);const kb=new M.a(-859308420,wb,this.businessBar.$.Bc,12,null);this.businessBar.$.Ia.Nb(kb,{[Q.a.$f]:"HelpID="+this.qAb,["InputMethod"]:wb,[Q.a.Uc]:w.a.OV,[w.a.Upa]:!0})}}
Object(t.a)(Y,"HelpTextTaskPaneAndCommandBusinessBarEntry",z.a,[]);class la extends z.a{constructor(wb,kb){super(wb,kb);this.NV=this.Ir=!0}pn(wb){super.pn(wb);this.set_visible(!1);this.businessBar.$.MI();this.businessBar.$.Ia.Nb(new M.a(-1081442996,wb,this.businessBar.$.Bc,10,null))}wW(wb){super.wW(wb);this.businessBar.$.Ia.Nb(new M.a(1702917262,wb,this.businessBar.$.Bc,10,null))}LD(wb){this.businessBar.removeEntry(59);G.g(wb)}}Object(t.a)(la,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",
z.a,[]);var ea=a(1088);class ha extends z.a{constructor(wb,kb){super(wb,kb);(this.policyManager=wb.$.da.Aa(274))?(this.message=this.policyManager.fuc,this.title=this.policyManager.title,this.rxa=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Kna(wb){super.Kna(wb);(wb=this.policyManager.S0i)&&wb(null)}}Object(t.a)(ha,"PolicyBusinessBarEntry",z.a,[]);var X=a(1086),T=
a(1090),ua=a(1089);a(427);var Ha=a(154),Ca=a(26);class Ga extends z.a{constructor(wb,kb){super(wb,kb);this.Ir=!0;this.title=""}pn(wb){super.pn(wb);Ha.c(Ca.a.uQi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(t.a)(Ga,"UnsupportedBrowserBusinessBarEntry",z.a,[]);var sa=a(1083),bb=a(88),Ba=a(881),qa=a(935),pa=a(1254);class ya{constructor(){this.IJc=new pa.a;this.GJc=new pa.a;this.FJc=new pa.a;this.L0g(this.IJc);this.K0g(this.GJc);this.J0g(this.FJc);this.IOc=new pa.a;
this.HOc=new pa.a;this.GOc=new pa.a;this.k3g(this.IOc);this.j3g(this.HOc);this.i3g(this.GOc);this.XKc=new pa.a;this.d1g(this.XKc);this.yHa(this.XKc);this.yHa(this.FJc);this.yHa(this.GJc);this.yHa(this.IJc);this.yHa(this.HOc);this.yHa(this.IOc);this.yHa(this.GOc)}p9h(wb,kb){switch(wb){case 1:return this.Ibi(kb);case 2:return this.FTh(kb)}return qa.a.zWd?this.XKc:null}L0g(wb){wb.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);wb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
wb.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}K0g(wb){wb.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);wb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);wb.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}J0g(wb){wb.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);wb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);wb.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}k3g(wb){wb.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);wb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);wb.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);wb.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);wb.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);wb.add("OverlayBig","Get the Word app");wb.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");wb.add("OverlaySmallSplit1",
"Discover Word");wb.add("OverlaySmallSplit2","designed for the iPad.");wb.add("SkipButton","Skip for now")}d1g(wb){wb.add("Headline","Get the Office Online extension for Chrome");wb.add("UseAppButton","Get the extension");wb.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}j3g(wb){wb.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);wb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);wb.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
wb.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);wb.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);wb.add("OverlayBig","Get the PowerPoint app");wb.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");wb.add("OverlaySmallSplit1","Discover PowerPoint");wb.add("OverlaySmallSplit2","designed for the iPad.");wb.add("SkipButton","Skip for now")}i3g(wb){wb.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
wb.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);wb.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);wb.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);wb.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}yHa(wb){wb.add("Corporation","Microsoft Corporation")}Ibi(wb){switch(wb){case 3:return this.IOc;case 2:return this.HOc;case 1:return this.GOc}return null}FTh(wb){switch(wb){case 3:return this.IJc;case 2:return this.GJc;
case 1:return this.FJc}return null}static get instance(){ya.Ma||(ya.Ma=new ya);return ya.Ma}}ya.Ma=null;Object(t.a)(ya,"WildFireStringFactory",null,[]);var za=a(6),cb=a(43);class Pa{constructor(wb,kb,tb,hb,Fb=null,va=null){this.ZSc=null;this._id=wb;this.HTc=kb;this.yBg=Fb;this.Blb=hb;this.Lnb=va;this.jEa=null;this.WZa=tb;this.lob=ya.instance.p9h(kb,wb)}XJe(){this.jEa=new Ba.a(this.title,this.message,null);this.jEa.addButton(this.ABe,Object(bb.a)(this,this.EDf,"onButtonOneClick"),"");this.WZa&&this.jEa.BOg(this.CBe,
Object(bb.a)(this,this.HDf,"onButtonTwoClick"));this.jEa.Paa=Object(bb.a)(this,this.wPe,"dismissBar");this.jEa.image=3;this.jEa.id=16;this.jEa.closeable=!0}get title(){return this.lob.ma("Headline")}get message(){return this.lob.ma("CallToAction")}get K9j(){return this.WZa}get ABe(){return this.WZa?this.lob.ma("InstallButton"):this.lob.ma("UseAppButton")}get CBe(){return this.WZa?this.lob.ma("OpenAppButton"):""}EDf(){this.WZa?this.Noi():this.A9j()}HDf(){this.WZa&&this.u7i()}get openUrl(){this.ZSc||
(this.ZSc=this.yBg());return this.ZSc}Noi(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Blb&&this.Lnb&&this.Lnb();qa.a.$Wf(this._id,this.HTc)}u7i(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Blb&&this.Lnb&&this.Lnb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(qa.a.uwe(this._id),this.openUrl,0,!1))}A9j(){qa.a.zWd?this.p3g():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),qa.a.GUd("BizBarClicked"),
1!==this.HTc&&2!==this.HTc||qa.a.S9g(this.openUrl,this.Blb,this._id,this.Lnb))}p3g(){this.Blb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");cb.a.rV(za.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Frh(){this.Blb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");qa.a.GUd(qa.a.E8g)}wPe(){qa.a.zWd?this.Frh():(qa.a.GUd(qa.a.x3e(this._id)),
c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static pmh(){const wb=za.AFrameworkApplication.sa.Pa,kb=new Pa(wb.$i,qa.a.gbf(),8<l.a.GAb,1===wb.Sza,()=>wb.rz,wb.$xj());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return kb}}Object(t.a)(Pa,"WildFireBusinessBar",null,[]);class nb extends z.a{constructor(wb,kb){super(wb,kb);this.TDa=Pa.pmh();this.Ir=!0;this.NV=this.TDa.K9j;this.title=this.TDa.title;this.message=this.TDa.message}get actionButton(){return this.TDa.ABe}get Gta(){return this.TDa.CBe}pn(wb){super.pn(wb);
this.TDa.EDf(null)}wW(wb){super.wW(wb);this.TDa.HDf(null)}LD(wb){super.LD(wb);this.TDa.wPe(null)}}Object(t.a)(nb,"WildFireMobileAppBusinessBarEntry",z.a,[]);var Ma=a(259),Oa=a(23),La=a(192),ra=a(173),V=a(46),ma=a(2),W=a(181),aa=a(1091),ia=a(68),ka=a(134);class Xa extends z.a{constructor(wb,kb,tb,hb){super(wb,kb);this.officeScriptsCommandManager=tb.da.Aa(519);c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=W.a.create();this.$=tb;this.title=P.a.instance.ha(2282);this.message=
"";this.YYd=P.a.instance.ha(2278);this.yqg=P.a.instance.ha(2279);this.wqg=P.a.instance.ha(2280);this.pIe=P.a.instance.ha(2281);this.update(hb)}update(wb){this.scriptLink=wb.scriptLink;this.runStatus=wb.runStatus;this.buttonText=wb.buttonText||"";this.mHi(wb.clickId);this.ouj();"preparing"===this.runStatus?(this.bpa(0),this.message=String.format(P.a.instance.qb(208),this.buttonText),this.Ir=!0,this.kta=this.YYd,this.btb=this.Lha=this.wbb):"running"===this.runStatus?(this.bpa(0),this.message=String.format(P.a.instance.qb(207),
this.buttonText),this.Ir=!0,this.kta=this.YYd,this.btb=this.Lha=this.wbb):"succeeded"===this.runStatus?(this.bpa(0),this.message=String.format(P.a.instance.qb(210),this.buttonText),"true"===wb.hasLogs?(this.Ir=!0,this.kta=this.wqg,this.Lha=this.zNf,this.NV=!0,this.e0c=this.yqg,this.f0c=this.ANf):(this.Ir=!0,this.kta=this.yqg,this.Lha=this.ANf)):"runFailed"===this.runStatus?(this.bpa(1),this.message=String.format(P.a.instance.qb(209),this.buttonText),this.p7a=ab.Sja,"true"===wb.hasLogs?(this.Ir=!0,
this.kta=this.wqg,this.Lha=this.zNf,"false"===wb.isOwner&&(this.NV=!0,this.e0c=this.pIe,this.f0c=this.KEf)):"false"===wb.isOwner&&(this.Ir=!0,this.kta=this.pIe,this.Lha=this.KEf)):"fetchFailed"===this.runStatus?(this.bpa(1),this.p7a=ab.Sja,this.message=P.a.instance.ha(2284)):"canceled"===this.runStatus?(this.bpa(0),this.p7a=ab.Zy,this.message=String.format(P.a.instance.qb(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.bpa(5),this.p7a=ab.Zy,this.message=String.format(P.a.instance.qb(211),
this.buttonText),this.Ir=!0,this.kta=this.YYd,this.btb=this.Lha=this.wbb):"initializing"===this.runStatus&&(this.bpa(0),this.p7a=ab.Ii,this.message=P.a.instance.ha(2283))}get tk(){return this.p7a}get actionButton(){return this.kta}get Gta(){return this.e0c}pn(wb){super.pn(wb);this.Lha&&this.Lha()}wW(wb){super.wW(wb);this.Gta&&this.f0c()}LD(wb){super.LD(wb);this.btb&&this.btb()}ouj(){this.message="";this.p7a=ab.Ii;this.Ir=!1;this.kta="";this.Lha=void 0;this.NV=!1;this.e0c="";this.f0c=void 0;this.hideCloseButton=
!1;this.btb=void 0}wbb(){const wb=W.a.create().toString();this.officeScriptsCommandManager.Pci(wb);this.Xnc(-2186799,wb)}zNf(){const wb=W.a.create().toString();this.officeScriptsCommandManager.Oci(wb);this.Xnc(1036446140,wb)}ANf(){const wb=W.a.create();if(this.scriptLink){const kb=new aa.b(this.scriptLink);this.officeScriptsCommandManager.qdf(this.id.toString(),JSON.stringify(kb),wb)}this.Xnc(-585097204,wb.toString())}KEf(){const wb=W.a.create().toString();this.officeScriptsCommandManager.Nci(wb);
this.Xnc(-639858579,wb)}mHi(wb){const kb=[];kb.push(Object(ma.a)(new ia.a,{name:"id",string:this.id.toString()}));kb.push(Object(ma.a)(new ia.a,{name:"hasScriptLink",bool:!!this.scriptLink}));kb.push(Object(ma.a)(new ia.a,{name:"runStatus",string:this.runStatus}));kb.push(Object(ma.a)(new ia.a,{name:"clickId",string:wb}));kb.push(Object(ma.a)(new ia.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));Ha.a(ka.a.RSi,void 0,void 0,kb)}Xnc(wb,kb){const tb=[];tb.push(Object(ma.a)(new ia.a,
{name:"id",string:this.id.toString()}));tb.push(Object(ma.a)(new ia.a,{name:"hasScriptLink",bool:!!this.scriptLink}));tb.push(Object(ma.a)(new ia.a,{name:"runStatus",string:this.runStatus}));tb.push(Object(ma.a)(new ia.a,{name:"clickId",string:kb}));Ha.d(wb,void 0,void 0,void 0,void 0,void 0,tb)}}Object(t.a)(Xa,"OfficeScriptsRunStatusBusinessBarEntry",z.a,[]);var sb=a(51),ib=a(1);class Ub extends A.a{constructor(wb,kb,tb,hb,Fb,va){super(wb,kb,tb);sb.a.instance.create(()=>{this.showCallout(kb,hb)},
Fb,va,!0,!0)}showCallout(wb,kb){if(this.businessBar&&this.businessBar.hma(wb.l1a)&&this.tve()){wb=new M.a(-847286761,0,this.businessBar.$.Bc,0,null);var tb={};tb.CalloutName=kb;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?tb.Target=this.vK():tb.Target=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.qP.domElement;this.businessBar.$.Ia.Nb(wb,tb)}}tve(){return!0}}
Object(t.a)(Ub,"CalloutBusinessBarEntry",A.a,[]);class hc extends Ub{constructor(wb,kb,tb,hb,Fb,va){super(wb,kb,tb,hb,Fb,va)}tve(){if(!ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const wb=this.businessBar.$.da.Aa(465);return wb&&wb.Uyc?!1:!0}}Object(t.a)(hc,"OptimizeWorkbookCalloutBusinessBarEntry",Ub,[]);var yb=a(19);class Gb extends z.a{constructor(wb,kb,tb){super(wb,kb);this.update(tb)}update(wb){this.title=
wb.title?wb.title:"";this.message=wb.message?wb.message:"";this.bpa(this.leh(wb.businessBarType));this.hideCloseButton=!!wb.hideCloseButton}leh(wb){switch(wb){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(t.a)(Gb,"MsFormsDataSyncStatusBusinessBarEntry",z.a,[]);class Sa extends z.a{constructor(wb,kb,tb,hb){super(wb,kb);this.NV=this.Ir=!0;this.Fdj=tb;this.cVg=hb}pn(wb){super.pn(wb);this.businessBar.$.Ia.Nb(new M.a(this.Fdj,
wb,this.businessBar.$.Bc,10,null))}wW(wb){super.pn(wb);this.businessBar.$.Ia.Nb(new M.a(this.cVg,wb,this.businessBar.$.Bc,10,null))}}Object(t.a)(Sa,"DualCommandActionsBusinessBarEntry",z.a,[]);class db extends z.a{constructor(wb,kb,tb,hb){super(wb,kb);this.host=tb.xa.HostName;this.Dii="OneDriveWOPI"===this.host||"Open From URL"===this.host;"Open From URL"===this.host?appChrome.renderSaveACopyToOneDriveCallout(hb):(this.wzi=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDrive",
!1)||ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveB",!1)||ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveC",!1))&&this.Dii&&appChrome.renderSaveACopyToOneDriveCallout(hb)}}Object(t.a)(db,"EditAttemptReadOnlyNoEditPermissionsBusinessBarEntry",z.a,[]);var fb=a(1087);a.d(C,"BusinessBarControl",function(){return ab});class ab extends v.a{constructor(wb,kb){super(kb);this.V0e=u.DOMElementExtensions.Uq+",div";this.KU=Array(71);
this.Wm=!1;this.AW=tb=>{if(tb.Da.keyCode===b.a.Xy){var hb=this.rc.querySelectorAll(this.V0e);const Fb=u.DOMElementExtensions.Pl(hb);hb=u.DOMElementExtensions.mB(hb);return u.DOMElementExtensions.eCa(tb.Da,Fb,hb)}return!1};this.pb=wb;this.set_visible(!1);this.addCssClass(x.a.Eyh);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(x.a.Gyh);f.KeyInputManager.instance.ta(e.a.fc,this.rc,this.AW);m.a(wb).ti(this)}get je(){return Ma.a.S2c}get rc(){return this.domElement}get Qf(){return this.get_visible()}get $(){return this.pb}pg(wb,
kb){ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?kb||u.DOMElementExtensions.setFocus(u.DOMElementExtensions.Pl(this.rc.querySelectorAll(this.V0e))):kb||u.DOMElementExtensions.setFocus(this.domElement.firstChild);return!kb}Gh(wb){return u.DOMElementExtensions.Mf(this.rc,wb)}Bj(){}hk(){}dispose(){this.Wm||(f.KeyInputManager.instance.Ba(e.a.fc,this.rc,this.AW),d.a.wc(this.KU),this.KU=Array(71),this.pb=null,super.dispose(),this.Wm=!0)}hma(wb){if(!this.get_visible())return!1;
wb=this.KU[wb];return!!wb&&wb.isVisible}Chd(wb){return this.hma(wb)?this.KU[wb].vK():null}rH(wb){return!!this.KU[wb]}ORb(wb,kb){if(wb=this.KU[wb])wb.update(kb),wb.A5j()}JE(wb,kb,tb=null,hb=null){let Fb=!1;if(this.rH(wb))tb=this.KU[wb].get_visible();else{this.set_visible(!0);const va=ab.obf()[wb];this.KU[wb]=this.dba(wb,kb,tb,hb);tb=!1;Fb=!0;hb="";let jb=0;kb&&(hb=kb.MessageIdName,jb=kb.MessageId);const Ab=va.RKa,Qa=V.PageLoadTrackingInfo.instance.Ywa(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${wb}, time from app interactive: ${Qa}`);
ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===va.businessBarType||ra.a(this.$).lPd(va.hash,hb,jb,h.a.CFc,!0,1,kb,Ab)}tb||!y.BusinessBarManager.Wfc().includes(wb)&&!Fb||(this.KU[wb].set_visible(!0),this.$.MI())}removeEntry(wb){return this.Qnj(wb)}mNd(){d.a.wc(this.KU);this.KU=Array(71);this.set_visible(!1)}Qnj(wb){if(!this.rH(wb))return!1;d.a.Ja(this.KU[wb]);this.KU[wb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.MI();return!0}dba(wb,
kb,tb=null,hb=null){const Fb=ab.obf()[wb],va=!!(this.$.Nd&64);switch(wb){case 23:wb=new db(this,Fb,this.pb,this.rc);break;case 2:case 4:case 25:case 26:case 36:case 35:wb=new z.a(this,Fb);break;case 12:case 29:case 30:case 31:case 32:case 57:wb=va?new A.a(this,Fb,-8805455):new z.a(this,Fb);break;case 34:wb=va?new Sa(this,Fb,-8805455,-104572626):new z.a(this,Fb);break;case 22:wb=new F(this,Fb,-8805455);break;case 46:case 45:wb=va?new R(this,Fb,kb,0,-8805455):new B(this,Fb,kb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:wb=
new B(this,Fb,kb,0);break;case 19:wb=new z.a(this,Fb);break;case 47:wb=new B(this,Fb,kb,0);break;case 6:case 14:wb=new U(this,Fb,kb.HelpTopicId);break;case 67:case 65:wb=new ca(this,Fb,kb.HelpTopicId);break;case 37:wb=new ca(this,Fb,w.a.snh);break;case 38:wb=new z.a(this,Fb);break;case 68:wb=new F(this,Fb,924877417);break;case 16:wb=new z.a(this,Fb);wb.title=r.a.Jh(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);wb.message=r.a.Jh(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);
break;case 18:wb=new A.a(this,Fb,-1762562205);wb.hideCloseButton=!0;break;case 20:wb=new nb(this,Fb);break;case 21:case 56:wb=new z.a(this,Fb);break;case 28:wb=new z.a(this,Fb);break;case 24:wb=new Ga(this,Fb);break;case 27:wb=new ha(this,Fb);break;case 39:wb=new sa.a(this,Fb);break;case 40:wb=new n.a(this,Fb);break;case 41:wb=new X.a(this,Fb);break;case 42:wb=new ea.a(this,Fb);break;case 48:wb=new z.a(this,Fb);break;case 49:wb=new z.a(this,Fb);break;case 50:wb=new z.a(this,Fb);break;case 51:wb=new z.a(this,
Fb);break;case 52:wb=new z.a(this,Fb);break;case 53:wb=new ua.a(this,Fb);break;case 54:wb=new T.a(this,Fb);break;case 55:wb=new N(this,Fb);break;case 5:wb=new I(this,Fb);break;case 58:wb=new A.a(this,Fb,-1753056834);kb?(kb=kb.Directive,Oa.a.$q(kb)||"&nbsp;"===kb||(wb.message=kb)):tb&&(wb.message=tb);break;case 59:wb=new la(this,Fb);break;case 60:wb=new z.a(this,Fb);break;case 63:wb=new ca(this,Fb,w.a.TRi);break;case 61:wb=new Y(this,Fb,w.a.DZg,-8805455);break;case 66:wb=new Y(this,Fb,w.a.cjj,1461300262);
break;case 62:wb=new hc(this,Fb,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");wb.message=tb;break;case 70:wb=new fb.a(this,Fb,-1190551534);break;case 64:wb=new Xa(this,Fb,this.$,hb);break;case 69:wb=new Gb(this,Fb,hb);break;default:wb=new B(this,Fb,kb,7)}wb.XJe();return wb}static obf(){let wb;wb=La.a.lma()?261:260;return ab.pBe||(ab.pBe=[new E(0,276,277,278,0,0,ab.Sja,1,"BB_UnableToRefreshLock"),new E(1,276,277,278,0,0,ab.Sja,1,"BB_UnableToRefreshLockExpected"),new E(2,
268,269,0,0,0,ab.Zy,5,"BB_WorkbookAlmostTooLarge"),new E(3,270,271,272,0,0,ab.Sja,1,"BB_WorkbookTooLarge"),new E(4,259,wb,0,0,0,ab.Zy,5,"BB_ExternalWorkbookLinksDisabled"),new E(5,263,262,264,0,0,ab.Sja,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new E(6,265,266,267,0,0,ab.Ii,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new E(7,251,252,253,0,0,ab.Ii,5,"BB_UnsupportedFeatures"),new E(8,0,0,0,0,0,ab.Ii,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new E(9,0,0,0,0,0,ab.Ii,0,"BB_CollabDataStringsLocaleMismatch"),
new E(10,0,0,0,0,0,ab.Ii,0,"BB_CollabDataLocaleMismatch"),new E(11,279,280,281,0,0,ab.Sja,1,"BB_LastGenericStatusError"),new E(12,282,283,284,0,0,ab.Zy,5,"BB_ScratchPadWarning"),new E(13,285,286,287,0,0,ab.Sja,1,"BB_AuthenticationLost"),new E(14,288,289,290,0,0,ab.Zy,5,"BB_OdfCompatibilityIssues"),new E(15,0,575,0,0,0,ab.Zy,5,"BB_PivotChartInteractivityMissingWarning"),new E(16,0,0,0,0,0,ab.Ii,2,"BB_WorkbookIsIrmProtected"),new E(17,0,0,0,0,0,ab.Ii,0,"BB_BIFeatureNotAvailable"),new E(18,291,292,287,
0,0,ab.Zy,5,"BB_AnonymousCreateMode"),new E(19,254,255,0,0,0,ab.Zy,5,"BB_UnsupportedInteractiveReportEditing"),new E(20,0,0,0,0,0,ab.Ii,0,"BB_MobileAppCampaignBizBar"),new E(21,297,298,0,0,0,ab.Ii,0,"BB_TransientServerCommunicationFailures"),new E(22,1643,1654,1655,0,0,ab.Ii,5,"BB_EditAttemptInReadOnly"),new E(23,1643,1654,0,0,0,ab.Ii,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new E(24,0,O.HelperMethods.U4j(),1632,0,0,ab.Ii,3,"BB_UnsupportedBrowser"),new E(25,300,301,0,0,0,ab.Ii,2,"BB_ReadOnlyPermissions"),
new E(26,302,303,0,0,0,ab.Ii,2,"BB_DocumentIsIrmProtectedWarning"),new E(27,0,0,0,0,0,ab.Zy,5,"BB_PolicyWarningMessage"),new E(28,1285,299,0,0,0,ab.Ii,0,"BB_WorkingOnIt"),new E(29,1643,1641,1642,0,0,ab.Ii,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new E(30,1656,1657,1658,0,0,ab.Ii,5,"BB_WorkbookIsReadOnlyRecommended"),new E(31,1643,1659,1660,0,0,ab.Ii,5,"BB_WorkbookHasPasswordToModify"),new E(32,1643,1661,1664,0,0,ab.Ii,3,"BB_LegacySharedWorkbookEditWarning"),new E(33,1651,1662,253,0,0,ab.Ii,
5,"BB_LegacyConnectionsWarning"),new E(34,1643,1960,1961,1962,0,ab.Ii,0,"BB_TooManyLoadBlockingFloatingObjects"),new E(35,1652,1653,0,0,0,ab.Ii,2,"BB_GroupedSlicers"),new E(36,313,314,0,0,0,ab.Zy,5,"BB_ThirdPartyAddinDisabled"),new E(37,1789,1790,0,0,1791,ab.Ii,5,"BB_FinanceLinkedEntityDisclaimerBar"),new E(38,1818,1819,0,0,0,ab.Zy,5,"BB_WolframDeprecationAlertBar"),new E(39,0,0,0,0,0,ab.Ii,0,"BB_WacGdprNotice"),new E(40,0,0,0,0,0,ab.Ii,0,"BB_AutomaticSensitivityLabel"),new E(41,0,0,0,0,0,ab.Ii,0,
"BB_RecommendedSensitivityLabel"),new E(42,0,0,0,0,0,ab.Ii,0,"BB_MandatorySensitivityLabel"),new E(43,315,316,317,0,0,ab.Ii,0,"BB_LocalStorageDisabled"),new E(44,632,633,0,0,0,ab.Ii,0,"BB_AutoRefreshDisabled"),new E(45,1014,1012,1016,1314,0,ab.Ii,4,"BB_CorruptedFileRepaired"),new E(46,1015,1013,1016,1314,0,ab.Ii,5,"CorruptedOdsFileRepaired"),new E(47,273,274,275,0,0,ab.Zy,5,"BB_MinorVersionLimitReached"),new E(48,304,305,0,0,0,ab.Zy,5,"BB_SensitivityApplicationGenericError"),new E(49,306,308,0,0,
0,ab.Zy,5,"BB_SensitivityApplicationTooLargeFileError"),new E(50,307,308,0,0,0,ab.Zy,5,"BB_SensitivityApplicationLabelNotSupportedError"),new E(51,309,310,0,0,0,ab.Zy,5,"BB_SensitivityApplicationLabelDisabledError"),new E(52,311,312,0,0,0,ab.Zy,5,"BB_SensitivityApplicationMandatoryConflictError"),new E(53,0,0,0,0,0,ab.Zy,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new E(54,0,0,0,0,0,ab.Zy,5,"BB_SensitivityApplicationSetLabelError"),new E(55,2119,2120,2121,2124,0,ab.Ii,5,"BB_ExternalWorkbookLinksPromptEnableContent",
"Warning_MessageBar_16"),new E(56,297,298,0,0,0,ab.Ii,0,"BB_NetworkDown"),new E(57,318,319,320,0,0,ab.Ii,2,"BB_DefaultToViewDueToCogs"),new E(58,1815,1816,1817,0,0,ab.Ii,1,"BB_RefreshLinkedEntityErrorBar"),new E(59,1792,1793,1794,1795,0,ab.Ii,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new H(60,250,0,0,0,ab.Ii,5,"BB_CanvasHealth"),new E(61,1017,1018,1314,0,1019,ab.Ii,5,"BB_MismatchedFileFormatConverted"),new E(62,2238,0,2240,0,0,ab.Ii,5,"BB_OptimizeWorkbook"),new E(63,321,322,0,0,323,ab.Ii,0,"BB_NovModePostDepreciation"),
new E(64,0,0,0,0,0,ab.Ii,0,"BB_OfficeScriptsRunning"),new E(65,2214,2215,0,0,2217,ab.Ii,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new E(66,324,325,0,0,326,ab.Ii,5,"BB_ReadOnlyPivotTable"),new E(67,2214,2216,0,0,2217,ab.Ii,0,"BB_PowerQueryRefreshHostNotSupported"),new E(68,1057,l.a.blc?1059:1058,1056,0,0,ab.Ii,4,"BB_RefreshPageAfterEnablingTheExtension"),new E(69,0,0,0,0,0,ab.Ii,0,"BB_MsFormsDataSyncStatus"),new E(70,0,0,0,0,0,ab.Zy,5,"BB_DataCleansingSuggestions")])}}ab.Sja=yb.a.NBh;ab.Zy=yb.a.PBh;
ab.Ii=yb.a.OBh;ab.pBe=null;Object(t.a)(ab,"BusinessBarControl",v.a,[36])},1202:function(t,C,a){t={};a.r(t);a.d(t,"CalcManager",function(){return Pa});var c=a(0),b=a(14),f=a(228),e=a(159),d=a(9),h=a(117);a(182);var r=a(198),l=a(89),u=a(189),v=a(109),x=a(73);class w{}w.local="Local";w.pYj="Thread";Object(c.a)(w,"RecalcServiceCreateMode",null,[]);var m=a(184);class n{constructor(V){this.c9d=null;this.init(V)}get Qaa(){return this.c9d}init(V){this.c9d=new u.a;if(void 0!==V&&null!==V&&void 0!==V.HeadersList&&
null!==V.HeadersList&&0<V.HeadersList.length)for(const ma of V.HeadersList)this.Qaa.ia(ma.Index,ma.Name)}}Object(c.a)(n,"ColHeadersListData",null,[]);var z=a(1),y=a(33),A=a(106),F=a(23),D=a(21),B=a(186);class M{constructor(V,ma){this.TBe=V;this.sheetName=ma;this.TNb=!1}}Object(c.a)(M,"CalcBlockInformation",null,[]);class R{constructor(V,ma,W,aa,ia){this.type=V;this.fullName=ma;this.range=W;this.sheetId=aa;this.attributes=ia;this.dF=null}}Object(c.a)(R,"CalcNamedObject",null,[]);class P{get Ak(){return this.Ame}constructor(V){this.epg=
V;this.Ame=[];this.e2d=[];this.w1a={};this.vVd=new Map}Z9f(V,ma){this.Ame[V]=ma;this.epg&&ma.G8&&this.vVd.set(ma.G8.sheetName,V)}getSheetIndex(V){if(this.epg){if(this.vVd.has(V))return this.vVd.get(V)}else for(let ma=1;ma<this.Ak.length;ma++)if(F.a.equals(this.Ak[ma].G8.sheetName,V,!1))return ma;return-1}}Object(c.a)(P,"GridCache",null,[]);var E=a(708),H=a(562);class G{constructor(V){this.G8=V;this.a7=new E.a(H.a.$h());this.Tpc=!1}}Object(c.a)(G,"SheetInformation",null,[]);var N=a(974),I;(function(V){V[V.initialization=
0]="initialization";V[V.contentReady=1]="contentReady";V[V.cellEdit=2]="cellEdit"})(I||(I={}));Object(c.b)("UpdateDataTrigger",I);class O{constructor(V){this.eMd=null;this.Byd=this.dMd=this.tGd=!1;this.$Jd=0;this.SJd=this.UJd=this.VJd=this.TJd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.sq=this.errorTypeNames=null;this.Ds=this.currentStateId=-1;this.tja="";this.nba=null;this.getNameLoc=(ma,W)=>this.Rkc()?this.nf.ma(this.currentStateId).Ak[0].a7.nb(W)?
(ma=excelOnlineCalc.location.nameLoc(ma,W),excelOnlineCalc.util.success(ma)):excelOnlineCalc.util.success(null):(ma=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ma));this.getContainingTable=ma=>{if(!this.Rkc())return ma=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ma);const W=ma.range.col,aa=ma.range.row;var ia=this.nf.ma(this.currentStateId).Ak[0].a7,ka=null;for(let Xa of ia)if(ia=Xa.value,2===ia.type&&F.a.equals(ma.sheet.index.toString(),ia.sheetId,!0)){const sb=
ia.range;W>=sb.left-1&&W<=sb.right-1&&aa<=sb.bottom-1&&aa>=sb.top-1&&(ka=excelOnlineCalc.location.nameScope(this.documentLoc,ia.sheetId),ka=excelOnlineCalc.location.nameLoc(ka,ia.fullName))}return ka?excelOnlineCalc.util.success(ka):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ma,W)=>{if(!this.Rkc()){var aa=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(aa)}aa=ma.name;var ia=this.nf.ma(this.currentStateId).Ak[0].a7;if(ia.nb(aa)){ia=ia.ma(aa);const Xa=ia.range;
if(2!==ia.type)return excelOnlineCalc.util.failure(this.y8c(5));const sb=ia.dF?ia.dF.Qaa:null;if(!sb)return excelOnlineCalc.util.success(null);for(var ka of sb)if(F.a.equals(ka.value,W,!0))return ma=excelOnlineCalc.location.documentLoc(ma.scope.document.path,ma.scope.document.name),ma=excelOnlineCalc.location.sheetIndex(ma,ia.sheetId),ka=excelOnlineCalc.location.gridRange(Xa.top-1,ka.key,Xa.bottom-Xa.top+1,1),ka=excelOnlineCalc.location.sheetGridRange(ma,ka),aa=excelOnlineCalc.location.structRefColumnLoc(aa,
ka,!!(ia.attributes&16),!!(ia.attributes&8)),excelOnlineCalc.util.success(aa);return Xa.right-Xa.left+1!==sb.count?(aa=excelOnlineCalc.util.unavailable([17,ma,W]),excelOnlineCalc.util.failure(aa)):excelOnlineCalc.util.failure(this.y8c(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ma,W)=>{if(!this.Rkc())return W=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(W);var aa=this.nf.ma(this.currentStateId).Ak[0].a7;if(aa.nb(ma.name)){var ia=aa.ma(ma.name);
if(2!==ia.type)return excelOnlineCalc.util.failure(this.y8c(5));aa=!!(ia.attributes&16);const ka=!!(ia.attributes&8),Xa=aa?1:0,sb=ka?1:0;ma=excelOnlineCalc.location.documentLoc(ma.scope.document.path,ma.scope.document.name);ma=excelOnlineCalc.location.sheetIndex(ma,ia.sheetId);ia=ia.range;let ib={};if(1===W)ib=excelOnlineCalc.location.gridRange(ia.top-Xa-1,ia.left-1,ia.bottom+sb-ia.top+Xa+1,ia.right-ia.left+1);else if(2===W)ib=excelOnlineCalc.location.gridRange(ia.top-1,ia.left-1,ia.bottom-ia.top+
1,ia.right-ia.left+1);else if(3===W)if(aa)ib=excelOnlineCalc.location.gridRange(ia.top-2,ia.left-1,1,ia.right-ia.left+1);else return excelOnlineCalc.util.success(null);else if(4===W)if(ka)ib=excelOnlineCalc.location.gridRange(ia.bottom,ia.left-1,1,ia.right-ia.left+1);else return excelOnlineCalc.util.success(null);W=excelOnlineCalc.location.sheetGridRange(ma,ib);return excelOnlineCalc.util.success(W)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(ma,W)=>{if((F.a.equals(ma,this.documentLoc.path,
!0)||!ma)&&F.a.equals(W,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);ma=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ma,W)]);return excelOnlineCalc.util.failure(ma)};this.getSheetIndex=(ma,W)=>{if(!this.nf.nb(this.currentStateId)||!this.nf.ma(this.currentStateId).Ak)return W=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(W);ma=this.nf.ma(this.currentStateId).Ak;for(let aa=1;aa<ma.length;aa++)if(F.a.equals(ma[aa].G8.sheetName,
W,!0))return excelOnlineCalc.util.success(ma[aa].G8.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(ma,W)=>{if(!this.nf.nb(this.currentStateId)||!this.nf.ma(this.currentStateId).Ak)return W=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(W);ma=this.nf.ma(this.currentStateId).Ak;for(let aa=1;aa<ma.length;aa++)if(F.a.equals(ma[aa].G8.sheetId,W,!0))return excelOnlineCalc.util.success(ma[aa].G8.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=
()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.wJf=()=>{this.setNumberFormats()};this.yd=()=>{b.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.nf=new u.a;this.currentStateId=this.Ds=-1;this.tja="";this.e3a=null;this.dMd=!1;this.sq&&this.clearCache()};this.kd=V;
this.nf=new u.a;this.e3a=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.kd.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.kqa();this.atd=y.a.atd();this.s6=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1);this.exi=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NoCompareCalcModelExpFF1",!1);this.fxi=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NoCompareCalcModelExpFF2",!1);this.Lsd=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7717008_CalcBlocksExtendedTelemetry");
this.pui=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7737506_fixCalcUsedRangeForFreezePanes")}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.tOd(this.wJf);this.kd&&this.kd.lm(this.yd);this.close()}MRb(V){if(!this.sq)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.kd.da.Aa(268),!this.instantaneousSupportInformationManager))return b.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),
!1;2!==V&&(this.currentStateId=this.kd.ea.QEb,this.currentStateId===d.a.ue&&(this.currentStateId=this.kd.ea.Ee));if(1===V&&this.currentStateId<this.Ds)return b.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Ds} - ignoring update`),!1;this.eEj();0!==V&&this.dMd||(this.GIj(),this.HFj(),this.vGj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Qte(this.wJf),this.kd.rl(this.yd),this.dMd=!0);this.Cjj();
let ma=!1;0===V&&(ma=this.Hmi());if(0!==V||ma)this.PHj()?(this.sIj(V),this.rIj(),this.Ds=this.currentStateId,this.S8g()):b.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==V&&this.resumeRecalc();return!0}evalFormula(V,ma,W,aa){if(!this.sq)return b.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ma=excelOnlineCalc.calc.sheetCellLocation(null!==W&&void 0!==
W?W:x.d(this.kd.ua.na),ma.top-1,ma.left-1);V=this.sq.evalFormula(this.kd.ea.Ee,V,ma,aa);this.resumeRecalc();return V}w4g(V,ma,W,aa=null){const ia=x.d(this.kd.ua.na);let ka=V.cell.lR-1,Xa=V.cell.kR-1;var sb=ka,ib=Xa;let Ub=null;aa&&(Ub=excelOnlineCalc.calc.cellLocation(ka,Xa),ka=aa.top-1,Xa=aa.left-1,sb=aa.bottom-1,ib=aa.right-1);W=this.O3d(V,W,"SetCell");0>W||(ib=O.jba("CalculateFormula.cell",ia,ka,Xa,sb,ib),sb=[],aa=this.mmd(ia),ma=excelOnlineCalc.calc.inferredRangeFormulaEdit(ib,ma,Ub,aa),sb.push(ma),
V=(ma=this.Yaf())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ia,ka,Xa,F.a.Tve(V.cell.text),W,ma.top-1,ma.left-1,ma.bottom-1,ma.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ia,ka,Xa,F.a.Tve(V.cell.text),W,"","","",""),b.ULS.sendTraceTag(537170180,0,50,V),this.sq.editRangeFormulas(W,sb),this.resumeRecalc())}r4a(V,ma,
W,aa,ia){if(!this.sq)return b.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!W||!ma)return b.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!W}, outputColumnRange null: ${!ma}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");b.ULS.shipAssertTag(537170178,0,W.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const ka=x.d(this.kd.ua.na),Xa=this.mmd(ka);let sb=null;if(V){sb=[];for(const hc of V)if(hc.column!==W.left){V=hc.row-1;var ib=hc.column-1;V=O.jba("EvalFormulaRangeOnClone.cell",ka,V,ib,V,ib);ib=z.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?U(hc.Xr,hc.formulaBarText,hc.si):excelOnlineCalc.calc.valueCellData(hc.text,hc.text,hc.si,null);sb.push(excelOnlineCalc.calc.rangeWrite(V,ib))}}W=excelOnlineCalc.calc.cellLocation(W.top-1,W.left-1);ma=O.jba("EvalFormulaRangeOnClone.outputColumnRange",
ka,ma.top-1,ma.left-1,ma.bottom-1,ma.right-1);let Ub;ia?this.s6&&(aa=[excelOnlineCalc.calc.inferredRangeFormulaEdit(ma,aa,W,Xa)],Ub=this.sq.evalOnClonedModel(sb,aa,ia)):(ia=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ma,aa,W,Xa)],Ub=this.sq.evalOnClonedModel(sb,ia));this.resumeRecalc();return Ub}fMe(V){let ma=null;try{if(V)if(this.tja=D.h(this.kd).Ca.rwa(V),this.currentStateId=V.PUa,this.currentStateId<this.Ds||this.currentStateId===d.a.ue)b.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.tja} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Ds}`);
else{if(this.Nmi(),this.pui&&1===V.yw.PaneType&&this.g9j(V.na),!this.z_g())if(ma=this.kd.Rb.Qc("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.tja} StateId:${this.currentStateId}`),this.e3a=this.x6a(V.na.sheetName))if(D.h(this.kd).Ca.nm.L3a(V.ld)){var W=V.Ff;if(W){var aa=W.getCalcBlockModel();if(aa)if(this.r_g(aa)){this.nf.ma(this.currentStateId).w1a[this.tja]=new M(aa,V.na.sheetName);var ia=V.me;ia?this.INg(ia.NamedObjects):b.ULS.sendTraceTag(537170144,0,15,
"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else this.Lsd&&b.ULS.sendTraceTag(509117971,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else b.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else b.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.tja}`)}else this.Lsd&&
b.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");else{const ka=!!(this.kd.Nd&32),Xa=this.nf.nb(this.currentStateId)&&this.nf.ma(this.currentStateId).Ak?this.nf.ma(this.currentStateId).Ak.length:0;b.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${Xa}, scratchPad:${ka}, sheetNameLength:${V.na.sheetName?V.na.sheetName.length:
-1} Hash:${V.na.hash}`)}}else b.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ma&&ma.stop()}}Hfc(V){var ma;if(!this.nf.nb(this.currentStateId))return b.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const W=null===(ma=this.nf.ma(this.currentStateId))||void 0===ma?void 0:ma.Ak;if(!W||!W[0])return null;ma=W[0].a7;if(!ma||!ma.nb(V.name))return b.ULS.sendTraceTag(509646789,
0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==ma}`),null;V=ma.ma(V.name);if(!V||!V.dF)return null;ma=new r.a;for(let aa of V.dF.Qaa)ma.add(aa.value);return ma}x4g(V,ma,W){var aa=D.h(this.kd),ia=aa.Ob(ma);ia=this.O3d(ia,null,"CopyPaste");W=this.O3d(aa.Ob(V),W,"CopyPaste");if(0>ia||0>W||ia!==W)b.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${W}, targetRevision:${ia}.`);
else{W=[];aa=x.d(this.kd.ua.na);var ka=this.mmd(aa);V=O.jba("CalculateFormulaForCopyPaste.srcRange",aa,V.top-1,V.left-1,V.bottom-1,V.right-1);ma=O.jba("CalculateFormulaForCopyPaste.targetRange",aa,ma.top-1,ma.left-1,ma.bottom-1,ma.right-1);ma=excelOnlineCalc.calc.copyPasteRangePasteEdit(ma,V,ka);W.push(ma);ma=ka?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",aa,ia,ka.row,ka.column,ka.lastRow,ka.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
aa,ia,"","","","");b.ULS.sendTraceTag(537170142,0,50,ma);this.sq.editRangePaste(ia,W);this.resumeRecalc()}}mmd(V){const ma=this.Yaf();let W=null;ma?W=O.jba("GetViewport.viewport",V,ma.top-1,ma.left-1,ma.bottom-1,ma.right-1):b.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return W}Yaf(){const V=D.h(this.kd);let ma=V.Ej;if(D.h(this.kd).lb.mj){ma=V.hg(1).Ej;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!ma)return b.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;ma.hfa(1,1);ma.hfa(3,1)}return ma}O3d(V,ma,W){let aa;if(!this.sq||!V)return b.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.sq}, modifiedCell is null:${!V}, operation:${W}`),-1;const ia=V.cell.lR-1,ka=V.cell.kR-1;if(V.cell.Ov){if(aa=V.cell.Ov.V3b,aa===d.a.ue)return b.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${V.cell.Ov.ld}, operation:${W}`),
-1}else return b.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${V.cell.lR},${V.cell.kR}), operation:${W}`),-1;if(aa<this.Ds)return b.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${ia},${ka}) - blockRevision:${aa} < lastUpdatedStateId:${this.Ds}, operation:${W}`),-1;if(aa<this.currentStateId)return b.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${ia},${ka}) - blockRevision:${aa} < currentStateId:${this.currentStateId}, operation:${W}`),
-1;ma&&!this.tGd&&(this.sq.setOnRecalcResults(ma),this.tGd=!0);return this.J4j()&&!this.MRb(2)?(b.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${W}`),-1):aa}getFormulaBarText(V,ma,W){return ma&&ma.startsWith("'")?ma:V.cell.formulaBarText||W.toString()}nkh(V,ma,W){let aa=null;z.EwaSettings.isChangeGateEnabled("OfficeVSO:7616924_fixSheetIdSentToCalcts")&&(this.e3a=this.x6a(W));if(this.ECe()&&this.nf.ma(this.Ds).w1a){const sb=this.nf.ma(this.Ds).w1a[V];
if(null===sb||void 0===sb?0:sb.TNb)aa=sb.TBe}W=this.Dri(aa,ma,W);const {xSi:ia,numberOfNonEmptyCells:ka,vSi:Xa}=this.mbh(aa,ma,W);b.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${V} StateId:${this.currentStateId} number of formulas ${ia}, number of non-empty cells ${ka}, number of cells ${Xa}`)}Dri(V,ma,W){let aa=!1;const ia=O.L3e(ma);if(V){const ka=O.L3e(V);F.a.equals(ka,ia,!1)&&(aa=!0)}this.exi&&(aa=!1);aa?this.lOg(V,this.Ds,W):this.nOg(ma,
W);return aa}ECe(){let V=!1;this.sq&&-1!==this.Ds&&(V=this.sq.stateIdAvailable(this.Ds));return V&&this.nf.nb(this.Ds)&&this.Ds<this.currentStateId}mbh(V,ma,W){let aa=0,ia=0,ka=0,Xa,sb;for(ma.reset();Xa=ma.getNextCell();)ka++,(Xa.value||Xa.formula)&&ia++,B.f(Xa.formula)&&aa++,(sb=W?V.getCell(Xa.row,Xa.col):null)?this.ibh(ma,Xa,sb):this.mOg(ma,Xa);if(W)for(V.reset();sb=V.getNextCell();)(Xa=ma.getCell(sb.row,sb.col))||this.Zre(V,sb);return{xSi:aa,numberOfNonEmptyCells:ia,vSi:ka}}vGj(){this.sq.setOnUpdateRequest(()=>
{})}uGj(){this.sq.setOnUnresponsive((V,ma,W,aa)=>{this.p6i(V,ma,W,aa)})}p6i(V,ma,W,aa){b.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${V}, waitTime:${ma}, timeoutCount:${W}, hasBeenClosed:${aa}.`);aa&&(this.Vuj(),this.kqa())}Vuj(){this.yd(null,null);this.Byd=this.tGd=!1;this.$Jd=0;this.SJd=this.UJd=this.VJd=this.TJd=-1}close(){this.sq.close()}clearCache(){this.sq.clearCache()}resumeRecalc(){this.sq.resumeRecalc()}HFj(){this.sq.setA1ReferenceStyle(!0)}Cjj(){if(this.instantaneousSupportInformationManager){var V=
this.instantaneousSupportInformationManager.Qoi;const W=this.instantaneousSupportInformationManager.Toi,aa=this.instantaneousSupportInformationManager.Soi,ia=this.instantaneousSupportInformationManager.Roi;var ma=!1;V!==this.TJd&&(ma=!0,this.TJd=V);W!==this.VJd&&(ma=!0,this.VJd=W);aa!==this.UJd&&(ma=!0,this.UJd=aa);ia!==this.SJd&&(ma=!0,this.SJd=ia);const ka=[];z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ma=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),ka.push(ma),ma=!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ma=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),ka.push(ma),ma=!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ma=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),ka.push(ma),ma=!0);ma&&(V=excelOnlineCalc.calc.recalcServiceConfig(null,V,null,W,null,null,null,aa,ka,ia),this.sq.reconfigure(V))}}sIj(V){let ma=
null;if(this.nf.nb(this.currentStateId))try{this.nba=[],ma=this.kd.Rb.Qc("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${I[V]}`),h.a.forEach(this.nf.ma(this.currentStateId).w1a,(W,aa)=>{aa.TNb||(this.nkh(W,aa.TBe,aa.sheetName),aa.TNb=!0)},null),this.sq.updateRanges(this.currentStateId,this.nba)}finally{ma&&ma.stop()}else b.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}rIj(){const V=
[],ma=this.ECe();var W=ma&&this.nf.ma(this.Ds).Ak&&this.nf.ma(this.Ds).Ak[0]&&this.nf.ma(this.Ds).Ak[0].Tpc?this.nf.ma(this.Ds).Ak[0].a7:null;this.GHe(W,this.nf.ma(this.currentStateId).Ak[0].a7,null,this.Ds,V);this.nf.ma(this.currentStateId).Ak[0].Tpc=!0;for(let aa=1;aa<this.nf.ma(this.currentStateId).Ak.length;aa++)W=-1,ma&&this.nf.ma(this.Ds).Ak&&(W=this.tld(this.nf.ma(this.currentStateId).Ak[aa].G8.sheetName,this.Ds)),W=-1!==W&&this.nf.ma(this.Ds).Ak[W].Tpc?this.nf.ma(this.Ds).Ak[W].a7:null,this.GHe(W,
this.nf.ma(this.currentStateId).Ak[aa].a7,this.nf.ma(this.currentStateId).Ak[aa].G8.sheetId,this.Ds,V),this.nf.ma(this.currentStateId).Ak[aa].Tpc=!0;this.sq.updateNamedObjects(this.currentStateId,V)}GHe(V,ma,W,aa,ia){if(void 0!==W&&null!==W){var ka=excelOnlineCalc.calc.undefinedNamesWrite(W);ia.push(ka)}if(V){var Xa=!1;ka=[];var sb=[];if(ma)for(let Ub of ma){const hc=Ub.value;if(V.nb(Ub.key)){var ib=V.ma(Ub.key);O.OQi(ib,hc)?Xa=!0:(ib=excelOnlineCalc.calc.namedObject(Ub.key,null),ka.push(ib),O.nZc(Ub.key,
hc,sb))}else O.nZc(Ub.key,hc,sb)}for(let Ub of V)ma&&ma.nb(Ub.key)||(V=excelOnlineCalc.calc.namedObject(Ub.key,null),ka.push(V));Xa&&(ma=excelOnlineCalc.calc.namedObjectsPromote(W,aa),ia.push(ma));0<ka.length&&(ma=excelOnlineCalc.calc.namedObjectsWrite(W,ka),ia.push(ma));0<sb.length&&(W=excelOnlineCalc.calc.namedObjectsWrite(W,sb),ia.push(W))}else if(ma){aa=[];for(sb of ma)O.nZc(sb.key,sb.value,aa);0<aa.length&&(W=excelOnlineCalc.calc.namedObjectsWrite(W,aa),ia.push(W))}}z_g(){const V=this.nf.ma(this.currentStateId).w1a[this.tja];
return V?(this.Lsd?b.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.tja} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.Ds}. sentToRecalcEngine: ${null===V||void 0===V?void 0:V.TNb}`):b.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.tja} StateId:${this.currentStateId} previously handled`),this.fxi?!1:!0):!1}r_g(V){return 1===V.getColumnNumbers().length&&V.getColumnNumbers()[0]===
O.cBd+1?!1:!0}Hmi(){let V=!1;D.h(this.kd).Ca.lxb(ma=>{ma.state&1&&this.kd.ea.Ee===ma.pe.Revision&&(this.fMe(ma),V=!0)});return V}WJe(V,ma){var W=V.getRowNumbers(),aa=V.getColumnNumbers();V=W[0]-1;W=W[W.length-1]-1;const ia=aa[0]-1;aa=aa[aa.length-1]-1;ma=this.x6a(ma);if(!ma){const ka=this.nf.nb(this.currentStateId)&&this.nf.ma(this.currentStateId).Ak?this.nf.ma(this.currentStateId).Ak.length:0;b.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${ka}`)}return O.jba("CreateBlockRangeLocation",
ma,V,ia,W,aa)}lOg(V,ma,W){if(W=this.WJe(V,W)){var aa=O.V7b(V.getRowNumbers());V=O.V7b(V.getColumnNumbers());ma=excelOnlineCalc.calc.rangePromote(W,ma,aa,V);this.nba[this.nba.length]=ma}}nOg(V,ma){if(ma=this.WJe(V,ma)){var W=O.V7b(V.getRowNumbers());V=O.V7b(V.getColumnNumbers());V=excelOnlineCalc.calc.rangeWrite(ma,null,W,V);this.nba[this.nba.length]=V}}ibh(V,ma,W){let aa=null,ia=0,ka=0;switch(ma.valueType){case 2:aa=this.jmd(ma);var Xa=this.jmd(W);Xa=F.a.equals(Xa,aa,!1);break;case 1:null===ma.value&&
null===W.value?Xa=!0:(ia=parseFloat(ma.value),Xa=parseFloat(W.value)===ia);break;default:null===ma.value&&null===W.value?Xa=!0:(ka=parseFloat(ma.value),Xa=ka===parseFloat(W.value))}Xa&&ma.valueType===W.valueType&&ma.ifmt===W.ifmt&&ma.formulaType===W.formulaType&&F.a.equals(W.formula,ma.formula,!1)||(void 0!==ma.formula&&null!==ma.formula||void 0!==ma.value&&null!==ma.value||void 0!==ma.text&&null!==ma.text||0!==ma.valueType?this.k1b(V,ma,aa,ia,ka):this.Zre(V,ma))}INg(V){if(this.kd.Hb&&this.kd.Hb.items)for(let ka=
0;ka<this.kd.Hb.count;ka++){var ma=this.kd.Hb.items[ka];if(2!==ma.type&&3!==ma.type)continue;var W=0,aa=ma.name,ia=aa.lastIndexOf("!");if(0<ia){W=aa.substr(0,ia);"'"===W.charAt(0)&&(W=W.substr(1,W.length-2));W=this.tld(W,this.currentStateId);if(-1===W){aa=this.nf.nb(this.currentStateId)&&this.nf.ma(this.currentStateId).Ak?this.nf.ma(this.currentStateId).Ak.length:0;b.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${aa}`);continue}aa=
aa.substr(ia+1)}ia=this.nf.ma(this.currentStateId).Ak[W].a7;let Xa=ma.usedRange;2===ma.type&&(Xa=m.a(ma));if(ia.nb(aa)){if(W=ia.ma(aa),W.range=Xa,W.attributes=ma.attributes,2===W.type)if(aa=ma.UO,!W.dF)W.dF=new n(aa);else if(aa)for(const sb of aa.HeadersList)W.dF.Qaa.ia(sb.Index,sb.Name)}else if(W=this.x6a(ma.sheetName)){W=new R(ma.type,ma.name,Xa,W,ma.attributes);if(2===W.type)if(ma.UO)W.dF=new n(ma.UO);else if(ma=O.jMh(ma.name,V))W.dF=new n(ma.ColHeadersList);ia.ia(aa,W)}else aa=this.nf.nb(this.currentStateId)&&
this.nf.ma(this.currentStateId).Ak?this.nf.ma(this.currentStateId).Ak.length:0,b.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${aa}`)}}k1b(V,ma,W,aa,ia){var ka=V.getRowNumbers()[ma.row]-1;V=V.getColumnNumbers()[ma.col]-1;ka=O.jba("AddRangeUpdateCommand",this.e3a,ka,V,ka,V);V=null;let Xa=ma.formula||ma.text;const sb=excelOnlineCalc.calc.blankValue;let ib=null;void 0!==ma.text&&null!==ma.text||void 0!==ma.value&&null!==ma.value||
(W="",ib="This cell contains blanks only",0===ma.formulaType&&(Xa=""));switch(ma.valueType){case 2:null!==W&&(0===ma.formulaType&&(V=excelOnlineCalc.calc.valueCellData(Xa,W,ma.ifmt,ib)),1===ma.formulaType&&(V=excelOnlineCalc.calc.cellFormulaCellData(Xa,W,ma.ifmt,ib)),2===ma.formulaType&&(V=excelOnlineCalc.calc.valueCellData("",sb,0,"This cell is a part of an array")));break;case 1:isNaN(aa)?b.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ma.row},${ma.col}) invalid numeric value`):
(0===ma.formulaType&&(V=excelOnlineCalc.calc.valueCellData(Xa,aa,ma.ifmt,null)),1===ma.formulaType&&(V=excelOnlineCalc.calc.cellFormulaCellData(Xa,aa,ma.ifmt,null)),2===ma.formulaType&&(V=excelOnlineCalc.calc.valueCellData("",sb,0,"This cell is a part of an array")));break;case 3:isNaN(ia)?b.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ma.row},${ma.col}) invalid boolean value`):(W=1===ia?!0:!1,0===ma.formulaType&&(V=excelOnlineCalc.calc.valueCellData(Xa,W,ma.ifmt,
null)),1===ma.formulaType&&(V=excelOnlineCalc.calc.cellFormulaCellData(Xa,W,ma.ifmt,null)),2===ma.formulaType&&(V=excelOnlineCalc.calc.valueCellData("",sb,0,"This cell is a part of an array")));break;case 4:isNaN(ia)?b.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ma.row},${ma.col}) invalid error value`):(W=excelOnlineCalc.calc.errorValue(ia),0===ma.formulaType&&(V=excelOnlineCalc.calc.valueCellData(Xa,W,ma.ifmt,null)),1===ma.formulaType&&(V=excelOnlineCalc.calc.cellFormulaCellData(Xa,
W,ma.ifmt,null)),2===ma.formulaType&&(V=excelOnlineCalc.calc.valueCellData("",sb,0,"This cell is a part of an array")));break;default:V=excelOnlineCalc.calc.valueCellData("",sb,ma.ifmt,null)}V&&(ma=excelOnlineCalc.calc.rangeWrite(ka,V,null,null),this.nba[this.nba.length]=ma)}mOg(V,ma){switch(ma.valueType){case 2:this.k1b(V,ma,this.jmd(ma),null,0);break;case 1:this.k1b(V,ma,null,parseFloat(ma.value),0);break;default:this.k1b(V,ma,null,null,parseFloat(ma.value))}}Zre(V,ma){var W=V.getRowNumbers()[ma.row]-
1;V=V.getColumnNumbers()[ma.col]-1;W=O.jba("AddRangeUpdateCommandEmptyCell",this.e3a,W,V,W,V);ma=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ma.ifmt,null);ma=excelOnlineCalc.calc.rangeWrite(W,ma,null,null);this.nba[this.nba.length]=ma}x6a(V){V=this.tld(V,this.currentStateId);return 0<V?this.nf.ma(this.currentStateId).Ak[V].G8.sheetId:null}tld(V,ma){if(!this.nf.nb(ma))return b.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ma} does not exist in GridCache`),
-1;const W=this.nf.ma(ma);return W.Ak?W.getSheetIndex(V):(b.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ma}`),-1)}PHj(){if(!this.nf.nb(this.currentStateId)||!this.nf.ma(this.currentStateId).Ak.length)return b.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const V=[];for(let ma=1;ma<this.nf.ma(this.currentStateId).Ak.length;ma++){const W=
this.nf.ma(this.currentStateId).Ak[ma];W&&V.push(W.G8)}this.sq.updateSheetNames(this.currentStateId,V);this.sq.updateUnusedCells(this.currentStateId,this.nf.ma(this.currentStateId).e2d);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var V=[];for(const ma of this.instantaneousSupportInformationManager.Qza){const W=excelOnlineCalc.calc.numberFormat(ma.IfmtIndex,ma.FormatString,ma.Builtin);V.push(W)}this.sq.setNumberFormats(V,!0)}}eEj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.Ve){var V=this.Lmi();if(!this.Byd||V)this.U7b(),this.instantaneousSupportInformationManager.Ve.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Ve.TrueValueString),this.instantaneousSupportInformationManager.Ve.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Ve.FalseValueString),V=N.CalcHelper.TKe(this.instantaneousSupportInformationManager,V),this.sq.setLocale(V),this.Byd=!0}}GIj(){var V=null;if(void 0!==
this.kd.workbookContext.TimeZoneInformation&&null!==this.kd.workbookContext.TimeZoneInformation){V=null;this.kd.workbookContext.TimeZoneInformation.StandardDate.Month&&(V=excelOnlineCalc.date.dateTime(this.kd.workbookContext.TimeZoneInformation.StandardDate.Year,this.kd.workbookContext.TimeZoneInformation.StandardDate.Month,this.kd.workbookContext.TimeZoneInformation.StandardDate.Day,this.kd.workbookContext.TimeZoneInformation.StandardDate.Hour,this.kd.workbookContext.TimeZoneInformation.StandardDate.Minute,
this.kd.workbookContext.TimeZoneInformation.StandardDate.Second,this.kd.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.kd.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ma=null;this.kd.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ma=excelOnlineCalc.date.dateTime(this.kd.workbookContext.TimeZoneInformation.DaylightDate.Year,this.kd.workbookContext.TimeZoneInformation.DaylightDate.Month,this.kd.workbookContext.TimeZoneInformation.DaylightDate.Day,
this.kd.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.kd.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.kd.workbookContext.TimeZoneInformation.DaylightDate.Second,this.kd.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.kd.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));V=excelOnlineCalc.date.tzData(this.kd.workbookContext.TimeZoneInformation.Bias,V,this.kd.workbookContext.TimeZoneInformation.StandardBias,ma,this.kd.workbookContext.TimeZoneInformation.DaylightBias)}else b.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");V=excelOnlineCalc.calc.workbookProps(this.kd.workbookContext.F1904,this.kd.workbookContext.FDateCompatibility,V);this.sq.setWorkbookProps(V)}kqa(){const V=z.EwaSettings.ya(570)?w.local:w.pYj,[ma,W]=y.a.$V(this.kd)?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.eMd=v.d(excelOnlineCalc.calc.createRecalcService(V,ma,W));this.eMd.continueWith(aa=>
{aa.exception?b.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${aa.exception.toString()}`):(b.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.sq=this.eMd.result)?this.MRb(0)?this.uGj():b.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):b.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Lmi(){const V=
this.instantaneousSupportInformationManager.Hka;if(!V||this.$Jd===V.length)return null;this.$Jd=V.length;return N.CalcHelper.DKe(V)}U7b(){this.errorTypeNames=N.CalcHelper.U7b()}Nmi(){if(!(this.nf.nb(this.currentStateId)&&0<this.nf.ma(this.currentStateId).Ak.length)){this.nf.ia(this.currentStateId,new P(this.atd));this.nf.ma(this.currentStateId).Z9f(0,new G(null));var V=this.kd.ua;for(let aa=0;aa<V.count;aa++){var ma=Object(l.a)(A.a,V.getItem(aa));if(ma){void 0!==ma.sheetId&&null!==ma.sheetId&&void 0!==
ma.name&&null!==ma.name&&ma.sheetId.length&&ma.sheetName.length||b.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${aa} Id:${ma.sheetId} Hash:${ma.hash} NameLength:${ma.name?ma.name.length:-1}`);var W=void 0;W=excelOnlineCalc.calc.sheetName(ma.sheetId,ma.name);this.nf.ma(this.currentStateId).Z9f(aa+1,new G(W));W=ma.usedRange.dP();W=excelOnlineCalc.calc.rangeLocation(0,0,W.LastRow,W.LastColumn);ma=excelOnlineCalc.calc.unusedCellsUpdate(ma.sheetId,
W);this.nf.ma(this.currentStateId).e2d.push(ma)}else b.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${aa}`)}}}g9j(V){if(V instanceof A.a){var ma=V.usedRange.dP();ma=excelOnlineCalc.calc.rangeLocation(0,0,ma.LastRow,ma.LastColumn);ma=excelOnlineCalc.calc.unusedCellsUpdate(V.sheetId,ma);this.nf.ma(this.currentStateId).e2d[V.index]=ma}}S8g(){for(let V of this.nf)V.key<this.Ds&&this.nf.remove(V.key)}jmd(V){V=
V.value||V.text;if(void 0===V||null===V)V="";return V}J4j(){if(!this.nf.nb(this.currentStateId))return!1;let V=!1;h.a.forEach(this.nf.ma(this.currentStateId).w1a,(ma,W)=>{W.TNb||(V=!0)},null);return V}y8c(V){const ma={};ma.reason=V;ma.kind=1;return ma}Rkc(){return this.nf.nb(this.currentStateId)&&this.nf.ma(this.currentStateId).Ak&&this.nf.ma(this.currentStateId).Ak[0]&&this.nf.ma(this.currentStateId).Ak[0].a7?!0:!1}static rgh(V){const ma=[];if(null===V||void 0===V?0:V.Qaa)for(let W of V.Qaa)V=excelOnlineCalc.calc.columnData(W.key,
W.value),ma.push(V);return ma}static OQi(V,ma){if(V.type!==ma.type||V.attributes!==ma.attributes||!F.a.equals(V.fullName,ma.fullName,!1)||!V.range.equals(ma.range))return!1;if(!V.dF&&!ma.dF)return!0;if(!V.dF||!ma.dF||V.dF.Qaa.count!==ma.dF.Qaa.count)return!1;for(let W of V.dF.Qaa){let aa;if(!(W.value&&({value:aa}=ma.dF.Qaa.Mc(W.key)).returnValue&&aa&&F.a.equals(W.value,aa,!1)))return!1}return!0}static nZc(V,ma,W){var aa=O.jba("NamedObject",ma.sheetId,ma.range.top-1,ma.range.left-1,ma.range.bottom-
1,ma.range.right-1);if(2===ma.type){const ia=!!(ma.attributes&16),ka=!!(ma.attributes&8);ma=O.rgh(ma.dF);aa=excelOnlineCalc.calc.namedTableData(aa,ia,ka,ma);V=excelOnlineCalc.calc.namedObject(V,aa)}else aa=excelOnlineCalc.calc.namedRangeData(aa),V=excelOnlineCalc.calc.namedObject(V,aa);W.push(V)}static L3e(V){const ma=Sys.Serialization.JavaScriptSerializer.serialize(V.getRowNumbers());V=Sys.Serialization.JavaScriptSerializer.serialize(V.getColumnNumbers());return ma+V}static V7b(V){let ma=null;if(1<
V.length)for(let W=1;W<V.length;W++){let aa=0;for(;V[W-1]+1+aa<V[W];)ma=ma||[],ma.push(V[W-1]+aa),aa++}return ma}static jMh(V,ma){if(!ma)return null;for(let W=0,aa=ma.length;W<aa;++W)if(F.a.equals(V,ma[W].Name,!1))return ma[W];return null}static jba(V,ma,W,aa,ia,ka){const Xa=(sb,ib,Ub,hc)=>{(0>Ub||Ub>=hc)&&b.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${sb} invalid ${ib}:${Ub}`)};void 0!==ma&&null!==ma||b.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${V} sheetId is null`);
Xa(V,"top",W,O.Byf);Xa(V,"left",aa,O.cBd);Xa(V,"bottom",ia,O.Byf);Xa(V,"right",ka,O.cBd);return excelOnlineCalc.calc.sheetRangeLocation(ma,W,aa,ia,ka)}}O.Byf=1048576;O.cBd=16384;Object(c.a)(O,"CalcAsyncEngine",null,[2]);const U=(V,ma,W)=>{switch(V.type){case 2:return excelOnlineCalc.calc.valueCellData(ma,V.value,W,null);case 1:return excelOnlineCalc.calc.valueCellData(ma,parseFloat(V.value),W,null);case 3:return excelOnlineCalc.calc.valueCellData(ma,1===parseFloat(V.value),W,null);case 4:return excelOnlineCalc.calc.valueCellData(ma,
excelOnlineCalc.calc.errorValue(parseFloat(V.value)),W,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,W,null)}};class ca{constructor(){this.IK=this.JK=this.JF=this.KF=this.N_=!1}}Object(c.a)(ca,"AbsoluteRelativeReferenceInfo",null,[]);var Q=a(25);class Y{}Y.lRf="#";Object(c.a)(Y,"Operators",null,[]);var la=a(1095);class ea{}ea.sheet="Sheet";ea.sheetRange="SheetRange";ea.document="Document";ea.rji="Ident";Object(c.a)(ea,"TraverseFormulaQualifierTypes",null,
[]);var ha=a(1096),X=a(939),T=a(831),ua=a(45),Ha=a(60),Ca=a(75),Ga=a(297),sa=a(40);class bb extends Sys.EventArgs{constructor(V){super();this.Hk=V}}Object(c.a)(bb,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var Ba=a(157),qa=a(41),pa=a(248);class ya{constructor(V,ma){this.NFf=(W,aa)=>{W=this.gridView.ga.qa.activeCell;const ia=this.gridView.Ob(W);null!=ia&&this.qcj(W,aa.text,ia.cell.si,ia.cell.Ov.V3b,this.gridView.$.activeItemName)};this.qAa=()=>{this.Uya=Object(Ga.a)({message:"PrefetchNotStarted"})};
this.calcManager=V;this.gridView=ma;this.Uya=Object(Ga.a)({message:"Ctor"});V=z.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetchMsDebounce",100);this.qcj=pa.a((W,aa,ia,ka,Xa)=>this.prefetch({text:aa,range:W,ifmt:ia,stateId:ka,sheetName:Xa}),V);this.gridView.hc.An(this.qAa);this.gridView.Ih.lte(this.NFf)}dispose(){this.gridView.Ih.WZf(this.NFf);this.gridView.hc.sn(this.qAa);this.sFe()}U3e(V){if(Object(Ga.b)(this.Uya))return Object(Ga.a)(this.Uya.reason.message);if(ya.kXg(V,
this.Uya.value.key)){for(const ma of this.Uya.value.results.results)if(Object(Ga.c)(ma)&&ya.Vyi(V,ma))return ma;return Object(Ga.a)("RangeNotFoundInPrefetchResult")}return Object(Ga.a)("ResultUnavailable")}sFe(){this.Uya=Object(Ga.a)({message:"PrefetchResultCleared"})}prefetch(V){this.Uya=Object(Ga.a)({message:"EvalInProgress",key:V});this.calcManager.r4a([],V.range,V.range,V.text,!0).then(ma=>{this.Uya=Object(Ga.d)({key:V,results:ma})}).catch(ma=>{b.ULS.sendTraceTag(509219811,0,50,`SetCellEstimationPrefetcher.prefetch: evalFormulaRangeOnClonedModel promise rejected with error ${ma}`)})}static kXg(V,
ma){return V.text===ma.text&&V.range.toString()===ma.range.toString()&&V.ifmt===ma.ifmt&&V.stateId===ma.stateId&&V.sheetName===ma.sheetName}static Vyi(V,ma){return V.range.top-1===ma.value.cell.row&&V.range.left-1===ma.value.cell.col}}Object(c.a)(ya,"SetCellEstimationPrefetcher",null,[853,2]);var za=a(92),cb;let Pa=cb=class extends sa.a{constructor(V){super();this.zu=null;this.Xqg=!1;this.xQd=this.instantaneousSupportInformationManager=this.oJb=null;this.KDd=new Map;this.The=null;this.Urc=ma=>{b.ULS.sendTraceTag(537170005,
0,50,"CalcManager.OnLocaleInformationAvailable() called");ma.tOd(this.Urc);ma.Hka.length?this.xrc(ma,Sys.EventArgs.Empty):(b.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ma.ute(this.xrc))};this.xrc=ma=>{b.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ma.hOd(this.xrc);this.n2j(ma)};this.onContentReady=()=>{this.zu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Rqd||
Ha.Task.delay(0).continueWith(()=>{this.zu.MRb(1)},0,null,Ca.a.current))};this.yDf=(ma,W)=>{this.zu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Rqd||this.zu.fMe(W.hd.block))};b.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.sjc=!1;this.pb=V;this.it=D.h(V);this.HKc=null;this.gridView.vv(this.onContentReady);this.gridView.Ca.OZc(this.yDf);this.$.da.kb(268,ma=>{ma.Ve?(b.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),
this.Urc(ma,Sys.EventArgs.Empty)):(b.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ma.Qte(this.Urc))});if(this.s6=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1))this.lme=new ya(this,this.it)}CQg(V){this.addHandler(cb.qRe,V)}lBf(V){this.raiseEvent(cb.qRe,new bb(V))}get bAc(){return this.lme}get wU(){return this.HKc}get gridView(){return this.it}get $(){return this.pb}get XF(){return this.The}get localeInfo(){return this.wU?
this.wU.config.localeInfo:null}get config(){return this.wU.config}dispose(){b.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.kb(268,V=>{V.tOd(this.Urc);V.hOd(this.xrc)});this.gridView&&(this.gridView.My(this.onContentReady),this.gridView.Ca&&this.gridView.Ca.DZf(this.yDf),this.it=null);this.HKc=null;this.sjc=!1;this.s6&&(za.a.Ja(this.bAc),this.lme=null)}y4g(V,ma,W,aa=null){this.zu&&this.zu.w4g(V,ma,W,aa)}evalFormula(V,ma,W,aa){return this.zu?this.zu.evalFormula(V,ma,W,aa):
Promise.reject("calc engine not initialized")}r4a(V,ma,W,aa,ia){return this.zu?this.zu.r4a(V,ma,W,aa,ia):Promise.reject("CalcEngine is null")}Hfc(V){if(!V)return b.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.zu)return null;b.ULS.shipAssertTag(537170059,0,2===V.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.zu.Hfc(V)}NUg(V,ma){if(!ma||2!==V.type)return!1;V=m.a(V);return V.right-V.left+1===ma.count}lZe(V,ma){if(!this.oJb)return this.Xqg||
b.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var W=this.Ltb(Q.Range.Lc(1,1));W=this.oJb.parseFormula(excelOnlineCalc.parse.parseLocals(1,W.range),V);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(W))return b.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let aa;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){const ia=null!==
ma&&void 0!==ma?ma:this.gridView.ga.qa.activeCell,ka=excelOnlineCalc.location.gridCell(ia.top-1,ia.left-1),Xa=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),sb=excelOnlineCalc.location.sheetIndex(Xa,this.$.ua.na.sheetId),ib=this.Kkh(ka,sb);this.xQd||(this.xQd=excelOnlineCalc.util.createResolver(this.Jkh()));aa=excelOnlineCalc.parse.parseResultHelper.extractReferences(W,this.wU.config.localeInfo,z.EwaSettings.ya(512),ib,this.xQd)}else aa=excelOnlineCalc.parse.parseResultHelper.extractReferences(W,
this.wU.config.localeInfo,z.EwaSettings.ya(512));z.EwaSettings.ya(101)&&this.b8j(aa,V);return aa}catch(aa){return b.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${aa.message}`),null}}extractLetVariables(V,ma){if(!this.oJb)return this.Xqg||b.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const W=this.Ltb(Q.Range.Lc(1,1));V=this.oJb.parseFormula(excelOnlineCalc.parse.parseLocals(1,W.range),V);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(V))return b.ULS.sendTraceTag(537170053,
0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(V,ma,this.wU.config.localeInfo)}catch(aa){return b.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${aa.message}`),null}}extractReferences(V,ma,W,aa,ia){if(!ma)return b.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!W)return b.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),
null;ia=this.lZe(V,ia);if(!ia)return b.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.Gjh(ia,ma,W,V,aa)}catch(ka){return b.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${ka.message}`),null}}Ltb(V,ma=!0){return V&&this.wU?this.wU.glh(this.wU.Rmh(),V.top-1,V.left-1,ma):null}$lf(V,ma){V=this.rMa(V);if(!Object(Ga.c)(V))return null;ma=this.XF.parseEdit(ma,V.value);return excelOnlineCalc.util.isSuccess(ma)?
ma.value.kind===X.a.formula:null}eBi(V){V=this.rMa(V);return Object(Ga.c)(V)?"Text"===V.value.valueType:null}kti(V){V=this.rMa(V);return Object(Ga.c)(V)?"Date"===V.value.valueType:null}rMa(V){if(null==this.XF)return Object(Ga.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(Ga.a)("Instantaneous manager is null");if(this.KDd.has(V))return Object(Ga.d)(this.KDd.get(V));if("number"===typeof V){var ma=this.okd(V);if(null==ma)return Object(Ga.a)(`Invalid ifmt=${V}`);
var W=ma.FormatString;ma=ma.Builtin}else W=V,ma=!1;W=this.XF.createFormat(W,ma);return excelOnlineCalc.util.isSuccess(W)?(this.KDd.set(V,W.value),Object(Ga.d)(W.value)):Object(Ga.a)("Could not create number format")}getWorksheetFuncId(V){return this.localeInfo.getWorksheetFuncId(V)}Gjh(V,ma,W,aa,ia){const ka={Items:[]};for(let Ub=0;Ub<V.length;Ub++){var Xa=V[Ub];const hc={};hc.Start=Xa.span.start;hc.End=Xa.span.end;if(ia||Xa.kind!==la.a.func)if(ia||Xa.kind!==la.a.OFi){if(!this.tth(Xa,ma,W))continue;
var sb=new ca;const yb=this.d6h(Xa,ma,sb,aa);if(z.EwaSettings.ya(512)){var ib=this.a2h(Xa);const Gb=this.$1h(Xa);if(yb||Gb&&0<=ib){let Sa={};Sa.Span=hc;Sa.LetNumber=ib;Sa.LetName=Gb;Sa.Range=yb;Sa.IsRangeRef=sb.N_;Sa.IsAbsoluteFirstRow=sb.KF;Sa.IsAbsoluteFirstColumn=sb.JF;Sa.IsAbsoluteSecondRow=sb.JK;Sa.IsAbsoluteSecondColumn=sb.IK;Sa.IsStructRef=Xa.kind===la.a.lZd;ka.Items.push(Sa)}}else yb&&(ib={},ib.Span=hc,ib.Range=yb,ib.IsRangeRef=sb.N_,ib.IsAbsoluteFirstRow=sb.KF,ib.IsAbsoluteFirstColumn=sb.JF,
ib.IsAbsoluteSecondRow=sb.JK,ib.IsAbsoluteSecondColumn=sb.IK,ib.IsStructRef=Xa.kind===la.a.lZd,ka.Items.push(ib))}else Xa=Xa.ref.value.oper.kind,sb={},sb.Span=hc,sb.IsString=2===Xa,sb.IsBoolean=4===Xa,sb.IsNumber=1===Xa,ka.Items.push(sb);else hc.End=Xa.span.start+Xa.ref.name.length,Xa={},Xa.Span=hc,Xa.IsFunction=!0,Xa.FunctionId=this.getWorksheetFuncId(aa.substring(hc.Start,hc.End)),ka.Items.push(Xa)}ka.Items.sort((Ub,hc)=>Ub.Span.Start-hc.Span.Start);return ka}a2h(V){return V.kind===la.a.ltf?V.ref.number:
-1}$1h(V){return V.kind===la.a.ltf?V.ref.name:null}d6h(V,ma,W,aa){if(V.kind===la.a.range)return W.N_=!0,this.TIe(V,ma,W,aa);if(V.kind===la.a.namedRange){W=V.ref;(V=this.$.Hb.getItemByName(W.name))||(V=this.$.Hb.getItemByName(ma+"!"+W.name));if(!(V&&V.sheetName&&V.usedRange&&F.a.equals(V.sheetName,ma,!0)))return null;ma=2===V.type?m.a(V):V.usedRange;return ua.m(ma,V)}if(V.kind===la.a.lZd){let ia=V.ref,ka;ia.name?(ka=this.$.Hb.getItemByName(ia.name))||(ka=this.$.Hb.getItemByName(ma+"!"+ia.name)):ka=
this.gridView.wb.mh(this.gridView.ga.qa.activeCell);if(!(ka&&ka.sheetName&&ka.usedRange&&F.a.equals(ka.sheetName,ma,!0)))return null;W.N_=!1;return this.TIe(V,ma,W,aa)}return null}TIe(V,ma,W,aa){V=V.ref;if(V.type){if(V.type===ha.a.column){var ia=V.startIndex;V=V.endIndex;W.JF=ia.kind===T.a.abs;W.IK=V.kind===T.a.abs;return this.createRange(0,ia.index,d.a.Fg,V.index,ma)}if(V.type===ha.a.row)return ia=V.endIndex,W.KF=V.startIndex.kind===T.a.abs,W.JK=ia.kind===T.a.abs,this.createRange(V.startIndex.index,
0,V.endIndex.index,d.a.Eg,ma);if(V.type===ha.a.cell){ia=V.row;var ka=V.col;W.KF=W.JK=ia.kind===T.a.abs;W.JF=W.IK=ka.kind===T.a.abs;return this.q5b(V.span.end,aa)&&(W=Q.Range.Lc(ia.index+1,ka.index+1),W=this.gridView.wb.M$e(W))?ua.n(W,ma):this.createRange(ia.index,ka.index,ia.index,ka.index,ma)}if(V.type===ha.a.range){ia=V.top;ka=V.left;aa=V.bottom;V=V.right;const Xa=Math.min(ia.index,aa.index),sb=Math.min(ka.index,V.index),ib=Math.max(ia.index,aa.index),Ub=Math.max(ka.index,V.index);W.KF=ia.kind===
T.a.abs;W.JK=aa.kind===T.a.abs;W.JF=ka.kind===T.a.abs;W.IK=V.kind===T.a.abs;return this.createRange(Xa,sb,ib,Ub,ma)}b.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${V.type}'`);return null}b.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}q5b(V,ma){return ma.length>=V&&0<V&&ma.charAt(V-1)===Y.lRf}s4g(V,ma,W){this.zu&&this.zu.x4g(V,ma,W)}okd(V){return this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.Qza&&this.instantaneousSupportInformationManager.Qza[V]&&this.XF?this.instantaneousSupportInformationManager.Qza[V]:null}toXLNumber(V){if(!this.XF)return null;V=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.XF,V);return excelOnlineCalc.util.isSuccess(V)?V.value:null}b8j(V,ma){if(V)for(const W of V)W.ref.type&&W.ref.type===ha.a.cell&&(V=W.ref,cb.gcj(V,ma)&&(V.span.end+=1,W.span.end+=1))}createRange(V,ma,W,aa,ia){const ka={};ka.FirstRow=V;ka.FirstColumn=
ma;ka.LastRow=W;ka.LastColumn=aa;ka.SheetName=ia;return ka}tth(V,ma,W){var aa=V.ref.qualifier;if(!aa)return!0;switch(V.ref.qualifier.type){case ea.sheet:return V=aa.document,F.a.equals(aa.sheet,ma,!0)&&(!V||F.a.equals(V.document,W,!0));case ea.sheetRange:return ma=this.$.ua.getItemByName(ma),W=this.$.ua.getItemByName(aa.sheet1),aa=this.$.ua.getItemByName(aa.sheet2),!!ma&&!!W&&!!aa&&(W.index<=ma.index&&ma.index<=aa.index||aa.index<=ma.index&&ma.index<=W.index);case ea.document:return F.a.equals(aa.document,
W,!0);case ea.rji:return aa=aa.name,F.a.equals(aa,ma,!0)||F.a.equals(aa,W,!0);default:return b.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${aa.type}'`),!1}}n2j(V){this.instantaneousSupportInformationManager=V;V.Qza.length&&V.Hka.length?(this.HKc=new N.CalcHelper(this.gridView.$),this.oJb=this.wU.createParser(),this.The=this.wU.createNumberFormatter(),this.sjc=!0,b.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),
this.zu||(b.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.zu=new O(this.$))):b.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${V.Qza.length}, functions info count = ${V.Hka.length}`)}Kkh(V,ma){const W={allowUnqualifiedCell:!0,wrapCellReferences:!0};W.config=this.wU.config;W.originGridCell=excelOnlineCalc.util.success(V);W.originSheet=excelOnlineCalc.util.success(ma);
return W}Jkh(){const V={};V.config=this.wU.config;V.getNameLoc=this.zu.getNameLoc;V.getContainingTable=this.zu.getContainingTable;V.getStructRefColumn=this.zu.getStructRefColumn;V.getStructRefSpecialRef=this.zu.getStructRefSpecialRef;V.getDocumentLoc=this.zu.getDocumentLoc;V.getSheetIndex=this.zu.getSheetIndex;V.getSheetName=this.zu.getSheetName;V.getUserDefinedFuncLoc=this.zu.getUserDefinedFuncLoc;V.getSheetRangeIndexes=this.zu.getSheetRangeIndexes;return V}static gcj(V,ma){return ma.length>V.span.end&&
ma.charAt(V.span.end)===Y.lRf}};Pa.qRe="ECRC";Pa=cb=Object(e.b)([Object(Ba.d)(qa.g),Object(e.c)(0,Object(qa.u)()),Object(e.c)(1,Object(qa.v)())],Pa);Object(c.a)(Pa,"CalcManager",sa.a,[823,2]);var nb=a(39),Ma=a(54);class Oa extends f.a{constructor(V){super();this.$=V;this.Mb()}create(){if(this.$){b.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var V=77;var ma="Current"}else V=80,ma=
"Stable";b.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${ma} JS was loaded`);nb.TaskExtensions.za(Ma.a.loadScript(V,4,this.Na,void 0,void 0,265),()=>{b.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let W=this.$.da.Aa(266,!1);W||(b.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),W=new Pa(this.$),this.$.da.Ha(266,W));this.vb(W)},this.ka,3)}else b.ULS.sendTraceTag(537169994,
0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static la(V){V&&V.da&&V.da.Ha(265,new Oa(V))}}Object(c.a)(Oa,"CalcManagerFactory",f.a,[]);var La=a(10);a.d(C,"a",function(){return ra});const ra=()=>{La.a.Fa(V=>{z.EwaSettings.LF()||Oa.la(V)})};String(t);window.___1680632998925_closurehack=t},1207:function(t,C,a){t={};a.r(t);a.d(t,"SharedUIControlsFactory",function(){return kb});var c=a(10),b=a(70),f=a(0),e=a(228),d=a(159),h=a(14),r=a(205),l=a(86),u=a(39),v=a(51),x=a(47),
w=a(1),m=a(660),n=a(31),z=a(126);class y{constructor(){this.startTime=n.a.Ya.kc;this.Yx=new m.a}v5e(){return z.a(n.a.Ya,this.startTime)}}Object(f.a)(y,"OngoingAction",null,[]);class A extends l.a{constructor(va,jb,Ab,Qa,Z=null){super();this.TQa=this.tqb=null;this.X2c=0;this.dtc=null;this.M3i=()=>{const wa=this.TQa.v5e();h.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.Zma}>.OnRunningLong: Operation running for more than ${wa}ms`);this.dtc=v.a.instance.create(this.z7,Math.max(this.EBe-wa,
0),x.a.Rpe)};this.z7=()=>{h.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.Zma}>.OnTimeout: Operation running for more than ${this.TQa.v5e()}ms, timing out. Has pending actions: ${this.R7a}`);this.X2c++;this.X2c>this.DBe&&h.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.Zma}>.OnTimeout: passed the allowed bypassed count`);this.TQa.Yx.cancel();this.K_e()};this.AI=()=>{this.R7a&&h.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.Zma}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.ENa}, AggregatedActionParams not null: ${this.R7a}`);
this.Xqd()};this.kLg=va;this.lLg=jb;this.documentVisibilityObserver=Ab;this.Zma=Qa;this.FL=Z;Ab&&this.documentVisibilityObserver.yta(this.AI);this.W2c=!!Ab&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.DBe=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);jb=w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.EBe=va.ghd(jb);va=
w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.C3g=Math.max(this.EBe-jb,0)+va}get ENa(){return!!this.TQa}get R7a(){return!!this.tqb}ZPf(va){h.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.Zma}>.PerformThrottledAction: Start. IsActionOngoing: ${this.ENa}, AggregatedActionParams not null: ${this.R7a}`);this.tqb=this.lLg.a0c(va,this.tqb);this.Xqd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.sBa(this.AI);
this.nDe();super.dispose()}v9f(va){this.W2c?(this.TQa=va?new y:null,va?this.startTimer():this.nDe()):this.TQa=va?{}:null}K_e(va=null){this.W2c&&va&&va.nN?h.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.Zma}>.FinishedCallback: timedout, skipping`):(h.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.Zma}>.FinishedCallback: Start. IsActionOngoing: ${this.ENa}, AggregatedActionParams not null: ${this.R7a}`),this.v9f(!1),this.Xqd())}Xqd(){if(!this.jPb()){var va=this.tqb;this.tqb=null;
this.v9f(!0);h.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.Zma}>.InternalPerformAction: Calling PerformAction.`);var jb=this.W2c?this.TQa.Yx.token:r.a.none;u.TaskExtensions.za(this.kLg.vId(va),()=>{this.K_e(jb)},jb,0,this.FL)}}jPb(){return!this.R7a||this.ENa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.oi?(h.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.Zma}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}nDe(){this.dtc&&this.dtc.cancel()}startTimer(){this.X2c<=
this.DBe&&(this.dtc=v.a.instance.create(this.M3i,this.C3g,x.a.Rpe))}}Object(f.a)(A,"ActionAggregator",l.a,[874,2]);var F=a(29),D=a(91),B=a(114),M=a(16),R=a(50),P=a(40),E=a(19),H=a(7),G=a(138),N=a(15),I=a(21),O=a(60);class U extends P.a{constructor(va){super();this.ax=this.firstElement=null;this.eOa=!1;this.Ys=null;this.JKj=F.a.Nf;this.oIf=jb=>{const Ab=jb.Da.keyCode;return Ab===D.a.Wh?this.sXi():Ab===D.a.Xy&&jb.Da.shiftKey?this.$Ih(this.firstElement):!1};this.MNf=jb=>{if(!this.eOa||jb.Da.keyCode!==
D.a.DG)return!1;U.Aff();O.Task.delay(1).Fo(()=>{this.ax.focus();return!0},0,this.ka);return!0};this.a7i=()=>{document.activeElement&&document.activeElement.id===this.ax.id||(U.Aff(),O.Task.delay(1).Fo(()=>{this.ax.focus();return!0},0,this.ka))};this.lGf=()=>{this.Ijg(this.ax)};this.nIf=jb=>{jb.stopPropagation();jb.preventDefault();this.eOa&&(this.eOa=!1)};this.$=va;(va=this.$.ea.nc)&&h.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${va.Bua}; InWebPart = '${va.inWebPart?"Classic":
"Non Classic"}', InEmbedView = '${va.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);va&&(va.inWebPart||va.inEmbedView)?h.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${va.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${va.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.Ahh(),this.xih(),B.KeyInputManager.instance.ta(M.a.fc,this.$.domElement,this.MNf));
this.$.da.Ha(238,this)}xRg(va){this.addHandler("KBIS",va)}jqj(va){this.removeHandler("KBIS",va)}dispose(){this.firstElement&&R.a.removeHandler(this.firstElement,M.a.focus,this.lGf);this.Ys&&this.Ys.detach("focus");this.ax&&(R.a.removeHandler(this.ax,M.a.focus,this.nIf),R.a.removeHandler(this.ax,M.a.blur,U.onBlur),B.KeyInputManager.instance.Ba(M.a.fc,this.ax,this.oIf));B.KeyInputManager.instance.Ba(M.a.fc,this.$.domElement,this.MNf);this.Ys=this.ax=this.firstElement=this.$=null;super.dispose()}Ahh(){this.JKj?
(this.firstElement=document.documentElement,this.Ys=G.a.instance.uH(document.parentWindow),this.Ys.la("focus",this.a7i)):(this.firstElement=U.wKe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),R.a.addHandler(this.firstElement,M.a.focus,this.lGf))}xih(){this.ax=U.wKe();this.ax.id=H.a.$Re;this.ax.setAttribute(H.a.wu,N.a.instance.ha(863));document.body.appendChild(this.ax);R.a.addHandler(this.ax,M.a.focus,this.nIf);R.a.addHandler(this.ax,M.a.blur,U.onBlur);B.KeyInputManager.instance.ta(M.a.fc,
this.ax,this.oIf)}$Ih(va){this.Ijg(va);return!1}sXi(){this.eOa=!0;I.h(this.$).focus();I.h(this.$).ga.Fcf();this.raiseEvent("KBIS");return!0}Ijg(va){this.eOa?this.eOa=!1:(this.eOa=!0,va&&va.focus())}static wKe(){const va=document.createElement("div");va.tabIndex=0;return va}static Aff(){document.body.classList.add(E.a.HUe)}static onBlur(){document.body.classList.remove(E.a.HUe)}}Object(f.a)(U,"EmbedViewFocusControl",P.a,[873,2]);var ca=a(6),Q=a(1100),Y=a(66),la=a(530),ea=a(25),ha=a(45),X=a(380),T=
a(199),ua=a(294),Ha=a(120),Ca=a(32),Ga=a(258),sa=a(293),bb=a(65);const Ba=(va,jb,Ab,Qa,Z,wa,Ea,fa,Ua,Aa,Ib=null)=>{Ib=va.Oa(1,Ib);Ib.selectedRange=jb;Ib.richValueKeyPath=Ab;Ib.singleColumn=Qa;Ib.searchForRange=Z;Ib.calculateMajorityDataType=wa;return bb.g(va,"GetRichValueFieldListContextList",Ib,Ea,fa,Ua,Aa,4)};var qa=a(33);class pa extends P.a{constructor(va,jb){super();this.EMb=this.Yid=this.qyb=this.BP=null;this.kXb=!1;this.S9d=null;this.fLd=!1;this.ZYi=(Ab,Qa,Z)=>{h.ULS.sendTraceTag(25264350,
0,10,"Call to GetRichValueFieldListContextList failed in: "+Z);this.EMb&&this.EMb.stop();this.BP=null;this.raiseEvent(Q.h)};this.$Yi=Ab=>{Ga.a(Ab)||(this.EMb&&this.EMb.stop(),this.kXb=!1,(this.BP=Ab.Result)&&0<this.BP.length&&h.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.BP.length} rich value field list context for autocomplete`),this.dYa=!0,this.hvc())};this.dYa=!1;this.pb=va;this.SVb=-1;this.tableManager=jb;this.fLd=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&
qa.a.ZV(va)}A1b(va){this.addHandler(Q.a,va)}Mwc(va){this.removeHandler(Q.a,va)}XQg(va){this.addHandler(Q.h,va)}Rpj(va){this.removeHandler(Q.h,va)}get w8a(){return this.dYa}get FGi(){return this.kXb}get H1e(){return this.SVb}get y9c(){return this.S9d}get $(){return this.pb}get fl(){return this.BP}get GZh(){return!!this.qyb}dispose(){this.pb=null;this.oeb();super.dispose()}abj(){var va=Array(6);var jb={};jb.Name=Q.f;va[0]=jb;jb={};jb.Name=Q.c;va[1]=jb;jb={};jb.Name=Q.d;va[2]=jb;jb={};jb.Name=Q.g;va[3]=
jb;jb={};jb.Name=Q.e;va[4]=jb;jb={};jb.Name=Q.b;va[5]=jb;jb={ColumnName:"",ColumnIndex:-1};jb.FieldInfoDataList=va;va=[];va[0]=jb;this.FTd(va)}d_(va,jb,Ab,Qa=null){if(va){this.H3c();this.$4b();var Z=null,wa=!1;if(!Qa&&({Xbb:wa,fl:Z}=this.b2j(va,jb,Ab)).returnValue)if(this.fLd||this.FTd(Z),this.kXb=!0,this.BP=Z,this.fLd){if(!wa){this.dYa=!0;this.hvc();return}}else if(this.BP&&0<this.BP.length&&(this.dYa=!0,this.hvc()),!wa)return;this.Bng(va,Qa,jb,Ab,!1)}}Bng(va,jb,Ab,Qa,Z){if(this.$.ea.jc){this.$.Rb&&
(this.EMb=this.$.Rb.Qc("WebServiceCall","GetRichValueFieldInfoListContext"));this.qyb=null;var wa=this.$.pa.va.ic();this.qyb=Ba(this.$.pa.va,va,jb,Ab,Qa,Z,this.$Yi,this.ZYi,null,wa)}else this.BP=null}oeb(){this.BP=null;this.dYa=!1;this.H3c();this.$4b();this.qyb=null;this.SVb=-1}H3c(){pa.vsb(this.qyb)}$4b(){pa.vsb(this.Yid)}hvc(){this.raiseEvent(Q.a)}aq(va){va=ha.E(va);--va.left;--va.right;return this.tableManager.aq(va)}aMa(va){va.FirstColumn=va.FirstColumn;va.LastColumn=va.LastColumn;va.FirstRow=
va.FirstRow;va.LastRow=va.LastRow;this.$4b();this.Yid=null;return X.a(this.$.userOperationManager,(jb,Ab,Qa)=>ua.i(this.$.pa.va,va,sa.b(jb,Z=>{this.iZi(Z)}),sa.a(Ab,Ab,Z=>{this.hZi(Z)}),Qa,null),jb=>new T.a(264,0,jb,80),null)}hZi(va){va=Ha.a.Ye(va.data);h.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${Ca.a.xc(va)}`)}iZi(va){if(Ga.a(va))-315732528!==va.Errors[0].MessageId&&h.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${Ca.a.xc(va.Errors)}`);
else if(va&&va.Result){va=va.Result;var jb=va.HasHeaderRow;jb=new la.AutofilterRange(va.TableRange.FirstRow+(jb?1:0)+1,va.TableRange.FirstColumn+1,va.TableRange.LastRow+1,va.TableRange.LastColumn+1,null,null,null,0,jb);this.SVb=va.TableRange.FirstColumn;(va=this.nTf(!1,!0,jb))||h.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.FTd(va)}else h.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}b2j(va,
jb,Ab){let Qa,Z;Z=null;Qa=!1;if(va.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,Xbb:Qa,aMa:!1,fl:Z};let wa;this.SVb=-1;if(Ab){wa=this.aq(va);if(!wa||!wa.Ala)return{returnValue:!1,Xbb:Qa,aMa:!1,fl:Z};var Ea=I.h(this.$).wb.O9e(wa);this.S9d=wa;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Ea&&0<Ea.count)return--va.FirstColumn,--va.LastColumn,this.Yid=this.aMa(va),{returnValue:!0,Xbb:Qa,aMa:!0,fl:Z};wa.top+=1;wa.right=
ha.E(va).right-1}else wa=new la.AutofilterRange(va.FirstRow+1,va.FirstColumn+1,va.LastRow+1,va.LastColumn+1,null,null,null,0,!1);if(wa.top>wa.bottom||wa.left>wa.right)return{returnValue:!0,Xbb:Qa,aMa:!1,fl:Z};va=I.h(this.$);var fa=va.lb.width,Ua=va.lb.height;Ea=va.view.visibleArea;fa=new Y.a(Ea.x-fa,Ea.y-Ua,Ea.width+fa,Ea.height+Ua);Ua=va.Mg(wa);if(!Ea||!Ua||!va.vlc(wa))return{returnValue:!1,Xbb:Qa,aMa:!1,fl:Z};fa.contains(Ua)||(Qa=!0);Z=this.nTf(jb,Ab,wa);return{returnValue:!0,Xbb:Qa,aMa:!1,fl:Z}}FTd(va){va&&
h.ULS.sendTraceTag(25264348,0,50,`Retrieved ${va.length} rich value field contexts from block cache`);this.kXb=!0;(this.BP=va)&&0<this.BP.length&&(this.dYa=!0,this.hvc())}nTf(va,jb,Ab){let Qa;Qa=null;const Z=Ab.clone();if(jb)for(let wa=Ab.right,Ea=0;wa>=Ab.left;--wa){if(Z.left=wa,Z.right=wa,jb=this.K5e(Z,!0,Ab.left)){Qa||(Qa=[]);Qa[Ea]=jb;if(va)break;++Ea}}else if(va=this.K5e(Z,!1))Qa=[],Qa[0]=va;return Qa}K5e(va,jb,Ab=0){var Qa=null;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Z=
I.h(this.$).wb.k7h(va);if(Z&&0<Z.count){var wa=Array(Z.count);Qa=0;for(var Ea of Z.values)Z={},Z.Name=Ea,wa[Qa]=Z,++Qa;Ea="";Z=-1;0<va.top&&jb&&(va=new ea.Range(va.top-1,va.left,va.top-1,va.left,!1,!1),null!=I.h(this.$).Ob(va)&&null!=I.h(this.$).Ob(va).originalText&&(Ea=I.h(this.$).Ob(va).originalText),Z=va.left-Ab);Qa={};Qa.ColumnName=Ea;Qa.ColumnIndex=Z;Qa.FieldInfoDataList=wa}}else if((Ea=I.h(this.$).wb.O9e(va))&&0<Ea.count){wa=Array(Ea.count);Qa=0;for(Z of Ea)Ea={},Ea.Name=Z,wa[Qa]=Ea,++Qa;Ea=
"";Z=-1;0<va.top&&jb&&(va=new ea.Range(va.top-1,va.left,va.top-1,va.left,!1,!1),Ea=I.h(this.$).Ob(va).originalText,Z=va.left-Ab);Qa={};Qa.ColumnName=Ea;Qa.ColumnIndex=Z;Qa.FieldInfoDataList=wa}return Qa}static vsb(va){va&&ca.AFrameworkApplication.Od.gv(va.xu)}}Object(f.a)(pa,"FieldInfoManager",P.a,[335,2]);class ya extends pa{constructor(va,jb,Ab,Qa){super(va,jb);this.X3a=null;this.fGf=()=>{this.Mwc(this.fGf);if(this.fl&&this.fl.length&&this.contextMenuManager){var Z=this.contextMenuManager.Zhd("autoFilterRichFieldList"),
wa=window.document.getElementById(this.X3a);Z.s1(null,wa,this,null,!0)}};this.qxg=Ab;this.contextMenuManager=Qa}get mH(){return this.qxg}RZh(va,jb){this.X3a=jb;h.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${va.FirstRow}, ${va.FirstColumn}, ${va.LastRow}, ${va.LastColumn})`);this.Bng(va,null,!0,!1,!0)}}Object(f.a)(ya,"FilterInfoManager",pa,[336,335,2]);var za=a(864),cb=a(1099),Pa=a(34),nb=
a(92),Ma=a(9);class Oa{}Oa.aDh="ewa-sharedUi-launchButton";Oa.dDh="ewa-sharedUi-launchButtonWithText";Oa.bDh="ewa-sharedUi-launchButtonClick";Oa.eDh="ewa-sharedUi-launchButtonWithTextClick";Oa.cDh="ewa-sharedUi-launchButtonText";Object(f.a)(Oa,"CssClassNames",null,[]);var La=a(73);a(525);var ra=a(246),V=a(229);P=a(245);var ma=a(298),W=a(77),aa=a(12),ia=a(263),ka=a(36);class Xa extends P.a{constructor(va,jb,Ab,Qa,Z,wa,Ea,fa,Ua){super(document.createElement("div"));this.ssf=null;this.FXd=!1;this.Sb=
this.MQb=this.nUa=null;this.YN=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.XN=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.eRj=()=>{this.bqe()};this.od=Aa=>{this.raiseEvent(this.HJb,Aa);this.GJb();return!0};this.ZWi=Aa=>{100<z.a(n.a.Ya,this.ssf)&&this.knd(new Sys.UI.Point(Math.round(Aa.clientX),Math.round(Aa.clientY)))};this.UN=Aa=>{W.g(Aa.Da,!1);return!1};this.IZ=this.De.IJa();this.set_visible(!1);this.$lc=Z;this.HJb=wa;this.gqc=va;this.d6b=jb;this.Sb=Ua;this.$lc&&(this.nUa=v.a.instance.create(this.eRj,
3E4,"OnObjectButton.ShyTimerFired",!1,!1));va&&this.domElement.classList.add(va);this.Yrb=document.createElement("div");this.domElement.appendChild(this.Yrb);Ab&&this.Yrb.classList.add(Ab);this.j2d(Qa);Ea&&(this.MQb=document.createElement("div"),this.domElement.appendChild(this.MQb),this.MQb.classList.add(fa),this.MQb.innerText=Ea,this.domElement.style.padding="3px",ra.a.instance.ta(M.a.pointerDown,this.domElement,this.UN));this.c1a=new ma.a(this.domElement,7);V.a.instance.ta(M.a.click,this.domElement,
this.od);w.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&ra.a.instance.ta(M.a.pointerDown,this.domElement,this.UN);va=Aa=>{W.g(Aa)};this.Pc.la("mouseup",va);this.Pc.la("click",va);this.Pc.la("dblclick",va)}SY(va){this.addHandler(this.HJb,va)}e8(va){this.get_events().removeHandler(this.HJb,va)}PRg(va){this.addHandler("OnObjectButtonMouseOver",va)}zqj(va){this.get_events().removeHandler("OnObjectButtonMouseOver",va)}ORg(va){this.addHandler("OnObjectButtonMouseOut",
va)}yqj(va){this.get_events().removeHandler("OnObjectButtonMouseOut",va)}j2d(va){va&&this.Sb.uh(this.Yrb,va)}C5j(va,jb,Ab){this.Sb.cF(this.Yrb);va?va.Fca(jb,16,16,this.Yrb,16,16,void 0,Ab):h.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}D5j(va,jb){va&&(this.MQb.innerText=va);this.domElement.title=jb}dispose(){this.get_isInitialized()&&(this.hide(),this.Pc.iD(),nb.a.wc([this.IZ,this.c1a]),V.a.instance.Ba(M.a.click,this.domElement,this.od),ra.a.instance.Ba(M.a.pointerDown,
this.domElement,this.UN),this.nUa&&this.nUa.dispose(),super.dispose())}meb(){this.d6b&&this.domElement.classList.remove(this.d6b);this.gqc&&this.domElement.classList.add(this.gqc)}GJb(){this.gqc&&this.domElement.classList.remove(this.gqc);this.d6b&&this.domElement.classList.add(this.d6b);this.k4a()}k4a(){this.$lc&&(this.nUa.cancel(),this.Ifg(),this.setOpacity(1));this.set_visible(!0)}to(va,jb,Ab,Qa,Z=!1){va=ka.a(Qa).Ph(va);jb=ka.a(Qa).Ph(jb);ka.a(Qa).BAc(this.domElement);this.domElement.style.top=
aa.HelperMethods.Ic(jb);this.domElement.style.left=this.domElement.style.right="";jb=va;Z&&(jb=va-this.domElement.offsetWidth);ia.c(this.domElement.style,Ab,aa.HelperMethods.Ic(jb));this.set_visible(!0);this.setOpacity(1);this.$lc&&(this.FXd=!1,this.bUj(),this.nUa.rq())}hide(){this.meb();this.set_visible(!1);this.$lc&&(this.Ifg(),this.nUa.cancel())}eac(){this.Pc.la("mouseover",this.YN,!0);this.Pc.la("mouseout",this.XN,!0)}bUj(){this.IZ.Xi("mousemove")||this.IZ.la("mousemove",this.ZWi)}Ifg(){this.IZ.Xi("mousemove")&&
this.IZ.detach("mousemove")}knd(va){if(this.domElement.parentNode){var jb=Sys.UI.DomElement.getBounds(this.domElement);const Ab=new Sys.UI.Point(Math.round(jb.x+jb.width),Math.round(jb.y+jb.height));jb=Math.abs(Ab.x-va.x);va=Math.abs(Ab.y-va.y);va=jb>va?jb:va;this.FXd?this.setOpacity(Xa.F4g(va)):100>=va&&this.bqe()}}bqe(){this.FXd=!0;this.nUa.cancel()}setOpacity(va){F.a.setOpacity(this.domElement,va);this.ssf=n.a.Ya.kc}static F4g(va){return 100>=va?1:250<=va?0:.01*(100-(va-100)/150*100)}}Object(f.a)(Xa,
"OnObjectButton",P.a,[884,97,2]);var sb=a(792);const ib=Oa.cDh;class Ub extends l.a{constructor(va,jb,Ab,Qa,Z,wa,Ea,fa,Ua=""){super();this.Kxa=null;this.dgf=!1;this.Sb=this.Dpc=this.Epc=null;this.buttons={};this.JTe={};this.$=va;this.svgIconProvider=jb;this.tVi=Ab;this.Thc=Qa;this.Shc=Z;this.altText=wa;this.HJb=Ea;this.Sb=fa;this.buttonText=Ua}get Gz(){return ka.a(this.$).UHa(Ma.a.W1i)}get A5b(){return Ma.a.V1i}get buttonWidth(){return ka.a(this.$).UHa(Ma.a.X1i)}dispose(){this.nsh();this.$=null;super.dispose()}getButton(va,
jb=!0){return this.twa(va,jb)}twa(va,jb=!0){const Ab=va.toString();Ab in this.buttons||this.zih(va,jb);return this.buttons[Ab]}to(va,jb,Ab,Qa,Z=!0,wa=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&La.i(this.$.na)){var Ea=I.h(this.$).uS.domElement;const fa=va+this.buttonWidth-Ea.scrollWidth;Ea=jb+this.buttonWidth-Ea.scrollHeight;va=0<fa?va-fa:va;jb=0<Ea?jb-Ea:jb}this.twa(Qa,Z).to(va,jb,Ab,this.$,wa)}hide(){const va=this.buttons;for(let jb in va)va[jb].hide()}eac(va,jb){!this.dgf&&(jb=this.buttons[jb.toString()])&&
(this.Epc=(Ab,Qa)=>{va(Qa,!0)},jb.PRg(this.Epc),this.Dpc=(Ab,Qa)=>{va(Qa,!1)},jb.ORg(this.Dpc),this.dgf=!0,jb.eac())}zih(va,jb){this.Kxa=String.format(this.Thc===E.a.Yac?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Pa.a.Jh(this.Thc),Pa.a.Jh(this.Shc),"{0}");var Ab=String.format(this.Kxa,Pa.a.Jh(this.altText));jb=new Xa(""===this.buttonText?Oa.aDh:Oa.dDh,""===this.buttonText?Oa.bDh:
Oa.eDh,E.a.sz,Ab,jb,this.HJb,this.buttonText,ib,this.Sb);Ab=(Qa,Z)=>{this.tVi(Z,va)};jb.SY(Ab);this.buttons[va.toString()]=jb;this.JTe[va.toString()]=Ab;Ab=I.h(this.$).hg(va);Ab.domElement.insertBefore(jb.domElement,Ab.domElement.firstChild)}nsh(){for(const va of sb.a(this.buttons)){const jb=this.buttons[va];jb.e8(this.JTe[va]);nb.a.Ja(jb);delete this.buttons[va];this.Epc&&jb.zqj(this.Epc);this.Dpc&&jb.yqj(this.Dpc)}}domElement(va){return this.twa(va).domElement}k4a(va){this.twa(va).k4a()}yng(va,
jb){this.Thc=va;this.Shc=jb}dSb(va,jb,Ab=!0){this.Kxa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Pa.a.Jh(this.Thc),Pa.a.Jh(this.Shc),"{0}");va=String.format(this.Kxa,Pa.a.Jh(va));this.twa(jb,Ab).j2d(va)}LVa(va,jb,Ab){this.twa(Ab,!1).D5j(va,jb)}wng(){this.Kxa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Pa.a.Jh(this.Shc),"{1}");const va=String.format(this.Kxa,void 0,
Pa.a.Jh(void 0));this.twa(void 0,!1).j2d(va)}xng(va,jb,Ab){this.twa(Ab,!1).C5j(this.svgIconProvider,va,jb)}}Object(f.a)(Ub,"OnObjectLaunchButton",l.a,[871,2]);l=a(101);class hc extends l.a{constructor(va,jb){super(va);this.qFb=null;this.Yrh=()=>{this.display()};this.rki=Math.max(1,jb)}dispose(){nb.a.Ja(this.qFb);this.qFb=null;super.dispose()}DUa(){nb.a.Ja(this.qFb);this.qFb=v.a.instance.create(this.Yrh,this.rki,x.a.JGi)}JUa(){nb.a.Ja(this.qFb);this.hide()}}Object(f.a)(hc,"LoadingIndicatorBehavior",
l.a,[883,2]);class yb extends hc{constructor(va,jb,Ab,Qa){super(va,jb);this.pFb=null;this.Lzg=Ab;this.Ghi=Qa;this.yNg()}dispose(){this.pFb=null;super.dispose()}display(){this.Lzg(this.pFb)}hide(){this.Ghi(this.pFb)}yNg(){this.pFb=document.createElement("div");this.domElement.appendChild(this.pFb)}}Object(f.a)(yb,"ShimmerLoadingIndicatorBehavior",hc,[]);var Gb=a(76),Sa=a(54),db=a(13);class fb extends hc{constructor(va,jb,Ab,Qa=null,Z=null,wa=0){super(va,jb);this.l7a=this.xPa=null;this.l7a=Ab;this.Yhc=
Qa||Sa.a.current.io(104);this.muf=wa;this.D9c=Z;this.xNg()}dispose(){this.xPa=null;super.dispose()}display(){db.DOMElementExtensions.setVisible(this.xPa,!0)}hide(){db.DOMElementExtensions.setVisible(this.xPa,!1)}xNg(){this.xPa=document.createElement("div");this.xPa.classList.add(Gb.a.KBh);const va=document.createElement("div");va.classList.add(Gb.a.LBh);this.D9c&&""!=this.D9c&&va.classList.add(this.D9c);const jb=0===this.muf?"":N.a.instance.ha(this.muf),Ab=String.format('<div class="'+Gb.a.MBh+'">{0}</div>',
jb);this.Yhc?this.l7a.uh(va,`<img src="${this.Yhc}" alt="${jb}" title="${jb}"/>`+Ab):this.l7a.uh(va,Ab);this.xPa.appendChild(va);this.domElement.appendChild(this.xPa)}}Object(f.a)(fb,"SpinnerLoadingIndicatorBehavior",hc,[]);var ab=a(157),wb=a(41);Object(ab.b)(wb.X)(va=>Object(d.a)(void 0,void 0,void 0,function*(){const jb=yield ab.a.resolve(wb.F,{rb:va.rb});return new kb(jb)}));class kb{constructor(va){this.l7a=va}E8c(va,jb,Ab){return new za.a(va,jb,Ab)}a8b(va,jb,Ab,Qa,Z,wa,Ea,fa,Ua,Aa){return new cb.a(va,
jb,Ab,Qa,Z,wa,Ea,fa,Ua,Aa)}qub(va,jb,Ab,Qa,Z=0){return new fb(va,jb,this.l7a,Ab,Qa,Z)}ykd(va){return va.da.Aa(238)||new U(va)}c8b(va,jb,Ab,Qa,Z,wa,Ea,fa=""){return new Ub(va,jb,Ab,Qa,Z,wa,Ea,this.l7a,fa)}e8c(va,jb){return new pa(va,jb)}vhh(va,jb,Ab,Qa){return new ya(va,jb,Ab,Qa)}K7c(va,jb,Ab,Qa){return new A(va,jb,Ab,Qa)}}Object(f.a)(kb,"SharedUIControlsFactory",null,[860]);var tb=a(109);class hb extends e.a{constructor(va){super();this.$=va;this.Mb()}create(){const va=Object(tb.d)(ab.a.resolve(wb.F,
{rb:this.Na}));u.TaskExtensions.za(va,()=>{this.vb(this.$.da.Aa(12)||new kb(va.result))},this.ka,3)}static la(va){va.da.Ha(477,new hb(va))}}Object(f.a)(hb,"SharedUIControlsFactoryServiceFactory",e.a,[]);a.d(C,"a",function(){return Fb});const Fb=()=>{c.a.Fa(va=>{Object(b.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")||hb.la(va)})};String(t);window.___1680633022861_closurehack=t},1211:function(t,C,a){t=a(0);var c=a(6),b=a(228),f=a(14),e=a(88),d=a(57),h=a(204);class r{constructor(){this.hme=
this.wVc=!1;const ia=c.AFrameworkApplication.Xj;0>=ia||(this.Xj=ia,f.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Xj,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.yia}),h.a.instance.w_c(Object(e.a)(this,this.KQa,"onSessionExpiredDetected")),h.a.instance.u_c(Object(e.a)(this,this.OLf,"onSessionExpiringDetected")))}KQa(){h.a.instance.HOd(Object(e.a)(this,this.KQa,"onSessionExpiredDetected"));f.ULS.sendTraceTag(19247381,
217,50,"SessionExpiredDetected");this.ofi()}OLf(){h.a.instance.GOd(Object(e.a)(this,this.OLf,"onSessionExpiringDetected"));this.hme||this.wVc||(f.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.hme=!0,this.AQj())}ofi(){this.wVc||(c.AFrameworkApplication.jG(d.a.Ozc),this.wVc=!0,this.zQj())}}Object(t.a)(r,"ASessionExpirationManager",null,[]);var l=a(92),u=a(40),v=a(32),x=a(15),w=a(49),m=a(262),n=a(8),z=a(87),y=a(265),A=a(74);class F extends r{constructor(ia){super();
this.Qa=new u.a;this.qF=this.Bob=!1;this.$=ia}aue(ia){this.Qa.addHandler("SessionExpired",ia)}$pb(ia){this.Qa.addHandler("TokenRefreshed",ia)}Xwc(ia){this.Qa.removeHandler("TokenRefreshed",ia)}get accessTokenExpiringMessage(){const ia=(new Date(this.Xj)).format(this.$.xa.ShortTimeFormat);return String.format(x.a.instance.qb(78),ia)}get tokenExpired(){return this.Bob}get Lfb(){return!1}get bda(){return!1}get HMd(){return!1}get C6(){return!1}Vgc(){return h.a.instance.AR(c.AFrameworkApplication.Xj)}dispose(){l.a.Ja(this.Qa);
this.$=null}AQj(){this.$.isEditMode&&this.qgc(!1)}zQj(){this.Bob=!0;this.qgc(!0);this.Qa.raiseEvent("SessionExpired")}qgc(ia){f.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${ia}, GotDeploymentOrTimedOutError ${this.$.ea.m_}`);const ka=this.$.ub.lp;ia&&ka&&ka.isVisible&&1299163859===ka.error.MessageId&&this.$.ub.lp.zv();const Xa=this.nd(ia);w.a(this.$).Nr(new m.a(n.a.Lw,5,()=>{const sb=A.a(this.$),ib=sb.ud.activityState;ib[z.a.l3]=this.$.Rrb(this.$.isEditMode);
ib[z.a.lM]=z.a.pab;ib[y.a.Mp]=n.a.accessTokenExpiringWarning;sb.ud.sr([Xa])}))}nd(ia){return ia?v.a.MLe():this.elh()}elh(){const ia=v.a.nd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");ia.Description=this.accessTokenExpiringMessage;return ia}}Object(t.a)(F,"EwaAccessTokenExpirationManager",r,[449,450,2]);var D=a(2),B=a(181),M=a(83),R=a(660),P=a(31);class E{constructor(ia,ka){this.TKb=!1;this.correlationID=ia;this.k9c=ka;this.TEc=!1;this.creationTime=P.a.Ya.kc}}Object(t.a)(E,"RefreshAccessTokenContext",
null,[]);var H=a(59),G=a(65),N=a(171),I=a(47),O=a(118),U=a(126),ca=a(1),Q=a(23),Y=a(156),la=a(38),ea=a(124);class ha{}Object(t.a)(ha,"Error",null,[]);class X{}Object(t.a)(X,"NamedResult",null,[]);class T extends X{}Object(t.a)(T,"ErrorInfo",X,[]);class ua{constructor(ia,ka){this.G_b=ia;this.OG=ka}get tokens(){return this.G_b}get errors(){return this.OG}}Object(t.a)(ua,"TokenRefreshArgs",null,[451]);class Ha{constructor(ia,ka){this.documentVisibilityObserver=null;this.Qa=new u.a;this.Yx=null;this.Bgb=
this.znb=!1;this.Qvc=null;this.bLb=!1;this.Fzd=!0;this.ofe=this.Lee=this.qF=this.Bob=!1;this.jT=null;this.$cf=()=>{if(this.$.ea.jc)this.xdf(!1);else if(this.Fzd){this.Fzd=!1;const Xa=A.a(this.$);f.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${Xa.Zh?Xa.Zh.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Dig()}]`)}};this.dd=(Xa,sb)=>{this.context&&(Xa=this.$.ea,sb.XH&&this.context.TKb&&
!this.context.TEc?(this.context.TEc=!0,sb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},sb.IsUserActive=Xa.df.kq,sb.RefreshAccessTokenCorrelationID=this.context.correlationID,sb=H.a.Fc(sb),f.ULS.sendTraceTag(537170708,0,50,sb)):!this.znb||Xa.jc||this.context.k9c||(sb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Yx&&(this.Yx.cancel(),sb.Aborted=!0,sb.ResetStopRefreshRetriesUntilTokenExpired=!0,
this.Bgb=!1),sb.TimeUntilTokenExpirationInMin=this.Dig(),sb.RefreshAccessTokenCorrelationID=this.context.correlationID,sb=H.a.Fc(sb),f.ULS.sendTraceTag(572019856,0,50,sb)))};this.kAa=()=>{if(this.context&&this.context.TKb&&!this.context.TEc){var Xa={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Xa.CreatedForExpired=this.context.k9c;Xa.RefreshAccessTokenCorrelationID=this.context.correlationID;Xa.OpenWorkbookErrors=v.a.xc(this.$.ea.aG);Xa.ExecutionContextErrors=v.a.xc(A.a(this.$).ud.errors);
Xa.accesstokenTTL=c.AFrameworkApplication.Xj;Xa=H.a.Fc(Xa);f.ULS.sendTraceTag(537170707,0,15,Xa)}};this.wdf=()=>{this.Bgb=!1;this.xdf(!0)};this.XGd=()=>{this.bLb&&(this.$.ea.df.uBa(this.XGd),this.bLb=!1);this.hfg()};this.$=ia;this.k0d=ka;this.FMd=ia.Rb.Dg("WebServiceCall","refreshToken");h.a.instance.w_c(this.wdf);h.a.instance.u_c(this.$cf);ka=this.$.ea;ka.Zj(this.dd);ka.M1b(this.kAa);this.kOi=this.$.xa.MinTokenLifetimeForRegularExpirationPromptInMin;this.vag=this.$.xa.ShortAccessTokenExpirationPromptSeconds;
this.dXf=this.$.xa.RefreshAccessTokenDurationLimitInSec;this.Fog(ia.ea.XOf,c.AFrameworkApplication.Xj);ia=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.Xj,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.yia,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.W4d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.Y4d});f.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${ia}`);this.$.da.kb(291,Xa=>{this.documentVisibilityObserver=
Xa})}aue(ia){this.Qa.addHandler("SessionExpired",ia)}$pb(ia){this.Qa.addHandler("TokenRefreshed",ia)}Xwc(ia){this.Qa.removeHandler("TokenRefreshed",ia)}get tokenExpired(){return this.Bob}get bda(){return this.Lee}get C6(){return this.ofe}get context(){return this.jT}get Lfb(){return this.C6?!1:this.$.ea.df.kq?1>ea.a.e7:6>ea.a.f7}get HMd(){return this.znb}Vgc(){return h.a.instance.AR(c.AFrameworkApplication.Xj)}dispose(){h.a.instance.HOd(this.wdf);h.a.instance.GOd(this.$cf);const ia=this.$.ea;ia&&
(ia.xk(this.dd),ia.Zwc(this.kAa));l.a.Ja(this.Qa);this.documentVisibilityObserver=this.$=null}Dig(){return this.Vgc()?0:(c.AFrameworkApplication.Xj-(new Date).getTime())/6E4}Fog(ia,ka){if(0<ka&&!this.Vgc()){const Xa=c.AFrameworkApplication.fa.Dd("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.KY),sb=(ka-ia.getTime())/6E4;f.ULS.shipAssertTag(537170713,0,0<=sb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${ka}] creationTime [${ia.getTime()}] tokenLifetimeInMin [${sb}]`);
sb<this.kOi?(f.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.vag}] tokenLifetimeInMin [${sb}]`),c.AFrameworkApplication.KY=this.vag):c.AFrameworkApplication.KY!==Xa&&(f.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${Xa}] tokenLifetimeInMin [${sb}]`),c.AFrameworkApplication.KY=Xa)}}xfh(ia){return!this.context||
this.context.TKb||this.context.k9c!==ia?(ia=new E(B.a.create().toString(),ia),this.context&&!this.context.TEc&&f.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${ia.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.TKb}] `),this.jT=ia,!0):!1}vuj(ia){ia&&this.qF&&!this.bda&&this.$.ea.df.kq&&!this.C6&&(this.qF=!1)}xdf(ia){this.vuj(ia);if(!(this.znb||this.Bgb&&!ia||this.qF)&&
this.Lfb){this.znb=!0;var ka=this.context?this.context.creationTime:null,Xa=this.xfh(ia);this.Fzd=!0;var sb=this.$.ea,ib={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};ib.newContextCreated=Xa;ib.IsUserActive=sb.df.kq;ib.IsSessionActive=sb.jc;ib.ContainsChangesWorkbookOperations=this.$.userOperationManager.wJa();ib.isSessionExpired=ia;ib.stopRefreshRetriesUntilTokenExpired=this.Bgb;ib.FailedToRefreshExpiredToken=this.qF;ib.numOfFailuresWhileUserIsActive=ea.a.e7;ib.numOfFailuresWhileUserIsInActive=
ea.a.f7;ib.numOfFailuresWhileOffline=ea.a.Pza;ib.RefreshAccessTokenCorrelationID=this.context.correlationID;Xa&&ka&&(ib.TimeInMinFromPreviosContextCreation=Math.round(U.b(P.a.Ya,ka)/60));ka=H.a.Fc(ib);f.ULS.sendTraceTag(40416199,0,50,ka);this.FMd.start();this.Lee=sb.df.kq;this.Yx=new R.a;this.AFi(ia);var Ub=this.k0d.Pkj(!ia,this.Yx?this.Yx.token:null);Ub.continueWith(()=>{this.f9g();const hc=this.k0d.Iej(Ub);this.FMd.stop();const yb=this.Vgc();if(!hc||ca.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
yb){const Gb=Ub.result.errors;hc&&yb&&this.WMg(Gb);this.Vei(Gb,ia)}else this.Bgb=!1,this.Xei(Ub.result.tokens,ia);this.znb=!1},8)}}WMg(ia){const ka=[Object(D.a)(new ha,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];ia.add(Object(D.a)(new T,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ka}))}AFi(ia){ia&&(this.$.ea.df.kq?this.hfg():(this.$.ea.df.Zha(this.XGd),this.bLb=!0))}hfg(){this.Qvc=N.AsyncMethodContext.Oq(()=>{this.Okj()},1E3*this.dXf,I.a.vkj,this.Qvc)}f9g(){this.Qvc&&
this.Qvc.cancel();this.bLb&&(this.$.ea.df.uBa(this.XGd),this.bLb=!1);this.Yx=null}Okj(){f.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.dXf}]`);this.Yx.cancel()}Vei(ia,ka){this.Bgb=!0;ka&&(this.qF||(this.Bob=this.qF=!0),this.k0d.gDb(ia)&&(this.ofe=!0));const Xa=!ka||this.Lfb&&!ea.a.BBc?40380379:39982555;ka=this.kKe(ka);ka.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ka.FailedToRefreshExpiredToken=
this.qF;ka.LastErrorIsPermanent=this.C6;if(0<ia.count){var sb=ia.ma(0);ka.errorName=sb.Name;0<sb.Errors.length&&(ka.ErrorId=sb.Errors[0].Id,sb=sb.Errors[0].Details,ka.ErrorDetails=this.rth(sb.toString())?"PiiScrubbed":sb)}ka=H.a.Fc(ka);f.ULS.sendTraceTag(Xa,0,15,ka);this.Qa.raiseEvent("TokenRefreshed",new ua(null,ia))}rth(ia){return Q.a.contains(ia,"makes the internet safe for businesses",!0)}kKe(ia){const ka={},Xa=this.$.ea;ka.Name="";ka.IsUserActive=Xa.df.kq;ka.IsSessionActive=Xa.jc;ka.GotDeploymentOrTimedOutError=
Xa.m_;ka.TimeInSecFromLastStatefulSuccessfulRequest=Xa.LX;ka.TimeFromLastUserActivityInMs=Xa.df.Zgb;ka.calledFromSessionExpiredFlow=ia;ka.RefreshTokenDurationInMS=this.FMd.Jc;ka.numOfFailuresWhileUserIsActive=ea.a.e7;ka.numOfFailuresWhileUserIsInActive=ea.a.f7;ka.numOfFailuresWhileOffline=ea.a.Pza;ka.RefreshAccessTokenCorrelationID=this.context.correlationID;ka.accessTokenTTL=c.AFrameworkApplication.Xj;ka.ContainsChangesWorkbookOperations=this.$.userOperationManager.wJa();ka.IsDocumentHidden=this.documentVisibilityObserver?
this.documentVisibilityObserver.oi.toString():"Unknown";ka.TimeFromFirstOpenInHr=Math.floor(U.b(P.a.Ya,O.toUtc(Xa.XOf))/3600);return ka}Xei(ia,ka){this.qF=!1;this.a9j();this.Fog(new Date,c.AFrameworkApplication.Xj);const Xa=this.$.ea,sb=!ka&&Xa.df.kq,ib=!this.$.isEditMode&&Xa.pdb;ka=this.kKe(ka);ka.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ka.shouldTriggerSilentReloadAfterExpiring=sb;ka.WopiTokenTaskItemPriority=c.AFrameworkApplication.Y4d;ka.isDirtyViewSession=ib;ka=H.a.Fc(ka);
f.ULS.sendTraceTag(39982556,0,15,ka);this.Qa.raiseEvent("TokenRefreshed",new ua(ia,null));ib?Xa.df.kq&&(f.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),Xa.bgd()):Xa.df.kq?sb&&(ia=A.a(this.$).ud.activityState,ia[ea.a.vhb]=!0,ia[Y.a.PY]=!0,ia[la.a.cs]=this.$.isEditMode,w.a(this.$).Nr(new m.a(n.a.$oa,2,null))):Xa.jc&&G.j(this.$.pa.va,!0,!1,!1,null,null,null,null,
null)}a9j(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=M.a.ZT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.PP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=M.a.ZT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.LY,c.AFrameworkApplication.Xj.toString()),this.$.ea.btc()):f.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.xa.AccessToken=c.AFrameworkApplication.accessToken;this.$.xa.AccessTokenValidTo=c.AFrameworkApplication.Xj;void 0!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=M.a.ZT(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.PP,c.AFrameworkApplication.accessToken),this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=M.a.ZT(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,
c.AFrameworkApplication.LY,c.AFrameworkApplication.Xj.toString()));void 0!==this.$.xa.EmbedConfiguratorUrl&&null!==this.$.xa.EmbedConfiguratorUrl&&(this.$.xa.EmbedConfiguratorUrl=M.a.ZT(this.$.xa.EmbedConfiguratorUrl,c.AFrameworkApplication.PP,c.AFrameworkApplication.accessToken),this.$.xa.EmbedConfiguratorUrl=M.a.ZT(this.$.xa.EmbedConfiguratorUrl,c.AFrameworkApplication.LY,c.AFrameworkApplication.Xj.toString()));this.context.TKb=!0}}Object(t.a)(Ha,"EwaAccessTokenExpirationRefreshManager",null,[449,
450,2]);var Ca=a(198),Ga=a(170),sa=a(89),bb=a(425);class Ba{}Ba.K0b="ActivityDuration";Ba.error="Error";Ba.wcd="Errors";Ba.failed="Failed";Ba.QMh="FirstActivity";Ba.initialized="Initialized";Ba.NDi="LastActivity";Ba.S2f="RetryOverride";Ba.Ttj="RequestGroups";Ba.requests="Requests";Ba.A2f="Responses";Ba.Pzc="SessionDuration";Ba.status="Status";Ba.success="Success";Ba.successful="Successful";Ba.tokens="Tokens";Object(t.a)(Ba,"SessionExpirationStrings",null,[]);var qa=a(113);class pa{constructor(ia){this.ap=
{};this.dY={};this.aGg={};this.$uf=15;this.Gee=!1;this.HHg=new Date;this.aXb=new Date;this.de=ia;this.t_b=new qa.a(2,2,6E4*this.$uf,Object(e.a)(this,this.Frg,"writeMeasures"),135,"SL",!1);this.de.Kf(this.t_b);this.cni()}Frg(){f.ULS.sendTraceTag(41964821,217,50,f.ULS.Fc({["Aggregate"]:this.dY,["Current"]:this.ap}))}cni(){this.dY[Ba.Ttj]=0;this.dY[Ba.requests]=0;this.dY[Ba.A2f]=0;this.dY[Ba.status]=Ba.initialized;this.dY[Ba.QMh]=new Date;this.dY[Ba.Pzc]=0;this.dY[Ba.K0b]=0;this.dY[Ba.Pzc]=0;this.ap[Ba.Pzc]=
0;this.dY[Ba.K0b]=0;this.ap[Ba.K0b]=0}Spd(ia,ka){var Xa=ia[ka];Xa=Xa?Xa:0;Xa++;ia[ka]=Xa;this.XTd(ia)}XTd(ia){const ka=new Date;ia[Ba.K0b]=+ka-+this.aXb;this.aXb=ka;ia[Ba.Pzc]=+this.aXb-+this.HHg;ia[Ba.NDi]=this.aXb}o1(ia,ka){this.ap[ia]=ka;this.XTd(this.ap)}wTd(ia,ka){this.ap[ia]=ka;this.XTd(this.ap)}incrementCounter(ia){this.Spd(this.ap,ia);this.Spd(this.dY,ia);this.Spd(this.aGg,ia)}flush(){this.Gee||(this.dY[Ba.status]=this.ap[Ba.status],this.Frg(this.t_b),this.de.Goa(this.t_b,6E4*this.$uf))}stop(){f.ULS.sendTraceTag(41964822,
217,100,"Stopping logger. Flushing one last time");this.flush();this.Gee=!0;this.de.np(this.t_b)}}Object(t.a)(pa,"SessionLogger",null,[473]);var ya=a(104),za=a(661),cb=a(585),Pa=a(382),nb=a(175),Ma=a(975),Oa=a(200),La=a(146);class ra{constructor(ia,ka,Xa,sb=null,ib=!1,Ub=null,hc=!1,yb=!1){this.x$=0;this.c3=this.jj=null;this.G_b=new Ca.a;this.OG=new Ca.a;this.Uk=null;this.mYa=!1;this.Dob=this.Eob=null;this.de=ia;this.Hje=ka;this.Hje.execute(Gb=>{Gb.Lk(nb.a.Yod,Object(e.a)(this,this.C_i,"onHostResponseReceived"))});
this.bH=Xa;this.koe=new Ma.a("WebServiceCall","TokenRefresh");this.Bk=sb||new pa(ia);this.CHg=ib;this.NT=Ub?Ub:za.SessionStatusManager.instance;this.pae=hc;this.vVb=yb}C_i(ia){if(ia.MessageId!==nb.a.Yod)La.a(39408099,306,15,"Unexpected message.");else{var ka=new Ca.a,Xa=new Ca.a;this.Bk.incrementCounter(Ba.A2f);var sb=ia.Values[Pa.a.g7f];if(!sb||0>=sb.length)La.a(40122317,306,15,"Found no tokens in the dictionary"),sb=ia.Values;La.a(40122318,306,100,"The Tokens array contains {0} tokens",sb.length);
this.Bk.o1("Correlation",ia.CorrelationId);var ib="";for(let yb=0;yb<sb.length;yb++){this.Bk.wTd(Ba.tokens,sb.length);var Ub=sb[yb],hc=Ub;if(!hc||!hc.Name)continue;this.Bk.incrementCounter(hc.Name);const Gb=Ub;if(Gb&&Gb.Value)La.a(39408128,306,100,"Received token with name: {0}",Gb.Name),ka.add(Gb),this.G_b.add(Gb),this.vVb||this.Bk.o1(Ba.status,Ba.success),this.pae&&this.NT&&this.NT.Tuj();else if(Ub=this.K7h(Ub),La.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
hc.Name,JSON.stringify(Ub),this.c3),Xa.add(Ub),this.vVb||(this.OG.add(Ub),ib=JSON.stringify(Ub),this.Bk.o1(Ba.error,JSON.stringify(Ub)),this.Bk.o1(Ba.status,Ba.failed)),this.pae)for(const Sa of Ub.Errors)hc=this.lZh(Sa),this.NT&&this.NT.nPg(hc)}this.vVb?(0<Xa.count?this.Dob?this.Dob(new ua(ka,Xa)):La.a(512267295,306,15,"Received errors but the promise has completed"):this.Eob?this.Eob(new ua(ka,Xa)):La.a(512267294,306,15,"Received valid tokens but the promise has completed"),La.a(512344162,306,50,
"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ka.count,Xa.count,ia.CorrelationId,this.c3)):(0<Xa.count&&""!==ib?(sb=Object.assign(new Oa.a,{extendedProperties:new Map}),sb.extendedProperties.set("Errors",ib),sb.extendedProperties.set("RetryCount",this.x$.toString()),sb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),sb.extendedProperties.set("IsTokenExpiring",this.mYa.toString()),ya.Health.instance.recordKpiFailure("WACTokenRefresh",
"TokenRefreshFailed",!1,!1,sb)):ya.Health.instance.recordKpiSuccess("WACTokenRefresh",null),La.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ka.count,Xa.count,ia.CorrelationId,this.c3),0<Xa.count&&!this.gDb(Xa)?(ia=this.bH.L9e(Xa),ia!==this.bH.zeb&&(this.Bk.wTd(Ba.S2f,ia),this.de.Goa(this.jj,ia))):(this.Bk.flush(),this.jj&&(La.a(39408131,306,100,"Deleting task {0} from task manager",this.jj.name),this.de.np(this.jj)),this.Uk&&!this.Uk.task.isCompleted?
this.Uk.setResult(new ua(ka,Xa)):La.a(512267293,306,15,"Received results but the task has completed")))}}K7h(ia){if(!ia)return null;const ka=Object.assign(new T,{Name:ia.Name,Errors:[]});for(const Xa of ia.Errors)ia=new ha,ia.Id=Xa.Id,ia.Details=cb.a.v6a(Xa.Details,500),ka.Errors.push(ia);return ka}requestTokensOnce(){this.I1f()}I1f(){c.AFrameworkApplication.hza("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.x$>=this.bH.wyf?(La.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
this.c3),this.oKe(this.Uk,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(ya.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.r6f())}r6f(){const ia={};ia[Pa.a.g7f]=this.bH.tokens;const ka=B.a.create().toString();La.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.bH.tokens),this.x$+1,ka,this.c3);this.Hje.execute(Xa=>{Xa.hi(nb.a.pwe,ia,ka)});this.x$++;this.Bk.incrementCounter(Ba.requests)}oKe(ia,
ka,Xa){const sb=new Ca.a;for(let ib=0;ib<this.bH.tokens.length;ib++){const Ub=Object.assign(new T,{Name:this.bH.tokens[ib],Errors:[Object.assign(new ha,{Id:ka,Details:Xa})]});sb.add(Ub);this.OG.add(Ub)}this.de.np(this.jj);this.Bk.o1(Ba.wcd,JSON.stringify(this.OG));this.Bk.o1(Ba.status,Ba.failed);ia&&!ia.task.isCompleted&&ia.setResult(new ua(new Ca.a,this.OG))}Pkj(ia,ka=null){this.koe.start();this.mYa=ia;this.c3=B.a.create().toString();La.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",
this.c3,this.mYa);this.x$=0;this.OG.clear();this.G_b.clear();const Xa=new Ga.a;this.Uk=Xa;ka&&ka.R(()=>{const sb=!!Xa&&!Xa.task.isCompleted;La.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.c3,this.mYa,sb);sb&&this.oKe(Xa,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.vVb?this.J1f(this.bH.wyf).then(sb=>{this.Uk&&!this.Uk.task.isCompleted&&this.Uk.setResult(sb);this.Dob=this.Eob=null;this.Bk.o1(Ba.wcd,JSON.stringify(this.OG));
this.Bk.o1(Ba.status,Ba.success);this.Bk.flush()}).catch(sb=>{this.Uk&&!this.Uk.task.isCompleted&&this.Uk.setResult(Object(sa.a)(451,sb));this.Dob=this.Eob=null;this.Bk.o1(Ba.wcd,JSON.stringify(this.OG));this.Bk.o1(Ba.status,Ba.failed);this.Bk.flush()}):(this.jj=new qa.a(this.bH.priority,2,this.bH.zeb,Object(e.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,nb.a.pwe,!0),this.CHg&&this.I1f(),this.de.Kf(this.jj));return this.Uk.task}J1f(ia){const ka=this,Xa=new Promise((yb,Gb)=>{ka.Eob=yb;ka.Dob=
Gb;ya.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);ka.r6f()}),sb=this,ib=new Promise((yb,Gb)=>{window.setTimeout(()=>{Gb(sb.uKe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},sb.bH.zeb)});let Ub=ia;const hc=this;return new Promise((yb,Gb)=>{Ub--;Promise.race([Xa,ib]).then(Sa=>{ya.Health.instance.recordKpiSuccess("WACTokenRefresh",null);yb(Sa)}).catch(Sa=>{var db=hc.bH.zeb;if(Object(bb.a)(451,Sa)&&(Sa=Object(sa.a)(451,Sa),0<Sa.errors.count)){hc.UHi(Sa.errors);
hc.sr(Sa.errors);if(hc.gDb(Sa.errors)){Gb(Sa);return}const fb=hc.bH.L9e(Sa.errors);fb!==hc.bH.zeb?(hc.Bk.wTd(Ba.S2f,fb),db=fb):hc.nBi(Sa.errors)&&(db=0)}Ub?window.setTimeout(()=>{hc.J1f(Ub).then(yb).catch(Gb)},db):(db=hc.uKe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),hc.sr(db.errors),Gb(db),La.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",hc.c3))})})}sr(ia){for(let ka of ia)this.OG.add(ka)}nBi(ia){if(!ia.count)return!1;
ia=ia.ma(ia.count-1);return ia.Errors.length?"TIMEOUT"==ia.Errors[0].Id:!1}uKe(ia,ka){const Xa=new Ca.a;for(let sb=0;sb<this.bH.tokens.length;sb++){const ib=this.ohh(this.bH.tokens[sb],ia,ka);Xa.add(ib)}return new ua(new Ca.a,Xa)}ohh(ia,ka,Xa){return Object.assign(new T,{Name:ia,Errors:[Object.assign(new ha,{Id:ka,Details:Xa})]})}UHi(ia){if(ia.count){ia=ia.ma(ia.count-1);ia=JSON.stringify(ia);var ka=Object.assign(new Oa.a,{extendedProperties:new Map});ka.extendedProperties.set("Errors",ia);ka.extendedProperties.set("RetryCount",
this.x$.toString());ka.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());ka.extendedProperties.set("IsTokenExpiring",this.mYa.toString());ya.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ka);this.Bk.o1(Ba.error,ia);this.Bk.o1(Ba.status,Ba.failed)}}Iej(ia){this.koe.stop();const ka=this.pgi(ia.result.errors);f.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!ka,this.c3,this.mYa,this.x$,this.OG.count,0<ia.result.errors.count?ia.result.errors.ma(0).Name:"",0<ia.result.errors.count&&0<ia.result.errors.ma(0).Errors.length?ia.result.errors.ma(0).Errors[0].Id:"",0<ia.result.errors.count&&0<ia.result.errors.ma(0).Errors.length?ia.result.errors.ma(0).Errors[0].Details:"");return ka?!1:this.Hej(ia.result.tokens)}gDb(ia){return this.bH.gDb(ia)}Hej(ia){for(let ka=0;ka<ia.count;ka++){const Xa=ia.ma(ka);if(Xa.Name===Pa.a.accessToken){const sb=(new Date).getTime();
Xa.Expiry>c.AFrameworkApplication.Xj?(f.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Xa.Expiry,["NowGetTime"]:sb,["BootTime"]:c.AFrameworkApplication.yia},"PreviousAccessTokenTtl",c.AFrameworkApplication.Xj),c.AFrameworkApplication.accessToken=Xa.Value,c.AFrameworkApplication.Xj=Math.floor(Xa.Expiry),c.AFrameworkApplication.X4d=sb,c.AFrameworkApplication.c_a=Math.floor(Xa.Expiry)):f.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:Xa.Expiry,["NowGetTime"]:sb,["BootTime"]:c.AFrameworkApplication.yia},"PreviousAccessTokenTtl",c.AFrameworkApplication.Xj)}}return!0}pgi(ia){let ka=!1;for(let Xa=0;Xa<ia.count;Xa++){ka=!0;const sb=ia.ma(Xa);f.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",sb.Name,JSON.stringify(sb.Errors),this.c3)}return ka}lZh(ia){let ka=d.a.Ozc;ia=parseInt(ia.Id);if(isNaN(ia))ka=d.a.rck;else{switch(ia){case 401:ka=d.a.uck;break;case 403:ka=d.a.pck;
break;case 500:ka=d.a.qck;break;case 503:ka=d.a.tck}ka===d.a.Ozc&&(ka=500<ia?d.a.sck:d.a.ock)}return ka}}Object(t.a)(ra,"TokenRefreshManager",null,[452]);class V{constructor(){this.zeb=c.AFrameworkApplication.xck;this.wyf=c.AFrameworkApplication.vck;this.tokens=c.AFrameworkApplication.Gbi();this.priority=c.AFrameworkApplication.Y4d;this.Rke=this.fHj();this.OXc=c.AFrameworkApplication.Fbi()}gDb(ia){ia=JSON.stringify(ia);if(this.OXc&&0<this.OXc.length)for(const ka of this.OXc)if(0<ka.length&&0<=ia.indexOf(ka))return!0;
return!1}L9e(ia){try{if(ia)for(let ka of ia)if(ka.Errors)for(const Xa of ka.Errors)if(Xa.Id in this.Rke)return Number.parseInvariant(this.Rke[Xa.Id].toString())}catch(ka){f.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",ka.toString())}return this.zeb}fHj(){const ia={};try{if(!c.AFrameworkApplication.bgc()||0>=c.AFrameworkApplication.bgc().length||""===c.AFrameworkApplication.bgc()[0])return ia;for(const ka of c.AFrameworkApplication.bgc())0<ka.length&&
(ia[ka]=c.AFrameworkApplication.wck)}catch(ka){f.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",ka.toString())}return ia}}Object(t.a)(V,"TokenRefreshPolicy",null,[448]);class ma extends b.a{constructor(ia){super();this.$=ia;this.Mb()}create(){c.AFrameworkApplication.JR("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.ra("RefreshAccessTokenSilently")?this.vb(this.thh()):this.vb(this.$.da.Aa(38)||
this.$.da.Ha(38,new F(this.$)))}thh(){var ia=this.$.da.Aa(38);if(ia)return ia;ia=new ra(c.AFrameworkApplication.ji,c.AFrameworkApplication.dR(),new V);return this.$.da.Ha(38,new Ha(this.$,ia))}static la(ia){ia.da.Ha(39,new ma(ia))}}Object(t.a)(ma,"AccessTokenExpirationManagerFactory",b.a,[]);var W=a(10);a.d(C,"a",function(){return aa});const aa=()=>{W.a.Fa(ma.la)}},1220:function(t,C,a){t=a(0);var c=a(228),b=a(33),f=a(2),e=a(14),d=a(6),h=a(1367),r=a(185);class l{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(t.a)(l,"TaskPaneGroupAppProps",null,[]);var u=a(29),v=a(1),x=a(40),w=a(221),m=a(19),n=a(7),z=a(272);class y{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(t.a)(y,"ExcelLegacyTaskPaneWacInfraProps",null,
[]);var A=a(304),F=a(259),D=a(20),B=a(13),M=a(18),R=a(138),P=a(12),E=a(21);class H{constructor(db){this.width=db}}Object(t.a)(H,"ActiveTaskPaneData",null,[]);var G=a(60);class N extends x.a{constructor(db,fb){super();this.isVisible=!1;this.m_d=this.Bfa=-1;this.ZNe=40;this.Qh=this.YO=this.animationManager=this.SLc=null;this.oFd=()=>{this.Y1f()};this.gEc=new Set;this.gEc.add("FieldListTaskPane");this.gEc.add("PivotTableSettingsTaskPane");this.gEc.add("SlicerSettingsTaskPane");this.pb=fb;z.a(this.$).ti(this);
this.uA=db;this.eab=this.S1g();b.a.Cj()||d.AFrameworkApplication.sa.Pa.tf||(this.uA.style.bottom=this.$.Nd&4?P.HelperMethods.Ic(this.$.xfa):"0");this.Ibc={};this.EQb={};this.K6d={};this.j_d=R.a.instance.ke(this.rc);this.j_d.la("focusin",this.oFd);this.Rni()}get $(){return this.pb}get Oha(){return this.K6d}get LM(){return this.SLc}get isCollapsed(){return!this.LM}dispose(){z.a(this.$).gA(this);const db=this.Ibc;for(let fb in db)({key:fb,value:db[fb]}).value();this.EQb=this.K6d=this.Ibc=null;this.j_d.iD();
this.eab=this.uA=this.j_d=null;super.dispose()}mwa(db,fb,ab,wb,kb,tb,hb,Fb,va=N.mFi,jb=N.lFi,Ab=null,Qa=null,Z=!1){const wa=Object(f.a)(new y,{getContent:()=>db});wa.isSharedRuntime=Z;return Object(f.a)(new h.a,{hideHeader:!0,contentProps:wa,title:fb,width:ab,location:2,onOpen:kb,onClose:tb,onShow:hb,onHide:Fb,iconUrl:Ab,iconId:Qa,enableResize:wb,minResizeWidth:va,maxResizeWidth:jb})}E7(db,fb){r.UISurfaces.Aj().then(ab=>{db in this.Oha?ab.setSelectedTaskPane(db):ab.showTaskPane(db,fb);return null})}h8b(db,
fb){r.UISurfaces.Aj().then(ab=>{ab.initializeHiddenSharedRuntimeTaskPane(db,fb);const wb=this.$.domElement;wb.addEventListener("scroll",function tb(){0!=wb.scrollLeft&&(wb.scrollLeft=0,wb.removeEventListener("scroll",tb))})})}updateTaskPane(db,fb){r.UISurfaces.Aj().then(ab=>{ab.updateTaskPane(db,fb);return null})}setSelectedTaskPane(db){r.UISurfaces.Aj().then(fb=>{fb.setSelectedTaskPane(db);return null})}hideTaskPane(db){r.UISurfaces.Aj().then(fb=>{fb.hideTaskPane(db,N.xXj);return null})}get rc(){return this.uA}get Qf(){return this.isVisible}get je(){return F.a.eEc}pg(db,
fb){return fb?!1:(this.c6f(),!0)}Gh(db){return B.DOMElementExtensions.Mf(this.rc,db)}Bj(){this.$.frame.We.zk(this.je)}hk(){}S1g(){const db=document.createElement(w.a.div);db.style.height="0px";db.style.width="0px";db.tabIndex=-1;return db}OSh(){var db=B.DOMElementExtensions.getElementById(this.uA,"tabStripFocusZone");if(db){db=db.getElementsByTagName("button");for(let fb=0;fb<db.length;fb++)if(Boolean.parse(db[fb].getAttribute("aria-selected")))return db[fb].getAttribute("aria-controls")}return null}Pbh(db){return(db=
window.getComputedStyle(db,null).getPropertyValue("transition-duration"))?parseInt(db.endsWith("ms")?parseFloat(db):1E3*parseFloat(db),10):0}xlj(){const db=document.getElementById("tabbedTaskPaneContainer");db&&db.addEventListener("transitionend",()=>this.MIa(-1))}Rni(){r.UISurfaces.Aj().then(db=>{let fb=new l;fb.middleContainer=this.eab;fb.onOpen=(ab,wb)=>{this.isVisible=!0;-1===this.Bfa&&(this.Bfa=this.Pbh(wb));b.a.Cj()||(this.Oha[ab]=new H(B.DOMElementExtensions.mQ(B.DOMElementExtensions.getElementById(wb,
N.vhg))))};fb.onClose=ab=>{this.isVisible=0<db.selectors.getTabbedTaskPaneCount();e.ULS.sendTraceTag(537014371,0,50,`Closing of ${ab} TaskPane`);if(!this.isVisible)this.O0e(),b.a.Cj()||d.AFrameworkApplication.sa.Pa.tf||window.requestAnimationFrame(()=>{this.j2b(this.eab)});else if(!b.a.Cj()&&this.LM&&this.LM!==ab){const wb=1<db.selectors.getTabbedTaskPaneCount()?this.Gfc():0,kb=1===db.selectors.getTabbedTaskPaneCount()?-1*this.Gfc():0;this.Rue(ab,this.LM,wb,kb)}b.a.Cj()?this.MIa(this.Bfa):(d.AFrameworkApplication.sa.Pa.tf&&
0>=this.Bfa&&this.MIa(this.Bfa),delete this.Oha[ab]);delete this.EQb[ab]};fb.onShow=(ab,wb)=>{null!=this.ii&&(this.ii.stop(),this.ii=null);this.SLc=ab;this.Y1f();1!==wb&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Axj()},0)});b.a.Cj()?window.requestAnimationFrame(()=>{this.MIa(this.Bfa)}):d.AFrameworkApplication.sa.Pa.tf&&0>=this.Bfa?window.requestAnimationFrame(()=>{this.MIa(this.Bfa)}):window.requestAnimationFrame(()=>{this.Xyj(this.eab,this.Bfa)})};fb.onHide=(ab,wb,kb)=>{const tb=
this.OSh();tb!==ab&&(this.ii=this.$.Rb.Qc("UserAction","TaskPaneToggle"),e.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${ab} to ${tb}`));kb?b.a.Cj()||this.j2b(this.eab):!b.a.Cj()&&tb&&(ab=1===Object.keys(this.Oha).length?this.Gfc():0,this.Rue(this.LM,tb,this.Gfc(),ab));this.SLc=null;kb&&1!==wb&&this.O0e();b.a.Cj()&&window.requestAnimationFrame(()=>{this.MIa(this.Bfa)})};fb.setFocusCallback=(ab,wb)=>{wb&&(this.EQb[ab]=wb)};fb.onResizeStart=()=>{b.a.Cj()||this.Q_c(P.HelperMethods.Ic(0))};fb.onResizeEnd=
()=>{b.a.Cj()?this.MIa():(this.j2b(this.eab),this.Oha[this.LM]=this.Old(this.LM));e.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.LM} TaskPane`)};db.renderTaskPaneGroups(null,this.uA,fb);d.AFrameworkApplication.sa.Pa.tf&&!b.a.Cj()&&this.xlj();return null})}j2b(db){this.Q_c(this.$.isChromeRtl?db.style.left:db.style.right)}Q_c(db){e.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.LM}`);this.$.suj(db)}MIa(db=0){-1<db?G.Task.delay(db+this.ZNe).continueWith(()=>{this.$.YAa(A.a.f_("ResetContentAreaMargin"))}):
this.$.YAa(A.a.f_("ResetContentAreaMargin"))}Rue(db,fb,ab,wb){fb=fb.endsWith(N.k_d)?fb.substring(0,fb.length-N.k_d.length):fb;fb=this.fbf(fb);wb=fb+wb;db=this.fbf(db);wb<db&&this.Q_c(P.HelperMethods.Ic(fb+ab))}Xyj(db,fb){window.setTimeout(()=>{this.j2b(db)},fb+this.ZNe)}Gfc(){return-1!==this.m_d?this.m_d:this.m_d=B.DOMElementExtensions.mQ(B.DOMElementExtensions.getElementById(this.uA,"tabStripFocusZone"))}Old(db){return B.DOMElementExtensions.mQ(B.DOMElementExtensions.getElementById(B.DOMElementExtensions.getElementById(this.uA,
db+N.k_d),N.vhg))}fbf(db){if(db in this.Oha){const fb=this.Oha[db].width;return 0<fb?fb:this.Old(db)}return db?this.Old(db):0}O0e(){E.h(this.$).setFocus()}Axj(){if(this.EQb[this.LM]){const db=this.EQb[this.LM];db&&db(null,null)}else this.gEc.has(this.LM)||this.c6f()}c6f(){r.UISurfaces.Aj().then(db=>{1<db.selectors.getTabbedTaskPaneCount()?db.focusTabbedTaskPaneArea():(db=B.DOMElementExtensions.getElementById(this.rc,"AgaveTaskpaneCloseButtonId"))?db.focus():(db=B.DOMElementExtensions.Pl(this.rc.querySelectorAll("button")))&&
db.focus();return null})}Y1f(){this.$.domElement.scrollLeft=0;u.a.FOa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}PE(db){this.addHandler(N.xib,db)}iG(db){this.removeHandler(N.xib,db)}get WO(){return this.uA}get iE(){e.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}bub(db,fb,ab,wb,kb){let tb=db.Aa(fb);tb||(tb=M.a(D.a,ab,db,fb),tb.SetScriptLoadFlavor(kb));
wb&&tb.MZc(wb);const hb=""+fb;let Fb=null;const va=()=>{tb.create();Fb()};this.Ibc[hb]=Fb=()=>{tb.Lwc(va);delete this.Ibc[hb]};tb.z1b(va)}initialize(){e.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}Gcg(){}nR(){e.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}VI(){e.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}wse(){e.ULS.shipAssertTag(537151108,
11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}w1f(){e.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}B6a(){e.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}Dhd(){e.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}$ja(){e.ULS.shipAssertTag(537151104,
11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}eC(){e.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){e.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}MTd(){e.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static la(db){const fb=
N.Q2g(db.Ib,db.isChromeRtl);N.wYg(db,fb);return new N(fb,db)}static Q2g(db,fb){const ab=document.createElement("div");ab.id=db+n.a.fEc;b.a.Cj()?ab.classList.add(m.a.Fbk):(ab.classList.add(fb?m.a.Hbk:m.a.Gbk),d.AFrameworkApplication.sa.Pa.tf&&ab.classList.add(m.a.iBa));return ab}static wYg(db,fb){db.isMobileMode&&fb.setAttribute("aria-hidden","true");if(d.AFrameworkApplication.sa.Pa.tf){let ab;(ab=document.getElementById("FarPaneRegion"))?ab.appendChild(fb):e.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else v.EwaSettings.isChangeGateEnabled("OfficeVSO:7643983_GridLayoutRemoval")||
b.a.Cj()&&fb.classList.add(m.a.fzh),document.getElementById(db.Ib+n.a.$1a).insertBefore(fb,db.CCa)}}N.mFi=300;N.lFi=950;N.xXj=2;N.k_d="-panel";N.vhg="ExcelTaskPaneContentWrapper";N.Ydg="rtpSizeChanged";N.NGe="rtpCollapsed";N.cPf="rtpAdded";N.xib="rtpVisibility";Object(t.a)(N,"ReactTaskPaneManager",x.a,[337,36,2]);var I=a(102),O=a(169),U=a(16),ca=a(246),Q=a(114),Y=a(92),la=a(425),ea=a(229),ha=a(88),X=a(89),T=a(101),ua=a(759),Ha=a(567),Ca=a(54),Ga=a(15);class sa extends Sys.EventArgs{constructor(){super()}}
Object(t.a)(sa,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var bb=a(50),Ba=a(91),qa=a(245);const pa=ua.a.bCh,ya=ua.a.dCh,za=`<span class='${m.a.Xsb} ${ua.a.eCh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;class cb extends qa.a{constructor(db){super(document.createElement("a"));this.Qa=new x.a;this.Sb=this.Sne=null;this.od=()=>{this.enabled&&this.Qa.raiseEvent("tpButtonClicked",null,this);return!0};this.Sb=db}YPg(db){this.Qa.addHandler("tpButtonClicked",db)}FZf(db){this.Qa.removeHandler("tpButtonClicked",
db)}get n1a(){return this.domElement}get taskPane(){return this.Sne}get enabled(){return super.enabled}set enabled(db){db!==super.enabled&&(this.domElement.classList.toggle(ua.a.JU),this.domElement.classList.toggle(ya),this.domElement.tabIndex=db?0:-1,super.enabled=db)}get xp(){return this.domElement.firstChild.firstChild}dispose(){Y.a.wc([this.Qa]);this.Qa=null;this.domElement&&bb.a.uoa(this.domElement);super.dispose()}Qni(db){const fb=6===db.Uh;var ab=fb&&!db.tk;ab=String.format(za,db.jR,db.tk,
ab?Ca.a.current.io(102):Ca.a.mf(10),ua.a.sja,ab?String.format('style="width:24px;{0}:0px"',"left"):"");this.Sb.uh(this.domElement,ab);this.domElement.classList.add(pa);this.domElement.classList.add(ya);this.domElement.title=db.jR;this.domElement.tabIndex=0;B.DOMElementExtensions.Yu(this.domElement,n.a.rt,null,null);this.Sne=db;fb&&(db=this.taskPane,null===db||void 0===db?void 0:db.Ymg());ea.a.instance.ta(U.a.click,this.domElement,this.od);Q.KeyInputManager.instance.$t(this.domElement,this.od,Ba.a.Wh)}}
Object(t.a)(cb,"TaskPaneButton",qa.a,[393]);class Pa extends T.a{constructor(db,fb,ab,wb){super(db);this.animationManager=this.H6=this.Xe=null;this.aM=this.OWa=!1;this.T9d=0;this.pb=null;this.RPc=!1;this.Sb=null;this.Yz=()=>{this.nvi||(this.eC(),this.$.zf())};this.yEd=(kb,tb)=>{this.onButtonClick(kb,tb)};this.h7=()=>{this.$Fc()};this.$=fb;this.Sb=wb;z.a(this.$).ti(this);this.$.Hb.kg(this.h7);this.configuration=ab;this.baseName=P.HelperMethods.Qwa(this.domElement,this.configuration.yhg||this.configuration.C1);
this.Hbc={};this.Ngb=[];this.su=[];this.$rb={};this.Tne=document.getElementById(this.baseName+this.configuration.i_d);this.WO||e.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.i_d} not found`);this.fJg=document.getElementById(this.baseName+this.configuration.C1);this.uA||e.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.C1} not found`);this.gJg=document.getElementById(this.baseName+
this.configuration.n0d);this.YO||e.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.n0d} not found`);db=String.format(Pa.yXj,this.baseName+this.configuration.mjg,this.baseName+Pa.DQb);this.Sb.uh(this.YO,db);this.g8d=document.getElementById(this.baseName+Pa.DQb);this.uBe||e.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Pa.DQb} not found`);(this.Zrb=document.getElementById(this.baseName+Pa.DQb))||
e.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Pa.DQb} not found`);this.tyg=this.MKe(this.configuration.LGe,this.IGe);this.syg=this.cKe(this.configuration.JGe,Ga.a.instance.ha(1297),this.Qbi,this.g2a,!0);this.vAg=this.MKe(this.configuration.TYe,this.aJh);this.uAg=this.cKe(this.configuration.RYe,Ga.a.instance.ha(1296),this.Rbi,this.gLa,!1);B.DOMElementExtensions.setVisible(this.gLa,!1);ea.a.instance.ta(U.a.click,this.f2a,Object(ha.a)(this,this.Wqc,"onCollapseIconClicked"));
ea.a.instance.ta(U.a.click,this.fLa,Object(ha.a)(this,this.prc,"onExpandIconClicked"));ea.a.instance.ta(U.a.click,this.g2a,Object(ha.a)(this,this.Wqc,"onCollapseIconClicked"));ea.a.instance.ta(U.a.click,this.gLa,Object(ha.a)(this,this.prc,"onExpandIconClicked"));Q.KeyInputManager.instance.ta(U.a.fc,this.f2a,Object(ha.a)(this,this.pEf,"onCollapseIconKeyDown"));Q.KeyInputManager.instance.ta(U.a.fc,this.fLa,Object(ha.a)(this,this.WFf,"onExpandIconKeyDown"))}PE(db){this.addHandler(Pa.xib,db);db(this,
new sa(this.isVisible,B.DOMElementExtensions.isVisible(this.YO)))}iG(db){this.removeHandler(Pa.xib,db)}get YO(){return this.gJg}get rc(){return this.YO}get Qf(){return this.OWa}set Qf(db){this.OWa=db}get uA(){return this.fJg}get je(){return F.a.WRi}get WO(){return this.Tne}get iE(){return this.su}get Qh(){return this.Xe}get LM(){return null}get Oha(){return null}get isCollapsed(){return this.aM}get B9c(){return this.T9d}get $(){return this.pb}set $(db){this.pb=db}get uBe(){return this.g8d}get f2a(){return this.syg}get fLa(){return this.uAg}get g2a(){return this.tyg}get gLa(){return this.vAg}get nvi(){return this.RPc}get Rbi(){return this.configuration.KGe}get Qbi(){return this.configuration.SYe}bub(db,
fb,ab,wb,kb){let tb=db.Aa(fb);tb||(tb=M.a(D.a,ab,db,fb),tb.SetScriptLoadFlavor(kb));wb&&tb.MZc(wb);const hb=""+fb;hb in this.Hbc||tb.V1b((jb,Ab)=>{this.u7(Ab)});let Fb=null;const va=()=>{tb.create();Fb()};this.Hbc[hb]=Fb=()=>{tb.Lwc(va);delete this.Hbc[hb]};tb.z1b(va)}dispose(){if(this.su)for(let fb=0,ab=this.su.length;fb<ab;fb++)this.su[fb].FZf(this.yEd),this.su[fb].dispose();const db=this.Hbc;for(let fb in db)({key:fb,value:db[fb]}).value();this.$.ea&&this.$.Hb&&this.$.Hb.Gg(this.h7);this.Zrb=this.g8d=
this.Tne=this.Xe=this.$rb=this.Ngb=this.su=null;ea.a.instance.Ba(U.a.click,this.f2a,Object(ha.a)(this,this.Wqc,"onCollapseIconClicked"));ea.a.instance.Ba(U.a.click,this.fLa,Object(ha.a)(this,this.prc,"onExpandIconClicked"));ea.a.instance.Ba(U.a.click,this.g2a,Object(ha.a)(this,this.Wqc,"onCollapseIconClicked"));ea.a.instance.Ba(U.a.click,this.gLa,Object(ha.a)(this,this.prc,"onExpandIconClicked"));Q.KeyInputManager.instance.Ba(U.a.fc,this.f2a,Object(ha.a)(this,this.pEf,"onCollapseIconKeyDown"));Q.KeyInputManager.instance.Ba(U.a.fc,
this.fLa,Object(ha.a)(this,this.WFf,"onExpandIconKeyDown"));super.dispose()}pg(db,fb){if(fb)return!1;this.Xe&&!this.isCollapsed?(db=this.Qh.taskPane,db.Qf&&db.pg(!0,!1)||B.DOMElementExtensions.setFocus(this.Qh.n1a)):B.DOMElementExtensions.setFocus(this.fLa);return!0}Gh(db){return this.isVisible?B.DOMElementExtensions.Mf(this.domElement,db)||B.DOMElementExtensions.Mf(this.domElement,B.DOMElementExtensions.Cyb(db)):!1}Bj(){}hk(){this.Xe&&this.Xe.taskPane.hk()}setFocusOnToolbarFirstElement(){this.isCollapsed?
B.DOMElementExtensions.setFocus(this.fLa):B.DOMElementExtensions.setFocus(this.f2a)}MTd(){for(let db=this.su.length-1;0<=db;db--)if(this.su[db].isVisible){B.DOMElementExtensions.setFocus(this.su[db].n1a);return}this.setFocusOnToolbarFirstElement()}B6a(db){const fb=[];for(let ab=this.su.length-1;0<=ab;ab--)this.su[ab].taskPane.Uh===db&&fb.push(this.su[ab].taskPane);return fb}Dhd(db){const fb=[];for(let ab=0;ab<this.su.length;ab++)this.su[ab].taskPane.Uh===db&&fb.push(this.su[ab]);return fb}wse(db){if(db){let fb;
const ab=Object(X.a)(320,db);ab?(fb=new cb(this.Sb),fb.domElement.id=this.baseName+"bt_"+db.Uh.toString()+"_"+db.sf.InstanceId,this.Zrb.appendChild(fb.domElement),this.$rb["6"]=fb,ab.button=fb):fb=this.$rb[db.Uh.toString()];fb.Qni(db);fb.YPg(this.yEd);fb.isVisible=db.Zq();fb.enabled=db.Tt();this.Ngb.push(db);this.su.push(fb);Pa.fPi(db,this.WO);this.gxh(fb);this.$Fc()}}VI(db,fb){let ab;for(const wb of this.su)ab=wb.taskPane,ab.Uh===db.Uh&&ab==db&&this.z5b(wb,fb)}mwa(){e.ULS.shipAssertTag(512291714,
11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}E7(){e.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}h8b(){e.ULS.shipAssertTag(512291712,11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){e.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){e.ULS.shipAssertTag(512291682,
11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){e.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}Gcg(db,fb){db?(this.RPc=!0,this.CUd(!1)):(this.RPc=!1,this.CUd(!0),fb&&(this.eC(),this.$.zf()))}nR(db){if(!this.Ngb.includes(db)){let ab=null;ab=()=>{this.Aoj(db);db.fX(ab)};db.eU(ab);this.wse(db);var fb=Object(X.a)(382,db);fb&&(fb.PE(this.Yz),this.Yz(fb,Sys.EventArgs.Empty));if(fb=Object(X.a)(155,
db))fb.PE(this.Yz),this.Yz(fb,Sys.EventArgs.Empty);if(fb=Object(X.a)(383,db))fb.PE(this.Yz),this.Yz(fb,Sys.EventArgs.Empty);this.raiseEvent(Pa.cPf,null,db);this.eC()}}z5b(db,fb){if(db.taskPane.Tt()&&db.taskPane.Zq()){if(this.Xe){this.Xe.domElement.classList.remove(Pa.dpb);this.Xe.taskPane.isVisible=!1;if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const ab=Object(X.a)(320,this.Xe.taskPane);ab&&ab.Jj.NNd(ab.sf.InstanceId)}this.H6=this.Xe}this.Xe=db;this.Xe.taskPane.isVisible=
!0;this.Xe.domElement.classList.add(Pa.dpb);fb&&this.$ja(!1,!1);this.fib()}}onButtonClick(db){let fb=!1;if(this.Xe!==db){fb=!0;const ab=db.taskPane.rc;this.animationManager.adj(ab);if(this.Xe){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const wb=Object(X.a)(320,this.Xe.taskPane);wb&&wb.Jj.NNd(wb.sf.InstanceId)}this.Xe.taskPane.isVisible=!1;this.Xe.domElement.classList.remove(Pa.dpb)}this.H6=this.Xe;this.Xe=db;this.Xe.domElement.classList.add(Pa.dpb);this.Xe.taskPane.isVisible=
!0;this.fib();this.animationManager.UIh(ab)}this.$ja(!(this.isCollapsed||fb),!1)}fib(){const db=this.B9c;let fb=0;this.Xe&&(fb=this.Xe.taskPane.gw?this.Xe.taskPane.gw:this.Xe.taskPane.oq);fb!==db&&(this.T9d=fb,this.isCollapsed||(this.animationManager&&this.Xe?this.animationManager.E2b(this.uA,db,fb,this.Qh.taskPane):this.uA.style.width=P.HelperMethods.Ic(fb)),this.ySa(),this.raiseEvent(Pa.Ydg,null,this))}JM(db){const fb=new cb(this.Sb);fb.isVisible=!1;fb.domElement.id=this.baseName+"bt_"+db.toString();
this.Zrb.appendChild(fb.domElement);this.$rb[db.toString()]=fb}$Fc(){if(void 0!==this.su&&null!==this.su){void 0===this.Xe||null===this.Xe||this.Xe.taskPane.Tt()||(this.Xe.domElement.classList.remove(Pa.dpb),this.Xe.taskPane.isVisible=!1,this.Xe.taskPane.Zq()&&(this.H6=this.Xe),this.Xe=null);var db=null;for(let fb=0;fb<this.su.length;fb++)if(this.Ngb[fb].Zq()){const ab=this.Ngb[fb].Tt();(this.su[fb].enabled=ab)&&!db&&(db=this.su[fb])}void 0!==this.Xe&&null!==this.Xe||!db||(void 0!==this.H6&&null!==
this.H6&&this.H6.taskPane.Tt()&&this.H6.taskPane.Zq()?this.z5b(this.H6,!1):this.z5b(db,!1));void 0!==Ha.a(this.$)&&null!==Ha.a(this.$)&&Ha.a(this.$).isVisible&&void 0!==this.Xe&&null!==this.Xe&&1!==this.Xe.taskPane.Uh&&(Ha.a(this.$).isVisible=!1);void 0!==this.Xe&&null!==this.Xe&&7!==this.Xe.taskPane.Uh&&(db=this.$.da.Aa(52),null===db||void 0===db?0:db.isVisible)&&(db.isVisible=!1);void 0!==this.Xe&&null!==this.Xe&&8!==this.Xe.taskPane.Uh&&(db=this.$.da.Aa(233))&&(db.isVisible=!1);void 0!==this.Xe&&
null!==this.Xe&&9!==this.Xe.taskPane.Uh&&(db=this.$.da.Aa(248))&&(db.isVisible=!1);v.EwaSettings.ya(264)&&void 0!==this.Xe&&null!==this.Xe&&12!==this.Xe.taskPane.Uh&&(db=this.$.da.Aa(302))&&(db.isVisible=!1);v.EwaSettings.ya(418)&&void 0!==this.Xe&&null!==this.Xe&&15!==this.Xe.taskPane.Uh&&(db=this.$.da.Aa(365))&&(db.isVisible=!1);b.a.qwd(this.$)&&void 0!==this.Xe&&null!==this.Xe&&13!==this.Xe.taskPane.Uh&&(db=this.$.da.Aa(334))&&(db.isVisible=!1);void 0!==this.Xe&&null!==this.Xe&&14!==this.Xe.taskPane.Uh&&
(db=this.$.da.Aa(346))&&(db.isVisible=!1);void 0!==this.Xe&&null!==this.Xe&&16!==this.Xe.taskPane.Uh&&(db=this.$.da.Aa(371))&&(db.isVisible=!1);void 0!==this.Xe&&null!==this.Xe&&17!==this.Xe.taskPane.Uh&&(db=this.$.da.Aa(408))&&(db.isVisible=!1);this.fib()}}BLh(db,fb){B.DOMElementExtensions.setVisible(this.g2a,!db);B.DOMElementExtensions.setVisible(this.gLa,db);db&&this.raiseEvent(Pa.NGe,null,this);this.fib();fb&&B.DOMElementExtensions.setFocus(db?this.fLa:this.f2a)}Agc(db,fb){this.$.Xc(db,fb,26,
null)}u7(db){db.GO&&this.nR(db.GO)}Aoj(db){if(db){const fb=this.su.length;let ab=!1;for(let wb=0;wb<fb;wb++){const kb=this.su[wb];if(kb.taskPane===db){this.Zrb.removeChild(kb.n1a);delete this.$rb[db.Uh.toString()];Array.remove(this.Ngb,db);Array.remove(this.su,kb);kb.FZf(this.yEd);kb.taskPane.rc.parentNode.removeChild(kb.taskPane.rc);this.Xe&&this.Xe.taskPane===kb.taskPane&&(this.Xe=null);this.H6&&this.H6.taskPane===kb.taskPane&&(this.H6=null);ab=!0;break}}ab&&this.$Fc()}}gxh(db){const fb=db.taskPane.Uh,
ab=!!this.Xe&&1===this.Xe.taskPane.Uh;(1===fb||!ab&&2===fb)&&this.z5b(db,!1)}static fPi(db,fb){const ab=db.rc;ab.parentNode&&ab.parentNode.removeChild(ab);fb.appendChild(ab);db.isVisible=!1}cKe(db,fb,ab,wb,kb){const tb=document.createElement("a");tb.setAttribute(n.a.lU,kb?n.a.Dk:n.a.vr);tb.setAttribute(n.a.Kd,n.a.rt);tb.tabIndex=0;tb.classList.add(m.a.sz);tb.classList.add(db);tb.classList.add(ua.a.aCh);db=String.format(Pa.C8g,fb,ab,Ca.a.mf(10));this.Sb.uh(tb,db);wb.appendChild(tb);return tb}}Pa.xib=
"tpVisibility";Pa.yXj=`<div id='{0}' class='${ua.a.gCh}'><div id='{1}' class='${ua.a.fCh}'></div></div>`;Pa.C8g="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Pa.DQb="novTaskpaneButtonGroup";Pa.dpb=ua.a.cCh;Pa.Ydg="tpSizeChanged";Pa.NGe="tpCollapsed";Pa.cPf="tpAdded";Object(t.a)(Pa,"TaskPaneControl",T.a,[337,36,2]);var nb=a(52),Ma=a(457),Oa=a(733);class La{constructor(){this.SYe=this.KGe=this.RYe=this.JGe=this.TYe=this.LGe=this.mjg=this.n0d=this.i_d=this.C1=this.yhg=null}}Object(t.a)(La,"Configuration",
null,[]);a(439);T=a(307);class ra extends T.a{constructor(db){super(5,db)}}Object(t.a)(ra,"ResizeAnimationEvent",T.a,[]);var V=a(480),ma=a(600),W=a(107);class aa{constructor(db,fb){this.zhg=null;this.$=fb;this.taskPane=db}MIh(){this.zhg=B.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Ib+n.a.EDd);const db=aa.b9c(this.taskPane),fb=aa.b9c(this.zhg),ab=ma.a(W.a.Hm);ab.animate(db,n.a.$Ac);ab.animate(fb,n.a.$Ac)}adj(db){db.style.opacity="0"}UIh(db){ma.a(W.a.Hm).animate(aa.b9c(db),
n.a.$Ac)}E2b(db,fb,ab,wb){fb||(wb.isVisible=!0);this.$.ySa(ab);ma.a(W.a.Hm).animate(aa.Hkh(db,fb,ab),n.a.$Ac,null,null,()=>{this.$.BBa();ab||1===wb.Uh||(wb.isVisible=!1);wb.BW(ab<fb)})}static Hkh(db,fb,ab){db=new ra(db);db.qVg(fb,ab);return db}static b9c(db){db=new V.a(db);db.sM(0,1);return db}}Object(t.a)(aa,"TaskPaneAnimationManager",null,[360]);const ia=`<div id="{0}" class="${ua.a.kCh}" runat="server"></div></div><div id="{1}" class="${ua.a.jCh} ${ua.a.ms}" runat="server"></div>`,ka=`<button type="button" id="{0}" class="${ua.a.hCh}"></button><span><div id="{1}" class="${ua.a.iCh}"></div></span>`,
Xa=ua.a.VBh;class sb extends Pa{constructor(db,fb,ab,wb){super(db,ab,sb.Agh(),wb);this.Atc=null;this.Kvd=!1;this.JS=null;this.n2i=kb=>{var tb=!1;if(9===kb.Da.keyCode){tb=this.Qh.taskPane.LV(kb,this.YO);if(!tb){tb=this.$.da.Aa(52);var hb=this.domElement.querySelectorAll(this.Qh.taskPane===tb?tb.Uq:Ma.a.b9i);tb=B.DOMElementExtensions.Pl(hb);hb=B.DOMElementExtensions.mB(hb);tb=B.DOMElementExtensions.eCa(kb.Da,tb,hb)}return tb}hb=I.FocusManager.instance().li;if(null===hb||void 0===hb?0:hb.EN)return tb;
27===kb.Da.keyCode&&this.Qh.taskPane.$g(!1);return tb};this.yd=()=>{this.YO.style.bottom=this.uA.style.bottom=this.$.Nd&4&&!d.AFrameworkApplication.sa.Pa.tf?P.HelperMethods.Ic(this.$.xfa):"0";this.eC()};this.JKf=kb=>{Object(la.a)(320,this.Qh.taskPane)&&(this.Qh.taskPane.WHa.firstChild.style[n.a.pointerEvents]="none");this.Kvd=!0;this.JS=this.Pyb(kb.clientPoint);O.a.instance.ta(U.a.wg,this.domElement.ownerDocument.body,this.ysc);O.a.instance.ta(U.a.Fe,this.domElement.ownerDocument.body,this.zsc);ca.a.instance.ta(U.a.vk,
this.domElement.ownerDocument.body,this.ysc);ca.a.instance.ta(U.a.og,this.domElement.ownerDocument.body,this.zsc);return!0};this.zsc=()=>{Object(la.a)(320,this.Qh.taskPane)&&(this.Qh.taskPane.WHa.firstChild.style[n.a.pointerEvents]="");this.Kvd=!1;O.a.instance.Ba(U.a.wg,this.domElement.ownerDocument.body,this.ysc);O.a.instance.Ba(U.a.Fe,this.domElement.ownerDocument.body,this.zsc);ca.a.instance.Ba(U.a.vk,this.domElement.ownerDocument.body,this.ysc);ca.a.instance.Ba(U.a.og,this.domElement.ownerDocument.body,
this.zsc);return!0};this.ysc=kb=>{this.Kvd&&(kb=this.Pyb(kb.clientPoint),kb=Oa.a.hE(kb,this.JS),this.Rve(kb.x));return!0};this.t3i=kb=>{void 0!==kb.Da&&null!==kb.Da&&(9===kb.Da.keyCode?kb.Da.shiftKey?(kb=Object(la.a)(36,this.Qh.taskPane)?this.Qh.taskPane:null)&&kb.pg(!1,!1):this.setFocusOnToolbarFirstElement():37!==kb.Da.keyCode&&39!==kb.Da.keyCode||this.Rve(37===kb.Da.keyCode?-20:20));return!0};this.$.domElement.classList.add(Xa);this.whg=fb;this.initialize();Q.KeyInputManager.instance.ta(U.a.fc,
this.domElement,this.n2i);this.FQb=B.DOMElementExtensions.getElementById(fb.parentNode,this.$.Ib+n.a.nqc);this.iEc=B.DOMElementExtensions.getElementById(fb.parentNode,this.$.Ib+n.a.wBf);this.FQb.title=Ga.a.instance.ha(2233);O.a.instance.ta(U.a.Cf,this.iEc,this.JKf);ca.a.instance.ta(U.a.pointerDown,this.iEc,this.JKf);Q.KeyInputManager.instance.ta(U.a.fc,this.FQb,this.t3i)}get je(){return F.a.eEc}get IGe(){return this.YO}get aJh(){return this.IGe}fib(){super.fib();this.FQb&&(this.Qh&&this.Qh.taskPane.isResizable?
(this.FQb.style.display="block",this.iEc.style.display="block"):(this.FQb.style.display="none",this.iEc.style.display="none"))}get UEc(){const db=this.YO;return db&&B.DOMElementExtensions.isVisible(db)?Ma.a.UEc:0}w1f(db){db&&(this.animationManager=db);this.Mtj();this.animationManager=db||new aa(this.uA,this.$);this.animationManager.MIh()}dispose(){this.Atc&&this.Atc.iG(this.Yz);Ha.a(this.$)&&Ha.a(this.$).iG(this.Yz);const db=this.$.da.Aa(52);db&&db.iG(this.Yz);this.$.lm(this.yd);Y.a.wc([this.Atc]);
this.Atc=null;super.dispose()}initialize(){this.w1f(null);this.JM(0);this.JM(1);this.JM(2);this.JM(7);this.JM(8);this.JM(9);this.JM(10);this.JM(17);v.EwaSettings.ya(264)&&this.JM(12);v.EwaSettings.ya(418)&&this.JM(15);v.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.JM(13):b.a.qwd(this.$)&&this.JM(13);this.JM(14);this.JM(16);v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&this.JM(18);this.eC()}eC(){var db=
0;let fb=0;for(let ab=this.iE.length-1;0<=ab;ab--){const wb=this.iE[ab].taskPane.Zq(),kb=this.iE[ab].taskPane;if(this.iE[ab].isVisible=wb)fb++,(1!==kb.Uh&&(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==kb.Uh)&&14!==kb.Uh&&16!==kb.Uh||kb.Tt())&&db++}db=0<db;B.DOMElementExtensions.setVisible(this.YO,db);this.CUd(db);B.DOMElementExtensions.setVisible(this.gLa,db&&this.isCollapsed);B.DOMElementExtensions.setVisible(this.g2a,db&&!this.isCollapsed);B.DOMElementExtensions.setVisible(this.uBe,
1<fb);this.$Fc()}$ja(db,fb){if(this.isCollapsed!==db){db||(this.whg.style.display=d.AFrameworkApplication.sa.Pa.tf?"flex":"block");var ab=this.B9c;this.aM=!this.isCollapsed;var wb=db?ab:0;ab=db?0:ab;this.Qh&&(this.animationManager.E2b(this.uA,wb,ab,this.Qh.taskPane),this.ySa());db&&(this.whg.style.display="none");this.BLh(db,fb)}}CUd(db){const fb=this.isVisible!==db;this.Qf=db;B.DOMElementExtensions.setVisible(this.domElement,db);fb&&(d.AFrameworkApplication.sa.Pa.tf&&B.DOMElementExtensions.toggleCssClass(this.domElement,
ua.a.JBh,db),this.ySa(),this.raiseEvent(Pa.xib,new sa(db,db),this))}Wqc(db){if(db.Vb===this.g2a&&3!==db.Cb)return!1;this.Agc(296943390,db.Cb);this.$ja(!0,!0);return!0}prc(db){if(db.Vb===this.gLa&&3!==db.Cb)return!1;this.Agc(-625072140,db.Cb);this.$ja(!1,!0);return!0}pEf(db){return 13===db.Da.keyCode?(this.Agc(296943390,db.Cb),this.$ja(!0,!0),!0):!1}WFf(db){return 13===db.Da.keyCode?(this.Agc(-625072140,db.Cb),this.$ja(!1,!0),!0):!1}ySa(){let db=0;this.$.Nd&262144&&(db+=this.UEc,B.DOMElementExtensions.isVisible(this.uA)&&
!this.isCollapsed&&(db+=this.B9c));this.$.ySa(db)}MKe(db,fb){const ab=document.createElement("div");ab.classList.add(db);fb.insertBefore(ab,fb.firstChild);return ab}Mtj(){const db=this.domElement;let fb=document.getElementById(this.$.Ib+n.a.$1a);d.AFrameworkApplication.sa.Pa.tf&&(fb=document.getElementById("FarPaneRegion"));db.parentNode&&db.parentNode!==fb&&db.parentNode.removeChild(db);fb.appendChild(db);this.Lfi()}Lfi(){const db=this.uA,fb=this.YO,ab=this.$.ea;db.style.right="0";d.AFrameworkApplication.sa.Pa.tf||
(db.style.marginRight=P.HelperMethods.Ic(Ma.a.UEc));db.style.bottom=this.$.Nd&4&&!d.AFrameworkApplication.sa.Pa.tf?P.HelperMethods.Ic(this.$.xfa):"0";this.WO.style.bottom="0";fb.style.right="0";this.$.rl(this.yd);ab.hI&&this.yd(null,null)}Pyb(db){const fb=new nb.a(0,0);return Oa.a.fv(fb,this.uA,db,!1)}Rve(db){const fb=this.uA.offsetWidth;db=fb-db;db<this.Qh.taskPane.oq?db=this.Qh.taskPane.oq:950<db&&(db=950);this.Qh.taskPane.gw=db;const ab=new aa(this.uA,this.$);ab.E2b(this.uA,fb,db,this.Qh.taskPane);
Object(la.a)(320,this.Qh.taskPane)||ab.E2b(this.Qh.taskPane.rc,fb,db,this.Qh.taskPane);this.$.ySa(this.YO.offsetWidth+db);this.$.YAa(A.a.f_("AnimateTaskpaneResize"))}static la(db,fb){let ab=null;db.Rb&&(ab=db.Rb.Dg("ComponentAttach","AttachTaskPanePickerControl"),ab.start());const wb=sb.S2g(db.Ib),kb=sb.R2g(db.Ib,fb),tb=sb.T2g(db.Ib);wb.appendChild(tb);wb.appendChild(kb);sb.xYg(db,wb);db=new sb(wb,kb,db,fb);ab&&ab.stop();return db}static S2g(db){const fb=document.createElement("div");fb.id=db+n.a.fEc;
return fb}static R2g(db,fb){const ab=document.createElement("div");ab.id=db+n.a.vBf;ab.className=ua.a.WBh;let wb=String.format(ia,db+n.a.URi,db+n.a.vW);wb+=String.format(ka,db+n.a.nqc,db+n.a.wBf);fb.uh(ab,wb);d.AFrameworkApplication.sa.Pa.tf&&B.DOMElementExtensions.toggleCssClass(ab,ua.a.iBa,!0);return ab}static T2g(db){const fb=document.createElement("div");fb.id=db+n.a.EDd;fb.className=ua.a.UDh;fb.style.zIndex="100";d.AFrameworkApplication.sa.Pa.tf&&B.DOMElementExtensions.toggleCssClass(fb,ua.a.iBa,
!0);return fb}static xYg(db,fb){(d.AFrameworkApplication.sa.Pa.tf?document.getElementById("FarPaneRegion"):document.getElementById(db.Ib+n.a.$1a)).appendChild(fb)}static Agh(){const db=new La;db.yhg=n.a.fEc;db.C1=n.a.vBf;db.i_d=n.a.vW;db.n0d=n.a.EDd;db.mjg=n.a.VRi;db.LGe=ua.a.YBh;db.TYe=ua.a.$Bh;db.JGe=ua.a.XBh;db.RYe=ua.a.ZBh;db.KGe=ua.a.xXe;db.SYe=ua.a.yXe;return db}}Object(t.a)(sb,"TaskPanePickerControl",Pa,[]);var ib=a(39),Ub=a(721),hc=a(109),yb=a(157),Gb=a(41);a.d(C,"a",function(){return Sa});
class Sa extends c.a{constructor(db){super();this.$=db;this.Mb()}create(){if(b.a.Md())this.CXf(()=>N.la(this.$));else{const db=Object(hc.d)(yb.a.resolve(Gb.F,{rb:this.Na}));ib.TaskExtensions.za(db,()=>{this.CXf(()=>sb.la(this.$,db.result))},this.ka,3)}}static la(db){db.da.Ha(50,new Sa(db))}CXf(db){v.EwaSettings.isChangeGateEnabled("OfficeVSO:7377510_InitializingTPSlicePI")?(db=Object(Ub.a)(this.$.da,183,db),this.vb(db)):this.vb(db())}}Object(t.a)(Sa,"TaskPaneManagerFactory",c.a,[])},1224:function(t,
C,a){function c(Ha){const Ca=new h.StandardDialog;Ca.Xb=4;Ha=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,Ha)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;Ca.FS(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,Ha,I)}t=a(0);var b=a(14),f=a(228),e=a(1354),d=a(6),h=a(143),r=a(88),l=a(894);class u{}u.GYj=864E5;u.yTg=3;u.kTi=144E5;Object(t.a)(u,"AddinConstantsNum",null,[]);var v=
a(740),x=a(897),w=a(848);class m{constructor(Ha,Ca,Ga,sa=null){this.fa=sa?sa:d.AFrameworkApplication.fa;this.aPc=2;this.C7a=Ha;this.mKg=Ca;this.Rb=Ga}get Ixa(){return this.aPc}get R9j(){return this.mKg}KQd(Ha){if(this.fa.ra("AgaveSupportsLiveIdSpoofing")){var Ca=(new Date).getTime();this.C7a(Ha,this.Ixa,{["ak0"]:Ca})}else if(w.a.KMj(Ha)){Ca=String.format(d.AFrameworkApplication.sa.Pa.n0+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",d.AFrameworkApplication.sa.Pa.$i,this.R9j,
d.AFrameworkApplication.Di);const Ga=d.AFrameworkApplication.Od;let sa=null;this.Rb&&(sa=this.Rb.Qc("ComponentAttach",x.a[Ha]+l.a[this.Ixa]));Ga.Zm(Ca,1,null,null,!0,4,bb=>{this.U6i(Ha,bb.data.te);sa&&sa.stop()},bb=>{b.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",bb.data.httpStatus);sa&&sa.stop()},null)}else w.a.Ddf(Ha)?(Ca=w.a.P2e(Ha),this.C7a(Ha,this.Ixa,{["ak0"]:Ca})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&
this.C7a(Ha,this.Ixa,null)}U6i(Ha,Ca){if(Ca&&""!==Ca&&(Ca=Sys.Net.XMLDOM(Ca))){w.a.Dhb(v.a.Gue,((new Date).getTime()+u.kTi).toString(),Ha);let Ga=Ca.getElementsByTagName("update");Ga&&Ga.length||(Ga=Ca.getElementsByTagName("o:update"));Ga&&0<Ga.length&&(Ca=Date.parse(Ga[0].firstChild.nodeValue),(w.a.P2e(Ha)<Ca||w.a.Ddf(Ha))&&this.C7a(Ha,this.Ixa,{["ak0"]:Ca}))}}}Object(t.a)(m,"AddinCommandsAnonymousAPIInitializer",null,[198]);class n{constructor(Ha,Ca,Ga){this.aPc=Ga;this.C7a=Ha;this.Fh=Ca}get Ixa(){return this.aPc}KQd(Ha){let Ca=
null;this.Fh&&(Ca=this.Fh.Qc("ComponentAttach",x.a[Ha]+l.a[this.Ixa]));if(null==this.nWd(Ha)?0:this.nWd(Ha)){const Ga=(new Date).getTime()-u.yTg*u.GYj;this.C7a(Ha,this.Ixa,{["ak0"]:Ga})}Ca&&Ca.stop()}}Object(t.a)(n,"AddinCommandsInitializerBase",null,[198]);class z extends n{constructor(Ha,Ca){super(Ha,Ca,5)}nWd(){return!0}}Object(t.a)(z,"AddinCommandsInitializer",n,[]);class y extends n{constructor(Ha,Ca){super(Ha,Ca,1)}nWd(Ha){try{const Ca=v.a.T5e()+Ha;return Boolean.parse(this.iVh(Ca)||"false")}catch(Ca){b.ULS.sendTraceTag(17306844,
220,50,"LocalStorage is not allowed, {0}.",Ca.toString())}return null}iVh(Ha){const Ca=localStorage;return void 0!==Ca&&null!==Ca?Ca.getItem(Ha):null}}Object(t.a)(y,"AddinCommandsLocalCacheInitializer",n,[]);var A=a(568),F=a(84),D=a(26);class B{constructor(Ha,Ca=null){this.Rb=Ha;this.fa=Ca?Ca:d.AFrameworkApplication.fa}get appUILocale(){return A.a.KH(d.AFrameworkApplication.lcid).name}Xli(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var Ha={};Ha[v.a.ruh]="TeachingCallout";this.wKd(D.a.whb,Ha)}const Ca=this.xhd();if(Ca)if(this.fa.ra("OcpsIsEnabled"))F.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ga=>{Ga.isFeatureEnabled("ConnectedServices",!0).then(sa=>{for(let bb of Ca){if(!sa&&0===bb.key)continue;
const Ba=this.p2e(bb.value);Ba&&Ba.KQd(bb.key)}return null})});else for(let Ga of Ca)(Ha=this.p2e(Ga.value))&&Ha.KQd(Ga.key)}LQd(Ha,Ca,Ga){Ga&&Ga[v.a.OHa]?(Ga[v.a.SP]=Ha,Ga[v.a.rM]=Ca,this.wKd(D.a.Hoa,Ga),w.a.Dhb(v.a.OHa,Ga[v.a.OHa].toString(),Ha)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===Ha&&(Ga={},Ga[v.a.SP]=Ha,Ga[v.a.rM]=Ca,this.wKd(D.a.dS,Ga))}p2e(Ha){let Ca=null;switch(Ha){case 1:Ca=new y(Object(r.a)(this,this.LQd,"retrieveAddinFlagCompleted"),
this.Rb);break;case 2:Ca=new m(Object(r.a)(this,this.LQd,"retrieveAddinFlagCompleted"),this.appUILocale,this.Rb,this.fa);break;case 5:Ca=new z(Object(r.a)(this,this.LQd,"retrieveAddinFlagCompleted"),this.Rb)}return Ca}}Object(t.a)(B,"AddinCommandsInitializerHost",null,[]);var M=a(170),R=a(274),P=a(812),E=a(278),H=a(160),G=a(356),N=a(1);let I;class O extends h.StandardDialog{constructor(Ha,Ca){super();this.N8d=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.Cae=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;
this.Dae=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.Tmb=!1;this.xrb=()=>{this.hide();this.Tmb&&c(this.qga)};this.eVi=()=>{P.a.instance.getItem("optedIntoAddinDeveloperMode")?(P.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.Tmb=!1):(P.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Tmb=!0)};this.qga=Ha;I=Ca}showDialog(Ha,Ca){try{this.ye=void 0===this.ye||null===this.ye?E.a.xKb(G.a.a2).toString():this.ye,this.show({["type"]:"StandardDialogProps",["id"]:this.ye,
["dialogIcon"]:3,["headerText"]:Ha,["titleText"]:Ca,["resultHandler"]:this.xrb,["messageAreaLink"]:this.vkh(),["permanentDismissCheckbox"]:this.rkh(),["renderMicrosoftLogoInHeader"]:!1})}catch(Ga){this.FIc(Ha,Ca)}}vkh(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.Cae,["handler"]:{["href"]:this.Dae,["target"]:"_blank"},["onExecute"]:null}}rkh(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.N8d,["onExecute"]:this.eVi}}FIc(Ha,Ca){const Ga=
new H.a(!1,!1,!1);Ga.Xb=1;Ga.ye=E.a.xKb(G.a.a2).toString();Ga.dg=String.format(this.zV(),Ca,this.Dae,this.Cae,this.N8d);Ga.initializeAndShow(Ha,this.mug,{optInCheckbox:!1})}mug(Ha,Ca){1==Ha&&Ca.optInCheckbox&&(P.a.instance.getItem("optedIntoAddinDeveloperMode")?(P.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.Tmb=!1):(P.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Tmb=!0,c(this.qga)))}zV(){return N.EwaSettings.isChangeGateEnabled("OfficeVSO:7726503_DeveloperModeStyleFix")?
"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>":"<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}Object(t.a)(O,"AppsForOfficeDeveloperModeOptInDialog",h.StandardDialog,[]);var U=a(53),ca=a(39),Q=a(98),Y=a(18),la=a(385);
class ea extends B{constructor(Ha){super(Ha.Rb);this.qga=this.$Ub=null;this.SFa=new R.a;this.MXf=Ca=>{1===Ca&&this.qga&&this.LXf()};this.$=Ha;e.a.BAb=e.a.qYe}get appUILocale(){return this.$.xa.UICultureTag}Ikg(){this.Xli();this.H2j()}xhd(){const Ha=new la.a;this.$.ea.Lg.get(27)&&(Ha.ia(0,2),""!==d.AFrameworkApplication.fa.Wa("HostInstallAddIns")&&Ha.ia(16,5));this.$.ea.Lg.get(33)&&Ha.ia(1,1);N.EwaSettings.ya(52)&&Ha.ia(8,1);this.$.se.get(35)&&Ha.ia(10,5);return Ha}wKd(Ha,Ca){this.axh(()=>{const Ga=
new Q.a(Ha,0,this.$.Bc,0,null);this.$.Ia.Nb(Ga,Ca)})}axh(Ha){(Ca=>{Ca=this.$.da.Aa(Ca);return!!Ca&&Y.d(Ca)})(198)?(new M.a,this.$.da.kb(198,Ca=>{Ha(Ca)})):Ha(null)}H2j(){this.qga=d.AFrameworkApplication.fa.Wa("DevAddinManifestFileUrl");this.$Ub=d.AFrameworkApplication.fa.Wa("DevAddinManifestGuid");var Ha=d.AFrameworkApplication.fa.Wa("IsDevAddinTest");if(this.qga&&this.$Ub&&Ha){Ha="true"===Ha;var Ca=this.SFa.getItem("optedIntoAddinDeveloperMode");const Ga=this.SFa.getItem(this.$Ub);Ca||Ha&&d.AFrameworkApplication.fa.ra("SuppressDeveloperAddinDialogs")?
Ga||Ha&&d.AFrameworkApplication.fa.ra("SuppressDeveloperAddinDialogs")?this.LXf():(Ha=new h.StandardDialog,Ha.Xb=4,Ca=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.qga)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,Ha.FS(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,Ca,this.MXf)):(Ha=new O(this.qga,this.MXf),Ha.Xb=0,Ha.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,
CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}LXf(){const Ha=U.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);ca.TaskExtensions.za(Ha,()=>{Ha.result.Jg.validateAndCacheNewDevAddinManifest(this.qga);this.SFa.setItem(this.$Ub,"true")},this.$.ka,3)}}Object(t.a)(ea,"AddinCommandsInitService",B,[850]);var ha=a(721);class X extends f.a{constructor(Ha){super();this.addinCommandsInitService=null;this.dd=()=>{b.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.ea.jc}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.Nd&
16384)}] `);this.addinCommandsInitService.Ikg();this.$.ea.xk(this.dd)};this.$=Ha;this.Mb()}create(){this.$.da.kb(53,()=>{this.vb(Object(ha.a)(this.$.da,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new ea(this.$))));this.$.ea.jc?(b.ULS.sendTraceTag(537170702,0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.Nd&16384)}] `),this.addinCommandsInitService.Ikg()):this.$.ea.Zj(this.dd)})}static la(Ha){Ha.da.Ha(201,
new X(Ha))}}Object(t.a)(X,"AddinCommandsInitServiceFactory",f.a,[]);var T=a(10);a.d(C,"a",function(){return ua});const ua=()=>{T.a.Fa(X.la)}},1236:function(t,C,a){t=a(0);var c=a(14),b=a(88),f;(function(P){P[P.generalException=0]="generalException";P[P.invalidArgument=1]="invalidArgument";P[P.notAllowed=2]="notAllowed";P[P.apiNotAvailable=3]="apiNotAvailable";P[P.unresolvedPendingRequest=4]="unresolvedPendingRequest";P[P.timeout=5]="timeout";P[P.adalTimeout=6]="adalTimeout";P[P.userNotSignedIn=7]=
"userNotSignedIn";P[P.userAborted=8]="userAborted";P[P.silentSignInFailed=9]="silentSignInFailed";P[P.invalidResourceUrl=10]="invalidResourceUrl";P[P.invalidGrant=11]="invalidGrant";P[P.connectionLost=12]="connectionLost";P[P.clientError=13]="clientError";P[P.serverError=14]="serverError"})(f||(f={}));Object(t.b)("ErrorCodes",f);a(1366);class e{constructor(P,E){this.requestCallback=this.requestParameters=null;this.requestParameters=P;this.requestCallback=E}}Object(t.a)(e,"OutstandingRequest",null,
[]);class d{}d.WQi="AADSTS50058";d.invalidResourceUrl="AADSTS50001";d.RQi="AADSTS65001";d.gRi="AADSTS70011";d.userAborted="13002";d.Nbj="Popup Window is null";d.Mbj="Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.n_j="tokenRevoked";Object(t.a)(d,"WopiHostErrorType",null,[]);var h=a(6),r=a(566),l=a(582),u=a(42),v=a(1365);class x{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(t.a)(x,"WopiIdentityInfo",
null,[803]);class w{constructor(P,E,H){this.expiration=this.authority=this.accessToken=null;this.accessToken=P;this.authority=E;this.expiration=H}}Object(t.a)(w,"WopiIdentityToken",null,[802]);var m=a(29),n=a(148),z=a(382),y=a(175),A=a(68),F=a(354);class D{constructor(P){this._initialized=!1;this.Obb={};this.oDc={};this.PO=h.AFrameworkApplication.sa.jE;this.Wod=P}i4a(P){this._initialized||(P.Am(y.a.bRf),P.Lk(y.a.bRf,Object(b.a)(this,this.c3i,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(P,
E,H=null){this.DPa(P,E);return new Promise((G,N)=>{if(this.prd(E))if(E in this.Obb)N("unresolvedPendingRequest");else{var I=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,u.c({["error"]:"Request timeout.",["callerId"]:E}));N("timeout")},12E4);this.ehd(P,E,H,(O,U)=>{window.clearTimeout(I);O?G(O):(c.ULS.sendTraceTag(37856033,369,15,u.c({["error"]:f[U]})),N(U))})}else c.ULS.sendTraceTag(37856034,344,10,u.c({["error"]:"Caller is not allowed."})),N("notAllowed")})}getPrimaryIdentityInfo(P){return new Promise((E,
H)=>{this.prd(P)?this.s5h((G,N)=>{G?E(G):(c.ULS.sendTraceTag(37856064,369,10,u.c({["error"]:N.toString()})),H(N))}):(c.ULS.sendTraceTag(37856065,344,10,u.c({["error"]:"Caller is not allowed."})),H("notAllowed"))})}getAuthContext(P){return new Promise((E,H)=>{const G=this.getAuthContextSync(P);G?E(G):H("notAllowed")})}getAuthContextSync(P){if(this.prd(P)){const E=new v.a;E.upn=h.AFrameworkApplication.fa.Wa("UserPrincipalName");E.userId=h.AFrameworkApplication.fa.Wa("LoggableUserId");E.authority=h.AFrameworkApplication.fa.Wa("HostAuthAuthority");
E.tenantId=h.AFrameworkApplication.fa.Wa("TenantId");E.isAnonymous=h.AFrameworkApplication.fa.ra("IsAnonymousUser");E.supportsAuthToken=this.Pii(P);P=h.AFrameworkApplication.fa.Wa("HostAuthType");E.authorityType="aad"===P.toLowerCase()?2:"msa"===P.toLowerCase()?1:0;return E}c.ULS.sendTraceTag(40751647,344,10,u.c({["error"]:"Caller is not allowed."}));return null}Pii(P){const E=r.OAuthManagerSettings.CAb;return m.a.Gya?E&&r.OAuthManagerSettings.Fhg?Array.contains(r.OAuthManagerSettings.Fhg,P.toLowerCase()):
!1:E}ehd(P,E,H,G){var N=[];Array.add(N,Object.assign(new A.a,{name:"CallerId",string:E}));Array.add(N,Object.assign(new A.a,{name:z.a.uYd,string:P.correlationId}));n.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:N}));N=l.a.create().toString();const I="getAccessToken_"+N,O=this.PO.Qc("ComponentAttach",I);this.oDc[I]=O;const U={};U[z.a.vYd]=N;U[z.a.vTj]=P.resource;U[z.a.wTj]=P.scope;U[z.a.Keg]=h.AFrameworkApplication.fa.Wa("HostAuthType");
U[z.a.zTj]=h.AFrameworkApplication.fa.Wa("UserPrincipalName");U[z.a.xTj]=P.silentLogin;U[z.a.sTj]=P.options;U[z.a.uYd]=P.correlationId;U[z.a.tTj]=E;H&&(U[z.a.addinName]=H.AddinName,U[z.a.rTj]=H.AddinTrustId);this.Wod.execute(ca=>{this.i4a(ca);ca.hi(y.a.getAuthToken,U)});this.Obb[N]=new e(P,G)}s5h(P){const E=h.AFrameworkApplication.fa.Wa("UserName"),H=h.AFrameworkApplication.fa.Wa("UserPrincipalName"),G=h.AFrameworkApplication.fa.Wa("LoggableUserIdSpace"),N=new x;N.email=H;N.displayName=E;switch(G){case "OrgIdPuid":N.authority=
"AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":N.authority="MicrosoftAccount";break;default:N.authority=G}P(N,null)}c3i(P){let E=null;try{let G=P.Values[z.a.vYd];const N=P.Values[z.a.qTj],I=P.Values[z.a.Keg],O=P.Values[z.a.yTj];let U=null,ca=null;const Q=this.Obb[G];if("undefined"!==typeof Q&&Q){var H=[];Array.add(H,Object.assign(new A.a,{name:z.a.uYd,string:Q.requestParameters.correlationId}));n.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:H}));E=Q.requestCallback;delete this.Obb[G];"undefined"!==typeof N&&N&&N.length?ca=new w(N,I,O):U=f[this.dMi(P)];H="getAccessToken_"+G;H in this.oDc&&(this.oDc[H].stop(),delete this.oDc[H]);E(ca,U)}else c.ULS.sendTraceTag(37856066,344,10,u.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:G}))}catch(G){P=P.Values[z.a.vYd],P in this.Obb&&delete this.Obb[P],this.Ync(),c.ULS.sendTraceTag(37856067,344,10,u.c({["error"]:G.message,["stack"]:G.stack})),E&&E(null,"generalException")}}prd(P){var E=
h.AFrameworkApplication.Ebi();P=P.toLowerCase();for(const H of E)if(P===H.toLowerCase())return!0;E=r.OAuthManagerSettings.q0c;for(let H in E)if(P===E[H].toLowerCase())return!0;return!1}dMi(P){P=P.Values[z.a.uTj];this.Ync();c.ULS.sendTraceTag(39068821,344,15,u.c({["error"]:P}));return P?-1<P.indexOf(d.WQi)?9:-1<P.indexOf(d.Nbj)||-1<P.indexOf(d.Mbj)?12:-1<P.indexOf(d.invalidResourceUrl)?10:-1<P.indexOf(d.userAborted)?8:-1<P.indexOf(d.gRi)||-1<P.indexOf(d.RQi)||P===d.n_j?11:-1<P.indexOf(d.adalTimeout)?
6:0:13}DPa(P,E){P=this.ukj(P.resource);c.ULS.sendTraceTag(39921882,344,50,u.c({["callerId"]:E,["resource"]:P}))}Ync(){c.ULS.sendTraceTag(39068822,344,50,u.c({["userAgent"]:window.navigator.userAgent}))}ukj(P){return(P?P:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(t.a)(D,"WopiIdentityManager",null,[796]);var B=a(260);class M{constructor(){this.ib=null}get name(){return"Common.App.WopiIdentity"}ki(P){this.ib=P;P.register(D,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").zc().Gc(()=>
new D(P.$b("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&h.AFrameworkApplication.fa.Nu(Object(b.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){try{this.ib.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(P){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+P)}}dispose(){}static main(){B.a.instance.dj(new M)}}Object(t.a)(M,"WopiIdentityPackage",null,[4,5]);a.d(C,"a",function(){return R});const R=()=>{Type.registerNamespace("Common.App.WopiIdentity");
M.main()}},1245:function(t,C,a){t=a(0);var c=a(88),b=a(14),f=a(131),e=a(43);class d{constructor(A){this.lha=this.fha=this.pha=this.oha=null;this.Ube=this.qfe=this.Jx=this.bM=!1;this.rUc=this.Hfe=null;this.yfe=0;this.$a=this.Efe=null;this.v2=A;this.FA=3;this.ylb=!0}initialize(A,F,D){this.oha=this.eld(A,F);this.pha=CommonUIStrings.l_SavingStatus;this.fha=CommonUIStrings.l_ReadOnlyStatus;this.lha=CommonUIStrings.l_ReviewModeStatus;this.v2&&this.v2.execute(B=>{B.f_c(Object(c.a)(this,this.cSb,"updateToSavingStatus"))});
this.Jx=!0;this.$a=D;return!0}Qfa(A,F){this.bM=A;this.FA=F;this.US(this.ylb)}US(A){!this.ylb&&A&&(this.Efe=new Date);this.ylb=A;A=null;3===this.FA&&(A=this.ylb?this.oha:this.pha);this.Rrh(A)}eld(A,F){return A?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):F&&F.length?String.format(CommonUIStrings.l_SavedToStatus,F):CommonUIStrings.l_SavedStatus}cSb(){this.US(!1)}M2h(){switch(this.FA){case 1:return this.fha;case 2:return this.lha;default:return null}}tti(A){return this.qfe===
this.bM&&this.yfe===this.FA&&this.Hfe===A}lad(A){appChrome.getHeaderApi().then(F=>{F.updateDocumentTitleStatus(this.bM,A,this.M2h(),this.Efe,this.ylb);this.Ube=!0;return null});this.rUc=null}Rrh(A){this.Jx&&f.c()&&!this.tti(A)&&(!this.Ube&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.lad(A):e.a.JPd()?(this.rUc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.rUc=window.requestIdleCallback(()=>
{this.lad(A)})):window.requestAnimationFrame(()=>{this.lad(A)}),this.qfe=this.bM,this.Hfe=A,this.yfe=this.FA)}}Object(t.a)(d,"ReactSaveStatusUIHandler",null,[365]);var h=a(175);class r{constructor(A,F){this.Bs=null;this.oha=CommonUIStrings.l_SavedStatus;this.pha=CommonUIStrings.l_SavingStatus;this.fha=CommonUIStrings.l_ReadOnlyStatus;this.lha=CommonUIStrings.l_ReviewModeStatus;this.fWb=F;this.v2=A;this.FA=3;this.Ksa=!0}au(){this.v2&&this.v2.execute(A=>{A.f_c(Object(c.a)(this,this.cSb,"updateToSavingStatus"))});
this.fWb.execute(A=>{this.Bs=A})}Qfa(A,F){this.FA=F;3===F?this.US(this.Ksa):2===F?this.z1d(this.lha):this.z1d(this.fha)}cSb(){this.US(!1)}US(A){this.Ksa=A;this.z1d(this.Ksa?this.oha:this.pha)}z1d(A){this.Bs&&this.Bs.hi(h.a.c3j,this.Jch(A))}Jch(A){const F={};F.StatusText=A;return F}}Object(t.a)(r,"SaveStatusPostMessageHandler",null,[365]);var l=a(96),u=a(133),v=a(58);class x{constructor(A,F,D,B){this.lha=this.fha=this.pha=this.oha=null;this.VFa=0;this.CE=this.eVc=this.kEa=this.MJc=this.WGa=null;this.Wd=
A;this.c$=F;this.v2=D;this.tj=B;this.Ide=!0;this.bM=!1;this.FA=3;this.Ksa=!0}initialize(A,F){if(!this.Wd)return!1;this.oha=this.eld(A,F);this.pha=CommonUIStrings.l_SavingStatus;this.fha=CommonUIStrings.l_ReadOnlyStatus;this.lha=CommonUIStrings.l_ReviewModeStatus;this.au();return!0}eld(A,F){return A?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):F&&F.length?String.format(CommonUIStrings.l_SavedToStatus,F):CommonUIStrings.l_SavedStatus}au(){this.c$&&this.c$.execute(A=>
{A.lSg(Object(c.a)(this,this.ULe,"createStatusAndModeElements"));A.eSg(Object(c.a)(this,this.qPj,"showHideSaveStatusElement"));A.I_j&&this.ULe(null,null)});this.v2&&this.v2.execute(A=>{A.f_c(Object(c.a)(this,this.cSb,"updateToSavingStatus"))})}hw(){this.CE&&this.Wd&&this.Wd.BG(this.CE)}qPj(A,F){this.Qfa("true"===F,this.FA)}Qfa(A,F){this.bM=A;this.FA=F;this.MJc&&(this.MJc.style.display=this.bM||3===this.FA||!this.WGa?"none":"");this.kEa&&(this.kEa.style.display=this.bM||3===this.FA?"none":"",this.kEa.innerText=
1===this.FA?this.fha:this.lha,this.kEa.title=1===this.FA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.eVc&&(this.eVc.style.display=this.bM||1===this.FA||!this.WGa&&!this.kEa?"none":"");this.CE&&(this.CE.style.display=this.bM||1===this.FA?"none":"",this.US(this.Ksa),this.CE.title=CommonUIStrings.l_SaveStatusTooltip)}ULe(A,F){A=document.getElementById(l.CuiHelper.Lef);F&&F.mck||!A||""===this.oha||""===this.pha||""===this.fha||""===this.lha||(this.WGa=document.getElementById(l.CuiHelper.g4b),
this.MJc=l.CuiHelper.Mua(A,"BreadcrumbAppModeDash","-",null,!1),this.kEa=l.CuiHelper.Mua(A,"BreadcrumbAppModeStatus",1===this.FA?this.fha:this.lha,null,!1),this.gng(this.kEa),this.eVc=l.CuiHelper.Mua(A,"BreadcrumbSaveStatusDash","-",null,!1),this.CE=l.CuiHelper.Mua(A,"BreadcrumbSaveStatus",this.oha,null,!1),this.gng(this.CE),this.Qfa(this.bM,this.FA))}cSb(){this.US(!1)}US(A){this.Ksa=A;this.p8j(this.Ksa?this.oha:this.pha)}p8j(A){!this.CE||3!==this.FA&&2!==this.FA||(this.Ide&&!this.Ksa?(this.VFa=this.CE.offsetWidth<
this.VFa?this.VFa:this.CE.offsetWidth,this.k5j(this.pha),this.Ide=!1):this.CE.innerText=A)}gng(A){A.style.direction=this.tj?"rtl":"ltr";A.style.width="auto";A.style.textAlign=this.tj?"right":"left";A.style.display=this.bM?"none":"";A.setAttribute("Unselectable","on")}k5j(A){this.CE&&(this.CE.style.width="",this.CE.innerText=A,this.VFa=this.CE.offsetWidth<this.VFa?this.VFa:this.CE.offsetWidth,A=u.a.lB(this.CE),this.CE.style.width=this.VFa-v.a.SD(A.paddingLeft)-v.a.SD(A.paddingRight)+1+"px")}}Object(t.a)(x,
"SaveStatusUIHandler",null,[365]);var w=a(6),m=a(100);class n{constructor(){this.fVc=this.dUc=this.Nnb=this.ib=null}get name(){return"Common.App.SaveStatus"}ki(A){this.ib=A;w.AFrameworkApplication.fa.ra("PostMessageEmbedded")&&w.AFrameworkApplication.hideHeaderEmbedded?this.ib.register(r,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Gc(()=>new r(this.ib.$b("Common.App.HostNotification.EditNotificationEventSource"),this.ib.$b("Postmessage.IHostPostmessenger"))):
w.AFrameworkApplication.sa.Pa.Vpf||(w.AFrameworkApplication.sa.Pa.Ou?this.ib.register(d,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Gc(()=>new d(this.ib.$b("Common.App.HostNotification.EditNotificationEventSource"))):this.ib.register(x,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Gc(()=>new x(m.EventHandlerManager.instance,this.ib.$b("Common.App.Header.HeaderEventSource"),this.ib.$b("Common.App.HostNotification.EditNotificationEventSource"),
w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.fa.Nu(Object(c.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){const A=w.AFrameworkApplication.fa,F=!!w.AFrameworkApplication.sa.Pa&&4===w.AFrameworkApplication.sa.Pa.$i;if(A.ra("WordEditorAutoSaveImprovementIsEnabled")||A.ra("PptEditorSaveStatusInHeaderEnabled")||F&&A.ra("SimplifiedReactRibbonUxIsEnabled")||A.ra("ExcelSaveStatusInHeaderEnabled")||A.ra("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.fa.ra("PostMessageEmbedded")&&
w.AFrameworkApplication.hideHeaderEmbedded?(this.fVc=this.ib.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.fVc.au():w.AFrameworkApplication.sa.Pa.Vpf||A.ra("PreventSaveStatusInitializationWithHiddenHeader")&&w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.sa.Pa.Ou?(this.dUc=this.ib.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.dUc.initialize(A.ra("IsSkyDrive"),A.Wa("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.fa):(this.Nnb=this.ib.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.Nnb.initialize(A.ra("IsSkyDrive"),A.Wa("HostNameToIncludeInSavedStatus")))}dispose(){this.Nnb&&this.Nnb.hw()}}Object(t.a)(n,"PackageManager",null,[4,5]);var z=a(260);a.d(C,"a",function(){return y});const y=()=>{Type.registerNamespace("Common.App.SaveStatus");z.a.instance.dj(new n)}},1255:function(t,C,a){var c=a(10);t=a(0);var b=a(14),f=a(228),e=a(92),d=a(6),h=a(198),r=a(9),l=a(40),u=a(921),v=a(231),x=a(65),w=a(900);class m extends Sys.EventArgs{constructor(){super()}}Object(t.a)(m,"NumberFormatsUpdatedEventArgs",
Sys.EventArgs,[]);var n=a(51),z=a(47);a(37);var y=a(32),A=a(1),F=a(628);a(23);var D=a(293),B=a(21);a(186);class M{constructor(N){this.data=N}}Object(t.a)(M,"NumberFormatDataHolder",null,[]);var R=a(189);class P extends l.a{constructor(N,I){super();this.uxd=r.a.ue;this.n3c=null;this.Aib=this.Ymc=!1;this.BCf=(O,U)=>{var ca;(O=B.h(this.$))&&(U=null!==(ca=null===U||void 0===U?void 0:U.cell)&&void 0!==ca?ca:O.Ob(null))&&this.jqa(U.cell.si,!0)};this.JYi=O=>{this.isActive()&&(y.a.Jq(O.Errors)||!O.Result?
(O=O.Errors?O.Errors.map(U=>JSON.stringify(U)).join(","):"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${O}`)):(O=O.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${O.Index}, category = ${O.Category}`),this.qGj(O.Index,O.Category),this.raiseEvent(P.d4c,new u.a(O.Index,O.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");
this.c5b();this.isActive()&&this.ea.nc.allowEdits&&(this.Aib||this.Rn&&!(this.ea.QEb>this.uxd)?this.THc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.Sjd=w.a(this.$.pa.va,this.Rn?this.Rn.Digest:"",this.rZi,this.qZi,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.l6e())};this.XGf=O=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${O.data.status}, HTTP status = ${O.data.httpStatus}.`);
this.iMa=null};this.t0=()=>{this.Aib=!1;this.ea.YD(this.t0);this.$Sa(this.Ymc?P.GVd:P.gDd)};this.dd=(O,U)=>{b.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");v.a(U)&&this.$Sa(P.GVd)};this.Gf=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.tDd(0===this.$.workbookContext.CalcMode)};this.yd=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");
this.$Sa(P.GVd);A.EwaSettings.ya(269)&&3!==this.$.workbookContext.CalcMode&&this.tDd(0===this.$.workbookContext.CalcMode)};this.jZi=(O,U,ca)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.iMa=null;this.isActive()?O.StateId===r.a.ue?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.THc()):!O.Result||this.rY&&this.rY.length?this.$Sa(P.gDd):this.CKf(O,
U,ca):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.CKf=O=>{this.rY=O.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.rY?this.rY.length:-1} functions.`);O=!1;if(this.rY){for(const U of this.rY)U&&(this.K1e[U.NameUI.toLocaleUpperCase()]=U.FunctionIndex.toString(),U.NameUI!==U.NameDataStrings&&(this.K1e[U.NameDataStrings.toLocaleUpperCase()]=
U.FunctionIndex.toString(),O=!0),this.SPh.ia(U.FunctionIndex,U.NameUI));this.raiseEvent(P.Fgd,Sys.EventArgs.Empty,this)}O&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.rZi=O=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.Ymc=!1,this.uxd=O.StateId,this.uxd===r.a.ue)this.Ymc=!0,this.THc();else{if(O.Result){var U=this.Rn;this.Rn=O.Result;b.ULS.sendTraceTag(537155678,
0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Rn.Digest}.`);O=[];if(U)O=P.O2h(U.NumberFormats,this.Rn.NumberFormats);else for(U=0;U<this.Rn.NumberFormats.length;U++)this.sqc.ia(U,this.Rn.NumberFormats[U].NumberFormatCategory);for(const ca of O)this.sqc.ia(ca,this.Rn.NumberFormats[ca].NumberFormatCategory);this.raiseEvent(P.NDd,new m(O),this);this.raiseEvent(P.ouf)}this.$Sa(P.gDd)}};this.qZi=O=>{this.isActive()&&(10===O.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):
(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${O.data.status}, HTTP status = ${O.data.httpStatus}.`),this.Ymc=!0,this.THc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=N;this.$=I;this.Rn=this.iMa=this.Sjd=this.SKb=null;this.sqc=new R.a;this.Uxb=new R.a;this.rY=[];this.SPh=new R.a;this.K1e={};this.ea.Zj(this.dd);this.$.rl(this.yd);B.h(this.$).ga.t3(this.BCf);A.EwaSettings.ya(269)&&this.ea.vu(this.Gf);
this.$Sa(P.Rgf);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Qte(N){this.addHandler(P.NDd,N)}tOd(N){this.removeHandler(P.NDd,N)}bQg(N){this.addHandler(P.d4c,N)}bpj(N){this.removeHandler(P.d4c,N)}ute(N){this.addHandler(P.Fgd,N)}hOd(N){this.removeHandler(P.Fgd,N)}FRg(N){this.addHandler(P.ouf,N)}get Ve(){return this.Rn?this.Rn.LocaleInformation:null}get Qza(){return this.Rn?this.Rn.NumberFormats:[]}get Hka(){this.rY&&this.rY.length||this.l6e();return this.rY}get Qoi(){return this.Rn&&
void 0!==this.Rn.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.Rn.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Rn.InstantaneousCalcWebWorkerPrecisionSamplingRate:P.qoh}get Toi(){return this.Rn&&void 0!==this.Rn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Rn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.Rn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:P.uoh}get Soi(){return this.Rn&&void 0!==this.Rn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&
null!==this.Rn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.Rn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:P.toh}get Roi(){return this.Rn&&void 0!==this.Rn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.Rn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Rn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:P.soh}get zif(){return this.Rn?this.Rn.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:P.roh}get Rqd(){return null!==this.n3c?
this.n3c:this.Rn?this.Rn.InstantaneousCalcManualMode:!1}e2j(N){let I;if(!N)return{returnValue:!0,category:"General"};I="";if(!({category:N}=this.jqa(N,!1)).returnValue)return{returnValue:!1,category:I};I=this.Wdh(N);return{returnValue:!0,category:I}}Wdh(N){let I="";switch(N){case 0:I="General";break;case 1:I="Number";break;case 2:I="Currency";break;case 3:I="Accounting";break;case 4:I="Date";break;case 5:I="Time";break;case 6:I="Percentage";break;case 7:I="Fraction";break;case 8:I="Scientific";break;
case 9:I="Text";break;case 10:I="Special";break;case 11:I="Custom"}return I}jqa(N,I){let O,U=({value:O}=this.sqc.Mc(N,0)).returnValue;!U&&0<N&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${N}`),this.DVh(N),I&&(O=this.CVh(N),U=!0),F.a(N,this.$.AG)&&(O=6));return{returnValue:U,category:O}}Gui(N){let I=0;if(({category:I}=this.jqa(N,!0)).returnValue)return 6===I;b.ULS.sendTraceTag(537155733,
0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${N}`);return!1}sOh(N){b.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.iMa=x.o(this.$.pa.va,{FilterType:0},D.b(this.CKf,N),this.XGf,null,null,null)}d1e(){this.$Sa(P.Rgf)}tDd(N){this.n3c=N}DVh(N){if(this.Uxb&&this.$){var I;if(!({value:I}=this.Uxb.Mc(N)).returnValue||I.isCompleted)b.ULS.sendTraceTag(537155728,
0,50,`Getting number format category for format index: ${N}`),(I=w.c(this.$.pa.va,N,this.JYi,null,null,null))&&this.Uxb.ia(N,I)}else b.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}CVh(N){return 1<=N&&8>=N?1:9<=N&&12>=N?2:13===N||14===N?6:15===N?8:17===N|18===N?7:19===N?4:16===N||20<=N&&29>=N||31===N?11:30===N?9:32<=N&&35>=N?3:0}isActive(){const N=void 0===this.ea||null===this.ea,I=!N&&this.ea.jc;b.ULS.sendTraceTag(537155727,
0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${I} - sessionStateManager IsNullOrUndefined: ${N}`);return I}qGj(N,I){this.sqc.ia(N,I)}dispose(){e.a.Ja(this.SKb);this.SKb=null;this.c5b();for(let N of this.Uxb){const I=N.value;I&&!I.isCompleted&&d.AFrameworkApplication.Od.gv(I.xu)}this.Uxb=null;this.ea&&(this.ea.xk(this.dd),this.Aib&&this.ea.YD(this.t0),this.Aib=!1,this.ea.$v(this.Gf));this.ea=null;this.$&&B.h(this.$)&&B.h(this.$).ga&&(B.h(this.$).ga.Iea(this.BCf),
this.$.lm(this.yd));this.$=null;super.dispose()}isFeatureEnabled(N){try{switch(N){case "LocaleLongDateFormat":return A.EwaSettings.ya(184);case "GetLocaleDayNames":return A.EwaSettings.ya(185);case "CalculateTextWidthIgnoreLetterSpacing":return A.EwaSettings.ya(255);case "OfficeVSO:3657744_CalcFixForDateFormat":return A.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return A.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");
case "CalcAutocompleteExperiment":return A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return A.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return A.EwaSettings.ya(101);default:return N.startsWith("OfficeVSO:")?A.EwaSettings.isChangeGateEnabled(N):!1}}catch(I){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${N}): feature parsing failed, returning false. Exception: ${I.toString()}.`),
!1}}$Sa(N){this.isActive()&&this.ea.nc.allowEdits?(e.a.Ja(this.SKb),this.SKb=null,this.SKb=n.a.instance.create(this.refresh,N,z.a.Uoi)):b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.nc&&null!==this.ea.nc?this.ea.nc.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}l6e(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");
this.iMa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.rY&&this.rY.length||(this.iMa=x.o(this.$.pa.va,{FilterType:0},this.jZi,this.XGf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}THc(){this.Aib||(this.Aib=!0,this.ea.HC(this.t0))}c5b(){this.gv(this.Sjd);this.gv(this.iMa);this.iMa=this.Sjd=null}gv(N){N&&
!N.isCompleted&&this.$.pa.va.Bhb(N.xu)}static O2h(N,I){if(!N||!N.length)return[];if(!I||!I.length){I=Array(N.length);for(var O=0;O<N.length;++O)I[O]=N[O].IfmtIndex;return I}O=new R.a;for(const U of N)O.ia(U.IfmtIndex,new M(U));N=new h.a;for(const U of I){let ca;({value:ca}=O.Mc(U.IfmtIndex)).returnValue&&ca.data.FormatString===U.FormatString||N.add(U.IfmtIndex)}return N.toArray()}}P.NDd="isim0";P.d4c="isim1";P.Fgd="isim2";P.ouf="isim3";P.Rgf=100;P.GVd=1E3;P.gDd=3E5;P.qoh=.001;P.uoh=.1;P.toh=.2;P.soh=
.001;P.roh=50;Object(t.a)(P,"InstantaneousSupportInformationManager",l.a,[681,2]);var E=a(721);class H extends f.a{constructor(N){super();this.$=N;this.Mb()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var N=Object(E.a)(this.$.da,268,()=>new P(this.$.ea,this.$));this.vb(N)}}static la(N){if(!N)throw Error.argumentNull("ewaControl");N.da.Ha(246,new H(N))}}Object(t.a)(H,"InstantaneousSupportInformationManagerFactory",
f.a,[]);a.d(C,"a",function(){return G});const G=()=>{c.a.Fa(H.la)}},1256:function(t,C,a){t=a(0);var c=a(14),b=a(88),f=a(113),e=a(112),d=a(26);class h{constructor(D,B,M){this.NGa=null;this.de=D;this.La=B;this.ibe=M.create()}dYf(){this.NGa?c.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(c.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.NGa=new f.a(2,1,3E4,Object(b.a)(this,this.pPb,"showFloatPane"),67),this.de.Kf(this.NGa))}pPb(){this.NGa=
null;c.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.ibe.display()}bSa(){this.La.Wb(d.a.pPb,e.a.frame,Object(b.a)(this,this.bPj,"showFloatPaneHandler"))}bPj(D,B,M,R,P){return D!==d.a.pPb?2:1===M?32:2===M&&P?(c.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",P),P?this.dYf():(this.NGa?(c.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.de.np(this.NGa)):(c.ULS.sendTraceTag(23674915,
207,50,"Hide float pane immediately!"),this.ibe.remove(null)),this.NGa=null),32):8}}Object(t.a)(h,"FloatPaneActor",null,[858]);var r=a(127),l=a(166),u=a(16),v=a(50),x=a(93);class w{constructor(D,B,M,R,P){this.qRc=this.llb=this.VYb=this.hha=this.KP=this.lr=this.sKc=this.cM=this.Zmb=this.hmb=this.imb=this.vNc=null;this.de=B;this.$a=D;this.Pi=M;this.ib=P;this.h2=R}M2a(){this.cM=document.createElement("div");this.cM.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.cM.style.width=
this.KP.width+"px";(this.qRc=this.R3h(this.h2))?(this.hha=document.createElement("a"),this.hha.setAttribute(x.a.Kd,x.a.xr),this.Pi.ta(u.a.click,this.hha,Object(b.a)(this,this.yKf,"onRedirectClick")),this.hha.href=this.qRc,this.hha.target="_blank",this.hha.appendChild(this.KP),this.cM.appendChild(this.hha)):this.cM.appendChild(this.KP);this.lr=document.createElement("a");this.lr.setAttribute(x.a.Kd,x.a.rt);this.lr.className="StandardButton WACFloatPaneCloseButton";this.lr.title=CommonUIStrings.l_Close;
this.lr.tabIndex=-1;this.sKc=l.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.sKc.setAttribute(x.a.Kd,x.a.xr);this.lr.appendChild(this.sKc);this.Pi.ta(u.a.click,this.lr,Object(b.a)(this,this.onClose,"onClose"));this.cM.appendChild(this.lr);this.Zmb.appendChild(this.cM)}P0h(D){const B=this.$a.ra("O365PromotionHasStarted");switch(D){case 2:return r.a.zua(String.format("adppt{0}.png",B?"sale":""));case 1:return r.a.zua(String.format("adxls{0}.png",
B?"sale":""));case 3:return r.a.zua(String.format("addoc{0}.png",B?"sale":""))}return null}R3h(D){const B=this.$a.Wa("O365AdPaneRedirectedURL");switch(D){case 1:return String.format(B,"Excel");case 2:return String.format(B,"PowerPoint");case 3:return String.format(B,"Word")}return null}hide(D=null){this.llb=null;this.cM&&!this.VYb&&(D?c.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):c.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.cM.className=
String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.cM.style.height="0px",this.VYb=new f.a(2,1,1E3,Object(b.a)(this,this.remove,"remove"),67),this.de.Kf(this.VYb))}remove(){this.cM&&this.Zmb&&(this.hha&&this.Pi.Ba(u.a.click,this.hha,Object(b.a)(this,this.yKf,"onRedirectClick")),this.Pi.Ba(u.a.click,this.lr,Object(b.a)(this,this.onClose,"onClose")),this.Zmb.removeChild(this.cM),this.cM=null);this.VYb=null}display(){if(this.vNc=this.ib.yg("Common.IFloatPaneContainer"))if(this.Zmb=this.vNc.container){var D=
this.P0h(this.h2);D?(c.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",D),this.KP=document.createElement("img"),this.KP.className="WACFloatPaneImage",this.imb=Object(b.a)(this,this.W0i,"onLoadImageFinish"),v.a.addHandler(this.KP,u.a.load,this.imb),this.hmb=Object(b.a)(this,this.V0i,"onLoadImageError"),v.a.addHandler(this.KP,u.a.error,this.hmb),this.KP.src=D):c.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else c.ULS.sendTraceTag(23674906,
207,15,"The container is empty, so the float pane can't be shown.");else c.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}W0i(){const D=this.$a.Dd("O365AdPaneShowingDuration",60);this.M2a();this.cM.style.display="block";this.cM.style.height=this.KP.height+"px";this.llb=new f.a(2,1,1E3*D,Object(b.a)(this,this.hide,"hide"),67);this.de.Kf(this.llb);this.UYf()}V0i(){c.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");
this.UYf();this.KP=null}UYf(){this.imb&&this.KP&&v.a.removeHandler(this.KP,u.a.load,this.imb);this.imb=null;this.hmb&&this.KP&&v.a.removeHandler(this.KP,u.a.error,this.hmb);this.hmb=null}yKf(){c.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.llb&&this.de.np(this.llb);this.hide();return!0}dispose(){this.hide()}}Object(t.a)(w,"FloatPane",null,[870]);class m{constructor(D,B,M,R,P){this.de=B;this.$a=D;this.Pi=M;this.ib=P;this.h2=
R}create(){return new w(this.$a,this.de,this.Pi,this.h2,this.ib)}}Object(t.a)(m,"FloatPaneFactory",null,[857]);var n=a(6),z=a(229),y=a(260);class A{constructor(){this.ib=null}get name(){return"Common.App.FloatPane"}get Mlf(){return n.AFrameworkApplication.fa.ra("O365AdvertisementIsEnabled")&&n.AFrameworkApplication.fa.ra("IsShowAdvertisementPaneEnabled")}init(){this.Mlf&&(c.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.ib.resolve("Common.App.FloatPane.IFloatPaneActor").dYf(),
c.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.ib.resolve("Common.App.FloatPane.IFloatPaneActor").bSa())}ki(D){this.ib=D;this.Mlf&&(this.ib.register(m,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Gc(()=>new m(n.AFrameworkApplication.fa,n.AFrameworkApplication.ji,z.a.instance,n.AFrameworkApplication.sa.Pa.$i,this.ib)).zc(),this.ib.register(h,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Gc(()=>
new h(n.AFrameworkApplication.ji,n.AFrameworkApplication.xb,this.ib.resolve("Common.App.FloatPane.IFloatPaneFactory"))).zc())}dispose(){}static main(){y.a.instance.dj(new A)}}Object(t.a)(A,"FloatPanePackage",null,[4,5]);a.d(C,"a",function(){return F});const F=()=>{Type.registerNamespace("Common.App.FloatPane");A.main()}},1257:function(t,C,a){var c=a(10);t=a(0);var b=a(14),f=a(232),e=a(6),d=a(92),h=a(34),r=a(37),l=a(40),u=a(15),v=a(33);class x extends l.a{constructor(ua,Ha,Ca){super();this.value=null;
this.Ywd=ua;this.Ix=Ha;this.qEg=Ca}DQg(ua){this.addHandler("EnabledStateChanged",ua)}get isEnabled(){return this.Ix}set isEnabled(ua){ua!==this.Ix&&(this.Ix=ua,v.a.Pn()&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.Ywd.replace(" ","")+"Button",ua)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get ei(){return this.value?String.format(u.a.instance.qb(79),this.Ywd,this.value):this.Ywd}get poc(){return this.qEg}}Object(t.a)(x,"StatusBarAggregateControl",
l.a,[900]);class w extends l.a{constructor(){super();this.controls=new r.a(!1);this.W6d=null;this.kUf=()=>{this.raiseEvent("AggregatesChanged")};this.q3(0,415,"Average",!0);this.q3(1,416,"Count",!0);this.q3(2,417,"NumericalCount",!1);this.q3(3,418,"Minimum",!1);this.q3(4,419,"Maximum",!1);this.q3(5,420,"Sum",!0)}MPg(ua){this.addHandler("AggregatesChanged",ua)}Soj(ua){this.removeHandler("AggregatesChanged",ua)}get b0a(){return this.W6d||w.dSe}set b0a(ua){ua=ua||w.dSe;ua!==this.b0a&&(this.aCa(0,ua.Average),
this.aCa(1,ua.Count),this.aCa(2,ua.NumericalCount),this.aCa(3,ua.Minimum),this.aCa(4,ua.Maximum),this.aCa(5,ua.Sum),this.W6d=ua,this.kUf())}dispose(){d.a.wc(this.controls.values);this.controls.clear();super.dispose()}ywa(ua){return this.controls.getItem(ua)}CMg(ua,...Ha){ua=this.ywa(ua.toString());for(const Ca of Ha)this.controls.add(Ca,ua)}q3(ua,Ha,Ca,Ga){Ha=new x(u.a.instance.Va(Ha),Ga,Ca);Ha.DQg(this.kUf);this.controls.add(ua.toString(),Ha)}aCa(ua,Ha){this.ywa(ua.toString()).value=Ha}static get dSe(){w.Ara||
(w.Ara={},w.Ara.Average=w.Ara.Count=w.Ara.NumericalCount=w.Ara.Minimum=w.Ara.Sum=null);return w.Ara}}w.Ara=null;Object(t.a)(w,"StatusBarAggregateControlCollection",l.a,[]);var m=a(327),n=a(45),z=a(231),y=a(171),A=a(47),F=a(5),D=a(31),B=a(126),M=a(1),R=a(197),P=a(21),E=a(65);const H=(ua,Ha,Ca,Ga,sa,bb,Ba,qa=null)=>{qa=ua.Oa(1,qa);qa.activeCell=Ha;qa.selectedRanges=Ca;return E.g(ua,"GetStatusBarAggregates",qa,Ga,sa,bb,Ba,0)};var G=a(55),N=a(60),I=a(258),O=a(157),U=a(41),ca=a(167),Q=a(355),Y=a(79),la=
a(62);const ea=M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PauseBeforeCalcRequest",10),ha=[{c0a:0,name:"Average",kVa:-1015637685,d0a:1,h5a:!0},{c0a:1,name:"Count",kVa:1957769939,d0a:3,h5a:!1},{c0a:2,name:"NumericalCount",kVa:-1292677035,d0a:2,h5a:!1},{c0a:3,name:"Minimum",kVa:405783320,d0a:5,h5a:!0},{c0a:4,name:"Maximum",kVa:1210824414,d0a:4,h5a:!0},{c0a:5,name:"Sum",kVa:1265371067,d0a:9,h5a:!0}];class X{constructor(ua,Ha=null,Ca=null){this.zdc=this.WFc=this.XFc=this.VFc=null;this.Eta=
new w;this.m$a=new r.a(!0);this.Shg=0;this.Zkg=Ga=>{const sa=this.ga.qa.activeCell.clone(),bb=n.d(this.ga.qa.selectedRanges);var Ba=this.$.na;const qa=null===Ba||void 0===Ba?void 0:Ba.sheetId,pa=null===Ba||void 0===Ba?void 0:Ba.hash,ya=this.$.ea.Ee,za=this.$.ea.QEb;Ba=this.$.listSeparator;const cb=n.i(n.H(bb),Ba,this.$,!1),Pa=`=${this.calcManager.config.localeInfo.getWorksheetFuncName(485)}({0}${Ba}5${Ba}{1})`;Promise.all(ha.map(nb=>this.calcManager.evalFormula(String.format(Pa,nb.d0a,cb),sa,void 0,
nb.h5a?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(nb=>{var Ma;const Oa=this.ga.qa.selectedRanges,La=this.ga.qa.activeCell,ra=null===(Ma=this.$.na)||void 0===Ma?void 0:Ma.sheetId;if(n.R(bb,Oa)&&sa.equals(La)&&qa===ra){Ma=[];for(var [,V]of nb.entries()){if(void 0===(null===V||void 0===V?void 0:V.formatted)||!excelOnlineCalc.util.isSuccess(V.formatted)||!excelOnlineCalc.util.isSuccess(V.value)){this.Yyc();return}nb=this.calcManager.XF.renderValue(V.formatted.value,
excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(nb)){this.Yyc();return}nb=excelOnlineCalc.numfmt.renderedValueToString(nb.value);Ma.push(nb)}V={};for(var ma of ha)V[ma.name]="";ma=Ma[1];nb=Ma[2];if(1<+ma&&(V.Count=ma,0<+nb))for(const [W,aa]of ha.entries())V[aa.name]=Ma[W];this.GOb(V);this.PXj(V,ma,ya,za,bb,sa,qa,pa,Ga)}}).catch(nb=>{b.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason: ${JSON.stringify(nb)}`);this.Yyc()})};this.$c=()=>
{this.tmg()};this.xf=(Ga,sa)=>{Ga=sa.hd.hash;sa=sa.hd.block;const bb=sa.Eba;if(sa.state&4&&bb&&bb!==this.m$a.getItem(Ga)){this.m$a.add(Ga,bb);var Ba=(Ga=sa.Ff)?P.g(Ga.getRowNumbers(),Ga.getColumnNumbers()):null;f.a.any(this.ga.qa.selectedRanges,qa=>qa.xd(Ba))&&this.tmg()}};this.qn=(Ga,sa)=>{this.m$a.remove(sa.hd.hash)};this.yd=()=>{this.$.da.kb(29,Ga=>{this.statusBarManager=Ga;Ga.OJ(this);b.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};
this.dd=(Ga,sa)=>{!Ga.jc&&z.b(sa)&&this.statusBarManager&&(this.statusBarManager.fG(this),this.statusBarManager=null,b.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};this.yYj=()=>{let Ga;({P4b:Ga}=this.m2j(this.ga.qa.selectedRanges)).returnValue?this.GOb(Ga):this.x1f()};this.x1f=()=>{var Ga;const sa=n.d(this.ga.qa.selectedRanges),bb=this.ga.qa.activeCell.clone(),Ba=null===(Ga=this.$.na)||void 0===Ga?void 0:Ga.sheetId;this.Lxf(bb,sa,qa=>
{var pa;const ya=this.ga.qa.selectedRanges,za=this.ga.qa.activeCell,cb=null===(pa=this.$.na)||void 0===pa?void 0:pa.sheetId;n.R(sa,ya)&&bb.equals(za)&&Ba===cb&&this.GOb(qa.Result)})};this.qkf=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StatusBarAggregatesCSE",!1);this.Blf=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AggregatesDebugErrorMessageForFF",!1);this.$=ua;this.gridView=P.h(this.$);this.b4=Ha||e.AFrameworkApplication.Od;this.Hh=Ca||D.a.Ya;this.$.ea.Zj(this.dd);
this.$.rl(this.yd);this.ga.IC(this.$c);this.ga.FC(this.$c);this.Ca.uu(this.xf);this.Ca.hH(this.qn);for(const Ga of ha)this.qIj(Ga.c0a,Ga.name,Ga.kVa);(this.statusBarManager=this.$.da.Aa(29))&&this.statusBarManager.OJ(this);this.qkf&&((M.EwaSettings.LF()?Ga=>O.a.resolve(U.g).then(sa=>setTimeout(()=>Ga(sa),0)):Ga=>this.$.da.kb(266,Ga))(Ga=>{this.calcManager=Ga}),this.$.da.kb(268,Ga=>{this.instantaneousSupportInformationManager=Ga}))}Iq(ua){this.Eta.MPg(ua)}gr(ua){this.Eta.Soj(ua)}get b0a(){return this.Eta.b0a}GOb(ua){this.Eta.b0a=
ua}get Ca(){return this.gridView.Ca}get ga(){return this.gridView.ga}dispose(){this.$&&(this.$.ea.xk(this.dd),this.$.lm(this.yd),this.ga.UB(this.$c),this.ga.JI(this.$c),this.Ca.Ls(this.xf),this.Ca.KI(this.qn),this.dDe());this.statusBarManager&&(this.statusBarManager.fG(this),this.statusBarManager=null);d.a.wc([this.VFc,this.XFc,this.WFc,this.Eta]);this.$=this.Eta=this.WFc=this.XFc=this.VFc=null;this.m$a&&(this.m$a.clear(),this.m$a=null)}ns(ua,Ha){return this.ywa(ua)&&this.j9e(ua,Ha)?!0:!1}j9e(ua,
Ha){const Ca=this.ywa(ua);if(!Ca)return!1;let Ga=Ca.ei;if(ua.endsWith("Label"))Ha.Visible=Ca.isVisible,v.a.Pn()?Ha.LabelText=Ga:Ha.Value=Ga;else if(ua.endsWith("Button"))Ha.LabelText=Ga,Ha.On=Ca.isEnabled;else return!1;return!0}Qn(){return!0}Oc(){return!1}executeCommand(ua,Ha){ua=this.ywa(Ha.command);if(!ua)return R.a(Ha.command);ua.isEnabled=!ua.isEnabled;this.HHi(ua.poc,ua.isEnabled);return N.Task.Ua(!0)}Ac(ua,Ha){return!!this.ywa(Ha.command)}Vc(){return!1}Lxf(ua,Ha,Ca){const Ga=this.$;this.dDe();
this.$.ea.jc&&(this.zdc=H(Ga.pa.va,n.o(ua,Ga),n.r(Ha,Ga),Ca,null,null,null))}m2j(ua){let Ha;return{returnValue:({P4b:Ha}=X.Ykg(ua)).returnValue||this.VWg(ua)&&this.SWg(ua),P4b:Ha}}PXj(ua,Ha,Ca,Ga,sa,bb,Ba,qa,pa){const ya=this.Blf;if(pa||!(this.Shg>(ya?1E3:20)||Math.random()>(ya?1:.05)))this.Shg++,this.Lxf(bb,sa,za=>{var cb,Pa,nb,Ma;if(!I.a(za)){var Oa=this.ga.qa.selectedRanges,La=this.ga.qa.activeCell,ra=null===(cb=this.$.na)||void 0===cb?void 0:cb.sheetId;cb=za.StateId;if(n.R(sa,Oa)&&bb.equals(La)&&
Ba===ra&&Ca===this.$.ea.Ee&&Ga===this.$.ea.QEb&&Ca===cb){var V=za.Result;cb={};const ia={};ra=!0;for(var ma of ha){var W=V[ma.name],aa=ua[ma.name];const ka=W===aa;cb[ma.name]=ka;ia[ma.name]=[W.length,aa.length];ra&&(ra=ka)}({category:La}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.e2j(null!==(Ma=null===(nb=null===(Pa=this.gridView.Ob(La))||void 0===Pa?void 0:Pa.cell)||void 0===nb?void 0:nb.si)&&void 0!==Ma?Ma:0):{category:"uninitialized"});Pa=Oa.length;
Oa=n.b(Oa);nb=this.gridView.def()||this.gridView.cef();ma=this.gridView.lb;Ma=ma.iJb;W=this.gridView.Lj("StatusBarAggregates");ma=Y.b(bb,ma.Vi,ma.zj,this.gridView.rowsPerBlock,this.gridView.columnsPerBlock,Object(la.c)(W)?W.value:null);ma=ma.X+"_"+ma.Y+"_"+ma.PaneType;V=V.Count;W=ua.Count;aa=this.gridView.wb.P3h(sa);za=`StatusBarAggregateManager.testCalcResult: allCorrect: ${ra}, ${JSON.stringify(cb)}, numberFormatCategory: ${La}, resLength(server,calc): ${JSON.stringify(ia)}, stateId: ${Ca}, latestSuccessfulStateId: ${Ga}, prevSheetId: ${Ba}, prevSheetHash: ${qa}, numOfRanges: ${Pa}, numOfCells: ${Oa}, prevActiveCell: ${bb}, prevSelectedRanges: ${sa.join(";")}, sheetHasHidden: ${nb}, panesState: ${Ma}, blockPositionString: ${ma}, ReportCalcState: ${za.ReportCalcState}, CalcComplete: ${za.CalcComplete}, serverCount: ${V}, calcCount: ${W}, calcCountUnfiltered: ${Ha}, enumeratorCount: ${aa}, forceTestResult: ${pa}`;
b.ULS.sendTraceTag(520426510,0,50,za);W!==V&&!pa&&this.Blf&&(za={Appearance:1,Caption:null,Description:"We need your help!\nYou encountered an error we are having a hard time reproducing.\nPlease save a copy of your workbook at its current state and send it to issolomo@microsoft.com.\nThank you!",Directive:null,MessageId:0,MessageIdName:"StatusBarAggregatesDebugErrorMessageForFF"},za.MessageIdHash=h.a.Au(za.MessageIdName),za.Severity=0,za.Type=0,M.EwaSettings.By()?new Q.a(this.$,za):(new ca.ErrorDialog(this.$,
za)).qg());ra||pa||window.setTimeout(()=>{this.Zkg(!0)},100)}}})}VWg(ua){const Ha=this.gridView.Ej,Ca=this.gridView.Lp;return!!Ha&&f.a.all(ua,Ga=>Ha.contains(Ga))&&f.a.all(ua,Ga=>!Ca.dDb(Ga))}SWg(ua){if(500<n.b(ua))return!1;const Ha=this.Hh.Ce;ua=this.gridView.hba("StatusBarAggregateManager.AreAllCellsEmpty",ua);try{for(let Ca=0;ua.$$mn();Ca++)if(ua.$$cu().LL||!(Ca%25)&&100<B.c(this.Hh,Ha))return!1}finally{ua&&ua.dispose()}return!0}ywa(ua){return this.Eta.ywa(ua)}qIj(ua,Ha,Ca){this.Eta.CMg(ua,"Query"+
Ha+"Label","Query"+Ha+"Button",Ca.toString())}tmg(){var ua;if(this.$.Nd&4&&!this.gridView.jb&&!this.gridView.ni){var Ha;({P4b:Ha}=X.Ykg(this.ga.qa.selectedRanges)).returnValue?this.GOb(Ha):(this.GOb(null),this.qkf?(null===(ua=this.calcManager)||void 0===ua?0:ua.sjc)?this.Zyj():this.Yyc():this.VFc=y.AsyncMethodContext.Oq(this.yYj,500,A.a.JUj,this.VFc))}}Zyj(){this.WFc=y.AsyncMethodContext.Oq(()=>this.Zkg(!1),ea,A.a.KUj,this.WFc)}Yyc(){this.XFc=y.AsyncMethodContext.Oq(this.x1f,500,A.a.IUj,this.XFc)}dDe(){this.zdc&&
(this.b4.gv(this.zdc.xu),this.zdc=null)}HHi(ua,Ha){const Ca={};Ca.a=this.$.xa.UserSessionId;Ca.b=ua;Ca.c=Ha;G.b().gf(29,Ca)}static initData(){const ua=m.a.N$;for(const Ha of ha)ua(Ha.kVa,F.a.Qg,0,0)}static la(ua){X.initData();const Ha=new X(ua);ua.Ia.p3(Ha);ua.da.Ha(27,Ha)}static Ykg(ua){return{returnValue:1===ua.length&&ua[0].isSingle,P4b:null}}}Object(t.a)(X,"StatusBarAggregateManager",null,[822,2,229,230,233]);a.d(C,"a",function(){return T});const T=()=>{c.a.Fa(ua=>{ua.da.kb(29,()=>{X.la(ua)})})}},
1266:function(t,C,a){t=a(0);var c=a(14),b=a(228),f=a(36),e=a(92),d=a(29),h=a(84),r=a(553),l=a(9),u=a(52),v=a(7),x=a(174),w=a(73),m=a(304),n=a(134),z=a(45),y=a(33),A=a(13),F=a(12),D=a(110),B=a(21),M=a(320),R=a(135),P=a(381);class E{constructor(Q){this.E7a=this.pic=0;this.t5b=null;this.Llf=!1;this.$=Q;this.Llf=Q.ymc}Yui(){return B.h(this.$).jb?(c.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.ub.$w?(c.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}CYi(Q){this.t5b=new Sys.UI.Point(Math.round(Q.nwa.center.x),Math.round(Q.nwa.center.y));this.pic=f.a(this.$).zoom;this.E7a=Q.nwa.scale;let Y={["InitialZoom"]:this.pic,["Location"]:"canvas",["InputMethod"]:Q.Cb};R.b(this.$).rd(n.a.eaj,Y);c.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.t5b.x},${this.t5b.y}), initial zoom ${this.pic}, initial scale ${this.E7a}`);
this.V$a(Q,"onGestureStart");return!0}BYi(Q){if(!this.E7a)return c.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.V$a(Q,"OnGestureEvent"),!0;if(!isFinite(this.E7a))return c.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.E7a}`),this.V$a(Q,"OnGestureEvent"),!0;const Y=Q.nwa.scale/this.E7a*this.pic;f.a(this.$).Srg(Y,this.t5b);c.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${Y}. Current scale ${Q.nwa.scale}`);this.V$a(Q,"OnGestureEvent");return!0}AYi(Q){f.a(this.$).Trg();c.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.V$a(Q,"OnGestureEnd")}zYi(Q){c.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.V$a(Q,"OnGestureCancel")}V$a(Q,Y){var la,ea,ha;this.Llf&&(c.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${Y},        eventArgs non-null: ${isNullOrUndefined(Q)}, gestureData non-null: ${isNullOrUndefined(null===
Q||void 0===Q?void 0:Q.nwa)},        srcEvent non-null: ${isNullOrUndefined(null===(la=null===Q||void 0===Q?void 0:Q.nwa)||void 0===la?void 0:la.srcEvent)}`),null===(ha=null===(ea=null===Q||void 0===Q?void 0:Q.nwa)||void 0===ea?void 0:ea.srcEvent)||void 0===ha?void 0:ha.preventDefault())}}Object(t.a)(E,"PinchToZoomAdapter",null,[363]);var H=a(40);class G extends H.a{constructor(){super()}Bue(Q){this.addHandler("ZCIEK",Q)}Q_f(Q){this.removeHandler("ZCIEK",Q)}F_c(Q){this.addHandler("ZCUIK",Q)}POd(Q){this.removeHandler("ZCUIK",
Q)}Fhj(){this.raiseEvent("ZCIEK")}Ehj(){this.raiseEvent("ZCUIK")}Ghj(){this.raiseEvent("ZCEK")}}Object(t.a)(G,"ZoomEventManager",H.a,[361]);var N=a(23),I=a(90);class O extends H.a{constructor(Q){super();this.statusBarManager=null;this.z1e=!1;this.$=Q;this.$.da.kb(29,Y=>{this.statusBarManager=Y;Y.OJ(this)})}Iq(Q){this.addHandler("Zoom",Q)}gr(Q){this.removeHandler("Zoom",Q)}Uz(){this.Qn("QueryZoomStatus")&&this.raiseEvent("Zoom")}ns(Q,Y){return"QueryZoomStatus"!==Q?!1:this.Sei(Y)}Qn(){return f.a(this.$).bT()}dispose(){this.statusBarManager&&
(this.statusBarManager.fG(this),this.statusBarManager=null);this.$=null;super.dispose()}kbf(Q){Q=this.dbi(Q);if(!Q)return null;Q=Q.getElementsByClassName("cui-ctl-mediumlabel");return 1!==Q.length?(c.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):Q[0]}Sei(Q){if(!this.$)return!1;const Y=f.a(this.$).$Sb;let la=!1;if(y.a.Pn())N.a.equals(appChrome.selectors.getControlLabel(I.a.zoomStatusBarMenuOpen),Y,!1)||(la=!0);else{const ea=this.kbf("HandleQueryZoomStatusCommand");
ea?N.a.equals(Q.LabelText.toString(),Y,!1)||(ea.innerText="",la=!0):la=!0}la&&this.QFj(Q,Y);return!0}QFj(Q,Y){Q.LabelText=Y;y.a.Pn()&&(Q.Visible=!0)}dbi(Q){var Y=A.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!Y)return Y=(Y=this.$.ea.nc)?Y.inEmbedView:!1,d.a.yp||Y||c.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${Q}`),null;this.z1e||(this.z1e=!0,c.ULS.sendTraceTag(537149762,
0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${Q}`));return Y}}Object(t.a)(O,"ZoomStatusBarManager",H.a,[2,229,230]);class U extends r.a{constructor(Q){super(Q);this.zoomEventManager=this.Sya=this.IEb=null;this.NEb=-1;this.Klf=!1;this.$c=()=>{this.NEb=-1};c.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Fib=new O(Q);this.faj()&&(c.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.fYg());this.$mj()}dispose(){this.Fib&&
(e.a.Ja(this.Fib),this.Fib=null);this.zoomEventManager&&(this.$.da.TU(419),this.zoomEventManager=null);this.Klf&&this.Cqh();super.dispose()}bT(){return!0}Srg(Q,Y){Q=this.vLa(Q);if(B.h(this.$).rtl){const la=Math.round(A.DOMElementExtensions.getBounds(this.$.Df).width*f.a(this.$).zoom);this.IEb=new Sys.UI.Point(la-Y.x,Y.y)}else this.IEb=Y;this.FTa(Q,!1,"ZoomWithPinch")}pIc(){return!0}oIc(Q,Y){var la=d.a.isMac?.07:.15;Q=this.zoom+(Q?la:-la);Q=this.vLa(Q);B.h(this.$).rtl?(la=Math.round(A.DOMElementExtensions.getBounds(this.$.Df).width*
f.a(this.$).zoom),this.Sya=new Sys.UI.Point(la-Y.x,Y.y)):this.Sya=Y;Y=this.zoom;this.FTa(Q,!0,"ZoomWithMouse");Y={["InitialZoom"]:Y,["FinalZoom"]:Q,["Location"]:"canvas"};R.b(this.$).rd(n.a.Gdk,Y)}Trg(){this.IEb=null}qIc(Q,Y){this.FTa(this.vLa(Q),!1,Y?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Urg(Q){isNaN(Q)?c.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.FTa(this.vLa(Q),!1,"ZoomToLevelInExcelLive")}rIc(Q,Y){this.FTa(this.vLa(Q),
!0,Y?"ZoomWithShortcuts":"ZoomWithButtons")}$9e(Q,Y){const la=B.h(this.$).rtl,[ea,ha]=this.Bkd(la),[X,T]=this.omd(Q,ha);return this.Sya?(Q=this.jkd(this.Sya,Q,Y,ha,ea,"ZoomWithMouse"),this.Sya=null,Q):this.IEb?this.jkd(this.IEb,Q,Y,ha,ea,"ZoomWithPinch"):B.h(this.$).ga.Ra.YV?this.Fdk(Q,Y,ha,ea,X,T,B.h(this.$).rtl):this.Hdk(Q,Y,ha,ea,X,T,B.h(this.$).rtl)}K5f(Q,Y,la){if(Q){c.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${Q.x} ${Q.y}) (new top-left) from zoom:${Y} to zoom:${la}`);Q=new u.a(Q.x,Q.y);la=
B.h(this.$).rtl;[,la]=this.Bkd(la);const [ea,ha]=this.omd(Y,la);B.h(this.$).dve(Q,ea,ha,"ApplicationZoom")}else c.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${Y} to zoom:${la}`)}zoomFitToScreen(){const Q=this.zoom;var Y=B.h(this.$).rtl;const [la,ea]=this.Bkd(Y),[ha,X]=this.omd(Q,ea);var T=B.h(this.$).ga.Ra.YV;(Y=T?this.X5e(this.$Qa,ha,X,!1):this.i$e(this.$Qa,ea,la,ha,X,Y,!1))?(Y=Math.min(ha/(Y.width+100),X/(Y.height+100)),Y=this.lNh(Y),this.FTa(Y,!0,"ZoomWithFitToScreen"),T?B.h(this.$).ga.Ra.nua(B.h(this.$).ga.Ra.oc,
!1):(T=z.v(B.h(this.$).ga.qa.activeRange,this.$),B.h(this.$).Bg(T,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.NEb=Q,this.Klf||this.cYg()):c.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${T}`)}zoomFitToScreenUndo(){this.FTa(this.NEb,!1,"ZoomWithFitToScreen")}uWd(){return-1!==this.NEb}cYg(){const Q=B.h(this.$);Q&&(Q.ga.IC(this.$c),Q.OE(this.$c))}Cqh(){const Q=B.h(this.$);Q&&(Q.ga.UB(this.$c),Q.hG(this.$c))}lNh(Q){Q=Math.min(Q,
l.a.wNi);Q=Math.max(Q,l.a.mOi);return Math.round(100*Q)/100}FTa(Q,Y,la){if(this.mIc()){var ea=B.h(this.$).view.visibleArea.toString();Q=this.vLa(Q);var ha=w.d(this.$.ua.na);ha||(ha=r.a.ZAf);B.h(this.$).nh.v1(5,M.a.lIc,la);B.h(this.$).nh.dna(M.a.lIc,this.$.ea.Ee);c.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${Q} to sheet ${ha} origin ${la} prevZoom ${this.zoom}`);this.JIj(ha,Q);this.zoomEventManager.Ghj();this.S0j(la);this.c1j(Y);this.NEb=-1;P.b(this.$,la);Q=B.h(this.$).view.visibleArea.toString();
c.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${ea}, NewGridVisibleArea: ${Q}, IsShyRibbonActive: ${this.$.P_}`)}}RWh(Q){return(Q=F.HelperMethods.sD(this.$.Df,this.$.domElement,Q))?Q:new Sys.UI.Point(0,0)}Bkd(Q){const Y=this.RWh(Q);Q=this.B0h(Y,Q);return[Y,Q]}omd(Q,Y){const la=A.DOMElementExtensions.getBounds(this.$.Df);return[Math.round((la.width-Y.x)*Q),Math.round((la.height-Y.y)*Q)]}B0h(Q,Y){Y=F.HelperMethods.sD(B.h(this.$).domElement,this.$.domElement,Y);return Y?
(Q=new Sys.UI.Point(Math.round(Y.x-Q.x),Math.round(Y.y-Q.y)),Q):new Sys.UI.Point(0,0)}Hdk(Q,Y,la,ea,ha,X,T){return(T=this.i$e(Q,la,ea,ha,X,T))?this.V8e(T,Q,Y,la,ea,ha,X):null}i$e(Q,Y,la,ea,ha,X,T=!0){var ua=z.G(B.h(this.$).ga.qa.selectedRanges);if(T&&(ua=ua.ze(z.G(B.h(this.$).Ufc())),!ua))return c.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const Ha=B.h(this.$).Ob(ua.topLeft);ua=B.h(this.$).Ob(ua.bottomRight);if(!Ha||!ua)return c.ULS.sendTraceTag(537149776,
0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;Q=Ha.cell.lR===ua.cell.lR&&Ha.cell.kR===ua.cell.kR?this.HVh(Q,ua,Y,la,ea,X):this.Q$h(Q,Ha,ua,Y,la,ea,X);return Q?T?this.i0e(Q,ea,ha):Q:(c.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}i0e(Q,Y,la){if(0>Q.x||Q.x>Y)Q.x=0;if(0>Q.y||Q.y>la)Q.y=0;Q.x+Q.width>Y&&(Q.width=Y-Q.x);Q.y+Q.height>la&&(Q.height=la-Q.y);return Q}Q$h(Q,
Y,la,ea,ha,X,T){Y=B.h(this.$).getCellBounds(Y.cell);if(!Y)return null;const ua=B.h(this.$).getCellBounds(la.cell);if(!ua)return null;let Ha=ha.x;T&&(Ha=0,Y.x=Math.round(X/Q)-Y.x-Math.round(Y.width),ua.x=Math.round(X/Q)-ua.x-Math.round(ua.width));Q=new Sys.UI.Bounds(Math.round((Y.x-ea.x)*Q)-Ha,Math.round((Y.y-ea.y)*Q-ha.y),Math.round((ua.x+ua.width-Y.x)*Q),Math.round((ua.y+ua.height-Y.y)*Q));la=la.cell.getRange();c.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${la.top}, b:${la.bottom}, r:${la.right}, l:${la.left}) in bounds (${Q.x}, ${Q.y}, ${Q.width}, ${Q.height})`);
return Q}HVh(Q,Y,la,ea,ha,X){const T=B.h(this.$).getCellBounds(Y.cell);if(!T)return null;let ua=ea.x;X&&(ua=0,T.x=Math.round(ha/Q)-T.x-Math.round(T.width));Q=new Sys.UI.Bounds(Math.round((T.x-la.x)*Q)-ua,Math.round((T.y-la.y)*Q-ea.y),Math.round(T.width*Q),Math.round(T.height*Q));Y=Y.cell.getRange();c.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${Y.top}, l:${Y.left}) in bounds (${Q.x}, ${Q.y}, ${Q.width}, ${Q.height})`);return Q}Fdk(Q,
Y,la,ea,ha,X){const T=this.X5e(Q,ha,X);return T?this.V8e(T,Q,Y,la,ea,ha,X):null}V8e(Q,Y,la,ea,ha,X,T){Q=new Sys.UI.Point(this.z9e(X,Q.x,Q.width),this.z9e(T,Q.y,Q.height));return this.jkd(Q,Y,la,ea,ha)}z9e(Q,Y,la){return Q===la?(c.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),Q/2):Q*Y/(Q-la)}X5e(Q,Y,la,ea=!0){const ha=B.h(this.$).ga.Ra.oc.domElement;var X=F.HelperMethods.sD(ha,B.h(this.$).domElement,B.h(this.$).rtl);
if(!X)return c.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const T=B.h(this.$).vzb();X=new Sys.UI.Point(Math.round((X.x-T.topLeft.x)*Q),Math.round((X.y-T.topLeft.y)*Q));Q=new Sys.UI.Bounds(X.x,X.y,Math.round(ha.offsetWidth*Q),Math.round(ha.offsetHeight*Q));return ea?this.i0e(Q,Y,la):Q}uBf(){this.Fib.Uz()}RRi(Q){"ZoomToLevelInExcelLive"===Q?this.zoomEventManager.Fhj():this.zoomEventManager.Ehj()}$mj(){this.zoomEventManager=this.$.da.Ha(419,
new G)}jkd(Q,Y,la,ea,ha,X=""){var T=B.h(this.$).rtl?0:ha.x;ha="ZoomWithPinch"===X||"ZoomWithMouse"===X?new Sys.UI.Point(Q.x-T-Math.round(ea.x*Y),Q.y-ha.y-Math.round(ea.y*Y)):Q;ha=new Sys.UI.Point(Math.round(ha.x/Y),Math.round(ha.y/Y));c.ULS.shipAssertTag(537149770,0,!!Y,"Original zoom level must be different than 0");T=la/Y;ha=new Sys.UI.Point(Math.round(ha.x*(1-1/T)),Math.round(ha.y*(1-1/T)));"ZoomWithMouse"===X||"ZoomWithPinch"===X?(ha.x+=Math.round((ea.x-B.h(this.$).Qr)*(T-1)),ha.y+=Math.round((ea.y-
B.h(this.$).$J)*(T-1))):(T=Math.round(ea.x*(la-Y)),0<T&&ha.x>T&&(ha.x+=T),Y=Math.round(ea.y*(la-Y)),0<Y&&ha.y>Y&&(ha.y+=Y));"ZoomWithMouse"===X&&(Q.x||(ha.x=0),Q.y||(ha.y=0));Q=B.h(this.$).vzb();return new Sys.UI.Point(ha.x+Q.topLeft.x,ha.y+Q.topLeft.y)}fYg(){const Q=[];h.a.instance.$b("Common.IGestureInputManager").execute(Y=>{0===Y.Z_h()&&Y.Blj(document.body,new E(this.$),Q)})}faj(){return this.mIc()&&(d.a.Lo&&d.a.UNa(67)||this.$.ymc)}JIj(Q,Y){P.a(this.$)?this.setZoomLevel(Q,Y,this.l5d,l.a.Duc):
this.setZoomLevel(Q,Y,this.zoomPerSheetId,this.$Qa)}setZoomLevel(Q,Y,la,ea){la.remove(Q);Y!==ea&&la.add(Q,Y)}S0j(Q){this.U9f();this.$.YAa(m.a.f_("TriggerImmediateZoomOperations"));this.n9j();this.RRi(Q)}n9j(){this.$yi()?this.$.zf():this.Fib.Uz();const Q=this.Fib.kbf("UpdateZoomStatusBar");Q&&(Q.innerText=this.$Sb)}$yi(){const Q=x.a(this.$);return Q?Q.Fp.oA===(y.a.zOa(this.$)?v.a.vvc:this.$.Ib+v.a.l3f):!1}c1j(Q){B.h(this.$).Edk(Q);this.fUg()}fUg(){const Q=D.a(this.$);if(Q)for(const Y of B.h(this.$).Ca.uy()){if(!Y){c.ULS.sendTraceTag(537149768,
0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!Y.qk)continue;const la=Y.Wi;if(la)for(let ea=0;ea<la.count;ea++)if(2===la.mg(ea).type){const ha=Q.Hr(la.mg(ea).lh());ha?(ha.Mfa(!1),c.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):c.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else c.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}
Object(t.a)(U,"ZoomManager",r.a,[]);a.d(C,"a",function(){return ca});class ca extends b.a{constructor(Q){super();this.$=Q;this.Mb()}create(){const Q=new U(this.$);this.p9j(Q);this.$.da.Ha(368,Q);this.vb(Q)}p9j(Q){const Y=f.a(this.$);if(Y){var la=Y.tmd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");Q.MUd(la);Q.Syc(Y.RFc)}else c.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static la(Q){Q.da.Ha(369,
new ca(Q))}}Object(t.a)(ca,"ZoomManagerFactory",b.a,[])},1271:function(t,C,a){t=a(0);var c=a(983),b=a(6);class f{}Object(t.a)(f,"LokiTokenResult",null,[]);class e{constructor(v){this.SXb=v}$jd(){const v=this.q2h();return v?e.Ttd?new Promise((x,w)=>{this.SXb.continueWith(()=>{this.SXb.Ah||this.SXb.Tf?w(Error.create("Error downloading auth library")):this.SXb.result.JL("Loki",v).then(m=>{m=b.AFrameworkApplication.fa.ra("ForceLokiFallbackToACLPTokenIsEnabled")?this.t2h():m.IsSuccess&&m.Token?Object.assign(new f,
{isSuccess:!0,token:m.Token,errorMessage:null}):Object.assign(new f,{isSuccess:!1,token:null,errorMessage:JSON.stringify(m)});x(m);return m})})}):Promise.resolve(Object.assign(new f,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new f,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",c.a.n3e())}))}t2h(){const v=b.AFrameworkApplication.fa.Wa("LokiUserDataSignature")||
"";return Object.assign(new f,{isSuccess:!0,token:v,errorMessage:null})}q2h(){let v=null;const x=c.a.Ddc();2===x?v=b.AFrameworkApplication.fa.Wa("LokiAADAppId"):1===x&&(v=b.AFrameworkApplication.fa.Wa("LokiMSAAppId"));return v}static get Ttd(){return b.AFrameworkApplication.fa.ra("IsO365CommercialHost")||b.AFrameworkApplication.fa.ra("IsO365ConsumerHost")}}Object(t.a)(e,"LokiTokenManager",null,[795]);var d=a(260),h=a(84),r=a(527);class l{get name(){return"Common.App.LivePersonaUtils"}init(){h.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}ki(v){v.register(e,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").zc().Gc(()=>new e(r.a.wq(v.$b("Common.App.OAuth.IOAuthManager"))))}static main(){d.a.instance.dj(new l)}}Object(t.a)(l,"LivePersonaUtilsPackage",null,[4,5]);a.d(C,"a",function(){return u});const u=()=>{Type.registerNamespace("Common.App.LivePersonaUtils");l.main()}},1272:function(t,C,a){t=a(0);var c=a(576),b=a(573),f=a(569),e=a(1027);class d{gkh(B,M){if(B&&!(1>B.length)&&M){var R=Object.assign(new f.a,{ExternalId:"msPresenceOuter",
ControlList:[]});this.Fhh(B,R.ControlList);M.push(R)}}Fhh(B,M){const R=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(M,R);M=Object.assign(new f.a,{Title:"",ControlList:[]});Array.add(R.Menu.MenuSectionList,M);this.Mjh(B,M.ControlList)}Mjh(B,M){for(let R=0;R<B.length;R++){const P=Object.assign(new e.a,{ExternalId:String.format("CoauthorPersona_{0}",
R),Command:"336231556",DisplayName:B[R].userName,LabelText:B[R].userName,ImageBackColor:B[R].color,PersonaId:B[R].email,IsAnonymous:B[R].isAnonymous});Array.add(M,P)}}}Object(t.a)(d,"PresenceContextMenuSectionBuilder",null,[944]);var h=a(88),r=a(6),l=a(188),u=a(572),v=a(113),x=a(143),w=a(92),m=a(84),n=a(112),z=a(26);class y{constructor(B,M,R,P){this.d8d=this.j2=this.jj=this.tE=this.A9=null;this.XZb=B;this.ZHg=P;this.XZb.MNa&&(this.jj=new v.a(3,2,5E3,Object(h.a)(this,this.QYg,"authenticationCheckTask"),
2),r.AFrameworkApplication.ji.Kf(this.jj),this.Pg(M,R));this.XZb.Mpb(()=>{this.jDf()});this.XZb.B_a(()=>{this.kDf()})}get businessBar(){return this.j2||(this.j2=m.a.instance.yg("CommonUI.IBusinessBar"))}get qBe(){return this.d8d||(this.d8d=m.a.instance.yg("CommonUI.IBusinessBarEntryFactory"))}Pg(B,M){const R=r.AFrameworkApplication.xb;R.Ne(z.a.authenticationLost,n.a.frame,B,96);R.Ne(z.a.aze,n.a.frame,M,96);R.Wb(z.a.lDe,n.a.frame,l.ActionManager.yad);R.Wb(z.a.mDe,n.a.frame,l.ActionManager.yad);R.Wb(z.a.Oxd,
n.a.frame,l.ActionManager.yad)}jDf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);r.AFrameworkApplication.xb.processAction(z.a.authenticationLost,2)}kDf(){this.DXj();r.AFrameworkApplication.xb.processAction(z.a.aze,2)}QYg(){this.XZb.authenticationCheck()}DXj(){this.tE&&(this.tE.hide(),this.tE.dispose(),this.tE=null);this.A9&&this.businessBar&&(r.AFrameworkApplication.ug||this.businessBar.removeEntry(this.A9),this.A9.dispose(),this.A9=null)}showDialog(B){w.a.Ja(this.tE);this.tE=new x.StandardDialog;
this.ZHg||(this.tE.Ot=!1,this.tE.Xb=0);this.tE.yc(1,CommonUIStrings.l_SignIn);this.tE.FS(CommonUIStrings.l_DefaultDialogTitle,B,Object(h.a)(this,this.Gu,"dialogHandler"))}Gu(B){1===B?(u.a.L7(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),r.AFrameworkApplication.xb.processAction(z.a.Oxd,2)):(this.$fb(),r.AFrameworkApplication.xb.processAction(z.a.mDe,2))}$fb(){this.businessBar&&this.qBe&&(this.A9=this.qBe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,
null),this.A9.closeable=!0,this.A9.addButton(CommonUIStrings.l_SignIn,y.l3g,""),this.A9.Paa=Object(h.a)(this,this.n3g,"businessBarEntryCloseHandler"),this.businessBar.JE(this.A9,!1))}n3g(){this.yrh();r.AFrameworkApplication.xb.processAction(z.a.lDe,2)}yrh(){this.jj&&(r.AFrameworkApplication.ji.np(this.jj),this.jj=null)}dispose(){this.jj=this.tE=this.A9=null}static l3g(){u.a.L7();r.AFrameworkApplication.xb.processAction(z.a.Oxd,2)}}Object(t.a)(y,"SignOutResponseUI",null,[2]);var A=a(260);class F{get name(){return"Common.App.UI"}ki(B){B.register(d,
"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").zc()}init(){}dispose(){w.a.Ja(F.X2);F.X2=null}static main(){A.a.instance.dj(new F)}}F.X2=null;Object(t.a)(F,"CommonAppUIPackage",null,[4,5]);a.d(C,"a",function(){return D});const D=()=>{Type.registerNamespace("CAUI");F.main()}},1283:function(t,C,a){t=a(0);var c=a(92),b=a(228),f=a(53),e=a(39),d=a(233),h=a(14),r=a(34),l=a(6),u=a(86),v=a(387),x=a(80),w=a(380),m=a(199),n=a(98),z=a(258),y=a(1),A=a(23),
F=a(293);class D{constructor(G){this.$=G}get Dlf(){return this.$.workbookContext.FileCoauthorable}get NCb(){return!1}get Lxb(){return this.$.ea.amIAlone}get mQe(){if(this.Lxb)return!0;for(const G of this.$.ea.No)if(!G.SupportsRename)return!1;return!0}}Object(t.a)(D,"EwaCoauthManager",null,[364]);var B=a(65),M=a(74),R=a(26);class P extends u.a{constructor(G,N){super();this.Aea=this.ROd=this.S_f=this.r$c=null;this.xla=()=>{var I=this.$.ea.jn;if(I&&I.WorkbookFileName){var O=r.a.Zp(I.WorkbookFileName),
U=!!A.a.compare(this.$.workbookContext.WorkbookFileName,I.WorkbookFileName,!1),ca=y.EwaSettings.ya(465)&&!!I.BreadcrumbFolderUrl&&!!A.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,I.BreadcrumbFolderUrl,!1);if(U||ca)this.Aea={},this.Aea.NewFileName=O,this.Aea.EditDocInClientUrl=I.EditDocInClientUrl,this.Aea.DirectInvokeDAVUrl=I.DirectInvokeDAVUrl,this.Aea.DownloadACopyUrl=I.DownloadACopyUrl,y.EwaSettings.ya(465)&&I.BreadcrumbFolderUrl&&(this.Aea.BreadcrumbFolderName=I.BreadcrumbFolderName,
this.Aea.BreadcrumbFolderUrl=I.BreadcrumbFolderUrl),I=l.AFrameworkApplication.xb.ie(R.a.fileNameUpdate,2,O),this.Aea=null,h.ULS.shipAssertTag(537154064,0,32===I,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.AXi=(I,O,U)=>{this.S_f=O;this.ROd=U;this.$.Ia.Nb(new n.a(1897077126,x.a.Eb,2,3,null),{["newFileName"]:I})};this.zXi=I=>{this.Aea&&I(this.B9e(this.Aea),this.Bs)};this.sIb=I=>{z.a(I)||!I.Result?(I=P.RRh(I),M.a(this.$).ud.mM([-414480287,650565124,-782844485,
1223808266,-62451516,1636785843]),this.ROd(I)):this.S_f(this.B9e(I.Result),this.Bs)};this.j3i=()=>{this.ROd(5)};this.$=G;this.Bs=N;this.$.ea.vu(this.xla)}initialize(){l.AFrameworkApplication.vbc=this.AXi;l.AFrameworkApplication.dLa=this.zXi;this.r$c=l.AFrameworkApplication.wz;l.AFrameworkApplication.wz=new D(this.$)}dispose(){l.AFrameworkApplication.vbc=null;l.AFrameworkApplication.dLa=null;this.$.ea.$v(this.xla);l.AFrameworkApplication.wz=this.r$c;this.$=this.r$c=null;super.dispose()}renameFile(G,
N){const I=G.newFileName;if(I&&(G=r.a.Zp(this.$.workbookContext.WorkbookFileName),!y.EwaSettings.isChangeGateEnabled("OfficeVSO:7439298_CompareNewFileNameForRenameOperation")||A.a.compare(G,I,!1))){const O=this.$.pa.va.ic();w.a(this.$.userOperationManager,(U,ca,Q)=>{var Y=this.$.pa.va;U=F.b(U,this.sIb);ca=F.a(ca,this.j3i);const la=Y.Oa(9,O);la.newFileName=I;return B.g(Y,"RenameFile",la,U,ca,Q,null,0)},U=>new m.a(134,0,U),N)}}Fsi(){return 32===l.AFrameworkApplication.xb.processAction(R.a.aja,1)}B9e(G){var N=
this.$.workbookContext;l.AFrameworkApplication.LZ=G.DownloadACopyUrl;const I=y.EwaSettings.ya(465)&&!!G.BreadcrumbFolderUrl;I&&(l.AFrameworkApplication.Fm.breadcrumbFolderName=G.BreadcrumbFolderName,l.AFrameworkApplication.Fm.breadcrumbFolderUrl=G.BreadcrumbFolderUrl,N.FullDocumentInfo.BreadcrumbFolderUrl=G.BreadcrumbFolderUrl,N.FullDocumentInfo.BreadcrumbFolderName=G.BreadcrumbFolderName);N.FullDocumentInfo.BreadcrumbDocName=G.NewFileName;v.d(N,G.NewFileName);N={};N.NewName=G.NewFileName;N.DirectInvokeDavUrl=
G.DirectInvokeDAVUrl;N.EditDocInClientUrl=G.EditDocInClientUrl;I&&(N.BreadcrumbFolderName=G.BreadcrumbFolderName,N.BreadcrumbFolderUrl=G.BreadcrumbFolderUrl);N.OperationResult=0;return N}static RRh(G){switch(G.Errors[0].MessageId){case -414480287:G=2;break;case 650565124:G=1;break;case 1636785843:G=6;break;case -782844485:G=4;break;default:G=5}return G}}Object(t.a)(P,"RenameFileManager",u.a,[343,2]);var E=a(55);a.d(C,"a",function(){return H});class H extends b.a{constructor(G){super();this.wZ=this.renameFileManager=
null;this.$=G;this.Mb()}create(){if(!this.wZ){const G=d.a.T2a(E.b(),this.ka,"Task","IRenameFileManager");this.wZ=G.task;const N=f.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Na),I=f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);e.TaskExtensions.za(e.TaskExtensions.Pd([I,N],this.ka),()=>{const O=new P(this.$,N.result);this.$.da.Ha(120,O);G.setResult(O)},this.ka,3)}this.wZ.continueWith(G=>{this.vb(G.result)})}dispose(){c.a.Ja(this.renameFileManager);this.$=this.renameFileManager=
null;super.dispose()}static la(G){G.da.Ha(119,new H(G))}}Object(t.a)(H,"RenameFileManagerServiceFactory",b.a,[])},1286:function(t,C,a){t=a(0);var c=a(2),b=a(14),f=a(29),e=a(92),d=a(16),h=a(89),r=a(425),l=a(86),u=a(9),v=a(67),x=a(466);class w{constructor(ea,ha){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=ha;this.parentElement=ea}Wfh(){const ea=this.Xfh();x.a(this.$,243,242,0,ha=>{this.cardViewManager=ha;ha.ocg(this.parentElement,
2,ea)})}eff(){this.cardViewManager&&this.cardViewManager.cNa(-1,-1,this.parentElement)}Xfh(){const ea={layoutId:"AutoDetectTooltip"};ea.description=this.longDescription;ea.convertToDomainName=this.convertToDomainName;ea.longDescription=this.longDescription;ea.urlValue=this.urlValue;ea.imageAltText=this.imageAltText;ea.helpText=this.helpText;ea.helpId=this.helpId;return ea}}Object(t.a)(w,"AutoDetectCardManager",null,[]);var m=a(35),n=a(217),z=a(34),y=a(229),A=a(19),F=a(54);class D extends l.a{constructor(ea,
ha,X){super();this.od=T=>{if(T.Vb.id===this.BKa.firstChild.id){T=this.dze;const ua={};ua.Id=T.prb;this.convertToLinkedEntityManager.l7c(ua,!0,T);this.BKa.removeChild(this.BKa.firstChild);return!0}return!1};this.dze=ea;this.convertToLinkedEntityManager=ha;this.BKa=document.createElement("div");this.BKa.className="clip16x16";this.Kxa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',z.a.Jh("autodetectid"+this.dze.left),A.a.pdd,
F.a.mf(11));X.uh(this.BKa,this.Kxa);ea=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");y.a.instance.ta(d.a.click,ea,this.od)}get domElement(){return this.BKa}dispose(){if(this.BKa){const ea=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");y.a.instance.Ba(d.a.click,ea,this.od)}super.dispose()}static get r3g(){return"clip16x16"}}Object(t.a)(D,"AutoDetectColumnHeaderButton",l.a,[]);var B=a(1),M=a(1093),R=a(12),P=a(21),E=a(189);class H extends l.a{constructor(ea,
ha,X){super();this.Sb=null;this.$=ea;this.gridView=P.h(ea);this.convertToLinkedEntityManager=ha;this.Sb=X;this.Y5c=new E.a}dispose(){super.dispose()}Vrh(ea){for(let ha of this.gridView.Xia)for(let X of ha){const T=X,ua=T.Pt,Ha=M.a(T.C5);this.zMg(ea,Ha,ua);T.TTd(Ha)}}zMg(ea,ha,X){if(ha.length){var T=X.length;X[T-1]<ea.left||(X=R.HelperMethods.Ux(new n.a(X),0,T,ea.left,R.HelperMethods.WF),0>X||!(ha=ha[X]))||(this.gridView.rtl?ha.classList.add(m.a.PFh):ha.classList.add(m.a.OFh),this.Y5c.nb(ea.left)||
this.Y5c.add(ea.left,new D(ea,this.convertToLinkedEntityManager,this.Sb)),ea=this.Y5c.ma(ea.left).domElement,!ha.getElementsByClassName(D.r3g).length&&this.TSj(ha)&&ha.appendChild(ea))}}TSj(ea){const ha=parseInt(ea.style.width,10);var X=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";X=H.Jhh(X);ea=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.Sb.C7h(ea.firstChild.innerHTML),X,!0,B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<
ha-(ha/2+ea/2)?!0:!1}static Jhh(ea){return`${"normal"} ${"normal"} ${ea} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(t.a)(H,"AutoDetectColumnHeaderManager",l.a,[]);var G=a(435),N=a(25),I=a(73),O=a(155),U=a(13),ca=a(15),Q=a(154),Y=a(68);a.d(C,"a",function(){return la});class la extends l.a{constructor(ea,ha,X,T,ua){super();this.isMac=f.a.isMac;this.j_a=-1;this.s8b=null;this.Rua=-1;this.FN=this.Jmc=this.xXd=this.Y_=this.eze=!1;this.nU=null;this.Ze=()=>{this.Uxa&&
this.gridView&&this.DX()};this.Dc=()=>{this.Uw()};this.od=()=>{this.DJa();P.h(this.$).pg(!0,!1)};this.Uda=(Ca,Ga)=>{Ga?(this.Amg(this.s8b),this.fgb()):(Ca=[29],this.gridView.Jb.ik(Ca),this.gridView.Jb.Mk(null,Ca),this.nU&&this.nU.eff())};this.Kk=()=>{this.R8a()&&this.Kh.hide();1===this.gridView.ga.Se&&this.DX()};this.UR=()=>{const Ca=this.gridView.ga.Se;this.gridView.ga.qa.activeCell&&1===Ca&&this.DX()};this.onKeyUp=Ca=>this.WEb?this.Y_?!1:17===Ca.Da.keyCode&&this.xXd?(this.FN?(this.fgb(),this.Sea()):
this.rOb(),!0):!1:this.Y_=!1;this.onKeyDown=Ca=>{if(!this.WEb)return this.Y_=!1;this.xXd=!1;this.Y_=Ca.ctrlKey;switch(Ca.Da.keyCode){case 27:return this.FN?(this.Uda(null,!1),this.Sea()):this.nU&&(this.nU.eff(),this.rOb()),!0;case 13:if(this.FN)return this.FN=!1,this.DJa(),!0;break;case 17:return this.xXd=!0}return!1};const {AutoDetectActionButton:Ha}=a(1382);this.$=ea;this.qrb=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);ha||b.ULS.sendTraceTag(537166983,
0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=T;T.MJb();this.Kh=new Ha(ea,ha,this.od,X,"");this.UYg=new H(this.$,T,ua);this.gridView=P.h(this.$);this.gridView.ga.QJ(this.Ze);this.gridView.hc.D_a(this.Ze);this.gridView.vv(this.UR);ea.wj(this.Dc);ea.GC(this.Kk);this.gridBlockManager=Object(h.a)(730,this.gridView.Ca);this.Mo=ea.frame.hu;this.DX()}get rc(){return this.Kh.domElement(1)}get WEb(){const ea=this.Kh.domElement(la.Rfa);return ea?
U.DOMElementExtensions.isVisible(ea):!1}get Uxa(){return this.$.isEditMode&&B.EwaSettings.ya(128)&&B.EwaSettings.ya(131)&&(new O.a(this.$.ua)).di?!1:-1!==this.Rua}dispose(){this.gridView&&this.gridView.ga.LI(this.Ze);if(this.$){const ea=this.$;ea.ll(this.Dc);ea.gG(this.Kk);P.h(ea).My(this.UR)}e.a.Ja(this.Kh);this.Mo=this.$=this.gridView=this.Kh=null;super.dispose()}Uw(){this.Uda(null,!1);this.j_a=-1;this.Kh.hide();this.D3j();this.FN=!1}Sea(){this.Kh.getButton(la.Rfa).meb();this.FN=!1}rOb(){this.Kh.getButton(la.Rfa).GJb();
this.Amg(this.s8b);this.FN=!0;this.$.da.kb(211,ea=>{ea.QRa(ca.a.instance.ha(1751))})}onAutoDetectUIShown(){if(this.Uxa&&-1!==this.j_a)this.convertToLinkedEntityManager.onAutoDetectUIShown()}VYg(ea){var ha=new N.Range(1===ea.top?1:ea.top-1,ea.left,ea.bottom,ea.right,!0,!1);ha=this.gridView.getRangeInformation(ha);for(const X of ha)if(Object(r.a)(G.AutoDetectRange,X)&&this.vjc(ea,!1,X))return!0;return!1}DJa(){if(this.Uxa&&-1!==this.j_a){this.Kh.getButton(la.Rfa).GJb();var ea={};ea.Id=this.Rua;ea.StringId=
null;this.convertToLinkedEntityManager.l7c(ea,!0,this.s8b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");ea=[Object(c.a)(new Y.a,{name:"Domain",int64:this.Rua})];Q.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,ea);this.Rua=-1}}$Uh(){let ea=ca.a.instance.ha(1747);if(-1!==this.Rua){ea+=" ";try{ea+=this.convertToLinkedEntityManager.rEb(this.Rua.toString())}catch(ha){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.Rua}`)}}ea+=
" ";return ea=this.qrb?ea+ca.a.instance.ha(1750):ea+ca.a.instance.ha(this.isMac?1749:1748)}fgb(){this.qrb&&(this.nU||(this.nU=new w(this.rc,this.$),this.nU.convertToDomainName=ca.a.instance.ha(1752),this.nU.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.nU.imageAltText=ca.a.instance.ha(1754),this.nU.helpId="HID_DataTypes_Wolfram",this.nU.helpText=ca.a.instance.ha(1753)),this.nU.longDescription=this.convertToLinkedEntityManager.s0d(this.j_a.toString()),
this.nU.Wfh())}vjc(ea,ha,X){if((new N.Range(X.top,X.left,X.bottom===u.a.Fg?X.bottom:X.bottom+1,X.right,!0,!1)).xd(ea)){if(ha){if(X&&X.prb!==this.j_a){this.j_a=X.prb;ea=X.prb.toString();ha=this.qrb?"":this.convertToLinkedEntityManager.s0d(ea);const T=this.convertToLinkedEntityManager.gji(ea);this.Kh.gib(this.convertToLinkedEntityManager.rEb(ea),ha,T,la.Rfa)}this.Rua=X.prb;this.s8b=X}return!0}return!1}DX(){if(this.convertToLinkedEntityManager){var ea=this.gridView.ga.Se;if(this.gridBlockManager&&this.gridBlockManager.Gnd){var ha=
this.gridView.ga.qa.activeCell,X=!this.gridBlockManager.rs(ha),T=this.gridView.getRangeInformation(this.gridView.Ej);for(const ua of T)if(Object(r.a)(G.AutoDetectRange,ua))switch(T=ua,T.M8g){case 3:if(this.vjc(ha,!0,T)){if(1!==ea||X){this.Uw();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.VMd();this.Kh.sCa(ha,this.Uda);this.eze||(this.eze=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",
!1)||B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.UYg.Vrh(T);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Uw()}}Amg(ea){const ha=[29];this.gridView.Jb.Mk(ea,ha);this.gridView.Jb.jr(ha)}R8a(){return this.$.ea.isNamedObjectViewMode&&I.f(this.$.na)}VMd(){this.qrb&&!this.Jmc&&this.Mo&&(this.Mo.Js(d.a.fc,this.$.domElement,this.onKeyDown,!0),this.Mo.Js(d.a.Vd,
this.$.domElement,this.onKeyUp,!0),this.Jmc=!0)}D3j(){this.qrb&&this.Jmc&&this.Mo&&(this.Mo.Us(d.a.fc,this.$.domElement,this.onKeyDown,!0),this.Mo.Us(d.a.Vd,this.$.domElement,this.onKeyUp,!0),this.Jmc=!1)}static get Rfa(){return 1}static fXh(ea){return ca.a.instance.ha(1808)+v.a.space+ea}}Object(t.a)(la,"AutoDetectManager",l.a,[])},1291:function(t,C,a){var c=a(10);t=a(0);var b=a(228),f=a(14),e=a(40),d=a(1);class h extends e.a{constructor(){super()}X0d(v,x){f.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${v}, TriggerType: ${x}`);
if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(x){case 0:this.raiseEvent("pssort",void 0,v);break;case 1:this.raiseEvent("psfilter",void 0,v);break;case 2:this.raiseEvent("pscrttbl",void 0,v)}}}Object(t.a)(h,"ProactiveSuggestionManager",e.a,[516]);var r=a(721);class l extends b.a{constructor(v){super();this.$=v;this.Mb()}create(){let v=Object(r.a)(this.$.da,476,()=>new h);this.vb(v)}static la(v){v.da.Ha(475,new l(v))}}Object(t.a)(l,
"ProactiveSuggestionManagerFactory",b.a,[]);a.d(C,"a",function(){return u});const u=()=>{c.a.Fa(v=>{l.la(v)})}},1292:function(t,C,a){var c=a(10);t=a(0);var b=a(84),f=a(228),e=a(231),d=a(32),h=a(21);class r{constructor(x,w){this.Ale=this.sPc=!1;this.sAa=(m,n)=>{(null===n||void 0===n?0:n.zH)&&d.a.pXg([n.zH])&&(this.jNb=!0)};this.So=()=>{this.jNb=!1};this.dd=(m,n)=>{e.b(n)&&this.Qfa(!0);this.jNb=!1};this.yd=()=>{this.qR=this.$.qR;this.Qfa()};this.dLf=()=>{this.US()};this.iKf=()=>{this.qR=this.$.qR};
this.zEd=()=>{h.h(this.$).Ca.sx(this.zEd);this.qR=this.$.qR};this.T4f=w;this.$=x;this.$.userOperationManager.tr(this.iKf);this.$.rl(this.yd);this.$.ea.MSg(this.dLf);this.$.ea.Zj(this.dd);this.$.L1b(this.sAa);this.$.ea.pM(this.So);this.Qfa()}get YDi(){return this.$.ea?this.$.ea.Esf:!1}get qR(){return this.sPc}set qR(x){x?this.sPc=!0:h.h(this.$)&&h.h(this.$).Ca&&(h.h(this.$).Ca.T5()?this.sPc=!1:h.h(this.$).Ca.vw(this.zEd));this.US()}get jNb(){return this.Ale}set jNb(x){this.Ale=x;this.US()}dispose(){this.$&&
(this.$.lm(this.yd),this.$.Ywc(this.sAa),this.$.userOperationManager&&this.$.userOperationManager.ro(this.iKf),this.$.ea&&(this.$.ea.lrj(this.dLf),this.$.ea.xk(this.dd),this.$.ea.iS(this.So)),h.h(this.$)&&h.h(this.$).Ca&&h.h(this.$).Ca.sx(this.zEd))}Qfa(x=!1){x=!this.$.isEditMode||x;this.T4f.Qfa(x,this.$.isEditMode?3:1);this.US()}US(){this.$.isEditMode&&this.T4f.US(!this.qR&&!this.YDi&&!this.jNb)}}Object(t.a)(r,"SaveStatusManager",null,[2]);var l=a(721);class u extends f.a{constructor(x){super();
this.kd=x;this.Mb()}create(){const x=b.a.instance;x.$b("Common.App.SaveStatus.ISaveStatusUIHandler").execute(w=>{const m=new r(this.kd,w);x.register(r,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").zc().Gc(()=>m);w=Object(l.a)(this.kd.da,300,()=>x.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.vb(w)})}static la(x){x.da.Ha(299,new u(x))}}Object(t.a)(u,"SaveStatusFactory",f.a,[]);a.d(C,"a",function(){return v});const v=()=>{c.a.Fa(u.la)}},1293:function(t,
C,a){var c=a(10);t=a(0);var b=a(228),f=a(39),e=a(21),d=a(14),h=a(35),r=a(217),l=a(25),u=a(73),v=a(1),x=a(1093),w=a(12),m=a(169),n=a(16),z=a(190),y=a(229),A=a(162),F=a(67),D=a(95),B=a(155);class M{constructor(I,O,U){this.kPa=1;this.J$=[];this.active=!1;this.Sb=null;this.onPointerDown=ca=>{A.a.slim(ca.Da.rawEvent);return!1};this.lx=()=>{const ca=this.gridView.amd();if(!(0>=ca||ca===this.kPa||this.gridView.Tr)){var Q=!1,Y=[],la=[];for(var ea=this.J$.length-1;0<=ea;ea--){var ha=this.J$[ea];if(this.$ld(ha)>
ca||ha.bottom<ca)Y.push(ha),this.J$.splice(ea,1),Q=!0}for(ea=this.tableManager.rangeList.length-1;0<=ea;ea--){ha=this.tableManager.rangeList[ea];const X=this.$ld(ha);X<=ca&&ha.bottom>=ca&&!(X<=this.kPa&&ha.bottom>=this.kPa)&&ha.Ala&&(la.push(ha),Q=!0)}if(Q){ha=this.gridView.vtc;for(let X of ha)for(let T of X)for(let ua of T)this.tkc?this.k8g(ua,Y,la):this.l8g(ua,Y,la,Q)}else d.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.kPa=
ca}};this.CHf=(ca,Q)=>{Q.isRow||Q.E_c(this.Ygc)};this.DHf=(ca,Q)=>{Q.isRow||(this.tableManager.rangeList.length||this.deactivate(),Q.MOd(this.Ygc))};this.Ygc=(ca,Q)=>{if(this.Zd())this.activate();else if(ca=this.active,this.deactivate(),!ca){d.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Q=Q.fq)&&this.reg(Q.C5,Q)};this.jKf=(ca,Q)=>{!this.gridView.Tr&&(this.Zd()?this.activate():(ca=this.active,this.deactivate(),
ca||d.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Q=Q.fq)&&(ca=x.a(Q.C5),this.reg(ca,Q)&&Q.TTd(ca))};this.he=()=>{this.gridView.lb.y5?this.deactivate():this.activate()};this.tableManager=I;this.gridView=O;this.$=O.$;this.Sb=U;I.n_c(this.jKf);O.aRg(this.CHf);O.bRg(this.DHf);this.$.ua.kg(this.he);this.$.Hb.kg(this.he);this.xxe(ca=>{ca.E_c(this.Ygc)});this.Zd()&&(this.activate(),this.lx(this,null));this.$.da.Ha(68,this)}dispose(){this.deactivate();
this.gridView&&(this.tableManager.AOd(this.jKf),this.gridView.Tpj(this.CHf),this.gridView.Upj(this.DHf),this.$.ua.Gg(this.he),this.$.Hb.Gg(this.he),this.xxe(I=>{I.MOd(this.Ygc)}));this.gridView=this.tableManager=this.J$=null}get tkc(){return this.gridView.BD}NEc(I,O,U){if(!u.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.lb.fDa)return O&&d.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),
!0;const ca=U.Maf();var Q=ca.length;if(ca[Q-1]<I.left)return d.ULS.sendTraceTag(509147276,0,50,`HeaderSnappingFeature.toggleHeaderSnapping: Header snapping failed, autoFilterRange.left=${I.left} > last headerNumber=${ca[Q-1]}`),!1;var Y=w.HelperMethods.Ux(new r.a(ca),0,Q,I.left,w.HelperMethods.WF);if(0>Y)return d.ULS.sendTraceTag(509147275,0,50,`HeaderSnappingFeature.toggleHeaderSnapping: binary search failed, autoFilterRange.left=${I.left} wasn't found in headerNumbers`),!1;const la=I.Y_d,ea=I.hze;
Q=Math.min(la.length+Y,Q);let ha=0;if(!ea)return d.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;Y<Q;Y++){const X=ca[Y];O?(U.updateCellText(Y,la[ha]),U.updateCellAlignment(Y,!0),U.activateCellAutoFilter(Y,ea[ha]),this.Kre(I,ha,X)):(U.updateCellText(Y,l.Range.HM(X)),U.updateCellAlignment(Y,!1),U.deactivateCellAutoFilter(Y),this.VQe(X));O&&U.qFj();ha++}U.om("HeaderSnappingFeature::toggleHeaderSnapping");I.yCa=O;return!0}OEc(I,
O,U,ca){if(!u.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.lb.fDa)return!0;if(!U.length)return!1;var Q=ca.length;if(ca[Q-1]<I.left)return!1;var Y=w.HelperMethods.Ux(new r.a(ca),0,Q,I.left,w.HelperMethods.WF);if(0>Y)return!1;const la=I.Y_d,ea=!!I.FIa&&0<I.FIa.length,ha=!!I.menuModel&&0<I.menuModel.length;for(let ua=Y,Ha=0,Ca=Math.min(la.length+Y,Q);ua<Ca;ua++,Ha++)if(Q=U[ua]){var X=null;(Y=Q.getElementsByClassName(h.a.Edd))&&(X=Y[0]);if(X&&X.innerText){if(Y=Q.getElementsByClassName(h.a.jve))for(var T=
Y.length-1;0<=T;T--)Q.removeChild(Y[T]);Y=ca[ua];O?(X.innerText=la[Ha],Q.classList.add(h.a.KXe),ea&&I.FIa[Ha]&&(X=document.createElement("div"),v.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:7658740_ReduceInnerHTMLUsageForHeaderSnappingFeaturev2")&&this.Sb?(this.Sb.uh(X,I.FIa[Ha]),T=I.FIa[Ha].split(F.a.AVg),3===T.length?(T=D.a.rf(T[1]),this.$qe(X.firstChild,T),m.a.instance.ta(n.a.Cf,X.firstChild,this.onPointerDown),z.a.instance.ta(n.a.Dp,
X.firstChild,this.onPointerDown)):(T=new B.a(this.$.ua),(T.Zd(2048)||T.Zd(4096))&&d.ULS.sendTraceTag(509678873,0,10,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain click/pointer handlers for ShowAutoFilterMenu"),this.$qe(X.firstChild,null))):X.innerHTML=I.FIa[Ha],ha&&I.menuModel[Ha]&&this.Kre(I,Ha,Y),Q.appendChild(X.firstChild))):(Q.classList.remove(h.a.KXe),X.textContent=l.Range.HM(Y),this.VQe(Y))}}I.yCa=O;return!0}$qe(I,O){y.a.instance.ta(n.a.click,I,U=>{O&&A.a.hrc(U.Da.rawEvent,
966232027,O,this.$.get_id());return!0})}Kre(I,O,U){this.$.da.kb(8,ca=>{ca.ecc.x_i(I,O,U)})}VQe(I){this.$.da.kb(8,O=>{O.ecc.y_i(I)})}l8g(I,O,U,ca){const Q=I.Pt,Y=x.a(I.C5);let la;const ea=v.EwaSettings.isChangeGateEnabled("OfficeVSO:7705876_headerSnappingActivateHtmlLogs");for(let ha=O.length-1;0<=ha;ha--)la=O[ha],this.OEc(la,!1,Y,Q)?(ea&&d.ULS.sendTraceTag(537157656,1,50,"HeaderSnappingFeature.checkTablesForSnappingHtml: Table deactivation succeeded"),O.splice(ha,1)):ea&&d.ULS.sendTraceTag(537157655,
1,50,"HeaderSnappingFeature.checkTablesForSnappingHtml: Table deactivation failed");for(O=U.length-1;0<=O;O--)la=U[O],this.OEc(la,!0,Y,Q)?(ea&&d.ULS.sendTraceTag(537157654,1,50,"HeaderSnappingFeature.checkTablesForSnappingHtml: Table activation succeeded"),this.J$.push(la)):ea&&d.ULS.sendTraceTag(537157653,1,50,"HeaderSnappingFeature.checkTablesForSnappingHtml: Table activation failed");ca&&I.TTd(Y)}k8g(I,O,U){if(I.m5g()){for(var ca=O.length-1;0<=ca;ca--)this.NEc(O[ca],!1,I)?(d.ULS.sendTraceTag(509166921,
0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),O.splice(ca,1)):d.ULS.sendTraceTag(509166920,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation failed");for(O=U.length-1;0<=O;O--)ca=U[O],this.NEc(ca,!0,I)?(d.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.J$.push(ca)):d.ULS.sendTraceTag(509166918,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation failed")}else d.ULS.sendTraceTag(509166922,
0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}reg(I,O){const U=this.tkc?O.Maf():O.Pt;var ca=U[0];const Q=U[U.length-1],Y=this.Z$h(ca,Q);let la=!1;for(let ea=this.J$.length-1;0<=ea;ea--){const ha=this.J$[ea];Q>=ha.left&&ca<=ha.right&&(this.tkc?this.NEc(ha,!1,O):this.OEc(ha,!1,I,U),this.J$.splice(ea,1),la=!0)}for(let ea=0,ha=Y.length;ea<ha;ea++)if(ca=Y[ea],this.tkc?this.NEc(ca,!0,O):this.OEc(ca,!0,I,U))this.J$.push(Y[ea]),la=!0;return la}activate(){this.Zd()&&
!this.active&&(this.gridView.view.qt(this.lx),this.active=!0)}deactivate(){this.active&&(this.gridView.view.hr(this.lx),this.active=!1)}Zd(){return u.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.lb.mP&&0<this.tableManager.rangeList.length}xxe(I){const O=this.gridView.vtc;for(let U of O)for(let ca of U)for(let Q of ca)I(Q)}Z$h(I,O){const U=[];if(!this.active)return U;this.kPa=this.gridView.amd();for(let ca=this.tableManager.rangeList.length-1;0<=ca;ca--){const Q=this.tableManager.rangeList[ca];
Q.bottom>=this.kPa&&this.$ld(Q)<=this.kPa&&Q.left>=I&&Q.right<=O&&Q.Ala&&U.push(Q)}return U}$ld(I){const O=this.gridView.wb.mh(I);return O&&this.tableManager.gmf(I,O.usedRange.topLeft)?I.top+1:I.top}}Object(t.a)(M,"HeaderSnappingFeature",null,[2]);var R=a(109),P=a(157),E=a(41),H=a(53);class G extends b.a{constructor(I){super();this.$=I;this.Mb()}create(){const I=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?Object(R.d)(P.a.resolve(E.db,{rb:this.Na})):H.GetServiceTaskFactory.create(this.$.da,
134,this.ka,this.Na),O=Object(R.d)(P.a.resolve(E.F,{rb:this.Na}));f.TaskExtensions.za(f.TaskExtensions.Pd([O],this.ka),()=>{f.TaskExtensions.za(f.TaskExtensions.Pd([I],this.ka),()=>{this.vb(this.$.da.Aa(68)||new M(I.result,e.h(this.$),O.result))},this.ka,11)},this.ka,3)}static la(I){I.da.Ha(67,new G(I))}}Object(t.a)(G,"HeaderSnappingFactory",b.a,[]);a.d(C,"a",function(){return N});const N=()=>{c.a.Fa(G.la)}},1294:function(t,C,a){t=a(0);var c=a(14),b=a(88),f=a(1383),e=a(1104),d=a(6),h=a(16),r=a(113),
l=a(175);class u{constructor(y,A,F,D,B){this.ZNc=this.gGa=null;this.RXa=this.fJc=!1;this.de=A;this.OXb=y;this.Nra=F;this.HP=D;this.QSc=B;this.SXf(null)}SXf(){const y=document.getElementById(d.AFrameworkApplication.Jqb);!this.RXa&&this.HP&&y&&(this.HP.ta(h.a.Eza,y,Object(b.a)(this,this.SBd,"mouseActivityHandler"),null),this.RXa=!0);this.QSc(()=>{this.dispose()})}SBd(){this.RXa&&(this.HP.Ba(h.a.Eza,document.getElementById(d.AFrameworkApplication.Jqb),Object(b.a)(this,this.SBd,"mouseActivityHandler")),
this.RXa=!1);this.rqe();return!1}rqe(){this.fJc=!0;this.ZNc||(this.ZNc=new r.a(3,2,this.OXb,Object(b.a)(this,this.SXf,"registerHandlerTask"),112),this.de.Kf(this.ZNc));this.gGa||(this.KNb(null),this.gGa=new r.a(3,2,this.OXb,Object(b.a)(this,this.KNb,"sendPostMessageIfNecessary"),111),this.de.Kf(this.gGa))}KNb(){this.fJc&&(this.Nra.CWR(()=>this.Nra.result.hi(l.a.N9j,null)),c.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.fJc=!1)}dispose(){this.RXa&&
(this.HP.Ba(h.a.Eza,document.getElementById(d.AFrameworkApplication.Jqb),Object(b.a)(this,this.SBd,"mouseActivityHandler")),this.RXa=!1)}}Object(t.a)(u,"UserActivityHostNotificationManager",null,[856,2]);var v=a(190),x=a(260),w=a(108),m=a(527);class n{constructor(){this.ib=null}get name(){return"Common.App.EditNotification"}init(){d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.Nu(Object(b.a)(this,this.HB,"onFullAppSettingsReady"))}HB(){n.editNotificationIsEnabled&&0<n.qbd&&(this.ib.register(f.a,
"Common.App.HostNotification.EditNotificationEventSource").zc(),this.ib.register(u,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").zc().Gc(()=>new u(6E4,w.a.instance,m.a.wq(this.ib.$b("Postmessage.IHostPostmessenger")),v.a.instance,d.AFrameworkApplication.Fgb)),this.ib.register(e.a,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").zc().Gc(()=>new e.a(n.qbd,w.a.instance,
m.a.wq(this.ib.$b("Postmessage.IHostPostmessenger")),this.ib.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.ib.yg("Common.Interface.IUserActivityHostNotificationManager"),n.editNotificationPostMessageIsEnabled,n.Auh)),this.ib.resolve("Common.Interface.IEditNotificationManager"),c.ULS.shipAssertTag(38086291,209,0<n.qbd,"EditNotification Interval is less than or equal to 0."))}ki(y){this.ib=y}dispose(){}static get qbd(){return d.AFrameworkApplication.fa?parseInt(d.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get Auh(){return d.AFrameworkApplication.fa?parseInt(d.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get editNotificationIsEnabled(){return!!d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.ra("EditNotificationIsEnabled")}static get editNotificationPostMessageIsEnabled(){return!!d.AFrameworkApplication.fa&&d.AFrameworkApplication.fa.ra("EditNotificationPostMessageIsEnabled")}static main(){x.a.instance.dj(new n)}}
Object(t.a)(n,"CommonHostNotificationPackage",null,[4,5]);a.d(C,"a",function(){return z});const z=()=>{Type.registerNamespace("Common.App.HostNotification");n.main()}},1295:function(t,C,a){t=a(0);var c=a(88),b=a(112),f=a(918),e=a(739),d=a(26);class h{constructor(x,w){this.Bkb=null;this.La=x;this.$a=w}Pg(){(this.Bkb=this.$a.Wa("StatusBarEnvironmentNameToUse"))&&""!==this.Bkb&&this.La.Ne(d.a.PTf,b.a.frame,Object(c.a)(this,this.r6j,"updateEnvironmentName"),96)}r6j(x,w,m,n,z){if(1===m)return 32;z[f.a.Value]=
this.Bkb;z[e.a.ei]=this.Bkb;z[f.a.Visible]=!0;return 32}}Object(t.a)(h,"DisplayEnvironmentName",null,[]);var r=a(6),l=a(260);class u{constructor(){this.ib=null}get name(){return"Common.App.DisplayEnvironmentName"}ki(x){this.ib=x;this.ib.register(h,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").zc().Gc(()=>new h(r.AFrameworkApplication.xb,r.AFrameworkApplication.fa))}init(){this.ib.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Pg()}dispose(){}static main(){l.a.instance.dj(new u)}}
Object(t.a)(u,"DisplayEnvironmentNamePackage",null,[4,5]);a.d(C,"a",function(){return v});const v=()=>{Type.registerNamespace("Common.App.DisplayEnvironmentName");u.main()}},1296:function(t,C,a){var c=a(10);t=a(0);var b=a(228),f=a(14),e=a(34),d=a(94),h=a(199),r=a(65),l=a(12),u=a(293),v=a(467),x=a(21),w=a(116),m=a(154),n=a(55);class z{constructor(D){this.sV=null;this.Rvf=new Set;this.Ypf=!1;this.c0=(B,M)=>{if(!this.Rvf.has(B)){var R=[];if(M){const P=x.h(this.$).wb.mh(M,!1);if(!P){1!==M.top||1!==M.left||
this.Ypf||(R.push(w.a.Vg("IsTableOnA1","false",1)),m.a("MsFormsTableUsage",void 0,void 0,R),this.Ypf=!0);return}if(1!==P.usedRange.top||1!==P.usedRange.left)return}M=n.b().Sj(B);R.push(w.a.Vg("Command",M,2));m.a("MsFormsTableUsage",void 0,void 0,R);this.Rvf.add(B)}};this.I2d=(B,M)=>{if(!this.$.ea.Lg.get(61)||d.k(this.$.Ue))d.k(this.$.Ue)&&M&&M.item.name===this.sV.uK&&this.kze();else if(this.$.ua.Ik(this.sV.nxb)){const R={};R.SheetName=this.sV.nxb;R.NamedObjectName=this.sV.nxb;R.FirstColumn=0;R.FirstRow=
0;R.LastColumn=0;R.LastRow=2;const P=H=>{if(!d.k(this.$.Ue)){if(null===H||void 0===H?0:H.Result)this.$.workbookContext.MsFormId=H.Result[0][0],this.sV.uK=H.Result[1][0],H=H.Result[2][0],this.xL(!!this.$.workbookContext.MsFormId&&this.TBi(H),1024),this.kze();d.c(this.$.Ue)&&(M?f.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${e.a.Au(this.$.workbookContext.MsFormId).toString()}`):f.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${e.a.Au(this.$.workbookContext.MsFormId).toString()}`));
d.c(this.$.Ue)&&!M&&f.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${e.a.Au(this.$.workbookContext.MsFormId).toString()}`);!d.c(this.$.Ue)&&M||this.xL(!0,2048)}},E=this.$.pa.va.ic();this.$.userOperationManager.pF(new h.a(159,0,(H,G,N)=>r.r(this.$.pa.hx,R,!1,u.b(H,P),G,N,null,E),16))}else M||this.xL(!0,2048)};this.v1i=(B,M)=>{M&&M.item.name===this.sV.nxb&&(this.xL(!1,1024),this.xL(!0,2048))};this.$=D}o2j(){this.sV=v.a.current;this.I2d(null,null);this.$.ua.Yha(this.I2d);
this.$.ua.TY(this.v1i)}dispose(){this.$.ua.Aoa(this.I2d)}TBi(D){if(!D)return!0;const B=RegExp("-","g"),M=this.$.workbookContext.MsFormDocUrl.toLowerCase();return M.includes(D.toLowerCase())||M.includes(D.toLowerCase().replace(B,""))?!0:!1}kze(){d.c(this.$.Ue)&&this.sV.uK&&this.$.ua.na&&this.$.ua.na.name!==this.sV.uK&&this.$.ua.Ik(this.sV.uK)&&this.$.ua.getItemByName(this.sV.uK).activate()}xL(D,B){this.$.workbookContext.Options=l.HelperMethods.IO(D,this.$.workbookContext.Options,B)}}Object(t.a)(z,
"MsFormInfoUpdatingService",null,[845,2]);var y=a(721);class A extends b.a{constructor(D){super();this.msFormInfoUpdatingService=null;this.$=D;this.Mb()}create(){this.vb(Object(y.a)(this.$.da,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new z(this.$))));this.msFormInfoUpdatingService.o2j()}static la(D){D.da.Ha(236,new A(D))}}Object(t.a)(A,"MsFormInfoUpdatingServiceFactory",b.a,[]);a.d(C,"a",function(){return F});const F=()=>{c.a.Fa(A.la)}},1319:function(t,C,a){t=a(0);var c=
a(228),b=a(979);class f extends c.a{constructor(r){super();this.$=r;this.Mb()}create(){this.vb(this.$.da.Aa(5)||new b.BusinessBarManager(this.$,!this.$.u_))}static la(r){r.da.Ha(4,new f(r))}}Object(t.a)(f,"BusinessBarManagerFactory",c.a,[]);var e=a(10),d=a(70);a.d(C,"a",function(){return h});const h=()=>{Object(d.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")||e.a.Fa(f.la)};String(b);window.___1680632998888_closurehack=b},1320:function(t,C,a){t=a(0);var c=a(816),b=a(228);class f extends b.a{constructor(){super();
this.Mb()}create(){this.vb(new c.a)}}Object(t.a)(f,"CommonUIJsServiceFactory",b.a,[]);var e=a(10);a.d(C,"a",function(){return d});const d=()=>{e.a.Fa(h=>{h.da.Ha(203,new f)})}},1321:function(t,C,a){t=a(0);var c=a(158),b=a(614);class f extends b.a{constructor(){super()}dispose(){c.WacAirSpace.qrd()&&c.WacAirSpace.MEc()}animate(h,r,l,u,v){r&&c.WacAirSpace.vL(h.element,r);c.WacAirSpace.animate(h,u,v);l&&c.WacAirSpace.unj(h.element,l)}}Object(t.a)(f,"AnimationManager",b.a,[2]);var e=a(107);a.d(C,"a",
function(){return d});const d=()=>{e.a.Hm.Ha(141,new f)}},1330:function(t,C,a){t=a(0);var c=a(228),b=a(53),f=a(39),e=a(1),d=a(14);class h{constructor(l){this.lUa=!0;h.akf()?h.Gri()?this.lUa=!1:h.lkf()?(d.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!l}`),this.lUa=l):this.lUa=!1:this.lUa=!0}I8a(){return!this.lUa}static lkf(){return h.akf()&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)}static akf(){return e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)}static Gri(){return e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)}}Object(t.a)(h,"LineageCatchUpExperimentManager",null,[854]);a.d(C,"a",function(){return r});class r extends c.a{constructor(l){super();this.$=l;this.Mb()}create(){h.lkf()?f.TaskExtensions.za(b.GetServiceTaskFactory.Sa(this.$.da,456,457,this.Na),l=>{f.TaskExtensions.za(l.result.WMj(),
u=>{this.qKe(u.result)},this.$.ka,3)},this.$.ka,3):this.qKe(!0)}qKe(l){this.vb(this.$.da.Aa(458)||this.$.da.Ha(458,new h(l)))}static la(l){l.da.Ha(459,new r(l))}}Object(t.a)(r,"LineageCatchUpExperimentManagerFactory",c.a,[])},1331:function(t,C,a){t=a(0);var c=a(228),b=a(53),f=a(39),e=a(14),d=a(7),h=a(80),r=a(65),l=a(98),u=a(1);class v{constructor(m,n){this.Fud=!1;this.Gf=()=>{this.$jg()};this.$=m;u.EwaSettings.ya(527)&&this.$.ea.w$a&&!v.$zb&&(n&&!n.lUa||this.Nak(),v.Jdf?e.ULS.sendTraceTag(537155461,
0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):n&&!n.lUa||this.Uak());e.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.ENd();this.$=null;e.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){v.$zb||(v.$zb=!0,e.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.ENd()}Uak(){u.EwaSettings.ya(523)&&
!this.$.isAnonymousUser()&&r.i(this.$.pa.va,m=>{this.$?(m=m.Result,e.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${m}.`),v.Jdf=!0,m&&this.gFc(0)):e.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},()=>{e.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}Nak(){u.EwaSettings.ya(522)&&!this.$jg()&&(this.$.ea.vu(this.Gf),
this.Fud=!0)}$jg(){return this.$.ea&&this.$.ea.jn&&this.$.ea.jn.ShouldTriggerLineageCalloutOnMerge?(e.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.gFc(1),!0):!1}gFc(m){v.$zb?e.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):(v.$zb=!0,e.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${m}.`),
this.ENd(),u.EwaSettings.ya(418)&&(m=new l.a(-847286761,h.a.Eb,this.$.Bc,0,d.a.L0),this.$.Ia.Nb(m,{["CalloutName"]:4})))}ENd(){this.Fud&&(this.Fud=!1,this.$.ea.$v(this.Gf))}}v.$zb=!1;v.Jdf=!1;Object(t.a)(v,"LineageTeachingCalloutTriggerManager",null,[831,2]);var x=a(721);a.d(C,"a",function(){return w});class w extends c.a{constructor(m){super();this.$=m;this.Mb()}create(){f.TaskExtensions.za(b.GetServiceTaskFactory.Sa(this.$.da,458,459,this.Na),m=>{const n=m.result;m=Object(x.a)(this.$.da,403,()=>
new v(this.$,n));this.vb(m)},this.$.ka,3)}static la(m){m.da.Ha(402,new w(m))}}Object(t.a)(w,"LineageTeachingCalloutTriggerManagerFactory",c.a,[])},1332:function(t,C,a){t=a(0);var c=a(228),b=a(14),f=a(245),e=a(7),d=a(272),h=a(33),r=a(259),l=a(13),u=a(21),v=a(728);const x=a(19).a.wFh;class w extends f.a{constructor(A,F,D){super(A);this.gw=0;this.Xs=!1;this.Dc=()=>{this.$g(!1)};this.$=F;this.taskPaneManager=D;d.a(F).ti(this);this.$.wj(this.Dc);h.a.Md()&&(this.isVisible=!1)}eU(A){this.get_events().addHandler("EnrichmentTaskPaneRemoved",
A)}fX(A){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",A)}PE(A){this.addHandler("EnrichmentTaskPaneVilibilityChanged",A)}iG(A){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",A)}XRg(A){this.addHandler("EnrichmentTaskPaneOnFocus",A)}Eqj(A){this.removeHandler("EnrichmentTaskPaneOnFocus",A)}get isVisible(){return super.isVisible}set isVisible(A){super.isVisible=A;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Qf(){return this.isVisible}get je(){return r.a.Rwh}get Uh(){return 10}get tk(){return x}get jR(){return this.titleText}get titleText(){return"Enrichment"}get oq(){return 300}get isResizable(){return!1}get rc(){return this.domElement}get height(){return this.taskPaneManager.WO.offsetHeight}get cC(){return this.taskPaneManager.mwa(this.rc,
this.titleText,this.oq,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.oq)}Zq(){return this.Xs}Tt(){return this.Xs}BW(){}dispose(){this.$&&this.$.ll(this.Dc);this.taskPaneManager=this.$=null;super.dispose()}pg(A,F){F||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!F}Gh(A){return l.DOMElementExtensions.Mf(this.rc,A)}Bj(){}hk(){}$g(A){this.Xs=A;const F=this.taskPaneManager;this.isVisible=A;h.a.Md()?A?this.taskPaneManager.E7("EnrichmentTaskPane",
this.cC):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(A&&0<F.iE.length&&(!F.Qh||10!==F.Qh.taskPane.Uh||F.isCollapsed)&&F.VI(this,!0),F.eC());A||(u.h(this.$).pg(!0,!1),this.$.zf())}LV(){return!1}static la(A,F){var D=A.Ib;let B=document.getElementById(D+e.a.NSe);B||(B=v.a("div",A.Ib+e.a.NSe,"cui-taskpane"),h.a.Md()||(D=document.getElementById(D+e.a.vW),void 0!==D&&null!==D?D.appendChild(B):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${A.zD}`)));
D=A.da;return D.Aa(257)||D.Ha(257,new w(B,A,F))}}Object(t.a)(w,"EnrichmentTaskPane",f.a,[671,2,339,36]);var m=a(53),n=a(426),z=a(39);a.d(C,"a",function(){return y});class y extends c.a{constructor(A){super();this.rh=this.ui=null;this.$=A;this.Mb()}get RD(){this.ui||(this.ui=z.TaskExtensions.za(n.a(this.$),A=>{this.rh=w.la(this.$,A.result)},this.ka,3));return this.ui}create(){const A=m.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),F=m.GetServiceTaskFactory.create(this.$.da,155,this.ka,
this.Na);z.TaskExtensions.za(z.TaskExtensions.ts(z.TaskExtensions.Pd([A,F],this.ka),()=>this.RD,this.ka),()=>{this.vb(this.rh)},this.ka,3)}dispose(){this.rh=this.ui=this.$=null;super.dispose()}static la(A){A.da.Ha(258,new y(A))}}Object(t.a)(y,"EnrichmentTaskPaneFactory",c.a,[])},1347:function(t,C,a){t=a(0);var c=a(14),b=a(264);class f{constructor(h,r){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=
null;this.testIteration=0;this.testName=h;this.caller=r;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(t.a)(f,"NetworkTestResult",null,[]);var e=a(592);a.d(C,"a",function(){return d});class d{constructor(h,r,l,u,v){this.url="";this.A7a=!1;this.bhb=-1;this.testIteration=0;this.baseUrl=l;this.zEf=u;this.Sod=r;this.result=new f(r,v)}runTest(){try{if(this.A7a)return c.ULS.sendTraceTag(537155206,
0,50,`NetworkTestReq.RunTest: a test for the host ${this.Sod} is already mid way, not starting a new one.`),!1;this.reset();this.A7a=!0;this.result.startTimeMs=Date.now();const h=new b.QueryStringBuilder(this.baseUrl);h.P$("tid",this.result.startTimeMs.toString());this.url=h.toString();this.ZAj();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(h){return this.Owb("Exeption: "+h.message),!1}}reset(){this.url="";this.result.reset();this.A7a=!1;this.bhb=-1}clearTimeout(){-1!==
this.bhb&&(window.clearTimeout(this.bhb),this.bhb=-1)}ZAj(){try{const h=new XMLHttpRequest;h.onreadystatechange=()=>{4===h.readyState&&(200===h.status?this.EMh():this.Owb(`Error when downloading resource. status code: ${h.status}, status text: ${h.statusText}`,h.status.toString()))};h.onerror=()=>{this.Owb(`Client error when attempting to download resource. status code: ${h.status}, response: ${h.statusText}`)};this.bhb=window.setTimeout(()=>{this.bhb=-1;this.Owb("Request timeout")},1E4);h.open("GET",
this.url,!0);h.send(null)}catch(h){this.Owb("Exeption: "+h.message)}}EMh(){this.A7a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=e.a(this.url),this.result.isSuccess=!0,this.H6b())}Owb(h,r=null){this.A7a&&(this.clearTimeout(),this.result.errorMessage=h,this.result.isSuccess=!1,this.result.errorStatusCode=r,this.H6b())}H6b(){this.A7a=!1;this.zEf&&this.zEf(this.result,this.Sod)}}Object(t.a)(d,"NetworkTestReq",null,[])},1382:function(t,
C,a){a.r(C);a.d(C,"AutoDetectActionButton",function(){return d});t=a(0);C=a(86);var c=a(1286),b=a(54),f=a(15),e=a(21);class d extends C.a{constructor(h,r,l,u,v){super();this.$=h;this.Do=u.c8b(h,r,l,"",b.a.mf(11),v,"AutoDetectPointerDown",f.a.instance.ha(1808)+"...")}get Gz(){return this.Do.Gz}dispose(){this.Do.dispose();this.$=null;super.dispose()}domElement(h){return this.Do.domElement(h)}getButton(h){return this.Do.getButton(h,!1)}gib(h,r,l,u){this.Do.LVa(c.a.fXh(h),r,u);this.Do.xng(l,r,u)}sCa(h,
r){const l=e.h(this.$),u=l.lb.yi(h);h=l.Mg(h,u);const v=l.hg(u).Nm;if(h&&0<=h.x&&0<=h.y&&v.width>h.width+160){let x=h.bottomRight.x+this.Gz,w=h.topLeft.y+this.Gz,m=!1;x+160>v.bottomRight.x&&(x=h.topLeft.x-this.Gz,m=!0);if(w<v.topLeft.y+this.Gz){if(l.lb.fDa){this.hide();return}w=v.topLeft.y+this.Gz}this.Do.eac(r,u);this.to(x,w,l.rtl,u,m)}else this.hide()}to(h,r,l,u,v){this.Do.to(h,r,l,u,!1,v)}hide(){this.Do.hide()}}Object(t.a)(d,"AutoDetectActionButton",C.a,[])},1500:function(t,C,a){a.r(C);var c=a(0),
b=a(14),f=a(6),e=a(127),d=a(405);class h extends d.a{constructor(Sb){super(Sb)}get y7b(){return!1}createElement(){const Sb=document.createElement("link");Sb.setAttribute("rel","stylesheet");Sb.setAttribute("type","text/css");Sb.setAttribute("href",this.cu);return Sb}r8c(){return null}gwc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.kA.cu)}}Object(c.a)(h,"CssResource",d.a,[]);var r=a(384),l=a(234),u=a(34),v=a(60);class x{constructor(){this.wYb=this.LVb=null}cGi(){this.LVb||
(b.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.LVb=v.Task.WAA(x.hGi(),x.ZFi()),this.LVb.continueWith(Sb=>{b.ULS.sendTraceTag(21030599,324,10,"{0}",u.a.Rid(Sb.exception))},5));return this.LVb}eGi(){if(!this.wYb)try{b.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.wYb=v.Task.WAA(x.Pbd(l.a.create(f.AFrameworkApplication.fa.Wa("DimeUrl"),null,null))),this.wYb.continueWith(Sb=>{b.ULS.sendTraceTag(39978391,324,10,"{0}",u.a.Rid(Sb.exception))},
5)}catch(Sb){b.ULS.sendTraceTag(594874951,324,10,"{0}",u.a.Rid(Sb))}return this.wYb}static hGi(){var Sb=x.Ofc("inproductmessaging.js");Sb=l.a.create(Sb,null,null);return x.Pbd(Sb)}static ZFi(){var Sb=x.Ofc("inproductmessaging.css");Sb=new h(Sb);return x.Pbd(Sb)}static Ofc(Sb){return e.a.E6b(String.format("ipm/{0}",Sb))}static Pbd(Sb){r.a.Qja(Sb);return Sb.z$a}}Object(c.a)(x,"DependencyDownloader",null,[939]);class w{}w.D8i="inProductMessagingOverlayDiv";w.Caj="PlayButtonImage";w.Dsj="ReplayButtonImage";
Object(c.a)(w,"Constants",null,[]);class m{constructor(){this.Nme=this.ihe=this.D7d=!0;this.Esj=this.Daj=null;this.wPi=!1;this.locale=null;this.nlg={}}get lze(){return this.D7d}set lze(Sb){this.D7d=Sb}get xzf(){return this.ihe}set xzf(Sb){this.ihe=Sb}get Kcg(){return this.Nme}set Kcg(Sb){(this.Nme=Sb)&&this.NGj()}NGj(){this.Ese(w.Caj,this.Daj);this.Ese(w.Dsj,this.Esj)}Ese(Sb,Cc){Cc&&(this.nlg[Sb]=Cc)}}Object(c.a)(m,"FirstRunExperienceUISettings",null,[938]);class n{constructor(){this.completed=this.knj=
!1}}Object(c.a)(n,"FirstRunExperienceViewData",null,[937]);var z=a(88),y=a(188),A=a(112),F=a(26);class D{constructor(Sb,Cc,cd){this.La=Sb;this.pf=Cc;this.pWb=cd}Pg(){this.La.Ne(F.a.cNh,A.a.frame,Object(z.a)(this,this.aNh,"firstRunExperienceHandler"),64);this.La.Wb(F.a.a0e,A.a.frame,Object(z.a)(this,this.Uji,"inProductMessagingTabHandler"));this.La.Wb(F.a.$_e,A.a.frame,Object(z.a)(this,this.Tji,"inProductMessagingShiftTabHandler"));this.La.Wb(F.a.frh,A.a.frame,Object(z.a)(this,this.grh,"dimeLaunchHandler"));
this.La.Wb(F.a.N0f,A.a.frame,y.ActionManager.sg);this.La.Wb(F.a.ctj,A.a.frame,y.ActionManager.sg);this.La.Wb(F.a.dtj,A.a.frame,y.ActionManager.sg);this.pf&&this.pf.updateCommandUI()}aNh(Sb,Cc,cd,Wd,je){2===cd&&this.pWb.BEi(je);return 32}grh(Sb,Cc,cd,Wd,je){2===cd&&this.pWb.yEi(je);return 32}Uji(Sb,Cc,cd){return 2===cd?this.pWb.XBd():32}Tji(Sb,Cc,cd){return 2===cd?this.pWb.UBd():32}}Object(c.a)(D,"InProductMessagingActor",null,[]);var B=a(89);class M{constructor(){this.oYf=this.p2f=this.thg=this.unc=
this.instance=null}}Object(c.a)(M,"DimeExperienceUISettings",null,[]);var R=a(131),P=a(473);class E{constructor(Sb,Cc,cd,Wd,je){this.adc=!1;this.ivb=null;this.La=Sb;this.ZGa=Cc;this.aZb=cd;this.h2=Wd;this.LJc=je}Mmi(Sb){R.b("getHeaderApi")?Sb.isFeatureEnabled("MsoPremiumBadge",!0).then(Cc=>{const cd=Sb.isFreemiumUpsellEnabled();cd&&(appChrome.getHeaderApi().then(Wd=>{Wd.updatePremiumStatus(Cc,cd);return null}),Sb.kBa("MsoPremiumBadge",Wd=>{appChrome.getHeaderApi().then(je=>{je.updatePremiumStatus(Wd.isEnabled,
cd);return null})}));return null}):b.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}BEi(Sb){this.aZb.cGi().continueWith(()=>{this.ZGa.TQj(Sb)})}yEi(Sb){let Cc="gopremium",cd=null,Wd=()=>{};Sb?(Sb.experience&&""!==Object(B.a)(String,Sb.experience)&&(Cc=Object(B.a)(String,Sb.experience)),Sb.onTaskComplete&&(Wd=Sb.onTaskComplete),Sb.campaignId&&""!==Object(B.a)(String,Sb.campaignId)&&(cd=Object(B.a)(String,Sb.campaignId))):b.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.Usf(Cc,Wd,cd)}Usf(Sb,Cc,cd=null){if(this.adc&&this.ivb){const Wd={};Wd.experience=Sb||"gopremium";Wd.campaignId=cd||P.b(this.h2,this.LJc,Object(B.a)(String,Wd.experience),!0);this.La.processAction(F.a.N0f,2);b.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Wd.experience);try{const je=Object.assign(new M,{instance:this.ivb,unc:Wd,thg:Cc||(()=>{}),p2f:Ee=>{b.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+Ee.status)},oYf:()=>{b.ULS.sendTraceTag(51675406,324,10,"Dime launch error");
this.adc=!1;this.ivb=null}});this.ZGa.iPj(je)}catch(je){b.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+je.message),this.adc=!1,this.ivb=null,this.La.ie(F.a.bdc,2,{["experience"]:Wd.experience})}}else b.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.La.ie(F.a.bdc,2,{["experience"]:Sb})}Ptf(){this.aZb.eGi().continueWith(()=>{try{var Sb=u.a.Ok(f.AFrameworkApplication.uiCulture);const Wd=P.c(this.h2);if(Wd){var Cc={};Cc.partnerId=Wd;Cc.language=Sb;Cc.sessionId=
f.AFrameworkApplication.userSessionId;Cc.authHint=f.AFrameworkApplication.fa.Wa("UserPrincipalName");var cd=f.AFrameworkApplication.fa.Wa("Puid")||"";""!==cd&&(Sb={},Sb.puid=cd,Cc.userInfo=Sb);this.ivb=new Dime(Cc);this.adc=!0;b.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else b.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Wd){b.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Wd.message)}},3)}XBd(){return this.ZGa.XBd()}UBd(){return this.ZGa.UBd()}}
Object(c.a)(E,"InProductMessagingUIManager",null,[934]);class H{constructor(){this.ooe=0;this.zYa=Array(5);this.zYa[0]=10;this.zYa[1]=15;this.zYa[2]=50;this.zYa[3]=100;this.zYa[4]=200}Init(Sb){this.ooe=Sb}SendTrace(Sb,Cc){b.ULS.sendTraceTag(34182235,this.ooe,this.zYa[Sb],"{0}",Cc)}}Object(c.a)(H,"DefaultNetworkingManager",null,[951]);var G=a(273),N=a(326),I=a(102);class O{constructor(Sb){this.lc=Sb}TQj(Sb){Sb&&(InProductMessaging.Networking.NetworkingMgr=new H,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(Sb.Kcg,Sb.xzf,Sb.lze,Sb.wPi,Sb.locale,Object(z.a)(this,this.RWi,"onDismissFirstRunExperience"),Sb.nlg),this.BTa(w.D8i,!0))}iPj(Sb){if(Sb&&Sb.instance&&Sb.unc){let Cc=document.getElementById("wacDimeContainer");Cc||(Cc=document.createElement("div"),Cc.id="wacDimeContainer",document.body.appendChild(Cc));f.AFrameworkApplication.fa.ra("DimeFocusManagerIsEnabled")&&this.BTa("wacDimeContainer",!1);Sb.unc.parentElementId="wacDimeContainer";Sb.instance.launch(Sb.unc,Sb.thg).then(cd=>
{this.oLb();document.body.removeChild(Cc);Sb.p2f(cd)}).catch(cd=>{this.oLb();document.body.removeChild(Cc);Sb.oYf(cd)})}else throw Error.argument("DimeExperienceUISettings");}BTa(Sb,Cc){if(this.lc&&Sb&&(Sb=document.getElementById(Sb),this.Emi(Sb),Sb=this.lc.cN("InProductMessagingFocusId"))){const cd=this.lc.li;cd&&"InProductMessagingFocusId"===cd.name||this.lc.cS("InProductMessagingFocusId",!1);Cc&&this.tWf(Sb.scope)}}Emi(Sb){var Cc=this.lc.Gi("InProductMessagingFocusId");Cc.parent=G.AFrame.kU;const cd=
new N.DOMFocusListing(()=>Sb);cd.Gdb=!1;cd.Bo(3);cd.Bo(2);cd.Bo(4);Cc=this.lc.cua(()=>Sb,Cc,cd);Cc.hLb();Cc.d0=!0;Cc.uJa=!0}tWf(Sb){Sb.Qk(I.FocusManager.instance().a3);Sb.Qk(I.FocusManager.instance().b3);Sb.bindAction(I.FocusManager.instance().a3,F.a.a0e);Sb.bindAction(I.FocusManager.instance().b3,F.a.$_e)}oLb(){this.lc&&(this.lc.O7("InProductMessagingFocusId"),this.lc.lSa("InProductMessagingFocusId"))}RWi(Sb,Cc){this.oLb();Sb=Object.assign(new n,{completed:Sb,knj:Cc});f.AFrameworkApplication.xb.ie(F.a.$Mh,
2,Sb)}XBd(){const Sb=document.activeElement,Cc=this.lc.WQ();return Sb&&Cc&&Cc.uf&&Sb===Cc.uf.ax?(Cc.uf.Ul(Sb),Cc.Gza()?32:8):4}UBd(){const Sb=document.activeElement,Cc=this.lc.WQ();return Sb&&Cc&&Cc.uf&&Sb===Cc.uf.firstElement?(Cc.uf.Ul(Sb),Cc.bQa()?32:8):4}}Object(c.a)(O,"InProductMessagingUIWrapper",null,[935]);var U=a(144),ca=a(260),Q=a(29);class Y{constructor(){this.ib=null}get name(){return"Common.App.InProductMessaging"}ki(Sb){Sb.register(x,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").zc().Gc(()=>
new x);Sb.register(O,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").zc().Gc(()=>new O(I.FocusManager.instance()));Sb.register(E,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").zc().Gc(()=>new E(f.AFrameworkApplication.xb,Sb.resolve("Common.IInProductMessagingUIWrapper"),Sb.resolve("Common.App.InProductMessaging.IDependencyDownloader"),f.AFrameworkApplication.sa.Pa.$i,f.AFrameworkApplication.sa.Pa.Sza));
Sb.register(D,"Common.App.InProductMessaging.InProductMessagingActor").zc().Gc(()=>new D(f.AFrameworkApplication.xb,f.AFrameworkApplication.sa,Sb.resolve("Common.IInProductMessagingUIManager")));Sb.register(m,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").zc().Gc(()=>new m);Sb.register(n,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").zc().Gc(()=>new n);this.ib=Sb}init(){this.ib.resolve("Common.App.InProductMessaging.InProductMessagingActor").Pg();
f.AFrameworkApplication.fa.Nu(()=>{f.AFrameworkApplication.sa.Pa.Ou&&U.a.get_instance().ek(15,()=>{this.ib.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Sb=>{this.ib.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Mmi(Sb)})});f.AFrameworkApplication.fa.ra("FreemiumUpsellShowDialogIsEnabled")&&P.a()&&!Q.a.nya&&1!==f.AFrameworkApplication.sa.Pa.$i&&this.ib.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Sb=>{Sb.isFeatureEnabled("MsoPremiumBadge",
!0).then(Cc=>{!Cc&&Sb.isFreemiumUpsellEnabled()&&this.ib.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Ptf();return null})})})}dispose(){}static main(){ca.a.instance.dj(new Y)}}Object(c.a)(Y,"InProductMessagingPackage",null,[4,5]);var la=a(198),ea=a(42);class ha{constructor(Sb,Cc,cd,Wd=null,je=null){this.rw=Sb;this.vFa=Cc;this.alb=cd;this.Gje=Wd;this.lnb=je}sbc(Sb){const Cc=new Sys.StringBuilder(this.rw.QMb);Cc.append("RoamingServiceHandler.ashx?action=");Cc.append("getFirstRunExperienceSettings");
Cc.append("&");Cc.append(this.Pkd(Sb));Cc.append("&");Cc.append(f.AFrameworkApplication.Di);f.AFrameworkApplication.Od.Zm(Cc.toString(),1,null,null,!0,2,Object(z.a)(this,this.s5,"getRequestSuccessCallback"),Object(z.a)(this,this.dN,"getRequestFailureCallback"),null)}J4a(Sb){var Cc=new Sys.StringBuilder(this.rw.QMb);Cc.append("RoamingServiceHandler.ashx?action=");Cc.append("saveFirstRunExperienceSettings");Cc.append("&");Cc.append(f.AFrameworkApplication.Di);Cc=Cc.toString();Sb=ea.c(Sb);f.AFrameworkApplication.Od.Zm(Cc,
2,Sb,null,!0,4,Object(z.a)(this,this.fcj,"postRequestSuccessCallback"),Object(z.a)(this,this.hO,"postRequestFailureCallback"),null)}s5(Sb){let Cc=!1,cd=null;try{if(0<Sb.data.te.length){const Wd=Object(B.a)(Object,ea.a(Sb.data.te)),je=Wd?Wd[this.rw.r0c]:null;je&&(cd=Object(B.a)(Object,ea.a(je.toString())))}Cc=!0}catch(Wd){this.dN(null)}Cc&&this.vFa&&this.vFa(Sb.data,cd)}dN(Sb){this.alb&&this.alb(Sb?Sb.data:null)}fcj(Sb){this.Gje&&this.Gje(Sb?Sb.data:null)}hO(Sb){this.lnb&&this.lnb(Sb?Sb.data:null)}Pkd(Sb){const Cc=
new Sys.StringBuilder("requestedsettings=");for(let cd=0;cd<Sb.count;cd++)Cc.append(Sb.ma(cd)),cd<Sb.count-1&&Cc.append(";");return Cc.toString()}}Object(c.a)(ha,"FirstRunExperienceRequestHandler",null,[]);var X=a(239),T=a(84);class ua{constructor(){this.Tkb=this.MVb=this.rw=null}UWd(Sb){Sb?(this.rw=Sb,this.Ewi()&&(b.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Sb=new la.a,Sb.add(this.rw.r0c),this.MVb=new ha(this.rw,Object(z.a)(this,
this.s5,"getRequestSuccessCallback"),Object(z.a)(this,this.dN,"getRequestFailureCallback"),null,Object(z.a)(this,this.hO,"postRequestFailureCallback")),this.MVb.sbc(Sb)),(this.rw.E9a||f.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.VWd()):b.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}Ewi(){try{if(this.rw.E9a)return!0;if(!f.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",
!0)||f.AFrameworkApplication.fa.ra("IsAnonymousUser"))return!1;if(this.rw.hti||this.rw.H9a||f.AFrameworkApplication.fa.ra("IsO365ConsumerHost"))return!0;const Sb=f.AFrameworkApplication.fa.Wa("FlightId");return-1!==(Sb?Sb.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Sb){b.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Sb?Sb.toString():null)}return!1}F4f(Sb){const Cc={},cd={};cd.FREDisplayedDate=(new Date).toUTCString();cd.VersionDisplayed=Sb;cd.RemindMeLater=
!1;Cc[this.rw.r0c]=ea.c(cd);b.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.MVb&&this.MVb.J4a(Cc)}s5(Sb,Cc){Sb=Sb?+Sb.g4-+Sb.HF:-1;Sb>this.rw.t3f?b.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Sb,this.rw.t3f):Cc?this.YNj(Cc)?(b.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.rw.pzf),this.VWd()):(this.mad(!1),b.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(b.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.VWd())}dN(Sb){this.mad(!1);b.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Sb?Sb.httpStatus:-1)}hO(Sb){b.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
Sb?Sb.httpStatus:-1)}VWd(){this.mad(!0);var Sb=T.a.instance.yg("Common.ISystemInitiatedFeedback");Sb?this.zcg(Sb):(b.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),f.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Sb=T.a.instance.$b("Common.ISystemInitiatedFeedback"))?Sb.execute(Cc=>{this.zcg(Cc)}):b.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}zcg(Sb){if(Sb){var Cc=
this.rw.oNh;Cc&&(f.AFrameworkApplication.Uma(Cc),f.AFrameworkApplication.Fs(Cc));b.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Cc);Sb.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.Tkb=Object(z.a)(this,this.TXi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.Tkb,!0),window.addEventListener("FRELaunchedEvent",this.Tkb,!0)):(b.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.F4f(this.rw.currentVersion))}else b.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}TXi(Sb){if(Sb){var Cc=Sb.detail;Sb=Sb.type;var cd=this.rw&&this.rw.campaignId?this.rw.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===Sb||cd&&Cc&&Cc.id&&-1!==Cc.id.indexOf(cd))Cc.success&&(b.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.F4f(this.rw.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",
this.Tkb,!0),window.removeEventListener("FRELaunchedEvent",this.Tkb,!0))}}YNj(Sb){if("RemindMeLater"in Sb&&"FREDisplayedDate"in Sb){if("true"===Sb.RemindMeLater.toString()&&(+new Date-+new Date(Sb.FREDisplayedDate.toString()))/36E5>this.rw.pzf)return!0}else if(f.AFrameworkApplication.fa.ra("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Sb&&Sb.VersionDisplayed<this.rw.currentVersion)return b.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),
!0;return!1}mad(Sb){f.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&X.a.dispatch("FREDecisionEvent",{["show"]:Sb})}}Object(c.a)(ua,"FirstRunExperienceLauncher",null,[912]);class Ha{constructor(){this.ib=null}get name(){return"Common.App.FirstRunExperienceLauncher"}ki(Sb){this.ib=Sb;this.ib.register(912,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").zc().Gc(()=>new ua)}init(){}dispose(){}static main(){ca.a.instance.dj(new Ha)}}
Object(c.a)(Ha,"FirstRunExperienceLauncherPackage",null,[4,5]);var Ca=a(10),Ga=a(228),sa=a(1);class bb{constructor(Sb){this.$=Sb}get r0c(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get hti(){return this.isEnabled()&&sa.EwaSettings.ya(295)}get H9a(){return this.isEnabled()&&sa.EwaSettings.ya(297)}get E9a(){return sa.EwaSettings.ya(296)}get oNh(){return null}get pzf(){return 24}get t3f(){return 4E3}get QMb(){return this.$.xa.WebServiceBase||
""}isEnabled(){if(f.AFrameworkApplication.fa?f.AFrameworkApplication.fa.ra("IsAnonymousUser"):1)return!1;const Sb=f.AFrameworkApplication.Yb?Object(B.a)(String,f.AFrameworkApplication.Yb.AudienceGroup):"";return"Unknown"!==Sb&&"Automation"!==Sb}}Object(c.a)(bb,"FirstRunExperienceLauncherSettings",null,[932]);class Ba{constructor(Sb,Cc){this.b0e=Sb;this.bNh=Cc}UWd(){this.b0e&&this.b0e.UWd(this.bNh)}}Object(c.a)(Ba,"FirstRunExperienceManager",null,[933]);var qa=a(721);class pa extends Ga.a{constructor(Sb){super();
this.$=Sb;this.Mb()}create(){const Sb=Object(qa.a)(this.$.da,311,()=>this.Chh());this.vb(Sb)}Chh(){var Sb=new bb(this.$);Sb=new Ba(T.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),Sb);Sb.UWd();return Sb}static la(Sb){Sb.da.Ha(312,new pa(Sb))}}Object(c.a)(pa,"FirstRunExperienceManagerFactory",Ga.a,[]);var ya=a(61);class za extends Ga.a{constructor(Sb){super();this.Mpd=null;this.$=Sb;this.Mb()}create(){const Sb=Object(qa.a)(this.$.da,361,()=>this.nih());this.vb(Sb)}nih(){this.Mpd=
T.a.instance.yg("Common.IInProductMessagingUIManager");ya.a.Ag.Ou?U.a.get_instance().ek(16,()=>{this.bif()}):this.bif();return this.Mpd}bif(){T.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Sb=>{Sb.isFeatureEnabled("MsoPremiumBadge",!0).then(Cc=>{!Cc&&Sb.isFreemiumUpsellEnabled()&&this.Mpd.Ptf();return null})})}static la(Sb){Sb.da.Ha(362,new za(Sb))}}Object(c.a)(za,"InProductMessagingManagerFactory",Ga.a,[]);var cb=a(51),Pa=a(425),nb=a(86),Ma=a(538),Oa=a(21),
La=a(588);class ra extends Ma.a{constructor(Sb){super(1);this.Lga=!1;this.ODf=()=>{this.refresh()};this.PDf=()=>{this.refresh()};this.gridView=Oa.h(Sb);this.gridView.hc.An(this.PDf);this.gridView.hc.Bm(this.ODf);this.refresh()}get uI(){return this.qpc(this.Lga)}QUd(Sb){this.Lga!==Sb&&(this.Lga=Sb,this.vKb())}get name(){return La.a.cellEdit}dispose(){this.gridView.hc.sn(this.PDf);this.gridView.hc.km(this.ODf);this.gridView=null;super.dispose()}vKb(){this.qLd(this.Lga)}refresh(){this.QUd(!this.gridView.jb)}}
Object(c.a)(ra,"CellEditSafeStatePublisher",Ma.a,[]);var V=a(40),ma=a(125);class W{constructor(Sb,Cc){this.handler=null;this.publisher=Sb;this.uI=Cc}}Object(c.a)(W,"SafeStatePublisherState",null,[]);var aa=a(625);const ia=Sb=>Sb?`${Sb.Current} / ${Sb.Pending} @${Sb.SuspensionStartTimestamp}`:null,ka=Sb=>(null===Sb||void 0===Sb?void 0:Sb.SuspensionStartTimestamp)&&Sb.Pending>Sb.Current;class Xa extends V.a{constructor(Sb,Cc){super();this.Bsf=null;this.i$a=!1;this.fIb=(cd,Wd)=>{3===Wd.azf&&this.i$a&&
b.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.i$a=!0;this.$cb()};this.USa=new la.a;this.Cza=Sb;this.aoa=Cc;this.cCb=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.k9a=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");this.cCb&&(this.aoa.H_a(this.gAa.bind(this)),this.k9a?this.Cza.Mte(this.fIb):this.Cza.LRg(this.NIf.bind(this)))}get H4j(){return ma.f(ma.c(this.USa.toArray(),
Sb=>0!=Sb.uI),Sb=>Sb.publisher.name)}S1b(Sb){this.addHandler(Xa.TSa,Sb)}bxc(Sb){this.removeHandler(Xa.TSa,Sb)}nBa(Sb,Cc){const cd=new W(Sb,Cc);this.USa.add(cd);Cc=(Wd,je)=>{cd.uI=je.uI;this.$cb()};Sb.S1b(Cc);cd.handler=Cc;this.$cb()}W1d(Sb){let Cc=null;for(let cd of this.USa)if(cd.publisher===Sb){this.nmg(cd);Cc=cd;break}Cc&&(this.USa.remove(Cc),this.$cb())}dispose(){for(let Sb of this.USa)this.nmg(Sb);this.USa.clear();this.cCb&&(this.aoa.Tdb(this.gAa.bind(this)),this.k9a?this.Cza.s_f(this.fIb):this.Cza.wqj(this.NIf.bind(this)));
super.dispose()}Adc(){let Sb=$a.Adc(this.USa.toArray().map(Cc=>Cc.uI));return this.i$a&&1===Sb?2:Sb}nmg(Sb){Sb.publisher.bxc(Sb.handler)}$cb(){const Sb=this.Adc();Sb!==this.Bsf&&(this.raiseEvent(Xa.TSa,new aa.a(Sb)),this.Bsf=Sb)}NIf(){this.i$a&&b.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");this.i$a=!0;this.$cb()}gAa(Sb,Cc){Sb=Cc.Bda;(Cc=!ka(Sb))||(Cc=this.UDi,Cc=(null===Sb||void 0===Sb?void 0:Sb.SuspensionStartTimestamp)!==
(null===Cc||void 0===Cc?void 0:Cc.SuspensionStartTimestamp));Cc&&(this.i$a=!1);this.UDi=Sb;this.$cb()}}Xa.TSa="SSC";Object(c.a)(Xa,"ClientStateMonitor",V.a,[]);var sb=a(8),ib=a(74);class Ub extends Ma.a{constructor(Sb,Cc=null){super(1);this.Lga=!1;this.VN=()=>{this.refresh()};this.VEf=()=>{this.refresh()};this.$=Sb;this.yce=Cc||ib.a(Sb).TQ(sb.a.idle);ib.a(Sb).RZc(this.VEf);this.r7a.Iq(this.VN);this.refresh()}get uI(){return this.qpc(this.Lga)}QUd(Sb){Sb!==this.Lga&&(this.Lga=Sb,this.vKb())}get name(){return La.a.r7a}get r7a(){return this.yce}dispose(){ib.a(this.$).Jwc(this.VEf);
this.r7a.gr(this.VN);this.yce=null;super.dispose()}vKb(){this.qLd(this.Lga)}refresh(){this.QUd(1===this.r7a.Ju||ib.a(this.$).Zh===this.r7a)}}Object(c.a)(Ub,"IdleActivitySafeStatePublisher",Ma.a,[]);var hc=a(327),yb=a(5),Gb=a(23);class Sa extends nb.a{constructor(){super()}Oc(){return!1}executeCommand(){return v.Task.Ua(!0)}Ac(Sb,Cc){return 1905775613===Cc.command}Vc(){return!1}}Object(c.a)(Sa,"ToggleMergeSuspensionSafeState",nb.a,[233]);class db extends V.a{constructor(Sb,Cc){super();this.statusBarManager=
null;this.VCd=!1;this.gAa=(cd,Wd)=>{cd=`${Wd.Bda.Current===Wd.Bda.Pending?"\u26ad":"\u26ae"}${Wd.Bda.Current}`;Gb.a.equals(this.Zpc,cd,!1)||(this.Zpc=cd,this.Uz())};this.JQa=(cd,Wd)=>{cd=0==Wd.uI;this.VCd!==cd&&(this.VCd=cd,this.Uz())};this.mergeSuspensionManager=Cc;this.mergeSuspensionManager.aoa.H_a(this.gAa);this.Zpc="";hc.a.N$(1905775613,yb.a.tc,0,1);this.Ia=Sb.Ia;this.bRb=new Sa;Sb.da.kb(29,cd=>{this.mergeSuspensionManager&&(this.statusBarManager=cd,cd.OJ(this),this.mergeSuspensionManager.Oia.S1b(this.JQa))});
this.Ia.p3(this.bRb)}Iq(Sb){this.addHandler(db.yBd,Sb)}gr(Sb){this.removeHandler(db.yBd,Sb)}Uz(){this.raiseEvent(db.yBd)}Qn(Sb){return Sb===db.wfj&&!!this.mergeSuspensionManager}ns(Sb,Cc){if(!this.Qn(Sb))return!1;this.mergeSuspensionManager&&(Cc.LabelText=this.Zpc,Cc.On=this.VCd);return!0}dispose(){this.bRb&&(this.Ia.Jdb(this.bRb),this.bRb.dispose(),this.bRb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.aoa.Tdb(this.gAa),this.mergeSuspensionManager.Oia.bxc(this.JQa),this.mergeSuspensionManager=
null);this.statusBarManager&&(this.statusBarManager.fG(this),this.statusBarManager=null);this.Zpc=null;super.dispose()}}db.yBd="MSMSC";db.wfj="QueryMergeSuspensionStatus";Object(c.a)(db,"MergeSuspensionIndicatorManager",V.a,[229,230,2]);var fb=a(2),ab=a(904);class wb extends Sys.EventArgs{constructor(Sb){super();this.vya=Sb}}Object(c.a)(wb,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class kb{}Object(c.a)(kb,"SuspensionState",null,[]);class tb extends kb{constructor(Sb){super();
this.Ave=!1;this.Ave=Sb}}Object(c.a)(tb,"ReadyForPendingMergeState",kb,[]);const hb=new kb,Fb=new kb,va=new tb(!1),jb=new tb(!0);var Ab=a(905);class Qa extends Ab.a{constructor(Sb,Cc,cd){super(Sb);this.YUg=Cc;this.ERj=cd}}Object(c.a)(Qa,"ReadyForPendingMergesUpdatedEventArgs",Ab.a,[]);class Z extends V.a{constructor(Sb,Cc,cd){super();this.gAa=(Wd,je)=>{Wd=this.getState();const Ee=this.i0;this.i0=je.Bda;je=this.getState();this.bJi(Wd,je,Ee);this.raiseEvent(Z.tBd);this.M_e(Wd,je)};this.JQa=(Wd,je)=>
{Wd=this.getState();this.uI=je.uI;je=this.getState();this.M_e(Wd,je)};this.fIb=(Wd,je)=>{this.k9a&&4===je.azf&&(b.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",ia(this.i0),ia(je.i0)),this.OUf(this.getState(),!0))};this.cCb=sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.k9a=sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");
this.Oia=Sb;this.Oia.S1b(this.JQa);this.aoa=Cc;this.aoa.H_a(this.gAa);this.k9a&&(this.Cza=cd,this.Cza.Mte(this.fIb));this.i0=Object(fb.a)(new ab.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.uI=this.$ki()}$ki(){return Object(Pa.a)(Xa,this.Oia)?Object(B.a)(Xa,this.Oia).Adc():1}X1b(Sb){this.addHandler(Z.i0d,Sb)}gxc(Sb){this.removeHandler(Z.i0d,Sb)}xSg(Sb){this.addHandler(Z.aMd,Sb)}Yqj(Sb){this.removeHandler(Z.aMd,Sb)}KRg(Sb){this.addHandler(Z.tBd,Sb)}vqj(Sb){this.removeHandler(Z.tBd,Sb)}vhj(){this.nLd(this.getState()===
Fb)}dispose(){this.Oia.bxc(this.JQa);this.Oia=null;this.aoa.Tdb(this.gAa);this.aoa=null;this.k9a&&(this.Cza.s_f(this.fIb),this.Cza=null);super.dispose()}ekd(){return Object(fb.a)(new ab.a,{Current:this.i0.Current,Pending:this.i0.Pending,SuspensionStartTimestamp:this.i0.SuspensionStartTimestamp})}getState(){return ka(this.i0)?0==this.uI?jb:this.cCb&&1==this.uI?va:Fb:hb}M_e(Sb,Cc){Sb!==Cc&&(Cc===Fb?this.nLd(!0):Sb===Fb&&this.nLd(!1));this.OUf(Cc)}OUf(Sb,Cc=!1){Sb instanceof tb&&this.raiseEvent(Z.aMd,
new Qa(this.i0,Sb.Ave||!this.cCb,Cc))}bJi(Sb,Cc,cd){Sb===hb&&Cc!==hb?(Sb=Cc===Fb,Cc=Cc===va,b.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${Cc} publisher: ${Cc||Sb?this.Oia.H4j.join(","):""} counter: ${ia(this.i0)} isBlockingAllMerges: ${Sb}`)):Sb!==hb&&Cc===hb&&b.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${ia(cd)}`)}nLd(Sb){this.raiseEvent(Z.i0d,
new wb(Sb))}}Z.i0d="TPMBBC";Z.aMd="RFPMU";Z.tBd="MCC";Object(c.a)(Z,"MergeSuspensionStateHandler",V.a,[]);class wa extends V.a{constructor(Sb){super();this.K2=null;this.bnc=0;this.kGb=(Cc,cd)=>{(null===cd||void 0===cd?0:cd.Bda)&&this.CQa(cd.Bda,wa.P4d)};this.Tzc=()=>{this.d2f();this.EUf(this.K2,wa.zuj)};this.eFd=(Cc,cd)=>{cd.u2a&&this.K2.SuspensionStartTimestamp&&b.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${ia(this.K2)}`)};this.d2f();this.$=Sb;this.$.ea.Zj(this.Tzc);
this.$.ea.pM(this.Tzc);Oa.h(this.$).hc.Bm(this.eFd);this.$.da.kb(292,Cc=>{Cc.H_a(this.kGb);b.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}H_a(Sb){this.addHandler("MCU",Sb)}Tdb(Sb){this.removeHandler("MCU",Sb)}get i0(){return this.K2}CQa(Sb,Cc=""){const cd=this.K2.Current<Sb.Current||this.K2.Pending<Sb.Pending;if(Sb.SuspensionStartTimestamp&&this.bnc!==Sb.SuspensionStartTimestamp){if(this.bnc>Sb.SuspensionStartTimestamp){cd&&b.ULS.sendTraceTag(553736149,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${Cc}. S: ${wa.jGb(Sb)}, C: ${wa.jGb(this.K2)}`);
return}cd||b.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${wa.jGb(Sb)}, C: ${wa.jGb(this.K2)}`)}else if(!cd)return;this.K2=Sb;this.EUf(Sb,Cc)}dispose(){this.$.ea.xk(this.Tzc);this.$.ea.iS(this.Tzc);Oa.h(this.$).hc.km(this.eFd);const Sb=this.$.da.Aa(292);Sb&&Sb.Tdb(this.kGb);super.dispose()}EUf(Sb,Cc=""){ka(Sb)&&Sb.SuspensionStartTimestamp>this.bnc&&(b.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${ia(Sb)}, Origin: ${Cc}`),
this.bnc=Sb.SuspensionStartTimestamp);this.raiseEvent("MCU",new Ab.a(Sb))}d2f(){b.ULS.sendTraceTag(588276808,0,50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${wa.jGb(this.K2)}`);this.K2=Object(fb.a)(new ab.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static jGb(Sb){return Sb?`(${Sb.Current}/${Sb.Pending} @${Sb.SuspensionStartTimestamp})`:"null"}}wa.P4d="PMM.RTC";wa.N$b="PMM.EwaResult";wa.zuj="PMM.resetMergeCounter";Object(c.a)(wa,"PendingMergeMonitor",V.a,[]);class Ea{}Object(c.a)(Ea,
"ClientRevisions",null,[]);var fa=a(47),Ua=a(65);const Aa=(Sb,Cc,cd,Wd,je,Ee,Ue,gf=null)=>{gf=Sb.Oa(1,gf);gf.viewportState=Cc;gf.allowViewAdjustment=cd;return Ua.g(Sb,"DoPendingMerge",gf,Wd,je,Ee,Ue,0)},Ib=(Sb,Cc,cd,Wd,je,Ee,Ue=null)=>{Ue=Sb.Oa(1,Ue);Ue.suspensionStartTimestamp=Cc;return Ua.g(Sb,"KeepBlockingPendingMerges",Ue,cd,Wd,je,Ee,0)};class Pb extends V.a{constructor(Sb,Cc,cd,Wd){super();this.wKa=null;this.lEb=0;this.mEb=this.W9a=null;this.wKf=(je,Ee)=>{this.wKa.FYg(Ee.Bda,Ee.YUg,Ee.ERj)};
this.GIb=(je,Ee)=>{Ee.vya?this.XTj():this.kDc()};this.MIf=()=>{this.lEb=0};this.C6f=()=>{const je=this.Y6.ekd();Ib(this.va,null!=je.SuspensionStartTimestamp?je.SuspensionStartTimestamp:0,null,()=>{this.x0i(je)},null,null,this.va.ic())};this.QDa=(je,Ee)=>{if(Ee){Ee.uqb.MergeCount=this.Y6.ekd();let Ue;({min:je,max:Ue}=Oa.h(this.$).hOi());sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Ee.uqb.ClientRevisions=Object(fb.a)(new Ea,{Min:je,Max:Ue,MaxFromBlockCache:Oa.h(this.$).Ca.yyf}):
Ee.uqb.ClientRevisions=Object(fb.a)(new Ea,{Min:je,Max:Ue})}};this.$=Sb;this.B0a=cd;this.Y6=Cc;this.Y6.xSg(this.wKf);this.Y6.X1b(this.GIb);this.Y6.KRg(this.MIf);this.$.pa.$ha(this.QDa);this.va=this.$.pa.va;this.OPd=this.$.xa.MergeSuspensionRequestThrottlingTimeInMs;this.oDi=this.$.xa.KeepBlockingPendingMergesRequestIntervalMs;this.wKa=Wd;b.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.pa.Boa(this.QDa);this.kDc();this.Y6.Yqj(this.wKf);this.Y6.gxc(this.GIb);this.Y6.vqj(this.MIf);
this.Y6=null;super.dispose()}XTj(){this.kDc();if(this.XOe()){const Sb=this.Y6.ekd();b.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${ia(Sb)} fail count: ${this.lEb}`)}else this.mEb=this.B0a.create(this.C6f,this.OPd,fa.a.mEb),this.W9a=this.B0a.cD(this.C6f,this.oDi,fa.a.W9a)}kDc(){this.W9a&&(this.mEb.cancel(),this.W9a.cancel(),this.W9a=this.mEb=null)}x0i(Sb){let Cc;
Cc=" fail count: "+this.lEb;this.lEb++;this.XOe()&&this.kDc();b.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${ia(Sb)}${Cc}`)}XOe(){return this.lEb>Pb.UMi}}Pb.UMi=5;Object(c.a)(Pb,"RequestController",V.a,[]);var Fa=a(170),da=a(205),K=a(31),xa=a(293);class rb extends Sys.EventArgs{constructor(Sb,Cc){super();this.azf=Sb;this.i0=Cc}}Object(c.a)(rb,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);class Qb extends V.a{get ENa(){return 0<this.cHd}constructor(Sb,
Cc,cd=null,Wd=null,je=null){super();this.anc=null;this.cHd=0;this.documentVisibilityObserver=null;this.Qrf=!1;this.opc=null;this.va=Sb;this.OPd=Cc.xa.MergeSuspensionRequestThrottlingTimeInMs;const Ee=Cc.xa.GetRangeContentPrefetchDelayForMergeInMs;this.Oy=()=>{Cc.m5f(Ee)};this.Hh=cd||K.a.Ya;this.upg=0;this.FL=Wd;this.TBa=je;Cc.da.kb(291,Ue=>{this.documentVisibilityObserver=Ue})}LRg(Sb){this.addHandler(Qb.zBd,Sb)}wqj(Sb){this.removeHandler(Qb.zBd,Sb)}Mte(Sb){this.addHandler(Qb.uBd,Sb)}s_f(Sb){this.removeHandler(Qb.uBd,
Sb)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.oi}FYg(Sb,Cc,cd=!1){this.jPb(Sb,Cc,cd)?(new Fa.a).setResult(!0):(Cc=this.D$i(Sb,Cc),this.anc=Sb,this.cHd++,Cc.continueWith(()=>{this.VWi()},0,da.a.none,this.FL))}D$i(Sb,Cc){this.upg=this.Hh.Ufa;this.Qrf=Cc;b.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${Sb.Current} / ${Sb.Pending} @${Sb.SuspensionStartTimestamp}. allowSelectionAdjustment: ${Cc}`);
this.isDocumentHidden||this.Oy();return this.hBj(Cc,Sb)}jPb(Sb,Cc,cd=!1){if(this.TBa&&!Cc&&!this.TBa.vAi())return b.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.anc||Sb.SuspensionStartTimestamp>this.anc.SuspensionStartTimestamp)return this.ENa&&b.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${Sb.Current} / ${Sb.Pending} @${Sb.SuspensionStartTimestamp}`),
!1;if(this.ENa)return!0;if(cd)return!1;cd=this.anc;const Wd=this.Hh.Ufa-this.upg<this.OPd;Cc=this.Qrf===Cc;return(Sb||cd?Sb&&cd?Sb.Current===cd.Current&&Sb.Pending===cd.Pending&&Sb.SuspensionStartTimestamp===cd.SuspensionStartTimestamp:!1:!0)&&Wd&&Cc}hBj(Sb,Cc){const cd=this.va.ic(),Wd=()=>{b.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${Cc.Current} / ${Cc.Pending} @${Cc.SuspensionStartTimestamp}`)};return this.TBa?this.TBa.Ixj(this.DYh(Sb,Wd,cd)):
this.mCe(null,!0,void 0,Wd,cd)}DYh(Sb,Cc,cd){return(Wd,je,Ee)=>{let Ue=void 0;b.ULS.shipAssertTag(523317955,0,null!=Wd||Sb,"!allowSelectionAdjustment requires a non-null initialViewportState.");Ue=this.WWi.bind(this);je&&(Ue=xa.b.call(null,gf=>{const rf=gf.Result;let xf=null===rf||void 0===rf?void 0:rf.AdjustedViewportState;3===(null===rf||void 0===rf?void 0:rf.MergeResultState)&&(xf=void 0);je(xf,gf.StateId)},Ue));Ee&&(Cc=xa.a.call(null,Ee,Cc));return this.mCe(Wd,Sb,Ue,Cc,cd)}}mCe(Sb,Cc,cd,Wd,je){return Aa(this.va,
Sb,Cc,cd,Wd,null,null,je)}WWi(Sb){var Cc=Sb.Result;void 0!=Cc&&(Cc=Cc.MergeResultState,sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout")&&2!==Cc?this.opc=[Cc,Sb.MergeCount]:3===Cc&&(b.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.Ugj()))}Ugj(){this.raiseEvent(Qb.zBd,new Sys.EventArgs)}Tgj(Sb,Cc){this.raiseEvent(Qb.uBd,new rb(Sb,Cc))}VWi(){this.cHd--;if(this.opc){const Sb=this.opc;this.opc=null;this.Tgj(...Sb)}}}
Qb.zBd="MWA";Qb.uBd="MDO";Object(c.a)(Qb,"DoPendingMergeSender",V.a,[949,950]);class pc{constructor(Sb=!1){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.Rji=Sb}get reportName(){return this.Rji?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}Object(c.a)(pc,"SelectionAdjustSessionEndsReport",null,[286]);var Lb=
a(45);class qb{constructor(Sb,Cc,cd,Wd,je,Ee){this.pb=Sb;this.GG=Cc;this.A$=cd;this.HZb=Wd;this.I6d=je;this.$L=Ee}get activeCell(){return this.GG}get selectedRanges(){return this.A$}get Xq(){let Sb=!1;if(null===this.$L||void 0===this.$L)Sb=!0;else if(this.$L>=this.selectedRanges.length||!this.selectedRanges[this.$L].contains(this.activeCell))b.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.$L}, selectedRangesLength: ${this.selectedRanges.length}`),
Sb=!0;Sb&&(this.$L=this.B4g());return this.$L}get activeRange(){return 0>this.Xq?this.activeCell:this.selectedRanges[this.Xq]}get sheetName(){return this.HZb}get activeItemName(){return this.I6d}get Vtg(){return 1===this.selectedRanges.length}Dqg(Sb){let Cc=this.selectedRanges.map(cd=>this.X1j(cd,this.I6d));for(let cd of Cc)if(cd)for(let Wd of cd)if(Wd.qk&&Wd.pe.Revision<Sb)return!1;return!0}GZj(){var Sb;return{SheetName:this.sheetName,ActiveCell:null===(Sb=this.activeCell)||void 0===Sb?void 0:Sb.toString(),
TopLeft:void 0,SelectedRanges:Lb.r(this.selectedRanges,this.pb)}}toString(){var Sb,Cc;return`active cell: ${null!==(Cc=null===(Sb=this.activeCell)||void 0===Sb?void 0:Sb.toString())&&void 0!==Cc?Cc:"null"} selection: ${ma.f(this.selectedRanges,cd=>{var Wd;return null!==(Wd=null===cd||void 0===cd?void 0:cd.toString())&&void 0!==Wd?Wd:"null"}).join(",")}`}equals(Sb){return Sb?this.activeCell.equals(Sb.activeCell)&&Lb.R(this.selectedRanges,Sb.selectedRanges)&&this.sheetName===Sb.sheetName:!1}B4g(){for(let [Sb,
Cc]of this.selectedRanges.entries())if(null===Cc||void 0===Cc?0:Cc.contains(this.activeCell))return Sb;return-1}X1j(Sb,Cc){var cd;const Wd=Oa.h(this.pb).Ca.E5a(Sb,Cc);Wd||b.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==(cd=null===Sb||void 0===Sb?void 0:Sb.toString())&&void 0!==cd?cd:"null"} ; activeItemNameIsDefined: ${!!Cc}`);return Wd}}Object(c.a)(qb,"SelectionState",null,[]);var bc=a(220),sc=a(754);class Tb{constructor(Sb){this.eDc=
0;this.iH=this.EF=null;this.X6d=new pc;this.Y6d=new pc(!0);this.kI=0;this.SXj=!1;this.lOi=1E4;this.yd=()=>{this.KLe()};this.Pj=()=>{this.u1c(!0,!1)};this.Pab=()=>{this.u1c(!1,!1)};this.$=Sb;this.gridView=Oa.h(this.$);this.gridView.Ca.vw(this.Pj);this.gridView.Ca.uu(this.Pab);this.gridView.Ca.Rse(this.Pab);this.gridView.Ca.R$(this.Pab);this.$.rl(this.yd);this.KLe()}Ixj(Sb){let Cc=null,cd=null,Wd=()=>{this.xTi()};this.yjf()?(this.UP.parallel++,b.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.iH}`)):
(Cc=(je,Ee)=>{this.yTi(je,Ee)},cd=this.TGj());return null===Sb||void 0===Sb?void 0:Sb(cd,Cc,Wd)}vAi(){return!this.yjf()&&this.bca().Vtg}TGj(){var Sb;b.ULS.shipAssertTag(525135961,0,0===this.kI,"SelectionAdjustManager.setPreRequestState: unexpected state");this.iH&&(this.UP.errors++,b.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.iH.toString()}`));this.iH=null;this.EF=this.bca();let Cc=null;const cd=null===(Sb=this.EF)||
void 0===Sb?void 0:Sb.GZj();cd&&(Cc={ActiveSheetName:this.EF.sheetName,SheetViewportStateChanges:[cd]});this.kI=1;return Cc}xTi(){b.ULS.shipAssertTag(525135960,0,1===this.kI,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.UP.errors++;this.kI=2;this.Cr()}yTi(Sb,Cc){try{b.ULS.shipAssertTag(525135959,0,1===this.kI,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.eDc=Cc,Cc=2,this.EF?Sb?(this.iH=this.vKj(Sb))?(Cc=7,this.EF.equals(this.iH)?this.EF.equals(this.bca())?
(this.UP.adjustedDidntChange++,Cc=4):(this.UP.adjustedDidntChangeWithDivergence++,Cc=5):this.EF.sheetName!=this.iH.sheetName?(this.UP.differentSheetAdjust++,Cc=10):this.EF.equals(this.bca())||(this.UP.divergenceOnResponse++,Cc=6,this.I0f())):this.UP.errors++:(this.UP.errors++,b.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.EF.toString()}`)):(this.UP.errors++,b.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===
Sb||void 0===Sb?void 0:Sb.ActiveCell}`)),this.kI=Cc}catch(cd){this.kI=12,b.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${cd}`)}finally{7!=this.kI?this.Cr():this.u1c(!1,!0)}}dispose(){this.gridView.Ca.sx(this.Pj);this.gridView.Ca.Ls(this.Pab);this.gridView.Ca.EZf(this.Pab);this.gridView.Ca.nSa(this.Pab);this.$.lm(this.yd)}yjf(){return 1===this.kI||7===this.kI}vKj(Sb){let Cc;if(!({range:Cc}=Lb.ab(Sb.ActiveCell,this.$.ua)).returnValue)return b.ULS.sendTraceTag(537155411,
0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${Sb.ActiveCell}`),null;let cd=[];const Wd=this.$.na,je=!!Wd&&2===Wd.pG;if(Sb.SelectedRanges)cd=Lb.g(Sb.SelectedRanges.Ranges);else if(!je)return b.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!Wd}`),null;return new qb(this.$,Cc,cd,Sb.SheetName,this.EF.activeItemName,this.EF.Xq)}bca(){const Sb=this.$.na;if((null===
Sb||void 0===Sb?0:Sb.activeCell)&&Sb.selectedRanges&&Sb.sheetName)return new qb(this.$,Sb.activeCell,Sb.selectedRanges,Sb.sheetName,this.$.activeItemName,Sb.Xq);b.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!Sb}, activeCell null: ${!(null===Sb||void 0===Sb?0:Sb.activeCell)}, selectedRanges null: ${!(null===Sb||void 0===Sb?0:Sb.selectedRanges)}, sheetName null: ${!(null===Sb||void 0===Sb?0:Sb.sheetName)}`);return null}KLe(){this.$.da.kb(276,
()=>{const Sb=bc.a(this.$);Sb.$T(this.X6d);Sb.$T(this.Y6d)})}u1c(Sb,Cc){var cd;if(this.zyi(Sb))if(8===this.kI)b.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{Cc&&b.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{b.ULS.shipAssertTag(525135956,0,7===this.kI,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.EF.equals(this.bca())?(null===(cd=
this.gridView)||void 0===cd?0:cd.jb)?(this.UP.editBoxDivergence++,this.kI=11):(Sb=0,Sb=this.iH.Xq,-1==Sb?(this.UP.errors++,b.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):(this.UP.adjusted++,this.kI=8,this.gridView.ga.bE(this.iH.selectedRanges,Sb,this.iH.activeCell,0,void 0,"SelectionAdjust"))):(this.UP.divergenceOnViewportReady++,this.I0f(),this.kI=9)}catch(Wd){this.kI=12,b.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${Wd}`)}finally{this.Cr()}}}zyi(Sb){if(!this.iH)return!1;
if(!this.EF)return b.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.iH.toString()}`),!1;if(Oa.h(this.$).Ca.yyf<this.eDc)return!1;if(Sb||this.SXj)b.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.EF.Dqg(this.eDc)||!this.iH.Dqg(this.eDc))return!1;return!0}Cr(){this.EF=this.iH=
null;this.kI=0}I0f(){const Sb=this.bca();b.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.EF.toString()} current: ${Sb?Sb.toString():""} adjusted: ${this.iH.toString()} sheetSameBetweenInitialAndAdjusted: ${this.EF.sheetName===this.iH.sheetName} sheetSameBetweenInitialAndCurrent: ${this.EF.sheetName===(Sb?Sb.sheetName:null)}`)}get UP(){return sc.a.AD(this.lOi)?this.Y6d:this.X6d}}Object(c.a)(Tb,"SelectionAdjustManager",null,[948,2]);class $a extends nb.a{constructor(Sb,
Cc,cd=null){super();this.DEa=this.dic=this.s7a=this.J1a=null;this.$=Sb;this.SYa=new wa(Sb);this.TBa=new Tb(this.$);this.wKa=new Qb(this.$.pa.va,this.$,void 0,void 0,this.TBa);this.vli(Sb,cd);this.Vga=new Z(this.DEa,this.SYa,this.wKa);this.HPd=new Pb(Sb,this.Vga,Cc,this.wKa);sa.EwaSettings.ya(230)&&(this.dic=new db(Sb,this));b.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}X1b(Sb){this.Vga.X1b(Sb)}gxc(Sb){this.Vga&&this.Vga.gxc(Sb)}get Oia(){return this.DEa}get aoa(){return this.SYa}get Y6(){return this.Vga}nBa(Sb,
Cc){this.DEa.nBa(Sb,Cc)}W1d(Sb){this.DEa.W1d(Sb)}CQa(Sb,Cc=""){this.SYa.CQa(Sb,Cc)}dispose(){this.dic&&(this.dic.dispose(),this.dic=null);this.TBa&&this.TBa.dispose();this.wKa.dispose();this.HPd&&(this.HPd.dispose(),this.HPd=null);this.Vga&&(this.Vga.dispose(),this.Vga=null);this.SYa.dispose();this.SYa=null;this.DEa.dispose();this.DEa=null;this.J1a&&(this.J1a.dispose(),this.J1a=null);this.s7a&&(this.s7a.dispose(),this.s7a=null);this.$=null;super.dispose()}vKb(){this.Vga.vhj()}static Adc(Sb){let Cc=
0;for(let cd of Sb){if(2==cd)return 2;1==cd&&(Cc=1)}return Cc}vli(Sb,Cc){this.DEa=new Xa(this.wKa,this.SYa);Cc?Object(Pa.a)(Ub,Cc)?this.nBa(Cc,Object(B.a)(Ub,Cc).uI):Object(Pa.a)(ra,Cc)?this.nBa(Cc,Object(B.a)(ra,Cc).uI):this.nBa(Cc,0):(this.J1a=new ra(Sb),this.s7a=new Ub(Sb),this.nBa(this.J1a,this.J1a.uI),this.nBa(this.s7a,this.s7a.uI))}}Object(c.a)($a,"MergeSuspensionManager",nb.a,[930,2]);class Nb extends Ga.a{constructor(Sb){super();this.kd=Sb;this.Mb()}create(){b.ULS.sendTraceTag(537155419,0,
50,"MergeSuspensionFactory.Create");this.vb(this.kd.da.Aa(343)||this.kd.da.Ha(343,new $a(this.kd,cb.a.instance)))}static la(Sb){b.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");Sb.da.Ha(344,new Nb(Sb))}}Object(c.a)(Nb,"MergeSuspensionFactory",Ga.a,[]);var Ra=a(53),ob=a(39),mb=a(92),gb=a(104),lb=a(59),Xb=a(15);class Xd{}Xd.PFi=3;Xd.connected=0;Object(c.a)(Xd,"ConnectionStateConstants",null,[]);var Qd=a(118),te=a(126),Pc=a(49);class Ne{constructor(Sb,Cc,cd){var Wd;this.type=0;this.startTime=
null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.zDf=(je,Ee)=>{this.blockedOperationsCount++;je=`${Ee.componentName}_${Ee.actionName}_${Ee.details})`;this.blockedActions[je]=this.blockedActions[je]?
this.blockedActions[je]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.ZGd=je=>{this.durationUntilUserInactive=Qd.getElapsedSeconds(this.startTime,K.a.Ya.kc);je.NOd(this.ZGd)};this.zW=()=>{this.hasTabbedOut=!0};this.$da=(je,Ee)=>{Ee.zPf!==this.type||this.isToastShown||(this.durationUntilToastShownMs=te.a(K.a.Ya,this.startTime),this.toastRaiser=Ee.toastRaiser,this.isToastShown=!0)};this.startTime=Sb;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=
cd;if(null===(Wd=Cc.ea)||void 0===Wd?0:Wd.df)this.wasUserActiveOnPIStart=Cc.ea.df.kq;this.Mi(Cc);this.isDialogShown=0<Cc.ub.$R;Sb=Cc.da.Aa(183);this.isTaskPaneShown=!!Sb&&Sb.isVisible&&!Sb.isCollapsed;this.isTaskPaneCollapsed=!!Sb&&Sb.isVisible&&Sb.isCollapsed}p8f(){this.durationMs=te.a(K.a.Ya,this.startTime)}hGd(Sb){var Cc;this.p8f();Pc.a(Sb).NLb(this.zDf);Pc.a(Sb).ig.$wc(this.$da);Sb.da.kb(291,cd=>{cd.Pdb(this.zW)});if(null===(Cc=Sb.ea)||void 0===Cc?0:Cc.df)Sb.ea.df.NOd(this.ZGd),this.wasUserActiveOnPIEnd=
Sb.ea.df.kq}Mi(Sb){Pc.a(Sb).N1b(this.zDf);this.isToastShown?this.toastRaiser="Immediate":Pc.a(Sb).ig.k_c(this.$da);Sb.da.kb(291,Cc=>{this.hasTabbedOut=Cc.oi;Cc.DHa(this.zW)});this.wasUserActiveOnPIStart&&Sb.ea.df.yue(this.ZGd)}}Object(c.a)(Ne,"PartialInteractivityData",null,[]);var Hb=a(1081);class pb extends Ne{constructor(Sb,Cc,cd,Wd,je,Ee){super(Sb,Cc,Wd);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=
0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=null;this.type=4;this.swappedOffline=cd;this.disconnectionSource=Enum.toString(Hb.a,je);this.triggeringRequest=Ee}SVi(Sb,Cc){this.swappedByOffline=Cc;this.hGd(Sb)}BEj(Sb){this.errorDataDuringConnectivityIssuesMode=Sb}Qjj(Sb){10>this.failedRequests.length&&(Sb=Sb+"_"+Qd.getElapsedSeconds(this.startTime,K.a.Ya.kc).toString(),this.failedRequests.push(Sb))}}Object(c.a)(pb,"ConnectivityIssuesData",
Ne,[]);var mc=a(173),Kc=a(136),Nc=a(121);class pd{}pd.nuh="DuringWork";pd.connectivityIssues="ConnectivityIssues";pd.offline="Offline";Object(c.a)(pd,"UnavailabilityTypes",null,[]);var Vd=a(55);class $d{constructor(Sb){this.Wmc=this.data=null;this.ped=0;this.lIe=null;this.JEf=(Cc,cd)=>{cd.iM?(this.data=new pb(K.a.Ya.kc,this.$,5===cd.Rpa,0!==cd.Rpa,this.$.ef.disconnectionSource,this.lIe),this.Wmc=this.$.ef.Jsf,this.ped=1,this.$.pa.ef.wTg(this.Mm),mc.a(this.$).SZc(this.D4f)):(this.data.SVi(this.$,5===
cd.Rpa),this.$.pa.ef.O_f(this.Mm),this.data.lastFailedRequestToOnlineTimeGapSec=Qd.getElapsedSeconds(this.Wmc,K.a.Ya.kc),sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?Vd.b().QNb(557682689,0,50,pd.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",lb.a.Fc(this.data)):b.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${lb.a.Fc(this.data)}`),
this.data&&this.data.isToastShown&&gb.Health.instance.recordQosError(Kc.a.M9g,[Nc.a.Enc],!0,!1,!1,!1,null),mc.a(this.$).fOd(this.D4f),this.data=null)};this.D4f=(Cc,cd)=>{this.data.BEj(cd.gV)};this.Mm=(Cc,cd)=>{this.data.Qjj(cd.context.methodName);Cc=K.a.Ya.kc;cd=Qd.getElapsedSeconds(this.Wmc,Cc);this.Wmc=Cc;cd>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=cd);this.ped++;this.data.averageDurationBetweenFailedRequestsSec=this.o4g(cd)};this.GEf=
(Cc,cd)=>{this.lIe=cd.u1j};this.$=Sb;Pc.a(this.$).ig.ate(this.JEf);this.$.ef.$se(this.GEf)}dispose(){this.$&&(Pc.a(this.$).ig.OZf(this.JEf),this.$.ef&&this.$.ef.NZf(this.GEf));this.data&&this.$.pa.ef.O_f(this.Mm);this.$=null}o4g(Sb){const Cc=this.ped-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Cc-1)+Sb)/Cc}}Object(c.a)($d,"ConnectivityIssuesTelemetryManager",null,[2]);var ue=a(883),he=a(9),Ge=a(1080),Ad=a(1079);class Ie{constructor(Sb){this.F3f=null;this.ixd=this.IBd=this.iHb=this.jHb=
0;this.fWd=!1;this.A6c=this.vUa=this.ECc=this.rab=null;this.O6c=0;this.cBj=()=>{if(12E4>this.$.ea.df.Zgb)for(let Cc of this.ECc)Cc.runTest();else this.ZYd("UserInactive")};this.Btj=Cc=>{Cc=Sys.Serialization.JavaScriptSerializer.serialize(Cc);b.ULS.sendTraceTag(388821830,0,50,Cc)};this.Rsj=Cc=>{if(Cc){var cd=this.A6c[Cc.testIteration.toString()];cd?cd.push(Cc):(cd=[Cc],this.A6c[Cc.testIteration.toString()]=cd);if(cd.length===this.F3f.length){cd=Sys.Serialization.JavaScriptSerializer.serialize(cd);
if(this.$&&this.$.ef){if(Cc.EstimatedLatency=this.$.ef.qze,this.$.ef.qze>this.$.nz.ExcelRountripThresholdMs){b.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${cd}, consequtive slow ping iteration #: ${this.O6c++}`);return}}else b.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");b.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${cd}`);this.O6c=1}}};this.xh=(Cc,cd)=>{Cc=cd.context.methodName;
if(Cc===he.a.fzb||Cc===he.a.Xwa)this.iHb++,Cc=Date.now(),this.dMj(Cc)&&(this.iHb=0,this.ixd=Cc,this.pUj())};this.Zda=()=>{this.BYd("OnThrottledUserActivity")};this.zW=()=>{this.ZYd("OnDocumentHidden")};this.AI=()=>{this.BYd("OnDocumentUnhidden")};this.$=Sb;if(this.gWd=this.c8g())this.F3f=[Ad.a.uIc],this.O6c=1,this.A6c={},this.$.ea.df.Zha(this.Zda),this.$.da.kb(291,Cc=>{Cc.DHa(this.zW);Cc.yta(this.AI)})}dispose(){this.$&&(this.fWd&&this.$.pa&&0<this.rab.count&&this.$.pa.Ms(this.xh),this.gWd&&(this.ZYd("Dispose"),
this.$.ea.df.uBa(this.Zda)))}Zki(){sa.EwaSettings.ya(199)&&this.Bcj();this.gWd&&this.Ccj()}wli(){this.iHb=this.jHb;this.ixd=0;var Sb={};if(!this.rab){this.rab=new la.a;const Cc=Ge.a.Vgd(this.Btj,"InitSampleMeasurement",this.$);for(const cd of Cc)Sb[cd.Sod]=cd.baseUrl,this.rab.add(cd)}Sb=Sys.Serialization.JavaScriptSerializer.serialize(Sb);b.ULS.sendTraceTag(537155210,0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.jHb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.iHb}, testParams: ${Sb} `);
0<this.rab.count&&this.$.pa.ur(this.xh)}pUj(){for(let Sb of this.rab)Sb.runTest()}BYd(Sb){this.vUa&&this.vUa.lo||(b.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${Sb}`),this.vUa=cb.a.instance.cD(this.cBj,5E3,fa.a.iSj),this.vUa.XV())}ZYd(Sb){this.vUa&&this.vUa.lo&&(b.ULS.sendTraceTag(537155207,0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${Sb}`),this.vUa.cancel())}dMj(Sb){return this.iHb>=this.jHb&&Sb-this.ixd>
this.IBd}c8g(){return Ie.v3f(this.$.xa.SlowNetworkMeasurementsSamplePercentage)}Bcj(){this.jHb=this.$.xa.NumberOfRequestToWaitPerNetworkMeasurement;this.IBd=1E3*this.$.xa.MinTimeBetweenNetworkMeasurementInSec;const Sb=this.$.xa.NetworkMeasurementsSamplePercentage;0<this.jHb&&0<this.IBd&&(this.fWd=Ie.v3f(Sb))&&this.wli()}Ccj(){if(!this.ECc){this.ECc=new la.a;const Sb=Ge.a.Vgd(this.Rsj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Ad.a.uIc]);for(const Cc of Sb)this.ECc.add(Cc);this.$.ea.df.kq&&
this.BYd("PrepareAndInitSlowNetworkTests")}}static v3f(Sb){return 100*Math.random()<Sb}}Object(c.a)(Ie,"NetworkMeasurement",null,[2]);var me=a(138),cc=a(813);class $c{constructor(Sb){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=Sb}get count(){return this._count}get MU(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}b6j(){this.MU&&
this.MU.p8f()}YNg(Sb){this.allOfflinePartialInteractivitiesDataInSession.push(Sb);this._count++}}Object(c.a)($c,"OfflinePartialInteractivitiesDataForLog",null,[]);class rd extends Ne{constructor(Sb,Cc,cd){super(Sb,Cc,cd);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=null;this.timeFromLastOffline=-1;this.type=5}jIj(Sb){this.timeFromLastOffline=Sb}CEj(Sb){this._errorDataDuringOfflineMode=Sb}}Object(c.a)(rd,"OfflinePartialInteractivityData",Ne,[]);class Nd{constructor(Sb,Cc){this.lQa=this.MU=
null;this.aKd=-1;this.exb=null;this.Dsf=v.Task.delay(0);this.obb=(cd,Wd)=>{Wd.iM?this.$1i(Wd.Rpa):this.a2i()};this.$da=(cd,Wd)=>{5===Wd.zPf&&this.$4a()};this.E4f=(cd,Wd)=>{this.MU.CEj(Wd.gV)};this.$4a=()=>{this.lQa.b6j();this.Ayj(Nd.cId,Sys.Serialization.JavaScriptSerializer.serialize(this.lQa))};this.rtj=cd=>{if(cd=cd.result)this.Vqg=!0,b.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${cd}`)};
this.Inj=()=>{this.Vqg&&(this.$?ob.TaskExtensions.za(this.indexedDB.I$c(Nd.cId),()=>{b.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.ka):b.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.qQa=()=>{if(this.lQa&&0<this.lQa.count){const cd=Sys.Serialization.JavaScriptSerializer.serialize(this.lQa);
b.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${cd}`)}};this.$=Sb;this.indexedDB=Cc;this.Vqg=!1;this.indexedDB.Pe()&&(this.indexedDB.initialize(Nd.bBb,Nd.cBb),this.Msj(),this.lQa=new $c(this.$.xa.UserSessionId),Pc.a(this.$).ig.e_c(this.obb));this.Tm=me.a.instance.uH();this.Tm.la("beforeunload",this.qQa)}dispose(){this.$&&Pc.a(this.$)&&Pc.a(this.$).ig.uOd(this.obb);mb.a.Ja(this.exb);this.$=this.exb=null}$1i(Sb){this.MU=
new rd(K.a.Ya.kc,this.$,0!==Sb);this.MU.jIj(-1!==this.aKd?window.performance.now()-this.aKd:-1);this.lQa.YNg(this.MU);Pc.a(this.$).ig.k_c(this.$da);this.$4a();this.exb=cb.a.instance.cD(this.$4a,Nd.JNh,fa.a.$4a);mc.a(this.$).SZc(this.E4f)}a2i(){this.MU.hGd(this.$);this.$4a();mb.a.Ja(this.exb);this.exb=null;this.aKd=window.performance.now();Pc.a(this.$).ig.$wc(this.$da);mc.a(this.$).fOd(this.E4f);this.Ssj()}Ayj(Sb,Cc){this.$?this.Dsf=ob.TaskExtensions.za(this.Dsf,()=>{this.indexedDB.Leb(new cc.a(Sb,
Cc))},this.$.ka):b.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}Msj(){const Sb=this.$.ka;ob.TaskExtensions.za(ob.TaskExtensions.za(this.indexedDB.gMa(Nd.cId),this.rtj,Sb),this.Inj,Sb)}Ssj(){if(this.MU){const Sb=Sys.Serialization.JavaScriptSerializer.serialize(this.MU);sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Vd.b().QNb(560791645,0,50,pd.offline,this.MU.durationMs,
"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Sb):b.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${Sb}`)}this.MU&&this.MU.isToastShown&&gb.Health.instance.recordQosError(Kc.a.Z9j,[Nc.a.Enc],!0,!1,!1,!1,null)}}Nd.bBb="NetworkAvailability";Nd.cBb="NetworkAvailabilityData";Nd.cId="partialInteractivityData";Nd.JNh=3E3;Object(c.a)(Nd,
"OfflineModeTelemetryManager",null,[2]);var ed=a(1347);const yd=Sb=>{Sb.isSuccess||(Sb=Sys.Serialization.JavaScriptSerializer.serialize(Sb),b.ULS.sendTraceTag(509669840,0,10,Sb))};class Ed{constructor(Sb,Cc){this.jna=this.HCd=this.rCf=null;this.$=Sb;sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Q.a.Nf||(this.rCf=new Nd(Sb,Cc));sa.EwaSettings.ya(199)&&(this.HCd=new Ie(this.$),this.HCd.Zki());sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
Q.a.Nf||(this.jna=new ue.NetworkConnectionHealthChecker(this.$));this.Ach=new $d(this.$);sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(Sb=this.$,Cc=sa.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==Cc&&(new ed.a(Sb,"1CDN",Cc,yd,"runOneCdnNetworkTest")).runTest())}dispose(){mb.a.Ja(this.rCf);mb.a.Ja(this.HCd);mb.a.Ja(this.jna);mb.a.Ja(this.Ach);this.$=null}}Object(c.a)(Ed,"NetworkConnectionTelemetryManager",null,[2]);
class Ud extends Ne{constructor(Sb,Cc,cd,Wd){super(Sb,Cc,cd);this.wasInteruptedByOfflineMode=!1;this.type=Wd;this.wasInteruptedByOfflineMode=!1}obb(){this.wasInteruptedByOfflineMode=!0}}Object(c.a)(Ud,"SilentReopenData",Ne,[]);class fe{constructor(Sb){this.O8=null;this.sMf=(Cc,cd)=>{this.pMf(cd,3)};this.GIf=(Cc,cd)=>{this.pMf(cd,2)};this.$=Sb;this.ig=Pc.a(this.$).ig;this.ig.Jte(this.GIf);this.ig.aTg(this.sMf)}dispose(){this.ig.q_f(this.GIf);this.ig.xrj(this.sMf);this.O8=this.ig=this.$=null}pMf(Sb,
Cc){Sb.iM?this.O8=new Ud(K.a.Ya.kc,this.$,0!==Sb.Rpa,Cc):(5===Sb.Rpa&&(this.O8.wasInteruptedByOfflineMode=!0),3!==Sb.Rpa&&2!==Sb.Rpa||b.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.O8.hGd(this.$),2===Cc?sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?Vd.b().RNb(571289604,0,50,pd.offline,this.O8.durationMs,this.O8):
b.ULS.sendTraceTag(571289604,0,50,lb.a.Fc(this.O8)):sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Vd.b().RNb(542782150,0,50,pd.nuh,this.O8.durationMs,this.O8):b.ULS.sendTraceTag(542782150,0,50,lb.a.Fc(this.O8)),this.O8=null)}}Object(c.a)(fe,"SilentReopenPartialInteractivityTelemetryManager",null,[2]);class We extends V.a{constructor(Sb,Cc,cd=!0){super();this.t1=this.V6b=this.mQa=this.Bpa=this.qUa=null;this.xAf=0;this.cwc=this.Ddb=this.Edb=!1;this.zAf=
this.documentVisibilityObserver=null;this.Sra=!1;this.Opd=this.Y8=0;this.qDb=!1;this.Tdg=0;this.ZVd=!1;this.I1=null;this.pJf=()=>{b.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.zpc(1,!1)};this.AI=()=>{this.fma||this.FFb?window.setTimeout(()=>{this.h0d()},this.xAf):this.h0d();this.documentVisibilityObserver.sBa(this.AI);this.qDb=!1};this.Wf=()=>{b.ULS.sendTraceTag(537155218,0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.FFb}, IsInDuringWorkSilentReopenMode:${this.roc&&
!this.Sra}`);this.FFb&&this.Zpe();this.roc&&!this.Sra&&this.Wpe();Oa.h(this.$).cellTextEditBox.km(this.Wf);this.Edb=this.Ddb=!1};this.qJf=()=>{b.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.zpc(1,!0);this.Ddb&&!this.Edb&&Oa.h(this.$).cellTextEditBox.km(this.Wf);this.Ddb=!1};this.Zda=(Wd,je)=>{this.Opd=this.Y8;this.Y8=je.FEc};this.rMf=()=>{this.$&&(this.cwc||(ib.a(this.$).TQ(sb.a.VQa).IQg(this.zJf),this.$.rl(this.yd),this.cwc=!0),
this.Sra=this.vri(),this.zpc(2,!1))};this.zJf=()=>{var Wd=ib.a(this.$).Zh;const je=Wd.YWg();Wd=ma.f(Wd.Zs.ud.errors,Ee=>Ee.MessageIdName);b.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${je}, IsB2W:${this.Sra}, Errors: ${lb.a.Fc(Wd)}`);je&&(this.qUa?(this.Sra=!1,this.jNe(),this.JFc()):this.Bpa&&(this.kNe(),this.JFc()))};this.yd=()=>{this.$?(b.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),
this.Sra=!1,this.t1&&this.t1.lo&&(mb.a.Ja(this.t1),this.t1=null),this.I1&&this.I1.lo&&(mb.a.Ja(this.I1),this.I1=null),this.zpc(2,!0),this.JFc()):b.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.HEf=()=>{this.yzf(!0)};this.IEf=()=>{this.yzf(!1)};this.zZb=Xd.PFi;this.K6c=Xd.connected;this.$=Sb;this.ef=Sb.pa.ef;cd&&(this.zAf=new Ed(Sb,Cc));this.$.da.kb(291,Wd=>{this.documentVisibilityObserver=Wd});this.xAf=this.$.xa.ExcelNetworkCheckAfterTabActivationDelayMs;
this.ef.Pte(this.pJf);this.ef.Xpb(this.qJf);this.ef.$se(this.HEf);this.ef.pQg(this.IEf);new fe(this.$,this);this.$vf=this.$.xa.LongInactivityTimePeriodSeconds;this.$.ea.A_c(this.rMf);this.$.ea.df.Zha(this.Zda);this.Tdg=this.$.xa.SilentReopenDuringWorkDelayMs}get Ati(){return this.Sra}get FFb(){return!(this.zZb&1)}get roc(){return!(this.zZb&2)}get fma(){return!!(this.K6c&2)}dispose(){this.ef&&(this.ef.v_f(this.pJf),this.ef.MLb(this.qJf),this.ef.NZf(this.HEf),this.ef.opj(this.IEf));this.qDb&&this.documentVisibilityObserver&&
(this.documentVisibilityObserver.sBa(this.AI),this.qDb=!1);this.$&&(this.cwc&&this.JFc(),this.$.ea&&(this.$.ea.H_f(this.rMf),this.$.ea.df&&this.$.ea.df.uBa(this.Zda)));this.I1&&(this.I1.dispose(),this.I1=null);mb.a.Ja(this.zAf);this.$=null;super.dispose()}mMi(){this.ZVd=!0}Wpe(){this.Bpa||(this.Bpa=Pc.a(this.$).ig.g_a(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}vri(){if(this.ZVd)return this.ZVd=!1,!0;const Sb=this.Y8>this.$vf||this.Opd>this.$vf&&10>this.Y8;
b.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.Y8}, Time gap between last two activities: ${this.Opd}. return value:${Sb}`);return Sb}Ftj(){this.I1=cb.a.instance.create(()=>{gb.Health.instance.recordQosError(Kc.a.nSj,[Nc.a.Enc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}zLg(){this.Bpa||this.t1?b.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.t1=cb.a.instance.create(()=>{this.$?this.Bpa?b.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):Oa.h(this.$).jb?(this.Ddb||(Oa.h(this.$).cellTextEditBox.Bm(this.Wf),b.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),
this.Edb=!0,b.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.Wpe():b.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.Tdg,fa.a.hRj,void 0,!0)}yzf(Sb){this.K6c=this.UBe(2,Sb,!0);this.Wue()}zpc(Sb,Cc){this.zZb=this.UBe(Sb,Cc,
!1);this.Wue()}UBe(Sb,Cc,cd){cd=cd?this.K6c:this.zZb;return Cc?cd|Sb:cd&~Sb}h0d(){const Sb=!!this.mQa,Cc=!!this.qUa,cd=!!this.Bpa,Wd=!!this.V6b;this.FFb&&!Sb?this.yLg():!this.FFb&&Sb&&this.Rnh();!this.roc||Cc||cd?this.roc||(Cc?this.jNe():(cd||this.t1&&this.t1.lo)&&this.kNe()):this.Sra?this.xLg():this.t1||this.zLg();this.fma&&!Wd?this.Vig(!0):!this.fma&&Wd&&this.Vig(!1)}yLg(){this.$?this.mQa?b.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):
Oa.h(this.$).jb?(this.Edb||(Oa.h(this.$).cellTextEditBox.Bm(this.Wf),b.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.Ddb=!0,b.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.Zpe():b.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}Zpe(){this.mQa||
(this.mQa=Pc.a(this.$).ig.g_a(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}Rnh(){this.mQa&&(mb.a.Ja(this.mQa),this.mQa=null)}jNe(){this.qUa&&(mb.a.Ja(this.qUa),this.qUa=null);this.I1&&this.I1.lo&&this.I1.cancel();this.I1=null}kNe(){this.Bpa&&(mb.a.Ja(this.Bpa),this.Bpa=null);this.t1&&(mb.a.Ja(this.t1),this.t1=null);this.Edb&&!this.Ddb&&Oa.h(this.$).cellTextEditBox.km(this.Wf);this.Edb=!1}xLg(){this.qUa||(this.qUa=Pc.a(this.$).ig.g_a(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Xb.a.instance.ha(2190)));this.Ftj()}Vig(Sb){Sb?(this.V6b=Pc.a(this.$).ig.g_a(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.xfj()):(mb.a.Ja(this.V6b),this.V6b=null)}xfj(){if(this.$&&this.$.pa){const Sb=this.$.pa.va.ic();Ua.I(this.$.pa.va,null,null,null,Sb)}}JFc(){ib.a(this.$).TQ(sb.a.VQa).gr(this.zJf);this.$.lm(this.yd);this.cwc=!1}Wue(){this.documentVisibilityObserver||b.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");
this.documentVisibilityObserver&&this.documentVisibilityObserver.oi?this.qDb||(this.documentVisibilityObserver.yta(this.AI),this.qDb=!0,b.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.h0d()}}Object(c.a)(We,"NetworkConnectionStateManager",V.a,[931,2]);var lf=a(41),Se=a(157);class Ae extends Ga.a{constructor(Sb){super();this.$=Sb;this.Mb()}create(){sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7476522_IDBNewService2")?
void Se.a.resolve(lf.G,{rb:this.Na}).then(Sb=>{let Cc=Object(qa.a)(this.$.da,400,()=>new We(this.$,Sb));this.vb(Cc)}):ob.TaskExtensions.za(Ra.GetServiceTaskFactory.create(this.$.da,396,this.$.da.ka,this.Na),Sb=>{let Cc=Object(qa.a)(this.$.da,400,()=>new We(this.$,Sb.result));this.vb(Cc)},this.$.ka,3)}static la(Sb){Sb.da.Ha(401,new Ae(Sb))}}Object(c.a)(Ae,"NetworkConnectionStateManagerFactory",Ga.a,[]);var Qe=a(1082),$e=a(1319),of=a(1330),re=a(1331),zf=a(1092),Lf=a(1332),Ze=a(1220),ec=a(1190),Lc=a(1291),
Da=a(1189),Cb=a(1283),Zb=a(1266),yc=a(1094),Vc=a(1320),jd=a(1271),ld=a(1245),Bd=a(1292),Td=a(1255),Jd=a(1202),ce=a(1098),ie=a(1207),we=a(1272),zc=a(1293),Sc=a(1321);a(1101);var td=a(1211),Md=a(1102),wd=a(1236),Ta=a(1294),Vb=a(1256),qc=a(1295),Ic=a(1105),gd=a(1296),Kd=a(1257),oe=a(1224),Ce=a(116),ze=a(113),af=a(148),Za=a(281);class Rb{constructor(Sb){this.IPa=this.sAd=this.LPa=this.Doc=0;this.lAd=this.lxf=null;Sb?(this.Loc=Sb,this.Rub=Date.now,this.Jjh(),this.kmj()):b.ULS.sendTraceTag(520955213,209,
10,"Can not initialize PenMinutesManager because TaskManager is null")}GGj(){this.lxf="Office.Excel.Online.Data.Activity.PenMinutes"}kmj(){window.document.body.addEventListener("pointerenter",Object(z.a)(this,this.tsc,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(z.a)(this,this.Xda,"onPointerLeave"));T.a.instance.$b("Common.App.VisibilityManagement.IVisibilityManager").execute(Sb=>{Sb.bue(Object(z.a)(this,this.Lzb,"handleVisibilityChange"))})}tsc(Sb){"pen"!==Sb.pointerType||
this.LPa||(this.LPa=Math.floor(this.Rub()/1E3),this.LPa<=this.Doc&&(this.LPa=this.Doc),this.sAd=0)}Xda(){this.edf()}edf(){const Sb=Math.ceil(this.Rub()/1E3);this.LPa&&Sb>this.Doc&&(this.sAd=Sb,this.IPa+=this.sAd-this.LPa);this.Doc=Sb;this.LPa=0}Lzb(Sb,Cc){0!==Cc.newState&&this.edf()}Jjh(){this.lAd=new ze.a(4,2,6E4,Object(z.a)(this,this.aJi,"logPenUsage"));this.Loc.Kf(this.lAd)}aJi(){0<this.IPa&&this.I6f(this.IPa);this.IPa=0}I6f(Sb){const Cc=new Za.a;Cc.name=this.lxf;const cd=[];(Sb=Ce.a.Vg("PenInputSec",
Sb.toString(),3))&&Array.add(cd,Sb);Cc.dataFields=cd;af.a.sendActivityEvent(Cc)}dispose(){0<this.IPa&&this.I6f(this.IPa);this.Loc.np(this.lAd)}}Object(c.a)(Rb,"PenMinutesManager",null,[703]);class rc{constructor(){this.sTc=this.ib=null}get name(){return"Common.App.PenMinutesManager"}ki(Sb){this.ib=Sb;const Cc=f.AFrameworkApplication.ji;this.ib.register(703,"Common.App.PenMinutesManager.IPenMinutesManager").zc().Gc(()=>new Rb(Cc))}init(){this.sTc=this.ib.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.sTc&&
this.sTc.dispose()}static main(){ca.a.instance.dj(new rc)}}Object(c.a)(rc,"PenMinutesManagerPackage",null,[4,5]);class Jc extends Ga.a{constructor(Sb){super();this.$=Sb;this.Mb()}static la(Sb){Sb.da.Ha(514,new Jc(Sb))}create(){this.vb(Object(qa.a)(this.$.da,513,()=>{Type.registerNamespace("Common.App.PenMinutesManager");rc.main();const Sb=T.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");Sb.GGj();return Sb}))}}Object(c.a)(Jc,"PenMinutesFactory",Ga.a,[]);Type.registerNamespace("Common.App.InProductMessaging");
Y.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Ha.main();(()=>{Ca.a.Fa(()=>{Ca.a.Fa(pa.la)})})();(()=>{Ca.a.Fa(()=>{Ca.a.Fa(za.la)})})();Ca.a.Fa(Nb.la);Ca.a.Fa(Ae.la);(()=>{Ca.a.Fa(Sb=>{Jc.la(Sb)})})();Object(Qe.a)();Object($e.a)();(()=>{Ca.a.Fa(Sb=>{of.a.la(Sb);re.a.la(Sb)})})();(()=>{Ca.a.Fa(Sb=>{Lf.a.la(Sb);zf.a.la(Sb)})})();(()=>{Ca.a.Fa(Sb=>{Ze.a.la(Sb)})})();(()=>{Ca.a.Fa(Sb=>{ec.a.la(Sb)})})();Object(Lc.a)();Object(Da.a)();(()=>{Ca.a.Fa(Sb=>{Cb.a.la(Sb)})})();(()=>
{Ca.a.Fa(Sb=>{Zb.a.la(Sb)})})();Object(yc.a)();Object(Vc.a)();Object(jd.a)();Object(ld.a)();Object(Bd.a)();Object(Td.a)();Object(Jd.a)();Object(ce.a)();Object(ie.a)();Object(zc.a)();Object(we.a)();Object(Sc.a)();Object(td.a)();Object(Md.a)();Object(wd.a)();Object(Ta.a)();Object(Vb.a)();Object(qc.a)();Ic.a.main();Object(gd.a)();Object(Kd.a)();Object(oe.a)()},731:function(t,C,a){a.d(C,"a",function(){return R});t=a(0);var c=a(2),b=a(14),f=a(92),e=a(229),d=a(16),h=a(114),r=a(185),l=a(6),u=a(91);C=a(245);
var v=a(1084),x=a(19),w=a(7),m=a(332),n=a(54),z=a(13),y=a(77),A=a(15),F=a(21),D=a(95),B=a(934),M=a(1);class R extends C.a{constructor(P,E){super(document.createElement("div"));this.wtf=this.Ive=this.Spe=this.j6b=this.oda=this.w9=this.qP=this.uz=null;this.rxa=this.NV=this.Ir=this.hideCloseButton=!1;this.yVi=H=>{this.LD(H)};this.EVi=H=>{13===H.keyCode&&this.LD(H)};this.dEd=H=>{this.pn(H.Cb);return!0};this.jEd=H=>{this.wW(H.Cb);return!0};this.Rrc=H=>{this.Kna(H.Cb?H.Cb:0);return!0};this.zVi=H=>{this.LD(H.Da);
return!0};this.tug=(H=null)=>{this.pn(H.inputMethod?H.inputMethod:0);return!0};this.uug=(H=null)=>{this.wW(H.inputMethod?H.inputMethod:0);return!0};this.j2=P;this.Jt=E;this.M1c=E.l1a.toString();this.title=E.title;this.message=E.message;this.set_visibilityMode(1)}get o3g(){return this.Jt.l1a}get businessBar(){return this.j2}get actionButton(){return this.Jt?this.Jt.actionButton:""}get Gta(){return this.Jt?this.Jt.Gta:""}get linkText(){return this.Jt?this.Jt.link:""}get tk(){return this.Jt?this.Jt.tk:
""}get alt(){return this.Jt?this.Jt.alt:""}bpa(P){this.Jt.businessBarType=P}dispose(){f.a.wc([this.j6b,this.qP,this.w9]);this.Ir&&this.qP&&(e.a.instance.Ba(d.a.click,this.qP.domElement,this.dEd),h.KeyInputManager.instance.Cx(this.domElement,this.Spe));this.NV&&this.w9&&(e.a.instance.Ba(d.a.click,this.w9.domElement,this.jEd),h.KeyInputManager.instance.Cx(this.domElement,this.Ive));this.rxa&&this.oda&&(e.a.instance.Ba(d.a.click,this.oda,this.Rrc),h.KeyInputManager.instance.Cx(this.domElement,this.wtf));
this.oda=this.uz=this.j2=this.w9=this.qP=null;super.dispose()}update(){}A5j(){this.pLe(!0)}XJe(){this.pLe(!1)}pkh(){const P=this.businessBar.$.Rb.Dg("DOMUpdate","ReactBusinessBar");P.start();this.message=D.a.rf(this.message);this.title=D.a.rf(this.title);r.UISurfaces.fkd().then(E=>{E.initializeMessageBarInStore();let H=Object(c.a)(new B.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.Jt.businessBarType,dismissButtonAriaLabel:A.a.instance.ha(10)});this.hideCloseButton||
(H.onDismiss=this.zVi);this.rxa&&(H.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.Rrc});this.Ir&&(H.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.tug});this.NV&&(H.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.Gta,["onExecute"]:this.uug});M.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.Jt.iconName&&(H.messageBarIconProps={["iconName"]:this.Jt.iconName});
M.EwaSettings.isChangeGateEnabled("OfficeVSO:7476511_BizBarCallbackTelemetry")?E.createNewMessageBarWithCallback(this.domElement,H,()=>{P.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.Jt.RKa} in: ${P.Jc} milliSeconds.`)}):E.createNewMessageBar(this.domElement,H);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.Jt.RKa} could not be initialized`);return null});if(l.AFrameworkApplication.fa.ra("Fluent2StyleIsEnabled"))this.domElement.classList.add("VNextBusinessBarEntry"),
this.domElement.classList.add("WACBusinessBarEntry");else{let E="1px solid ";switch(this.Jt.businessBarType){case 1:case 2:case 3:E+="#F1707B";break;case 4:E+="#92C353";break;case 5:E+="#FCE100";break;case 0:E+="#C8C6C4";break;default:E+="#C8C6C4"}this.domElement.style.border=E}this.domElement.classList.add("ReactBusinessBarEntry");M.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")||(this.domElement.tabIndex=0);this.businessBar.domElement.appendChild(this.domElement)}zjh(P){P||
(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var E=this.businessBar.$.Ib;P=E+"ewaBusinessBarEntryBody"+this.M1c;const H=E+"ewaBusinessBarEntryTitle"+this.M1c;var G=E+"ewaBusinessBarEntryIcon"+this.M1c;this.domElement.className=v.a.Fyh;if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7409767_BizBarUpdateReduceInnerHtml")){z.DOMElementExtensions.cF(this.domElement);E=document.createElement("div");E.className=v.a.XTe;E.id=P;var N=document.createElement("div");
N.className=v.a.WTe;var I=document.createElement("a");I.className=v.a.cUe;I.title=this.alt;const O=document.createElement("span");O.classList.add(x.a.Xsb);O.classList.add(v.a.ZTe);O.id=G;this.tk.length&&(G=document.createElement("img"),G.classList.add(this.tk),G.src=n.a.mf(0),O.appendChild(G));I.appendChild(O);N.appendChild(I);G=document.createElement("span");G.classList.add(v.a.bUe);G.id=H;G.innerText=D.a.rf(this.title);N.appendChild(G);G=document.createElement("span");G.classList.add(v.a.aUe);G.id=
"message";G.innerText=D.a.rf(this.message);N.appendChild(G);G=document.createElement("a");G.id="link";G.href="#";G.className=v.a.$Te;G.innerText=D.a.rf(this.linkText);N.appendChild(G);G=document.createElement("span");G.classList.add(v.a.Mac);I=document.createElement("button");I.type="button";I.id="action";I.className=v.a.Lac;I.innerText=D.a.rf(this.actionButton);G.appendChild(I);N.appendChild(G);G=document.createElement("span");G.classList.add(v.a.Mac);I=document.createElement("button");I.type="button";
I.id="altAction";I.className=v.a.Lac;I.innerText=D.a.rf(this.Gta);G.appendChild(I);N.appendChild(G);E.appendChild(N);N=document.createElement("a");N.className=v.a.YTe;N.tabIndex=0;N.setAttribute("role","button");G=document.createElement("span");G.id="close";G.classList.add(x.a.sz);I=document.createElement("img");I.classList.add(x.a.fbc);I.src=n.a.mf(13);I.alt=A.a.instance.ha(793);I.title=A.a.instance.ha(793);I.setAttribute("role","button");G.appendChild(I);N.appendChild(G);E.appendChild(N);this.domElement.appendChild(E)}else E=
"<div class='"+v.a.XTe+"' id='{0}'><div class='"+v.a.WTe+"'><a class='"+v.a.cUe+"' title='{1}'><span class='"+x.a.Xsb+" "+v.a.ZTe+"' id='{2}'>",this.tk.length&&(E+="<img class='{3}' src='{4}'/>"),E+="</span></a><span class='"+v.a.bUe+"' id='{5}'>{6}</span><span class='"+v.a.aUe+"' id='message'>{7}</span><a id='link' href='#' class='"+v.a.$Te+"'>{8}</a><span class='"+v.a.Mac+"'><button type='button' id='action' class='"+v.a.Lac+"'>{9}</button></span><span class='"+v.a.Mac+"'><button type='button' id='altAction' class='"+
v.a.Lac+"'>{10}</button></span></div><a class='"+v.a.YTe+"' tabindex='0' role='button'><span id='close' class='"+x.a.sz+"'><img class='"+x.a.fbc+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>",this.domElement.innerHTML=String.format(E,P,this.alt,G,this.tk,n.a.mf(0),H,this.title,this.message,this.linkText,this.actionButton,this.Gta,n.a.mf(13),A.a.instance.ha(793));z.DOMElementExtensions.Yu(this.domElement,w.a.kia,H,P);this.oda=$get("link",this.domElement);z.DOMElementExtensions.setVisible(this.oda,
this.rxa);this.rxa&&(e.a.instance.ta(d.a.click,this.oda,this.Rrc),this.wtf=h.KeyInputManager.instance.$t(this.oda,this.Rrc,u.a.Wh,u.a.TX));this.qP=new m.a(z.DOMElementExtensions.getElementById(this.domElement,"action"));this.qP.isVisible=this.Ir;this.w9=new m.a(z.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.w9.isVisible=this.NV;this.Ir&&(e.a.instance.ta(d.a.click,this.qP.domElement,this.dEd),this.Spe=h.KeyInputManager.instance.$t(this.qP.domElement,this.dEd,u.a.Wh,u.a.TX),
this.NV&&(e.a.instance.ta(d.a.click,this.w9.domElement,this.jEd),this.Ive=h.KeyInputManager.instance.$t(this.qP.domElement,this.jEd,u.a.Wh,u.a.TX)));this.uz=$get("close",this.domElement);this.j6b=this.De.ke(this.uz);this.j6b.la("click",this.yVi);this.j6b.la("keydown",this.EVi);z.DOMElementExtensions.setVisible(this.uz,!this.hideCloseButton)}pLe(P){M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.pkh():this.zjh(P)}pn(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.Jt.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.Jt.RKa}`);
F.h(this.businessBar.$).Xo(!0)}wW(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.Jt.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.Jt.RKa}`);F.h(this.businessBar.$).Xo(!0)}Kna(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.Jt.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.Jt.RKa}`);F.h(this.businessBar.$).Xo(!0)}LD(P){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.Jt.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.Jt.RKa}`);this.set_visible(!1);
this.businessBar.removeEntry(this.o3g);y.g(P)}vK(){return M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.qP.domElement}}Object(t.a)(R,"BusinessBarEntry",C.a,[])},785:function(t,C,a){a.r(C);var c=a(0),b=a(14),f=a(92),e=a(232),d=a(6),h=a(34),r=a(819),l=a(144),u=a(84),v=a(40),x=a(19),w=a(7),m=a(174),n=a(1286),z=a(1290),y=a(181),A=a(568),F=a(356),D=a(65);const B=(Tb,$a,Nb,Ra,ob,mb=null)=>{mb=Tb.Oa(1,mb);return D.g(Tb,
"GetRichDataClassificationLabels",mb,$a,Nb,Ra,ob,4)},M=(Tb,$a,Nb,Ra,ob,mb,gb,lb,Xb=null)=>{Xb=Tb.Oa(1,Xb);Xb.selectedRanges=$a;Xb.domainId=Nb;Xb.autodetect=Ra;return D.g(Tb,"ConvertToLinkedEntity",Xb,ob,mb,gb,lb,4)},R=(Tb,$a,Nb,Ra,ob,mb=null)=>{mb=Tb.Oa(1,mb);return D.g(Tb,"OnAutoDetectUIShown",mb,$a,Nb,Ra,ob,4)},P=(Tb,$a,Nb,Ra,ob,mb=null)=>{mb=Tb.Oa(1,mb);return D.g(Tb,"GetLinkedEntityMetadata",mb,$a,Nb,Ra,ob,4)},E=(Tb,$a,Nb,Ra,ob,mb,gb=null)=>{gb=Tb.Oa(1,gb);gb.selectedRanges=$a;return D.g(Tb,"ConvertLinkedEntityToText",
gb,Nb,Ra,ob,mb,4)},H=(Tb,$a,Nb,Ra,ob,mb,gb=null)=>{gb=Tb.Oa(1,gb);gb.selectedRanges=$a;return D.g(Tb,"RefreshLinkedEntitiesInRange",gb,Nb,Ra,ob,mb,4)},G=(Tb,$a,Nb,Ra,ob,mb,gb,lb,Xb,Xd,Qd=null)=>{Qd=Tb.Oa(1,Qd);Qd.selectedRanges=$a;Qd.isChangeObject=Nb;Qd.isFloodgateEnabled=Ra;Qd.isStarterData=ob;Qd.starterDataDomainId=mb;return D.g(Tb,"GetDataSelectorPaneData",Qd,gb,lb,Xb,Xd,4)},N=(Tb,$a,Nb,Ra,ob,mb,gb,lb=null)=>{lb=Tb.Oa(9,lb);lb.activeCell=$a;lb.selectionIndex=Nb;return D.g(Tb,"SelectLinkedEntityForDisambiguation",
lb,Ra,ob,mb,gb,4)},I=(Tb,$a,Nb,Ra,ob,mb,gb,lb,Xb,Xd,Qd,te=null)=>{te=Tb.Oa(1,te);te.searchCell=$a;te.searchQuery=Nb;te.isFloodgateEnabled=Ra;te.isStarterData=ob;te.starterDataDomainId=mb;te.starterDataDomainIdString=gb;return D.g(Tb,"LinkedEntitySearch",te,lb,Xb,Xd,Qd,4)},O=(Tb,$a,Nb,Ra,ob,mb,gb,lb,Xb=null)=>{Xb=Tb.Oa(1,Xb);Xb.cell=$a;Xb.starterDataDomainId=Nb;Xb.starterDataDomainIdString=Ra;return D.g(Tb,"InsertStarterDataTable",Xb,ob,mb,gb,lb,4)},U=(Tb,$a,Nb,Ra,ob,mb,gb,lb=null)=>{lb=Tb.Oa(1,lb);
lb.activeCell=$a;lb.isBackward=Nb;return D.g(Tb,"MoveToNextAmbiguousLinkedEntity",lb,Ra,ob,mb,gb,4)},ca=(Tb,$a,Nb,Ra,ob,mb,gb=null)=>{gb=Tb.Oa(9,gb);gb.activeCell=$a;return D.g(Tb,"CancelSearchLinkedEntity",gb,Nb,Ra,ob,mb,4)},Q=(Tb,$a,Nb,Ra,ob,mb,gb,lb=null)=>{lb=Tb.Oa(1,lb);lb.selectedRanges=$a;lb.letyDomainId=Nb;return D.g(Tb,"GetDataTypeSelectorData",lb,Ra,ob,mb,gb,4)},Y=(Tb,$a,Nb,Ra,ob,mb=null)=>{mb=Tb.Oa(1,mb);return D.g(Tb,"GetErrorMessageForLinkedDataTypeRefresh",mb,$a,Nb,Ra,ob,4)},la=(Tb,
$a,Nb,Ra,ob,mb=null)=>{mb=Tb.Oa(1,mb);return D.g(Tb,"GetHasUntrustedImageUrls",mb,$a,Nb,Ra,ob,4)},ea=(Tb,$a,Nb,Ra,ob,mb=null)=>{mb=Tb.Oa(1,mb);return D.g(Tb,"LinkedEntitiesEnableUntrustedImages",mb,$a,Nb,Ra,ob,0)},ha=(Tb,$a,Nb,Ra,ob,mb=null)=>{mb=Tb.Oa(1,mb);return D.g(Tb,"LinkedEntityTryAutoRefresh",mb,$a,Nb,Ra,ob,0)};var X=a(88),T=a(728),ua=a(816);class Ha{}Ha.aji="EnrichmentContentFrame";Ha.width=320;Object(c.a)(Ha,"EnrichmentConstants",null,[]);class Ca{constructor(Tb){this.messageType=0;this.messageType=
Tb}}Object(c.a)(Ca,"EnrichmentResponseMessage",null,[]);class Ga extends Ca{constructor(Tb,$a){super(Tb);this.messageContent=null;this.messageContent=$a}}Object(c.a)(Ga,"EnrichmentResponseMessageWithContent",Ca,[]);class sa extends Ga{constructor(Tb,$a,Nb){super(Tb,$a);this.telemetryJson=null;this.telemetryJson=Nb}}Object(c.a)(sa,"EnrichmentResponseMessageWithContentAndTelemetryData",Ga,[]);var bb=a(273),Ba=a(16),qa=a(102),pa=a(50),ya=a(91),za=a(114),cb=a(42),Pa=a(83),nb=a(29),Ma=a(112),Oa=a(719),
La=a(26);class ra{constructor(Tb,$a,Nb,Ra,ob){this.lr=this.Ck=this.Pce=this.Mce=this.ow=this.ov=null;this.Jx=!1;this.Pi=Tb;this.oe=$a;this.AP=Nb;this.lc=Ra;this.La=ob;this.Cra=za.KeyInputManager.Rl(ya.a.zqa,0)}get VOb(){return!0}get Xvb(){return d.AFrameworkApplication.fa.Wa("EnrichmentPaneUrl")}dispose(){this.VOb&&this.lr&&(this.Pi.Ba(Ba.a.click,this.lr,Object(X.a)(this,this.Cl,"onClosePaneClick")),this.oe.Ba(Ba.a.Vd,this.lr,Object(X.a)(this,this.hIf,"onKeyHide")));this.lr=null;this.ow&&(this.k4j(),
this.ow.parentNode.removeChild(this.ow),this.ow=null);this.lc.Gi("EnrichmentPaneId").Qk(this.Cra)}show(Tb,$a,Nb){this.ov=Tb;this.Jx||(this.Ck=this.M2a(),this.Koa.appendChild(this.Ck),this.Olj(),this.La.Wb(La.a.$Fe,Ma.a.frame,Object(X.a)(this,this.rdi,"handleEscapeKeyAction")),this.PTa(),this.Jx=!0);this.ow.src=this.Xvb&&this.Xvb.length?this.Xvb+"?culture="+$a.market+"&appName="+$a.applicationName+"&themeId="+$a.themeId+"&featuresBitMask="+$a.featuresBitMask:ra.BBf;this.Mce=$a;this.Pce=Nb;this.bgb()}qGc(Tb,
$a){Tb=new sa(2,Tb,$a);this.ouc(Tb)}PTa(){const Tb=this.lc.Gi("EnrichmentPaneId");Tb.parent=bb.AFrame.PPa;this.Pi.Dpb("EnrichmentPaneId",this.Ck);Tb.bindAction(this.Cra,La.a.$Fe)}D8f(){if(this.ow){qa.FocusManager.iqa(this.ow.contentWindow);const Tb=new sa(4,null,null);this.ouc(Tb)}}Cl(){this.l6b();return!0}hIf(Tb){Tb=Tb.Da.keyCode;return Tb===Sys.UI.Key.enter||Tb===Sys.UI.Key.space?(this.l6b(),!0):!1}l6b(){this.hide();if(this.ov)this.ov.onPaneClosed()}M2a(){const Tb=T.a("div","EnrichmentPaneId","EnrichmentPane");
this.VOb&&Tb.appendChild(this.o8c());this.Rmi(Tb);return Tb}o8c(){const Tb=T.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),$a=T.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");$a.innerText=CommonUIStrings.l_EnrichmentPaneTitle;$a.title=CommonUIStrings.l_EnrichmentPaneTitle;const Nb=ua.a.tb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Pi.ta(Ba.a.click,Nb,Object(X.a)(this,this.Cl,"onClosePaneClick"));
this.oe.ta(Ba.a.Vd,Nb,Object(X.a)(this,this.hIf,"onKeyHide"));Tb.appendChild($a);Tb.appendChild(Nb);this.lr=Nb;return Tb}Rmi(Tb){this.ow=T.b("iframe","","EnrichmentFrame");Tb.appendChild(this.ow);this.ow.id=Ha.aji;this.ow.setAttribute("role","presentation")}Olj(){pa.a.addHandler(this.ow,"load",Object(X.a)(this,this.LHf,"onIFrameLoad"));pa.a.addHandler(this.ow,"error",Object(X.a)(this,this.Grc,"onIFrameError"));$addHandler(window,"message",Object(X.a)(this,this.MHf,"onIFrameMessage"))}k4j(){pa.a.removeHandler(this.ow,
"load",Object(X.a)(this,this.LHf,"onIFrameLoad"));pa.a.removeHandler(this.ow,"error",Object(X.a)(this,this.Grc,"onIFrameError"));$removeHandler(window,"message",Object(X.a)(this,this.MHf,"onIFrameMessage"))}Snh(){this.ow.src=ra.BBf}hide(){this.phc();this.Snh()}rdi(Tb,$a,Nb){if(1!==Nb&&(this.hide(),this.ov))this.ov.onPaneClosed();return 32}LHf(){}Grc(){}MHf(Tb){Tb=Tb.rawEvent;if(!this.ow||-1!==this.ow.src.indexOf(Tb.origin)){try{var $a=cb.a(Tb.data)}catch(Nb){return}if(!Oa.c($a.messageType)){Tb=window.g_badCastCallback;
window.g_badCastCallback=null;switch($a.messageType){case 2:this.ouc(new sa(1,cb.c(this.Mce),this.Pce));break;case 1:this.ouc(new Ga(0,this.wTh()));break;case 3:this.ov&&this.ov.selectEntity($a.messageContent);break;case 5:this.ov&&this.ov.zGb($a.messageContent);break;case 8:this.ov&&($a=cb.a($a.messageContent),0<$a.DomainId?this.ov.WRd($a.Query,$a.TelemetryJson,$a.DomainId,$a.DomainIdString):this.ov.searchEntity($a.Query,$a.TelemetryJson));break;case 6:this.ov&&this.ov.cancelSearch();break;case 11:$a=
cb.a($a.messageContent);$a=ra.$7b("keydown","f6",ya.a.kTb,!0,!1,$a,!0,!1);this.ow&&this.ow.dispatchEvent($a);break;case 12:if(cb.a($a.messageContent).keyCode===ya.a.DG&&($a=ra.$7b("keydown","esc",ya.a.DG,!0,!1,!1,!1,!1),this.ow&&(this.ow.dispatchEvent($a),this.hide(),this.ov)))this.ov.onPaneClosed();break;case 13:this.ov&&this.ov.selectDataType($a.messageContent);break;case 14:this.ov&&this.ov.showHelpArticle($a.messageContent);break;case 15:this.ov&&this.ov.showSurveyDialog($a.messageContent);break;
case 16:this.ov&&($a=cb.a($a.messageContent),this.ov.insertTable($a.DomainId,$a.DomainIdString))}window.g_badCastCallback=Tb}}}wTh(){return cb.c([2,1,3,5,8,6])}ouc(Tb){Tb=cb.c(Tb);this.ow.contentWindow.postMessage(Tb,Pa.a.BK(this.Xvb))}static $7b(Tb,$a,Nb,Ra,ob,mb,gb,lb){nb.a.Ww?(mb=String.format("{0} {1} {2}",mb?"Shift":"",gb?"Control":"",lb?"Alt":""),mb.trim(),Nb=document.createEvent("KeyboardEvent"),Nb.initKeyboardEvent(Tb,Ra,ob,window.self,$a,0,mb,!1,"en-US")):($a={},$a.keyCode=Nb,$a.ctrlKey=
gb,$a.shiftKey=mb,$a.altKey=lb,$a.bubbles=Ra,$a.cancelable=ob,Nb=new KeyboardEvent(Tb,$a));return Nb}}ra.BBf="about:blank";Object(c.a)(ra,"EnrichmentPane",null,[784,2]);class V extends ra{constructor(Tb){super(d.AFrameworkApplication.sa.Ty,d.AFrameworkApplication.sa.hu,d.AFrameworkApplication.sa.Efa,d.AFrameworkApplication.sa.We,d.AFrameworkApplication.xb);this.taskPane=Tb;this.taskPane.XRg(this.D8f)}get Koa(){return this.taskPane.rc}bgb(){this.taskPane.isVisible||this.taskPane.$g(!0)}phc(){this.taskPane.$g(!1)}dispose(){this.taskPane&&
(this.taskPane.Eqj(this.D8f),this.taskPane=null);super.dispose()}}Object(c.a)(V,"EnrichmentTaskPaneWrapper",ra,[]);class ma{constructor(Tb){this.ez=null;this.xga=Tb}uEi(Tb,$a){this.ez=Tb;this.xga&&this.xga.show(this,$a,null)}qGc(Tb,$a){this.xga&&this.xga.qGc(Tb,$a)}wAb(){this.xga&&this.xga.hide()}dispose(){this.xga&&(this.xga.dispose(),this.xga=null)}selectEntity(Tb){return this.ez?this.ez.selectEntity(Tb):!1}searchEntity(Tb,$a){this.ez&&this.ez.searchEntity(Tb,$a)}WRd(Tb,$a,Nb,Ra){this.ez&&this.ez.WRd(Tb,
$a,Nb,Ra)}zGb(Tb){return this.ez?this.ez.zGb(Tb):!1}onPaneClosed(){if(this.ez)this.ez.onPaneClosed()}cancelSearch(){this.ez&&this.ez.cancelSearch()}selectDataType(Tb){this.ez&&this.ez.selectDataType(Tb)}showHelpArticle(Tb){this.ez&&this.ez.showHelpArticle(Tb)}showSurveyDialog(Tb){this.ez&&this.ez.showSurveyDialog(Tb)}insertTable(Tb,$a){this.ez&&this.ez.insertTable(Tb,$a)}}Object(c.a)(ma,"EnrichmentManager",null,[780,2]);class W extends ma{constructor(Tb){super(Tb)}dispose(){super.dispose()}}Object(c.a)(W,
"ExcelEnrichmentManager",ma,[]);var aa=a(15);class ia{constructor(Tb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Tb;this.commentQuestion=aa.a.instance.qb(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=aa.a.instance.qb(195);this.ratingValuesAscending=[aa.a.instance.qb(196),
aa.a.instance.qb(197),aa.a.instance.qb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=aa.a.instance.qb(194)}}Object(c.a)(ia,"FloodgateSurvey",null,[]);var ka=a(25),Xa=a(80),sb=a(428),ib=a(45),Ub=a(380),hc=a(199),yb=a(33),Gb=a(98),Sa=a(32),db=a(293),fb=a(21);class ab{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}
Object(c.a)(ab,"EnrichmentMessageContentAppProperties",null,[]);class wb{constructor(Tb,$a,Nb,Ra,ob){this.kva=this.rPe=!1;this.Seb=this.Lca=!0;this.RIb=this.bPb=!1;this.lgb=null;this.xtc=0;this.UR=()=>{(this.Seb||this.kva)&&2!==this.xtc&&(this.RIb||this.Nxd(!1))};this.dd=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.jWi=mb=>{Sa.a.lg(mb.Errors)?(mb=Sa.a.xc(mb.Errors),mb.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,
0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${mb}`)):mb.Result&&(this.$.ea.xk(this.dd),this.$.ea.Zj(this.dd),mb=mb.Result,this.lgb=mb.SkydanceFeatureBitmask,this.$Bd(mb),this.bPb=!0)};this.Ze=()=>{(this.Seb||this.kva)&&this.Nxd(!1)};this.yrc=(mb,gb)=>{Sa.a.lg(mb.Errors)?b.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Sa.a.xc(mb.Errors)}`):mb.Result&&
(mb=mb.Result,mb.DisambiguationJson?(this.bPb=!1,this.z9f(gb),this.lgb=mb.SkydanceFeatureBitmask,gb=mb.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.RIb=!1,this.atf(gb)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.UYi=(mb,gb)=>{Sa.a.lg(mb.Errors)?(gb=Sa.a.xc(mb.Errors),b.ULS.sendTraceTag(36975689,
0,10,`Failed to retrieve disambiguation data for search. errors: ${gb}`)):mb.Result&&(mb=mb.Result,mb.DisambiguationJson?(this.z9f(gb),this.lgb=mb.SkydanceFeatureBitmask,gb=mb.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.RIb=!0,this.atf(gb)):b.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};
this.u1i=mb=>{Sa.a.lg(mb.Errors)?(mb=Sa.a.xc(mb.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${mb}`),this.Seb=!0):mb.Result&&(mb=mb.Result,this.lgb=mb.SkydanceFeatureBitmask,this.$Bd(mb),this.bPb=!0)};this.q4i=mb=>{if(Sa.a.lg(mb.Errors)){const gb=Sa.a.xc(mb.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${gb}`)}mb.Result?(this.$Bd(mb.Result),this.bPb=!0):this.uua()};this.wLf=mb=>{Sa.a.lg(mb.Errors)?
(mb=Sa.a.xc(mb.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${mb}`)):mb.Result?this.qac.qGc(mb.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.uua())};this.b0i=mb=>{Sa.a.lg(mb.Errors)?(mb=Sa.a.xc(mb.Errors),b.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${mb}`)):this.uua()};
this.$=Tb;this.gridView=fb.h(this.$);this.gridView.ga.QJ(this.Ze);this.gridView.vv(this.UR);this.nTe=Ra;this.convertToLinkedEntityManager=ob;yb.a.Md()||Nb.nR($a);Tb=new V($a);this.qac=new W(Tb);u.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(mb=>{mb.isFeatureEnabled("mso_sendASmile",!0).then(gb=>{this.Lca=gb;return null})})}dispose(){this.$&&(this.gridView.ga.LI(this.Ze),this.gridView.My(this.UR))}selectEntity(Tb){const $a=ib.o(this.gridView.ga.qa.activeCell,
this.$),Nb=()=>new sb.a;Ub.a(this.$.userOperationManager,(Ra,ob,mb)=>N(this.$.pa.va,$a,Tb,db.b(Ra,this.q4i),ob,mb,null),Ra=>new hc.a(109,0,Ra,void 0,Nb),null);return!0}searchEntity(Tb,$a,Nb=!1,Ra=0,ob=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${$a}`);const mb=ib.o(this.gridView.ga.qa.activeCell,this.$);Ub.a(this.$.userOperationManager,(gb,lb,Xb)=>I(this.$.pa.va,mb,Tb,this.Lca,Nb,Ra,ob,db.b(gb,this.wLf),lb,Xb,null),gb=>
new hc.a(110,0,gb,16),null)}zGb(Tb){const $a=ib.o(this.gridView.ga.qa.activeCell,this.$);this.Seb=!1;Ub.a(this.$.userOperationManager,(Nb,Ra,ob)=>U(this.$.pa.va,$a,Tb,db.b(Nb,this.u1i),Ra,ob,null),Nb=>new hc.a(111,0,Nb,16),null);return!0}onPaneClosed(){this.kva=!1;this.rPe=!0;this.xtc=0;this.RIb=!1}cancelSearch(){const Tb=this.oSd();Tb&&Ub.a(this.$.userOperationManager,($a,Nb,Ra)=>ca(this.$.pa.va,Tb,db.b($a,this.wLf),Nb,Ra,null),$a=>new hc.a(112,0,$a,16),null)}selectDataType(Tb){b.ULS.sendTraceTag(537166977,
0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.uua();if(Tb&&Tb.length)if(Tb=JSON.parse(Tb))if(null==Tb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var $a={};$a.Id=Tb.domainId;$a.StringId=Tb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity($a)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,
0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(Tb){const $a=new Gb.a(-859308420,Xa.a.Eb,this.$.Bc,9,null);this.$.Ia.Nb($a,{[Xa.a.$f]:"HelpID="+Tb,["InputMethod"]:Xa.a.Eb,["ShouldCanvasTakeFocus"]:!0,[Xa.a.Uc]:w.a.OV})}showSurveyDialog(Tb){z.a.EPb(new ia(Tb))}insertTable(Tb,$a){const Nb=this.oSd();Nb&&Ub.a(this.$.userOperationManager,(Ra,ob,mb)=>O(this.$.pa.va,Nb,Tb,$a,db.b(Ra,this.b0i),ob,mb,null),Ra=>new hc.a(259,0,Ra,1),null)}Nxd(Tb){this.launchOrCloseDisambiguationPane(Tb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,
0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const Tb=this.FAj();Tb&&Ub.a(this.$.userOperationManager,($a,Nb,Ra)=>G(this.$.pa.va,Tb,!0,this.Lca,!1,null,db.b($a,this.UYi),Nb,Ra,1),$a=>new hc.a(114,0,$a,16),null)}launchLinkedEntityDataTypeSelectorPane(Tb,$a){Ub.a(this.$.userOperationManager,(Nb,Ra,ob)=>Q(this.$.pa.va,Tb,$a,db.b(Nb,this.yrc),Ra,ob,2),Nb=>new hc.a(233,0,Nb,16),null)}oEi(Tb,$a){Tb&&Ub.a(this.$.userOperationManager,
(Nb,Ra,ob)=>G(this.$.pa.va,Tb,!1,!1,!0,$a,db.b(Nb,this.yrc),Ra,ob,2),Nb=>new hc.a(257,0,Nb,16),null)}z9f(Tb){Tb&&(this.xtc=Tb)}atf(Tb){var $a=new Gb.a(-90814711,Xa.a.Eb,0,10,null);this.$.Ia.Nb($a,null);this.kva?this.qac.qGc(Tb,null):($a=3,null!=this.lgb?$a=this.lgb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Tb=this.iZh(Tb,$a))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.nTe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),
this.qac.uEi(this.nTe,Tb),this.kva=!0)}uua(){this.kva&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.qac.wAb(),this.kva=!1,this.xtc=0,this.RIb=!1)}$Bd(Tb){var $a=Tb.Row+1;Tb=Tb.Column+1;0>$a||0>Tb?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.uua(),this.$.ea.xk(this.dd)):($a=new ka.Range($a,Tb,$a,Tb,!0,!1),this.gridView.ga.updateSelection($a,
$a,60),this.Seb=!0)}iZh(Tb,$a){const Nb=new ab;Nb.applicationVersion=d.AFrameworkApplication.buildVersion;Nb.applicationName="ExcelWac";Nb.anid="00000000-0000-0000-0000-000000000000";Nb.sessionId=d.AFrameworkApplication.userSessionId;Nb.appCorrelationId=y.a.create().toString();var Ra=A.a.KH(d.AFrameworkApplication.lcid);Ra=Ra?Ra.name:null;Nb.uiLanguage=Ra;Nb.market=this.eec(Ra);Nb.themeId=0;Nb.disambiguationJson=Tb;$a<=F.a.a2?Nb.featuresBitMask=$a:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");
return Nb}eec(Tb){Tb=Tb.split("-");return Tb[Tb.length-1]}launchOrCloseDisambiguationPane(Tb){const $a=this.gridView.ga.qa.activeCell;if(this.oSd()&&$a)if(this.gridView.wb.GBb($a)){if((!this.rPe||Tb||this.bPb)&&!this.gridView.jb){Tb&&(this.Seb=!0);var Nb=ib.q($a,this.$);Ub.a(this.$.userOperationManager,(Ra,ob,mb)=>G(this.$.pa.va,Nb,!1,this.Lca,!1,null,db.b(Ra,this.yrc),ob,mb,1),Ra=>new hc.a(114,0,Ra,16),null)}}else this.uua();else this.uua()}Ckj(){if(this.kva){var Tb=this.gridView.ga.qa.activeCell;
if(Tb){var $a=ib.q(Tb,this.$);Ub.a(this.$.userOperationManager,(Nb,Ra,ob)=>G(this.$.pa.va,$a,!1,this.Lca,!1,null,db.b(Nb,this.yrc),Ra,ob,1),Nb=>new hc.a(114,0,Nb,16),null)}else this.uua()}}oSd(){const Tb=this.gridView.ga.qa;return Tb.Xca()?ib.o(Tb.activeCell,this.$):null}FAj(){const Tb=this.gridView.ga.qa;return Tb.Xca()?ib.q(Tb.activeCell,this.$):null}}Object(c.a)(wb,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var kb=a(2),tb=a(383),hb=a(1355),Fb=a(54),va=a(736);class jb{constructor(Tb,$a,
Nb){this.Atf=2;this.ztf="Size64by48";this.$=Tb;this.Xa=$a;this.convertToLinkedEntityManager=Nb}nRh(Tb,$a){var {ConvertToLinkedEntityManager:Nb}=a(785);this.N6j();$a=this.Xa.Nq($a).VE();let Ra=0,ob=0,mb=!1;for(var gb of Tb.Categories){const lb=this.TRh(gb,Ra);lb&&(ob===Nb.x$a&&(mb=!0),$a.MenuSectionList.push(lb),++Ra);++ob}mb&&Ra<=Nb.Btf&&$a.MenuSectionList.splice(Nb.x$a,1);Nb=this.Xa.Nc().p4b();gb=Fb.a.mf(11);for(const lb of Tb.LongButtons)this.convertToLinkedEntityManager.nNj(lb)&&this.yOg(Nb,lb,
gb);0<Nb.ControlList.length&&$a.MenuSectionList.push(Nb);return $a}yOg(Tb,$a,Nb){if($a){var Ra="Data.ConvertToLinkedEntityMenuItem_"+$a.Name,ob=this.convertToLinkedEntityManager.XU($a.DomainId);ob&&($a=Object(kb.a)(new tb.a,{Id:Ra,ExternalId:Ra,Command:"-1662108744",LabelText:$a.Name,Alt:$a.SuperTip,Visible:!0,MenuItemId:a(785).ConvertToLinkedEntityManager.O3a($a.DomainId),Image16by16:Nb,Image16by16Class:this.Gji(ob.FontLocator)}),Tb.ControlList.push($a))}}ORh(Tb,$a){return Object(kb.a)(new hb.a,
{Id:a(785).ConvertToLinkedEntityManager.gRe+Tb.toString(),ExternalId:a(785).ConvertToLinkedEntityManager.gRe+Tb.toString(),MenuItemId:a(785).ConvertToLinkedEntityManager.cbd+Tb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.tgf($a.FontLocator),LabelText:$a.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.vid($a)})}WYg(Tb){switch(Tb){case "Animal":return va.a.lVg;case "Apple":return va.a.oWg;case "Atom":return va.a.SXg;
case "Beaker":return va.a.MZg;case "Bridge":return va.a.m0g;case "Cat":return va.a.r6g;case "City":return va.a.J8g;case "Constellation":return va.a.Ech;case "Dog":return va.a.yth;case "Finance":return va.a.EZg;case "GradCap":return va.a.$bi;case "HumanAnatomy":return va.a.Yii;case "LocationPointer":return va.a.VGi;case "Map":return va.a.P7i;case "MedicineNeedle":return va.a.CNi;case "Mountain":return va.a.ROi;case "Movie":return va.a.jPi;case "Music":return va.a.vPi;case "OuterSpace":return va.a.s8i;
case "Planet":return va.a.Baj;case "Satellite":return va.a.Yxj;case "WolframGeneric":return va.a.Owj;default:return va.a.neh}}Gji(Tb){if("PowerBIRibbon"!==Tb)return x.a.pdd;switch(Tb){case "AnimalRibbon":return x.a.OEh;case "AppleRibbon":return x.a.PEh;case "AtomRibbon":return x.a.QEh;case "BeakerRibbon":return x.a.REh;case "BridgeRibbon":return x.a.SEh;case "CenterMapRibbon":return x.a.TEh;case "CityRibbon":return x.a.UEh;case "CurrencyRibbon":return x.a.VEh;case "ExerciseRibbon":return x.a.WEh;
case "FinanceRibbon":return x.a.lXe;case "FirstAidRibbon":return x.a.XEh;case "GlobeLightningRibbon":return x.a.YEh;case "GradCapRibbon":return x.a.ZEh;case "HumanAnatomyRibbon":return x.a.$Eh;case "LeafRibbon":return x.a.aFh;case "LocationPointerRibbon":return x.a.cFh;case "MapRibbon":return x.a.jXe;case "MountainRibbon":return x.a.dFh;case "MovieRibbon":return x.a.eFh;case "MusicRibbon":return x.a.fFh;case "NotablePeopleRibbon":return x.a.gFh;case "OuterSpaceRibbon":return x.a.hFh;case "PartlySunnyWeatherRibbon":return x.a.iFh;
case "PowerBIRibbon":return x.a.kXe;case "SatelliteRibbon":return x.a.jFh;case "WolframGenericRibbon":return x.a.bFh;case "YogaRibbon":return x.a.lFh;default:return x.a.iXe}}tgf(Tb){switch(Tb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";
case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";
case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";
case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}TRh(Tb,$a){$a=this.Xa.dD("ConvertToLinkedEntitySection_"+$a,this.Atf,this.ztf);var Nb=!1;for(var Ra of Tb.DomainIds){const ob=this.convertToLinkedEntityManager.XU(Ra);if(!ob||ob.DomainBlocked||!ob.ShowInRibbon)continue;Nb=ob.Name;const mb=a(785).ConvertToLinkedEntityManager.O3a(Ra);$a.tu("Data.ConvertToLinkedEntityMenuItem_"+mb,-1203788282,"QueryLinkedEntityGalleryIcon",
void 0,mb,this.tgf(ob.FontLocator),void 0,void 0,this.vid(ob),Nb);Nb=!0}if(!Nb)return null;Ra=$a.m4b(!0);$a=this.Xa.Nc();$a.title=Tb.Name;Tb=$a.p4b();Tb.ControlList.push(Ra);return Tb}N6j(){this.Atf=5;this.ztf="Size112by64"}vid(Tb){return Tb.RibbonTooltipHeader?Tb.RibbonTooltipHeader+"\n\n"+Tb.RibbonTooltip:Tb.RibbonTooltip}}Object(c.a)(jb,"ConvertToLinkedEntityMenuRenderer",null,[729]);var Ab=a(59),Qa=a(294),Z=a(120),wa=a(1),Ea=a(154),fa=a(68);class Ua{constructor(Tb,$a){this.Xnd=this.Znd=!1;this.Y2i=
Nb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Znd=!0;if(Sa.a.lg(Nb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Sa.a.xc(Nb.Errors)}`);else{var Ra=0,ob=[],mb=!1;try{if(!Nb.Result)return;const gb=Nb.Result;if(!gb){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}ob=this.M9i(gb);if(!ob||!ob.length)return;Ra=ob.length;this.SNi(ob);this.JBa.U1f();b.ULS.sendTraceTag(537166677,
0,50,`OnReadRoamingStringSuccess MruCount:${this.JBa.udb.length}`);if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const lb of this.JBa.udb)if(1===(lb.Id&1048320)>>8){mb=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${mb}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Ra} data types.`),Nb=[],Nb.push(Object(kb.a)(new fa.a,{name:"MruCount",int64:Ra})),Nb.push(Object(kb.a)(new fa.a,
{name:"MruWolframAvailable",bool:mb})),Ea.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Nb)}this.Xnd&&(this.Grg(this.JBa.udb),this.Xnd=!1)}};this.m7i=Nb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Sa.a.lg(Nb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Sa.a.xc(Nb.Errors)}`):Nb.Result&&(Nb.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.aLf=
(Nb,Ra,ob)=>{Nb=Z.a.Ye(Nb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${ob}. Errors: ${Sa.a.xc(Nb)}.`)};this.$=Tb;this.JBa=$a}s6h(){!this.Znd&&this.$.ea.jc&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),Qa.w(this.$.pa.va,0,this.Y2i,this.aLf,null,null))}Grg(Tb){Tb&&Tb.length?this.Znd?(Tb=this.oCj(Tb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),
Qa.C(this.$.pa.va,0,Tb,this.m7i,this.aLf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Xnd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}oCj(Tb){if(!Tb||!Tb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var $a=[];for(const Nb of Tb)Tb=
{},Tb.Id=Nb.Id,Nb.StringId&&(Tb.StringId=Nb.StringId),$a.push(Tb);$a="<DataTypes>"+Ab.a.Fc($a)+"</DataTypes>";return 1906<$a.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):$a}M9i(Tb){if(!Tb)return b.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!Tb.startsWith("<DataTypes>")||!Tb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,
0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Tb=Tb.substring(11,Tb.length-12);if(!Tb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let $a=[];try{$a=Ab.a.ri(Tb)}catch(Nb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Nb.message}`),null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${$a.length} data types.`);
return $a}SNi(Tb){const $a=this.JBa.udb,Nb=this.JBa.zjj;if($a.length!==Nb){for(let Ra=0;Ra<Tb.length&&$a.length<Nb;++Ra){const ob=Tb[Ra];this.JBa.XU(ob)&&!$a.includes(ob)&&$a.push(ob)}this.JBa.udb=$a}}}Object(c.a)(Ua,"LinkedDataTypeRoamingHandler",null,[]);var Aa=a(61),Ib=a(53),Pb=a(149),Fa=a(39),da=a(51),K=a(31),xa=a(258),rb=a(23),Qb=a(105),pc=a(70),Lb=a(109),qb=a(157),bc=a(41);a.d(C,"ConvertToLinkedEntityManager",function(){return sc});class sc extends v.a{constructor(Tb,$a,Nb,Ra,ob,mb,gb){super();
this.Npf=this.yvd=this.uwd=this.oud=this.nud=this.a9a=this.urd=null;this.aHb=this.znd=0;this.Qma=null;this.Frd=!1;this.zgd=this.fo=this.$Qd=null;this.Gs=0;this.bZ=null;this.SMa=8;this.z3c=this.ytf=this.Ilf=this.Kbb=!1;this.CAa=this.F2e=this.k_e=null;this.K1c=0;this.fZg=5;this.D3b=3E4;this.Ljg=!1;this.taa=null;this.vva=Array(5);this.rmg=this.d2d=!1;this.o3f=this.kyd=0;this.Sb=this.Mge=null;this.Gdg=!0;this.dd=(lb,Xb)=>{Xb.jc&&!Xb.CDb&&this.showUntrustedImageBusinessBarIfNecessary()};this.UZi=lb=>{if(lb.Result){var Xb=
lb.Result;if(Xb&&Xb.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Xb.length} labels`);var Xd=Ib.GetServiceTaskFactory.Sa(this.$.da,274,275,0);Fa.TaskExtensions.za(Xd,()=>{Xd.result.y1c(Xb,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ka,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.Gf=()=>{this.S1j();this.gei(this.$.ea.jn.LinkedEntityAsyncRefreshStateId);
this.l9a?this.kfi(this.$.ea.jn.RichDataClassificationLabelStateId):this.q8a&&this.r1d(!0)};this.pXi=()=>{this.d2d=!0;this.fo&&this.fo.Ckj()};this.mZi=lb=>{if(lb&&!xa.a(lb))try{lb.Result.HasUntrustedImageUrl&&(this.businessBar.eh(59,null),this.rmg=!0)}catch(Xb){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Xb}.`)}};this.Ysf=()=>{if(!this.ytf&&this.YBb()&&!this.qsd())if(Ea.a("DataTabActive"),
Aa.a.Ag.wR)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var lb=this.N7b();if(lb){var Xb={};Xb.InputMethod=Xa.a.Eb;Xb.CalloutName=8;Xb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ia.Nb(lb,Xb);this.ytf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else b.ULS.sendTraceTag(537166882,
0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.kWi=lb=>{Sa.a.lg(lb.Errors)||(this.l9a||this.r1d(!1),this.raiseEvent("LinkedEntityConverted"))};this.r5i=()=>{this.$.da.kb(211,lb=>{lb.readText(aa.a.instance.ha(1813))})};this.yd=(lb,Xb)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Xb.hW?b.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):
(this.$.isEditMode?this.yEe():this.yuj(),this.d2d&&this.pSe())};this.vZi=lb=>{this.W5b();if(lb.Result){var Xb=lb.Result;lb=Xb.DomainDataArray;if(this.Qma=Xb.Ribbon){var Xd={};Xd.Name=aa.a.instance.ha(1803);Xd.DomainIds=this.NK;this.Qma.Categories.splice(sc.x$a,0,Xd)}0<Xb.MaximumCellsToConvert&&(this.Mge=Xb.MaximumCellsToConvert);this.Gs=2;Xb=!1;if(lb){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${lb.length} domains`);this.qPa||(this.qPa=[]);Xd=aa.a.instance.ha(1800);
const Qd=aa.a.instance.ha(1802);for(const te of lb)te.DomainId?(this.qPa.push(te),te.DomainBlocked?(lb=!!te.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${lb?te.DomainId.Id.toString():te.Name} is telemetry only, do not show in menu (Has String ID: ${lb})`)):(this.WU.ia(sc.O3a(te.DomainId),te),te.Name===Xd||268435456===te.DomainId.Id?this.k_e=te.DomainId.Id.toString():te.Name===Qd||536870912===te.DomainId.Id?this.F2e=te.DomainId.Id.toString():268435712===te.DomainId.Id&&te.ShowInRibbon&&
(this.z3c=!0),Xb=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Xb||(this.qPa=null);this.eng();this.$Qd.s6h();this.Ljg||(this.N1j(),this.Ljg=!0)}else this.qPa=null,this.Gs=3,-1<this.SMa&&window.setTimeout(()=>{this.MJb()},100*(8-this.SMa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.EMd();this.QKe();this.z3c&&this.bnf&&Pb.c(this.Ysf,this.$.ka,500);this.q8a&&!this.l9a&&this.r1d(!0)};this.uZi=
lb=>{lb=Z.a.Ye(lb.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Sa.a.xc(lb)}].`);this.qPa=null;this.Gs=3;this.Kbb=!0;this.EMd()};this.onContentReady=()=>{this.$kg()&&this.gridView.My(this.onContentReady);this.Gdg&&this.$.workbookContext.Options&1048576&&(this.businessBar.aRj(),this.Gdg=!1)};this.Kk=()=>{this.W5b()};this.T0i=lb=>{if(xa.a(lb)){const Xb=Object(pc.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(Lb.d)(qb.a.resolve(bc.f,{rb:0})):
Ib.GetServiceTaskFactory.Sa(this.$.da,5,4,0);Fa.TaskExtensions.za(Xb,()=>{let Qd=null;if(null===lb||void 0===lb?0:lb.Errors)Qd=lb.Errors[0];Xb.result.kdg(Qd,null)},this.$.ka,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Sa.a.xc(lb.Errors)}].`);const Xd=Sa.a.hA(lb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.qo(Xd)}};
this.s3c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.D3b} millisecond interval`);this.ejf("Periodic auto-refresh check",this.BUi,this.AUi)};this.BUi=lb=>{xa.a(lb)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Sa.a.xc(lb.Errors)}].`),++this.K1c):this.K1c=0;f.a.Ja(this.CAa);this.K1c>=this.fZg?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.CAa=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.CAa=da.a.instance.create(this.s3c,this.D3b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.AUi=lb=>{lb=Z.a.Ye(lb.data);e.a.Yg(lb)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Sa.a.xc(lb)}].`);f.a.Ja(this.CAa);this.CAa=da.a.instance.create(this.s3c,this.D3b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.T1i=lb=>{lb=!!lb.Result&&lb.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${lb.toString()}`);lb?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${K.a.Ya.Ce.m-
this.znd} ms, retry count = ${this.aHb}`),this.MJb()):this.YCc()};this.S1i=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.YCc()};this.YYi=lb=>{lb.Result?(lb=lb.Result)?(this.ONd(),this.businessBar.kdg(null,lb)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=Tb;this.businessBar=mb;this.svgIconProvider=
Nb;this.Sb=gb;this.qPa=[];this.NK=[];this.gridView=fb.h(this.$);this.Lgc=-1;this.rwi=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.q8a=wa.EwaSettings.ya(387);this.l9a=wa.EwaSettings.ya(586);this.bnf=wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.WU=new Qb.a;this.bab=new jb(Tb,$a,this);Ra&&(this.fo=new wb(Tb,Ra,ob,this,this));this.$.rl(this.yd);m.a(this.$)&&m.a(this.$).RDj(this);
this.yEe();(this.q8a||this.l9a)&&this.$.ea.vu(this.Gf);wa.EwaSettings.ya(123)&&wa.EwaSettings.ya(131)&&(this.$kg()||this.gridView.vv(this.onContentReady));this.$.GC(this.Kk);this.$.ea.Zj(this.dd);this.showUntrustedImageBusinessBarIfNecessary();this.$Qd=new Ua(this.$,this)}dispose(){(this.q8a||this.l9a)&&this.$.ea.$v(this.Gf);this.$.ea.xk(this.dd);!this.taa&&wa.EwaSettings.ya(123)&&wa.EwaSettings.ya(131)&&this.gridView.My(this.onContentReady);this.fo&&this.fo.dispose();this.$.gG(this.Kk);this.$.lm(this.yd);
this.q8a&&(this.urd=null);f.a.Ja(this.CAa)}CRg(Tb){this.addHandler("LinkedEntityConverted",Tb)}oqj(Tb){this.removeHandler("LinkedEntityConverted",Tb)}get zjj(){return 5}get udb(){return this.NK}set udb(Tb){this.NK=Tb}selectEntity(Tb){return this.fo?this.fo.selectEntity(Tb):!1}searchEntity(Tb,$a){this.fo&&this.fo.searchEntity(Tb,$a)}WRd(Tb,$a,Nb,Ra){this.fo&&this.fo.searchEntity(Tb,$a,!0,Nb,Ra)}zGb(Tb){return this.fo?this.fo.zGb(Tb):!1}onPaneClosed(){if(this.fo)this.fo.onPaneClosed()}cancelSearch(){this.fo&&
this.fo.cancelSearch()}selectDataType(Tb){this.fo&&this.fo.selectDataType(Tb)}showHelpArticle(Tb){this.fo&&this.fo.showHelpArticle(Tb)}showSurveyDialog(Tb){this.fo&&this.fo.showSurveyDialog(Tb)}insertTable(Tb,$a){this.fo&&this.fo.insertTable(Tb,$a)}kfi(Tb){this.$.isEditMode&&this.o3f!==Tb&&d.AFrameworkApplication.fa.ra("SupportsPolicies")&&(this.o3f=Tb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),B(this.$.pa.va,this.UZi,
null,null,null))}pSe(){this.$.userOperationManager.Tc(new hc.a(589,0,(Tb,$a,Nb)=>ea(this.$.pa.va,db.b(Tb,this.pXi),$a,Nb,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.d2d||this.rmg||!this.$.ea.jc||this.tBj()}tBj(){this.$.userOperationManager.Tc(new hc.a(588,0,(Tb,$a,Nb)=>la(this.$.pa.va,db.b(Tb,this.mZi),$a,Nb,null),80),null)}r1d(Tb){if(this.q8a&&null==this.urd&&!this.l9a&&d.AFrameworkApplication.fa.ra("SupportsPolicies")&&null!=this.a9a&&this.a9a&&(!Tb||this.$.workbookContext.Options&
262144)){var $a=Ib.GetServiceTaskFactory.Sa(this.$.da,274,275,0);Fa.TaskExtensions.za($a,()=>{this.urd=$a.result.EXf(2)},this.$.ka,3)}}get bGb(){return this.vva.length}get zNi(){return this.Mge}oeh(Tb){(Tb=this.Cth(Tb))?this.convertToLinkedEntity(Tb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(Tb){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${Tb.Id}].`);if(this.gridView){var $a=
this.gridView.ga.qa.gd,Nb=$a.ze(this.gridView.SQ);this.Frd&&this.jPg(Tb);if(Nb){Nb=this.gridView.wb.wma(Nb);if(!this.Odf(Tb)&&this.hof(Tb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Aa.a.Ag.wR){$a=this.Ghd();if(!$a){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Nb=this.N7b();if(!Nb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");
return}var Ra={["InputMethod"]:Xa.a.Eb,CalloutName:3};Ra.Target=$a;Ra.RibbonButtonLabel=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.b3f(Tb):this.rEb(Tb.Id.toString());Ra.ExampleEntities=this.iYe(Tb);this.$.Ia.Nb(Nb,Ra);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.hof(Tb.Id)&&!Tb.StringId)this.launchLinkedEntityDataTypeSelectorPane(sc.O3a(Tb));
else{if(Nb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.lWj(Tb)){$a=ib.r(this.gridView.ga.qa.selectedRanges,this.$);this.fo.oEi($a,Tb);return}if(Aa.a.Ag.wR){$a=this.Ghd();if(!$a){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Nb=this.N7b();if(!Nb){b.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}Ra={["InputMethod"]:Xa.a.Eb,CalloutName:2};Ra.Target=$a;Ra.RibbonButtonLabel=this.b3f(Tb);Ra.ExampleEntities=this.iYe(Tb);Ra.BlankCellResourceId=this.k_g(Tb);Ra.HasBlankCellWalkthrough=this.fgi(Tb);Ra.ServiceDomain=Tb.Id;this.$.Ia.Nb(Nb,Ra);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.l7c(Tb,!1,$a)}}}else b.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.taa&&this.taa.DJa()}onAutoDetectUIShown(){Ub.a(this.$.userOperationManager,(Tb,$a,Nb)=>R(this.$.pa.va,Tb,$a,Nb,null),Tb=>new hc.a(230,0,Tb,80),null)}l7c(Tb,$a,Nb){const Ra=ib.q(Nb,this.$),ob=()=>new sb.a;Ub.a(this.$.userOperationManager,(mb,gb,lb)=>M(this.$.pa.va,Ra,Tb,$a,db.b(mb,this.kWi,this.r5i,this.fo.jWi),gb,lb,null),mb=>new hc.a(115,0,mb,void 0,ob),null)}jPg(Tb){if(this.Frd){var $a={};$a.Id=Tb.Id;Tb.StringId&&($a.StringId=
Tb.StringId);if(!(0<this.NK.length&&this.NK[0].Id===$a.Id&&this.NK[0].StringId===$a.StringId)){Tb=!1;this.NK.splice(0,0,$a);for(let Nb=1;Nb<this.NK.length;++Nb)if(this.NK[Nb].Id===$a.Id&&this.NK[Nb].StringId===$a.StringId){this.NK.splice(Nb,1);Tb=!0;break}for(;5<this.NK.length;)this.NK.splice(this.NK.length-1,1);this.Qma.Categories[sc.x$a].DomainIds=this.NK;this.U1f();Tb||this.$Qd.Grg(this.NK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");
if(this.gridView){var Tb=ib.q(this.gridView.ga.qa.gd,this.$);Ub.a(this.$.userOperationManager,($a,Nb,Ra)=>E(this.$.pa.va,Tb,$a,Nb,Ra,null),$a=>new hc.a(116,0,$a),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(fb.h(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");
this.ONd();var Tb=ib.r(this.gridView.ga.qa.selectedRanges,this.$);Ub.a(this.$.userOperationManager,($a,Nb,Ra)=>H(this.$.pa.va,Tb,$a,Nb,Ra,null),$a=>new hc.a(248,0,$a),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}nNj(Tb){Tb=this.XU(Tb.DomainId);if(!Tb||Tb.DomainBlocked||wa.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!Tb.HasCuratedData)return!1;if(this.rwi){for(let $a of this.WU)if($a.value.DomainId.Id===Tb.DomainId.Id&&$a.value.ShowInRibbon)return!0;
return!1}return Tb.ShowInRibbon}RLj(Tb){return 2!==this.Gs||!this.vva[Tb]}launchDisambiguationPaneForSearch(){this.fo&&this.fo.launchDisambiguationPaneForSearch()}Vc(Tb,$a,Nb){if("PopulateConvertToLinkedEntityMenu"!==$a)return!1;this.zgd=Nb.MenuId;if(0===this.Gs||3===this.Gs)return this.dbj(),!0;if(!this.Qma)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.WU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),
!1;this.bZ=this.bZ||this.bab.nRh(this.Qma,Nb.MenuId);Nb.MenuItems=this.bZ;return this.Frd=!0}dbj(){-1===this.Lgc&&(this.MJb(),this.Lgc=window.setInterval(()=>{this.MJb()},2E3))}MJb(){this.$.ea.jc&&2!==this.Gs&&(this.SMa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Gs=1,P(this.$.pa.va,this.vZi,this.uZi,null,null))}qsd(){return this.$.isEditMode&&2!==this.Gs&&(0<=this.SMa||!this.Kbb)}Q2d(Tb){d.AFrameworkApplication.ug?
b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):m.a(this.$)?(this.q7j(),Tb&&this.$.zf()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}yuj(){this.aHb=0;this.SMa=8;this.Kbb=!1;this.Gs=this.Lgc=0;this.qPa=this.Qma=null;this.W5b();for(let Tb=0;Tb<this.bGb;++Tb)this.vva[Tb]=null;this.YBb()&&this.Q2d(!0)}W5b(){this.bZ=null}YBb(){const Tb=w.a.DKb,$a=m.a(this.$);return!!$a&&$a.Fp.oA===Tb}eng(){if(this.Qma){let Nb=
0;var Tb=-1,$a=-1;let Ra=0,ob=0,mb=0,gb=0;const lb=[null,null,null,null,null];for(const Xb of this.Qma.Categories){let Xd=!1;for(const Qd of Xb.DomainIds){let te=this.XU(Qd);te&&!te.DomainBlocked&&te.ShowInRibbon&&(Nb<this.bGb?(this.vva[Nb]=Qd,ob===sc.x$a&&(-1===Tb&&(Tb=Nb),$a=Nb,gb=$a-Tb+1),++Nb):Nb===this.bGb&&Ra<gb&&ob!==sc.x$a&&(lb[Ra]=Qd,++Ra),Xd=!0)}Xd&&++mb;++ob}if(-1<Tb&&mb<=sc.Btf){for(;$a>=Tb;--$a)this.vva.splice($a,1);for(Tb=0;Tb<gb;++Tb)this.vva.splice(Nb+Tb,0,lb[Tb])}for(;Nb<this.bGb;)this.vva[Nb]=
null,++Nb}}$kg(){const Tb=fb.h(this.$).Ca,$a=this.gridView.ga.Se;if(Tb&&Tb.Gnd&&1===$a&&this.gridView.ga.qa.activeCell){const Nb=Object(pc.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(Lb.d)(qb.a.resolve(bc.X,{rb:1})):Ib.GetServiceTaskFactory.Sa(this.$.da,12,477,1);Fa.TaskExtensions.za(Nb,()=>{this.taa=new n.a(this.$,this.svgIconProvider,Nb.result,this,this.Sb)},this.$.ka,3);return!0}return!1}rEi(){this.fo&&this.fo.Nxd(!0)}launchLinkedEntityDataTypeSelectorPane(Tb){if(this.fo)if(Tb=
this.Iad(Tb))if(Tb.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var $a=ib.r(this.gridView.ga.qa.selectedRanges,this.$);this.fo.launchLinkedEntityDataTypeSelectorPane($a,Tb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}Hch(Tb){const $a=this.Fji(Tb),Nb=h.a.Jh(this.rEb(Tb));Tb=h.a.Jh(this.s0d(Tb));return sc.RQh($a,Fb.a.mf(11),Nb,Tb)}s0d(Tb){try{return this.rQe(parseInt(Tb,
10)).Description}catch($a){}return aa.a.instance.ha(1797)}rEb(Tb){try{return this.rQe(parseInt(Tb,10)).Name}catch($a){}return aa.a.instance.ha(1783)}b3f(Tb){try{return this.XU(Tb).Name}catch($a){}return this.rEb(Tb.Id.toString())}k_g(Tb){try{return this.XU(Tb).BlankCellResourceId}catch($a){}return null}fgi(Tb){try{return this.XU(Tb).HasBlankCellWalkthrough}catch($a){}return!1}Odf(Tb){try{const $a=sc.O3a(Tb);if(this.WU.nb($a))return this.WU.ma($a).HasCuratedData}catch($a){}return!1}lWj(Tb){try{return this.XU(Tb).SupportsStarterData}catch($a){}return!1}hof(Tb){return 268435968===
Tb}Ghd(){return 2===m.a(this.$).vO?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}N7b(){return new Gb.a(-847286761,Xa.a.Eb,this.$.Bc,0,w.a.L0)}QKe(){if(this.YBb()&&!this.qsd()&&!this.Ilf&&wa.EwaSettings.ya(387)&&this.Odf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),Aa.a.Ag.wR){const Nb=this.Ghd();if(Nb){var Tb=this.N7b();if(Tb){var $a=
{["InputMethod"]:Xa.a.Eb,CalloutName:6};$a.Target=Nb;$a.ShouldCanvasTakeFocus=!0;this.$.Ia.Nb(Tb,$a);this.Ilf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}gji(Tb){Tb=this.Iad(Tb);
return Tb?this.bab.WYg(Tb.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}vjc(Tb){return this.taa?this.taa.VYg(Tb):!1}bUh(){return this.taa?this.taa.$Uh():""}pri(){return this.taa?this.taa.WEb:!1}TYh(Tb,$a){const Nb=this.chf(Tb);if(0>Nb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${Tb}`);else if(Tb=(Tb=this.sQe(Tb))?this.XU(Tb):
null)$a[r.a.GalleryButtonProps]=this.bab.ORh(Nb,Tb),$a[r.a.Alt]=this.bab.vid(Tb)}U1f(){this.eng();this.YBb()&&this.Q2d(!0);this.W5b()}Fji(Tb){return Tb===this.k_e?x.a.lXe:Tb===this.F2e?x.a.jXe:x.a.iXe}iYe(Tb){try{return this.XU(Tb).ExampleEntities}catch($a){}return aa.a.instance.ha(1805)}EMd(){(0>this.SMa||this.Kbb)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Gs||0>this.SMa||this.Kbb)&&window.clearInterval(this.Lgc);this.qsd()?
this.zgd&&this.$.frame.Dx(this.zgd):this.Q2d(this.YBb())}Lb(Tb){return this.$.Ib+Tb}q7j(){var Tb=!0;const $a=Array(this.bGb),Nb=m.a(this.$)?m.a(this.$).Fp:null;if(Nb){for(let Ra=0;Ra<$a.length;++Ra)this.RLj(Ra)?$a[Ra]=!0:Tb=$a[Ra]=!1;Nb.P9f(["ConvertToLinkedEntityGallery"],Tb);if(!Tb)for(Tb=0;Tb<$a.length;++Tb)$a[Tb]&&Nb.P9f([this.SYh(Tb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}XU(Tb){const $a=sc.O3a(Tb);if(this.WU.nb($a))return this.WU.ma($a);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${Tb.Id} (Has String ID: ${!!Tb.StringId})`);return null}SYh(Tb){return"ConvertToLinkedEntityPreview"+Tb.toString()}G2d(){l.a.get_instance().ek(10,()=>{this.QKe();this.z3c&&this.bnf&&Pb.c(this.Ysf,this.$.ka,500)})}xgc(Tb,$a){switch(Tb){case "QueryLinkedEntityGalleryButtons":if(!$a[r.a.InnerHTML]){Tb=$a[Xa.a.Uc].toString();const Nb=rb.a.equals(Tb,aa.a.instance.ha(1800),!0)||rb.a.equals(Tb,aa.a.instance.ha(1801),!0),Ra=rb.a.equals(Tb,aa.a.instance.ha(1802),
!0);Nb||Ra||this.TYh(Tb,$a)}break;case "QueryLinkedEntityMenuGalleryButtons":$a[r.a.InnerHTML]||($a[r.a.InnerHTML]=this.Hch($a[Xa.a.Uc]))}return $a}Cth(Tb){var $a=this.sQe(Tb);if($a)return $a;if($a=this.Iad(Tb))return $a.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${Tb}`);return null}rQe(Tb){const $a={};$a.Id=Tb;return this.XU($a)}Iad(Tb){return this.WU.nb(Tb)?this.WU.ma(Tb):null}chf(Tb){if(!Tb.startsWith(sc.cbd))return-1;const $a=parseInt(Tb.substr(sc.cbd.length),
10);return isNaN($a)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${Tb}`),-1):$a}sQe(Tb){Tb=this.chf(Tb);return 0>Tb?null:this.vva[Tb]}ejf(Tb,$a,Nb){this.WU&&this.WU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${Tb})`),Tb=this.$.pa.va.ic(),this.$.ea.jc&&ha(this.$.pa.va,db.b(this.T0i,$a),Nb,null,null,Tb))}N1j(){this.ejf("Auto-refresh on load",null,null)}S1j(){this.WU&&this.WU.count&&(this.CAa?b.ULS.sendTraceTag(537166799,
0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.jn.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.CAa=da.a.instance.create(this.s3c,this.D3b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}YCc(){if(this.$.ea.jc&&null!=this.a9a&&null!=this.nud&&null!=this.oud&&null!=this.uwd&&null!=this.yvd)if(++this.aHb,12>=this.aHb){1===this.aHb&&(this.znd=K.a.Ya.Ce.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const Tb=this.$.pa.va.ic();Qa.u(this.$.pa.va,
this.uFi,this.vFi(),this.T1i,this.S1i,null,Tb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${K.a.Ya.Ce.m-this.znd} ms`),this.Kbb=!0,this.EMd()}yEe(){if(this.$.isEditMode)if(null!=this.a9a)this.YCc();else{var Tb=K.a.Ya.Ce.m,$a=[];u.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Nb=>{Nb.isFeatureEnabled("ExcelPowerBiPro",!1).then(Ra=>{b.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${K.a.Ya.Ce.m-
Tb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${Ra}]`);return this.a9a=Ra}).then(()=>{$a.push(Nb.isFeatureEnabled("ExcelWolframAlpha",!1).then(Ra=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${K.a.Ya.Ce.m-Tb} Millisecond.`);b.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${Ra}]`);
return this.uwd=Ra}))}).then(()=>{$a.push(Nb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(Ra=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${K.a.Ya.Ce.m-Tb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${Ra}]`);const ob=[Object(kb.a)(new fa.a,{name:"IsRestrictedByLicense",bool:Ra})];Ea.a("SatoriStockGeographyLicensingRestrictions",
void 0,void 0,ob);this.Npf=Ra&&wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return Ra}))}).then(()=>{$a.push(Nb.isFeatureEnabled("StockHistory",!1).then(Ra=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${K.a.Ya.Ce.m-Tb} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${Ra}]`);return this.yvd=Ra}))}).then(()=>
{$a.push(Nb.isFeatureEnabled("ExcelPowerBiFree",!1).then(Ra=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${K.a.Ya.Ce.m-Tb} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${Ra}]`);return this.nud=Ra}))}).then(()=>{$a.push(Nb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(Ra=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${K.a.Ya.Ce.m-
Tb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${Ra}]`);return this.oud=Ra}))}).then(()=>{Promise.all($a).then(()=>{this.YCc()})})})}}get uFi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}vFi(){return[this.a9a,this.uwd,this.yvd,this.nud,this.oud,this.Npf]}ONd(){this.businessBar&&this.businessBar.hma(58)&&
this.businessBar.removeEntry(58)}gei(Tb){this.kyd!==Tb&&this.businessBar&&((this.kyd=Tb)?Y(this.$.pa.va,this.YYi,null,null,null):this.ONd())}static RQh(Tb,$a,Nb,Ra){Tb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Tb,$a,Ra);Nb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Nb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',
Tb,Nb)}static O3a(Tb){return Tb.StringId?Tb.Id.toString()+"."+Tb.StringId:Tb.Id.toString()}}sc.gRe="ConvertToLinkedEntityPreview";sc.cbd="PreviewGalleryButtonIndex.";sc.x$a=0;sc.Btf=2;Object(c.a)(sc,"ConvertToLinkedEntityManager",v.a,[673,674,2,675])},863:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);C=a(731);var c=a(98);class b extends C.a{constructor(f,e,d){super(f,e);this.Ir=!0;this.command=d}pn(f){super.pn(f);this.businessBar.$.Ia.Nb(new c.a(this.command,f,this.businessBar.$.Bc,10,null))}}
Object(t.a)(b,"CommandActionBusinessBarEntry",C.a,[])},883:function(t,C,a){a.r(C);t=a(0);var c=a(2),b=a(14),f=a(330),e=a(32),d=a(12),h=a(274);class r{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(t.a)(r,"ConnectionErrorLogInfo",null,[]);var l=a(1079),u=a(1080);class v{constructor(w){this.apd=[l.a.ssg,l.a.uIc];this.Xl=(m,n)=>{this.tO[n]=m;this.Pgi()&&this.wtj("OnNetworkDownImmediatePing"===m.caller)};this.jna=w;this.$=w.$;this.tO={}}mEi(){const w=
u.a.Vgd(this.Xl,"OnNetworkDownImmediatePing",this.$,this.apd);for(const m of w)m.runTest()}Pgi(){for(const w of this.apd)if(void 0===this.tO[w]||null===this.tO[w])return!1;return!0}wtj(w){const m=this.$.ef.m6;w&&this.oVj(m);for(var n of this.apd)this.tO[n]=Sys.Serialization.JavaScriptSerializer.serialize(this.tO[n]);w=Date.now();n=this.jna.Uld(a(883).NetworkConnectionHealthChecker.NGb).returnValue;const z=this.jna.Uld(a(883).NetworkConnectionHealthChecker.UNb).returnValue;this.tO.isOfflineMode=m;
this.tO.networkDownBBAge=-1===n?n:w-n;this.tO.transientServerCommunicationFailuresBBAge=-1===z?z:w-z;this.jna.businessBar?(this.tO.isNetworkDownBBShown=this.jna.businessBar.rH(56).toString(),this.tO.isServerErrorBBShown=this.jna.businessBar.rH(21).toString()):(this.tO.isNetworkDownBBShown="unknown",this.tO.isServerErrorBBShown="unknown");b.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.tO)}`)}oVj(w){const {NetworkConnectionHealthChecker:m}=
a(883),n={};for(const z of Object.keys(this.tO)){const y=this.tO[z];n[y.testName]=y.isSuccess}n.isOfflineMode=w;this.jna.fZd(m.J6c,Sys.Serialization.JavaScriptSerializer.serialize(n))}}Object(t.a)(v,"ConnectionHealthTestsRunner",null,[]);a.d(C,"NetworkConnectionHealthChecker",function(){return x});class x{constructor(w){this.businessBar=this.f$a=null;this.qUi=(m,n)=>{n.rad?this.sUi(n):this.rUi(n)};this.xh=(m,n)=>{m=n.context.methodName;this.f$a&&m===this.f$a&&(b.ULS.sendTraceTag(537155230,0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.f$a}" has now succeeded. Querying local storage for BB showings.`),
this.E$a(x.UNb,!0),this.f$a=null);this.ovf(!1);this.T6b=!1};this.Mm=(m,n)=>{e.a.fh(n.errors,[-1387426400])&&!this.T6b&&(this.T6b=!0,this.ebg()&&window.performance.mark(x.qCf),(new v(this)).mEi())};this.gg=()=>{this.ovf(!0);this.E$a(x.NGb,!1);this.E$a(x.UNb,!1)};this.hAa=()=>{this.E$a(x.NGb,!0)};this.$=w;this.pa=this.$.pa;this.localStorage=new h.a;this.T6b=!1;this.$.ea.mk(this.gg);this.pa.ef.Xpb(this.hAa);this.pa.ur(this.xh);this.$.da.kb(5,m=>{this.businessBar=m;m.WPg(this.qUi)});this.pa.Tx(this.Mm)}dispose(){this.$&&
(this.$.ea&&this.$.ea.rn(this.gg),this.pa&&(this.pa.ef.MLb(this.hAa),this.pa.Ny(this.Mm),this.pa.Ms(this.xh)))}sUi(w){const m={};m.Timestamp=Date.now().toString();switch(w.l1a){case 21:this.f$a=w.data.FailedMethod;m.FailedMethod=this.f$a;this.fZd(x.UNb,JSON.stringify(m));break;case 56:this.fZd(x.NGb,JSON.stringify(m))}}rUi(w){switch(w.l1a){case 21:this.E$a(x.UNb,!0);break;case 56:this.E$a(x.NGb,!0)}}fZd(w,m){try{this.localStorage.Pe()&&this.localStorage.setItem(w,m)}catch(n){b.ULS.sendTraceTag(537155231,
0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${n.message||"Unknown"}`)}}Uld(w){if(this.localStorage.Pe()&&(w=this.localStorage.nMa(w))&&"null"!==w){var m=JSON.parse(w);w=parseInt(m.Timestamp,10);m=Sys.Serialization.JavaScriptSerializer.serialize(m);return{returnValue:w,rawData:m}}return{returnValue:-1,rawData:null}}ovf(w){if(this.localStorage.Pe()){const m=this.localStorage.nMa(x.J6c);if(m&&"null"!==m){let n=-1;this.T6b&&(n=this.QYh(x.qCf,
x.bTi));b.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(m)}, Period offline: ${n}, New session: ${w}`);this.localStorage.removeItem(x.J6c)}}}QYh(w,m){if(!this.ebg())return-1;window.performance.measure(m,w);w=window.performance.getEntriesByName(m);return w.length&&w[w.length-1]?w[w.length-1].duration:(b.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${m} returned no measures.`),
-1)}E$a(w,m){try{let n;const z=({rawData:n}=this.Uld(w)).returnValue;if(-1!==z){const y=Object(c.a)(new r,{timeElapsed:Date.now()-z,scenario:w,isNewSession:!m,rawData:n});b.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(y)}`)}this.localStorage.removeItem(w)}catch(n){b.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${n.message||"Unknown"}`)}}ebg(){return d.HelperMethods.B2c&&
f.a.Lrb}}x.NGb="NetworkDownBBShown";x.UNb="ServerCommunicationFailureBBShown";x.J6c="ConnectionHealthPingRsults";x.qCf="offMoStMa";x.bTi="offMoDuMea";Object(t.a)(x,"NetworkConnectionHealthChecker",null,[2])},935:function(t,C,a){a.d(C,"a",function(){return d});t=a(0);var c=a(14),b=a(6),f=a(43),e=a(29);class d{static h3e(h,r){switch(h){case 3:return d.$ai(r);case 2:return d.w4h(r);case 1:return d.uZh(r)}return""}static $ai(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static w4h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static uZh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,
r,l){if(e.a.Xg||e.a.gq)window.setTimeout(()=>{d.$Wf(l,d.gbf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.uwe(l),h,0,!1)}static S9g(h,r,l,u){r&&u&&u();d.openInClient(h,r,l)}static gbf(){return e.a.Xg?1:e.a.gq?2:e.a.S9a?3:e.a.isMac?4:0}static get OCb(){return"zh-CN"===window.navigator.language}static $Wf(h,r){1===r?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),h=d.h3e(h,r),8<e.a.GAb?f.a.vf(h,void 0,void 0,"RedirectToAppStore"):f.a.rV(h)):document.hidden||
(d.OCb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),f.a.rV(h)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.h3e(h,r),null,null)))}static uwe(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get zWd(){return(e.a.S9a||
e.a.isMac)&&e.a.Lo}static x3e(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static owi(h){return(h=d.x1h(h))&&""!==h?Boolean.parse(h):!1}static GUd(h){d.KFj(h)}static x1h(h){try{return localStorage.getItem(h)}catch(r){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+r.message),null}}static KFj(h){try{localStorage.setItem(h,"true")}catch(r){c.ULS.sendTraceTag(18416669,
306,50,"WildFire LocalStorage SetItem Failed with exception : "+r.message)}}}d.E8g="ChromeExtensionBarDismiss";Object(t.a)(d,"WildFireUtilities",null,[])},974:function(t,C,a){a.r(C);t=a(0);var c=a(14),b=a(232),f;(function(m){m[m.paren=0]="paren";m[m.lead=1]="lead";m[m.intern=2]="intern";m[m.trail=3]="trail";m[m.undefined=4]="undefined"})(f||(f={}));Object(t.b)("CurrencyFormatOption",f);var e;(function(m){m[m.none=-1]="none";m[m.mdy=0]="mdy";m[m.dmy=1]="dmy";m[m.ymd=2]="ymd";m[m.myd=3]="myd";m[m.dym=
4]="dym";m[m.ydm=5]="ydm"})(e||(e={}));Object(t.b)("DateOrderOption",e);var d=a(9);class h{constructor(m,n){({CalcHelper:m}=a(974));n&&(n.Ve||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.jEg=m.TKe(n,m.DKe(n.Hka));this.kEg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.kEg}get localeData(){return this.jEg}}Object(t.a)(h,"LocaleHolder",null,[]);var r=a(1097),l=a(54),u=a(1),v=a(23),x=a(182);a.d(C,"CalcHelper",
function(){return w});class w{constructor(m){this.$=m;(this.xy=this.$.da.Aa(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let n;n=u.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?l.a.current.io(77):l.a.current.io(80);this.logger=new r.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.RGi=new h(m,this.xy);excelOnlineCalc.config.initCalc(this.logger,
this.xy?z=>this.xy.isFeatureEnabled(z):()=>!1,n);this.kga=excelOnlineCalc.config.calcConfig(this.RGi.localeInfo)}get config(){return this.kga}Rmh(){if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.ua)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const m=this.$.ua.na;return m?m.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.ua.na.index}createParser(){const m=
{};m.config=this.config;return excelOnlineCalc.parse.createParser(m)}createNumberFormatter(){const m=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(n,z)=>excelOnlineCalc.calc.getTime(this.config,n,z,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(m)}glh(m,n,z,y){if(!y)return{range:{row:n,col:z},sheet:{document:this.documentLoc,index:m}};n=excelOnlineCalc.location.gridCell(n,z);m=excelOnlineCalc.location.sheetIndex(this.documentLoc,m);return excelOnlineCalc.location.sheetGridCell(m,
n)}static TKe(m,n=null){const z=w.U7b(),y=m.Ve.TrueValueString,A=m.Ve.FalseValueString,F=m.Ve.DecimalSeparator.toString(),D=m.Ve.ListSeparator.toString(),B=m.Ve.ColumnSeparator.toString(),M=m.Ve.RowSeparator.toString(),R=m.Ve.ThousandsDataArray,P=m.Ve.ThousandSeparator.toString(),E=m.Ve.Lcid,H=m.Ve.Country,G=m.Ve.DigitsNumber,N=m.Ve.ExpSeparatedBySpace,I=m.Ve.FractionSeparator.toString(),O=m.Ve.PercentSeparatedBySpace,U=v.a.f6g(Enum.toString(f,m.Ve.CurrencyFormat)),ca=m.Ve.CurrencySymbolLead,Q=m.Ve.CurrencySeparatedBySpace,
Y=m.Ve.CurrencySymbolString,la=m.Ve.DigitsCurrency,ea=-1===m.Ve.DateOrder?"MDY":x.e(Enum.toString(e,m.Ve.DateOrder)),ha=m.Ve.DateSeparator.toString(),X=m.Ve.DateAlternativeSeparator.toString(),T=m.Ve.Year4Digits,ua=m.Ve.Month2Digits,Ha=m.Ve.Day2Digits,Ca=m.Ve.LongDateFormat,Ga=m.Ve.TimeSeparator.toString(),sa=m.Ve.TimeAltSeparator,bb=m.Ve.Hour2Digits,Ba=m.Ve.Use24HourClock,qa=m.Ve.AmPmSeparatedBySpace,pa=[m.Ve.AmString,m.Ve.PmString],ya=m.Ve.DayNameShortArray,za=m.Ve.DayNameLongArray,cb=m.Ve.MonthNameShortArray,
Pa=m.Ve.MonthNameLongArray,nb=m.Ve.PictureSpecialArray,Ma=b.a.map(("\x00"+m.Ve.PictureSingleString).split(""),Xa=>"\x00"===Xa?null:Xa),Oa=m.Ve.PictureColorArray,La=m.Ve.PictureDbnumArray,ra=m.Ve.RowLetter.toString(),V=m.Ve.ColumnLetter.toString(),ma=m.Ve.LeftBrace.toString(),W=m.Ve.RightBrace.toString(),aa=m.Ve.LeftBracket.toString(),ia=m.Ve.RightBracket.toString(),ka=w.V8h(m.Ve);return excelOnlineCalc.calc.localeData(n,z,y,A,ra,V,ma,W,aa,ia,F,D,B,M,R,P,E,H,G,N,I,O,U,ca,Q,Y,la,ea,ha,X,T,ua,Ha,Ca,
Ga,sa,bb,Ba,qa,pa,ya,za,cb,Pa,nb,Ma,Oa,La,ka,m.Ve.SysDateFormatString,m.Ve.SysTimeFormatString)}static DKe(m){const n=[];if(!m)return n;for(const z of m)m=null,z.IsDynamicUdf||(m=excelOnlineCalc.calc.worksheetFunctionName(z.FunctionIndexInServer,z.NameUI)),m&&n.push(m);return n}static U7b(){const m=[],n=Object.keys(d.a.errorNames);for(let z=0;z<n.length;z++){const y=excelOnlineCalc.calc.errorTypeName(z+1,n[z]);y&&m.push(y)}return m}static V8h(m){const n=Array(6);n[1]="#"+m.AllStructRefString;n[3]=
"#"+m.HeadersStructRefString;n[2]="#"+m.DataStructRefString;n[4]="#"+m.TotalsStructRefString;n[5]="#"+m.ThisRowStructRefString;return n}}Object(t.a)(w,"CalcHelper",null,[])},979:function(t,C,a){a.r(C);t=a(159);var c=a(0),b=a(14),f=a(6),e=a(92),d=a(29),h=a(140),r=a(273),l=a(40),u=a(86),v;(function(X){X[X.unableToRefreshLock=0]="unableToRefreshLock";X[X.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";X[X.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";X[X.workbookTooLarge=3]="workbookTooLarge";
X[X.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";X[X.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";X[X.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";X[X.unsupportedFeatures=7]="unsupportedFeatures";X[X.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";X[X.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";X[X.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";X[X.lastGenericStatusError=
11]="lastGenericStatusError";X[X.scratchPadWarning=12]="scratchPadWarning";X[X.authenticationLost=13]="authenticationLost";X[X.odfCompatibilityIssues=14]="odfCompatibilityIssues";X[X.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";X[X.workbookIsIrmProtected=16]="workbookIsIrmProtected";X[X.biFeatureNotAvailable=17]="biFeatureNotAvailable";X[X.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";X[X.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";
X[X.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";X[X.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";X[X.editAttemptInReadOnly=22]="editAttemptInReadOnly";X[X.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";X[X.unsupportedBrowser=24]="unsupportedBrowser";X[X.readOnlyPermissions=25]="readOnlyPermissions";X[X.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";X[X.policyWarningMessage=27]="policyWarningMessage";
X[X.workingOnIt=28]="workingOnIt";X[X.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";X[X.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";X[X.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";X[X.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";X[X.legacyConnectionsBB=33]="legacyConnectionsBB";X[X.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";X[X.groupedSlicersBB=35]="groupedSlicersBB";
X[X.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";X[X.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";X[X.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";X[X.wacGdprNotice=39]="wacGdprNotice";X[X.automaticSensitivityLabel=40]="automaticSensitivityLabel";X[X.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";X[X.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";X[X.localStorageDisabled=43]="localStorageDisabled";X[X.autoRefreshDisabled=
44]="autoRefreshDisabled";X[X.corruptedFileRepaired=45]="corruptedFileRepaired";X[X.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";X[X.minorVersionLimitReached=47]="minorVersionLimitReached";X[X.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";X[X.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";X[X.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";X[X.sensitivityApplicationLabelDisabledError=
51]="sensitivityApplicationLabelDisabledError";X[X.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";X[X.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";X[X.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";X[X.promptEnableExternalLinks=55]="promptEnableExternalLinks";X[X.networkDown=56]="networkDown";X[X.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";X[X.refreshLinkedEntityErrorBar=
58]="refreshLinkedEntityErrorBar";X[X.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";X[X.canvasHealth=60]="canvasHealth";X[X.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";X[X.optimizeWorkbook=62]="optimizeWorkbook";X[X.novModePostDepreciation=63]="novModePostDepreciation";X[X.officeScriptsRunning=64]="officeScriptsRunning";X[X.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";X[X.readOnlyPivotTable=
66]="readOnlyPivotTable";X[X.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";X[X.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";X[X.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";X[X.dataCleansingSuggestions=70]="dataCleansingSuggestions";X[X.count=71]="count"})(v||(v={}));Object(c.b)("EwaBusinessBarEntryType",v);var x=a(7),w=a(1085);class m extends Sys.EventArgs{constructor(X,T,ua=null){super();this.l1a=X;this.rad=T;this.data=ua}}Object(c.a)(m,
"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var n=a(1088),z=a(1086),y=a(1090);a(1089);var A=a(1083),F=a(482),D=a(53),B=a(39),M=a(665),R=a(32),P=a(1),E=a(23),H=a(21),G=a(63),N=a(74),I=a(935),O=a(33),U=a(42),ca=a(157),Q=a(41),Y=a(1087);a.d(C,"BusinessBarManager",function(){return ha});var la;const ea=[55,39,5,30,16,14,7,41,4,37];let ha=la=class extends u.a{constructor(X,T=!X.u_){super();this.Qa=new l.a;this.fQ=null;this.EMc=[];this.Kqc=()=>{this.$.pa.MNa?this.removeEntry(13):this.eh(13,
null)};this.xh=(ua,Ha)=>{for(let Ca=0,Ga=la.Wfc().length;Ca<Ga;Ca++)ua=la.Wfc()[Ca],this.removeEntry(ua);Ha.context&&0<Ha.context.communicationErrorRetryCount&&(b.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.Hsj()};this.Mm=(ua,Ha)=>{var Ca;ua=this.qLh(Ha.errors);let Ga=[];for(let bb=0,Ba=ua.length;bb<Ba;++bb){const qa=ua[bb];if(1===qa.Type&&
qa.Appearance&32)Ga=this.nfi(qa,Ga);else if(Ha.xCj){b.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var sa=(null===(Ca=Ha.context)||void 0===Ca?0:Ca.stopwatch)?Ha.context.stopwatch.Jc:-1;5E3>sa?b.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${sa}ms).`):f.AFrameworkApplication.rAi()||
this.rPg(qa,Ha.context.methodName)}sa=[...la.Wfc()];for(let pa=0,ya=Ga.length;pa<ya;++pa){const za=Ga[pa];this.eh(za,qa);Array.remove(sa,za)}for(let pa=0,ya=sa.length;pa<ya;++pa)this.removeEntry(sa[pa])}};this.dd=(ua,Ha)=>{this.Dc(ua,Ha)};this.Dc=()=>{const ua=this.$.ea;ua.jc||ua.Sf()||(this.mNd(),this.EMc.length=0)};this.yd=(ua,Ha)=>{this.$.ea.Sf()&&!Ha.hW||this.khf(Ha.hW)};this.NIb=()=>{const ua=this.$.userOperationManager.Ifc();ua&&ua.operation.flags&1&&this.Ecg()};this.sHf=()=>{this.Ecg()};this.Gf=
()=>{this.qEe();this.Mcg()};this.WN=()=>{if(this.$.q6&&this.$.ea.Sf()&&this.$.ea.jc)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const ua=this.$.da.Aa(331);ua&&ua.jLa||this.removeEntry(55);this.removeEntry(5)}};this.$=X;this.e0a=T;this.VXg();f.AFrameworkApplication.Od&&f.AFrameworkApplication.Od.oZc(this);this.pHa=Array(71);for(let ua=
0;71>ua;ua++)this.pHa[ua]=null;this.Hh=M.EcmaDateClock.instance;this.Prf=this.Hh.kc.getTime();T&&(T=X.pa,T.Tx(this.Mm),T.ur(this.xh),T.Mpb(this.Kqc),T.B_a(this.Kqc),X.ea.Zj(this.dd),X.ea.vu(this.Gf),X.rl(this.yd),X.wj(this.Dc),X.ea.u3(this.WN),X.userOperationManager.tr(this.NIb),P.EwaSettings.ya(158)&&X.ea.Lg.get(45)&&f.AFrameworkApplication.fa.ra("SupportsPolicies")||this.adf(),this.khf(G.c(X)));X.da.Ha(5,this);O.a.z9a()&&(this.$.MPb=this.kri())}adf(){R.a.Jq(this.$.ea.aG)&&this.Mm(this,new F.a(this.$.ea.aG,
null,!1,-1,-1,-1,-1,"",-1,"",-1))}WPg(X){this.Qa.addHandler("bBarAttachedOrDetached",X)}get ybd(){return this.EMc}get domElement(){return this.fQ?this.fQ.domElement:null}dispose(){if(this.$){const X=this.$,T=X.pa;T.Ny(this.Mm);T.Ms(this.xh);T.Fwc(this.Kqc);T.ALb(this.Kqc);X.ea.xk(this.dd);X.ea.$v(this.Gf);X.lm(this.yd);X.ll(this.Dc);X.ea.d8(this.WN);X.userOperationManager.ro(this.NIb);H.h(X).hc.sn(this.sHf)}e.a.Ja(this.fQ);this.$=this.fQ=null;super.dispose()}kri(){for(let X=0;X<ea.length;X++)if(this.pHa[ea[X]])return!0;
return!1}Ori(X){switch(X){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:return!0;default:return!1}}eh(X,T,ua=null,Ha=null,Ca=null){if(!this.$.isMobileMode||this.Ori(X))this.e0a&&!this.rH(X)&&(this.pHa[X]=this.Hh.Ufa,this.fQ.JE(X,T,Ha,Ca),O.a.z9a()&&this.B5j(X),this.Qa.raiseEvent("bBarAttachedOrDetached",new m(X,!0,ua))),T&&32===T.Appearance&&N.a(this.$).ud.yda(T)}jPj(X,T,ua,Ha){b.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");A.a.initialize(X,T,ua,Ha);
this.eh(39,null)}jOj(X,T,ua,Ha){w.a.initialize(X,T,ua,Ha);this.eh(40,null)}sQj(X,T,ua,Ha){z.a.initialize(X,T,ua,Ha);this.eh(41,null)}GOj(X,T,ua){Y.a.initialize(X,T,ua);this.eh(70,null)}JPj(X,T,ua,Ha){n.a.initialize(X,T,ua,Ha);this.eh(42,null)}yQj(X,T,ua,Ha){y.a.initialize(X,T,ua,Ha);this.eh(54,null)}removeEntry(X){this.e0a&&(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&b.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(v,X)}`),this.pHa[X]=null,
this.fQ.removeEntry(X)&&this.Qa.raiseEvent("bBarAttachedOrDetached",new m(X,!1)))}hma(X){return this.e0a?this.fQ.hma(X):!1}rH(X){return this.e0a?this.fQ.rH(X):!1}OGb(){b.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}Xpc(){b.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}VXg(){const {BusinessBarControl:X}=a(1192);if(this.e0a&&!this.fQ){H.h(this.$).hc.An(this.sHf);
var T=document.getElementById(this.$.Ib+x.a.rBe);this.fQ=new X(this.$,T)}}mNd(){this.e0a&&this.fQ.mNd()}B5j(X){0<=ea.indexOf(X)&&!this.$.MPb&&(this.$.MPb=!0,this.$.t4b=X,this.$.d0c&&this.G7f(!0))}Hsj(){if(P.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const T=this.Hh.Ufa;if(3E5<=T-this.Prf){this.Prf=T;for(let ua=0;71>ua;ua++){var X=this.pHa[ua];if(X&&(X=T-X,3E5<=X)){const Ha=Enum.toString(v,ua);b.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Ha}] was activated but not turned off for ${X} Millis`)}}}}}qLh(X){const T=
[];for(const ua of X)switch(ua.MessageId){case -113742550:const Ha=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||R.a.fh(X,Ha))&&T.push(-113742550)}return R.a.hA(X,T)}nfi(X,T){switch(X.MessageId){case 2113407564:const ua=R.a.h1a([1821390342,-943219229,-502303485,1437034227]);for(let Ha=0;Ha<ua.length;Ha++)ua[Ha].HelpTopicId=X.HelpTopicId,ua[Ha].HelpDescription=X.HelpDescription,this.EMc.push(ua[Ha])}switch(X.MessageId){case -395951567:this.eh(6,
X);break;case 1643490758:this.eh(4,X);break;case -907264831:this.eh(5,X);break;case 757111532:case 2113407564:this.eh(7,X);break;case 2010656511:this.eh(15,X);break;case 1321660996:this.$.W9c=!0;this.eh(8,X);break;case 526339737:this.$.W9c=!0;this.eh(9,X);break;case -407088521:this.eh(10,X);break;case 1756116017:this.eh(14,X);break;case -1703455218:this.eh(17,X);break;case 1393475740:this.eh(25,X);break;case -949523941:this.eh(26,X);break;case 1779381952:this.eh(44,X);break;case 1421575100:this.eh(45,
X);break;case 613676060:this.eh(46,X);break;case 1233668252:this.eh(61,X);break;case 1911608588:X=!!(this.$.Nd&64);!this.$.ea.Sf()&&X&&T.push(29);break;case 1544494907:break;case -655555355:T.push(this.Pvd()?1:0);break;case -1221382671:T.push(2);break;case 1662282929:T.push(3);break;case 104919273:this.$.ea.Sf()||T.push(30);break;case -689453604:X=!!(this.$.Nd&64);this.$.ea.mef=!0;!this.$.ea.Sf()&&X&&T.push(31);break;case 157762400:this.$.ea.Ekc=!0;!this.$.ea.Sf()&&this.$.Nd&64&&!this.$.isEditMode&&
T.push(32);break;case -1125398042:P.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.Sf()&&this.$.Nd&64&&!this.$.isEditMode&&T.push(34);break;case -73730134:!this.$.ea.Sf()&&this.$.Nd&64&&T.push(33);break;case -293349236:T.push(65);break;case 1580811823:T.push(67);break;case -37299333:break;case 136737622:T.push(47);break;case -1780327030:this.eh(55,X);break;case -113742550:this.eh(57,X);break;case -260312420:this.$.ea.Sf()||T.push(66);break;
default:this.eh(11,X)}return T}Mli(){if(f.AFrameworkApplication.fa.ra("WildFireExcelBizBar")&&!I.a.owi(I.a.x3e(1))&&(d.a.gq||d.a.Xg)){const X=D.GetServiceTaskFactory.create(this.$.da,155,this.$.ka,1);B.TaskExtensions.za(X,()=>{this.eh(20,null)},this.ka,3)}}dli(X){X||3!==this.$.workbookContext.WorkbookNovType||this.eh(63,null)}khf(X){(!X&&!this.$.printingEnabled||this.$.se.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(b.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),
this.eh(16,null));this.Mli();this.qEe();this.Mcg();this.dli(X)}qEe(){this.$.workbookContext.Options&32768&&this.ZOj()}ZOj(){this.pHa[37]||this.eh(37,null)}aRj(){this.pHa[38]||this.eh(38,null)}Mcg(){this.$.workbookContext.Options&524288&&this.eh(59,null)}kdg(X,T){this.eh(58,X,null,T)}Rre(X,T=null){this.fQ.rH(X)?this.fQ.ORb(X,T):this.eh(X,null,null,null,T)}Ecg(){this.$.Nd&8&&this.eh(12,null)}Pvd(){const X=this.$.da.Aa(38);return X?X.tokenExpired:!1}rPg(X,T){if(!this.rH(21)&&-1387426400!==X.MessageId){b.ULS.sendTraceTag(537170204,
0,50,"BusinessBar: raising the transient communication failures notification.");const ua={};ua.FailedMethod=T;this.eh(21,X,ua)}}static Wfc(){return la.rve||(la.rve=[0,1,2,3])}G7f(X){try{const Ha=h.a.get(x.a.QHd);if(E.a.Yg(Ha))b.ULS.sendTraceTag(509682970,0,50,"BusinessBarManager.setBusinessBarFlagInCookie: Can't find skeleton cookie eventough alreadyDefinedSkeletonCookie = true. Set page load skeleton cookie."),this.$.iUd();else{var T=U.a(decodeURIComponent(Ha)),ua=T.Options;T.Options=X?ua|4096:~(~ua|
4096);try{const Ca=U.c(T);h.a.Qs(x.a.QHd,Ca,r.AFrame.hP);b.ULS.sendTraceTag(509686989,0,50,"BusinessBarManager.setBusinessBarFlagInCookie: Business bar flag in PageLoadSkeletonState cookie has been raised");h.a.Qs(x.a.u4b,this.$.t4b.toString(),r.AFrame.hP)}catch(Ca){b.ULS.sendTraceTag(509686988,0,50,`BusinessBarManager.setBusinessBarFlagInCookie: Failed setting PageLoadSkeletonState cookie with error message: ${Ca.message}`)}}}catch(Ha){b.ULS.sendTraceTag(509686987,0,50,`BusinessBarManager.setBusinessBarFlagInCookie: exception while parsing PageLoadSkeletonCookie. Message: ${Ha.message}`)}}Chd(X){return this.fQ.Chd(X)}};
ha.rve=null;ha=la=Object(t.b)([Object(ca.d)(Q.f),Object(t.c)(0,Object(Q.u)())],ha);Object(c.a)(ha,"BusinessBarManager",u.a,[832,2,71])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.pi.js.map/47e506d595904de27813de443b12f038/EwaDSOpt.pi.js.map
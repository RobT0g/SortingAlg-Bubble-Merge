'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1062:function(t,C,a){a.r(C);a.d(C,"InsightsMenuItemFactory",function(){return e});t=a(0);var c=a(725),b=a(324),f=a(34);class e{constructor(d=null){this.zCg=d||CommonUIStrings.l_InsightsButtonText}get GSa(){return 10}tQ(d){var h=d.bA;d=c.a.zR()?c.a.nja(h,1):c.a.X8c(h);h=String.format(this.zCg,h);return this.jRh(d,h)}jRh(d,h){return b.a(e.sif,c.a.zR()?"1914896509":"3317204163",f.a.kf(h),c.a.Moi,null,f.a.kf(d),
f.a.kf(h),null,null)}}e.sif="bInsights";Object(t.a)(e,"InsightsMenuItemFactory",null,[204])},1063:function(t,C,a){a.d(C,"a",function(){return f});t=a(0);var c=a(324),b=a(34);class f{constructor(e,d,h,r,l){this.qZb=e;this.pZb=d;this.rJg=h;this.PBg=r;this.Dce=l}get GSa(){return 4}tQ(e,d=null){d=d.sessionId+"|"+d.VV+"|"+e.bA;if(this.Dce||this.PBg){let h=this.Dce||b.a.Gfa(CommonUIStrings.l_HelpTooltip)===b.a.Gfa(e.bA.trim());if(this.rJg&&2<e.bA.length){const r=e.bA;";"===r.charAt(0)&&";"===r.charAt(r.length-
1)&&r.substring(1,r.length-1)===f.nod&&(h=!0)}e=h?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,e.bA);return this.w2e(d,b.a.kf(e),h)}return this.w2e(d,b.a.kf(String.format(CommonUIStrings.l_TextWithQuotation,e.bA)),!1)}w2e(e,d,h){return c.a(f.nod,h?this.pZb:this.qZb,d,"OfficeAssistant_16x16x32","A0",b.a.kf(e),d,null,null)}}f.nod="bSearchHelp";Object(t.a)(f,"AssistanceMenuItemFactory",null,[204])},1064:function(t,C,a){a.d(C,"a",function(){return d});
t=a(0);var c=a(6),b=a(324),f=a(166),e=a(34);class d{get GSa(){return 13}tQ(){return d.x1g()}static x1g(){return b.b(d.Z_e,"798637440",e.a.kf(CommonUIStrings.l_LookupFirstRunExperienceTitle),c.AFrameworkApplication.rB,f.getImageClass("Info_32x32x32"),null,null,e.a.kf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,e.a.kf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}d.Z_e="bTellMeFirstRun";Object(t.a)(d,"FirstRunMenuItemFactory",null,[204])},1065:function(t,
C,a){a.d(C,"a",function(){return e});t=a(0);var c=a(6),b=a(324),f=a(34);class e{constructor(d=null,h=null){this.Jhe=d;this.ZEg=h||CommonUIStrings.l_LookupNoResultsDescription}get GSa(){return 14}tQ(d){d=String.format(this.ZEg,d.bA);return this.a2g(d)}a2g(d){return b.b(e.XAf,"798637440",f.a.kf(CommonUIStrings.l_LookupNoResultsTitle),this.Jhe?c.AFrameworkApplication.rB:null,this.Jhe,null,null,f.a.kf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,f.a.kf(d),null,null)}}e.XAf="lookupNoResults";
Object(t.a)(e,"NoCommandsFoundMenuItemFactory",null,[204])},1066:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,f){this.FontWeight=0;this.Text=null;this.FontWeight=b;this.Text=f}}Object(t.a)(c,"LabelFormatted",null,[])},1067:function(t,C,a){a.d(C,"a",function(){return h});t=a(0);a(730);var c=a(732),b=a(735),f=a(734),e=a(725),d=a(34);class h{constructor(r){this.Ta=r}Qw(){return"Assistance"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:this.Ta.PIb?3:2}Pu(r,l,u=!1,v,x=null){v=
new f.a(r);if((!x||Array.contains(x,8))&&!e.a.Nz(r)){x=new b.a(8);if(u){u=d.a.Gfa(CommonUIStrings.l_HelpTooltip)===d.a.Gfa(r.Rd.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,r.Rd);const w=[];this.Ta.Hya&&(this.Ta.AWd||w.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),u=this.g8e(r.Rd));const m="||"+r.Rd;w.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",u));w.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",
m));appChrome.api.dispatch(w);r=new c.a("GetHelpFromTellMe",4,r.Rd,null,1)}else r=new c.a("bSearchHelp",4,r.Rd,null,1);x.Xl(r);x.displayName=CommonUIStrings.l_HelpButtonTitle;v.Ml(x)}l.resultsUpdated(v)}mxa(r,l=null){const u=new b.a(8),v=d.a.Gfa(CommonUIStrings.l_HelpTooltip)===d.a.Gfa(r.Rd.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,r.Rd);for(let w=0;w<l.length&&2>w;w++){var x=void 0;x=[];let m="GetHelpWithDescriptionFromTellMe"+(w+1).toString(),
n=4;if(this.Ta.YOb)x.push(appChrome.actions.setControlLabel(m,v)),x.push(appChrome.actions.setCompoundButtonCommandValueId(m,r.Rd)),x.push(appChrome.actions.updateCompoundButtonDescription(m,this.H$h(l.length)));else if(this.Ta.ZOb){let z=this.Daf(l[w]);m="GetHelpFromTellMe"+(w+1).toString();this.Ta.Hya&&(z=this.g8e(z));n=9;x.push(appChrome.actions.setControlLabel(m,z));x.push(appChrome.actions.setButtonCommandValueId(m,this.F$h(l[w])))}appChrome.api.dispatch(x);x=new c.a(m,n,null,null,0);x.label=
this.Daf(l[w]);x.description=this.E$h(l[w]);u.Xl(x);if(this.Ta.ZOb)break}u.displayName=CommonUIStrings.l_HelpButtonTitle;return u}H$h(r){return 1===r?String.format(CommonUIStrings.l_SearchResultText,r):String.format(CommonUIStrings.l_SearchResultsText,r)}g8e(r){return this.Ta.Dvd?e.a.qjd(r,CommonUIStrings.l_HelpScopedButtonText):r+CommonUIStrings.l_HelpScopedButtonText}Daf(r){return r.name?r.name:""}E$h(r){return r.description?r.description:""}F$h(r){return r.id?"AssetID="+r.id:""}}Object(t.a)(h,
"AssistanceResultsProvider",null,[202])},1068:function(t,C,a){a.d(C,"a",function(){return r});t=a(0);a(730);var c=a(732),b=a(735),f=a(734),e=a(726),d=a(725),h=a(828);class r{constructor(l){this.Ta=l}Qw(){return"Image"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:3===this.Ta.zl?3:2}Pu(l,u,v,x,w=null){v=new f.a(l);(!w||Array.contains(w,19))&&d.a.Nz(l)&&this.Ta.Sy&&this.mxa(l,v,1);u.resultsUpdated(v)}mxa(l,u,v,x=null){var w=[];let m;e.TellMeActor.instance.ty()&&e.TellMeActor.instance.ty().Hya?(m=this.Ta.Dvd?
d.a.qjd(l.Rd,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):l.Rd+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.Ta.AWd||w.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):m=this.Ta.Sy?d.a.Nz(l)?this.Ta.Pta?d.a.swa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.Ta.Pta?d.a.swa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,l.Rd)):
String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,l.Rd):this.Ta.Ofb?CommonUIStrings.l_TellMeImageSuggestionButtonText:l.Rd+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.Ta.p_?(e.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",m)),w=d.a.nja(l.Rd,9,Object.assign(new h.a,{landingTab:"Image"})),e.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",w))):(w.push(appChrome.actions.setControlLabel("ImageForSearch",
m)),l=d.a.nja(l.Rd,9,Object.assign(new h.a,{landingTab:"Image"})),w.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",l)),appChrome.api.dispatch(w));v=new c.a("ImageForSearch",12,null,null,v);x&&(v.score=x.ConfidenceScore);x=new b.a(19,this.Ta.Ofb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);x.Xl(v);u.Ml(x)}}Object(t.a)(r,"ImageResultsProvider",null,[202])},1069:function(t,C,a){a.d(C,"a",function(){return h});t=a(0);a(730);var c=a(732),b=a(735),f=a(734),e=
a(725),d=a(6);class h{constructor(r){this.Ta=r}Qw(){return"Template"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:3}Pu(r,l){r=new f.a(r);l.resultsUpdated(r)}mxa(r,l,u){var v=[];let x;x=this.Ta.Sy?this.Ta.Pta?e.a.swa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,r.Rd)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,r.Rd):String.format(CommonUIStrings.l_TellMeTemplateButtonText,r.Rd);v.push(appChrome.actions.setControlLabel("TemplateForSearch",x));v.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(d.AFrameworkApplication.fa.Wa("TellMeTemplateProviderURL"),d.AFrameworkApplication.uiCulture,r.Rd)));appChrome.api.dispatch(v);r=new b.a(23);r.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;v=new c.a("TemplateForSearch",24,null,null,0);v.label=u[0].Title?u[0].Title:"";v.description=u[0].Description?u[0].Description:"";r.Xl(v);l.Ml(r)}}Object(t.a)(h,"TemplateResultsProvider",null,[202])},1070:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.aEc=
this.Aca=this.Fxa=this.fn=this.A4b=this.Yr=this.gWa=0}}Object(t.a)(c,"TRIESCAN",null,[])},1181:function(t,C,a){a.r(C);var c=a(0),b=a(730),f=a(796),e=a(752),d=a(732),h=a(735),r=a(734),l=a(726),u=a(725),v=a(828);class x{constructor(Ya){this.Ta=Ya}Qw(){return"ActionAI"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(Ya,Db,Wb=!1,Bc,Tc=null){Bc=new r.a(Ya);if(!Tc||Array.contains(Tc,24))if(this.RMj()||!u.a.Nz(Ya)){Tc=new h.a(24);var id=u.a.Nz(Ya);Wb&&(Wb=null,u.a.zR()&&(Wb=u.a.nja(id?"":Ya.Rd,1,Object.assign(new v.a,
{landingTab:"ActionAI"}))),this.Ta.p_?Wb&&l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Wb)):(Ya=[],Wb&&Ya.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Wb)),appChrome.api.dispatch(Ya)));Tc.Xl(new d.a("ActionAIFromTellMe",25,null,null,1));Bc.Ml(Tc)}Db.resultsUpdated(Bc)}RMj(){return u.a.zR()&&this.Ta.Zic}}Object(c.a)(x,"ActionAIResultsProvider",null,[202]);var w=a(973);class m{constructor(Ya,Db){this.Ewg=Ya;this.Bi=Db}resultsUpdated(Ya){this.Ewg.eHj(this.Bi,
Ya)}}Object(c.a)(m,"AggregatorResultsProviderCallback",null,[218]);class n{constructor(Ya){this.aY=null;this.Ta=Ya;this.Ta.eIa&&(this.aY=null)}Qw(){return"AppsForOffice"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(Ya,Db,Wb,Bc,Tc=null){Wb=new r.a(Ya);if(!Tc||Array.contains(Tc,1))Tc=new h.a(1),this.aY.zek(Tc,Ya.Rd),Wb.Ml(Tc);Db.resultsUpdated(Wb)}}Object(c.a)(n,"AppsForOfficeRecommendationResultsProvider",null,[202]);var z=a(1067),y=a(723),A=a(745),F=a(425);class D{constructor(Ya,Db){this.Ea=
Ya;this.LKi=Db}isMatch(Ya,Db){if(!Object(F.a)(290,Ya))throw Error.argument("objToTest","Expected feature bundle");let Wb;return({value:Wb}=Ya.fj(this.Ea.XY)).returnValue?this.Ea.Z3d.isMatch(Wb,Db):this.LKi}}Object(c.a)(D,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[486]);class B{constructor(Ya,Db){this.Ea=Ya;this.fAd=Db}isMatch(Ya){if(!Object(F.a)(290,Ya))throw Error.argument("objToTest","Expected feature bundle");return!!(this.fAd^Ya.fj(this.Ea.XY).returnValue)}}Object(c.a)(B,"AnnotatedWithAnnotationFilter",
null,[486]);class M{constructor(Ya){this.Ea=Ya}isMatch(Ya,Db){if(!Object(F.a)(293,Ya))throw Error.argument("objToTest","Expected struct value");return this.Ea.Z3d.isMatch(Ya.Fwa(this.Ea.fieldIndex),Db)}}Object(c.a)(M,"FieldValueMatchesStructFilter",null,[486]);class R{constructor(Ya,Db){Ya&&(this.fieldIndex=Ya.ma(0),this.Z3d=Db.AV(Ya.ma(1)))}}Object(c.a)(R,"FieldValueMatchesStructFilterInit",null,[]);class P{constructor(Ya){this.fAd=Ya}isMatch(Ya){if(!Object(F.a)(290,Ya))throw Error.argument("objToTest",
"Expected feature bundle");return!!(this.fAd^Ya.Cnd)}}Object(c.a)(P,"HasAnnotationsAnnotationFilter",null,[486]);class E{constructor(Ya,Db){this.Ea=Ya;this.TK=Db}isMatch(Ya,Db){if(!Object(F.a)(292,Ya))throw Error.argument("objToTest","Expected list value");switch(this.TK){case 0:for(const Wb of Ya.items)if(this.Ea.filter.isMatch(Wb,Db))return!0;return!1;case 1:for(const Wb of Ya.items)if(!this.Ea.filter.isMatch(Wb,Db))return!1;return!0;default:throw Error.notImplemented();}}}Object(c.a)(E,"ItemTestListFilter",
null,[486]);class H{constructor(Ya){this.Ea=Ya}isMatch(Ya,Db){if(!Object(F.a)(292,Ya))throw Error.argument("objToTest","Expected list value");return this.Ea.filter.isMatch(Ya.items.length,Db)}}Object(c.a)(H,"LengthMatchesListFilter",null,[486]);class G{constructor(Ya,Db){this.Ea=Ya;this.TK=Db}isMatch(Ya,Db,Wb=null){let Bc=0===this.TK;for(const Tc of this.Ea.NEe)if((Bc=Tc.isMatch(Ya,Db,Wb))?1===this.TK:0===this.TK)return Bc;2===this.TK&&(Bc=!Bc);return Bc}}Object(c.a)(G,"NonterminalFilter",null,[486]);
class N{constructor(Ya,Db){if(Ya){var Wb=Ya.ma(0);this.NEe=Array(Wb);for(let Bc=0;Bc<Wb;++Bc)this.NEe[Bc]=Db.AV(Ya.ma(1+Bc))}}}Object(c.a)(N,"NonterminalFilterInit",null,[]);class I{constructor(Ya,Db){this.Ea=Ya;this.TK=Db}isMatch(Ya,Db){if("number"!==typeof Ya)throw Error.argument("objToTest","Expected number value");let Wb=this.Ea.number;if(this.Ea.query){Db=this.Ea.query.Jk(null,Db);if("number"!==typeof Db)throw Error.invalidOperation("Query did not return number");Wb+=Db}switch(this.TK){case 0:return Ya===
Wb;case 1:return Ya<Wb;case 2:return Ya<=Wb;case 3:return Ya>Wb;case 4:return Ya>=Wb;default:throw Error.notImplemented();}}}Object(c.a)(I,"NumberFilter",null,[486]);class O{constructor(Ya,Db){Ya&&(this.number=Ya.ma(0),this.query=Ya.ma(1)?Db.Kv(Ya.ma(1)):null)}}Object(c.a)(O,"NumberFilterInit",null,[]);class U{constructor(Ya,Db,Wb){this.tec=this.BZh;this.XKi=Ya;this.Nwf=Db;this.Mwf=Wb}m4c(Ya){this.Nwf=Ya}BZh(Ya){if(!Ya)throw Error.argument("name","Invalid named feature bundle reference");const Db=
Ya.substr(1);return 1===Ya.charCodeAt(0)&&Db===this.XKi?this.Nwf:this.Mwf?this.Mwf.tec(Ya):null}}Object(c.a)(U,"SimpleNamedFeatureBundleResolver",null,[505]);class ca{constructor(Ya){this.Ea=Ya}isMatch(Ya,Db){if(!Object(F.a)(290,Ya))throw Error.argument("objToTest","Expected feature bundle");Ya=this.Ea.query.Jk(null,new U(this.Ea.sHc,Ya,Db));if("boolean"!==typeof Ya)throw Error.invalidOperation("Query did not return bool");return Ya}}Object(c.a)(ca,"PredicateAnnotationFilter",null,[486]);class Q{constructor(Ya,
Db){Ya&&(this.sHc=Db.ha(Ya.ma(0)),this.query=Db.Kv(Ya.ma(1)))}}Object(c.a)(Q,"PredicateAnnotationFilterInit",null,[]);class Y{constructor(Ya){this.Ea=Ya}isMatch(Ya,Db){if("boolean"!==typeof Ya)throw Error.argument("objToTest","Expected bool value");Db=this.Ea.query.Jk(null,Db);if("boolean"!==typeof Db)throw Error.invalidOperation("Query did not return bool");return Ya===Db}}Object(c.a)(Y,"QueryBooleanFilter",null,[486]);class la{constructor(Ya,Db){this.Ea=Ya;this.TK=Db}isMatch(Ya,Db){if("number"!==
typeof Ya)throw Error.argument("objToTest","Expected integer");Db=this.Ea.query.Jk(null,Db);if("number"!==typeof Db)throw Error.invalidOperation("Query did not return an enum value");switch(this.TK){case 0:return Ya===Db;case 1:return 0!==(Ya&Db);case 2:return Ya===(Ya&Db);case 3:return Db===(Ya&Db);default:throw Error.notImplemented();}}}Object(c.a)(la,"QueryEnumFilter",null,[486]);class ea{constructor(Ya,Db){Ya&&(this.Pkc=1===Ya.ma(0),this.query=Db.Kv(Ya.ma(1)))}}Object(c.a)(ea,"QueryEnumFilterInit",
null,[]);class ha{constructor(Ya,Db){this.Ea=Ya;this.TK=Db}isMatch(Ya,Db){if(!Object(F.a)(292,Ya))throw Error.argument("objToTest","Expected list value");Db=this.Ea.query.Jk(null,Db);if(!Object(F.a)(292,Db))throw Error.invalidOperation("Query did not return list value");if(Ya.tI!==Db.tI)return!1;switch(this.TK){case 0:return y.Annotations.JDa(y.Annotations.j2h(Ya.tI),Ya,Db);case 1:for(const Wb of Ya.items)for(const Bc of Db.items)if(y.Annotations.JDa(Ya.tI,Wb,Bc))return!0;return!1;case 2:for(const Wb of Ya.items)for(const Bc of Db.items)if(!y.Annotations.JDa(Ya.tI,
Wb,Bc))return!1;return!0;case 3:for(const Wb of Db.items)for(const Bc of Ya.items)if(!y.Annotations.JDa(Ya.tI,Wb,Bc))return!1;return!0;default:throw Error.notImplemented();}}}Object(c.a)(ha,"QueryListFilter",null,[486]);class X{constructor(Ya,Db){this.Ea=Ya;this.TK=Db}isMatch(Ya,Db){if("string"!==typeof Ya)throw Error.argument("objToTest","Expected string");Db=this.Ea.query.Jk(null,Db);if("string"!==typeof Db)throw Error.invalidOperation("Query did not return string");this.Ea.Mrd&&(Ya=Ya.toUpperCase(),
Db=Db.toUpperCase());switch(this.TK){case 0:return Ya===Db;case 1:return 0<=Ya.indexOf(Db);case 2:return Ya.startsWith(Db);case 3:return Ya.endsWith(Db);case 4:return 0<=Db.indexOf(Ya);case 5:return Db.startsWith(Ya);case 6:return Db.endsWith(Ya);default:throw Error.notImplemented();}}}Object(c.a)(X,"QueryStringFilter",null,[486]);class T{constructor(Ya,Db){Ya&&(this.query=Db.Kv(Ya.ma(0)),this.Mrd=1===Ya.ma(1))}}Object(c.a)(T,"QueryStringFilterInit",null,[]);class ua{constructor(Ya){this.Ea=Ya}isMatch(Ya,
Db){if(!Object(F.a)(293,Ya))throw Error.argument("objToTest","Expected struct value");Db=this.Ea.query.Jk(null,Db);if(!Object(F.a)(293,Db))throw Error.invalidOperation("Query did not return struct value");return Ya.isEqual(Ya)}}Object(c.a)(ua,"QueryStructFilter",null,[486]);class Ha{constructor(Ya){this.Ea=Ya}isMatch(Ya,Db){Ya=this.Ea.query.Jk(null,Db);if("boolean"!==typeof Ya)throw Error.invalidOperation("Query did not return bool");return Ya}}Object(c.a)(Ha,"QueryWhereConstraintFilter",null,[486]);
class Ca{constructor(Ya){this.Ea=Ya}isMatch(Ya){if("string"!==typeof Ya)throw Error.argument("objToTest","Expected string");return this.Ea.IMd.test(Ya)}}Object(c.a)(Ca,"RegexStringFilter",null,[486]);class Ga{constructor(Ya,Db){Ya&&(this.IMd=Db.w9e(Ya.ma(0)))}}Object(c.a)(Ga,"RegexStringFilterInit",null,[]);class sa{constructor(Ya,Db){Ya&&(this.filter=Db.AV(Ya.ma(0)))}}Object(c.a)(sa,"SingleFilterFilterInit",null,[]);class bb{constructor(Ya,Db){Ya&&(this.query=Db.Kv(Ya.ma(0)))}}Object(c.a)(bb,"SingleQueryFilterInit",
null,[]);class Ba{constructor(Ya){this.Ea=Ya}isMatch(Ya){if("boolean"!==typeof Ya)throw Error.argument("objToTest","Expected bool value");return Ya===this.Ea.value}}Object(c.a)(Ba,"StoredValueBooleanFilter",null,[486]);class qa{constructor(Ya){Ya&&(this.value=1===Ya.ma(0))}}Object(c.a)(qa,"StoredValueBooleanFilterInit",null,[]);class pa{constructor(Ya,Db){this.Ea=Ya;this.TK=Db}isMatch(Ya){if("number"!==typeof Ya)throw Error.argument("objToTest","Expected integer");switch(this.TK){case 0:return this.Ea.Pkc?
this.Ea.value?!!(Ya&this.Ea.value):!Ya:Ya===this.Ea.value;case 1:return this.Ea.Pkc?(Ya&this.Ea.value)===this.Ea.value:32>Ya&&(1<<Ya&this.Ea.value)===this.Ea.value;case 2:return this.Ea.Pkc?!!(Ya&this.Ea.value):32>Ya&&!!(1<<Ya&this.Ea.value);default:throw Error.notImplemented();}}}Object(c.a)(pa,"StoredValueEnumFilter",null,[486]);class ya{constructor(Ya){Ya&&(this.Pkc=1===Ya.ma(0),this.value=Ya.ma(1))}}Object(c.a)(ya,"StoredValueEnumFilterInit",null,[]);class za{constructor(){this.o9i=null;this.c3c=
this.kNa=0}}Object(c.a)(za,"WHEREConstraintData",null,[]);class cb{constructor(Ya){this.Ea=Ya}isMatch(Ya,Db){if(!Object(F.a)(za,Ya))throw Error.argument("objToTest","Expected WHERE constraint data");let Wb=-1,Bc=-1;const Tc=Ya.o9i;switch(this.Ea.R3c){case 4:Wb=Tc.Wwb;Bc=Tc.mYd;break;case 5:Wb=Ya.kNa;Bc=Tc.Wwb-Ya.kNa;break;case 6:Wb=Tc.Wwb+Tc.mYd;Bc=Ya.kNa+Ya.c3c-Wb;break;case 1:case 2:case 3:let id=!1;for(let k=Tc.Jek;k;k=k.next)if(this.Ea.S9j===k.name){id=!0;1===this.Ea.R3c?(Wb=k.Wwb,Bc=k.mYd):2===
this.Ea.R3c?(Wb=Ya.kNa,Bc=k.Wwb-Ya.kNa):(Wb=k.Wwb+k.mYd,Bc=Ya.kNa+Ya.c3c-Wb);break}if(!id)return!1;break;case 7:Wb=Ya.kNa;Bc=Ya.c3c;break;default:throw Error.notImplemented();}return null!==this.Ea.pTj.$ek(Tc.Mfk,Wb,Bc,Wb,!0,2,Db)}}Object(c.a)(cb,"SubSreWhereConstraintFilter",null,[486]);class Pa{constructor(Ya,Db){if(Ya){var Wb=Db.ha(Ya.ma(0));this.R3c=Wb.charCodeAt(0);this.S9j=Wb.substr(1);this.pTj=Db.x7h(Ya.ma(1))}}}Object(c.a)(Pa,"SubSreWhereConstraintFilterInit",null,[]);class nb{constructor(Ya){this.Ea=
Ya}isMatch(Ya,Db,Wb=null){if(!Object(F.a)(290,Ya))throw Error.argument("objToTest","Expected feature bundle");if(null==Wb)throw Error.argumentNull("parentTextForSpan");if(this.Ea.$ve&&!this.Ea.$ve.isMatch(Ya,Db))return!1;if(this.Ea.D_d){let Bc;if(({value:Bc}=Ya.fj(this.Ea.USj)).returnValue){if(!this.Ea.D_d.isMatch(Bc,Db))return!1}else{let Tc,id;if(!({value:Tc}=Ya.fj(this.Ea.Aeg)).returnValue||!({value:id}=Ya.fj(this.Ea.zeg)).returnValue||0>Tc||0>id||Tc+id>Wb.length||!this.Ea.D_d.isMatch(Wb.substr(Tc,
id),Db))return!1}}if(this.Ea.Veg){let Bc;if(!({value:Bc}=Ya.fj(this.Ea.Aeg)).returnValue||!this.Ea.Veg.isMatch(Bc,Db))return!1}if(this.Ea.ktf){let Bc;if(!({value:Bc}=Ya.fj(this.Ea.zeg)).returnValue||!this.Ea.ktf.isMatch(Bc,Db))return!1}return!0}}Object(c.a)(nb,"TextSpanFilter",null,[486]);class Ma{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.Aeg=Ya.ma(0),this.zeg=Ya.ma(1),this.USj=Ya.ma(2),this.D_d=Ya.ma(3)?Db.AV(Ya.ma(3)):null,this.$ve=Ya.ma(4)?Db.AV(Ya.ma(4)):null,this.Veg=Ya.ma(5)?
Db.AV(Ya.ma(5)):null,this.ktf=Ya.ma(6)?Db.AV(Ya.ma(6)):null)}}Object(c.a)(Ma,"TextSpanFilterInit",null,[]);class Oa{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.XY=Ya.ma(0),this.Z3d=Ya.ma(1)?Db.AV(Ya.ma(1)):null)}}Object(c.a)(Oa,"ValueFilterAnnotationFilterInit",null,[]);var La=a(758);class ra{AV(Ya,Db){const Wb=Ya.ma(0),Bc=new La.a;Bc.jwa(Ya,1,Ya.count-1);switch(Wb){case 1:return new G(new N(Bc,Db),0);case 2:return new G(new N(Bc,Db),1);case 3:return new G(new N(Bc,Db),2);case 101:return new Ca(new Ga(Bc,
Db));case 103:return new X(new T(Bc,Db),0);case 104:return new X(new T(Bc,Db),1);case 105:return new X(new T(Bc,Db),2);case 106:return new X(new T(Bc,Db),3);case 107:return new X(new T(Bc,Db),4);case 108:return new X(new T(Bc,Db),5);case 109:return new X(new T(Bc,Db),6);case 201:return new Ba(new qa(Bc));case 202:return new Y(new bb(Bc,Db));case 301:return new I(new O(Bc,Db),0);case 302:return new I(new O(Bc,Db),1);case 303:return new I(new O(Bc,Db),2);case 304:return new I(new O(Bc,Db),3);case 305:return new I(new O(Bc,
Db),4);case 401:return new pa(new ya(Bc),0);case 402:return new pa(new ya(Bc),1);case 403:return new pa(new ya(Bc),2);case 404:return new la(new ea(Bc,Db),0);case 405:return new la(new ea(Bc,Db),1);case 406:return new la(new ea(Bc,Db),2);case 407:return new la(new ea(Bc,Db),3);case 501:return new M(new R(Bc,Db));case 502:return new ua(new bb(Bc,Db));case 601:return new E(new sa(Bc,Db),0);case 602:return new E(new sa(Bc,Db),1);case 603:return new H(new sa(Bc,Db));case 604:return new ha(new bb(Bc,Db),
0);case 605:return new ha(new bb(Bc,Db),1);case 606:return new ha(new bb(Bc,Db),2);case 607:return new ha(new bb(Bc,Db),3);case 701:return new P(!1);case 702:return new P(!0);case 703:return new B(new Oa(Bc,Db),!1);case 704:return new B(new Oa(Bc,Db),!0);case 705:return new D(new Oa(Bc,Db),!1);case 706:return new D(new Oa(Bc,Db),!0);case 707:return new ca(new Q(Bc,Db));case 901:return new nb(new Ma(Bc,Db));case 1002:return new Ha(new bb(Bc,Db));case 1001:return new cb(new Pa(Bc,Db));default:throw Error.argument("initData");
}}}Object(c.a)(ra,"FilterFactory",null,[289]);var V=a(727);class ma{constructor(Ya){this.Ea=Ya}get Wq(){return this.Ea.Wq}get NI(){return this.Ea.NI}get JDc(){return this.Ea.JDc}get Bjc(){return this.Ea.Bjc}load(Ya,Db){return this.Jk(Ya,Ya?new U("root",Ya,Db):Db)}store(Ya,Db,Wb){this.Cgb(Ya,Db,Ya?new U("root",Ya,Wb):Wb,null)}Jk(Ya,Db){if(!this.Bjc&&!this.Ea.annotations.H8a(this.Wq,Ya))throw Error.argument("input","Input value not of expected type");let Wb=this.Ea.c0e;for(;Wb;)Ya=Wb.load(Ya,Db),Wb=
Wb.next;return Ya}Cgb(Ya,Db,Wb,Bc){if(!this.JDc)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.Bjc&&!this.Ea.annotations.H8a(this.Wq,Ya))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ea.annotations.H8a(this.NI,Db))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ea.c0e.store(Ya,Db,Wb,Bc)}static GGe(Ya,Db,Wb,Bc){if(Wb===Bc)return Db;if(y.Annotations.ju(Wb)&&y.Annotations.ju(Bc)){Wb=y.Annotations.ala(Wb);
Bc=y.Annotations.ala(Bc);const Tc=new V.a(Ya,Bc);for(const id of Db.items)Array.add(Tc.items,ma.GGe(Ya,id,Wb,Bc));return Tc}if(Wb===y.Annotations.f9){if(Bc===y.Annotations.OX)return Db;if(Bc===y.Annotations.KL)return Db.toString()}else if(Wb===y.Annotations.OX){if(Bc===y.Annotations.f9)return Math.floor(Db);if(Bc===y.Annotations.KL)return Db.toString()}else if(Wb===y.Annotations.KL){if(Bc===y.Annotations.f9)return parseInt(Db);if(Bc===y.Annotations.OX)return parseFloat(Db)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(c.a)(ma,"AnnotationQuery",null,[493]);class W{constructor(){this.NI=this.Wq=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}bla(Ya){if(this.next)return{returnValue:this.next,T8:Ya};if(Ya){const Db=Ya.HIe;Ya=Ya.oSf;return{returnValue:Db,T8:Ya}}return{returnValue:null,T8:Ya}}}Object(c.a)(W,"AnnotationQueryStep",null,[533]);class aa extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){Db=this.Ea.query.Jk(Ya,Db);if(y.Annotations.ju(this.Wq)){var Wb=y.Annotations.ala(this.Wq);
let Tc=new V.a(this.Ea.annotations,Wb);if(y.Annotations.ju(this.Ea.query.NI)){if(Ya.items.length!==Db.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let id=0,k=Ya.items.length;id<k;++id)Array.add(Tc.items,this.O4b(Ya.items[id],Db.items[id],Wb===y.Annotations.OX))}else for(var Bc of Ya.items)Array.add(Tc.items,this.O4b(Bc,Db,Wb===y.Annotations.OX));return Tc}if(y.Annotations.ju(this.Ea.query.NI)){Bc=new V.a(this.Ea.annotations,this.Wq);for(Wb of Db.items)Array.add(Bc.items,
this.O4b(Ya,Wb,this.Wq===y.Annotations.OX));return Bc}return this.O4b(Ya,Db,this.Wq===y.Annotations.OX)}O4b(Ya,Db,Wb){Ya=this.y1a(Ya,Db);return Wb?Ya:Math.floor(Ya)}}Object(c.a)(aa,"NumericAnnotationQueryStep",W,[]);class ia extends aa{constructor(Ya){super(Ya)}y1a(Ya,Db){return Ya+Db}}Object(c.a)(ia,"AddAnnotationQueryStep",aa,[]);class ka extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){if(this.Wq===y.Annotations.K1&&this.Ea.query.NI===y.Annotations.K1){let Tc;if(({result:Tc}=this.LCe(Ya)).returnValue)return Tc}if(y.Annotations.ju(this.Wq)){var Wb=
new V.a(this.Ea.annotations,y.Annotations.K1);Db=this.Ea.query.Jk(Ya,Db);if(y.Annotations.ju(this.Ea.query.NI)){if(Ya.items.length!==Db.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Tc=0,id=Ya.items.length;Tc<id;++Tc)Array.add(Wb.items,this.ytb(Db.items[Tc],Ya.items[Tc]))}else for(var Bc of Ya.items)Array.add(Wb.items,this.ytb(Db,Bc));return Wb}Bc=this.Ea.query.Jk(Ya,Db);if(y.Annotations.ju(this.Ea.query.NI)){Db=new V.a(this.Ea.annotations,
y.Annotations.K1);for(Wb of Bc.items)Array.add(Db.items,this.ytb(Wb,Ya));return Db}return this.ytb(Bc,Ya)}}Object(c.a)(ka,"BinaryBooleanAnnotationQueryStep",W,[]);class Xa extends ka{constructor(Ya){super(Ya)}LCe(Ya){return{returnValue:!Ya,result:!1}}ytb(Ya,Db){return Ya&&Db}}Object(c.a)(Xa,"AndAnnotationQueryStep",ka,[]);class sb{constructor(Ya){Ya&&(this.annotations=Ya)}}Object(c.a)(sb,"AnnotationsOnlyQueryStepInit",null,[]);class ib extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){Db=this.Ea.query.Jk(Ya,
Db);Ya=Ya.clone();y.Annotations.ju(this.Ea.query.NI)?Array.addRange(Ya.items,Db.items):Array.add(Ya.items,Db);return Ya}}Object(c.a)(ib,"AppendAnnotationQueryStep",W,[]);class Ub extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){if(this.Wq===y.Annotations.dC)return this.executeScript(Ya,Db);const Wb=new V.a(this.Ea.annotations,y.Annotations.dC);for(const Bc of Ya.items)Array.add(Wb.items,this.executeScript(Bc,Db));return Wb}executeScript(Ya,Db){const Wb=new A.a(this.Ea.annotations);Wb.ija(Ya);
Ya=new A.a(this.Ea.annotations);this.Ea.script.Lba(null,new U("Input",Wb,new U("Output",Ya,Db)));return Ya}}Object(c.a)(Ub,"ApplyAnnotationQueryStep",W,[]);class hc extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){if(this.Wq===y.Annotations.dC)return Db=this.executeScript(Ya,Db),Db.fj(this.Ea.Xve).returnValue||new V.a(this.Ea.annotations,y.Annotations.dC),Db;const Wb=new V.a(this.Ea.annotations,y.Annotations.dC);for(const Bc of Ya.items)if(Ya=this.executeScript(Bc,Db),({value:Ya}=Ya.fj(this.Ea.Xve)).returnValue)for(const Tc of Ya.items)Array.add(Wb.items,
Tc);return Wb}executeScript(Ya,Db){const Wb=new A.a(this.Ea.annotations);Wb.ija(Ya);Ya=new A.a(this.Ea.annotations);this.Ea.script.Lba(null,new U("Input",Wb,new U("Output",Ya,Db)));return Ya}}Object(c.a)(hc,"ApplyExpandAnnotationQueryStep",W,[]);class yb{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.script=Db.QLa(Ya.ma(0)),this.Xve=Ya.ma(1))}}Object(c.a)(yb,"ApplyExpandQueryStepInit",null,[]);class Gb{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.script=Db.QLa(Ya.ma(0)))}}
Object(c.a)(Gb,"ApplyQueryStepInit",null,[]);class Sa extends W{constructor(Ya){super();this.Ea=Ya}load(Ya){if(this.Wq===y.Annotations.dC)return this.Pnc(Ya);const Db=new V.a(this.Ea.annotations,this.Ea.annotations.getAttributeType(this.Ea.XY));for(const Wb of Ya.items)Array.add(Db.items,this.Pnc(Wb));return Db}store(Ya,Db,Wb,Bc){if(this.Wq===y.Annotations.dC){var Tc=Db,id=({T8:Bc}=this.bla(Bc)).returnValue;id&&(Tc=id.store(y.Annotations.ZA(this.Pnc(Ya)),Db,Wb,Bc));Ya.Xn(this.Ea.XY,Tc)}else{var k=
Db;if(Tc=({T8:Bc}=this.bla(Bc)).returnValue){k=new V.a(this.Ea.annotations,this.Ea.annotations.getAttributeType(this.Ea.XY));for(id of Ya.items)Array.add(k.items,this.Pnc(id));k=Tc.store(k,Db,Wb,Bc)}Db=k;if(Db.items.length!==Ya.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Ob=0,kc=Ya.items.length;Ob<kc;++Ob)Wb=Ya.items[Ob],Wb.isReadOnly&&(Wb=Wb.clone(),Ya.items[Ob]=Wb),Wb.Xn(this.Ea.XY,Db.items[Ob])}return Ya}Pnc(Ya){({value:Ya}=Ya.fj(this.Ea.XY)).returnValue||
(Ya=this.Ea.annotations.XTh(this.Ea.XY));return Ya}}Object(c.a)(Sa,"AttrAnnotationQueryStep",W,[]);class db{constructor(Ya,Db){Ya&&(this.annotations=Db,this.XY=Ya.ma(0))}}Object(c.a)(db,"AttrQueryStepInit",null,[]);class fb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya){const Db=new A.a(this.Ea.annotations);Db.ija(Ya);return this.Ea.module.execute(Db)}}Object(c.a)(fb,"CallModuleAnnotationQueryStep",W,[]);class ab{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.module=Db.hkd(Ya.ma(0)))}}
Object(c.a)(ab,"CallModuleQueryStepInit",null,[]);class wb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){if(y.Annotations.ju(this.Wq)){var Wb=this.Ea.query.Jk(Ya,Db);Db=new V.a(this.Ea.annotations,y.Annotations.KL);let id="string"===typeof Wb;for(var Bc of Ya.items)if(id)Array.add(Db.items,Bc+Wb);else for(var Tc of Wb.items)Array.add(Db.items,Bc+Tc);return Db}Bc=this.Ea.query.Jk(Ya,Db);if("string"===typeof Bc)return Ya+Bc;Tc=new V.a(this.Ea.annotations,y.Annotations.KL);for(Wb of Bc.items)Array.add(Tc.items,
Ya+Wb);return Tc}}Object(c.a)(wb,"ConcatAnnotationQueryStep",W,[]);class kb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya){return ma.GGe(this.Ea.annotations,Ya,this.Wq,this.NI)}}Object(c.a)(kb,"ConvertAnnotationQueryStep",W,[]);class tb extends W{constructor(){super()}load(Ya){return Ya.items.length}}Object(c.a)(tb,"CountAnnotationQueryStep",W,[]);class hb extends aa{constructor(Ya){super(Ya)}y1a(Ya,Db){return Ya/Db}}Object(c.a)(hb,"DivideAnnotationQueryStep",aa,[]);class Fb extends W{constructor(Ya){super();
this.Ea=Ya}load(Ya,Db){Db=new U(this.Ea.sHc,null,Db);for(const Wb of Ya.items)if(Db.m4c(Wb),this.Ea.query.Jk(Wb,Db))return!0;return!1}}Object(c.a)(Fb,"ExistsAnnotationQueryStep",W,[]);class va extends aa{constructor(Ya){super(Ya)}y1a(Ya,Db){return Math.pow(Ya,Db)}}Object(c.a)(va,"ExpAnnotationQueryStep",aa,[]);class jb{constructor(Ya,Db){Ya&&(this.Pba=Db.ha(Ya.ma(0)))}}Object(c.a)(jb,"FeatureBundleNameQueryStepInit",null,[]);class Ab extends W{constructor(Ya){super();this.Ea=Ya}load(Ya){if(y.Annotations.ju(this.Wq)){const Db=
new V.a(this.Ea.annotations,this.Ea.annotations.DMa(y.Annotations.ala(this.Wq),this.Ea.fieldIndex));for(const Wb of Ya.items)Array.add(Db.items,Wb.Fwa(this.Ea.fieldIndex));return Db}return Ya.Fwa(this.Ea.fieldIndex)}store(Ya,Db,Wb,Bc){if(y.Annotations.ju(this.Wq)){var Tc=Db,id=({T8:Bc}=this.bla(Bc)).returnValue;if(id){Tc=new V.a(this.Ea.annotations,this.Ea.annotations.DMa(y.Annotations.ala(this.Wq),this.Ea.fieldIndex));for(var k of Ya.items)Array.add(Tc.items,k.Fwa(this.Ea.fieldIndex));Tc=id.store(Tc,
Db,Wb,Bc)}Db=Tc;if(Db.items.length!==Ya.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let Ob=0,kc=Ya.items.length;Ob<kc;++Ob)Wb=Ya.items[Ob],Wb.isReadOnly&&(Wb=Wb.clone(),Ya.items[Ob]=Wb),Wb.ITd(this.Ea.fieldIndex,Db.items[Ob])}else id=Db,(k=({T8:Bc}=this.bla(Bc)).returnValue)&&(id=k.store(y.Annotations.ZA(Ya.Fwa(this.Ea.fieldIndex)),Db,Wb,Bc)),Ya.ITd(this.Ea.fieldIndex,id);return Ya}}Object(c.a)(Ab,"FieldAnnotationQueryStep",W,[]);class Qa{constructor(Ya,
Db){Ya&&(this.annotations=Db,this.fieldIndex=Ya.ma(0))}}Object(c.a)(Qa,"FieldQueryStepInit",null,[]);class Z extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){for(const Wb of Ya.items)if(this.Ea.filter.isMatch(Wb,Db))return Wb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Ya,Db,Wb,Bc){let Tc=Db,id=-1;for(let Ob=0,kc=Ya.items.length;Ob<kc;Ob++)if(this.Ea.filter.isMatch(Ya.items[Ob],Wb)){id=Ob;break}if(0>id)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");
const k=({T8:Bc}=this.bla(Bc)).returnValue;k&&(Tc=k.store(y.Annotations.ZA(Ya.items[id]),Db,Wb,Bc));Ya.items[id]=Tc;return Ya}}Object(c.a)(Z,"FirstItemMatchingAnnotationQueryStep",W,[]);class wa extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){Db=new U(this.Ea.sHc,null,Db);for(const Wb of Ya.items)if(Db.m4c(Wb),!this.Ea.query.Jk(Wb,Db))return!1;return!0}}Object(c.a)(wa,"ForAllAnnotationQueryStep",W,[]);class Ea extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){Ya=Db?Db.tec(this.Ea.Pba):
null;if(!Ya)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ea.Pba+'"');return Ya}store(Ya,Db,Wb,Bc){Ya=Wb?Wb.tec(this.Ea.Pba):null;if(!Ya)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ea.Pba+'"');let Tc=Db;const id=({T8:Bc}=this.bla(Bc)).returnValue;id&&(Tc=id.store(Ya,Db,Wb,Bc));Ya!==Tc&&Ya.ija(Tc);return Ya}}Object(c.a)(Ea,"GetAnnotationQueryStep",W,[]);class fa{constructor(Ya,Db){this.Yyg=Ya;this.lGg=Db}get HIe(){return this.Yyg}get oSf(){return this.lGg}}
Object(c.a)(fa,"AnnotationQueryStoreContinuation",null,[624]);class Ua extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){return this.Ea.uEc.Jk(Ya,Db)?this.Ea.hkg.Jk(Ya,Db):this.Ea.Obc?this.Ea.Obc.Jk(Ya,Db):Ya}store(Ya,Db,Wb,Bc){var Tc=this.Ea.uEc.Jk(Ya,Wb);this.next&&(Bc=new fa(this.next,Bc));if(Tc)return this.Ea.hkg.Cgb(Ya,Db,Wb,Bc);if(this.Ea.Obc)return this.Ea.Obc.Cgb(Ya,Db,Wb,Bc);Tc=Db;let id=null;Bc&&(id=Bc.HIe,Bc=Bc.oSf);id&&(Tc=id.store(y.Annotations.ZA(Ya),Db,Wb,Bc));return Tc}}Object(c.a)(Ua,
"IfAnnotationQueryStep",W,[]);class Aa{constructor(Ya,Db){Ya&&(this.uEc=Db.Kv(Ya.ma(0)),this.hkg=Db.Kv(Ya.ma(1)),this.Obc=Ya.ma(2)?Db.Kv(Ya.ma(2)):null)}}Object(c.a)(Aa,"IfQueryStepInit",null,[]);class Ib{constructor(Ya,Db){Ya&&(this.oki=Db.Kv(Ya.ma(0)),this.$qf=Db.Kv(Ya.ma(1)))}}Object(c.a)(Ib,"IndexAndItemQueryStepInit",null,[]);class Pb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){const Wb=this.Ea.oki.Jk(Ya,Db);Db=this.Ea.$qf.Jk(Ya,Db);Ya=Ya.clone();if(0>Wb||Wb>Ya.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");
if(y.Annotations.ju(this.Ea.$qf.NI))for(let Bc=0;Bc<Db.items.length;++Bc)Array.insert(Ya.items,Wb+Bc,Db.items[Bc]);else Array.insert(Ya.items,Wb,Db);return Ya}}Object(c.a)(Pb,"InsertAtAnnotationQueryStep",W,[]);class Fa extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){return!(!Db||!Db.tec(this.Ea.Pba))}}Object(c.a)(Fa,"IsDefinedAnnotationQueryStep",W,[]);class da extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){Db=this.Dyb(Ya,Db);return Ya.items[Db]}store(Ya,Db,Wb,Bc){const Tc=this.Dyb(Ya,
Wb);let id=Db;const k=({T8:Bc}=this.bla(Bc)).returnValue;k&&(id=k.store(y.Annotations.ZA(Ya.items[Tc]),Db,Wb,Bc));Ya.items[Tc]=id;return Ya}Dyb(Ya,Db){Db=this.Ea.query.Jk(Ya,Db);if(0>Db||Db>=Ya.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Db}}Object(c.a)(da,"ItemAnnotationQueryStep",W,[]);class K extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){const Wb=new V.a(this.Ea.annotations,y.Annotations.ala(this.Wq));for(const Bc of Ya.items)this.Ea.filter.isMatch(Bc,
Db)&&Array.add(Wb.items,Bc);return Wb}}Object(c.a)(K,"ItemsMatchingAnnotationQueryStep",W,[]);class xa extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){Db=this.Dyb(Ya,Db);return Ya.items[Ya.items.length-Db-1]}store(Ya,Db,Wb,Bc){const Tc=this.Dyb(Ya,Wb);let id=Db;const k=({T8:Bc}=this.bla(Bc)).returnValue;k&&(id=k.store(y.Annotations.ZA(Ya.items[Ya.items.length-Tc-1]),Db,Wb,Bc));Ya.items[Ya.items.length-Tc-1]=id;return Ya}Dyb(Ya,Db){Db=this.Ea.query?this.Ea.query.Jk(Ya,Db):0;if(0>Db||Db>=Ya.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Db}}Object(c.a)(xa,"LastItemAnnotationQueryStep",W,[]);class rb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya){if(y.Annotations.ju(this.Wq)){const Db=new V.a(this.Ea.annotations,y.Annotations.f9);for(const Wb of Ya.items)Array.add(Db.items,Wb.length);return Db}return Ya.length}}Object(c.a)(rb,"LengthAnnotationQueryStep",W,[]);class Qb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){if(y.Annotations.ju(this.Wq)){const Wb=new V.a(this.Ea.annotations,y.Annotations.K1);for(const Bc of Ya.items)Array.add(Wb.items,
this.Ea.filter.isMatch(Bc,Db));return Wb}return this.Ea.filter.isMatch(Ya,Db)}}Object(c.a)(Qb,"MatchesAnnotationQueryStep",W,[]);class pc extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){return this.Ea.filter.isMatch(Ya,Db)}}Object(c.a)(pc,"MatchesAsListAnnotationQueryStep",W,[]);class Lb extends aa{constructor(Ya){super(Ya)}y1a(Ya,Db){return Ya%Db}}Object(c.a)(Lb,"ModuloAnnotationQueryStep",aa,[]);class qb extends aa{constructor(Ya){super(Ya)}y1a(Ya,Db){return Ya*Db}}Object(c.a)(qb,"MultiplyAnnotationQueryStep",
aa,[]);class bc extends W{constructor(Ya){super();this.Ea=Ya}load(Ya){if(y.Annotations.ju(this.Wq)){const Db=new V.a(this.Ea.annotations,y.Annotations.K1);for(const Wb of Ya.items)Array.add(Db.items,!Wb);return Db}return!Ya}}Object(c.a)(bc,"NotAnnotationQueryStep",W,[]);class sc extends ka{constructor(Ya){super(Ya)}LCe(Ya){return{returnValue:Ya,result:!0}}ytb(Ya,Db){return Ya||Db}}Object(c.a)(sc,"OrAnnotationQueryStep",ka,[]);class Tb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){const Wb=
this.Ea.LYd.Jk(Ya,Db);Ya=this.Ea.Rtb.Jk(Ya,Db);Db=new V.a(this.Ea.annotations,y.Annotations.f9);for(let Bc=0;Bc<Ya;++Bc)Array.add(Db.items,Wb+Bc);return Db}}Object(c.a)(Tb,"RangeAnnotationQueryStep",W,[]);class $a{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.filter=Db.AV(Ya.ma(0)))}}Object(c.a)($a,"SingleFilterQueryStepInit",null,[]);class Nb{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.query=Ya.ma(0)?Db.Kv(Ya.ma(0)):null)}}Object(c.a)(Nb,"SingleOptionalQueryQueryStepInit",
null,[]);class Ra{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.query=Db.Kv(Ya.ma(0)))}}Object(c.a)(Ra,"SingleQueryQueryStepInit",null,[]);class ob{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.LYd=Db.Kv(Ya.ma(0)),this.Rtb=Ya.ma(1)?Db.Kv(Ya.ma(1)):null)}}Object(c.a)(ob,"StartAndCountOrLengthQueryStepInit",null,[]);class mb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){let Wb;({startIndex:Db,length:Wb}=this.Bfc(Ya,Db));const Bc=new V.a(this.Ea.annotations,Ya.tI);
for(let Tc=0;Tc<Wb;++Tc)Array.add(Bc.items,Ya.items[Db+Tc]);return Bc}store(Ya,Db,Wb,Bc){let Tc,id;({startIndex:Tc,length:id}=this.Bfc(Ya,Wb));var k=Db;const Ob=({T8:Bc}=this.bla(Bc)).returnValue;if(Ob){k=new V.a(this.Ea.annotations,Ya.tI);for(let kc=0;kc<id;++kc)Array.add(k.items,Ya.items[Tc+kc]);k=Ob.store(k,Db,Wb,Bc)}Db=k;for(Wb=0;Wb<id;++Wb)Array.removeAt(Ya.items,Tc);for(let kc=0,wc=Db.items.length;kc<wc;++kc)Array.insert(Ya.items,Tc+kc,Db.items[kc]);return Ya}Bfc(Ya,Db){let Wb;Wb=this.Ea.LYd.Jk(Ya,
Db);if(0>Wb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Db=this.Ea.Rtb?this.Ea.Rtb.Jk(Ya,Db):Ya.items.length-Wb;if(0>Db||Wb+Db>Ya.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Wb,length:Db}}}Object(c.a)(mb,"SublistAnnotationQueryStep",W,[]);class gb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya,Db){if(y.Annotations.ju(this.Wq)){const Wb=new V.a(this.Ea.annotations,y.Annotations.KL);for(let Bc=
0,Tc=Ya.items.length;Bc<Tc;++Bc)Array.add(Wb.items,this.caf(Ya.items[Bc],Db));return Wb}return this.caf(Ya,Db)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}caf(Ya,Db){let Wb;({startIndex:Db,length:Wb}=this.Bfc(Ya,Db));return Ya.substr(Db,Wb)}Bfc(Ya,Db){let Wb;Wb=this.Ea.LYd.Jk(Ya,Db);if(0>Wb)throw Error.invalidOperation("Invalid start index in Substring() query step");Db=this.Ea.Rtb?this.Ea.Rtb.Jk(Ya,Db):Ya.length-Wb;if(0>Db||Wb+Db>Ya.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");
return{startIndex:Wb,length:Db}}}Object(c.a)(gb,"SubstringAnnotationQueryStep",W,[]);class lb extends aa{constructor(Ya){super(Ya)}y1a(Ya,Db){return Ya-Db}}Object(c.a)(lb,"SubtractAnnotationQueryStep",aa,[]);class Xb extends W{constructor(Ya){super();this.Ea=Ya}load(Ya){const Db=new V.a(this.Ea.annotations,y.Annotations.KL);for(let Wb=0;Wb<Ya.length;++Wb)Array.add(Db.items,Ya.charAt(Wb).toString());return Db}}Object(c.a)(Xb,"ToCharListAnnotationQueryStep",W,[]);class Xd extends W{constructor(Ya){super();
this.Ea=Ya}load(Ya){const Db=new V.a(this.Ea.annotations,this.Wq);Array.add(Db.items,Ya);return Db}}Object(c.a)(Xd,"ToListAnnotationQueryStep",W,[]);class Qd extends W{constructor(Ya){super();this.Ea=Ya}load(){return this.Ea.value}}Object(c.a)(Qd,"ValueAnnotationQueryStep",W,[]);class te{constructor(Ya,Db){if(Ya){var Wb=Ya.ma(0),Bc=1;this.value=({iR:Bc}=Db.kKa(Wb,Ya,Bc,null,null,null)).returnValue;y.Annotations.yPa(this.value)}}}Object(c.a)(te,"ValueQueryStepInit",null,[]);class Pc{constructor(Ya,
Db){Ya&&(this.sHc=Db.ha(Ya.ma(0)),this.query=Db.Kv(Ya.ma(1)))}}Object(c.a)(Pc,"VarNameAndQueryQueryStepInit",null,[]);class Ne{constructor(Ya,Db){this.fbe=null;if(Ya){this.annotations=Db.annotations;var Wb=0;this.Wq=Ya.ma(Wb);++Wb;this.NI=Ya.ma(Wb);++Wb;this.JDc=1===Ya.ma(Wb);++Wb;this.Bjc=1===Ya.ma(Wb);++Wb;var Bc=Ya.ma(Wb);++Wb;if(Bc){var Tc=Wb,id=Wb+Bc,k=Wb+2*Bc;Wb+=3*Bc;var Ob=Ya.count-Wb,kc=null;for(let ad=0;ad<Bc;++ad){var wc=Wb+Ya.ma(k+ad);const sd=(ad===Bc-1?Ob:Ya.ma(k+ad+1))-Ya.ma(k+ad),
Gd=new La.a;Gd.jwa(Ya,wc,sd);wc=Ne.s3h(Ya.ma(id+ad),Gd,Db);wc.Wq=Ya.ma(Tc+ad);wc.NI=ad===Bc-1?this.NI:Ya.ma(Tc+ad+1);kc?kc.next=wc:this.fbe=wc;kc=wc}}}}get c0e(){return this.fbe}static s3h(Ya,Db,Wb){switch(Ya){case 1:return new Ea(new jb(Db,Wb));case 2:return new Fa(new jb(Db,Wb));case 3:return new Sa(new db(Db,Wb.annotations));case 4:return new Ab(new Qa(Db,Wb.annotations));case 5:return new Ua(new Aa(Db,Wb));case 6:return new Qb(new $a(Db,Wb));case 43:return new pc(new $a(Db,Wb));case 45:return new Ub(new Gb(Db,
Wb));case 49:return new hc(new yb(Db,Wb));case 46:return new Qd(new te(Db,Wb.annotations));case 51:return new fb(new ab(Db,Wb));case 52:return new Tb(new ob(Db,Wb));case 53:return new kb(new sb(Wb.annotations));case 13:return new da(new Ra(Db,Wb));case 14:return new xa(new Nb(Db,Wb));case 15:return new tb;case 18:return new Z(new $a(Db,Wb));case 16:return new wa(new Pc(Db,Wb));case 17:return new Fb(new Pc(Db,Wb));case 22:return new Pb(new Ib(Db,Wb));case 24:return new ib(new Ra(Db,Wb));case 26:return new mb(new ob(Db,
Wb));case 27:return new K(new $a(Db,Wb));case 30:return new Xd(new sb(Wb.annotations));case 31:return new gb(new ob(Db,Wb));case 32:return new wb(new Ra(Db,Wb));case 47:return new rb(new sb(Wb.annotations));case 48:return new Xb(new sb(Wb.annotations));case 34:return new ia(new Ra(Db,Wb));case 35:return new lb(new Ra(Db,Wb));case 36:return new qb(new Ra(Db,Wb));case 37:return new hb(new Ra(Db,Wb));case 38:return new Lb(new Ra(Db,Wb));case 39:return new va(new Ra(Db,Wb));case 40:return new Xa(new Ra(Db,
Wb));case 41:return new sc(new Ra(Db,Wb));case 42:return new bc(new sb(Wb.annotations));default:throw Error.argument("currStepInitData");}}}Object(c.a)(Ne,"AnnotationQueryInit",null,[]);class Hb{constructor(Ya){this.Ea=Ya}execute(Ya,Db){this.Lba(Ya,Ya?new U("root",Ya,Db):Db)}Lba(Ya,Db){for(const Wb of this.Ea.commands)Db=Wb.execute(Ya,Db)}}Object(c.a)(Hb,"AnnotationScript",null,[492]);class pb{constructor(Ya){this.Ea=Ya}execute(Ya,Db){const Wb=this.Ea.noi.Jk(Ya,Db),Bc=this.Ea.A8i.Jk(Ya,Db);this.Ea.script.Lba(Ya,
new U("Input",Wb,new U("Output",Bc,Db)));return Db}}Object(c.a)(pb,"ApplyAnnotationScriptCommand",null,[507]);class mc{constructor(Ya,Db){Ya&&(this.noi=Db.Kv(Ya.ma(0)),this.A8i=Db.Kv(Ya.ma(1)),this.script=Db.QLa(Ya.ma(2)))}}Object(c.a)(mc,"ApplyScriptCommandInit",null,[]);class Kc{constructor(Ya){this.Ea=Ya}execute(Ya,Db){const Wb=this.Ea.oRd.Jk(Ya,Db);this.Ea.soc.Cgb(Ya,Wb,Db,null);return Db}}Object(c.a)(Kc,"AssignAnnotationScriptCommand",null,[507]);class Nc{constructor(Ya){this.Ea=Ya}execute(Ya,
Db){const Wb=this.Ea.soc.Jk(Ya,Db);Ya=this.Ea.oRd.Jk(Ya,Db);Wb!==Ya&&Wb.ija(Ya);return Db}}Object(c.a)(Nc,"CopyAnnotationScriptCommand",null,[507]);class pd{constructor(Ya){this.Ea=Ya}execute(Ya,Db){let Wb=this.Ea.oyd.Jk(Ya,Db);if(this.Ea.oyd.JDc){Wb=y.Annotations.ZA(Wb);var Bc=new U(this.Ea.Pba,null,Db);for(let id=0,k=Wb.items.length;id<k;++id){var Tc=this.yYe(Ya,Wb.items[id],Bc);if(0>this.Ea.cyc)Wb.items[id]=Tc;else if(({value:Tc}=Tc.fj(this.Ea.cyc)).returnValue)Wb.items[id]=Tc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");
}this.Ea.oyd.Cgb(Ya,Wb,Db,null)}else{Bc=new U(this.Ea.Pba,null,Db);for(let id=0,k=Wb.items.length;id<k;++id)this.yYe(Ya,Wb.items[id],Bc)}return Db}yYe(Ya,Db,Wb){let Bc;0>this.Ea.cyc?Bc=y.Annotations.ZA(Db):(Bc=new A.a(this.Ea.annotations),Bc.Xn(this.Ea.cyc,Db));Wb.m4c(Bc);this.Ea.K_g.Lba(Ya,Wb);return Bc}}Object(c.a)(pd,"EnumerateAnnotationScriptCommand",null,[507]);class Vd{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.Pba=Db.ha(Ya.ma(0)),this.oyd=Db.Kv(Ya.ma(1)),this.K_g=Db.QLa(Ya.ma(2)),
this.cyc=Ya.ma(3))}}Object(c.a)(Vd,"EnumerateScriptCommandInit",null,[]);class $d{constructor(Ya){this.Ea=Ya}execute(Ya,Db){this.Ea.uEc.Jk(Ya,Db)?this.Ea.H1j.Lba(Ya,Db):this.Ea.tZe&&this.Ea.tZe.Lba(Ya,Db);return Db}}Object(c.a)($d,"IfAnnotationScriptCommand",null,[507]);class ue{constructor(Ya,Db){Ya&&(this.uEc=Db.Kv(Ya.ma(0)),this.H1j=Db.QLa(Ya.ma(1)),this.tZe=Ya.ma(2)?Db.QLa(Ya.ma(2)):null)}}Object(c.a)(ue,"IfScriptCommandInit",null,[]);class he{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,
this.soc=Db.Kv(Ya.ma(0)),this.oRd=Db.Kv(Ya.ma(1)))}}Object(c.a)(he,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Ge{constructor(Ya){this.Ea=Ya}execute(Ya,Db){const Wb=this.Ea.oRd.Jk(this.Ea.soc.Jk(Ya,Db),Db);this.Ea.soc.Cgb(Ya,Wb,Db,null);return Db}}Object(c.a)(Ge,"ModifyAnnotationScriptCommand",null,[507]);class Ad{constructor(Ya){this.Ea=Ya}execute(Ya,Db){const Wb=new A.a(this.Ea.annotations);this.Ea.query&&Wb.ija(this.Ea.query.Jk(Ya,Db));return Db=new U(this.Ea.Pba,Wb,Db)}}Object(c.a)(Ad,
"NewAnnotationScriptCommand",null,[507]);class Ie{constructor(Ya,Db){Ya&&(this.annotations=Db.annotations,this.Pba=Db.ha(Ya.ma(0)),this.query=Ya.ma(1)?Db.Kv(Ya.ma(1)):null)}}Object(c.a)(Ie,"NewScriptCommandInit",null,[]);class me{constructor(Ya){this.Ea=Ya}execute(Ya,Db){Ya=this.Ea.query.Jk(Ya,Db);if(this.Ea.query.NI===y.Annotations.dC)Ya.kwc(this.Ea.XY);else for(const Wb of Ya.items)Wb.kwc(this.Ea.XY);return Db}}Object(c.a)(me,"RemoveAnnotationScriptCommand",null,[507]);class cc{constructor(Ya,Db){Ya&&
(this.annotations=Db.annotations,this.query=Db.Kv(Ya.ma(0)),this.XY=Ya.ma(1))}}Object(c.a)(cc,"RemoveScriptCommandInit",null,[]);class $c{constructor(Ya,Db){if(Ya){var Wb=0,Bc=Ya.ma(Wb);++Wb;if(Bc){var Tc=Wb,id=Wb+Bc;Wb+=2*Bc;var k=Ya.count-Wb;this.commands=Array(Bc);for(let Ob=0;Ob<Bc;++Ob){const kc=Wb+Ya.ma(id+Ob),wc=(Ob===Bc-1?k:Ya.ma(id+Ob+1))-Ya.ma(id+Ob),ad=new La.a;ad.jwa(Ya,kc,wc);this.commands[Ob]=$c.p3h(Ya.ma(Tc+Ob),ad,Db)}}}}static p3h(Ya,Db,Wb){switch(Ya){case 1:return new Kc(new he(Db,
Wb));case 2:return new Ge(new he(Db,Wb));case 3:return new me(new cc(Db,Wb));case 6:return new Ad(new Ie(Db,Wb));case 7:return new pd(new Vd(Db,Wb));case 8:return new $d(new ue(Db,Wb));case 9:return new Nc(new he(Db,Wb));case 10:return new pb(new mc(Db,Wb));default:throw Error.argument("initData");}}}Object(c.a)($c,"AnnotationScriptInit",null,[]);var rd=a(972);class Nd{constructor(Ya){this.Wj=Ya;this.oC=0}jL(){const Ya=this.Wj.Vn(this.oC,4);this.oC+=4;return Ya}get array(){return this.Wj}get offset(){return this.oC}set offset(Ya){this.oC=
Ya}}Object(c.a)(Nd,"ByteArrayReader",null,[]);class ed{constructor(){this.Ru=null;this.Wwf=this.HN=0}ma(Ya){if(0>Ya||Ya>=this.HN)throw Error.argumentOutOfRange("index");return this.Ru.Vn(this.Wwf+4*Ya,4)}get count(){return this.HN}static Ohh(Ya,Db,Wb){const Bc=new ed;Bc.Ru=Ya;Bc.Wwf=Db;Bc.HN=Wb;return Bc}}Object(c.a)(ed,"ReadOnlyListOverByteArray",null,[306]);class yd{constructor(Ya,Db){this.Lwf=this.Kwf=!1;this.fm=this.xda=this.Vzd=this.Owf=null;try{this.fm=Db.annotations;const Wb=Db.uwa(Ya.ma(0)),
Bc=new Nd(Wb);if(-914743053!==Bc.jL())throw Error.argument("Input does not represent a flat lexicon");this.Kwf=1===Bc.jL();this.Lwf=1===Bc.jL();const Tc=Bc.jL();Bc.offset+=Tc;const id=Bc.jL();this.Vzd=yd.v9i(Bc,id,this.fm);const k=Bc.jL();this.Owf=yd.A9i(Bc,k);const Ob=Bc.jL();this.xda=new rd.a(Bc.array,Bc.offset);Bc.offset+=Ob}catch(Wb){throw Error.argument("initData");}}get trie(){return this.xda}BVh(Ya){return"i"===Ya&&this.Lwf?"\u0130":Ya.toUpperCase()}Mrd(){return this.Kwf}ETh(Ya){let Db;Db=
new V.a(this.fm,y.Annotations.dC);if(1!==Ya)if(0===Ya)Ya=new A.a(this.fm),Array.add(Db.items,Ya);else if(Ya&1073741824){Ya=this.Owf[Ya&-1073741825];for(let Bc=0;Bc<Ya.length;++Bc){var Wb=Ya[Bc];Wb=0===Wb?new A.a(this.fm):this.Vzd[Wb-2];Array.add(Db.items,Wb)}}else Array.add(Db.items,this.Vzd[Ya-2]);return{returnValue:!0,rFi:Db}}static v9i(Ya,Db,Wb){if(Db%4)throw Error.argument("reader");const Bc=ed.Ohh(Ya.array,Ya.offset,Db/4);Ya.offset+=Db;Ya=[];for(Db=0;Db<Bc.count;){const Tc=({iR:Db}=Wb.kKa(y.Annotations.dC,
Bc,Db,null,null,null)).returnValue;Array.add(Ya,Tc)}return Ya}static A9i(Ya,Db){Db=Ya.offset+Db;const Wb=[];for(;Ya.offset<Db;){const Bc=Ya.jL(),Tc=Array(Bc);for(let id=0;id<Bc;++id){const k=Ya.jL();Tc[id]=k}Array.add(Wb,Tc)}return Wb}}Object(c.a)(yd,"RawFlatLexicon",null,[491]);var Ed=a(927),Ud=a(928);class fe{constructor(Ya){if(null==Ya)throw Error.argumentNull("base64String");const Db=Ya.length;if(Db%4)throw Error.argument("base64String's length must be a multiple of 4");this.HN=.75*Db;this.JPa=
Array(Math.ceil(this.HN/4));Ya.endsWith("==")?this.HN-=2:Ya.endsWith("=")&&--this.HN;let Wb=0;for(let Bc=0;Bc<Db;Bc+=4){const Tc=fe.Iyc[Ya.charCodeAt(Bc)-43]<<18|fe.Iyc[Ya.charCodeAt(Bc+1)-43]<<12|fe.Iyc[Ya.charCodeAt(Bc+2)-43]<<6|fe.Iyc[Ya.charCodeAt(Bc+3)-43];let id=Tc>>16&255;this.JPa[Math.floor(Wb/4)]|=id<<Wb%4*8;++Wb;id=Tc>>8&255;this.JPa[Math.floor(Wb/4)]|=id<<Wb%4*8;++Wb;id=Tc&255;this.JPa[Math.floor(Wb/4)]|=id<<Wb%4*8;++Wb}}get length(){return this.HN}ma(Ya){if(0>Ya||Ya>=this.HN)throw Error.argumentOutOfRange("i");
return this.D3e(Ya)}Vn(Ya,Db){if(0>Ya||0>Db||Ya+Db>this.HN)throw Error.argument("Bad range");let Wb=0;for(let Bc=0;Bc<Db;++Bc)Wb|=this.D3e(Ya+Bc)<<8*Bc;return Wb}kjj(Ya,Db){let Wb=0,Bc=0,Tc=Math.floor(Ya/8);for(Ya%=8;Bc<Db;){const id=8-Ya>Db-Bc?Db-Bc:8-Ya,k=this.ma(Tc);Wb|=(k>>Ya&~(255<<id))<<Bc;Bc+=id;++Tc;Ya=0}return Wb}D3e(Ya){return this.JPa[Math.floor(Ya/4)]>>Ya%4*8&255}}fe.Iyc=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(c.a)(fe,"ByteArray",null,[]);class We{constructor(Ya,Db,Wb){this.ar=Ya;this.NKi=Db;this.WKi=Wb;this.dxf=Array(Ya.b?Ya.b.length:0);this.zAd=new Ed.a(new Ud.a(this.uwa(this.ar.s)));this.SK=Array(Ya.t.length);this.Qwg=new y.Annotations(this.qwa(0),this)}get annotations(){return this.Qwg}get Eth(){return this.ar.d}Q2h(){if(!(""in this.ar.m))throw Error.argument("name","Unrecognized module");return this.hkd(this.ar.m[""])}uwa(Ya){if(0>
Ya||!this.ar.b||Ya>=this.ar.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.dxf[Ya]||(this.dxf[Ya]=new fe(this.ar.b[Ya]))}ha(Ya){if(1>Ya||Ya>=this.ar.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.ar.t[Ya])throw Error.argument("blobID","Requested blob is not a string");if(null==this.SK[Ya]){const Db=this.qwa(Ya).ma(0);this.SK[Ya]=this.zAd.ha(Db)}return this.SK[Ya]}w9e(Ya){if(1>Ya||Ya>=this.ar.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.ar.t[Ya])throw Error.argument("blobID",
"Requested blob is not a Regex");if(!this.SK[Ya]){var Db=this.qwa(Ya);const Wb=this.ha(Db.ma(0));Db=1===Db.ma(1);this.SK[Ya]=new RegExp(Wb,Db?"i":"")}return this.SK[Ya]}x7h(Ya){if(1>Ya||Ya>=this.ar.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.ar.t[Ya])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}hkd(Ya){if(1>Ya||Ya>=this.ar.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.ar.t[Ya])throw Error.argument("blobID","Requested blob is not an NL module");
return this.SK[Ya]||(this.SK[Ya]=this.WKi.f3h(this.qwa(Ya),this))}Kv(Ya){if(1>Ya||Ya>=this.ar.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.ar.t[Ya])throw Error.argument("blobID","Requested blob is not an annotation query");return this.SK[Ya]||(this.SK[Ya]=new ma(new Ne(this.qwa(Ya),this)))}QLa(Ya){if(1>Ya||Ya>=this.ar.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.ar.t[Ya])throw Error.argument("blobID","Requested blob is not an annotation script");return this.SK[Ya]||
(this.SK[Ya]=new Hb(new $c(this.qwa(Ya),this)))}AV(Ya){if(1>Ya||Ya>=this.ar.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.ar.t[Ya])throw Error.argument("blobID","Requested blob is not a filter");return this.SK[Ya]||(this.SK[Ya]=this.NKi.AV(this.qwa(Ya),this))}i6h(Ya){if(1>Ya||Ya>=this.ar.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.ar.t[Ya])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.SK[Ya]||(this.SK[Ya]=new yd(this.qwa(Ya),
this))}qwa(Ya){const Db=this.ar.n[Ya];Ya=(Ya<this.ar.t.length-1?this.ar.n[Ya+1]:this.ar.n.length)-Db;if(0>Db||0>Ya||Db+Ya>this.ar.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Db+","+Ya+")");const Wb=new La.a;Wb.vgd(this.ar.n,Db,Ya);return Wb}}Object(c.a)(We,"ObjectFetcher",null,[287]);class lf{constructor(Ya,Db,Wb){if(!Ya)throw Error.argumentNull("prediction");if(!Db)throw Error.argumentNull("fieldNames");if(!Wb)throw Error.argumentNull("values");if(Db.length!==
Wb.length)throw Error.argument("values","fieldNames and values do not have same length");this.dGg=Ya;this.KPa=Db;this.XFb=Wb}get prediction(){return this.dGg}get FZe(){return this.KPa.length}bMa(Ya){return 0<=Ya&&Ya<this.KPa.length?this.KPa[Ya]:null}fxa(Ya){return 0<=Ya&&Ya<this.XFb.length?this.XFb[Ya]:null}}Object(c.a)(lf,"PredictionData",null,[]);class Se{constructor(Ya,Db){if(!Ya)throw Error.argumentNull("predictions");if(!Db)throw Error.argumentNull("tokenAttributes");this.ZKi=Ya;this.jLi=Db}Mkd(){return this.ZKi}W2e(){return this.jLi}}
Object(c.a)(Se,"PredictionDataWithTokenAttributes",null,[]);class Ae{constructor(Ya,Db){this.prediction=null;this.score=0;this.prediction=Ya;this.score=Db}}Object(c.a)(Ae,"PredictionWithScore",null,[]);class Qe{constructor(Ya,Db){if(!Ya)throw Error.argumentNull("predictions");if(!Db)throw Error.argumentNull("attributes");this.eGg=Ya;this.NTb=Db}Mkd(){return this.eGg}W2e(){return this.NTb}}Object(c.a)(Qe,"PredictionsWithTokenAttributes",null,[]);class $e{constructor(Ya,Db,Wb){if(!Ya)throw Error.argumentNull("attributeName");
if(!Db)throw Error.argumentNull("fieldNames");if(!Wb)throw Error.argumentNull("values");if(Db.length!==Wb.length)throw Error.argument("values","fieldNames and values do not have same length");this.lxg=Ya;this.KPa=Db;this.XFb=Wb}get attributeName(){return this.lxg}get FZe(){return this.KPa.length}bMa(Ya){return 0<=Ya&&Ya<this.KPa.length?this.KPa[Ya]:null}fxa(Ya){return 0<=Ya&&Ya<this.XFb.length?this.XFb[Ya]:null}}Object(c.a)($e,"TokenAttributes",null,[]);var of=a(88),re=a(707);class zf{constructor(Ya,
Db,Wb,Bc,Tc){this.dTb=0;this.r5d=null;this.eTb=this.Gib=0;this.tIc=this.mWa=this.ZX=this.Hib=null;this.t5d=0;this.MYa=this.ap=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.mu=Ya;this.Wrg=this.$rg=Db;this.Vrg=this.Yrg=Wb;this.bTb=this.Xrg=Bc;this.cTb=this.Zrg=Tc}sIc(){this.eTb=0;return this.o5d}o5d(){if(!(this.eTb<this.bTb))return this.p5d;this.Hib=this.Wrg.items[this.eTb+this.Vrg];this.ZX=new A.a(this.mu.Ea.annotations);
1!==this.bTb&&this.mu.Ea.NBb||this.ZX.ija(this.Hib);if(0<=this.mu.Ea.Npc){({value:this.mWa}=this.ZX.fj(this.mu.Ea.Npc)).returnValue?this.mWa=this.mWa.ZA():this.mWa=new V.a(this.mu.Ea.annotations,y.Annotations.dC);this.tIc=this.cTb.items;this.t5d=this.tIc.length;for(this.dTb=0;this.dTb<this.t5d;++this.dTb)this.r5d=this.tIc[this.dTb],Array.add(this.mWa.items,this.r5d);this.ZX.Xn(this.mu.Ea.Npc,this.mWa)}else 0<=this.mu.Ea.LXd?this.ZX.Xn(this.mu.Ea.LXd,this.cTb.items[0]):0<=this.mu.Ea.v2c?this.ZX.Xn(this.mu.Ea.v2c,
!0):this.mu.Ea.Tnf?this.cTb.items[0].Scc((Ya,Db)=>this.ZX.Xn(Ya,Db)):(this.ZX.ija(this.cTb.items[0]),1!==this.bTb&&this.mu.Ea.NBb||(({value:this.Gib}=this.Hib.fj(this.mu.Ea.lH)).returnValue&&this.ZX.Xn(this.mu.Ea.lH,this.Gib),({value:this.Gib}=this.Hib.fj(this.mu.Ea.TJ)).returnValue&&this.ZX.Xn(this.mu.Ea.TJ,this.Gib),this.Hib.fj(this.mu.Ea.Vta).returnValue&&this.ZX.Xn(this.mu.Ea.Vta,this.Gib)));this.ap=this.ZX;this._state=2;return this.csg}p5d(){this._state=3}bsg(){this.eTb++;return this.o5d}csg(){return 1<
this.bTb&&this.mu.Ea.NBb?this.p5d:this.bsg}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new zf(this.mu,this.$rg,this.Yrg,this.Xrg,this.Zrg)).getEnumerator()}[Symbol.iterator](){return Object(re.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.MYa=this.sIc());for(;1===this._state;)this.MYa=this.MYa();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.ap}}
Object(c.a)(zf,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[2,33,66]);class Lf{constructor(Ya,Db,Wb){this.SFb=this.Xwf=0;this.Q$a=null;this.AAd=this.aAd=this.O$a=this.zoc=this.dAd=0;this.Boc=!1;this.pAd=Ya;this.BAd=Db;this.YKi=Wb}c8e(){null===this.Q$a&&({Xhg:this.Q$a,qgf:this.dAd,length:this.zoc,SJh:Ya}=this.pAd.zaf(this.BAd.items[this.SFb],this.YKi),this.Boc=Ya||this.Boc);if(this.O$a<this.zoc){var Ya=this.Q$a.charAt(this.dAd+
this.O$a);++this.O$a;return{returnValue:!0,ch:Ya}}if(this.SFb===this.BAd.items.length-1)return{returnValue:!1,ch:"\x00"};++this.SFb;this.O$a=0;this.Q$a=null;return{returnValue:!0,ch:" "}}bNd(Ya,Db){this.O$a===this.zoc&&this.Q$a&&(this.AAd=Db,this.aAd=this.SFb-this.Xwf+1)}Ouj(Ya){if(0>Ya||Ya>=this.BAd.items.length)throw Error.argumentOutOfRange("iToken");this.SFb=this.Xwf=Ya;this.Q$a=null;this.aAd=this.O$a=this.zoc=this.dAd=0;this.AAd=-1;this.Boc=!1}v2h(){return{G3g:this.aAd,uDi:this.AAd,OJh:this.Boc}}}
Object(c.a)(Lf,"TriePrefixVisitor",null,[331]);class Ze{constructor(Ya){this.Ea=Ya}execute(Ya){if(!({value:Wb}=Ya.fj(this.Ea.saa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Db;({value:Db}=Ya.fj(this.Ea.nia)).returnValue||(Db=null);var Wb=this.iTh(Wb,Db);Ya=y.Annotations.ZA(Ya);Ya.Xn(this.Ea.saa,Wb);return Ya}iTh(Ya,Db){let Wb=null;const Bc=this.Ea.flatLexicon.trie,Tc=new Lf(this,Ya,Db);let id=null;this.Ea.flatLexicon.Mrd()&&(id=Object(of.a)(this.Ea.flatLexicon,
this.Ea.flatLexicon.BVh,"getCaseInsensitiveForm"));let k=0,Ob;var kc;let wc;for(;k<Ya.items.length;){const ad=Ya.items[k];Tc.Ouj(k);Bc.Pqg(Tc,id);({G3g:Ob,uDi:kc,OJh:wc}=Tc.v2h());if(0<Ob){({rFi:kc}=this.Ea.flatLexicon.ETh(kc));for(let sd of this.jjh(Ya,k,Ob,kc)){1<Ob&&this.Ea.NBb&&this.Njh(Ya,Db,k,ad,Ob,wc,sd);if(!Wb)for(Wb=new V.a(this.Ea.annotations,y.Annotations.dC),kc=0;kc<k;++kc)Array.add(Wb.items,Ya.items[kc]);Array.add(Wb.items,sd)}k+=Ob}else Wb&&Array.add(Wb.items,ad),++k}return Wb||Ya}Njh(Ya,
Db,Wb,Bc,Tc,id,k){if(id)id=!0;else if(this.Ea.Enf){id=!1;var Ob=-1;for(var kc=0;kc<Tc;kc++){var wc=Ya.items[Wb+kc];let Yd;var ad=void 0;if(!({value:Yd}=wc.fj(this.Ea.lH)).returnValue||!({value:ad}=wc.fj(this.Ea.TJ)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<kc){if(Yd>Ob+1){id=!0;break}if(0>Ob||null===Db||Ob>=Db.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==Db.charAt(Ob)){id=!0;break}}Ob=Yd+ad}}else id=!1;if(id){ad=new Sys.StringBuilder;for(id=0;id<Tc;++id)({Xhg:Ob,qgf:kc,length:wc}=this.zaf(Ya.items[Wb+id],Db)),0<id&&ad.append(" "),ad.append(Ob.substr(kc,wc));k.Xn(this.Ea.Vta,ad.toString())}Ya=Ya.items[Wb+Tc-1];let sd,Gd;({value:Bc}=Bc.fj(this.Ea.lH)).returnValue&&({value:sd}=Ya.fj(this.Ea.lH)).returnValue&&({value:Gd}=Ya.fj(this.Ea.TJ)).returnValue?(k.Xn(this.Ea.lH,Bc),k.Xn(this.Ea.TJ,sd+Gd-Bc)):(k.kwc(this.Ea.lH),k.kwc(this.Ea.TJ))}jjh(Ya,
Db,Wb,Bc){return new zf(this,Ya,Db,Wb,Bc)}zaf(Ya,Db){let Wb,Bc;if(({value:Wb}=Ya.fj(this.Ea.Vta)).returnValue)Bc=!0,Db=0,Ya=Wb.length;else{Bc=!1;if(null===Db)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Wb=Db;if(!({value:Db}=Ya.fj(this.Ea.lH)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:Ya}=Ya.fj(this.Ea.TJ)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");
if(0>Db||0>Ya||Db+Ya>Wb.length)throw Error.argument("Token start/length values out of range","token");}return{Xhg:Wb,qgf:Db,length:Ya,SJh:Bc}}}Object(c.a)(Ze,"FlatLexiconNLModule",null,[307]);class ec{constructor(Ya,Db){this.v2c=this.Npc=this.LXd=this.Vta=this.TJ=this.lH=this.nia=this.saa=0;this.Tnf=this.Enf=this.NBb=!1;this.flatLexicon=null;this.annotations=Db.annotations;let Wb=0;try{this.saa=Ya.ma(Wb),++Wb,this.nia=Ya.ma(Wb),++Wb,this.lH=Ya.ma(Wb),++Wb,this.TJ=Ya.ma(Wb),++Wb,this.Vta=Ya.ma(Wb),
++Wb,this.LXd=Ya.ma(Wb),++Wb,this.Npc=Ya.ma(Wb),++Wb,this.v2c=Ya.ma(Wb),++Wb,this.NBb=1===Ya.ma(Wb),++Wb,this.Enf=1===Ya.ma(Wb),++Wb,this.Tnf=1===Ya.ma(Wb),++Wb,this.flatLexicon=Db.i6h(Ya.ma(Wb))}catch(Bc){throw Error.argument("initData");}}}Object(c.a)(ec,"FlatLexiconNLModuleInit",null,[]);class Lc{constructor(){this.FAb=0;this.Ned=null;this.oNb=0}}Object(c.a)(Lc,"FeatureGenStackRec",null,[]);class Da{constructor(Ya){this.j0d=Array(Ya);this.ihb=Array(Ya);this.kZd=[];this.Xfg=[]}}Object(c.a)(Da,"TokenStringLattice",
null,[]);const Cb=(Ya,Db,Wb)=>{for(let Bc=0;Bc<Ya.length;Bc++)Wb=Db(Wb,Ya[Bc]);return Wb},Zb=(Ya,Db)=>{const Wb=Array(Ya.length);for(let Bc=0;Bc<Ya.length;Bc++)Wb[Bc]=Db(Ya[Bc]);return Wb},yc=(Ya,Db)=>{Db=Array(Math.min(Db,Ya.length));for(let Wb=0;Wb<Db.length;Wb++)Db[Wb]=Ya[Wb];return Db},Vc=(Ya,Db)=>{const Wb=[];for(const Bc of Ya)Db(Bc)&&Array.add(Wb,Bc);return Wb};class jd{constructor(Ya,Db){this.key=Ya;this.value=Db}}Object(c.a)(jd,"KeyValuePair",null,[]);const ld=(Ya,Db)=>({returnValue:Db in
Ya,value:Ya[Db]}),Bd=Ya=>{const Db=[];for(let Wb in Ya){const Bc=new jd(Wb,Ya[Wb]);Array.add(Db,Bc)}return Db};class Td{constructor(Ya){this.yaf=this.u$h;this.Ea=Ya;this.Eoc=this.nAd=this.oAd=0;for(const Db of this.Ea.Pbc)this.oAd=Math.max(this.oAd,Db.nJd),this.nAd=Math.max(this.nAd,Db.eJd),this.Eoc=Math.max(this.Eoc,Db.ngb.length)}get xLh(){return this.Ea.SEc.trie}execute(Ya){if(!Ya)throw Error.argumentNull("input");let Db,Wb;({tokens:Db,fEi:Wb}=this.v$h(Ya));let Bc=null,Tc=null,id={};if(this.Ea.vCb){Db=
y.Annotations.ZA(Db);for(var k=0;k<Db.items.length;++k)Db.items[k]=y.Annotations.ZA(Db.items[k])}else({wZe:Tc,returnValue:Bc}=this.B8e(Ya,id));k=Array(this.Eoc);const Ob=Array(this.Eoc);for(var kc=0;kc<Ob.length;++kc)Ob[kc]=new Lc;for(kc=-this.oAd;kc<Db.items.length+this.nAd;++kc){let wc=null;this.Ea.vCb&&(wc=Db.items[kc],id={},{wZe:Tc,returnValue:Bc}=this.B8e(wc,id));for(const ad of this.Ea.Pbc){if(0>kc&&-kc>ad.nJd||kc>=Db.items.length&&kc-Db.items.length+1>ad.eJd)continue;let sd=!0;for(let Gd=0;Gd<
ad.ngb.length;++Gd){const Yd=kc+ad.ngb[Gd];k[Gd]=Yd;if(0>Yd?0>this.Ea.oJd:Yd>=Db.items.length?0>this.Ea.fJd:!Wb.ihb[Yd]){sd=!1;break}}sd&&({Gmh:Bc,Hmh:Tc}=this.Voi(ad,Wb,Bc,Tc,id,Ob,k))}this.Ea.vCb&&(wc.Xn(this.Ea.jma?this.Ea.I0a:this.Ea.G0a,Bc),this.Ea.jma&&wc.Xn(this.Ea.H0a,Tc))}Ya=y.Annotations.ZA(Ya);this.Ea.vCb?Ya.Xn(this.Ea.saa,Db):(Ya.Xn(this.Ea.jma?this.Ea.I0a:this.Ea.G0a,Bc),this.Ea.jma&&Ya.Xn(this.Ea.H0a,Tc));return Ya}v$h(Ya){let Db,Wb;if(!Ya||!({value:Db}=Ya.fj(this.Ea.saa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Bc;({value:Bc}=Ya.fj(this.Ea.nia)).returnValue||(Bc="");Wb=new Da(Db.items.length);const Tc=Vc(this.Ea.l0d,id=>!id.oBb||id.oBb.isMatch(Ya,null));for(let id=0;id<Db.items.length;++id){const k=Db.items[id];let Ob=null;Wb.j0d[id]=Wb.kZd.length;let kc=Wb.ihb[id]=0;for(const wc of Tc)0<wc.cGb&&Wb.ihb[id]+kc>=wc.cGb||wc.eRb&&!wc.eRb.isMatch(k,null)||({fRb:Ob,asb:kc}=wc.apply(this,k,id,Wb,Bc,Ob,kc))}return{tokens:Db,fEi:Wb}}Voi(Ya,Db,Wb,Bc,Tc,id,k){let Ob=0;id[0].FAb=-1;for(id[0].Ned=Ya.x3f;;){var kc=
k[Ob],wc=0>kc||kc>=Db.ihb.length?1:Db.ihb[kc];let Gd=!1;for(;id[Ob].FAb<wc-1;){++id[Ob].FAb;var ad=void 0,sd=void 0;0>kc?(ad=this.Ea.oJd,sd=1):kc>=Db.j0d.length?(ad=this.Ea.fJd,sd=1):(sd=Db.j0d[kc]+id[Ob].FAb,ad=Db.kZd[sd],sd=Db.Xfg[sd]);id[Ob].oNb=sd*(Ob?id[Ob-1].oNb:Ya.score);if(({value:ad}=ld(id[Ob].Ned,ad.toString())).returnValue){Ob===Ya.ngb.length-1?(kc=ad,id[Ob].oNb&&(({value:wc}=ld(Tc,kc.toString())).returnValue||(wc=-1),0>wc&&(Wb=y.Annotations.ZA(Wb),Array.add(Wb.items,kc)),this.Ea.jma&&
(Bc=y.Annotations.ZA(Bc),0>wc?Array.add(Bc.items,id[Ob].oNb):Bc.items[wc]+=id[Ob].oNb),0>wc&&(this.Ea.wqf||this.Ea.jma)&&(Tc[kc.toString()]=Wb.items.length-1))):(++Ob,id[Ob].FAb=-1,id[Ob].Ned=ad);Gd=!0;break}}if(!Gd&&(--Ob,0>Ob))break}return{Gmh:Wb,Hmh:Bc}}B8e(Ya,Db){let Wb;if(({value:Wb}=Ya.fj(this.Ea.jma?this.Ea.I0a:this.Ea.G0a)).returnValue)for(let Bc=0;Bc<Wb.items.length;++Bc)Db[Wb.items[Bc].toString()]=Bc;else Wb=new V.a(this.Ea.annotations,y.Annotations.f9);if(this.Ea.jma){if(({value:Db}=Ya.fj(this.Ea.H0a)).returnValue||
(Db=new V.a(this.Ea.annotations,y.Annotations.OX)),Db.items.length!==Wb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ea.annotations.kP(y.Annotations.dC,Ya));}else Db=null;return{returnValue:Wb,wZe:Db}}get o_j(){return this.Ea.SEc}u$h(Ya,Db){var Wb;if(({value:Wb}=Db.fj(this.Ea.Vta)).returnValue)Ya=Wb;else{if(!({value:Wb}=Db.fj(this.Ea.lH)).returnValue)throw Error.argument("Token is missing Span.StartIndex");
if(!({value:Db}=Db.fj(this.Ea.TJ)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Wb||0>Db||Wb+Db>Ya.length)throw Error.argument("Token indices are out of range");Ya=Ya.substr(Wb,Db)}return Ya}}Object(c.a)(Td,"NGramNLModule",null,[307,490]);class Jd{constructor(Ya){this.ngb=null;this.score=this.eJd=this.nJd=0;this.x3f=null;if(Ya){var Db=0;try{if(Ya.ma(Db)!==Jd.GIa)throw Error.argument("initData","Input does not represent a feature template");++Db;const Wb=Ya.ma(Db);++Db;this.ngb=
Array(Wb);for(let Bc=0;Bc<Wb;++Bc)this.ngb[Bc]=Ya.ma(Db),++Db;this.nJd=Ya.ma(Db);++Db;this.eJd=Ya.ma(Db);++Db;this.score=Ya.ma(Db);++Db;this.x3f=({ogf:Db}=Jd.PVf(Ya,Db)).returnValue}catch(Wb){throw Error.argument("initData");}}}static PVf(Ya,Db){const Wb=Ya.ma(Db);++Db;const Bc={};for(let Tc=0;Tc<Wb;++Tc){const id=Ya.ma(Db);++Db;Ya.ma(Db)?Bc[id.toString()]=({ogf:Db}=Jd.PVf(Ya,Db)).returnValue:(++Db,Bc[id.toString()]=Ya.ma(Db),++Db)}return{returnValue:Bc,ogf:Db}}}Jd.GIa=240803228;Object(c.a)(Jd,"FeatureTemplate",
null,[623]);var ce=a(875);class ie{constructor(Ya,Db){this.jma=this.wqf=this.vCb=!1;this.Vta=this.TJ=this.lH=this.saa=this.nia=this.H0a=this.I0a=this.G0a=0;this.SEc=null;this.fJd=this.oJd=0;this.Pbc=this.l0d=null;if(Ya){this.annotations=Db.annotations;var Wb=0;try{this.vCb=1===Ya.ma(Wb);++Wb;this.wqf=1===Ya.ma(Wb);++Wb;this.jma=1===Ya.ma(Wb);++Wb;this.G0a=Ya.ma(Wb);++Wb;this.I0a=Ya.ma(Wb);++Wb;this.H0a=Ya.ma(Wb);++Wb;this.nia=Ya.ma(Wb);++Wb;this.saa=Ya.ma(Wb);++Wb;this.lH=Ya.ma(Wb);++Wb;this.TJ=Ya.ma(Wb);
++Wb;this.Vta=Ya.ma(Wb);++Wb;this.SEc=this.S9i(Db.uwa(Ya.ma(Wb)));++Wb;this.oJd=Ya.ma(Wb);++Wb;this.fJd=Ya.ma(Wb);++Wb;const Bc=Ya.ma(Wb);++Wb;this.l0d=Array(Bc);for(let id=0;id<Bc;++id){const k=Ya.ma(Wb);++Wb;const Ob=this.SEc.trie,kc=new La.a;kc.jwa(Ya,Wb,k);this.l0d[id]=this.W9i(kc,Db,Ob);Wb+=k}const Tc=Ya.ma(Wb);++Wb;this.Pbc=Array(Tc);for(Db=0;Db<Tc;++Db){const id=Ya.ma(Wb);++Wb;const k=new La.a;k.jwa(Ya,Wb,id);this.Pbc[Db]=this.B9i(k);Wb+=id}}catch(Bc){throw Error.argument("initData");}}}S9i(Ya){return new Ed.a(new Ud.a(Ya))}W9i(Ya,
Db,Wb){return ce.a.create(Ya,Db,Wb)}B9i(Ya){return new Jd(Ya)}}Object(c.a)(ie,"NGramNLModuleInit",null,[]);class we{constructor(Ya){this.Ea=Ya}execute(Ya){if(!Ya)throw Error.argumentNull("input");Ya=Ya.clone();this.Ea.script.execute(Ya,null);return Ya}}Object(c.a)(we,"ScriptNLModule",null,[307]);class zc{constructor(Ya,Db){Ya&&(this.script=Db.QLa(Ya.ma(0)))}}Object(c.a)(zc,"ScriptNLModuleInit",null,[]);const Sc=Ya=>{Ya=Zb(Ya,Db=>Db*Db);return Math.sqrt(Cb(Ya,(Db,Wb)=>Db+Wb,0))},td=Ya=>Cb(Ya,(Db,Wb)=>
Db>Wb?Db:Wb,Ya[0]);class Md{constructor(Ya){this.Ea=Ya}execute(Ya){if(!Ya)throw Error.argumentNull("input");var Db=[],Wb=[];this.U$g(Ya,Db,Wb);this.STg(Db,Wb);const Bc={};for(let id=0;id<Db.length;++id){var Tc=Db[id];const k=this.Ea.Iif.ma(Tc);Tc=this.Ea.Jif.ma(Tc);for(let Ob=0;Ob<Tc;++Ob){const kc=this.Ea.L8g.ma(this.Ea.TEe.ma(k+Ob)),wc=this.Ea.UEe.ma(k+Ob);let ad;({value:ad}=ld(Bc,kc)).returnValue||(ad=0);Bc[kc]=ad+Wb[id]*wc}}Wb=Bd(Bc);Wb.sort((id,k)=>{var Ob=id.value,kc=k.value;(Ob=-(Ob>kc?1:Ob<
kc?-1:0))||(Ob=id.key.localeCompare(k.key));return Ob});Db=new V.a(this.Ea.annotations,y.Annotations.dC);for(const id of yc(Wb,this.Ea.EMi))Wb=new A.a(this.Ea.annotations),Wb.Xn(this.Ea.JYg,id.key),Wb.Xn(this.Ea.LYg,id.value),Array.add(Db.items,Wb);Ya.Xn(this.Ea.KYg,Db);return Ya}U$g(Ya,Db,Wb){if(({value:Ya}=Ya.fj(this.Ea.IYg)).returnValue){let Bc;if(({value:Bc}=Ya.fj(this.Ea.I0a)).returnValue){let Tc;if(!({value:Tc}=Ya.fj(this.Ea.H0a)).returnValue||Bc.items.length!==Tc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");
this.r6b(Bc,Tc,Db,Wb)}if(({value:Bc}=Ya.fj(this.Ea.NYg)).returnValue){let Tc;if(!({value:Tc}=Ya.fj(this.Ea.OYg)).returnValue||Bc.items.length!==Tc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.r6b(Bc,Tc,Db,Wb)}({value:Bc}=Ya.fj(this.Ea.G0a)).returnValue&&this.r6b(Bc,null,Db,Wb);({value:Bc}=Ya.fj(this.Ea.MYg)).returnValue&&this.r6b(Bc,null,Db,Wb)}}r6b(Ya,Db,Wb,Bc){for(let id=0;id<Ya.items.length;++id){var Tc=void 0;Ya.tI===
y.Annotations.KL?({value:Tc}=ld(this.Ea.eRe,Ya.items[id])).returnValue||(Tc=-1):(Tc=Ya.items[id],Tc=Tc>=this.Ea.GBd&&Tc<=this.Ea.gNi?this.Ea.eDd?this.Ea.eDd.ma(Tc-this.Ea.GBd)-1:Tc-this.Ea.GBd:-1);if(0<=Tc){let k;k=Db?Db.items[id]:1;0<k&&(Array.add(Wb,Tc),Array.add(Bc,k))}}}STg(Ya,Db){if(Ya.length){switch(this.Ea.tfj){case 0:break;case 1:for(var Wb=0;Wb<Db.length;++Wb)Db[Wb]=1+Math.log(Db[Wb]);break;case 2:Wb=td(Db);for(let Bc=0;Bc<Db.length;++Bc)Db[Bc]=.5+Db[Bc]/Wb*.5;break;case 3:for(Wb=0;Wb<Db.length;++Wb)Db[Wb]=
1;break;default:throw Error.notImplemented();}if(this.Ea.Kic)for(Wb=0;Wb<Db.length;++Wb)Db[Wb]*=this.Ea.Kic.ma(Ya[Wb]);Ya=Sc(Db);for(Wb=0;Wb<Db.length;++Wb)Db[Wb]/=Ya}}}Object(c.a)(Md,"TfIdfRankerNLModule",null,[307]);class wd{constructor(Ya,Db=0){if(!Ya)throw Error.argumentNull("byteArray");this.Foc=Db;if(604662927!==Ya.Vn(this.Foc+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this._count=Ya.Vn(this.Foc+4,4);this.wwf=Ya.Vn(this.Foc+8,4);this.GKi=Ya}ma(Ya){if(0>
Ya||Ya>=this.count)throw Error.argumentOutOfRange("index");return this.GKi.kjj(8*this.Foc+96+Ya*this.wwf,this.wwf)}get count(){return this._count}}Object(c.a)(wd,"CompactIntArray",null,[306]);const Ta=(Ya,Db)=>{Db=Array(Db);for(let id=0;id<Db.length;id++){var Wb=id,Bc=Ya.jL(),Tc=1===(Bc>>31&1)?-1:1;const k=Bc&8388607;Bc=Bc>>23&255;256===Bc+1?Tc=k?Number.NaN:1===Tc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Bc?(Bc-=127,Tc=Tc*Vb(k,1)*Math.pow(2,Bc)):Tc=Tc*Vb(k,0)*Math.pow(2,-126);Db[Wb]=Tc}return Db},
Vb=(Ya,Db)=>{let Wb=0;for(let Bc=0;23>Bc;Bc++)Wb+=(Ya>>22-Bc&1)/Math.pow(2,Bc+1);return Db+Wb};class qc{constructor(Ya,Db){this.eDd=null;this.FBf=0;this.Jif=this.Iif=this.Kic=null;this.EBf=0;this.UEe=this.TEe=null;this.annotations=Db.annotations;let Wb=0;this.MYg=Ya.ma(Wb);++Wb;this.G0a=Ya.ma(Wb);++Wb;this.NYg=Ya.ma(Wb);++Wb;this.OYg=Ya.ma(Wb);++Wb;this.I0a=Ya.ma(Wb);++Wb;this.H0a=Ya.ma(Wb);++Wb;this.IYg=Ya.ma(Wb);++Wb;this.KYg=Ya.ma(Wb);++Wb;this.JYg=Ya.ma(Wb);++Wb;this.LYg=Ya.ma(Wb);++Wb;var Bc=
Ya.ma(Wb);++Wb;var Tc=Array(Bc);for(var id=0;id<Bc;++id)Tc[id]=Db.ha(Ya.ma(Wb)),++Wb;this.L8g=La.a.P8c(Tc);this.EMi=Ya.ma(Wb);++Wb;this.tfj=Ya.ma(Wb);++Wb;Bc=Ya.ma(Wb);++Wb;this.eRe={};for(Tc=0;Tc<Bc;++Tc){id=Db.ha(Ya.ma(Wb));++Wb;const k=Ya.ma(Wb);++Wb;this.eRe[id]=k}this.GBd=Ya.ma(Wb);++Wb;this.gNi=Ya.ma(Wb);++Wb;Bc=Ya.ma(Wb);++Wb;0<Bc&&(Bc=Db.uwa(Ya.ma(Wb)),++Wb,this.eDd=this.Dtc(new Nd(Bc)));++Wb;Ya=Db.uwa(Ya.ma(Wb));this.J9i(Ya)}Dtc(Ya){return new wd(Ya.array,Ya.offset)}J9i(Ya){try{const Db=
new Nd(Ya);this.FBf=Db.jL();1===Db.jL()?this.Kic=La.a.P8c(Ta(Db,this.FBf)):this.Kic=null;const Wb=Db.jL();this.Iif=this.Dtc(Db);Db.offset+=Wb;const Bc=Db.jL();this.Jif=this.Dtc(Db);Db.offset+=Bc;this.EBf=Db.jL();const Tc=Db.jL();this.TEe=this.Dtc(Db);Db.offset+=Tc;this.UEe=La.a.P8c(Ta(Db,this.EBf))}catch(Db){throw Error.argument("byteReader");}}}Object(c.a)(qc,"TfIdfRankerNLModuleInit",null,[]);class Ic{constructor(Ya,Db,Wb,Bc){this.XHd=Ya;this.S_e=Wb;this.tokens=Bc;this.OU=Db;this.Yeb=-1;this.Jzc=
0}}Object(c.a)(Ic,"TokenizerData",null,[]);class gd{constructor(Ya){this.Ea=Ya}execute(Ya){if(!Ya)throw Error.argumentNull("input");if(!({value:Bc}=Ya.fj(this.Ea.nia)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Db;({value:Db}=Ya.fj(this.Ea.lH)).returnValue||(Db=0);let Wb;({value:Wb}=Ya.fj(this.Ea.TJ)).returnValue||(Wb=Bc.length-Db);if(0>Db||Db>Bc.length)throw Error.argument("input","Start index out of range");if(0>Wb||Wb>Bc.length)throw Error.argument("input",
"Length out of range");if(Db+Wb>Bc.length)throw Error.argument("input","Bad start-length range");var Bc=new Ic(Bc,Db,Db+Wb,new V.a(this.Ea.annotations,y.Annotations.dC));this.p_j(Bc);Ya=Ya.isReadOnly?Ya.clone():Ya;Ya.Xn(this.Ea.saa,Bc.tokens);return Ya}p_j(Ya){for(;Ya.OU<Ya.S_e;){if(this.Ea.Hmd){var Db=this.Ea.Hmd.dwf(Ya.XHd,Ya.OU,Ya.S_e-Ya.OU,null);!Db.succeeded&&Db.TAf&&(Db=Db.TAf);if(Db.succeeded){this.sJf(Ya,Db.length,this.Ea.Lbf);Ya.OU+=Db.length;continue}}Db=Ya.XHd.substr(Ya.OU);let Wb=-1,Bc=
-1,Tc=-1;for(let id=0;id<this.Ea.Cyc.length;++id){const k=this.Ea.Cyc[id].exec(Db);k&&0<k[1].length&&(0>Wb||k[0].length>Bc)&&(Wb=id,Bc=k[0].length,Tc=k[1].length)}0<=Wb?(this.sJf(Ya,Tc,this.Ea.kRd[Wb]),Ya.OU+=Tc):Ya.OU+=1}}sJf(Ya,Db,Wb){if(this.Ea.opf)Wb!==gd.W3g&&(0>Ya.Yeb&&(Ya.Yeb=Ya.OU),Ya.Jzc=Ya.OU+Db-Ya.Yeb,Wb===gd.V3g&&(0<=Ya.Yeb&&0<Ya.Jzc&&(Db=new A.a(this.Ea.annotations),Db.Xn(this.Ea.lH,Ya.Yeb),Db.Xn(this.Ea.TJ,Ya.Jzc),Db.Xn(this.Ea.w1c,gd.X3g),Db.Xn(this.Ea.nia,Ya.XHd),Array.add(Ya.tokens.items,
Db)),Ya.Yeb=-1,Ya.Jzc=0));else{let Bc=new A.a(this.Ea.annotations);Bc.Xn(this.Ea.lH,Ya.OU);Bc.Xn(this.Ea.TJ,Db);Bc.Xn(this.Ea.w1c,Wb);Array.add(Ya.tokens.items,Bc)}}}gd.W3g="GAP";gd.V3g="EOS_CHUNK";gd.X3g="SENTENCE";Object(c.a)(gd,"TokenizerNLModule",null,[307]);class Kd{constructor(Ya,Db){this.TJ=this.lH=this.w1c=this.saa=this.nia=0;this.opf=!1;this.kRd=this.Cyc=this.Lbf=this.Hmd=null;if(Ya){this.annotations=Db.annotations;var Wb=0;try{this.nia=Ya.ma(Wb);++Wb;this.saa=Ya.ma(Wb);++Wb;this.w1c=Ya.ma(Wb);
++Wb;this.lH=Ya.ma(Wb);++Wb;this.TJ=Ya.ma(Wb);++Wb;this.opf=1===Ya.ma(Wb);++Wb;var Bc=Ya.ma(Wb);++Wb;0<Bc&&(this.Hmd=Db.hkd(Bc).xLh);this.Lbf=Ya.ma(Wb)?Db.ha(Ya.ma(Wb)):"";++Wb;const Tc=Ya.ma(Wb);++Wb;this.Cyc=Array(Tc);this.kRd=Array(Tc);for(Bc=0;Bc<Tc;++Bc)this.Cyc[Bc]=new RegExp(Db.ha(Ya.ma(Wb))),++Wb,this.kRd[Bc]=Db.ha(Ya.ma(Wb)),++Wb}catch(Tc){throw Error.argument("initData");}}}}Object(c.a)(Kd,"TokenizerNLModuleInit",null,[]);class oe{constructor(Ya){this.Ea=Ya}execute(Ya){if(!Ya)throw Error.argumentNull("input");
let Db;if(!({value:Db}=Ya.fj(this.Ea.Wye)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Wb of this.Ea.wYd)Db=Wb.apply(Db);Ya=y.Annotations.ZA(Ya);Ya.Xn(this.Ea.Xye,Db);return Ya}static G0c(Ya,Db){const Wb=new Sys.StringBuilder;for(let Bc=0;Bc<Ya.length;++Bc)Wb.append(Db(Ya.substr(Bc,1)));return Wb.toString()}}Object(c.a)(oe,"TransliteratorNLModule",null,[307]);class Ce{constructor(Ya){Ya&&(this.style=Ya.ma(0))}apply(Ya){return oe.G0c(Ya,
Db=>Ce.e7g(Db,this.style))}static e7g(Ya,Db){switch(Db){case 0:return Ya.toLowerCase();case 1:return"I"===Ya?"\u0131":Ya.toLowerCase();case 2:return Ya.toUpperCase();case 3:return"i"===Ya?"\u0130":Ya.toUpperCase();default:throw Error.invalidOperation();}}}Ce.HIa=0;Object(c.a)(Ce,"ChangeCaseTransliterationStage",null,[319]);class ze{apply(Ya){return oe.G0c(Ya,ze.p0j)}static p0j(Ya){const Db=Ya.charCodeAt(0);return 65281<=Db&&65374>=Db?String.fromCharCode(Db-65248):Ya}}ze.HIa=4;Object(c.a)(ze,"LatinFullWidthToHalfWidthTransliterationStage",
null,[319]);class af{constructor(Ya,Db){Ya&&(this.IMd=Db.w9e(Ya.ma(0)),this.Bsj=Db.ha(Ya.ma(1)))}apply(Ya){return Ya.replace(this.IMd,this.Bsj)}}af.HIa=1;Object(c.a)(af,"RegexReplaceTransliterationStage",null,[319]);class Za{constructor(Ya,Db){if(Ya){var Wb=Ya.ma(0),Bc=Db.ha(Ya.ma(1)),Tc=new wd(Db.uwa(Ya.ma(2)));Ya=0>Ya.ma(3)?null:new wd(Db.uwa(Ya.ma(3)));this.tZd={};for(Db=0;Db<Wb;++Db)this.tZd[Bc.charAt(Db).toString()]=Bc.substr(Tc.ma(Db),Ya?Ya.ma(Db):1)}}apply(Ya){return oe.G0c(Ya,Db=>Db in this.tZd?
this.tZd[Db]:Db)}}Za.HIa=2;Object(c.a)(Za,"SingleCharSubstitutionsTransliterationStage",null,[319]);class Rb{constructor(Ya,Db){this.Xye=this.Wye=0;this.wYd=null;if(Ya){this.annotations=Db.annotations;var Wb=0;try{this.Wye=Ya.ma(Wb);++Wb;this.Xye=Ya.ma(Wb);++Wb;const Bc=Ya.ma(Wb);++Wb;this.wYd=Array(Bc);for(let Tc=0;Tc<Bc;++Tc){const id=Ya.ma(Wb);++Wb;const k=Ya.ma(Wb);++Wb;const Ob=new La.a;Ob.jwa(Ya,Wb,k);Wb+=k;this.wYd[Tc]=this.R9i(id,Ob,Db)}}catch(Bc){throw Error.argument("initData");}}}R9i(Ya,
Db,Wb){switch(Ya){case Ce.HIa:return new Ce(Db);case af.HIa:return new af(Db,Wb);case Za.HIa:return new Za(Db,Wb);case ze.HIa:return new ze;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(c.a)(Rb,"TransliteratorNLModuleInit",null,[]);class rc{f3h(Ya,Db){const Wb=Ya.ma(0),Bc=new La.a;Bc.jwa(Ya,1,Ya.count-1);switch(Wb){case 0:return new we(new zc(Bc,Db));case 2:return new gd(new Kd(Bc,Db));case 3:return new Td(new ie(Bc,Db));case 5:return new Ze(new ec(Bc,
Db));case 9:return new oe(new Rb(Bc,Db));case 10:return new Md(new qc(Bc,Db));default:throw Error.notImplemented();}}}Object(c.a)(rc,"NLModuleFactory",null,[288]);class Jc{constructor(Ya){this.T3g=";";if(!Ya)throw Error.argumentNull("resource");this.MR=new We(Ya,new ra,new rc);this.pAd=this.MR.Q2h();this.uwf=this.MR.annotations.Mxb("Text.Text");this.swf=this.MR.annotations.Mxb("Classification.Predictions");this.Zzd=this.MR.annotations.Mxb("Classification.PredictionString");this.twf=this.MR.annotations.Mxb("Classification.Probability");
this.FKi=this.MR.annotations.Mxb("NLMod.Tokens");if(0>this.uwf||0>this.swf||0>this.Zzd||0>this.twf)throw Error.argument("resourceObj","Resource does not represent a ranker");}nUh(){const Ya=[];this.Tdd(void 0,this.v3e(Ya),null);return Ya}pUh(Ya,Db){const Wb=[],Bc=[];this.Tdd(Ya,this.v3e(Wb),(Tc,id)=>{const k=this.MR.annotations.m3e(Tc),Ob=[],kc=[];Db&&Db.length&&-1===Array.indexOf(Db,k)||(Tc=this.MR.annotations.getAttributeType(Tc),this.YQf(Tc,id,Ob,kc),id=new $e(k,Ob,kc),Array.add(Bc,id))});return new Qe(Wb,
Bc)}oUh(Ya){const Db=[];this.Tdd(Ya,Wb=>{let Bc;if(({value:Bc}=Wb.fj(this.Zzd)).returnValue){let Tc;({value:Tc}=Wb.fj(this.twf)).returnValue&&Array.add(Db,new Ae(Bc,Tc))}},null);return Db}Tdd(Ya,Db,Wb){var Bc=new A.a(this.MR.annotations);Bc.Xn(this.uwf,Ya);Ya=this.pAd.execute(Bc);if(({value:Bc}=Ya.fj(this.swf)).returnValue)for(const Tc of Bc.items)Db(Tc);if(Wb&&({value:Db}=Ya.fj(this.FKi)).returnValue)for(const Tc of Db.items)Tc.Scc(Wb)}YQf(Ya,Db,Wb,Bc){if(y.Annotations.ju(Ya))for(var Tc of Db.items)this.YQf(Db.tI,
Tc,Wb,Bc);else if(y.Annotations.flg(Ya)){Tc=this.MR.annotations.m8e(Ya);for(let id=0;id<Tc;id++)Array.add(Wb,this.MR.annotations.Z$e(Ya,id)),Array.add(Bc,this.MR.annotations.kP(this.MR.annotations.DMa(Ya,id),Db.Fwa(id)))}else Array.add(Wb,"VALUE"),Array.add(Bc,this.MR.annotations.kP(Ya,Db))}v3e(Ya){return Db=>{let Wb;({value:Wb}=Db.fj(this.Zzd)).returnValue&&Array.add(Ya,this.j5h(Wb))}}j5h(Ya){const Db=Ya.indexOf(this.T3g);return 0>Db?Ya:Ya.substring(0,Db)}}Object(c.a)(Jc,"Ranker",null,[]);var Sb=
a(781),Cc=a(797),cd=a(6);class Wd{constructor(Ya,Db){this.Afe="";this.aUc=null;this.bUc=!1;this.aY=null;this.mxg=["TellMe.TellMeParamCollection"];this.Ta=Ya;this.$ga=Db;this.Ta.eIa&&(this.aY=null)}get bvc(){if(!this.aUc&&!this.bUc){let Ya=null;try{Ya=window.TellMeModel}catch(Db){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("QueryRanker","TellMeModel not found. Exception: "+Db)}if(Ya){try{this.aUc=new Jc(Ya)}catch(Db){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("QueryRanker",
"Exception thrown while loading classifier. Exception: "+Db)}this.bUc=!0}else if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("QueryRanker","Classifier model not found")}return this.aUc}Qw(){return"Command"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(Ya,Db,Wb=!1,Bc=b.a.tellMe,Tc=null){const id=new r.a(Ya);if((!Tc||Array.contains(Tc,0))&&!u.a.Nz(Ya)){if(!this.bvc&&this.bUc){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("CRASH","CommandResultsProvider: Found invalid Model data");
throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.Ta.eIa&&this.aY&&this.aY.initialize();if(Sb.CommandResultsUtility.Vrd(Ya.Rd)&&(Tc=Sb.CommandResultsUtility.w4e(Ya.Rd),0<Tc.results.length)){Tc.displayName="Classifier Debug";id.Ml(Tc);Db.resultsUpdated(id);return}Tc=Ya?this.Afe=Ya.Rd:this.Afe;if(cd.AFrameworkApplication.fa.ra("TellMeParameterizedQueriesEnabled")){Tc=this.l5h(Tc);var k=this.Xdc(Tc.Mkd());Tc=Tc.W2e()}else Tc=this.k5h(Tc),k=this.EWh(Tc),Tc=[];Sb.CommandResultsUtility.$nc(k,
!1,"Classifier","TFIDF");k=Sb.CommandResultsUtility.kzb(Ya,k,this.Ta,this.aY,this.$ga,Tc,0,1);0<k.results.length&&Bc!==b.a.contextMenu&&(k.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Wb||k.results.length||this.Ta.Mxa||this.Ta.Gpa||(Ya=new d.a("lookupNoResults",14,Ya.Rd,null,1),k.Xl(Ya));0<k.results.length&&id.Ml(k);id.attributes=Tc}Db.resultsUpdated(id)}Mkd(){let Ya=[];try{Ya=this.bvc.nUh()}catch(Db){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("GetPredictions","Exception: "+
Db)}return Ya}k5h(Ya){let Db=[];try{Db=this.bvc.oUh(Ya)}catch(Wb){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("GetPredictionsWithScore","Exception: "+Wb)}return Db}l5h(Ya){try{return this.bvc.pUh(Ya,this.mxg)}catch(Db){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("GetPredictionsWithTokenAttributes","Exception: "+Db)}return new Qe([],[])}Xdc(Ya){const Db=[];if(Ya)for(const Wb of Ya)Db.push(new Cc.a(Wb,-99999));return Db}EWh(Ya){const Db=[];if(Ya)for(const Wb of Ya)Db.push(new Cc.a(Wb.prediction,
Wb.score));return Db}}Object(c.a)(Wd,"CommandResultsProvider",null,[202]);var je=a(926),Ee=a(34);class Ue{constructor(Ya,Db,Wb,Bc){this.YG=Ya;this.ata=Db;this.qoe=Bc;this.TAg=Wb;this.Ta=l.TellMeActor.instance.ty()}Qw(){return"EmptyQuery"}tD(){return 1===this.Ta.zl?1:0}Pu(Ya,Db,Wb=!1,Bc,Tc=null){Bc=new r.a(Ya);if((!Tc||Array.contains(Tc,5)||Array.contains(Tc,6)||Array.contains(Tc,4))&&u.a.Nz(Ya)){this.YG.zwa().length||!this.TAg||this.qoe||(Ya=new h.a(6),Tc=new d.a(null,13,void 0,void 0,1),Ya.Xl(Tc),
Bc.Ml(Ya));Ya=new h.a(4);if(0<this.YG.zwa().length){Ya.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;Tc=this.YG.zwa();var id=[];for(var k of Tc)id.push(k.Id);Sb.CommandResultsUtility.Mmg(id,this.Ta);for(var Ob of Tc)Sb.CommandResultsUtility.Zxa(Ob.Id)&&Ya.Xl(new d.a(Ob.Id,5,null,null,2));Bc.Ml(Ya)}if(this.qoe&&0<this.ata.length&&this.YG.zwa().length<Ue.uyf){k=new h.a(5);k.displayName=CommonUIStrings.l_TellMeTryQueryTitle;Ob=Ue.uyf-Ya.results.length;Ya=[];for(Tc=0;Tc<this.ata.length&&Tc<Ob;++Tc){if(Wb){id=
u.a.u1d+(Tc+1);const kc=this.ata[Tc].key,wc=Ee.a.replaceAll(kc,'"',"");Ya.push(appChrome.actions.setControlLabel(id,kc));Ya.push(appChrome.actions.setButtonCommandValueId(id,wc));id=new je.a(kc,7,0,wc,id)}else id=new je.a(this.ata[Tc].key,7,0,this.ata[Tc].value);k.Xl(id)}0<Ya.length&&appChrome.api.dispatch(Ya);Bc.Ml(k)}}Db.resultsUpdated(Bc)}}Ue.uyf=5;Object(c.a)(Ue,"EmptyQueryResultsProvider",null,[202]);class gf{constructor(Ya){this.Ta=Ya}Qw(){return"Feedback"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?
1:2}Pu(Ya,Db,Wb,Bc,Tc=null){Ya=new r.a(Ya);if(!Tc||Array.contains(Tc,21))Tc=[],Tc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Tc),Tc=new h.a(22),Tc.displayName="",Tc.Xl(new d.a("TellMeFeedback",23,null,null,1)),Ya.Ml(Tc);Db.resultsUpdated(Ya)}}Object(c.a)(gf,"FeedbackResultsProvider",null,[202]);class rf{constructor(Ya,Db,Wb,Bc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Ya;this.CommandId=Db;
this.CommandValueId=Wb;this.InputText=Bc}}Object(c.a)(rf,"FindInDocumentProp",null,[]);class xf{constructor(Ya){this.URc=2;this.fGa=[];this.osa=[];this.Ta=Ya;xf.a5=Ya.u_e;xf.w_e="FindInDocumentSuggestion";xf.eQf="FindInDocumentSuggestion3";this.WDg=Object.assign(new v.a,{landingTab:"Indoc",data:null});this.PHg=this.Ta.Mfb||!!cd.AFrameworkApplication.sa&&cd.AFrameworkApplication.sa.Pa.Mfb}Qw(){return"FindInDocument"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:3===this.Ta.zl?this.Ta.eeg?2:3:2}Pu(Ya,
Db,Wb=!1,Bc,Tc=null){const id=new r.a(Ya);if(Tc&&!Array.contains(Tc,2))Db.resultsUpdated(id);else if(Array.clear(this.fGa),u.a.Nz(Ya)){if(Wb&&this.Gbg()){Wb=new h.a(2);Wb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Tc=1;Bc="";if(0<this.osa.length&&!this.Ta.Ofb)for(var k of this.osa)if(""!==k.Label.toLowerCase()){if(Tc>=this.URc)break;this.dog(Wb,k.Label,k.CommandValueId,xf.w_e+Tc,k.InputText);Tc++}k="";this.Ta.Sy?(id.Ml(Wb),Wb=new h.a(3),k=this.Ta.Pta?u.a.swa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):k=CommonUIStrings.l_TellMeOpenFindPaneText;Bc=this.v4e("");this.dog(Wb,k,Bc,xf.eQf,"");id.Ml(Wb)}Db.resultsUpdated(id)}else k="",Wb&&(Wb=this.v4e(Ya.Rd),Bc=[],this.Ta.Hya?(this.Ta.AWd&&Bc.push(appChrome.actions.setControlIconSet(xf.a5,{"default":"FindInDocument_20"})),k=this.Ta.Dvd?u.a.qjd(Ya.Rd,CommonUIStrings.l_FindInDocumentScopedButtonText):Ya.Rd+CommonUIStrings.l_FindInDocumentScopedButtonText):this.Ta.Sy?(k=this.Ta.Pta?u.a.swa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
Ya.Rd)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,Ya.Rd),Bc.push(appChrome.actions.setControlIconSet(xf.a5,{"default":"FindInDocument_20"}))):k=this.Ta.Ofb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,Ya.Rd),this.Ta.p_?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(xf.a5,k)),l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(xf.a5,Wb))):(Bc.push(appChrome.actions.setControlLabel(xf.a5,
k)),Bc.push(appChrome.actions.setButtonCommandValueId(xf.a5,Wb)),appChrome.api.dispatch(Bc)),this.i9f(k,xf.a5,Wb,Ya.Rd)),this.Ta.eeg?(k=new d.a(xf.a5,8,Ya.Rd),Wb=new h.a(2),Wb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,Wb.Xl(k),id.Ml(Wb),Db.resultsUpdated(id)):this.Ta.XZh().then(Ob=>{const kc=new d.a(xf.a5,8,Ya.Rd,null,1);kc.count=Ob;Ob=new h.a(2);Ob.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ob.Xl(kc);id.Ml(Ob);Db.resultsUpdated(id)},Ob=>{l.TellMeActor.instance.sc.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+Ob);Ob=new d.a(xf.a5,8,Ya.Rd,null,1);const kc=new h.a(2);kc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;kc.Xl(Ob);id.Ml(kc);Db.resultsUpdated(id)})}Gbg(){return!!this.Ta&&this.Ta.GBc}dog(Ya,Db,Wb,Bc,Tc=null){const id=[];Db&&id.push(appChrome.actions.setControlLabel(Bc,Db));this.Ta.Sy&&id.push(appChrome.actions.setControlIconSet(Bc,{"default":"FindInDocument_20"}));id.push(appChrome.actions.setButtonCommandValueId(Bc,Wb));appChrome.api.dispatch(id);
this.i9f(Db,Bc,Wb,"");Ya.Xl(new d.a(Bc,8,Tc,null,1,-99999))}v4e(Ya){return this.PHg?u.a.nja(Ya,15,this.WDg):Ee.a.kf(Ya)}i9f(Ya,Db,Wb,Bc){this.Gbg()&&this.fGa.length<this.URc&&(Ya=new rf(Ya,Db,Wb,Bc),Array.add(this.fGa,Ya))}bGj(Ya){for(let Db=0;Db<this.fGa.length;Db++)if(this.fGa[Db].CommandId===Ya){const Wb=this.fGa[Db].Label;let Bc=!1;if(0<this.osa.length){let Tc=0;for(const id of this.osa){if(id.Label===Wb){Array.removeAt(this.osa,Tc);Bc=!0;break}Tc++}}!Bc&&this.osa.length>=this.URc-1&&Array.removeAt(this.osa,
1);Array.insert(this.osa,0,this.fGa[Db])}}}xf.a5=null;xf.w_e=null;xf.eQf=null;Object(c.a)(xf,"FindInDocumentResultsProvider",null,[202]);var Vf=a(1068);class Bb{constructor(Ya){this.Ta=Ya}Qw(){return"Insights"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(Ya,Db,Wb=!1,Bc,Tc=null){Bc=new r.a(Ya);if(!Tc||Array.contains(Tc,13))if(this.gNj()||!u.a.Nz(Ya)){Tc=new h.a(13);var id=""===Ya.Rd.trim(),k=id?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Ob=new d.a(k,10,Ya.Rd,null,1);Wb&&(Wb=null,
u.a.zR()?id?id=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(id=this.Ta.Ofb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Ya.Rd),Wb=u.a.nja(Ya.Rd,1)):(id=String.format(CommonUIStrings.l_InsightsButtonText,Ya.Rd),Wb=u.a.X8c(Ya.Rd)),this.Ta.p_?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(k,id)),Wb&&l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Wb))):
(Ya=[],Ya.push(appChrome.actions.setControlLabel(k,id)),Wb&&Ya.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Wb)),appChrome.api.dispatch(Ya)),Ob.label=id);Tc.Xl(Ob);Bc.Ml(Tc)}Db.resultsUpdated(Bc)}gNj(){return u.a.zR()&&this.Ta.HXj&&!this.Ta.HQ}}Object(c.a)(Bb,"InsightsResultsProvider",null,[202]);var ac=a(1066);class tc{constructor(Ya){this.Ta=Ya}Qw(){return"Learning"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(Ya,Db,Wb,Bc,Tc=null){Wb=new r.a(Ya);Tc&&!Array.contains(Tc,
21)||!u.a.Nz(Ya)||(Tc=[],Bc=this.Ta.XEi,Tc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Bc)),Bc=tc.F_h(Bc),Tc.push(appChrome.actions.setControlLabel("LearningForSearch",Bc)),appChrome.api.dispatch(Tc),Ya=new d.a("LearningForSearch",22,Ya.Rd,null,1),Tc=new h.a(21),Tc.Xl(Ya),Wb.Ml(Tc));Db.resultsUpdated(Wb)}static F_h(Ya){const Db=[];Array.add(Db,new ac.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Db,new ac.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Db,new ac.a(600,Ya));Array.add(Db,new ac.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Ya={};Ya.parts=Db;return JSON.stringify(Ya)}}Object(c.a)(tc,"LearningProvider",null,[202]);var ub=a(464);class jc{constructor(Ya,Db){this.qYa=this.VZa=this.Bsa=this.GXb=null;this.sC=!1;this.JYa=Ya;this.lzg=Db;Ya&&this.kZe(Ya)}qFc(){this.JYa.qFc()&&this.kZe(this.JYa)}y9h(Ya){let Db=[];var Wb=[];Ya=jc.bRi(Ya);var Bc="";Array.clear(Wb);for(let Tc=0;Tc<Ya.length;Tc++){const id=Ya.charAt(Tc);-1!==
" ".indexOf(id)?(Bc.length&&Array.add(Wb,Bc),Bc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(id)?(Bc.length&&Array.add(Wb,Bc),Bc=id,Array.add(Wb,Bc),Bc=""):Bc+=id}Bc.length&&Array.add(Wb,Bc);for(Ya=0;Ya<Wb.length;Ya++)Bc=this.DWh(Wb[Ya]),Bc=this.keh(Bc),Db=jc.QNi(Db,Bc);return Db=this.iOg(Db)}P8a(){this.sC||this.qFc();return this.sC}d9b(Ya){return this.GXb[Ya.toString()]}iOg(Ya){for(let Db=0;Db<Ya.length;Db++){const Wb=this.Bsa[Db];if(Ya[Db].commandId!==this.d9b(Wb[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Bc;(Bc=Ya[Db]).score=Bc.score+Wb[1]}return Ya}keh(Ya){const Db=[];for(var Wb=0;Wb<this.Bsa.length;Wb++)Db.push(new Cc.a(this.d9b(this.Bsa[Wb][0]),-5));Wb=new ub.a;for(var Bc=0;Bc<Ya.length;Bc++)Wb.add(this.d9b(Ya[Bc][0]));for(Bc=0;Bc<Db.length;Bc++){const id=Db[Bc];for(let k=0;k<Ya.length;k++){var Tc=Ya[k];const Ob=this.d9b(Tc[0]);Tc=Tc[1];if(Ob===id.commandId){id.score=Tc;Wb.remove(Ob);break}}if(!Wb.count)break}return Db}DWh(Ya){const Db=1>Ya.length;for(let k=0;2>=k;k++){const Ob=this.qYa;for(let kc in Ob){var Wb=
Ob[kc],Bc=Ya,Tc=kc;const wc=Tc.length+1,ad=Array((Bc.length+1)*wc);for(var id=0;id<=Bc.length;id++)ad[id*wc]=id;for(id=0;id<=Tc.length;id++)ad[id]=id;for(id=0;id<Tc.length;id++)for(let sd=0;sd<Bc.length;sd++)ad[(sd+1)*wc+(id+1)]=Bc.charAt(sd)===Tc.charAt(id)?ad[sd*wc+id]:Math.min(Math.min(ad[sd*wc+(id+1)]+1,ad[(sd+1)*wc+id]+1),ad[sd*wc+id]+1);Bc=ad[Bc.length*wc+Tc.length];if((!Bc||!Db)&&Bc<=k)return Wb}}return this.VZa}kZe(Ya){this.GXb=Ya.gkd();this.Bsa=Ya.F5h();this.VZa=Ya.X$h();this.qYa=Ya.G1h();
if(this.sC=!!this.GXb&&!!this.Bsa&&!!this.qYa&&!!this.VZa)this.sC=0<this.Bsa.length&&jc.srd(this.Bsa);this.sC&&(this.sC=0<this.VZa.length&&jc.srd(this.VZa));this.sC&&(this.qYa=jc.Bai(this.qYa));this.sC||(this.qYa=this.VZa=this.Bsa=this.GXb=null)}G$h(Ya){Ya=this.y9h(Ya);return this.oLh(Ya,this.lzg)}oLh(Ya,Db){let Wb=[];for(let Bc=0;Bc<Ya.length;Bc++)Ya[Bc].score>=Db&&Wb.push(Ya[Bc]);Wb.sort((Bc,Tc)=>Bc.score<Tc.score?1:Bc.score>Tc.score?-1:0);0<Wb.length-10&&(Wb=Wb.slice(0,10));return Wb}static QNi(Ya,
Db){if(!Ya.length)return Db;if(Ya.length!==Db.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Wb=0;Wb<Ya.length;Wb++){if(Ya[Wb].commandId!==Db[Wb].commandId)throw Error.create("Incorrect CommandId");let Bc;(Bc=Ya[Wb]).score=Bc.score+Db[Wb].score}return Ya}static bRi(Ya){return Ee.a.Ok(Ya)}static srd(Ya){for(let Db=0;Db<Ya.length;Db++)if(2!==Ya[Db].length)return!1;return!0}static Bai(Ya){const Db={};for(let Tc in Ya){var Wb=Tc,Bc=Ya[Tc];
const id=Bc;id.length&&jc.srd(id)&&(Db[Wb]=Bc)}return Db}}Object(c.a)(jc,"NaiveBayesClassifierModel",null,[]);class Ka{constructor(Ya,Db){this.aY=null;this.Ta=Ya;this.Amb=new jc(Db,Ya.P7e);this.Ta.eIa&&(this.aY=null)}Qw(){return"NBCommand"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(Ya,Db,Wb=!1,Bc=b.a.tellMe,Tc=null){const id=new r.a(Ya);if((!Tc||Array.contains(Tc,0))&&!u.a.Nz(Ya)){if(Sb.CommandResultsUtility.Vrd(Ya.Rd)&&(Tc=Sb.CommandResultsUtility.w4e(Ya.Rd),0<Tc.results.length)){Tc.displayName=
"Classifier Debug";id.Ml(Tc);Db.resultsUpdated(id);return}if(!this.Amb.P8a()){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.Ta.eIa&&this.aY&&this.aY.initialize();Tc=this.Amb.G$h(Ya.Rd);Sb.CommandResultsUtility.$nc(Tc,!1,"Classifier","NaiveBayesian");Tc=Sb.CommandResultsUtility.kzb(Ya,Tc,this.Ta,this.aY,null,null,0,1);0<Tc.results.length&&
Bc!==b.a.contextMenu&&(Tc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Wb||Tc.results.length||this.Ta.Mxa||this.Ta.Gpa||(Ya=new d.a("lookupNoResults",14,Ya.Rd,null,1),Tc.Xl(Ya));0<Tc.results.length&&id.Ml(Tc)}Db.resultsUpdated(id)}}Object(c.a)(Ka,"NaiveBayesCommandProvider",null,[202]);class zb{constructor(){this.dGa=null;this.sC=!1;this.qFc()}qFc(){this.sC||(this.dGa=window.NBCRM)&&4===this.dGa.length&&(this.sC=!0);return this.sC}F5h(){return this.sC?this.dGa[1]:null}X$h(){return this.sC?
this.dGa[2]:null}G1h(){return this.sC?this.dGa[3][0]:null}gkd(){return this.sC?this.dGa[0][0]:null}}Object(c.a)(zb,"NaiveBayesModelAdapter",null,[240]);var Yb=a(182);class oc{constructor(Ya){this.Ta=Ya}Qw(){return"OfficeScript"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(Ya,Db){const Wb=new r.a(Ya);if(!u.a.Nz(Ya)){Ya=Yb.d(Ya.Rd);var Bc=new h.a(28);Bc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Bc=this.ese(Ya,oc.F3j,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
Bc);Bc=this.ese(Ya,oc.yPh,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Bc);Wb.Ml(Bc)}Db.resultsUpdated(Wb)}ese(Ya,Db,Wb,Bc,Tc,id){const k=[];for(const Ob of Db)if(Yb.a(Ya,Ob)){this.Ta.p_?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Wb,Tc)),l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Wb,Bc))):(k.push(appChrome.actions.setControlLabel(Wb,Tc)),k.push(appChrome.actions.setButtonCommandValueId(Wb,Bc)),
appChrome.api.dispatch(k));id.Xl(new d.a(Wb,28,null,null,1));break}return id}}oc.F3j="unhide row rows col cols column columns".split(" ");oc.yPh=["freeze","selection","pane","panes"];Object(c.a)(oc,"OfficeScriptsSamplesProvider",null,[202]);var Wc=a(198),vd=a(341),Dd=a(827),be=a(768),se=a(826),Oe=a(42),Me=a(181),Ia=a(719);class Jb{constructor(Ya){this.gz=null;this.KG=-1;this.fBd=14;this.iBd=12;this.attributes=this.nXc=this.query=null;this.c9a=!1;this.iZa=[];this.zh=cd.AFrameworkApplication.Od;cd.AFrameworkApplication.fa&&
(this.fBd=cd.AFrameworkApplication.fa.Dd("TellMeMaxTermedResults",this.fBd),this.iBd=cd.AFrameworkApplication.fa.Dd("TellMeMaxZeroTermResults",this.iBd));this.BB=Ya}get Bh(){return this.iZa}get DFc(){return this.nXc}Ml(Ya){let Db=!1;for(let Wb=0;Wb<this.Bh.length;Wb++)if(30!==this.Bh[Wb].groupType&&this.Bh[Wb].groupType===Ya.groupType){this.wZc(this.Bh[Wb],Ya);Db=!0;break}Db||this.Bh.push(Ya)}wZc(Ya,Db){for(let Wb=0;Wb<Db.results.length;Wb++)Ya.Xl(Db.results[Wb])}lZf(Ya){const Db=[];for(const Wb of this.Bh)Wb.groupType!==
Ya&&Db.push(Wb);this.Bh.length!==Db.length&&(this.iZa=Db)}joj(Ya){let Db=null,Wb=null,Bc=null;for(let Tc=0;Tc<Ya.length;Tc++){const id=Ya[Tc];if(id&&id.Bh&&id.Bh.length)for(const k of id.Bh)if(17===k.groupType||18===k.groupType)Db=k;else if(0===k.groupType||16===k.groupType)Wb=k,Bc=id}Db&&Wb&&0<Wb.results.length&&(17===Db.groupType&&({gZc:Wb,CZc:Db}=Sb.CommandResultsUtility.jNg(Wb,Db,this.BB.ty()?this.BB.ty().dWh:-.6)),Bc.lZf(Wb.groupType))}JSj(){new Wc.a;this.SPb(this.BB.rxf)}KDb(Ya,Db){return this.query.Rd.length>
this.BB.ty().Q5h&&this.Pxi(Ya,Db)||this.query.Rd.length>this.BB.ty().R5h&&this.DAi(Ya,Db)?!0:!1}DAi(Ya,Db){return Ya&&Ya.length&&Db&&Db.length?-1===Db.toLowerCase().indexOf(Ya.toLowerCase())?!1:!0:!1}Pxi(Ya,Db){return Ya&&Ya.length&&Db&&Db.length?Db.toLowerCase().startsWith(Ya.toLowerCase()):!1}uLh(Ya){const Db=[];for(const Wb of this.BB.ty().Sy?this.DFc:this.Bh)Ya.contains(Wb.groupType)||Db.push(Wb);this.BB.ty().Sy?this.nXc=Db:this.iZa=Db}m8j(Ya,Db){const Wb=[];for(const Bc of this.Bh){const Tc=
Bc;if(13!==Tc.groupType||24!==Tc.groupType){const id=Ya[be.a[Tc.groupType].toLowerCase()];let k="False";id<Db&&(k="True");Tc.displayName=Tc.displayName+" ("+k+": "+id+")"}Wb.push(Tc)}this.iZa=Wb}SPb(Ya,Db=!1,Wb=null){if(this.BB.ty().Sy){if(!Db)for(this.nXc=Array(this.Bh.length),Db=0;Db<this.Bh.length;Db++)this.DFc[Db]=this.Bh[Db];this.BB.Axf.SPb(this.Bh,this.DFc,this.query,Ya,Wb)}else{for(Wb=new Wc.a;this.Bh.length;){Db=this.Bh.pop();const Bc=be.a[Db.groupType].toLowerCase(),Tc=Ya[Bc];if(Ia.c(Tc))throw Error.create("GroupId "+
Bc+" missed from group SortingOrder");Wb.add(new vd.a(Tc,Db))}Wb.Sc((Bc,Tc)=>Bc.key<Tc.key?-1:1);for(Ya=0;Ya<Wb.count;Ya++)Db=Wb.ma(Ya).value,this.Bh.push(Db)}}KSj(){var Ya=!1;let Db=!1,Wb=!1;for(let Tc=0;Tc<this.Bh.length;Tc++){var Bc=this.Bh[Tc];const id=Bc.groupType;if(8===id||15===id||14===id){Bc=Bc.results;for(let k=0;k<Bc.length;k++){if(8===id&&this.KDb(this.query.Rd,Bc[k].label)){Ya=!0;break}if(15===id&&this.KDb(this.query.Rd,Bc[k].label)){Db=!0;break}if(14===id){if(this.KDb(this.query.Rd,
Bc[k].label)||this.KDb(this.query.Rd,Bc[k].description)){Wb=!0;break}const Ob=Bc[k].label.split(" ");for(const kc of Ob)if(this.KDb(this.query.Rd,kc)){Wb=!0;break}}}}}Ya=this.BB.s7h(Ya,Db,Wb);this.SPb(Ya)}MQa(Ya,Db,Wb,Bc,Tc,id){if(Tc===this.gz){var k=Ya.data.te;Tc=null;try{Tc=Oe.b(k)}catch(De){l.TellMeActor.instance.sc.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+De);return}if("RankerResults"in Tc&&Tc.RankerResults){this.a4();var Ob=Tc.RankerResults,
kc=new Wc.a,wc=new Wc.a;k=0;for(var ad of Ob){Ob=ad.ProviderId;var sd=ad.Score;k+=sd;kc.add(new vd.a(Ob,sd))}kc.Sc((Pe,Xe)=>Pe.value>Xe.value?-1:1);sd=id?id.g8h:1E-6;ad={};Ob={};let De=0;for(var Gd=0;Gd<kc.count;Gd++){let Pe=parseInt(kc.ma(Gd).key),Xe=kc.ma(Gd).value/k;1===Pe&&(Ob.answer=De++,Ob.entity=De++,Ob.definition=De++,Ob.wolframanswer=De++,Xe<sd&&(wc.add(9),wc.add(11),wc.add(10),wc.add(12)),ad.answer=Xe,ad.entity=Xe,ad.definition=Xe,ad.wolframanswer=Xe);2===Pe&&(Ob.assistance=De++,Xe<sd&&
wc.add(8),ad.assistance=Xe);3===Pe&&(Ob.classifier=De++,Ob.serviceclassifier=De++,Xe<sd&&(wc.add(0),wc.add(17)),ad.classifier=Xe,ad.serviceclassifier=Xe);4===Pe&&(Ob.people=De++,Xe<sd&&wc.add(14),ad.people=Xe);5===Pe&&(Ob.document=De++,Xe<sd&&wc.add(15),ad.document=Xe);6===Pe&&(Ob.findindocument=De++,Xe<sd&&wc.add(2),ad.findindocument=Xe);7===Pe&&(Ob.notes=De++,Xe<sd&&wc.add(20),ad.notes=Xe);8===Pe&&(Ob.image=De++,Xe<sd&&wc.add(19),ad.image=Xe)}kc=new Wc.a;kc.add("classifier");kc.add("serviceclassifier");
kc.add("appsforoffice");kc.add("addin");kc.add("findindocument");kc.add("assistance");kc.add("document");kc.add("people");kc.add("answer");kc.add("wolframanswer");kc.add("definition");kc.add("entity");kc.add("image");kc.add("template");kc.add("officescript");for(Gd=0;Gd<kc.count;Gd++)kc.ma(Gd)in Ob||(Ob[kc.ma(Gd)]=De++);Ob.learning=De++;Ob.insights=De++;Ob.actionai=De++;Ob.actionaicommand=De++;Ob.feedback=De++;id&&id.Iwi&&this.m8j(ad,sd);id&&id.Jwi&&this.uLh(wc);wc={};for(var Yd in ad)wc[Yd]=ad[Yd]*
k;this.SPb(Ob,!0,wc)}if(id.gvd&&"Intents"in Tc&&Tc.Intents){Yd=Tc.Intents;for(var ve of Yd)if(this.dwd(ve)&&"Serplet"===ve.GroupType&&ve.ConfidenceScore>ve.ConfidenceThreshold){Yd=!1;Tc=0;if(id.hvd){k=new d.a("",32);for(wc=0;wc<this.Bh.length;wc++)if((kc=this.Bh[wc].results)&&0<kc.length){Tc=wc;k=kc[0];break}2===k.groupType&&(Yd=!0)}k=new h.a(13);Yd&&id.hvd&&(k=new h.a(13,CommonUIStrings.l_TellMeWebTitle));wc=new d.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Rd,null,0);kc=[];ad=null;ad=
u.a.zR()?u.a.nja(this.query.Rd,1):u.a.X8c(this.query.Rd);kc.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",ad));ad=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Rd);kc.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",ad));appChrome.api.dispatch(kc);k.Xl(wc);wc=[];if(Yd&&id.hvd)for(wc.push(this.Bh[Tc]),wc.push(k),Yd=Tc+1;Yd<this.Bh.length;Yd++)(Tc=this.Bh[Yd].results)&&0<Tc.length&&wc.push(this.Bh[Yd]);else for(wc.push(k),
Yd=0;Yd<this.Bh.length;Yd++)(Tc=this.Bh[Yd].results)&&0<Tc.length&&wc.push(this.Bh[Yd]);this.iZa=wc}}if(id.PDb&&!id.Sy){ve=Yd=-1;for(Tc=0;Tc<this.Bh.length;Tc++)switch(this.Bh[Tc].groupType){case 23:Yd=Tc;break;case 0:case 17:case 2:-1===ve&&(ve=Tc)}if(-1!==Yd){ve=-1===ve?0:Yd>ve?ve+1:ve;Yd=this.Bh[Yd];Tc=Array(this.Bh.length);k=0;for(wc=0;wc<Tc.length;wc++)wc===ve?Tc[wc]=Yd:(23===this.Bh[k].groupType&&k++,Tc[wc]=this.Bh[k],k++);this.iZa=Tc}}Bc.resultsUpdated(this);Bc=l.TellMeActor.instance.sc;Bc.w0(Db.length,
"RankerInference",Ya.data.httpStatus.toString(),Math.round(window.performance.now()-Wb),se.a.Jhg,!0,Dd.a.zca);this.c9a&&Bc&&(Ya=this.query.XAa,Db=Bc.LUb,id.dmc&&Ya>Db&&!id.Sy&&(Bc.mzd(this.query.Rd),Bc.zTd(Ya)))}}dwd(Ya){if("GroupType"in Ya&&Ya.GroupType&&"ConfidenceScore"in Ya&&"ConfidenceThreshold"in Ya)return!0;l.TellMeActor.instance.sc.onError("IsValidIntentGroup","Invalid intents found");return!1}wQa(Ya,Db,Wb,Bc,Tc){Bc===this.gz&&(this.a4(),l.TellMeActor.instance.sc.w0(Db.length,"RankerInference",
Ya.data.httpStatus.toString(),Math.round(window.performance.now()-Wb),se.a.Jhg,!1,Dd.a.zca));Tc.resultsUpdated(this)}a4(){-1!==this.KG&&(window.clearTimeout(this.KG),this.KG=-1)}LSj(Ya){let Db;Db=this.BB.ty().Sy?l.TellMeActor.instance.sc.Fld(this.DFc,this.query.Rd):l.TellMeActor.instance.sc.Fld(this.Bh,this.query.Rd);var Wb=this.BB.ty().f8h;""!==Wb&&(Wb="_"+Wb);let Bc="";this.BB.ty().Htd&&(Bc="RankerInference"+Wb+",");this.BB.ty().gvd&&(Bc+="SerpletClassifier");","===Bc.charAt(Bc.length-1)&&(Bc=Bc.substring(0,
Bc.length-1));Wb=l.TellMeActor.instance.sc.paf(Bc);const Tc=this.gz=Me.a.create().toString();Wb["Client-Request-Id"]=Tc;const id=window.performance.now(),k=this.BB.ty()?this.BB.ty().h8h:600;this.a4();this.KG=window.setTimeout(()=>{if(Tc===this.gz){this.gz="";this.KG=-1;Ya.resultsUpdated(this);const Ob={};Ob[f.a.provider]="Ranker";Ob[f.a.KRa]=this.query.XAa;l.TellMeActor.instance.sc.aL(e.a.timedOut,k,Ob)}},k);this.zh.Zm(l.TellMeActor.instance.sc.qaf(),2,Db,Wb,!1,0,Ob=>{this.MQa(Ob,this.query.Rd,id,
Ya,Tc,this.BB.ty())},Ob=>{this.wQa(Ob,this.query.Rd,id,Tc,Ya)},null,null,!1,4E3,6E3)}w1j(){var Ya=0,Db=new Wc.a,Wb=this.BB.pxf,Bc=this.BB.qxf;for(var Tc=0;Tc<this.Bh.length;Tc++){var id=this.Bh[Tc],k=be.a[id.groupType].toLowerCase(),Ob=Wb[k];Ya+=id.results.length;id.results.length>Ob&&(k=Bc[k],Ia.c(k)||Db.add(new vd.a(k,id)))}Bc=!this.query||""===this.query.Rd.trim();Tc=Ya-(Bc?this.iBd:this.fBd);if(!(0>=Tc)){Bc=window.performance.now();Ya=Ya.toString()+" total,"+Tc.toString()+" to remove.";if(0<Db.count)for(Db.Sc((kc,
wc)=>kc.key>wc.key?-1:1),id=0;id<Db.count&&0<Tc;id++){k=Db.ma(id).value;Ob=be.a[k.groupType].toLowerCase();let kc=k.results.length-Wb[Ob];kc>Tc&&(kc=Tc);0<kc&&(k.QNd(kc),Ya+=Ob+": "+kc.toString()+" results removed.",Tc-=kc)}if(0<Tc){Ya+=Tc.toString()+" results left after trimming.";Db=new Wc.a;Wb=this.BB.uxf;for(id=0;id<this.Bh.length;id++)k=this.Bh[id],Ob=Wb[be.a[k.groupType].toLowerCase()],Ia.c(Ob)||Db.add(new vd.a(Ob,k));Db.Sc((kc,wc)=>kc.key<wc.key?-1:1);for(Wb=0;0<Tc;)id=Db.ma(Wb++).value,Tc>=
id.results.length?(Array.remove(this.Bh,id),Ya+=be.a[id.groupType]+": "+id.results.length.toString()+" results force removed.",Tc-=id.results.length):(id.QNd(Tc),Ya+=be.a[id.groupType]+": "+Tc.toString()+" results force removed.",Tc=0)}l.TellMeActor.instance.sc&&(Db={},Db[f.a.message]=Ya,l.TellMeActor.instance.sc.aL("ShowOptimal",window.performance.now()-Bc,Db))}}}Object(c.a)(Jb,"CombineResultsUpdatedEventArgs",null,[179]);var xc=a(925);class Zc{constructor(Ya,Db,Wb,Bc=!1,Tc=""){this.rTc=this.AUc=
!1;this.oE=Ya;this.DGa=[];this.ake=Db.length;this.Ta=l.TellMeActor.instance.ty();this.UWb=Bc;this.bta=Tc;this.IZa={};for(Ya=0;Ya<Db.length;++Ya)this.IZa[Ya.toString()]=Wb?0:Db[Ya].tD()}eHj(Ya,Db){Db&&Db.query&&Db.query.XAa<l.TellMeActor.instance.BY||(this.DGa[Ya]=Db,this.rTc?this.AUc=!0:(!this.Ta||3!==this.Ta.zl||3!==this.IZa[Ya.toString()]||this.VOe())&&this.Txa())}p$i(){this.rTc=!0}U3j(){this.rTc=!1;this.AUc&&(this.AUc=!1,this.Txa())}VOe(){if(this.DGa.length<this.ake)return!1;for(let Ya=0;Ya<this.ake;++Ya)if(!this.DGa[Ya])return!1;
return!0}Txa(){var Ya=this.VOe();const Db=window.performance.now(),Wb=new Jb(l.TellMeActor.instance.Kbe);Wb.joj(this.DGa);for(var Bc=0;Bc<this.DGa.length;++Bc){var Tc=this.DGa[Bc];if(Tc&&Tc.Bh&&Tc.Bh.length&&(Wb.query=Tc.query,Tc.attributes&&0<Tc.attributes.length&&(Wb.attributes=Tc.attributes),Tc&&Tc.Bh&&(Ya||this.j8g(Bc,this.DGa))))for(const id of Tc.Bh)Wb.Ml(id)}Wb.Bh&&Wb.Bh.length&&(Wb.c9a=Ya,this.Ta&&this.Ta.e1d&&Wb.w1j(),xc.a.Kpf()&&(this.Ta&&this.Ta.nzi&&Wb.query.Rd&&0<Wb.query.Rd.length?Wb.KSj():
Wb.JSj()),xc.a.Kpf()&&this.Ta&&(this.Ta.Htd||this.Ta.gvd)&&this.UWb&&Wb.query.Rd&&0<Wb.query.Rd.length&&Wb.c9a&&this.bta!==b.a.contextMenu?(3===this.Ta.zl&&Ya||this.oE.resultsUpdated(Wb),Wb.LSj(this.oE)):this.oE.resultsUpdated(Wb),Ya=l.TellMeActor.instance.sc,Wb.c9a&&Ya&&(Bc=Wb.query.XAa,Tc=Ya.LUb,Wb.query.Rd&&0<Wb.query.Rd.length&&this.UWb&&this.Ta.dmc&&this.bta!==b.a.contextMenu&&Bc>Tc&&!this.Ta.Htd&&!this.Ta.Sy&&(Ya.mzd(Wb.query.Rd),Ya.zTd(Bc)),Ya.aL(e.a.Uvj,window.performance.now()-Db)))}j8g(Ya,
Db){if(!(this.IZa&&Ya.toString()in this.IZa)||Db.length<=Ya||!Db[Ya])return!1;if(!Db[Ya].Bh.length)return!0;const Wb=this.IZa[Ya.toString()];if(0===Wb)return!0;const Bc=this.IZa;for(let id in Bc){var Tc=Bc[id];const k=Number.parseInvariant(id);if(k!==Ya&&Tc===Wb&&!(Db.length>k&&Db[k]))return!1}return!0}}Object(c.a)(Zc,"ResultsAggregator",null,[]);var qd=a(1241);class Pd{constructor(){this.Xgb=this.Ygb=this.Wgb=this.logCount=this.logRank=this.invertedRank=0}YMg(Ya,Db){switch(Ya){case 1:this.invertedRank=
Db;break;case 3:this.logRank=Db;break;case 2:this.logCount=Db;break;case 5:this.Wgb=Db;break;case 4:this.Ygb=Db;break;case 6:this.Xgb=Db}}}Object(c.a)(Pd,"CommandFeatures",null,[]);class le{constructor(Ya){this.Mae=0;this.KEg=Ya;this.ryg={}}get modelId(){return this.KEg}get featureIntercept(){return this.Mae}get etb(){return this.ryg}xMg(Ya,Db,Wb){0===Db?this.Mae=Wb:(this.etb[Ya]||(this.etb[Ya]=new Pd),this.etb[Ya].YMg(Db,Wb))}}Object(c.a)(le,"CoefficientsModel",null,[]);const ke=(Ya,Db)=>Math.pow(10,
-Db/(60*Math.LN10/Math.LN2*Ya));class jf{constructor(Ya,Db){this.yGg=Ya;this._count=1;this.iFa=new Pd;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=Ya?1/Ya:0;this.features.logRank=2/Math.pow(2,Ya);this.features.Wgb=ke(10,Db);this.features.Ygb=ke(2,Db);this.features.Xgb=ke(1,Db)}get NRa(){return this.yGg}get count(){return this._count}get features(){return this.iFa}dki(){this._count=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}j8j(Ya){const Db=
2/Math.pow(2,Ya);this.features.invertedRank=Math.max(this.features.invertedRank,Ya?1/Ya:0);this.features.logRank=Math.max(this.features.logRank,Db)}Z8j(Ya){const Db=ke(10,Ya),Wb=ke(2,Ya);Ya=ke(1,Ya);this.features.Wgb=Math.max(this.features.Wgb,Db);this.features.Ygb=Math.max(this.features.Ygb,Wb);this.features.Xgb=Math.max(this.features.Xgb,Ya)}}Object(c.a)(jf,"CommandModel",null,[]);class nf{constructor(Ya){this.Cjb=null;if(!Ya&&l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("PredictionEngine",
"IModelAdapter can't be null");this.JYa=Ya;this.FXb=this.tyd()}tyd(){const Ya=this.JYa.N2h(),Db=this.JYa.gkd();if(void 0===Ya||null===Ya||void 0===Db||null===Db)return!1;try{window.performance.now();this.Cjb={};for(let Wb=0;Wb<Ya.length;Wb++){const Bc=Ya[Wb],Tc=Db[Bc[0].toString()].trim(),id=Bc[1],k=0!==id?Db[Bc[2].toString()].trim():"",Ob=Bc[3];Tc in this.Cjb||(this.Cjb[Tc]=new le(Tc));this.Cjb[Tc].xMg(k,id,Ob)}}catch(Wb){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("LoadModelData",
"Error Loading Suggestions Model: "+Wb);return!1}return!0}$Qh(){const Ya=this.JYa.a1h(),Db={};if(!Ya)return Db;let Wb=1;for(let Bc=0;Bc<Ya.length;Bc++){const Tc=Ya[Bc];Tc.Id in Db?(Db[Tc.Id].dki(),Db[Tc.Id].j8j(Wb),Db[Tc.Id].Z8j(Tc.TimeElapsedSinceClick)):Db[Tc.Id]=new jf(Wb,Tc.TimeElapsedSinceClick);Wb++}return Db}P8a(){this.FXb||(this.FXb=this.tyd());return this.FXb}i5h(){let Ya=[];if(!this.FXb){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("GetPredictedCommands","IModelAdapter returned no data");
return Ya}const Db=this.$Qh(),Wb=this.Cjb;for(let Tc in Wb){const id=Wb[Tc],k=id.modelId;let Ob=0;for(let kc in Db){var Bc=kc;const wc=Db[kc].features;(Bc=Bc in id.etb?id.etb[Bc]:null)&&(Ob+=wc.invertedRank*Bc.invertedRank+wc.logRank*Bc.logRank+wc.logCount*Bc.logCount+wc.Wgb*Bc.Wgb+wc.Ygb*Bc.Ygb+wc.Xgb*Bc.Xgb)}Ob+=id.featureIntercept;Ya.push(new Cc.a(k,Ob))}Ya.sort((Tc,id)=>Tc.score<id.score?1:Tc.score>id.score?-1:0);0<Ya.length-10&&(Ya=Ya.slice(0,10));return Ya}}Object(c.a)(nf,"PredictionEngine",
null,[]);class pe{constructor(){this.Zle={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}Xdc(Ya,
Db){return Db&&"word"===Db.application.toLowerCase()&&Ya in this.Zle?this.Zle[Ya]:[]}}Object(c.a)(pe,"SuggestionResultsUtility",null,[]);class Re{constructor(Ya,Db,Wb){this.Ta=Db;this.Amb=new nf(Ya);this.YG=Wb;this.Ane=new pe}Qw(){return"Suggestion"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(Ya,Db,Wb,Bc=b.a.tellMe,Tc=null){Wb=new r.a(Ya);l.TellMeActor.instance.iSb=!1;if((!Tc||Array.contains(Tc,16))&&u.a.Nz(Ya)){if(!this.Amb.P8a()){if(l.TellMeActor.instance.sc)l.TellMeActor.instance.sc.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.cvd()&&0<this.Ane.Xdc(l.TellMeActor.instance.G8b,this.Ta).length){const k=this.Ane.Xdc(l.TellMeActor.instance.G8b,this.Ta);Tc=[];for(var id of k)this.Ta.GBc&&"Find"===id||Tc.push(new Cc.a(id,0));l.TellMeActor.instance.iSb=!0}else Tc=this.Amb.i5h();Sb.CommandResultsUtility.$nc(Tc,!0,"Recommended","LRE");id=[];for(const k of Tc)this.YG&&this.YG.W6c(k.commandId)||
id.push(k);Ya=Sb.CommandResultsUtility.kzb(Ya,id,this.Ta,null,null,null,16,1);0<Ya.results.length&&Bc!==b.a.contextMenu&&(Ya.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Ya.results.length&&Wb.Ml(Ya)}Db.resultsUpdated(Wb)}cvd(){return!!this.Ta&&(this.Ta.cvd||this.Ta.wCi)}}Object(c.a)(Re,"SuggestionResultsProvider",null,[202]);class bf{a1h(){return l.TellMeActor.instance.pLc}N2h(){return window.TellMeSuggestionModel}gkd(){return window.CoefficientModelIdMap}}Object(c.a)(bf,"SuggestionsModelAdapter",
null,[239]);var Pf=a(1329),pg=a(1069);a.d(C,"AggregatorResultsProvider",function(){return $f});class $f{constructor(Ya=!1){this.ZYa={};this.ZYa[b.a.tellMe]=[];this.ZYa[b.a.contextMenu]=[];this.UWb=Ya}Vqf(Ya,Db,Wb,Bc,Tc=null){let id;var k=!1;switch(Bc){case b.a.contextMenu:id=this.ZYa[b.a.contextMenu];k=!0;break;default:id=this.ZYa[b.a.tellMe]}Db=new Zc(Db,id,k,this.UWb,Bc);Db.p$i();for(let Ob=0;Ob<id.length;++Ob){const kc=window.performance.now(),wc=new m(Db,Ob);(k=l.TellMeActor.instance.ty())&&k.l0g?
window.setTimeout(()=>{id[Ob].Pu(Ya,wc,Wb,Bc,Tc);if(l.TellMeActor.instance.sc){const ad={};ad[f.a.provider]=id[Ob].Qw();ad[f.a.KRa]=Ya.XAa;l.TellMeActor.instance.sc.aL(e.a.Pu,window.performance.now()-kc,ad)}},0):(id[Ob].Pu(Ya,wc,Wb,Bc,Tc),l.TellMeActor.instance.sc&&(k={},k[f.a.provider]=id[Ob].Qw(),k[f.a.KRa]=Ya.XAa,l.TellMeActor.instance.sc.aL(e.a.Pu,window.performance.now()-kc,k)))}Db.U3j()}Qw(){return"Aggregator"}tD(){return 0}Pu(Ya,Db,Wb=!1,Bc=b.a.tellMe,Tc=null){if(l.TellMeActor.instance.BOi)this.Vqf(Ya,
Db,Wb,Bc,Tc);else{const id=window.performance.now();l.TellMeActor.instance.Qbk.then(()=>{l.TellMeActor.instance.sc&&l.TellMeActor.instance.sc.aL(e.a.COi,window.performance.now()-id);this.Vqf(Ya,Db,Wb,Bc,Tc);return!0})}}fs(Ya,Db){this.ZYa[Db].push(Ya)}ANg(Ya){switch(Ya){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Db=this.ZYa[b.a.tellMe];for(const Wb of Db)if("FindInDocument"===Wb.Qw()){Wb.bGj(Ya);break}}}static createInstance(Ya,Db,Wb,Bc){const Tc=
Db.HQ;var id=Bc&&u.a.WVd(Db),k=id&&Db.dHd&&!Tc;const Ob=Db.Lvd&&!u.a.MOa()&&!Tc,kc=Db.Vtd&&!Tc,wc=new $f(id);if(Db.hNj&&!Tc){var ad=new tc(Db);wc.fs(ad,b.a.tellMe)}ad=Db.Yi?cd.AFrameworkApplication.fa.ra("TellMeIsSuggestionsForSimplifiedUxEnabled"):cd.AFrameworkApplication.fa.ra("TellMeSuggestionsIsEnabled");const sd=!ad&&cd.AFrameworkApplication.fa.ra("TellMeFirstRunExperienceIsEnabled");wc.fs(new Ue(Ya,Db.D2j,sd,!1),b.a.tellMe);ad&&!Tc&&wc.fs(new Re(new bf,Db,Ya),b.a.tellMe);Ya=cd.AFrameworkApplication.sa.Pa.gqf?
new Ka(Db,new zb):new Wd(Db,Wb);wc.fs(Ya,b.a.contextMenu);(id&&Db.eHd||k)&&wc.fs(Pf.a.YLe(Db,!0),b.a.tellMe);wc.fs(Ya,b.a.tellMe);!Db.fMh||Tc||"Word"===Db.application&&Db.v_e||wc.fs(new xf(Db),b.a.tellMe);Db.eIa&&!Tc&&(k=new n(Db),wc.fs(k,b.a.tellMe),wc.fs(k,b.a.contextMenu));!Db.iIa||Db.ZOb||Db.YOb||Tc||wc.fs(new z.a(Db),b.a.tellMe);Bc&&(Db.Mxa||u.a.zR())&&(k=new Bb(Db),wc.fs(k,b.a.tellMe),wc.fs(k,b.a.contextMenu));id&&wc.fs(Pf.a.YLe(Db,!1),b.a.tellMe);Bc&&!Db.uZd&&u.a.VVd(Db)&&!Tc&&(wc.fs(new qd.a(Db),
b.a.tellMe),Db.QVj&&wc.fs(new qd.a(Db),b.a.contextMenu));Ob&&wc.fs(new gf(Db),b.a.tellMe);!Db.Wfb&&!Db.Sy||Tc||wc.fs(new Vf.a(Db),b.a.tellMe);Db.PDb&&!Tc&&wc.fs(new pg.a(Db),b.a.tellMe);Db.Zic&&(id=new x(Db),wc.fs(id,b.a.tellMe),wc.fs(id,b.a.contextMenu));Bc&&Db.bjc&&!Tc&&wc.fs(new w.AddinResultsProvider(Db),b.a.tellMe);kc&&"Excel"===Db.application&&!Tc&&wc.fs(new oc(Db),b.a.tellMe);return wc}}Object(c.a)($f,"AggregatorResultsProvider",null,[202])},1241:function(t,C,a){t=a(0);var c=a(730),b=a(584),
f=a(796),e=a(752);class d{constructor(G,N,I,O,U,ca){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=G;this.url=N;this.spWebUrl=I;this.uniqueId=O;this.size=U;this.lastModified=ca}}Object(t.a)(d,"FileInfo",null,[]);var h=a(827);class r{constructor(G,N){this.DimensionValue=this.DimensionName=null;this.DimensionName=G;this.DimensionValue=N}}Object(t.a)(r,"Dimension",null,[]);class l{constructor(G,N,I,O,U){this.Query=this.EntityType=null;this.Size=this.From=
0;this.Filter=null;this.EntityType=G;this.Query=N;this.From=I;this.Size=O;U&&(this.Filter=U)}}Object(t.a)(l,"EntityRequest",null,[]);class u{constructor(G){this.QueryString=null;this.QueryString=G}}Object(t.a)(u,"Query",null,[]);var v=a(732);class x{constructor(G,N){this.Dimensions=this.Name=null;this.Name=G;this.Dimensions=N}}Object(t.a)(x,"Scenario",null,[]);var w=a(735),m=a(734);class n{constructor(G,N,I,O){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=G;this.TimeZone=
N;this.Cvid=I;this.Scenario=O}}Object(t.a)(n,"SubstrateBody",null,[]);var z=a(826),y=a(726),A=a(725),F=a(6),D=a(1030),B=a(1029),M=a(828),R=a(42),P=a(34),E=a(181);a.d(C,"a",function(){return H});class H{constructor(G){this.Smb=this.Jsa=this.MXb=this.Okb=this.gnb=0;this.Nhe=this.qje=this.gz=null;this.gRc=0;this.KG=-1;this.oob="";this.MNc=!1;this.zh=F.AFrameworkApplication.Od;this.Ta=G;this.h_b=this.Hld();this.HGa=new b.a;this.Ige=this.Ta.e1d?3:2;this.KWc=this.Ta.e1d&&this.Ta.Qcg?5:3;this.VXc=this.Ta.GBc?
2:3;this.Dpe=1;this.wXb=this.Ta.p8e;this.Yme=this.Ta.hAi;this.Dnb=G.K$e;F.AFrameworkApplication.fa&&(this.qje=F.AFrameworkApplication.fa.Wa("AppCatalogUrl")+F.AFrameworkApplication.fa.Wa("SearchPersonaPhotoBaseUrl"),this.MNc=this.Ta.HQ||this.Ta.dac);this.Ta.HQ&&(this.VXc=this.KWc=5)}Qw(){return"Substrate"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:3}Pu(G,N,I,O=c.a.tellMe,U=null){const ca=new m.a(G);if(!U||Array.contains(U,14)||Array.contains(U,15)||Array.contains(U,20))if(!this.gRc||window.performance.now()-
this.gRc>=A.a.kjg)if(I=this.HGa.aaf())this.gRc=window.performance.now(),I.then(Q=>{Q&&""!==Q?(this.oob=Q,""!==this.gz&&this.$$e(G,O,this.oob,N,U)):(y.TellMeActor.instance.sc.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),N.resultsUpdated(ca))},Q=>{y.TellMeActor.instance.sc.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Q);N.resultsUpdated(ca)});else{if(y.TellMeActor.instance.sc)y.TellMeActor.instance.sc.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");N.resultsUpdated(ca)}else this.oob&&""!==this.oob?this.$$e(G,O,this.oob,N,U):(N.resultsUpdated(ca),y.TellMeActor.instance.sc.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else N.resultsUpdated(ca)}Y0(){this.Jsa=this.Smb=this.MXb=this.Okb=this.gnb=0}$$e(G,N,I,O,U){this.Y0();const ca=new m.a(G),Q=this.gz=E.a.create().toString();this.a4();this.KG=window.setTimeout(()=>{if(Q===this.gz){this.gz="";this.KG=-1;O.resultsUpdated(ca);const ea={};ea[f.a.provider]=
this.Qw();ea[f.a.KRa]=G.XAa;y.TellMeActor.instance.sc.aL(e.a.timedOut,this.Dnb,ea)}},this.Dnb);const Y={"Content-Type":"application/json",Accept:"application/json"};Y.Authorization="Bearer "+I;Y["X-Office-Version"]=F.AFrameworkApplication.buildVersion;Y["X-Office-Application"]=F.AFrameworkApplication.fa.Wa("Application");Y["X-Office-Platform"]="WAC";Y["X-TellMe-SessionId"]=y.TellMeActor.instance.Kfc();Y["X-TellMe-Culture"]=F.AFrameworkApplication.uiCulture;Y["X-TellMe-ProcessSessionId"]=F.AFrameworkApplication.userSessionId;
Y["Client-Request-Id"]=Q;const la=window.performance.now();this.zh.Zm(this.s9h(),2,this.t9h(G.Rd,this.Ta.application,y.TellMeActor.instance.Kfc(),A.a.Nz(G)),Y,!1,0,ea=>{this.MQa(ea,G,O,Q,la,N,U)},ea=>{this.wQa(ea,G,O,Q,la)},null,null,!1,4E3,6E3)}a4(){-1!==this.KG&&(window.clearTimeout(this.KG),this.KG=-1)}MQa(G,N,I,O,U,ca,Q){y.TellMeActor.instance.sc.w0(N.Rd.length,this.h_b.join(","),G.data.httpStatus.toString(),Math.round(window.performance.now()-U),z.a.substrate,!0,h.a.zca);const Y=A.a.Nz(N),la=
new m.a(N);if(O===this.gz){this.a4();G=R.b(G.data.te);if(G.Groups){G=G.Groups;for(const ea of G)"People"===ea.Type&&this.Ta.JQb&&(Q?Array.contains(Q,14):1)?(G=this.N8e(ea.Suggestions,Y,ca),0<G.results.length&&la.Ml(G)):"File"===ea.Type&&this.Ta.IQb&&(Q?Array.contains(Q,15):1)?(G=this.bjd(ea.Suggestions,Y,ca),0<G.results.length&&(this.lkc()&&(O=new v.a("GenerateSlidesFromTellMe",30,"",null,1),G.Xl(O)),la.Ml(G))):"Notes"===ea.Type&&this.Ta.Iya&&ca!==c.a.contextMenu&&(Q?Array.contains(Q,20):1)&&(G=this.l8e(ea.Suggestions,
Y,N),0<G.results.length&&la.Ml(G))}I.resultsUpdated(la);y.TellMeActor.instance.sc.w0(N.Rd.length,this.h_b.join(","),"",Math.round(window.performance.now()-U),"",!0,h.a.provider)}else I.resultsUpdated(la)}l8e(G,N,I){const O=new w.a(20);O.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const U of G)this.VBi(U)&&(G=U.NotesType,G=P.a.Ok(G),G=this.I3h(G,U.LastModifiedTime,U.BodyPreview,U.Subject,N,I,U))&&(G.groupType=20,O.Xl(G));return O}N8e(G,N,I){const O=new w.a(14);O.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;
for(const ca of G)if(this.WBi(ca)){var U=ca.Id.split("@")[0];G=ca.EmailAddresses[0];let Q=ca.Type;if(void 0===Q||null===Q)Q="User";if(U=this.H4h(Q,ca.DisplayName,ca.JobTitle,G,U,I,N))U.description=G,G=ca.JobTitle,"Department"in ca&&"CompanyName"in ca&&(G+="@"+ca.Department+"@"+ca.CompanyName),U.f2b=G,O.Xl(U)}return O}bjd(G,N,I){const O=new w.a(15);O.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const ea of G)if(this.PBi(ea)){var U=ea.FileName;G=ea.FileExtension;var ca=U;U.length>G.length&&
ca.endsWith(G)&&(ca=U.substr(0,U.length-G.length-1));var Q=void 0,Y=0;"DateCreated"in ea&&ea.DateCreated?(Y=A.a.Tld(ea.DateCreated),Q=A.a.uaf(ea.DateCreated),Q=String.format(CommonUIStrings.l_CreatedTimeFormatString,ea.Author,Q)):Q=ea.Author;var la=ea.AccessUrl+"?web=1";const ha=P.a.Fla(la);U=String.format('<a href="{0}">{1}</a>',ha,P.a.Jh(U));if(I!==c.a.contextMenu||P.a.pya(la))if(ca=this.IZh(ca,I===c.a.contextMenu?U:la,Q,ea.FileExtension,ea.Text,N))ca.description=ea.Author,ca.r2b=Y,O.Xl(ca),this.MNc&&
(Y=ea.AccessUrl,U=A.a.uec(G),Q=ea.DateModified?ea.DateModified:ea.DateCreated,la=ea.Size?ea.Size:ea.FileSize,this.oMj()&&(Y=Y.replace(RegExp("%20","g")," "),U=A.a.P8h(G)),G=new d(U,Y,ea.SPWebUrl,ea.Id,la,Q),y.TellMeActor.instance.u2d(!1,ca.value,G))}return O}wQa(G,N,I,O,U){O===this.gz&&(this.a4(),y.TellMeActor.instance.sc.w0(N.Rd.length,this.h_b.join(","),G.data.httpStatus.toString(),Math.round(window.performance.now()-U),z.a.substrate,!1,h.a.zca));G=new m.a(N);I.resultsUpdated(G)}H4h(G,N,I,O,U,ca,
Q){Q=Q?this.Dpe:this.Ige;if(!window.LPC&&!A.a.jsd()||this.gnb===Q)return null;this.gnb+=1;Q="PeopleSuggestion"+this.gnb.toString();var Y=this.qje+"?size=1&accountName="+O;G=Object.assign(new D.a,{PersonaType:G,Smtp:O,ProfilePictureUrl:Y,AadObjectId:U});const la=Object.assign(new B.a,{identifiers:G,displayName:N});G=ca===c.a.contextMenu;this.Ta.p_?(y.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Q,la,N,I)),ca===c.a.contextMenu&&(I=A.a.LLe(N,O,U),y.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Q,
I))),y.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Q,G))):(Y=[],Y.push(appChrome.actions.setPersonaButtonCoauthor(Q,la,N,I)),ca===c.a.contextMenu&&(I=A.a.LLe(N,O,U),Y.push(appChrome.actions.setButtonCommandValueId(Q,I))),Y.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Q,G)),appChrome.api.dispatch(Y));return new v.a(Q,11,N,O,0)}I3h(G,N,I,O,U,ca,Q){if(U&&!this.Ta.kqf||this.MXb===this.wXb||this.Smb===this.wXb||this.Jsa===this.wXb)return null;
var Y=null;this.MXb+=1;U="";const la=[],ea={};Q.type="Notes";this.Nhe=Object.assign(new M.a,{landingTab:"Notes",data:Q});ca=A.a.nja(ca.Rd,33,this.Nhe);if("onenotepagepreviews"===G){if(!("ClickthroughUrl"in Q&&Q.ClickthroughUrl)||""===Q.ClickthroughUrl)return null;this.Smb+=1;U="OnenoteNotesSuggestion"+this.Smb.toString();ea["default"]="SaveAsonetoc2_20";Y=Q.ClickthroughUrl;la.push(appChrome.actions.setControlIconSet(U,ea));la.push(appChrome.actions.setCompoundButtonCommandValueId(U,Y));Y=new v.a(U,
19,null,null,0)}else if("stickynote"===G){if(!this.Yme)return null;this.Jsa+=1;U="NotesSuggestion"+this.Jsa.toString();ea["default"]="ShowAllNotes_20";la.push(appChrome.actions.setControlIconSet(U,ea));la.push(appChrome.actions.setCompoundButtonCommandValueId(U,ca));Y=new v.a(U,21,null,null,0)}else if("samsung"===G){if(!this.Yme)return null;this.Jsa+=1;U="NotesSuggestion"+this.Jsa.toString();ea["default"]="CategoryCollapsed_20";la.push(appChrome.actions.setControlIconSet(U,ea));la.push(appChrome.actions.setCompoundButtonCommandValueId(U,
ca));Y=new v.a(U,20,null,null,0)}""!==U&&(G=A.a.uaf(N),G=String.format(CommonUIStrings.l_LastModifiedString,G),Y.label=O,Y.r2b=A.a.Tld(N),la.push(appChrome.actions.setControlLabel(U,O)),la.push(appChrome.actions.updateCompoundButtonDescription(U,G)),la.push(appChrome.actions.setControlCustomTooltip(U,I)),appChrome.api.dispatch(la));return Y}IZh(G,N,I,O,U,ca){if(this.Okb===(ca?this.VXc:this.KWc)||this.MNc&&"Word"!==A.a.uec(O))return null;this.Okb+=1;ca="FileSuggestion"+this.Okb.toString();const Q=
[],Y={};Y["default"]=A.a.M0h(O);this.Ta.p_?(y.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ca,G)),y.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ca,Y)),y.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ca,I)),y.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ca,N)),y.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ca,U))):(Q.push(appChrome.actions.setControlLabel(ca,
G)),Q.push(appChrome.actions.setControlIconSet(ca,Y)),Q.push(appChrome.actions.updateCompoundButtonDescription(ca,I)),Q.push(appChrome.actions.setCompoundButtonCommandValueId(ca,N)),Q.push(appChrome.actions.setControlCustomTooltip(ca,U)),appChrome.api.dispatch(Q));return new v.a(ca,6,G,I,0)}Hld(){const G=[];this.Ta.JQb&&Array.add(G,"People");this.Ta.IQb&&Array.add(G,"File");this.Ta.Iya&&Array.add(G,"Notes");return G}t9h(G,N,I,O){var U=new u(G);G=new l("File",U,0,O?this.VXc:this.KWc,null);O=new l("People",
U,0,O?this.Dpe:this.Ige,A.a.y$i);U=new l("Notes",U,0,this.wXb,null);this.Ta.dac&&"powerpoint"===N.toLowerCase()&&(N="word");N=new r("app",N.toLowerCase());var ca=[];Array.add(ca,N);N=new x("tellmesearch",ca);ca=[];this.Ta.IQb&&Array.add(ca,G);this.Ta.JQb&&Array.add(ca,O);this.Ta.Iya&&Array.add(ca,U);I=new n(ca,"UTC",I,N);return R.c(I)}s9h(){let G=this.Ta.RVj;this.Ta.Iya&&(G+="?&setflight=NotesFrom3S");""!==this.Ta.baf&&(G=G+"&"+this.Ta.baf);return G}WBi(G){return"DisplayName"in G&&"Id"in G&&"EmailAddresses"in
G&&!!G.Id&&!!G.EmailAddresses}PBi(G){return"FileExtension"in G&&!!G.FileExtension&&"FileName"in G&&!!G.FileName&&""!==G.FileName&&"AccessUrl"in G&&!!G.AccessUrl&&""!==G.AccessUrl}VBi(G){return"Id"in G&&!!G.Id&&"NotesType"in G&&!!G.NotesType&&"Subject"in G&&!!G.Subject&&""!==G.Subject}lkc(){return!!F.AFrameworkApplication.fa&&F.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}oMj(){return!!F.AFrameworkApplication.fa&&F.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",
!0)}}Object(t.a)(H,"SubstrateResultsProvider",null,[202])},1329:function(t,C,a){t=a(0);var c=a(198),b=a(730),f=a(584),e=a(796),d=a(752),h=a(827),r=a(732),l=a(735),u=a(734),v=a(726),x=a(725);class w{constructor(E){this.Ta=E;this.h_b=this.Hld()}Qw(){return"Add-ins"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:3}Pu(E,H){E=new u.a(E);H.resultsUpdated(E)}mxa(E,H,G){let N;N=this.Ta.Sy?new l.a(29):new l.a(27);N.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;G&&this.JQj(E.Rd,H,N)}JQj(E,H,G){const N=
[];let I;I=this.Ta.Mqi?this.Ta.Sy&&this.Ta.Pta?x.a.swa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,E)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,E):this.Ta.Nqi?this.Ta.Sy&&this.Ta.Pta?x.a.swa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,E)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,E):this.Ta.Sy&&this.Ta.Pta?x.a.swa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,
E)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,E);this.Ta.p_?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",I)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",E))):(N.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",I)),N.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",E)),appChrome.api.dispatch(N));G.Xl(new r.a("LaunchAddinDialogFromTellMe",
29));H.Ml(G)}Hld(){const E=[];this.Ta.bjc&&Array.add(E,"Addin");return E}}Object(t.a)(w,"AddinStoreResultsProvider",null,[202]);var m=a(1067),n=a(781),z=a(797),y=a(1068),A=a(1241),F=a(1069),D=a(826),B=a(6),M=a(42),R=a(181);a.d(C,"a",function(){return P});class P{constructor(E,H,G){this.Ssa=this.$nb=this.aob=this.OZb=!1;this.gz=null;this.KG=-1;this.tha=this.uob=this.bta=this.SGa=null;this.Ffe=this.Lfe=0;this.Ta=E;const N=x.a.zR();this.Bra=H||[];this.zh=B.AFrameworkApplication.Od;this.Hme=E.eHd;this.bob=
E.dHd;this.MZb=N&&this.Sfb();this.NZb=N&&this.Tfb();this.Ime=N&&this.Ufb();this.QZb=this.Yfb();this.SVc=this.Wfb();if((H=E.uZd&&x.a.VVd(E))||E.HQ)this.SGa=new A.a(E),this.OZb=E.IQb;H&&(this.aob=E.JQb,this.$nb=E.Iya,this.Ssa=this.OZb&&this.hn("File")||this.aob&&this.hn("People")||this.$nb&&this.hn("Notes"));this.LZb=this.TMj();this.dob=E.PIb;this.PZb=this.oNj();this.QVc=this.SMj();this.KZb=this.oWd();this.M7d=this.Z9h();this.z7d=new m.a(E);this.nCg=new y.a(E);this.pJg=new F.a(E);this.zwg=new w(E);
this.Dnb=G;this.HGa=new f.a;this.dob&&(this.z7d=new m.a(E));E.HQ&&(this.QVc=this.PZb=this.dob=this.Ssa=this.$nb=this.aob=this.SVc=this.QZb=this.Ime=this.NZb=this.MZb=this.bob=!1,B.AFrameworkApplication.fa&&this.hn("File")&&this.Ubg()&&(E=this.HGa.Xld("Search",B.AFrameworkApplication.fa.Wa("TellMeServiceAuthEndpointForSearch"),!0),this.Gwb(E,"TellMeService",!0),E=this.HGa.Xld("SmartLookup",B.AFrameworkApplication.fa.Wa("SmartLookupShredderServiceEndpoint"),!1),this.Gwb(E,"Shredder",!1)));B.AFrameworkApplication.fa&&
this.Ssa&&this.hn("File")&&this.Ubg()&&(E=this.HGa.Xld("Search",B.AFrameworkApplication.fa.Wa("TellMeServiceAuthEndpointForSearch"),!0),this.Gwb(E,"TellMeService",!0))}hn(E){return Array.contains(this.Bra,E)?!0:!1}Qw(){return"TellMeService"}tD(){return 0===this.Ta.zl?0:1===this.Ta.zl?1:this.hn("Command")||this.hn("Recommended")?2:3}V9h(E){let H="";if(!E&&this.hn("Command")&&this.Ta.Mtd){H+="CommandSearch_DLIS,";var G=this.Ta.Phg;0<G.length&&(H+=G+",")}E&&this.hn("Recommended")&&this.bob&&(G=this.cbi(),
0<G.length&&(H+=G+","));!E&&this.hn("Help")&&(E=this.Ta.Ohg,0<E.length&&(H+=E+","));this.Ta.HQ&&this.tha&&0<this.tha.length&&(H+="IsRecallEnabled_true,");(this.Ta.dac||this.Ta.HQ)&&this.Ssa&&(H+="IsGenerateSlidesEnabled_true,");0<H.length&&(H=H.substr(0,H.length-1));return H}Gwb(E,H,G){const N=G?this.Lfe:this.Ffe;if(!N||window.performance.now()-N>=x.a.kjg)if(E)G?this.Lfe=window.performance.now():this.Ffe=window.performance.now(),E.then(I=>{G?this.uob=I:(this.tha=I,v.TellMeActor.instance.EXd=I)},I=>
{v.TellMeActor.instance.sc.onError("TellMeServiceProvider:FetchTokenForService_"+H,"tellMeServiceToken promise rejected: "+I)});else if(v.TellMeActor.instance.sc)v.TellMeActor.instance.sc.onError("TellMeServiceProvider:FetchTokenForService_"+H,"undefined token promise")}Pu(E,H,G,N=b.a.tellMe,I=null){const O=new u.a(E);G=x.a.Nz(E);this.hn("File")&&(this.Ssa||this.Ta.HQ)&&this.Gwb(this.HGa.$9h(),"TellMeService",!0);this.hn("File")&&this.Ta.HQ&&this.Gwb(this.HGa.H8h(),"Shredder",!1);var U=this.Ssa&&
!!this.uob;const ca=this.Ta.HQ&&!!this.tha;var Q=U||ca||G&&this.hn("Recommended")&&this.bob;U=U||ca||!G&&(this.Hme&&this.hn("Command")||this.MZb&&this.hn("Answer")||this.NZb&&this.hn("Definition")||this.SVc&&this.hn("Image")||this.dob&&this.hn("Help")||this.QZb&&this.hn("WolframAnswer")||this.PZb&&this.hn("Template")||this.QVc&&this.hn("Addin"));if(Q||U)if(this.bta=N,N={"Content-Type":"application/json",Accept:"application/json"},N["X-Office-Version"]=B.AFrameworkApplication.buildVersion,N["X-Office-Application"]=
B.AFrameworkApplication.fa.Wa("Application"),N["X-Office-Platform"]="WAC",N["X-TellMe-SqmUserId"]=B.AFrameworkApplication.fa.Wa("LoggableUserId")||"",N["X-TellMe-SessionId"]=v.TellMeActor.instance.Kfc(),this.uob&&(N.Authorization="Bearer "+this.uob),this.tha&&0<this.tha.length&&(N["X-TellMe-ShredderToken"]="Bearer "+this.tha),Q=this.V9h(G),0<Q.length&&(N["X-TellMe-Flights"]=Q),Q=[],!G&&this.hn("Answer")&&this.MZb&&(I?Array.contains(I,9):1)&&Array.add(Q,"Answer"),!G&&this.hn("Command")&&this.Hme&&
!n.CommandResultsUtility.Vrd(E.Rd)&&(I?Array.contains(I,17):1)&&Array.add(Q,"Command"),!G&&this.hn("Definition")&&this.NZb&&(I?Array.contains(I,10):1)&&Array.add(Q,"Definition"),!G&&this.hn("Help")&&this.dob&&(I?Array.contains(I,8):1)&&Array.add(Q,"Help"),!G&&this.hn("WolframAnswer")&&this.QZb&&(I?Array.contains(I,12):1)&&Array.add(Q,"WolframAnswer"),G&&this.hn("Recommended")&&this.bob&&!v.TellMeActor.instance.iSb&&(I?Array.contains(I,18):1)&&Array.add(Q,"Recommended"),!G&&this.hn("Image")&&this.SVc&&
(I?Array.contains(I,19):1)&&Array.add(Q,"Image"),this.uob&&this.Ssa&&(I?Array.contains(I,14)||Array.contains(I,15)||Array.contains(I,20):1)&&(this.SGa.Y0(),this.OZb&&this.hn("File")&&Array.add(Q,"File"),this.aob&&this.hn("People")&&Array.add(Q,"People"),this.$nb&&this.hn("Notes")&&Array.add(Q,"Notes")),this.tha&&0<this.tha.length&&this.Ta.HQ&&(I?Array.contains(I,15):1)&&(this.SGa.Y0(),this.hn("File")&&Array.add(Q,"File")),!G&&this.hn("Template")&&this.PZb&&(I?Array.contains(I,23):1)&&Array.add(Q,
"Template"),!G&&this.hn("Addin")&&this.QVc&&(I?Array.contains(I,27):1)&&Array.add(Q,"Addin"),!G&&this.hn("ActionAI")&&this.KZb&&(I?Array.contains(I,25):1)&&Array.add(Q,"ActionAI"),Q.length){N["X-TellMe-SuggestionTypes"]=Q.join(",");N["X-TellMe-Culture"]=B.AFrameworkApplication.uiCulture;N["X-TellMe-ProcessSessionId"]=B.AFrameworkApplication.userSessionId;var Y=this.gz=R.a.create().toString();N["Client-Request-Id"]=Y;var la=window.performance.now();this.a4();this.KG=window.setTimeout(()=>{if(Y===this.gz){this.gz=
"";this.KG=-1;H.resultsUpdated(O);const ea={};ea[e.a.provider]=this.Qw();ea[e.a.KRa]=E.XAa;v.TellMeActor.instance.sc.aL(d.a.timedOut,this.Dnb,ea)}},this.Dnb);this.zh.Zm(this.M7d,2,this.Y9h(E.Rd),N,!1,0,ea=>{this.MQa(ea,E,H,Y,la,I)},ea=>{this.wQa(ea,E,H,Y,la)},null,null,!1,4E3,this.KZb?3E4:6E3)}else v.TellMeActor.instance.sc.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),H.resultsUpdated(O);else H.resultsUpdated(O)}a4(){-1!==this.KG&&(window.clearTimeout(this.KG),this.KG=
-1)}MQa(E,H,G,N,I,O){const U=new u.a(H);if(N===this.gz){this.a4();v.TellMeActor.instance.sc.w0(H.Rd.length,this.Bra.join(","),E.data.httpStatus.toString(),Math.round(window.performance.now()-I),D.a.tellMe,!0,h.a.zca);N=E.data.te;E=null;try{E=M.b(N)}catch(ha){v.TellMeActor.instance.sc.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ha);return}N=x.a.Nz(H);if("Groups"in E&&E.Groups){var ca=E.Groups;for(var Q of ca)if("GroupType"in Q&&"Suggestions"in Q&&Q.Suggestions)if("Commands"===
Q.GroupType&&(O?Array.contains(O,17):1)||"Recommended"===Q.GroupType&&(O?Array.contains(O,18):1)){var Y=(ca="Recommended"===Q.GroupType)?"DLIS":"NaiveBayes";"Source"in Q&&Q.Source&&(Y=Q.Source);var la=Q.Suggestions;new c.a;var ea=[];for(const ha of la)this.NBi(ha)&&(la=ha.Type,("Command"===la||ca&&"Recommended"===la)&&ea.push(new z.a(ha.CommandId,ha.Score)));n.CommandResultsUtility.$nc(ea,!H.Rd.trim().length,Q.GroupType,Y);Y=v.TellMeActor.instance.YG;la=[];for(const ha of ea)ca&&Y&&Y.W6c(ha.commandId)||
la.push(ha);ea=n.CommandResultsUtility.kzb(H,la,this.Ta,null,null,null,ca?18:17,0);0<ea.results.length&&(this.bta!==b.a.contextMenu&&(ea.displayName=ca?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),U.Ml(ea))}else if("Answer"===Q.GroupType){la=Q.Suggestions;ca=null;ea=2147483647;Y="";for(const ha of la)if(this.LBi(ha))if(Y=ha.Type,la=this.dzb(Y),"Answer"===Y&&this.MZb){ca=this.CLe(Y,ha,H.Rd);break}else la&&la<ea&&(ea=la,ca=this.CLe(Y,ha,H.Rd));ea=x.a.Tvj(H.Rd,
Y);ca&&(O?Array.contains(O,ca.type):1)&&(Y=[],this.LZb?this.Ta.p_?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ca.value,ca.bA)),v.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ca.value,ca.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ca.value,ea))):(Y.push(appChrome.actions.setControlLabel(ca.value,ca.bA)),Y.push(appChrome.actions.updateCompoundButtonDescription(ca.value,ca.description)),
Y.push(appChrome.actions.setCompoundButtonCommandValueId(ca.value,ea)),appChrome.api.dispatch(Y)):this.Ta.p_?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ca.value,ca.bA+" - "+ca.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ca.value,ea))):(Y.push(appChrome.actions.setControlLabel(ca.value,ca.bA+" - "+ca.description)),Y.push(appChrome.actions.setButtonCommandValueId(ca.value,ea)),appChrome.api.dispatch(Y)),ea=this.olh(ca.type),
ea.Xl(ca),U.Ml(ea))}else"Help"===Q.GroupType&&Q.Suggestions.length&&(O?Array.contains(O,8):1)?this.dob&&(ca=this.z7d.mxa(H,Q.Suggestions))&&0<ca.results.length&&U.Ml(ca):"Template"===Q.GroupType&&(O?Array.contains(O,23):1)?(ca=Q.Suggestions)&&0<ca.length&&this.pJg.mxa(H,U,ca):"Addin"===Q.GroupType&&(O?Array.contains(O,27):1)?(ca=Q.Suggestions)&&0<ca.length&&this.zwg.mxa(H,U,ca):"ActionAI"===Q.GroupType&&(O?Array.contains(O,25):1)?(ea=Q.Suggestions,ca=[],new l.a(25),ea&&1===ea.length&&(Y=ea[0])&&Y.CommandId&&
(ea=Y.CommandId,ca.push(new z.a(ea,"Score"in Y?Y.Score:0)),ca=n.CommandResultsUtility.kzb(H,ca,this.Ta,null,null,null,25,0),ca.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,U.Ml(ca))):"Substrate"===Q.GroupType&&this.Ssa&&"Type"in Q?"File"===Q.Type&&this.OZb&&(O?Array.contains(O,15):1)?(ca=this.SGa.bjd(Q.Suggestions,N,this.bta))&&0<ca.results.length&&(this.lkc()&&(ea=new r.a("GenerateSlidesFromTellMe",30,"",null,1),ca.Xl(ea)),U.Ml(ca)):"People"===Q.Type&&this.aob&&(O?Array.contains(O,14):
1)?(ca=this.SGa.N8e(Q.Suggestions,N,this.bta))&&0<ca.results.length&&U.Ml(ca):"Notes"===Q.Type&&this.$nb&&(O?Array.contains(O,14):1)&&(ca=this.SGa.l8e(Q.Suggestions,N,H))&&0<ca.results.length&&U.Ml(ca):"Recall"===Q.GroupType&&this.Ta.HQ&&"Type"in Q&&"IntentService"===Q.Type&&(O?Array.contains(O,15):1)&&(ca=this.SGa.bjd(Q.Suggestions,N,this.bta))&&0<ca.results.length&&(this.lkc()&&(ea=new r.a("GenerateSlidesFromTellMe",30,"",null,1),ca.Xl(ea)),U.Ml(ca));else v.TellMeActor.instance.sc.onError("OnSuccessCallBack",
"GroupType"in Q?"Invalid group suggestions found for "+Q.GroupType:"Invalid group found")}if(E.Intents){Q=E.Intents;for(const ha of Q)this.dwd(ha)&&("Image"===ha.GroupType&&ha.ConfidenceScore>ha.ConfidenceThreshold&&(O?Array.contains(O,19):1)?this.nCg.mxa(H,U,0,ha):"Commands"===ha.GroupType&&ha.ConfidenceScore<ha.ConfidenceThreshold&&(O?Array.contains(O,17):1)&&(Q=new l.a(17),U.Ml(Q)))}G.resultsUpdated(U);v.TellMeActor.instance.sc.w0(H.Rd.length,this.Bra.join(","),"",Math.round(window.performance.now()-
I),"",!0,h.a.provider)}}wQa(E,H,G,N,I){const O=new u.a(H);N===this.gz&&(this.a4(),v.TellMeActor.instance.sc.w0(H.Rd.length,this.Bra.join(","),E.data.httpStatus.toString(),Math.round(window.performance.now()-I),D.a.tellMe,!1,h.a.zca));G.resultsUpdated(O)}dzb(E){switch(E){case "Entity":return this.Ime?3:0;case "Definition":return this.NZb?5:0;case "WolframAnswer":return this.QZb?2:0;default:return 0}}CLe(E,H,G){switch(E){case "Answer":return new r.a(this.LZb?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===H.Title?G:H.Title,H.Description,0);case "Entity":return new r.a(this.LZb?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===H.Title?G:H.Title,H.Description,0);case "Definition":return new r.a(this.LZb?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===H.Title?G:H.Title,H.Description,0);case "WolframAnswer":return new r.a("WolframForSearch",3,""===H.Title?G:H.Title,H.Description,0);default:return null}}olh(E){switch(E){case 0:return new l.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new l.a(11,
CommonUIStrings.l_TellMeEntityTitle);case 1:return new l.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new l.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new l.a(19,this.Ta.Ofb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}LBi(E){return"Type"in E&&!!E.Type&&""!==E.Type&&"Description"in E&&!!E.Description&&""!==E.Description}NBi(E){return"Type"in E&&!!E.Type&&""!==E.Type&&"CommandId"in E&&!!E.CommandId&&""!==E.CommandId&&"Score"in
E&&!!E.Score}dwd(E){if("GroupType"in E&&E.GroupType&&"ConfidenceScore"in E&&"ConfidenceThreshold"in E)return!0;v.TellMeActor.instance.sc.onError("IsValidIntentGroup","Invalid intents found");return!1}Y9h(E){const H=x.a.Ppf(E),G={};G.Query=E;H&&this.bob&&(this.bxi()?G.UserActionEvents=v.TellMeActor.instance.Ooe:(G.CommandClickedEvents=v.TellMeActor.instance.pLc,G.CommandActionEvents=v.TellMeActor.instance.l9d),G.TellMeCommandClickMruEvents=v.TellMeActor.instance.nhe,G.ContentType=v.TellMeActor.instance.G8b);
this.PZb&&(E={},E.Application=this.Ta.application,G.TemplateInfo=E);return M.c(G)}Sfb(){return!!this.Ta&&this.Ta.Sfb||!!B.AFrameworkApplication.sa&&B.AFrameworkApplication.sa.Pa.Sfb}Tfb(){return!!this.Ta&&this.Ta.Tfb||!!B.AFrameworkApplication.sa&&B.AFrameworkApplication.sa.Pa.Tfb}Ufb(){return!!this.Ta&&this.Ta.Ufb||!!B.AFrameworkApplication.sa&&B.AFrameworkApplication.sa.Pa.Ufb}Yfb(){return!!this.Ta&&this.Ta.Yfb||!!B.AFrameworkApplication.sa&&B.AFrameworkApplication.sa.Pa.Yfb}Wfb(){return!!this.Ta&&
(this.Ta.Wfb||this.Ta.Sy)}TMj(){return!!this.Ta&&!this.Ta.Hya}oNj(){return!!this.Ta&&this.Ta.PDb}SMj(){return!!this.Ta&&this.Ta.Oqi&&this.Ta.Lqi}oWd(){return!!this.Ta&&this.Ta.oWd}iqf(){return!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}jqf(){return!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}bxi(){return!!B.AFrameworkApplication.fa&&
B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}lkc(){return!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Ubg(){return!!B.AFrameworkApplication.fa&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}cbi(){return B.AFrameworkApplication.fa?B.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",
""):""}Z9h(){if(!B.AFrameworkApplication.fa)return"";if(this.jqf())return B.AFrameworkApplication.fa.Wa("TellMeServiceProdEndpointForSearch");if(this.iqf())return B.AFrameworkApplication.fa.Wa("TellMeServiceEdogEndpointForSearch");if(x.a.jsd())return B.AFrameworkApplication.fa.Wa("TellMeServiceIntEndpointForSearch");let E=B.AFrameworkApplication.fa.Wa("TellMeServiceSearchEndpoint");E&&""!==E||(E=B.AFrameworkApplication.Nhg);return E}static YLe(E,H){if(H)return new P(E,["Command","Recommended"],E.AZh);
H=x.a.zR()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new P(E,H,E.K$e)}}Object(t.a)(P,"TellMeServiceProvider",null,[202])},1336:function(t,C,a){t=a(0);var c=a(14),b=a(816),f=a(229),e=a(16),d=a(114),h=a(6),r=a(91),l=a(273),u=a(245),v=a(139),x=a(19),w=a(7),m=a(272),n=a(259),z=a(13),y=a(15),A=a(728);class F{}F.Wbh="CondtionalFormattingPane";F.Ybh="CondtionalFormattingPaneHeader";
F.Xbh="CondtionalFormattingPaneBody";F.Zbh="CondtionalFormattingPaneTitle";F.Vbh="CondtionalFormattingCloseButton";Object(t.a)(F,"CssClassNames",null,[]);a.d(C,"a",function(){return E});const D=F.Wbh,B=F.Ybh,M=F.Xbh,R=w.a.n_d+F.Zbh,P=w.a.CQb+F.Vbh;class E extends u.a{constructor(H,G,N){super(H);this.WFe=this.Ie=null;this.gw=0;this.Xs=!1;this.Dc=(I,O)=>{O.Sf||this.$g(!1)};this.psc=()=>{this.n4c();return!1};this.Cl=()=>{this.raiseEvent("CFTPCR");return!1};this.$=G;this.taskPaneManager=N;m.a(G).ti(this);
this.ygh();this.$.wj(this.Dc)}eU(H){this.get_events().addHandler("CFTPR",H)}fX(H){this.get_events().removeHandler("CFTPR",H)}dU(H){this.addHandler("CFTPC",H)}eX(H){this.removeHandler("CFTPC",H)}qSg(H){this.addHandler("CFTPCO",H)}Rqj(H){this.removeHandler("CFTPCO",H)}rSg(H){this.addHandler("CFTPE",H)}Sqj(H){this.removeHandler("CFTPE",H)}pSg(H){this.addHandler("CFTPCR",H)}Qqj(H){this.removeHandler("CFTPCR",H)}get isVisible(){return super.isVisible}set isVisible(H){super.isVisible!==H&&((super.isVisible=
H)?this.raiseEvent("CFTPE"):this.raiseEvent("CFTPCO"))}get Qf(){return this.isVisible}get je(){return n.a.Tbh}get Uh(){return 9}get tk(){return x.a.tFh}get jR(){return y.a.instance.ha(1074)}get oq(){return 320}get isResizable(){return!1}get rc(){return this.domElement}get height(){return this.taskPaneManager.WO.offsetHeight}get titleText(){return y.a.instance.ha(1299)}Zq(){return this.Xs}Tt(){return this.Xs}BW(){}LV(){return!1}Bj(){}hk(){}dispose(){this.$&&this.$.ll(this.Dc);this.Ie&&(f.a.instance.Ba(e.a.click,
this.Ie,this.Cl),d.KeyInputManager.instance.Cx(this.Ie,this.WFe));this.Ie=this.taskPaneManager=this.$=null;this.h4j();super.dispose()}pg(){this.F8f();this.n4c();return!0}Gh(H){return z.DOMElementExtensions.Mf(this.rc,H)}$g(H){this.Xs=H;const G=this.taskPaneManager;z.DOMElementExtensions.isVisible(G.YO);this.isVisible=H;this.taskPaneManager.eC();H&&0<G.iE.length&&(!G.Qh||9!==G.Qh.taskPane.Uh||G.isCollapsed)&&G.VI(this,!0);this.$.zf()}HU(){var H=this.$.Ib;const G=A.b("div","ConditionalFormattingPaneBodyId",
M);H=document.getElementById(H+w.a.O6b);const N=this.KM();H.appendChild(N);H.appendChild(G);return G}KM(){const H=A.b("div","ConditionalFormattingPaneHeaderId",B),G=A.b("span","ConditionalFormattingPaneTitleId",R);G.innerText=this.titleText;G.setAttribute("aria-live","polite");G.setAttribute("role","heading");G.setAttribute("aria-level","2");G.setAttribute(v.a.ariaLabel,y.a.instance.ha(1300));this.Ie=b.a.tb("ConditionalFormattingPaneCloseButtonId",P,y.a.instance.ha(10),"ClosePaneGlyph_16x16x32",!1);
this.Ie.classList.add(h.AFrameworkApplication.isRtl?w.a.oka:w.a.pka);f.a.instance.ta(e.a.click,this.Ie,this.Cl);this.WFe=d.KeyInputManager.instance.$t(this.Ie,this.Cl,r.a.Wh);H.appendChild(G);H.appendChild(this.Ie);return H}ygh(){this.$.frame.We.zk("ConditionalFormattingPane");const H=this.$.frame.We.Gi("ConditionalFormattingPane");H.parent=l.AFrame.kU;H.EN=!0;f.a.instance.lBa(e.a.click,this.rc,this.psc,null,!0)}n4c(){this.$.frame.We.Gj("ConditionalFormattingPane")}XEj(){this.$.frame.We.Gj(this.$.frame.We.mF||
l.AFrame.kU)}h4j(){f.a.instance.GFc(e.a.click,this.rc,this.psc,!0)}A$g(){this.$g(!1);this.XEj();this.raiseEvent("CFTPC")}F8f(){const H=document.getElementById(E.firstPaneElementId);H?H.focus():c.ULS.sendTraceTag(51663744,0,10,"ConditionalFormattingTaskPane.SetFocusOnPaneFirstElement: could not find element.")}setFocusOnToolbarFirstElement(){this.taskPaneManager.setFocusOnToolbarFirstElement()}static get firstPaneElementId(){return E.mji}static get ruleManagerId(){return E.pji}static get loadingRuleListId(){return E.nji}static get ruleListId(){return E.oji}static la(H,
G){var N=H.Ib;let I=document.getElementById(N+w.a.O6b);I||(I=document.createElement("div"),I.id=H.Ib+w.a.O6b,document.getElementById(N+w.a.vW).appendChild(I));I.classList.add(D);N=H.da;return N.Aa(248)||N.Ha(248,new E(I,H,G))}}E.mji=w.a.E6c;E.pji=w.a.ZHe;E.nji=w.a.Ubh;E.oji=w.a.YHe;Object(t.a)(E,"ConditionalFormattingTaskPane",u.a,[928,2,339,36])},1379:function(t,C,a){a.r(C);a.d(C,"SurfaceStringTokenStringGenerator",function(){return b});t=a(0);var c=a(875);class b extends c.a{constructor(f){super(f);
this.Ea=f}apply(f,e,d,h,r,l,u){null==l&&(l=f.yaf(r,e));u=c.a.Bse(f,l,this.Ea.score,d,h,u);return{fRb:l,asb:u}}}b.bsb=0;Object(t.a)(b,"SurfaceStringTokenStringGenerator",c.a,[])},1380:function(t,C,a){a.r(C);a.d(C,"QueryTokenStringGenerator",function(){return f});t=a(0);var c=a(875),b=a(723);class f extends c.a{constructor(e){super(e);this.Ea=e}apply(e,d,h,r,l,u,v){d=this.Ea.query.load(d,null);l=0;let x=null;this.Ea.query.NI===b.Annotations.K1?d&&(x=this.Ea.name):((x=this.Ea.name)&&(x+="_"),x+=this.Ea.annotations.kP(this.Ea.query.NI,
d));null!=x&&(l=c.a.Bse(e,x,this.Ea.score,h,r,l));return{fRb:u,asb:v+l}}}f.bsb=1;Object(t.a)(f,"QueryTokenStringGenerator",c.a,[])},1381:function(t,C,a){a.r(C);a.d(C,"FuzzyMatchTokenStringGenerator",function(){return b});t=a(0);var c=a(875);class b extends c.a{constructor(f){super(f);this.Ea=f}apply(f,e,d,h,r,l,u){null==l&&(l=f.yaf(r,e));f=this.Ea.zTe.zKi(l);if(this.Ea.XNf)for(var v of f)if(!v.ky&&v.Bcc)return{fRb:l,asb:u};v=0;for(const x of f)if(x.ky&&!({a3c:v}=this.Exe(x,!0,d,h,v)).returnValue)return{fRb:l,
asb:u};if(this.Ea.Zgf)for(const x of f)if(!({a3c:v}=this.Exe(x,!1,d,h,v)).returnValue)break;return{fRb:l,asb:u}}Exe(f,e,d,h,r){let l;e?(e=0,l=f.Bcc?1:0):(e=f.Bcc?1:0,l=f.count-e);for(let u=0;u<l;++u)if(c.a.Cse(f.$va+e+u,this.Ea.score,d,h),++r,0<this.Ea.eBd&&r>=this.Ea.eBd)return{returnValue:!1,a3c:r};return{returnValue:!0,a3c:r}}}b.bsb=2;Object(t.a)(b,"FuzzyMatchTokenStringGenerator",c.a,[])},1409:function(t,C,a){a.r(C);t=a(0);var c=a(768),b=a(198),f=a(341),e=a(89),d=a(735);class h{constructor(z,
y,A,F=0){this.Wbf=z;this.groupType=y;this.Omd=F;this.CMb=A}}Object(t.a)(h,"SortingGroup",null,[]);class r{constructor(z,y,A,F){this.order=z;this.QMa=y;this.zci=A;this.groupType=F}}Object(t.a)(r,"SortingProp",null,[]);var l=a(726),u=a(730),v=a(725),x=a(719);class w{constructor(z,y){this.txf={};this.sxf={};this.mxf=this.Dxf=1;this.hBe(z,y)}MSj(z,y,A){var F=v.a.Nz(A)?this.txf:this.sxf;A=new b.a;for(var D of y)y=Object(e.a)(r,F[c.a[D.groupType].toLowerCase()]),x.c(y)||A.add(new f.a(y,D));A.Sc((M,R)=>
M.key.order<R.key.order?-1:1);Array.clear(z);D=l.TellMeActor.instance.FE;for(y=0;y<A.count;){F=A.ma(y).key.QMa;var B=A.ma(y).value;const M=new d.a(A.ma(y).key.groupType);x.c(D)||D.Location===u.a.contextMenu||(M.displayName=A.ma(y).key.zci);for(const R of B.results)M.Xl(R);for(B=++y;B<A.count&&A.ma(B).key.QMa===F;)this.wZc(M,A.ma(B).value),B=++y;z.push(M)}}G8j(z,y){this.mxf=this.Dxf=1;this.hBe(z,y)}hBe(z,y){this.teg(z);for(var A=0;A<z.length;A++){let F=z[A];for(const D of F.CMb)this.fNg(D,A,F.Wbf,
F.groupType)}this.teg(y);for(z=0;z<y.length;z++){A=y[z];for(const F of A.CMb)this.eNg(F,z,A.Wbf,A.groupType)}}teg(z){z.sort((y,A)=>Object(e.a)(h,y).Omd>Object(e.a)(h,A).Omd?-1:1)}fNg(z,y,A,F){this.txf[c.a[z].toLowerCase()]=new r(this.Dxf++,y,A,F)}eNg(z,y,A,F){this.sxf[c.a[z].toLowerCase()]=new r(this.mxf++,y,A,F)}wZc(z,y){for(let A=0;A<y.results.length;A++)z.Xl(y.results[A])}}Object(t.a)(w,"BaseGroupingSorter",null,[]);class m{constructor(){this.Noc=[new h("",26,[26]),new h("",24,[24]),new h(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,
4,[4,2]),new h(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new h(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new h("",13,[13]),new h("",22,[22])];this.Goc=[new h("",25,[25]),new h(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new h(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new h(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new h("",13,[13,24]),new h("",22,[22])];this.Qwf=new w(this.Noc,
this.Goc)}SPb(z,y,A,F=null,D=null){let B=!1;if(F){for(const M of v.a.Nz(A)?this.Noc:this.Goc)this.Whj(M,F);B=!0}if(D){for(const M of v.a.Nz(A)?this.Noc:this.Goc)this.H8j(y,M,D);B=!0}B&&this.Qwf.G8j(this.Noc,this.Goc);this.Qwf.MSj(z,y,A)}Whj(z,y){const A=new b.a;for(var F of z.CMb){const D=y[c.a[F].toLowerCase()];A.add(new f.a(x.c(D)?Number.MAX_VALUE:D,F))}if(A.count){A.Sc((D,B)=>D.key<B.key?-1:1);y=Array(A.count);for(F=0;F<A.count;F++)y[F]=A.ma(F).value;z.CMb=y}}H8j(z,y,A){let F=0;for(const D of y.CMb)if(c.a[D].toLowerCase()in
A&&A[c.a[D].toLowerCase()])for(const B of z)if(B.groupType===D){F+=A[c.a[D].toLowerCase()];break}y.Omd=F}}Object(t.a)(m,"SimplifiedGroupingSorter",null,[]);a.d(C,"GroupsPlacementInfo",function(){return n});class n{constructor(z){this.rxf={};this.pxf={};this.qxf={};this.uxf={};this.vAd={};this.vxf=this.lLi=this.cLi=this.eLi=1;this.Axf=null;this.Km=z;this.O2g();this.tbj();this.D2g();this.E1g();z.Sy&&(this.Axf=new m)}ds(z){this.rxf[c.a[z].toLowerCase()]=this.eLi++}nt(z,y){this.pxf[c.a[z].toLowerCase()]=
y}O$(z){this.qxf[c.a[z].toLowerCase()]=this.cLi++}gH(z){this.uxf[c.a[z].toLowerCase()]=this.lLi++}Np(z){this.vAd[c.a[z].toLowerCase()]=this.vxf++}O2g(){const z=!!this.Km&&this.Km.Hya,y=!!this.Km&&this.Km.PIb,A=!!this.Km&&this.Km.Iya,F=!!this.Km&&this.Km.Lvd&&!v.a.MOa(),D=!!this.Km&&this.Km.PDb,B=!!this.Km&&this.Km.bjc,M=!!this.Km&&this.Km.Vtd,R=!!this.Km&&this.Km.Zic;this.Km&&(this.Km.HQ||this.Km.dac)&&this.ds(26);R&&this.ds(24);this.ds(4);this.ds(18);this.ds(16);this.ds(7);this.ds(17);this.ds(0);
this.ds(1);M&&this.ds(28);D&&this.ds(23);z||this.ds(2);z&&!y||this.ds(8);this.ds(15);A&&this.ds(20);this.ds(14);this.ds(9);this.ds(12);this.ds(10);this.ds(11);z&&this.ds(2);z&&!y&&this.ds(8);this.ds(19);B&&this.ds(27);this.ds(21);this.ds(13);F&&this.ds(22)}tbj(){this.nt(21,1);this.nt(4,3);this.nt(18,3);this.nt(16,3);this.nt(7,3);this.nt(17,5);this.nt(0,5);this.nt(1,1);this.nt(28,2);this.nt(2,1);this.nt(8,2);this.nt(15,3);this.nt(14,2);this.nt(27,3);this.nt(9,1);this.nt(12,1);this.nt(10,1);this.nt(11,
1);this.nt(19,1);this.nt(23,1);this.nt(13,1);this.nt(24,1);this.nt(25,1);this.nt(20,2);this.nt(22,1);this.nt(26,1)}D2g(){this.O$(4);this.O$(0);this.O$(17);this.O$(7);this.O$(16);this.O$(18);this.O$(15);this.O$(20);this.O$(8);this.O$(14)}E1g(){this.gH(14);this.gH(10);this.gH(12);this.gH(9);this.gH(11);this.gH(20);this.gH(15);this.gH(8);this.gH(2);this.gH(1);this.gH(27);this.gH(7);this.gH(18);this.gH(16);this.gH(17);this.gH(0);this.gH(4)}Luj(){this.vAd={};this.vxf=1}s7h(z,y,A){this.Luj();const F=!!this.Km&&
this.Km.Hya,D=!!this.Km&&this.Km.PIb,B=!!this.Km&&this.Km.Iya,M=!!this.Km&&this.Km.Lvd&&!v.a.MOa(),R=!!this.Km&&this.Km.PDb,P=!!this.Km&&this.Km.bjc,E=!!this.Km&&this.Km.Vtd,H=!!this.Km&&this.Km.Zic;z=z&&D;H&&this.Np(25);this.Np(4);this.Np(18);this.Np(16);this.Np(7);this.Np(17);this.Np(0);this.Np(1);E&&this.Np(28);R&&this.Np(23);F&&!D||!z||this.Np(8);y&&this.Np(15);F||this.Np(2);P&&this.Np(27);A&&this.Np(14);F&&!D||z||this.Np(8);y||this.Np(15);B&&this.Np(20);A||this.Np(14);this.Np(9);this.Np(12);
this.Np(10);this.Np(11);F&&this.Np(2);F&&!D&&this.Np(8);this.Np(19);this.Np(21);H&&this.Np(24);this.Np(13);M&&this.Np(22);return this.vAd}ty(){return this.Km}}Object(t.a)(n,"GroupsPlacementInfo",null,[])},1411:function(t,C,a){a.r(C);t=a(0);var c=a(978),b=a(827),f=a(768),e=a(1329),d=a(826);class h{constructor(n="",z="",y="",A=-99999,F=-1,D=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=n?n:"";this.Description=z?z:"";this.Type=y?y:"";this.Score=A;this.Age=
F;this.Count=D}}Object(t.a)(h,"Suggestion",null,[]);class r{constructor(n,z){this.GroupType=this.Suggestions=null;this.Suggestions=n;this.GroupType=z}}Object(t.a)(r,"SuggestionGroup",null,[]);class l{}l.help="help";l.answer="answer";l.commands="commands";l.zCj="servicecommands";l.Qhg="template";Object(t.a)(l,"SuggestionGroupType",null,[]);var u=a(726),v=a(725),x=a(6),w=a(42);a.d(C,"InteractionLogger",function(){return m});class m{constructor(n,z,y){this.zMc=0;this.JWc=this.bmb=null;this.Bk=n;this.aWc=
this.KLc=this.ZOc=!1;this.czg=z;this.zh=x.AFrameworkApplication.Od;this.Ta=y;this.LUb=this.pTc=0}get GI(){return this.Bk.GI}HAc(n){this.Bk.HAc(n)}tvf(){if(this.bmb){var n=0;for(const z of this.bmb)this.Bk.zJi(z,n++);this.bmb=null}}beginQuery(n,z,y){this.Bk.nJi(n,z,y)}fAa(n,z){this.Bk.RZg(n,z);this.ZOc=!0;this.aWc=!1}Gna(){this.ZOc=!1;this.KLc||(this.tvf(),this.Bk.uSe(this.zMc))}pJi(n,z){this.Bk.qJi(n,z)}JVi(n,z,y,A,F){for(const D of this.czg)if(n.startsWith(D)){this.aWc=!0;break}this.Bk.zHi(n,z,y,
A,F)}eWi(n){this.KLc=!1;this.zMc=n;this.ZOc||this.aWc||(this.tvf(),this.Bk.uSe(this.zMc,!1))}dWi(n,z){this.Bk.CHi(n,z);this.KLc=!0}Rgd(n,z){if(!n.count)return"";let y="";const A=Date.now();for(let F of n)n=(A-F.timeStamp)/1E3,n=v.a.oFc(n),0<y.length&&(y+=";"),y+=z?F.commandId:F.controlId,y+=":",y+=n.toString();return y}Hna(){var n=this.Rgd(c.a.instance.Qjb,!1);0<n.length&&this.Bk.wHi(n);n=this.Rgd(c.a.instance.FEa,!0);0<n.length&&this.Bk.YGi(n);n=this.Rgd(c.a.instance.IVb,!0);0<n.length&&this.Bk.cIi(n);
n=u.TellMeActor.instance.ohe;0<n.length&&this.Bk.mJi(w.c(n))}MJi(n){this.Bk.fHi(n)}w0(n,z,y,A,F,D,B){this.Bk.BIi(n,z,y,A,F,D,B)}hzd(n,z,y,A){this.Bk.hzd(n,z,y,A)}aL(n,z,y=null){this.Bk.WHi(n,z,y)}onError(n,z,y=null){this.Bk.gza(n,z,y)}TFj(n){this.bmb=n}x9h(n){const z=[];if(!n)return z;for(let y=0;y<n.length;y++){const A=f.a[n[y].groupType].toLowerCase(),F=[],D=n[y].results;if(D){for(let B=0;B<D.length;B++)"findindocument"===A?Array.add(F,new h("","",A,D[B].score,D[B].r2b,D[B].count)):Array.add(F,
new h(D[B].label,D[B].description,A,D[B].score,D[B].r2b,D[B].count));"answer"===A||"definition"===A||"wolframanswer"===A||"entity"===A?Array.add(z,new r(F,l.answer)):"classifier"===A||"appsforoffice"===A?Array.add(z,new r(F,l.commands)):"serviceclassifier"===A?Array.add(z,new r(F,l.zCj)):"assistance"===A?Array.add(z,new r(F,l.help)):("document"===A||"people"===A||"findindocument"===A||"notes"===A||"image"===A||"template"===A)&&Array.add(z,new r(F,A))}}return z}Fld(n,z){const y={};y.Query=z;y.SuggestionGroups=
w.c(this.x9h(n));return w.c(y)}paf(n){const z={"Content-Type":"application/json",Accept:"application/json"};z["X-Office-Version"]=x.AFrameworkApplication.buildVersion;z["X-Office-Application"]=x.AFrameworkApplication.fa.Wa("Application");z["X-Office-Platform"]="WAC";z["X-TellMe-SqmUserId"]=x.AFrameworkApplication.fa.Wa("LoggableUserId")||"";z["X-TellMe-SessionId"]=this.Bk.GI.VV;z["X-TellMe-SuggestionTypes"]="Ranker";z["X-TellMe-Culture"]=x.AFrameworkApplication.uiCulture;z["X-TellMe-ProcessSessionId"]=
x.AFrameworkApplication.userSessionId;z["X-TellMe-Flights"]=n;z["X-TellMe-PartialQueryIndex"]=this.pTc;return z}MQa(n,z,y){this.w0(z.length,"RankerLogging",n.data.httpStatus.toString(),Math.round(window.performance.now()-y),d.a.Khg,!0,b.a.zca)}wQa(n,z,y){this.w0(z.length,"RankerLogging",n.data.httpStatus.toString(),Math.round(window.performance.now()-y),d.a.Khg,!1,b.a.zca)}qaf(){this.JWc||(this.JWc=new e.a(this.Ta,null,6E3));return this.JWc.M7d}mzd(n){const z=this.Fld(this.bmb,n),y=this.paf("RankerLogging"),
A=window.performance.now();this.zh.Zm(this.qaf(),2,z,y,!1,0,F=>{this.MQa(F,n,A)},F=>{this.wQa(F,n,A)},null,null,!1,4E3,6E3);this.pTc++}Auj(){this.pTc=0}zTd(n){this.LUb=n}}Object(t.a)(m,"InteractionLogger",null,[])},1508:function(t,C,a){a.r(C);t={};a.r(t);a.d(t,"AssistanceCommandHandler",function(){return y});var c=a(6),b=a(260);C=a(0);var f=a(718),e=a(159),d=a(7),h=a(80),r=a(98),l=a(1),u=a(197),v=a(135),x=a(26),w=a(60),m=a(157),n=a(41),z=a(70);let y=class{constructor(fa,Ua){this.Yh=fa;this.$=Ua}Oc(){return!1}executeCommand(fa,
Ua,Aa,Ib){l.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&v.b(this.$).qPd();fa=Aa[h.a.Uc];return l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&l.EwaSettings.ya(221)||!(fa&&fa===d.a.$Ld||7===Ua.af&&Aa.SourceControlId===this.$.Ib+d.a.hxa)?l.EwaSettings.ya(221)&&!c.AFrameworkApplication.disableWholeAppsForOfficeFeature&&(2===Ua.af||7===Ua.af||l.EwaSettings.isChangeGateEnabled("OfficeVSO:3009717_EnableTellMeHelpForAgaveHelpPane")&&
-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),fa))?(Aa[d.a.Upa]=Ib?Ib.enabledInViewModeRibbon:!1,Ua=new r.a(-859308420,Ua.method,Ua.mode,Ua.af,Ua.tabName),this.$.Ia.Nb(Ua,Aa)):2===this.Yh.ie(x.a.searchHelp,2,Aa)?u.a(Ua.command):w.Task.Ua(!0):2===this.Yh.ie(x.a.giveFeedback,2,Aa)?u.a(Ua.command):w.Task.Ua(!0)}Ac(fa,Ua){return Object(z.b)("OfficeVSO:7649055_AssistanceCommandHandlerMigrationEnabled")&&!c.AFrameworkApplication.iIa?!1:-1376725189===Ua.command||-1969051244===
Ua.command}Vc(){return!1}};y=Object(e.b)([Object(m.d)(n.c),Object(e.c)(0,Object(n.a)()),Object(e.c)(1,Object(n.u)())],y);Object(C.a)(y,"AssistanceCommandHandler",null,[233]);class A extends f.a{constructor(fa){super(fa)}Fd(){this.qd([new y(c.AFrameworkApplication.xb,this.$)])}static la(fa){f.a.Yd(112,new A(fa))}}Object(C.a)(A,"AssistanceCommandHandlerFactory",f.a,[]);var F=a(14),D=a(88);class B{constructor(){this.correlationId=this.sessionId=this.YTc=null;this.actionId=0;this.m0b=null}get Rd(){return this.YTc?
this.YTc:""}set Rd(fa){this.YTc=fa}}Object(C.a)(B,"AssistanceSearchVariableUrlParameterSet",null,[]);var M=a(329),R=a(661),P=a(84),E=a(112);class H{constructor(){this.Jx=!1;this.fz=!0;this.Mle=this.Wib=null}get isInitialized(){return this.Jx}initialize(fa,Ua){const Aa=!!fa&&!!Ua;Aa&&(this.Wib=fa,this.Mle=Ua);this.Jx=Aa;c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)||P.a.instance.$b("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Ib=>
{Ib.YM("Enabled").then(Pb=>{this.fz=Pb;return null},()=>null)})}Pg(fa){fa||(fa=c.AFrameworkApplication.xb);c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.fz=c.AFrameworkApplication.cE,P.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ua=>{Ua.isFeatureEnabled("mso_sendASmile",!0).then(Aa=>{this.fz=c.AFrameworkApplication.cE&&Aa;(Aa=c.AFrameworkApplication.sa)&&
Aa.updateCommandUI();return null},()=>null)}));fa.Wb(x.a.searchHelp,E.a.frame,Object(D.a)(this,this.wQj,"showSearchResults"))}wQj(fa,Ua,Aa,Ib,Pb){if(1===Aa)return c.AFrameworkApplication.fa.ra("IsFeedbackExperiencesAvailable")||(this.fz=!1),Pb&&"SourceControlId"in Pb&&(Pb=Pb.SourceControlId,("GiveFeedback"===Pb||"btnFeedback"===Pb||"btnFeedbackPane"===Pb||"PptEditingStatusBar.GiveFeedbackPane"===Pb||"GiveFeedbackPane"===Pb)&&!this.fz)?8:R.SessionStatusManager.instance.W6a?8:32;F.ULS.sendTraceTag(4761738,
1302,50,"");M.a.mark(4771);if(this.isInitialized){fa=Pb.CommandValueId;Ua=Pb.SourceControlId;Pb=Object.assign(new B,{actionId:x.a.searchHelp,m0b:Pb});if(void 0!==fa&&null!==fa)Pb=H.fai(fa);else if(void 0!==Ua&&null!==Ua)switch(Ua){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":Pb.actionId=x.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":Pb.actionId=x.a.Nch;break;case "btnShowTraining":case "Training":Pb.actionId=
x.a.k0j;break;case "btnWhatsNew":case "WhatsNew":Pb.actionId=x.a.fck}this.Wib.COj(this.Mle,Pb);M.a.mark(4772);return 32}M.a.mark(4772);return 8}dispose(){this.Wib&&(this.Wib.dispose(),this.Wib=null)}static get instance(){H.Ma||(H.Ma=new H);return H.Ma}static fai(fa){const Ua=new B,Aa=fa.indexOf("|");Ua.sessionId=fa.substring(0,Aa);const Ib=fa.indexOf("|",Aa+1);Ua.correlationId=fa.substring(Aa+1,Ib);Ua.Rd=fa.substr(Ib+1);return Ua}}H.Ma=null;Object(C.a)(H,"AssistanceActor",null,[2]);var G=a(43),N=
a(34),I=a(719);class O{constructor(){this.y7d=this.$a=this.IWa=null;this.kTc=!1}COj(fa,Ua){if(Ua.actionId!==x.a.giveFeedback||c.AFrameworkApplication.cE)if(this.kTc&&!c.AFrameworkApplication.disableWholeAppsForOfficeFeature)this.IWa||(this.IWa=this.y7d()),this.IWa.dgb();else if(Ua.actionId===x.a.giveFeedback)this.kOj();else{fa=fa.Ofc(Ua);Ua=null;try{N.a.pya(fa)&&(Ua=G.a.vf(fa,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(Aa){throw F.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+Aa.message),Aa;}Ua?F.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",fa):F.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",fa,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else F.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.IWa&&(this.IWa.dispose(),this.IWa=null)}R$f(fa,Ua,Aa){Aa&&I.c(fa)?this.kTc=!1:(this.y7d=fa,this.kTc=Aa);this.$a=Ua}kOj(){c.AFrameworkApplication.xb.processAction(x.a.giveFeedback,2)}static createInstance(fa,Ua,Aa=null){const Ib=new O;null==Aa?Ib.R$f(fa,Ua,c.AFrameworkApplication.sye||Ua.ra("HelpTabIsEnabled")):Ib.R$f(fa,Ua,Aa);return Ib}}Object(C.a)(O,"AssistanceDisplayManager",
null,[267,2]);var U=a(568);class ca{constructor(fa,Ua,Aa,Ib,Pb){this.I2=fa;this.SEg=Ua;this.tXb=Aa;this.Wwg=Ib;this.gge=Pb}get lcid(){return this.I2}get namespace(){return this.SEg}get RPa(){return this.tXb}get RWg(){return this.Wwg}get locale(){return this.gge}static O$h(fa){const Ua=fa.indexOf(".");return 0<=Ua&&Ua<fa.length&&(fa=parseInt(fa.substring(0,Ua)),!isNaN(fa))?fa:ca.QXg}static createInstance(fa){return new ca(c.AFrameworkApplication.lcid,fa,ca.O$h(c.AFrameworkApplication.buildVersion),
"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",U.a.KH(c.AFrameworkApplication.lcid).name)}}ca.QXg=16;Object(C.a)(ca,"AssistanceSearchUrlParameterSet",null,[]);var Q=a(264);class Y{constructor(fa,Ua){fa=new Q.QueryStringBuilder(fa);fa.vj("clid",Ua.lcid.toString());fa.vj("p1",Ua.namespace);fa.vj("ver",Ua.RPa.toString());fa.vj("apps",Ua.RWg);fa.vj("lc",Ua.locale);this._url=fa.toString()}Ofc(fa){const Ua=new Q.QueryStringBuilder(this._url);Ua.vj("src","TellMe");Ua.vj("query",fa.Rd);Ua.vj("sessionid",
fa.sessionId);Ua.vj("correlationid",fa.correlationId);return Ua.toString()}static createInstance(fa){return new Y(c.AFrameworkApplication.tye,fa)}}Object(C.a)(Y,"AssistanceSearchUrlProvider",null,[165]);class la{ki(){}init(){c.AFrameworkApplication.iIa&&!c.AFrameworkApplication.suppressHelp&&H.instance.Pg(c.AFrameworkApplication.xb)}dispose(){H.instance.dispose()}Wli(){H.instance.initialize(O.createInstance("XLWAEndUser",c.AFrameworkApplication.fa),Y.createInstance(ca.createInstance(void 0)))}}Object(C.a)(la,
"AssistancePackage",null,[4,5]);class ea extends la{constructor(){super()}get name(){return"Excel.Assistance"}init(){super.init();this.Wli()}}Object(C.a)(ea,"ExcelAssistancePackage",la,[]);var ha=a(10);e=a(520);var X=a(53),T=a(39),ua=a(40);class Ha extends ua.a{constructor(fa,Ua,Aa,Ib){super();this.Ope=0;this.d_a=null;this.Gs=0;this.menuId=this.bZ=null;this.zCf=()=>{this.d_a=null;this.Gs=3;this.ruf("OnAccountingFormatMenuDataLoadFailure");this.Cea();this.raiseEvent("ek2")};this.ACf=(Pb,Fa)=>{this.d_a=
Fa.d_a;this.Gs=2;this.ruf("OnAccountingFormatMenuDataLoadSuccess");this.Cea();this.raiseEvent("ek1")};this.frame=fa;this.Pub=Ua;this.Pub.IZc(this.ACf);this.Pub.HZc(this.zCf);this.eg=Ib;this.bab=Aa;this.Ntj()}IZc(fa){this.addHandler("ek1",fa)}wZf(fa){this.removeHandler("ek1",fa)}HZc(fa){this.addHandler("ek2",fa)}vZf(fa){this.removeHandler("ek2",fa)}dispose(){this.Pub.wZf(this.ACf);this.Pub.vZf(this.zCf);super.dispose()}Vc(fa,Ua,Aa){if("PopulateAccountingFormatsMenu"!==Ua)return!1;this.menuId=Aa.MenuId;
if(2!==this.Gs&&3!==this.Gs)return!1;this.bZ=this.bZ||this.bab.pRh(this.d_a,Aa.MenuId);Aa.MenuItems=this.bZ;return!0}Oc(){return!1}Ac(fa,Ua){return 443187837===Ua.command}executeCommand(fa,Ua,Aa){return 443187837===Ua.command?(fa={ValidMembers:32,NumberFormat:14},fa.NumberFormatOptions=this.d_a.NumberFormatOptions[parseInt(Aa[h.a.Uc].toString(),10)],this.eg.formatCells(443187837,fa,Ua),w.Task.Ua(!0)):u.a(Ua.command)}Ntj(){this.Ope=Date.now();this.Gs=1;this.Pub.SFi()}ruf(fa){F.ULS.sendTraceTag(537155170,
0,50,`AccountingFormatMenuCommandHandler.${fa}: AccountingFormat Menu loading time was : ${Date.now()-this.Ope} ms`)}Cea(){this.menuId&&this.frame.Dx(this.menuId)}}Object(C.a)(Ha,"AccountingFormatMenuCommandHandler",ua.a,[233,940]);var Ca=a(199),Ga=a(32),sa=a(293);class bb extends Sys.EventArgs{constructor(fa){super();this.d_a=fa}}Object(C.a)(bb,"AccountingFormatMenuDataLoadedEventArgs",Sys.EventArgs,[]);var Ba=a(1061);class qa extends ua.a{constructor(fa,Ua){super();this.nTi=()=>{this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};
this.oTi=Aa=>{!Ga.a.Jq(Aa.Errors)&&Aa.Result?this.raiseEvent("AccountingFormatMenuDataLoaded",new bb(Aa.Result)):this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};this.va=fa;this.userOperationManager=Ua}IZc(fa){this.addHandler("AccountingFormatMenuDataLoaded",fa)}wZf(fa){this.removeHandler("AccountingFormatMenuDataLoaded",fa)}HZc(fa){this.addHandler("AccountingFormatOptionsDataLoadFailed",fa)}vZf(fa){this.removeHandler("AccountingFormatOptionsDataLoadFailed",fa)}SFi(){this.userOperationManager.Tc(new Ca.a(166,
0,(fa,Ua,Aa)=>Ba.a(this.va,sa.b(fa,this.oTi),sa.a(Ua,this.nTi),Aa,null),16),null)}}Object(C.a)(qa,"AccountingFormatMenuDataLoader",ua.a,[927]);class pa{constructor(fa){this.Xa=fa}pRh(fa,Ua){return this.URh(fa,Ua).VE()}URh(fa,Ua){Ua=this.Xa.Nq(Ua);if(fa){var Aa=this.Xa.Nc();for(let Ib=0;Ib<fa.NumberOfMenuItems;++Ib){const Pb=this.efh(Ib.toString(),fa.MenuItemLabels[Ib]);Aa.buttons.push(Pb)}Ua.Cc.push(Aa)}fa=this.Xa.Nc();Aa=this.Uih();fa.buttons.push(Aa);Ua.Cc.push(fa);return Ua}efh(fa,Ua){fa=this.Xa.rQ(137,
"Number.AccountingFormatOptionMenuItem_"+fa,443187837,null,1,"None",0,0,fa,!1,0);fa.label=Ua;fa.yS(Ua);return fa}Uih(){return this.Xa.rQ(137,"Number.MoreAccountingFormatOptionsMenuItem",2105621672,null,1,"None",496,0,"3",!1,1594)}}Object(C.a)(pa,"AccountingFormatMenuRenderer",null,[926]);var ya=a(109);class za extends f.a{constructor(fa){super(fa)}Fd(){let fa;fa=l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(ya.d)(m.a.resolve(n.x,{rb:this.Na})):
X.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.Na);const Ua=X.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Na);T.TaskExtensions.za(T.TaskExtensions.Pd([fa,Ua],this.ka),()=>{var Aa=new qa(this.$.pa.va,this.$.userOperationManager);const Ib=new pa(Ua.result);Aa=new Ha(this.$.frame,Aa,Ib,fa.result);this.$.da.Ha(191,Aa);this.qd([Aa])},this.$.ka,3)}static la(fa){f.a.Yd(190,new za(fa))}}Object(C.a)(za,"AccountingFormatMenuCommandHandlerFactory",f.a,[]);var cb=a(1335),Pa=a(45),nb=a(21),
Ma=a(2),Oa=a(160),La=a(795),ra=a(15),V=a(275);class ma{constructor(fa,Ua){this.v$g=(Aa,Ib)=>{1===Aa?(Aa=Ib.resultLanguageIndex,F.ULS.sendTraceTag(537155167,0,50,`ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on OK. selected index:${Aa}`),this.numberFormatViewModel.DAc(Aa,"ChangeLocaleDialog")):F.ULS.sendTraceTag(537155166,0,50,"ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on Cancel");this.dispose()};this.jAa=()=>{this.numberFormatViewModel.Gtd(2,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded")&&
(F.ULS.sendTraceTag(537155165,0,50,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded success"),this.T7i())};this.iAa=()=>{F.ULS.sendTraceTag(537155164,0,15,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded failure")};this.numberFormatViewModel=Ua;this.activeCell=fa;this.numberFormatViewModel.J_a(this.jAa);this.numberFormatViewModel.d_c(this.iAa)}initialize(){const fa=Object(Ma.a)(new La.a,{Caller:2,NumberFormatCategory:-1});this.numberFormatViewModel.awb(this.activeCell,fa)}dispose(){this.numberFormatViewModel&&
(this.numberFormatViewModel.Udb(this.jAa),this.numberFormatViewModel.sOd(this.iAa))}T7i(){const fa={[V.a.Gt]:"ChangeLocaleDialog",["languageList"]:this.numberFormatViewModel.Ji.Locales,["helpLink"]:this.numberFormatViewModel.MOf},Ua=new Oa.a(!1,!1,!0);Ua.Xb=1;Ua.ye="ChangeLocaleDialog";Ua.initializeAndShow(ra.a.instance.ha(2218),this.v$g,fa)}}Object(C.a)(ma,"ChangeLocaleDialog",null,[2]);var W=a(1219),aa=a(33);class ia{constructor(fa,Ua){this.$=fa;this.numberFormatViewModel=Ua}Oc(){return!1}Ac(fa,
Ua){fa=!1;switch(Ua.command){case 2105621672:case -168056295:case 151715844:fa=!0}return fa}executeCommand(fa,Ua,Aa){fa=!1;switch(Ua.command){case 151715844:fa=this.x7i();break;case 2105621672:case -168056295:if(aa.a.Wsd())return this.$.Xc(-395879625,h.a.Eb,0,Aa);fa=this.openNumberFormatDialog(Ua,Aa)}return w.Task.Ua(fa)}Vc(){return!1}vdc(){let fa=null;const Ua=nb.h(this.$).ga.qa.activeCell;Ua&&(fa=Pa.o(Ua,this.$));return fa}openNumberFormatDialog(fa,Ua){var Aa;let Ib=null;h.a.Uc in Ua&&Ua[h.a.Uc]&&
(Ib=parseInt(Ua[h.a.Uc].toString(),10));const Pb=this.vdc();if(!Pb)return!1;this.numberFormatViewModel.nQd();Ua=null!==(Aa=null===Ua||void 0===Ua?void 0:Ua.onClose)&&void 0!==Aa?Aa:Fa=>{Fa&&this.numberFormatViewModel.formatCells(this.numberFormatViewModel.Tyb(),fa)};(new W.a(this.$,Pb,this.numberFormatViewModel,fa,Ib,Ua)).initialize();return!0}x7i(){const fa=this.vdc();if(!fa)return!1;this.numberFormatViewModel.nQd();(new ma(fa,this.numberFormatViewModel)).initialize();return!0}}Object(C.a)(ia,"NumberFormatCommandHandler",
null,[233]);var ka=a(1059);class Xa extends f.a{constructor(fa){super(fa)}Fd(){let fa;fa=l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(ya.d)(m.a.resolve(n.x,{rb:this.Na})):X.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.Na);T.TaskExtensions.za(fa,()=>{var Ua=new ka.a(this.$,fa.result,new cb.a(this.$));Ua=new ia(this.$,Ua);this.qd([Ua])},this.$.ka,3)}static la(fa){f.a.Yd(189,new Xa(fa))}}Object(C.a)(Xa,"NumberFormatCommandHandlerFactory",
f.a,[]);var sb=a(967);class ib extends f.a{constructor(fa){super(fa)}Fd(){this.$.Fz(()=>{this.qd([new sb.ConditionalFormattingCommandHandler(this.$)])})}static la(fa){f.a.Yd(247,new ib(fa))}}Object(C.a)(ib,"ConditionalFormattingCommandHandlerFactory",f.a,[]);ua=a(228);var Ub=a(1336),hc=a(426);class yb extends ua.a{constructor(fa){super();this.rh=this.ui=null;this.$=fa;this.Mb()}get RD(){this.ui||(this.ui=T.TaskExtensions.za(hc.a(this.$),fa=>{this.rh=Ub.a.la(this.$,fa.result)},this.ka,3));return this.ui}create(){const fa=
X.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),Ua=X.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);T.TaskExtensions.za(T.TaskExtensions.ts(T.TaskExtensions.Pd([fa,Ua],this.ka),()=>this.RD,this.ka),()=>{this.vb(this.rh)},this.ka,3)}dispose(){this.rh=this.ui=this.$=null;super.dispose()}static la(fa){fa.da.Ha(249,new yb(fa))}}Object(C.a)(yb,"ConditionalFormattingTaskPaneFactory",ua.a,[]);var Gb=a(54),Sa=a(726),db=a(163),fb=a(429),ab=a(341),wb=a(725),kb=a(166),tb=a(711);class hb{constructor(fa=
null,Ua=null,Aa=null,Ib,Pb=null){this.pJc=null;this.T6d=!1;this.Yae=this.HWa=null;this.YHg=this.Eme=this.Xwg=this.Zae=!1;this.CUb=null;this.hxg=null==Ua?c.AFrameworkApplication.iIa:Ua;this.ACg=null==Aa?c.AFrameworkApplication.Mxa:Aa;this.vIg=null==Pb?c.AFrameworkApplication.Gpa:Pb;this.QBg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeHelpOnHelpIsEnabled");this.sJg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeCommandHookIsEnabled");this.mJj(!!c.AFrameworkApplication.fa&&
c.AFrameworkApplication.fa.ra("TellMeIgnoreQueryForHelp"));this.kJg=!!c.AFrameworkApplication.sa&&c.AFrameworkApplication.sa.Pa.ODb;this.lJg=!wb.a.nya()&&!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMePeopleSuggestionIsEnabled");this.jJg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeFileSuggestionIsEnabled");this.EAg=!!c.AFrameworkApplication.sa&&c.AFrameworkApplication.sa.Pa.VTa;this.mJg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeSeeMoreButtonIsEnabledInZeroTerm");
this.QHg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("HelpShowsTopSearchResult");this.sFg=this.ZOb||this.YOb;this.qFg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("OnlineCommandSuggestionsIsEnabled");this.rFg=this.Mtd;this.BDg=!!c.AFrameworkApplication.fa&&this.tellMeInSharedHeaderIsEnabled&&c.AFrameworkApplication.fa.ra("StyledHeaderInLabelIsEnabled");this.pBg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",
1400):1400;this.vBg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.lBg=c.AFrameworkApplication.fa?parseFloat(c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.zDg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.ra("SmartLookupNoteSearchIsEnabled")||c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1));this.GCg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenSerpletActionAIFromTellMe",!1)&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableActionAITab",!1)&&wb.a.zR();this.KZb=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.SIg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl",
"https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.xBg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.RHg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.oIg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.WHg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("ShowFindInDocumentInZeroTermSearchBox")||this.Sy;this.JDg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.ra("TellMeTemplateProviderIsEnabled")||c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.kDg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",
!1);this.uDg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeIsRuleBasedSortingEnabled")&&"en-US"===c.AFrameworkApplication.uiCulture;this.GDg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.ra("TellMeFeedbackProviderIsEnabled")||c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.NDg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Ywg=
this.tellMeInSharedHeaderIsEnabled&&!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.JBg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.sIg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==
c.AFrameworkApplication.fa.Wa("Application"));this.Hxg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.jKg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||c.AFrameworkApplication.fa.ra("TellMePerformanceMarkerEnabled"));this.KCg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",
!1);this.OCg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.uBg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.IDg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeNotesSuggestionIsEnabled")||this.hqf;this.MCg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",
!1);this.NCg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.LCg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.dAg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);
this.eAg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.nJg=this.$Ai&&(this.dHd||this.eHd||this.PIb||this.tellMeInSharedHeaderIsEnabled&&wb.a.zR()&&!!c.AFrameworkApplication.fa&&(this.Wfb||this.Sfb||this.Tfb||this.Ufb||this.Yfb||c.AFrameworkApplication.fa.ra("ShowAnswerSearchResults")||c.AFrameworkApplication.fa.ra("ShowDefinitionSearchResults")||c.AFrameworkApplication.fa.ra("ShowEntitySearchResults")||
c.AFrameworkApplication.fa.ra("ShowWolframSearchResults")));this.xwg=!!c.AFrameworkApplication.fa&&!c.AFrameworkApplication.fa.ra("AppsForOfficeThirdPartyIsDisabled")&&c.AFrameworkApplication.fa.ra("AppsForOfficeAllowExternalMarketplace")&&c.AFrameworkApplication.WP;this.ywg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("AppsForOfficePrivateCatalogIsEnabled");this.hmi(fa||{});this.qZb="2918242107";this.pZb="1454393937";this.nGa={};this.ata=[];this.Gdh=[wb.a.sFc]}get application(){return this.HWa}get iIa(){return this.hxg}get Tzj(){return this.qZb}get Szj(){return this.pZb}get u_e(){return this.Yae}get fMh(){return this.Zae}get Mxa(){return this.ACg}get Gpa(){return this.vIg}get eIa(){return this.Xwg}get Ahi(){return this.QBg}get QXj(){return this.sJg}get $Ai(){return!0}get JXj(){return this.nJg}get ULj(){return this.Eme}mJj(fa){this.Eme=
fa}get tellMeInSharedHeaderIsEnabled(){return this.kJg}get JQb(){return this.lJg}get IQb(){return this.jJg}get fetchTokensForSearch(){return this.EAg}get HXj(){return this.mJg}get e1d(){return!1}get PIb(){return this.sFg}get dHd(){return this.qFg}get eHd(){return this.rFg}get Hya(){return!1}get dmc(){return!1}get Dvd(){return this.BDg}get AWd(){return this.YHg}get Wfb(){return!1}get hNj(){return!1}get XEi(){return""}get Q5h(){return 4}get R5h(){return 5}get f8h(){return""}get AZh(){return this.pBg}get K$e(){return this.vBg}get h8h(){return 1E3}get g8h(){return 1E-6}get RVj(){return this.SIg}get uZd(){return!1}get QVj(){return!1}get nzi(){return this.uDg}get gvd(){return!1}get hvd(){return!1}get Jwi(){return!1}get Iwi(){return!1}get hqf(){return!1}get kqf(){return!1}get v_e(){return!1}get Mfb(){return!1}get Sfb(){return!1}get Tfb(){return!1}get Ufb(){return!1}get Yfb(){return!1}get ZOb(){return this.QHg}get Ofb(){return this.RHg}get YOb(){return!1}get H4e(){return null}get cvd(){return!1}get GBc(){return this.WHg}get p8e(){return 0}get dWh(){return this.lBg}get baf(){return this.xBg}get hAi(){return this.zDg}get Zic(){return this.GCg}get oWd(){return this.KZb}get P7e(){return-3.9}get Sy(){return this.oIg}get PDb(){return this.JDg}get Vtd(){return this.kDg}get Lvd(){return this.GDg}get Pta(){return this.Ywg}get wCi(){return this.NDg}get p_(){return this.JBg}get eeg(){return this.sIg}get l0g(){return this.Hxg}get dHc(){return this.jKg}get bjc(){return this.KCg}get Oqi(){return this.OCg}get zl(){return this.uBg}get Iya(){return this.IDg}get Mqi(){return this.MCg}get Nqi(){return this.NCg}get Lqi(){return this.LCg}get Hue(){return this.xwg}get Iue(){return this.ywg}get HQ(){return this.dAg}get dac(){return this.eAg}get LK(){return!!c.AFrameworkApplication.sa&&
c.AFrameworkApplication.sa.Pa.Yi}get Yi(){return!!c.AFrameworkApplication.sa&&c.AFrameworkApplication.sa.Pa.Yi}get Uwi(){return!!c.AFrameworkApplication.sa&&c.AFrameworkApplication.sa.Pa.CMj}get YAf(){return kb.getImageClass("OfficeAssistant_32x32x32")}XZh(){return Promise.reject("GetFindMatchCount method is not overridden")}qmc(fa){return Array.contains(appChrome.selectors.getVisibleControlIds(),fa)}Ejc(){return!1}get Htd(){return!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeModelRankerEnabled")}get Ohg(){return c.AFrameworkApplication.fa?
c.AFrameworkApplication.fa.Wa("TellMeServiceHelpClassifierModelName"):""}get Mtd(){return!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.ra("TellMeMultiLingualCommandModelEnabled")}get ahc(){return"NoOpHeaderUi"}get Fdh(){return this.CUb}get parameterData(){return this.nGa}get D2j(){return this.ata}Mxh(){if(this.pJc&&!this.T6d&&(this.T6d=!0,this.o$f(this.pJc),this.Yi)){var fa=P.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");fa=(new tb.a(fa)).y5a(this.pJc.ej);appChrome.api.dispatch(fa)}}get T5f(){return""}o$f(){}Aqh(fa){const Ua=
[];for(let Aa=0;Aa<fa.length;++Aa)fa[Aa].SNj?Ua.push(new ab.a(fa[Aa].eVg,wb.a.Rkg+Aa.toString())):Ua.push(new ab.a(fa[Aa].standard,wb.a.sFc+Aa.toString()));return Ua}hmi(fa){const Ua={};for(let Aa in fa){const Ib=Aa,Pb=fa[Aa];for(let Fa in Pb){const da=Fa,K=Pb[Fa];(Ua[da]||(Ua[da]={}))[Ib]=K}}this.CUb=Ua}get Phg(){return""}get Qcg(){return!1}}Object(C.a)(hb,"TellMeApplicationData",null,[245]);class Fb{constructor(fa,Ua=null,Aa=!1){this.standard=fa;this.eVg=Ua;this.SNj=Aa}}Object(C.a)(Fb,"TryQuerySet",
null,[]);var va=a(259);class jb{constructor(){this.jhe=this.khe=null}get POi(){return this.jhe}tQ(fa){this.khe=fa;return this.Pih(fa)}vRi(){this.jhe=this.khe}K1h(fa){return 8===fa.type?String.format(CommonUIStrings.l_FindInDocumentText,fa.bA):fa.bA}FWh(fa){return fa.bA}}Object(C.a)(jb,"ParameterizedCommand",null,[]);var Ab=a(324);class Qa extends jb{constructor(fa){super();this.isReactRibbonEnabled=fa}get commandId(){return this.isReactRibbonEnabled?"FindParameterized":"Editing.Find"}get i9i(){return"Find"}Pih(fa){const Ua=
N.a.kf(String.format(ra.a.instance.Va(431),fa.bA));return Ab.a(wb.a.zmh(fa.value),"1540292897",Ua,"find16",null,N.a.kf(fa.bA),Ua,null,null)}}Object(C.a)(Qa,"FindParameterizedCommand",jb,[]);class Z extends hb{constructor(fa){super();this.HWa="Excel";this.qZb="-1376725189";this.pZb="-1386334072";var Ua=new Qa(this.Yi);this.parameterData[Ua.commandId]=Ua;c.AFrameworkApplication.fa.ra("TellMeTryQueriesIsEnabled")&&(Ua=[new Fb(ra.a.instance.Va(426),"",!1),new Fb(ra.a.instance.Va(427),"",!1),new Fb(ra.a.instance.Va(428),
"",!1),new Fb(ra.a.instance.Va(429),"",!1),new Fb(ra.a.instance.Va(430),"",!1)],this.ata=this.Aqh(Ua));c.AFrameworkApplication.fa.ra("TellMeFindInDocumentIsEnabled")&&(this.Zae=!0,this.Yae=this.Yi?"FindParameterized":"EditingFind");this.$=fa}get HBa(){return va.a.JMb}get YAf(){return kb.getImageClass("OfficeAssistant_32x32x32")}o$f(fa){const Ua=c.AFrameworkApplication.fa.ra("TellMeDesktopUpSellIsEnabled")&&c.AFrameworkApplication.fa.ra("TellMeDesktopUpSellInExcel"),Aa=c.AFrameworkApplication.aBi;
fa=fa.ej;fa.MacrosUpSellButton=!Ua||Aa;fa.HeaderFooterUpSellButton=!Ua||Aa;fa.MacrosUpSellButtonEnterprise=!Ua||!Aa;fa.HeaderFooterUpSellButtonEnterprise=!Ua||!Aa}get hqf(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.NotesSuggestionIsEnabled",!1)}get kqf(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ZeroTermNotesSuggestionIsEnabled",!1)}get p8e(){return c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.Excel.TellMe.NumberOfNotesSuggestionsToShow",
2)}get Phg(){return c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.MultiLanguageModelName","")}get uZd(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ServiceAADAuthIsEnabled",!1)}get Ohg(){return c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.HelpClassifierModelName","")}get Wfb(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowImageSearchResults",!1)}get Mtd(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.MLCModelIsEnabled",
!1)}get Qcg(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowMoreFileResults",!1)}get dmc(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.EnableRankerLogging",!1)}get P7e(){var fa=c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.NBClassifierScoreThreshold","-7.0");fa=parseFloat(fa);return isNaN(fa)?-7:fa}get Hue(){let fa=!1;this.$&&(fa=!l.EwaSettings.ya(174)&&this.$.ea.Lg.get(27)&&this.$.WP);
return fa}get Iue(){let fa=!1;this.$&&(fa=this.$.se.get(35));return fa}}Object(C.a)(Z,"ExcelTellMeApplicationData",hb,[]);class wa{constructor(fa){this.commandUIManager=null;this.KVi=Ua=>{this.commandUIManager=Ua;db.a(this.kd).GHa(this.Lda)};this.Lda=()=>{this.commandUIManager=this.kd.da.Aa(53)};this.kd=fa;this.kd.da.kb(53,this.KVi)}Oc(){return!1}executeCommand(fa,Ua,Aa){fa=0;switch(Ua.command){case -1642491107:fa=x.a.tellMe;break;case -240091811:fa=x.a.tellMeAccessibilityMenuText;break;case -1543335331:fa=
x.a.tellMeCacheAsyncMenuRefresh;break;case 815990803:fa=x.a.tellMeFocusInput;break;case 586156566:fa=x.a.tellMeInteractionBegin;break;case -1051173363:fa=x.a.tellMeRestoreFocus;break;case 878547493:fa=x.a.tellMeLogCommandExecuted;break;case 1024534176:fa=x.a.tellMeLogInputBlur;break;case -1991747669:fa=x.a.tellMeLogInputFocus;break;case -28797232:fa=x.a.tellMeLogMenuClose;break;case -1814078912:fa=x.a.tellMeLogMenuOpen;break;case 1404166600:fa=x.a.tellMeTryQuery;break;case -2064212100:fa=x.a.tellMeFeedback}let Ib=
0;fa&&(Ib=c.AFrameworkApplication.xb.ie(fa,2,Aa),this.k9j());F.ULS.sendTraceTag(537151007,0,50,`TellMeCommandHandler.ExecuteCommand: ActionId (${fa}) , response (${Ib})`);return fa&&2!==Ib?w.Task.Ua(!0):u.a(Ua.command)}Ac(fa,Ua){fa=!1;switch(Ua.command){case -1642491107:case -240091811:case -1543335331:case 815990803:case 586156566:case 878547493:case 1024534176:case -1991747669:case -28797232:case -1814078912:case 1404166600:case -2064212100:fa=!0}return fa}Vc(fa,Ua,Aa){"PopulateTellMe"===Ua&&c.AFrameworkApplication.xb.ie(x.a.tellMe,
2,Aa);return!1}dispose(){!!this.kd&!!db.a(this.kd)&&db.a(this.kd).pSa(this.Lda);this.commandUIManager=null}k9j(){!l.EwaSettings.ya(23)&&this.commandUIManager&&this.commandUIManager.Rmg("sbTellMe",!1)}static initData(fa){fa=new Z(fa);Sa.TellMeActor.instance.initialize(fa,null,null,null,null,null,fb.a.LJ.tqa,c.AFrameworkApplication.fa,P.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),null,P.a.instance.$b("Common.ISystemInitiatedFeedback"));Sa.TellMeActor.instance.Pg()}}
Object(C.a)(wa,"TellMeCommandHandler",null,[233,2]);class Ea extends f.a{constructor(fa){super(fa)}Fd(){const fa=[];var Ua=Gb.a.loadScript(c.AFrameworkApplication.sa.Pa.gqf?94:93,4,this.Na,void 0,void 0,108);fa.push(Ua);Ua=!1;(Ua=c.AFrameworkApplication.fa.ra("TellMeIsSuggestionsForSimplifiedUxEnabled"))&&fa.push(Gb.a.loadScript(95,4,this.Na,void 0,void 0,108));Ua=!1;(Ua=c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterAgaveCommandManagerForTellMeAddinSearch",!1))&&
fa.push(X.GetServiceTaskFactory.Sa(this.$.da,374,375,1));T.TaskExtensions.za(w.Task.FG(...fa),()=>{l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.InitTellMeApplicationDataWithEwaControl",!1)?wa.initData(this.$):wa.initData();this.qd([new wa(this.$)])},this.ka,3)}static la(fa){f.a.Yd(108,new Ea(fa))}}Object(C.a)(Ea,"TellMeCommandHandlerFactory",f.a,[]);a=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",
attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ConditionalFormatting");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.NumberFormat");Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Assistance");(()=>{c.AFrameworkApplication.iIa&&(b.a.instance.dj(new ea),ha.a.Fa(fa=>
{Object(z.b)("OfficeVSO:7649055_AssistanceCommandHandlerMigrationEnabled")||A.la(fa)}))})();Type.registerNamespace("NLRT");e.a.Hi('.NumberFormatStyleItem{color:#444;font:inherit}.NumberFormatStyleItem select,.NumberFormatStyleItem input{margin-bottom:1.5%}.NumberFormatCategoryList{width:22%;height:50%;margin-bottom:20%;height:65%}.NumberFormatRtlFloat{float:right}.NumberFormatLtrFloat{float:left}.NumberFormatDynamicList{width:70%;height:70%}.NumberFormatDynamicListRtlMargin{margin-right:3%}.NumberFormatDynamicListLtrMargin{margin-left:3%}.NumberFormatDlgFunctionBody{margin:0 13px 10px 13px;width:100%;height:346px}.NumberFormatDlgWidth{width:560px}.NumberFormatDlgBodyWidth{width:560px}.NumberFormatDescriptionItem{height:32%;width:95%;position:relative;top:4%;z-index:-1}.NumberFormatLinkItem{margin-bottom:6px;display:inline-block}.NumberFormatRtlLabelItem{margin-left:2%}.NumberFormatLtrLabelItem{margin-right:2%}.NumberFormatSampleItem{width:100%;background-color:#fff}.NumberFormatDynamicListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemHeight{max-height:325px}.NumberFormatSymbolItemWidth{width:100%}.NumberFormatItemColorStyle{color:#f00}.NumberFormatFocusCheckbox{outline:none}.NumberFormatBorderLabel{border:1px #808080 dashed}.NumberFormatFontLabel{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif}.NumberFormatSelectionBorder{border:1px solid #a9a9a9}');
ha.a.Fa(Xa.la);ha.a.Fa(za.la);e.a.Hi('.ewa-condfmt-dlg-err-label{width:400px;min-height:21px;margin-bottom:-15px;font-size:8pt;color:#d90000}.ewa-condfmt-dlg-header-label{font-weight:bold}.ewa-condfmt-dlg-with-label{padding-left:3px;padding-right:3px}.ewa-condfmt-dlg-list{width:auto;width:initial}.ewa-condfmt-dlg-input{width:auto;width:initial;padding-left:3px}.CondtionalFormattingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.CondtionalFormattingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.CondtionalFormattingPaneBody{flex:auto;position:relative}.CondtionalFormattingPaneTitle{position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.CondtionalFormattingCloseButton{display:inline-block;padding:0 5px;font-size:16px}');
(()=>{ha.a.Fa(fa=>{yb.la(fa);ib.la(fa)})})();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");ha.a.Fa(Ea.la);Type.registerNamespace("Common.App.Assistance");a;String(t);window.___1680633106624_closurehack=t},723:function(t,C,a){a.r(C);t=a(0);var c=a(425),b=a(745),f=a(727),e=a(927),d=a(928);class h{constructor(l,u){this.Ura=!1;this.LR=null;if(!l)throw Error.argumentNull("annotations");
if(!l.M9a(u))throw Error.argument("structTypeID","Invalid struct type ID");this.fm=l;this.P$a=this.fm.m8e(u);this.MIg=u}get k0a(){return this.fm}get isReadOnly(){return this.Ura}get zfa(){return this.MIg}Fwa(l){if(0>l||l>=this.P$a)throw Error.argument("iField","Invalid field index");return this.LR&&null!=this.LR[l]?this.LR[l]:this.fm.Y$e(this.zfa,l)}ITd(l,u){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>l||l>=this.P$a)throw Error.argument("iField",
"Invalid field index");if(!this.fm.H8a(this.fm.DMa(this.zfa,l),u))throw Error.argument("value","Value is not of the correct type for the specified field");(this.LR||(this.LR=Array(this.P$a)))[l]=u}kP(){const {Annotations:l}=a(723);let u="[";if(this.LR){let v=!0;for(let x=0;x<this.P$a;++x){if(null==this.LR[x])continue;const w=this.fm.DMa(this.zfa,x);if(l.JDa(w,this.LR[x],this.fm.Y$e(this.zfa,x)))continue;v?v=!1:u+=", ";u+=this.fm.Z$e(this.zfa,x);u+="=";const m=this.fm.kP(w,this.LR[x]);w===l.KL?(u+=
'"',u+=b.a.zcd(m),u+='"'):u+=m}}return u+"]"}isEqual(l){const {Annotations:u}=a(723);if(this===l)return!0;if(!l||this.fm!==l.k0a||this.zfa!==l.zfa)return!1;for(let v=0;v<this.P$a;++v)if(!u.JDa(this.fm.DMa(this.zfa,v),this.Fwa(v),l.Fwa(v)))return!1;return!0}clone(){const l=new h(this.fm,this.zfa);this.LR&&(l.LR=Array.clone(this.LR));return l}ZA(){return this.isReadOnly?this.clone():this}Eyd(){const {Annotations:l}=a(723);if(!this.isReadOnly&&(this.Ura=!0,this.LR))for(let u=0;u<this.P$a;++u){const v=
this.LR[u];null!=v&&l.yPa(v)}}toString(){return this.kP()}}Object(t.a)(h,"StructValue",null,[293,291]);a.d(C,"Annotations",function(){return r});class r{constructor(l,u){if(!l)throw Error.argumentNull("initData");if(!u)throw Error.argumentNull("objectFetcher");this.HKi=u.Eth;let v=0;var x=u.uwa(l.ma(v));++v;this.zAd=new e.a(new d.a(x));this.mAg=l.ma(v);++v;this.Fwf=Array(this.Aac);this.NFb=Array(this.Aac);this.mza=Array(this.Aac);for(x=0;x<this.Aac;++x){this.Fwf[x]=u.ha(l.ma(v));++v;this.NFb[x]=l.ma(v);
++v;var w=l.ma(v);++v;this.mza[x]=Array(w);for(var m=0;m<w;++m)this.mza[x][m]=u.ha(l.ma(v)),++v}this.LIg=l.ma(v);++v;this.Bxf=Array(this.dQb);this.Joc=Array(this.dQb);this.Koc=Array(this.dQb);this.Ioc=Array(this.dQb);for(x=0;x<this.dQb;++x)for(this.Bxf[x]=u.ha(l.ma(v)),++v,w=l.ma(v),++v,this.Joc[x]=Array(w),this.Koc[x]=Array(w),this.Ioc[x]=Array(w),m=0;m<w;++m)this.Joc[x][m]=u.ha(l.ma(v)),++v,this.Koc[x][m]=l.ma(v),++v,this.Ioc[x][m]=({iR:v}=this.kKa(this.Koc[x][m],l,v,null,null,null)).returnValue,
r.yPa(this.Ioc[x][m]);this.kxg=l.ma(v);++v;this.Xzd=Array(this.J0a);this.Yzd=Array(this.J0a);this.Wzd=Array(this.J0a);for(x=0;x<this.J0a;++x)this.Xzd[x]=u.ha(l.ma(v)),++v,this.Yzd[x]=l.ma(v),++v,this.Wzd[x]=({iR:v}=this.kKa(this.Yzd[x],l,v,null,null,null)).returnValue,r.yPa(this.Wzd[x])}Mxb(l){for(let u=0;u<this.J0a;++u)if(this.Xzd[u]===l)return u;return-1}m3e(l){if(!this.K9a(l))throw Error.argument("attrID","Invalid attribute ID");return this.Xzd[l]}getAttributeType(l){if(!this.K9a(l))throw Error.argument("attrID",
"Invalid attribute ID");return this.Yzd[l]}DMa(l,u){if(!this.M9a(l))throw Error.argument("structTypeID","Invalid struct type ID");l=this.Koc[r.eQb(l)];if(0>u||u>=l.length)throw Error.argument("iField","Invalid field index");return l[u]}kP(l,u){if(!this.kwd(l))throw Error.argument("typeID","Invalid type ID");if(!this.H8a(l,u))throw Error.argument("value","Value is not of the correct type");switch(l){case r.KL:return u;case r.K1:return u?"True":"False";case r.f9:case r.OX:return u.toString();case r.dC:return u.kP();
default:if(!r.ju(l)&&r.xRb(l)){l=r.mcd(l);const w=this.mza[l].length;switch(this.NFb[l]){case 0:return this.mza[l][u];case 1:if(u){var v="";for(var x=1;x<w;++x)u&1<<x-1&&(0<v.length&&(v+=" & "),v+=this.mza[l][x]);return v}return this.mza[l][0];case 2:v="";for(x=0;x<w;++x)u&1<<x&&(0<v.length&&(v+=" & "),v+=this.mza[l][x]);return v;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.NFb[l]);}}else return u.kP()}}kwd(l){switch(l){case r.KL:case r.K1:case r.f9:case r.OX:case r.dC:return!0;
default:return r.ju(l)?this.kwd(r.ala(l)):r.xRb(l)?this.OBi(l):this.M9a(l)}}OBi(l){l=r.mcd(l);return 0<=l&&l<this.Fwf.length}M9a(l){l=r.eQb(l);return 0<=l&&l<this.Bxf.length}K9a(l){return 0<=l&&l<this.J0a}H8a(l,u){if(null==u)return!1;switch(l){case r.KL:return"string"===typeof u;case r.K1:return"boolean"===typeof u;case r.f9:return"number"===typeof u;case r.OX:return"number"===typeof u;case r.dC:return Object(c.a)(290,u);default:if(r.ju(l))return Object(c.a)(292,u)&&u.tI===r.ala(l);if(r.xRb(l)){if("number"!==
typeof u)return!1;l=r.mcd(l);const v=this.mza[l].length;switch(this.NFb[l]){case 0:return 0<=u&&u<v;case 1:return!(u&-1<<v-1);case 2:return!!u&&!(u&-1<<v);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.NFb[l]);}}else return Object(c.a)(293,u)&&u.zfa===l}}get J0a(){return this.kxg}get Aac(){return this.mAg}get dQb(){return this.LIg}XTh(l){if(!this.K9a(l))throw Error.argument("attrID","Invalid attribute ID");return this.Wzd[l]}m8e(l){if(!this.M9a(l))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.Joc[r.eQb(l)].length}Z$e(l,u){if(!this.M9a(l))throw Error.argument("structTypeID","Invalid struct type ID");return this.Joc[r.eQb(l)][u]}Y$e(l,u){if(!this.M9a(l))throw Error.argument("structTypeID","Invalid struct type ID");l=this.Ioc[r.eQb(l)];if(0>u||u>=l.length)throw Error.argument("iField","Invalid field index");return l[u]}kKa(l,u,v,x,w,m){if(!u)throw Error.argumentNull("initData");if(r.ju(l)){var n=u.ma(v);++v;l=r.ala(l);var z=new f.a(this,l);for(var y=
0;y<n;++y)Array.add(z.items,({iR:v}=this.kKa(l,u,v,x,w,m)).returnValue);return{returnValue:z,iR:v}}switch(l){case r.KL:return{returnValue:(x||this.zAd).ha(u.ma(v++)),iR:v};case r.K1:return{returnValue:1===u.ma(v++),iR:v};case r.f9:return{returnValue:u.ma(v++),iR:v};case r.OX:return{returnValue:(w||this.HKi)[u.ma(v++)],iR:v};case r.dC:l=u.ma(v++);n=new b.a(this);for(z=0;z<l;++z)y=u.ma(v),++v,m&&(y=m[y]),n.Xn(y,({iR:v}=this.kKa(this.getAttributeType(y),u,v,x,w,m)).returnValue);return{returnValue:n,
iR:v};default:if(r.xRb(l))return{returnValue:u.ma(v++),iR:v};if(r.flg(l)){n=u.ma(v++);z=new h(this,l);for(y=0;y<n;++y){const A=u.ma(v);++v;z.ITd(A,({iR:v}=this.kKa(this.DMa(l,A),u,v,x,w,m)).returnValue)}return{returnValue:z,iR:v}}throw Error.argument("typeID","Invalid type ID");}}static xRb(l){return 16<=(l&16383)&&16384!==(l&16384)&&32768!==(l&32768)}static flg(l){return 16<=(l&16383)&&16384===(l&16384)&&32768!==(l&32768)}static ju(l){return 32768===(l&32768)}static j2h(l){if(r.ju(l))throw Error.argument("nonListTypeID",
"Non-list type ID required");return l|32768}static ala(l){if(!r.ju(l))throw Error.argument("listTypeID","List type ID required");return l&-32769}static JDa(l,u,v){switch(l){case r.KL:case r.K1:case r.f9:case r.OX:return u===v;case r.dC:return u.isEqual(v);default:return r.ju(l)?u.isEqual(v):r.xRb(l)?u===v:u.isEqual(v)}}static yPa(l){Object(c.a)(291,l)&&l.Eyd()}static ZA(l){return Object(c.a)(291,l)?l.ZA():l}static mcd(l){return l-16}static eQb(l){return(l&-16385)-16}}r.KL=1;r.K1=2;r.f9=3;r.OX=5;r.dC=
9;Object(t.a)(r,"Annotations",null,[294])},725:function(t,C,a){t=a(0);var c=a(341);class b{constructor(){this.userId=this.email=this.displayName=null}}Object(t.a)(b,"InsertMentionParameters",null,[]);class f{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(t.a)(f,"InsightsParameters",null,[]);var e=a(1063),d=a(1064),h=a(1065),r=a(1066),l=a(6);class u{constructor(){this.currentDocumentPath=l.AFrameworkApplication.fa.Wa("EditDocInClientUrl")}}Object(t.a)(u,"SmartLookupApplicationInterface",
null,[]);class v{}Object(t.a)(v,"SmartLookupSelection",null,[]);var x=a(42),w=a(29),m=a(34),n=a(719);a.d(C,"a",function(){return z});class z{static get Moi(){return"Insights_16x16x32"}static get eMh(){return"Find_16x16x32"}static get oPf(){return"-Parameterized"}static get JXd(){return"Parameterized"}static get sFc(){return"bTryQuery"}static get u1d(){return"TellMeSuggestion_"}static get Rkg(){return"bTryQueryAlternate"}static get v_d(){return"MenuTellMe"}static get y$i(){const y={},A=[];Array.add(A,
{Term:{PeopleType:"Person"}});y.And=A;return y}static zmh(y){return y+z.oPf}static getParameter(y){let A="",F="";if(y)for(let D=0;D<y.FZe;++D)"Type"===y.bMa(D)?A=y.fxa(D):"Value"===y.bMa(D)&&(F=y.fxa(D));return new c.a(A,F)}static X8c(y){y=Object.assign(new f,{neighborhood:y,mentionStart:0,mentionLength:y.length});return x.c(y)}static LLe(y,A,F){y=Object.assign(new b,{displayName:y,email:A,userId:F});return x.c(y)}static nja(y,A,F=null){return x.c(z.L$e(y,A,F,null))}static L$e(y,A,F=null,D=null){y=
Object.assign(new v,{neighborhood:y,mentionStart:0,mentionLength:y?y.length:0});return Object.assign(new u,{selection:y,userIntent:D,entryPoint:A,launchData:F})}static Tvj(y,A){return z.nja(y,z.P2f(A))}static P2f(y){switch(y){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static bmf(){return!!l.AFrameworkApplication.fa&&l.AFrameworkApplication.fa.ra("IsGoLocalEnvironment")}static MOa(){const y=
l.AFrameworkApplication.fa?l.AFrameworkApplication.fa.Wa("SovereignEnvironmentName"):null;return!!y&&0<y.length}static isEnterpriseUser(){const y=l.AFrameworkApplication.fa?l.AFrameworkApplication.fa.Wa("HostAuthType"):null;return!!y&&"aad"===y.toLowerCase()||"external"===y&&z.jsd()}static WVd(y){return y.JXj&&!z.MOa()}static ipf(){const y=l.AFrameworkApplication.fa?l.AFrameworkApplication.fa.Wa("UiHostIntegrationType"):"";return!!l.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===y&&l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static VVd(y){return y.tellMeInSharedHeaderIsEnabled&&y.fetchTokensForSearch&&(y.JQb||y.IQb||y.Iya)&&!z.ipf()&&z.isEnterpriseUser()&&!z.MOa()}static zR(){return l.AFrameworkApplication.fa?l.AFrameworkApplication.Gpa||l.AFrameworkApplication.fa.ra("SmartLookupEnableNativePane"):l.AFrameworkApplication.Gpa}static Nz(y){return!y||z.Ppf(y.Rd)}static Ppf(y){return!y||!y.trim().length}static oFc(y){if(!y)return 0;const A=Math.pow(10,5);return Math.round(y*A)/A}static toUtc(y){return y?new Date(y.getUTCFullYear(),
y.getUTCMonth(),y.getUTCDate(),y.getUTCHours(),y.getUTCMinutes(),y.getUTCSeconds(),y.getUTCMilliseconds()):null}static Tld(y){y=new Date(y);return(z.toUtc(new Date).getTime()-y.getTime())/1E3}static fqf(y){const {InsightsMenuItemFactory:A}=a(1062);switch(y){case e.a.nod:case d.a.Z_e:case A.sif:case h.a.XAf:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return y.startsWith(z.sFc)||
y.startsWith(z.u1d)||y.startsWith(z.Rkg)||y.startsWith("PeopleSuggestion")||y.startsWith("FileSuggestion")||y.startsWith("FindInDocumentSuggestion")||y.startsWith("NotesSuggestion")||y.startsWith("OnenoteNotesSuggestion")||y.startsWith("SmartLookupFromTellMe")||y.startsWith("GetHelpFromTellMe")||y.startsWith("GetHelpWithDescriptionFromTellMe")||y.startsWith("AddinSuggestion")||y.startsWith("OfficeScripts")?!0:!1}static qjd(y,A){const F=[];Array.add(F,new r.a(400,y));Array.add(F,new r.a(200,A));y=
{};y.parts=F;return JSON.stringify(y)}static swa(y){const A=y.indexOf("<b0>"),F=y.lastIndexOf("</b0>"),D=[];Array.add(D,new r.a(400,y.substring(0,A)));Array.add(D,new r.a(600,y.substring(A+4,F)));Array.add(D,new r.a(400,y.substring(F+5,y.length)));y={};y.parts=D;return JSON.stringify(y)}static uaf(y){const A=z.Tld(y);return 60>A?CommonUIStrings.l_TimeSince_SecsAgo:3600>A?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(A/60).toString()):86400>A?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(A/3600).toString()):172800>A?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(y)).localeFormat("MMMM dd, yyyy"))}static zWh(y){const A=Array(y.length);for(let F=0;F<y.length;F++)A[F]=y[F].commandId;return A}static jsd(){if("Dev Box"===l.AFrameworkApplication.fa.Wa("StatusBarEnvironmentNameToUse"))return!0;let y=l.AFrameworkApplication.fa.Wa("UserPrincipalName");y=n.c(y)?"":m.a.Ok(y);const A=l.AFrameworkApplication.fa.Sp("TellMeIntEnabledForFeatureCrew")?
l.AFrameworkApplication.fa.Ow("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(A,y)&&"inner"===l.AFrameworkApplication.fa.Wa("Microsoft365Ring")}static M0h(y){switch(z.uec(y)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static P8h(y){y=z.uec(y);switch(y){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return y}}static uec(y){switch(y.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static nya(){return w.a.Ww&&!w.a.Lo}}z.kjg=9E5;Object(t.a)(z,"TellMeUtils",null,[])},726:function(t,C,a){a.r(C);t=a(0);var c=a(708),b=a(562),f=a(88),e=a(425),d=a(89),h=a(978),r=a(96);class l{constructor(kb,tb,hb,Fb,va,jb){this.groupType=kb;this.resultType=tb;this.mZd=hb;this.QMa=Fb;this.oad=va;this.resultIndex=
jb}}Object(t.a)(l,"ClickLoggingInfo",null,[]);const u=kb=>{const tb=[];for(;kb;)Array.add(tb,"{ContextId:"+kb.contextId+", IsGraphNodeContext:"+kb.okc+"}"),kb=kb.VGb;tb.reverse();return"{"+tb.join(", ")+"}"};class v{constructor(){this.VV=this.sessionId=null}}Object(t.a)(v,"CorrelationRecord",null,[221]);var x=a(752);class w{constructor(kb,tb){this.provider=kb;this.Ghb=tb}}Object(t.a)(w,"ExternalResultProvider",null,[]);class m{constructor(kb,tb){this.Id=null;this.TimeStamp=0;this.Id=kb;this.TimeStamp=
tb}}Object(t.a)(m,"MRUControl",null,[]);var n;(function(kb){kb[kb.Answer=0]="Answer";kb[kb.Definition=1]="Definition";kb[kb.Entity=2]="Entity";kb[kb.WolframAnswer=3]="WolframAnswer";kb[kb.Assistance=4]="Assistance";kb[kb.Command=5]="Command";kb[kb.Document=6]="Document";kb[kb.TryQuery=7]="TryQuery";kb[kb.FindInDocument=8]="FindInDocument";kb[kb.HelpAction=9]="HelpAction";kb[kb.Insights=10]="Insights";kb[kb.People=11]="People";kb[kb.Image=12]="Image";kb[kb.FirstRunResult=13]="FirstRunResult";kb[kb.NoCommandsFoundResult=
14]="NoCommandsFoundResult";kb[kb.TestResult=15]="TestResult";kb[kb.AppsForOffice_Installed=16]="AppsForOffice_Installed";kb[kb.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";kb[kb.AppsForOffice_Query=18]="AppsForOffice_Query";kb[kb.Notes_Onenote=19]="Notes_Onenote";kb[kb.Notes_Samsung=20]="Notes_Samsung";kb[kb.Notes_Sticky=21]="Notes_Sticky";kb[kb.Learning=22]="Learning";kb[kb.Feedback=23]="Feedback";kb[kb.Template=24]="Template";kb[kb.ActionAI=25]="ActionAI";kb[kb.ActionAICommand=
26]="ActionAICommand";kb[kb.Addin=27]="Addin";kb[kb.OfficeScript=28]="OfficeScript";kb[kb.AddinStoreEntry=29]="AddinStoreEntry";kb[kb.GenerateSlides=30]="GenerateSlides";kb[kb.SummarizeDeck=31]="SummarizeDeck";kb[kb.Unknown=32]="Unknown"})(n||(n={}));Object(t.b)("ResultType",n);var z=a(925),y=a(725),A=a(6),F=a(812);class D{constructor(kb,tb){this.CEg=10;this.CJ=[];this.O2=[];this.Zde=this.Yde=!1;this.Emb=this.Dmb="";this.FYa=tb;this.Ta=kb;this.Aee=kb.Yi}zwa(){!this.Yde&&this.Aee&&this.Ta&&z.a.inf()&&
(this.Dmb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.Ta.application,this.CJ=this.G3e(),this.Yde=!0);return this.CJ}M5h(){!this.Zde&&this.Aee&&this.Ta&&z.a.inf()&&(this.Emb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.Ta.application,this.O2=this.G3e(!0),this.Zde=!0);return this.O2}bBi(kb){return kb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===kb||"TryOfficeUpsell"===kb}asd(kb){return this.iri(kb)||this.bBi(kb)||y.a.fqf(kb)?!1:!0}q3(kb){kb=kb.ControlId;this.asd(kb)&&(kb=this.UNd(kb),this.poj(kb),
this.ILi(),Array.insert(this.CJ,0,new m(kb,Date.now())),this.Dmb.length&&(kb=JSON.stringify(this.CJ),F.a.instance.setItem(this.Dmb,kb)))}fs(kb){this.HLi();Array.insert(this.O2,0,new m(n[kb],Date.now()));this.Emb.length&&(kb=JSON.stringify(this.O2),F.a.instance.setItem(this.Emb,kb))}G3e(kb=!1){if(!this.CJ.length){var tb=kb?F.a.instance.getItem(this.Emb):F.a.instance.getItem(this.Dmb);if(!tb||""===tb)return kb?this.O2:this.CJ;let hb=null;try{hb=JSON.parse(tb)}catch(Fb){this.a9g(kb),hb=null}if(!hb||
!hb.length||10<hb.length)return kb?this.O2:this.CJ;tb=0;for(const Fb of hb)if(kb||this.Ta.qmc(Fb.Id)&&this.asd(Fb.Id))if(kb?Array.insert(this.O2,tb++,Fb):Array.insert(this.CJ,tb++,Fb),tb===this.FYa)break}return kb?this.O2:this.CJ}W6c(kb){kb=this.UNd(kb);for(const tb of this.CJ)if(tb.Id===kb)return!0;return!1}a9g(kb=!1){F.a.instance.setItem(kb?this.Emb:this.Dmb,"")}Nsi(kb){kb=this.UNd(kb.ControlId);return this.asd(kb)?this.W6c(kb):!1}poj(kb){if(0<this.CJ.length){let tb=0;for(const hb of this.CJ){if(hb.Id===
kb){Array.removeAt(this.CJ,tb);break}tb++}}}UNd(kb){return"Excel"===this.Ta.application&&kb.startsWith("m_excelWebRenderer_ewaCtl_")?kb.substr(26,kb.length):kb}ILi(){this.CJ.length===this.FYa&&Array.removeAt(this.CJ,this.CJ.length-1)}HLi(){this.O2.length===this.CEg&&Array.removeAt(this.O2,this.O2.length-1)}iri(kb){kb=kb.split("|");let tb="";if(6<=kb.length)tb=kb[0];else if(3<=kb.length){if("3"===kb[0])return!0;tb=kb[1]}return tb.startsWith("WA")}static createInstance(kb){let tb=3;A.AFrameworkApplication.fa&&
(tb=A.AFrameworkApplication.fa.Dd("TellMeMaxRecommendedResultsToReturn",3));return new D(kb,tb)}}Object(t.a)(D,"MruControlsManager",null,[220]);class B{constructor(kb){this.nGa=kb}tQ(kb,tb){let hb;return kb.bA&&(hb=this.nGa[kb.value])?hb.tQ(kb,tb):(hb=this.t4e(kb.value))?hb.tQ(hb.POi,tb):null}B4h(kb,tb){if(kb=this.nGa[kb])for(const hb of tb)if(tb=y.a.getParameter(hb),tb.key===kb.i9i)return tb.value;return null}xRi(kb){(kb=this.t4e(kb))&&kb.vRi()}t4e(kb){const tb=kb.indexOf(y.a.oPf);return 0<tb?this.nGa[kb.substring(0,
tb)]:null}}Object(t.a)(B,"ParameterizedCommandManager",null,[219]);var M=a(768);class R{constructor(kb,tb){this.Rd=kb;this.XAa=tb}}Object(t.a)(R,"TellMeQuery",null,[]);var P=a(926);class E{constructor(kb,tb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=kb;this.TimeElapsedSinceClick=tb}}Object(t.a)(E,"CommandClickedEvent",null,[]);var H=a(719);class G{constructor(kb,tb){this.nFg=kb;this.BY=tb}resultsUpdated(kb){this.nFg(H.c(kb.query)?"":kb.query.Rd,kb.Bh,kb.attributes,this.BY,kb.c9a)}}Object(t.a)(G,
"ResultsUpdatedCallback",null,[218]);class N{constructor(kb,tb,hb,Fb,va){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=kb;this.TimeElapsedSinceClick=hb;this.CommandSurface=Fb;this.CommandId=tb;this.TerminalParentControlId=va}}Object(t.a)(N,"UserActionEvent",null,[]);var I=a(198);class O{constructor(kb,tb){this.menuModel=kb;this.resultCount=tb}}Object(t.a)(O,"GeneratedMenuModel",null,[]);class U{constructor(){this.ariaLabel=
this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(t.a)(U,"MenuModel",null,[]);class ca{constructor(kb,tb,hb){this.Ta=kb;this.nGa=tb;this.bHa=hb}kSh(kb,tb,hb){const {TellMeActor:Fb}=a(726);let va=0;const jb=new U,Ab=[];let Qa="";jb.sections=[];let Z=new I.a;const wa=!!this.Ta&&this.Ta.Hya;var Ea=!!this.Ta&&this.Ta.Mfb||A.AFrameworkApplication.sa.Pa.Mfb;for(const Ua of kb){kb=0;wa||(Z=new I.a);const Aa=new I.a;let Ib=Ua.displayName;for(const Pb of Ua.results){if(0<=
Pb.value.indexOf(y.a.JXd)){if(Pb.bA){var fa=this.nGa[Pb.value];if(fa&&Pb.value.endsWith(y.a.JXd)){if("FindParameterized"!==Pb.value&&!Ea){const Fa=[];Fa.push(appChrome.actions.setControlLabel(Pb.value,fa.K1h(Pb)));Fa.push(appChrome.actions.setButtonCommandValueId(Pb.value,fa.FWh(Pb)));appChrome.api.dispatch(Fa)}fa=Pb.value.replace(y.a.JXd,"");Z.remove(fa)?kb--:Aa.add(fa);Z.add(Pb.value);kb++}}}else switch(Pb.type){case 5:Aa.contains(Pb.value)||(Z.add(Pb.value),kb++);break;case 7:Z.add(Pb.bA);kb++;
break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Z.add(Pb.value),kb++}13===Ua.groupType&&(Ib=y.a.zR()?0<tb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,tb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,tb));21===Ua.groupType&&(Ib=CommonUIStrings.l_LearningUILiveText)}va+=kb;""!==
Ib&&0<kb&&(Qa+=" , "+kb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Ib+" , ");0<Z.count&&!wa&&(kb=appChrome.api.menuSection(Z.toArray(),Ua.displayName,null,M.a[Ua.groupType]),Ab.push(kb))}Ea=null;0<va&&(Ea=0<tb.length?1!==va?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,va,tb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,tb):1!==va?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,va):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,
wa?(tb=appChrome.api.menuSection(Z.toArray(),"",null,null),Ab.push(tb)):Ea+=Qa);hb&&(this.Ta.p_?Fb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Ea)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Ea)));jb.sections=Ab;return new O(jb,va,[])}static get Dbd(){return ca.kae||(ca.kae=new O(Object.assign(new U,{sections:[]}),0,[]))}}ca.kae=null;Object(t.a)(ca,"TellMeMenuDefintionGenerator",null,[]);var Q;(function(kb){kb[kb.TellMeControlActivated=0]="TellMeControlActivated";
kb[kb.TellMeQueryExecuted=1]="TellMeQueryExecuted";kb[kb.TellMeResultsRendered=2]="TellMeResultsRendered";kb[kb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(Q||(Q={}));Object(t.b)("PerformanceMarker",Q);var Y;(function(kb){kb[kb.TellMeTimeToRender=0]="TellMeTimeToRender";kb[kb.TellMeSessionLength=1]="TellMeSessionLength";kb[kb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Y||(Y={}));Object(t.b)("PerformanceMeasure",Y);class la{mark(kb){window.performance.mark(Q[kb])}measure(kb,
tb,hb){const {TellMeActor:Fb}=a(726);try{window.performance.measure(Y[kb],Q[tb],Q[hb])}catch(va){Fb.instance.sc.onError("TellMePerformance:Measure","error measuring "+Y[kb])}}Zyd(kb,tb,hb){const {TellMeActor:Fb}=a(726);Fb.instance.sc.hzd(tb,hb,kb,this.D2h(kb))}n9g(){var kb=[0,1,2,3];for(const tb of kb)window.performance.clearMarks(Q[tb])}clearMeasures(kb){for(const tb of kb)window.performance.clearMeasures(Y[tb])}D2h(kb){let tb=0;(kb=this.tTh(kb))&&0<kb.length&&(tb=kb[kb.length-1].duration);return tb}tTh(kb){return window.performance.getEntriesByName(Y[kb],
"measure")}}Object(t.a)(la,"TellMePerformance",null,[]);var ea=a(827),ha=a(826),X=a(42);class T{constructor(kb){this.oJg=kb}CIb(kb,tb,hb){const {TellMeActor:Fb}=a(726);Fb.instance.sc.w0(tb,ha.a.Tcb,kb.data.httpStatus.toString(),Math.round(window.performance.now()-hb),ha.a.Tcb,!0,ea.a.zca);kb=X.b(kb.data.te);tb=-1;kb.Index&&(tb=kb.Index);Fb.instance.sc.pJi(tb,this.oJg)}PHb(kb,tb,hb){const {TellMeActor:Fb}=a(726);Fb.instance.sc.w0(tb,ha.a.Tcb,kb.data.httpStatus.toString(),Math.round(window.performance.now()-
hb),ha.a.Tcb,!1,ea.a.zca)}P5h(kb){if(kb&&""!==kb.trim()){const hb=window.performance.now(),Fb=A.AFrameworkApplication.Ihg;var tb={};tb.Text=kb;tb.IsFileHash="false";tb=X.c(tb);A.AFrameworkApplication.Od.Zm(Fb,2,tb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,va=>{this.CIb(va,kb.length,hb)},va=>{this.PHb(va,kb.length,hb)},null,null,!1,4E3,6E3)}}}Object(t.a)(T,"TellMeQueryIndexCallback",null,[]);var ua=a(730);class Ha{constructor(kb,tb,hb){this.xml=kb;this.resultCount=tb;this.jsh=
hb}}Object(t.a)(Ha,"GeneratedMenuXml",null,[]);var Ca=a(1063),Ga=a(34);class sa{constructor(kb,tb){this.CUb=kb||{};this.$ga=tb}get GSa(){return 5}tQ(kb,tb=null){return this.$ga.tQ(kb,tb)||this.f1g(kb.value)}f1g(kb){return sa.I2c(kb,this.CUb[kb]||null)}static I2c(kb,tb=null){kb=String.format('<ClonedControl Id="{0}" ',kb);for(let va in tb){var hb=va,Fb=tb[va];Fb=Fb?Ga.a.kf(Fb.toString()):"";kb+=String.format('{0}="{1}" ',hb,Fb)}return kb+"/>"}}Object(t.a)(sa,"CommandMenuItemFactory",null,[204]);var bb=
a(324);class Ba{constructor(){this.PAg=CommonUIStrings.l_FindInDocumentText}get GSa(){return 8}tQ(kb){var tb=kb.bA;kb=Ga.a.kf(kb.value);const hb=Ga.a.kf(tb);tb=Ga.a.kf(String.format(this.PAg,tb));return this.NQh(kb,hb,tb)}NQh(kb,tb,hb){return bb.a(kb,"1540292897",hb,y.a.eMh,null,tb,hb,null,null)}}Object(t.a)(Ba,"FindInDocumentMenuItemFactory",null,[204]);var qa=a(1064),pa=a(1062),ya=a(1065);class za{get GSa(){return 7}tQ(kb){const tb=Object(d.a)(P.a,kb);return this.sSh(Ga.a.kf(kb.value),tb.id)}sSh(kb,
tb){return bb.a(tb,"1404166600",kb,null,null,kb,kb,null,null)}}Object(t.a)(za,"TryQueryMenuItemFactory",null,[204]);class cb{constructor(kb){this.Hae=[];this.Ta=kb}zZh(kb){for(const tb of this.Hae)if(tb.GSa===kb)return tb;return null}jBa(kb){this.Hae.push(kb)}ilj(kb){this.jBa(new sa(this.Ta.Fdh,kb));this.jBa(new ya.a(this.Ta.YAf));this.jBa(new Ca.a(this.Ta.Tzj,this.Ta.Szj,this.Ta.QXj,this.Ta.Ahi,this.Ta.ULj));this.jBa(new pa.InsightsMenuItemFactory);this.jBa(new Ba);this.jBa(new qa.a);this.jBa(new za)}}
Object(t.a)(cb,"MenuItemFactoryRegistry",null,[]);var Pa=a(732);class nb{constructor(kb,tb){this.Ta=kb;this.Qge=new cb(this.Ta);this.Qge.ilj(tb)}lSh(kb,tb){let hb=0;const Fb=[],va=[];for(const Ab of kb){kb=y.a.v_d;var jb=[];for(const Qa of Ab.results){const Z=this.Qge.zZh(Qa.type).tQ(Qa,tb);kb=y.a.v_d;jb.push(Z);if(13===Qa.type||14===Qa.type)kb="Menu32";17===Qa.type&&(kb="MenuTellMeExtended");Qa.groupType=Ab.groupType;va.push(Object(d.a)(Pa.a,Qa))}hb=hb?hb:jb.length;jb=bb.e("TellMeDropdownControls",
jb);kb=bb.h("TellMeDropdownMenuSection",jb,kb,Ab.displayName);Fb.push(kb)}tb=bb.i(Fb,"LookupDropdownMenu");return new Ha(tb,hb,va)}static get cac(){return nb.lae||(nb.lae=new Ha(bb.i([],"LookupDropdownMenu"),0,[]))}}nb.lae=null;Object(t.a)(nb,"TellMeXmlGenerator",null,[]);class Ma{}Ma.lPi="MRU";Ma.test="Test";Object(t.a)(Ma,"ActionType",null,[]);var Oa=a(796),La;(function(kb){kb[kb.Service=0]="Service";kb[kb.Local=1]="Local";kb[kb.MRU=2]="MRU";kb[kb.TestResult=3]="TestResult";kb[kb.Unknown=4]="Unknown"})(La||
(La={}));Object(t.b)("SubResultType",La);var ra=a(117);class V{constructor(kb,tb,hb,Fb,va=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=kb;this.IsEnabled=tb;this.ResultType=n[hb];this.SubResultType=La[Fb];this.OptionalData=va?ra.a.toJSON(va):null}}Object(t.a)(V,"ResultInfo",null,[]);var ma=a(116),W=a(148),aa=a(281);class ia{constructor(kb,tb=null){this.ade="TellMeWAC.";this.JFg=kb;this.VJg=tb}v8(kb,tb,hb){tb=ma.a.mi(tb);kb=ma.a.k8b(kb,
this.JFg,this.VJg,hb,tb);W.a.v8(kb,this.ade)}Uoa(kb,tb,hb=0){tb=ma.a.mi(tb);W.a.Uoa(Object.assign(new aa.a,{name:kb,dataFields:tb,durationMs:hb}),this.ade)}}Object(t.a)(ia,"TellMeOtelLogger",null,[249]);var ka=a(181);class Xa{constructor(kb,tb,hb,Fb,va,jb,Ab){this.EJ=this.fM=this.q9d=null;this.Tqa=kb;this.NLc=tb;this.t$=hb;this.Tra=Fb;this.Mga=va;this.HDg=jb;this.EJ=Ab?Ab:new ia(this.Tra?r.CuiHelper.IXd:r.CuiHelper.oEc)}get Yi(){return this.Tra}get GI(){return this.t$}HAc(kb){this.q9d=kb;switch(kb){case ua.a.contextMenu:this.fM=
ua.a.contextMenu;break;default:this.fM=ua.a.tellMe}}RZg(kb,tb){this.t$.VV||(this.t$.VV=ka.a.create().toString(),this.zuf(kb,!0,tb))}uSe(kb,tb=!0){this.t$.VV&&this.RHi(kb,tb);this.Tra&&appChrome.api.updateTellMeCorrelationId("");this.t$.VV=null}zuf(kb,tb,hb){const {TellMeActor:Fb}=a(726),va=this.fK(x.a.Pxa);va[Oa.a.culture]=this.NLc;va[Oa.a.appName]=this.Tqa;va[Oa.a.context]=kb;va[Oa.a.Slc]=this.Mga;va[Oa.a.YAi]=this.HDg;va[Oa.a.Xzi]=hb;va[Oa.a.Qvi]=tb;va[Oa.a.contentType]=Fb.instance.G8b;this.EJ.v8(x.a.Pxa,
va,this.q9d);this.Tra&&appChrome.api.updateTellMeCorrelationId(this.t$.VV)}RHi(kb,tb){const hb=this.fK(x.a.zNa);hb[Oa.a.quh]=kb;hb[Oa.a.Pvi]=tb;this.EJ.Uoa(x.a.zNa,hb)}nJi(kb,tb,hb){let Fb=0;!hb&&0<kb.length&&(Fb=kb.trim().split(" ").length);const va=this.fK(x.a.query);va[Oa.a.query]="!";va[Oa.a.KRa]=tb;va[Oa.a.RTf]=kb.length;va[Oa.a.Sqf]=hb;va[Oa.a.yck]=Fb;this.EJ.v8(x.a.query,va,this.fM)}BIi(kb,tb,hb,Fb,va,jb,Ab){const Qa=this.fK(x.a.latency);Qa[Oa.a.culture]=this.NLc;Qa[Oa.a.RTf]=kb;Qa[Oa.a.klg]=
tb;Qa[Oa.a.statusCode]=hb;Qa[Oa.a.GO]=va;Qa[Oa.a.isSuccess]=jb;Qa[Oa.a.dEi]=Ab;this.EJ.Uoa(x.a.latency,Qa,Fb)}hzd(kb,tb,hb,Fb){const va=this.fK(x.a.performance);va[Oa.a.culture]=this.NLc;va[Oa.a.VZg]=Q[kb];va[Oa.a.Bwh]=Q[tb];va[Oa.a.L$i]=Y[hb];this.EJ.Uoa(x.a.performance,va,Fb)}zJi(kb,tb){var {TellMeActor:hb}=a(726);const {CommandResultsUtility:Fb}=a(781);if(kb.results.length){var va=this.fK(x.a.t0f);va[Oa.a.QMa]=tb.toString();va[Oa.a.groupType]=M.a[kb.groupType];16===kb.groupType&&(va[Oa.a.Hzi]=
hb.instance.iSb);tb=[];hb=[];var jb=[];for(const Ab of kb.results)va[Oa.a.resultType]||(va[Oa.a.resultType]=n[Ab.type]),kb={},27===Ab.type&&(kb.AssetId=Ab.f2b),hb.push(Fb.Zxa(Ab.value)),tb.push(Ab.value),jb.push(new V(Ab.value,Fb.Zxa(Ab.value),Ab.type,Ab.kgg,kb));0<tb.length&&(va[Oa.a.Vvj]="{"+tb.join(", ")+"}",va[Oa.a.kwh]="{"+hb.join(", ")+"}",va[Oa.a.Rvj]=X.c(jb));this.EJ.v8(x.a.t0f,va,this.fM)}}NSh(kb,tb){if(4===kb)return Ma.lPi;switch(tb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";
case 19:case 20:case 21:return"Notes"}return n[tb]}zHi(kb,tb,hb,Fb,va){const jb=this.fK(x.a.click);jb[Oa.a.klg]=kb;jb[Oa.a.q9i]=tb;jb[Oa.a.commandId]=hb;jb[Oa.a.sH]=Fb;jb[Oa.a.actionType]=this.NSh(va.groupType,va.resultType);jb[Oa.a.resultType]=n[va.resultType];jb[Oa.a.mZd]=La[va.mZd];jb[Oa.a.groupType]=M.a[va.groupType];jb[Oa.a.QMa]=va.QMa.toString();jb[Oa.a.oad]=va.oad.toString();jb[Oa.a.resultIndex]=va.resultIndex.toString();this.EJ.v8(x.a.click,jb,this.fM)}CHi(kb,tb){this.t$.VV||(this.t$.VV=ka.a.create().toString(),
this.zuf("",!1,tb));tb=this.fK(x.a.KIe);tb[Oa.a.KRa]=kb;this.EJ.Uoa(x.a.KIe,tb)}Quf(kb,tb,hb){if(kb){if(hb)for(let Fb in hb)kb[Fb]=hb[Fb];this.EJ.Uoa(x.a.events,kb,tb)}}WHi(kb,tb,hb=null){const Fb=this.fK(x.a.events);Fb[Oa.a.event]=kb;this.Quf(Fb,Math.round(tb),hb)}gza(kb,tb,hb=null){const Fb=this.fK(x.a.events);Fb[Oa.a.event]=x.a.error;Fb[Oa.a.module]=kb;Fb[Oa.a.errorMessage]=tb;Fb[Oa.a.message]=tb;this.Quf(Fb,Math.round(window.performance.now()),hb)}wHi(kb){const tb=this.fK(x.a.$Ge);tb[Oa.a.value]=
kb;tb[Oa.a.wvc]=this.Tra;this.EJ.v8(x.a.$Ge,tb,this.fM)}YGi(kb){const tb=this.fK(x.a.Tpe);tb[Oa.a.value]=kb;tb[Oa.a.wvc]=this.Tra;this.EJ.v8(x.a.Tpe,tb,this.fM)}cIi(kb){const tb=this.fK(x.a.g_e);tb[Oa.a.value]=kb;tb[Oa.a.wvc]=this.Tra;this.EJ.v8(x.a.g_e,tb,this.fM)}mJi(kb){const tb=this.fK(x.a.FTf);tb[Oa.a.value]=kb;tb[Oa.a.wvc]=this.Tra;this.EJ.v8(x.a.FTf,tb,this.fM)}fHi(kb){const tb=this.fK(x.a.e7f);tb[Oa.a.value]=kb;this.EJ.v8(x.a.e7f,tb,this.fM)}qJi(kb,tb){const hb=this.fK(x.a.QTf);hb[Oa.a.Tcb]=
kb;tb&&(hb[Oa.a.VV]=tb);this.EJ.Uoa(x.a.QTf,hb)}fK(kb){return{["SessionID"]:this.t$.sessionId,["CorrelationID"]:this.t$.VV,["Time"]:(new Date).getTime(),["Event"]:kb,["Scenario"]:this.fM}}}Object(t.a)(Xa,"UsageLogger",null,[217]);var sb=a(102),ib=a(1054),Ub=a(709),hc=a(828),yb=a(113),Gb=a(93);a(861);a(384);var Sa=a(29),db=a(568),fb=a(112),ab=a(26);a.d(C,"TellMeActor",function(){return wb});class wb{constructor(){this.$ga=this.YG=this.lc=this.$a=this.cT=this.sP=this.de=this.La=this.sc=this.qv=this.bSc=
this.Cpe=this.IT=this.Ta=null;this.oYa=!1;this.pLc=[];this.l9d=[];this.Ooe=[];this.nhe=[];this.ohe=[];this.xee=!1;this.XWa=this.bHa=null;this.Jlb=this.Mga=!1;this.LEg=!0;this.FE=this.iWb=this.Kbe=this.hhe=null;this.rP=[];this.nra=this.hXa=this.r2=this.AYb=this.Ome=null;this.bYa=!1;this.gSc=0;this.NWa=null;this.BY=-1;this.Sge=0;this.Qlb=!1;this.Bra=null;this.Loe=!1;this.QWa=this.EE=null}get G8b(){return this.cT?this.cT.contentType:wb.unknown}get actions(){return this.rP}set actions(kb){this.rP=kb}Kfc(){return this.sc?
this.sc.GI.VV:null}ty(){return this.Ta}get BOi(){return this.LEg}get Qbk(){return this.hhe}performance(){return this.qv}get EXd(){return this.Ome}set EXd(kb){this.Ome=kb}get iSb(){return this.Loe}set iSb(kb){this.Loe=kb}tqa(kb){const tb=window.performance.now();this.bHa&&!H.c(kb)&&(this.bHa(kb),this.sc.aL(x.a.tqa,window.performance.now()-tb))}initialize(kb,tb=null,hb=null,Fb=null,va=null,jb=null,Ab=null,Qa=null,Z=null,wa=null,Ea=null){const {InteractionLogger:fa}=a(1411),{GroupsPlacementInfo:Ua}=
a(1409),{AggregatorResultsProvider:Aa}=a(1181);this.Ta=kb;this.Mga=!!A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Pa.nvd;this.sc=Fb;if(!Fb){Fb=new v;Fb.sessionId=A.AFrameworkApplication.userSessionId;const Ib=db.a.KH(A.AFrameworkApplication.lcid)||db.a.Rpi;this.sc=new fa(new Xa(this.Ta.application,Ib.name,Fb,this.Ta.Yi,this.Mga,kb.tellMeInSharedHeaderIsEnabled,null),this.Ta.Gdh,this.Ta)}this.$ga=new B(this.Ta.parameterData);this.Cpe=hb||new nb(this.Ta,this.$ga);this.bHa=Ab;this.bSc=this.bSc||
new ca(this.Ta,this.Ta.parameterData,Ab);this.lc=sb.FocusManager.instance();this.YG=D.createInstance(this.Ta);this.Kbe=new Ua(kb);this.La=va||A.AFrameworkApplication.xb;this.de=jb||A.AFrameworkApplication.ji;this.sP=Z;this.IT=tb;this.EE=Ea;this.qv=new la;this.QWa=new c.a(b.a.$h());this.AYb=[];Z?Z.execute(Ib=>{Ib.isFeatureEnabled(wb.IXj,!0).then(Pb=>{const {AggregatorResultsProvider:Fa}=a(1181);this.Qlb=Pb;this.IT=this.IT||Fa.createInstance(this.YG,this.Ta,this.$ga,this.Qlb);for(const da of this.AYb)this.IT.fs(da.provider,
da.Ghb);this.AYb=[];return null})}):(this.Qlb=!0,this.IT=this.IT||Aa.createInstance(this.YG,this.Ta,this.$ga,this.Qlb));this.$a=Qa;this.r2=nb.cac;this.hhe=new Promise(()=>{});wa&&wa.execute(Ib=>{this.cT=Ib});this.Ta.Yi&&y.a.ipf()&&(kb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.Ta.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(kb,kb)))}Pg(){this.ZOg()}ZOg(){this.La.Ne(ab.a.tellMe,fb.a.frame,Object(f.a)(this,this.tellMe,"tellMe"),96);this.La.Ne(ab.a.tellMeCacheAsyncMenuRefresh,
fb.a.frame,Object(f.a)(this,this.Z3g,"cacheAsyncMenuRefreshFunction"),96);this.La.Ne(ab.a.tellMeLogCommandExecuted,fb.a.frame,Object(f.a)(this,this.yIi,"logItemExecuted"),96);this.La.Ne(ab.a.tellMeLogMenuClose,fb.a.frame,Object(f.a)(this,this.DHi,"logControlDeactivation"),96);this.La.Ne(ab.a.tellMeLogInputFocus,fb.a.frame,Object(f.a)(this,this.uIi,"logInputFocus"),96);this.La.Ne(ab.a.tellMeInteractionBegin,fb.a.frame,Object(f.a)(this,this.Pxa,"interactionBegin"),96);this.La.Ne(ab.a.tellMeRestoreFocus,
fb.a.frame,Object(f.a)(this,this.Pxa,"interactionBegin"),96);this.La.Ne(ab.a.tellMeLogInputBlur,fb.a.frame,Object(f.a)(this,this.tIi,"logInputBlur"),96);this.La.Ne(ab.a.tellMeLogMenuOpen,fb.a.frame,Object(f.a)(this,this.BHi,"logControlActivated"),96);this.La.Ne(ab.a.tellMeFocusInput,fb.a.frame,Object(f.a)(this,this.gOh,"focusSearchBox"),96);this.La.Ne(ab.a.tellMeAccessibilityMenuText,fb.a.frame,Object(f.a)(this,this.Ich,"constructLiveNotificationForMenu"),96);this.La.Ne(ab.a.tellMeTryQuery,fb.a.frame,
Object(f.a)(this,this.rif,"insertTryQuery"),96);this.La.Ne(ab.a.WEi,fb.a.frame,Object(f.a)(this,this.rif,"insertTryQuery"),96);this.La.Ne(ab.a.RKh,fb.a.frame,Object(f.a)(this,this.Vna,"openOrInsertUrl"),96);this.La.Ne(ab.a.SKh,fb.a.frame,Object(f.a)(this,this.Vna,"openOrInsertUrl"),96);this.La.Ne(ab.a.TKh,fb.a.frame,Object(f.a)(this,this.Vna,"openOrInsertUrl"),96);this.La.Ne(ab.a.UKh,fb.a.frame,Object(f.a)(this,this.Vna,"openOrInsertUrl"),96);this.La.Ne(ab.a.VKh,fb.a.frame,Object(f.a)(this,this.Vna,
"openOrInsertUrl"),96);this.La.Ne(ab.a.r7i,fb.a.frame,Object(f.a)(this,this.Vna,"openOrInsertUrl"),96);this.La.Ne(ab.a.s7i,fb.a.frame,Object(f.a)(this,this.Vna,"openOrInsertUrl"),96);this.La.Ne(ab.a.t7i,fb.a.frame,Object(f.a)(this,this.Vna,"openOrInsertUrl"),96);this.La.Ne(ab.a.z$i,fb.a.frame,Object(f.a)(this,this.Dic,"insertMention"),96);this.La.Ne(ab.a.A$i,fb.a.frame,Object(f.a)(this,this.Dic,"insertMention"),96);this.La.Ne(ab.a.B$i,fb.a.frame,Object(f.a)(this,this.Dic,"insertMention"),96);this.La.Ne(ab.a.tellMeFeedback,
fb.a.frame,Object(f.a)(this,this.openFeedback,"openFeedback"),96);this.La.Ne(ab.a.KXj,fb.a.frame,Object(f.a)(this,this.Vna,"openOrInsertUrl"),96);this.La.Ne(ab.a.HTg,fb.a.frame,Object(f.a)(this,this.Ixd,"launchAddin"),96);this.La.Ne(ab.a.ITg,fb.a.frame,Object(f.a)(this,this.Ixd,"launchAddin"),96);this.La.Ne(ab.a.JTg,fb.a.frame,Object(f.a)(this,this.Ixd,"launchAddin"),96);this.La.Ne(ab.a.lCc,fb.a.frame,Object(f.a)(this,this.lCc,"showTellMeCoachmark"),96);this.La.Ne(ab.a.hEi,fb.a.frame,Object(f.a)(this,
this.iEi,"launchAddinStore"),96);this.La.Ne(ab.a.ggj,fb.a.frame,Object(f.a)(this,this.hgj,"quickActionOnFileHandler"),96);this.La.Ne(ab.a.eSh,fb.a.frame,Object(f.a)(this,this.dSh,"generateSlidesFromFiles"),96)}gOh(kb,tb,hb){if(1===hb)return 32;this.g$f();kb=!1;(this.Ta.tellMeInSharedHeaderIsEnabled||this.Mga)&&(tb=document.getElementById("SearchButton"))&&tb.click();if(!this.Ta.tellMeInSharedHeaderIsEnabled&&this.Mga)for(tb=document.getElementsByClassName("ms-suiteux-search-box"),hb=0;hb<tb.length;hb++){const Fb=
tb[hb].querySelector("input[type=search]");Fb&&(kb=sb.FocusManager.iqa(Fb))}else kb=sb.FocusManager.iqa($get(this.Ta.Yi?r.CuiHelper.IXd:r.CuiHelper.oEc));this.Jlb=!0;return kb?32:8}rif(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.g$f();kb=va.CommandValueId;tb=this.Ta.Yi?r.CuiHelper.IXd:r.CuiHelper.oEc;this.Ta.Yi&&!H.c(va[Ub.a.rpa])&&(va[Ub.a.rpa]=!1);if(kb){if(this.Ta.Yi)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(kb)),
this.Bra=[19],32;if(va=$get(tb))va.value=kb}return sb.FocusManager.iqa($get(tb))?32:8}g$f(){this.lc.cS(this.Ta.tellMeInSharedHeaderIsEnabled||this.Mga?this.Ta.ahc:this.Ta.HBa,!1)}JSh(kb,tb){switch(kb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,tb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,tb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,tb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
tb)}return tb}Ich(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;kb=this.r2?this.r2.resultCount:0;va.Value=1!==kb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,kb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.r2)for(const jb of this.r2.jsh)va=Object(e.a)(P.a,jb)?jb.id:Ga.a.replaceAll(jb.value,'"',""),(va=$get(va+"-"+y.a.v_d))&&Gb.a.Ch(va,Gb.a.wu,
Ga.a.kf(this.JSh(jb.groupType,va.innerText)));return 32}Z3g(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.NWa=new yb.a(2,1,0,()=>{va[ib.a.Callback]()},97);this.r2&&this.de.Kf(this.NWa);return 32}yIi(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;va.CloseAllMenus&&(kb=void 0===va.ParentControlId||null===va.ParentControlId?
"<NA>":va.ParentControlId,tb=this.XWa?this.XWa[va.ControlId]:null,!tb&&this.XWa&&"<NA>"!==kb&&(tb=this.XWa[kb]),tb||(tb=this.oYa&&this.YG.Nsi(va),tb=this.vqh(tb,va.ControlId),tb=new l(tb,32,4,-1,-1,-1),this.sc.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+va.ControlId+" determined group:"+M.a[tb.groupType])),this.sc.JVi(va.ControlId,kb,va.CommandId,va.CloseAllMenus,tb),this.$ga.xRi(va.ControlId),va.Location!==ua.a.contextMenu&&(this.YG.q3(va),this.YG.fs(tb.resultType),this.Ta.GBc&&
this.IT.ANg(va.CommandId)));return 32}DHi(kb,tb,hb,Fb,va){if(1===hb)return 32;z.a.ZAi()&&(new T(this.Kfc())).P5h(this.hXa);kb=this.hXa;tb=this.BY;hb=this.sc.LUb;if(H.c(va))return this.sc.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;va=va.UILocation;kb&&0<kb.length&&this.Qlb&&y.a.WVd(this.Ta)&&this.Ta.dmc&&19!==va&&tb>hb&&!this.Ta.Sy&&(this.sc.mzd(kb),this.sc.zTd(tb));this.sc.Auj();this.Ta.dHc&&19!==va&&(this.qv.mark(3),this.qv.measure(1,0,3),this.qv.measure(2,2,3),this.qv.Zyd(0,
1,2),this.qv.Zyd(2,2,3),this.qv.Zyd(1,0,3),this.qv.n9g(),this.qv.clearMeasures([0,2,1]));this.sc.eWi(window.performance.now()-this.gSc);this.Ta.Yi&&(this.nra=null,this.sc.Gna());this.Jlb=this.bYa=!1;this.hXa="";return 32}uIi(kb,tb,hb){if(1===hb)return 32;this.sc.fAa(u(tb),this.Jlb);return 32}tIi(kb,tb,hb){if(1===hb)return 32;this.sc.Gna();this.bYa=!1;return 32}BHi(kb,tb,hb,Fb,va){if(1===hb)return 32;this.FE=null;va&&(this.FE=va);this.Ta.dHc&&(H.c(this.FE)||this.FE.Location!==ua.a.contextMenu)&&this.qv.mark(0);
this.sc.HAc(H.c(this.FE)||H.c(this.FE.Location)?ua.a.unknown:this.FE.Location);this.sc.dWi(this.Sge,this.Jlb);this.bYa||this.Hna();return 32}pKe(kb,tb){const hb=[],Fb=Date.now();for(let va of kb)kb=(Fb-va.timeStamp)/1E3,kb=y.a.oFc(kb),Array.add(hb,new E(tb?va.commandId:va.controlId,kb));return hb}wmh(kb){const tb=[],hb=Date.now();for(let Fb of kb)if(Fb.controlId||"keyboardShortcut"===Fb.commandSurface)kb=(hb-Fb.timeStamp)/1E3,kb=y.a.oFc(kb),Array.add(tb,new N(Fb.controlId,Fb.commandId,kb,Fb.commandSurface,
Fb.tEc));return tb}VKe(kb=!1){var tb=kb?this.YG.M5h():this.YG.zwa();kb=[];const hb=Date.now();for(const Fb of tb)tb=(hb-Fb.TimeStamp)/1E3,tb=y.a.oFc(tb),Array.add(kb,new E(Fb.Id,tb));return kb}Hna(){if(!this.bYa){this.oYa=this.bYa=!0;""!==this.Ta.T5f&&A.AFrameworkApplication.Uma(this.Ta.T5f);if(!this.xee){this.xee=!0;const kb={};kb.IsMLREnabled=this.Ta.Uwi;kb.IsReactRibbonEnabled=this.Ta.Yi;kb.IsSharedHeaderEnabled=!!A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Pa.Ou;kb.IsSearchUxEnabled=
this.Mga;kb.IsTellMeInHeaderEnabled=this.Ta.tellMeInSharedHeaderIsEnabled;kb.IsGoLocalEnv=y.a.bmf();kb.IsSovereignEnvironment=y.a.MOa();kb.IsTellMeServiceResultsEnabled=y.a.WVd(this.Ta);kb.IsSubstrateProviderEnabled=y.a.VVd(this.Ta);kb.ShouldFetchTokens=!!A.AFrameworkApplication.sa&&A.AFrameworkApplication.sa.Pa.VTa;kb.IsSerpletEnabled=y.a.zR();kb.FirstOnClickTimeInMS=Math.round(window.performance.now());kb.IsHeaderHidden=A.AFrameworkApplication.hideHeader||A.AFrameworkApplication.hideHeaderEmbedded;
kb.IsSearchInHeaderHidden=A.AFrameworkApplication.hideSearchInHeaderByUiHost;void 0!==window.performance.timing&&null!==window.performance.timing&&(kb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));kb.IsFindWithMatchesEnabled=this.Ta.v_e;kb.HelpShowsTopSearchResult=this.Ta.ZOb;kb.HelpShowsNumberOfMatches=this.Ta.YOb;A.AFrameworkApplication.fa&&(kb.UiHost=A.AFrameworkApplication.fa.Wa("UiHostIntegrationType"));this.sc.MJi(JSON.stringify(kb))}this.pLc=this.pKe(h.a.instance.Qjb,
!1);this.l9d=this.pKe(h.a.instance.FEa,!0);this.Ooe=this.wmh(h.a.instance.FEa);this.nhe=this.VKe();this.ohe=this.VKe(!0);this.sc.Hna()}}Pxa(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Sa.a.Nmf)return 32;this.gSc=window.performance.now();this.Hna();kb=new G(Object(f.a)(this,this.x0,"onRequestCompleted"),0);this.BY++;this.sc.beginQuery("",this.BY,this.oYa);this.u2d(!0,null);this.r2=nb.cac;this.nra=ca.Dbd;if(this.IT)wb.instance.actions=
[],this.IT.Pu(new R("",this.BY),kb,this.Ta.Yi);else this.sc.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.NWa&&this.de.Kf(this.NWa);return 32}byc(kb,tb,hb){if(1===hb)return 32;this.lc.O7(this.Ta.tellMeInSharedHeaderIsEnabled||this.Mga?this.Ta.ahc:this.Ta.HBa,!1);return 32}tellMe(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:TellMe","actiondata comes null"),16;this.FE=va;this.sc.HAc(H.c(this.FE.Location)?ua.a.unknown:this.FE.Location);
kb=this.FE.Value;this.Ta.Yi||kb&&""!==kb.trim()?(!this.nra&&this.Ta.Yi&&(this.sc.fAa(u(tb),this.Jlb),this.Hna()),this.VIh(kb,this.FE.Location),this.FE.PopulationXML=this.r2.xml):this.oYa?this.FE.PopulationXML=this.r2.xml:(this.FE.PopulationXML=nb.cac.xml,this.nra=ca.Dbd,this.hXa="");return 32}VIh(kb,tb){this.gSc=window.performance.now();this.Ta.dHc&&tb!==ua.a.contextMenu&&this.qv.mark(1);this.Ta.Yi&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(kb));kb&&0<kb.trim().length&&(this.oYa=
!1);this.Ta.Mxh();tb=H.c(tb)?ua.a.tellMe:tb;if(kb!==this.hXa||this.Ta.Yi){this.BY++;this.sc.beginQuery(kb,this.BY,this.oYa);this.u2d(!0,null);const hb=new R(kb,this.BY),Fb=new G(Object(f.a)(this,this.x0,"onRequestCompleted"),this.BY);this.r2=nb.cac;this.nra=ca.Dbd;if(this.IT)wb.instance.actions=[],this.IT.Pu(hb,Fb,this.Ta.Yi,tb,this.Bra),this.Bra=null;else this.sc.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Sge=this.BY;this.hXa=kb}}j7j(kb){if(this.Ta.Yi){var tb=
appChrome.selectors.getActiveControlStates();if(tb=Object(d.a)(Object,tb[kb.value])){kb.label=tb.label;let hb=null;"description"in tb&&(hb=tb.description);hb&&Object.getType(hb)===String?kb.description=hb:"secondaryText"in tb?kb.description=tb.secondaryText:"fullDescriptionLabel"in tb&&(kb.description=tb.fullDescriptionLabel)}}}Zaj(kb){this.XWa={};let tb=0,hb=0;for(const Fb of kb){kb=0;for(const va of Fb.results)this.XWa[va.value]=new l(va.groupType,va.type,va.kgg,tb,kb,hb),kb++,hb++,va.label||5!==
va.type||this.j7j(va);0<kb&&tb++}}openUrlInNewTab(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(kb=va.CommandValueId)&&window.open(kb,"_blank");return 32}etf(kb){const tb={};tb.token=this.EXd;tb.files=X.c(kb);tb.type="MultiFilesDeckGeneration";kb=y.a.L$e("",y.a.P2f("GenerateDeckFromFile"),Object.assign(new hc.a,{landingTab:"All",data:tb}));kb=this.La.ie(ab.a.pqi,2,kb);return 32!==kb?(this.sc.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+kb+"."),!1):!0}hgj(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.lc.L0e();if(kb=va.TerminalParentControlId){kb=this.QWa.ma(kb);if(!kb)return 16;tb=[];Array.add(tb,kb);if(!this.etf(tb))return 8}return 32}dSh(){if(!this.QWa.count)return 16;const kb=[];for(let tb of this.QWa.values)Array.add(kb,tb);return this.etf(kb)?32:8}Dic(kb,tb,hb,Fb,va){if(1===hb)return 32;
if(H.c(va))return this.sc.onError("TellMeActor:InsertMention","actiondata comes null"),16;kb=va.UILocation;let jb;va=va.CommandValueId;try{jb=X.a(va)}catch(Ab){return this.sc.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return H.c(jb)?(this.sc.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):H.c(this.iWb)?(this.sc.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==kb?(this.sc.onError("TellMeActor:InsertMention",
"location "+kb+" is unexpected"),16):this.iWb.Dic(jb.displayName,jb.email,jb.userId)?32:(this.sc.onError("TellMeActor:InsertMention","mention is not inserted"),16)}Vna(kb,tb,hb,Fb,va){return 1===hb?32:H.c(va)?(this.sc.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===va.UILocation?this.Loi(hb,va):this.openUrlInNewTab(kb,tb,hb,Fb,va)}openFeedback(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.EE&&
window.setTimeout(()=>{this.EE.execute(jb=>{jb.EPb("TellMeSurvey",null)})},wb.cKh);return 32}Loi(kb,tb){if(1===kb)return 32;if(H.c(tb))return this.sc.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(H.c(this.iWb))return this.sc.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;kb=tb.CommandValueId;return H.c(kb)?(this.sc.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.iWb.insertHtmlText(kb)?32:(this.sc.onError("TellMeActor:InsertUrl","url is not inserted"),
16)}x0(kb,tb,hb,Fb,va){hb=window.performance.now();this.Zaj(tb);this.sc.TFj(tb);this.Ta.Yi?(this.nra=this.bSc.kSh(tb,kb,va),this.Ta.p_?(this.rP.push(appChrome.actions.updateTellMeSearchResults(this.nra.menuModel,kb,va)),appChrome.api.dispatch(this.rP)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.nra.menuModel,kb,va)),this.Ta.dHc&&this.bYa&&(H.c(this.FE)||this.FE.Location!==ua.a.contextMenu)&&(this.qv.mark(2),this.qv.measure(0,1,2))):this.r2=this.Cpe.lSh(tb,this.sc.GI);
this.NWa&&this.de.Kf(this.NWa);va={};va.GroupsCount=tb.length;va.QueryID=Fb;va.QueryLength=kb.length;this.sc.aL(x.a.Mkh,window.performance.now()-hb,va)}vqh(kb,tb){return tb.startsWith(this.Ta.Yi?y.a.u1d:y.a.sFc)?5:kb?4:"bSearchHelp"===tb||tb.startsWith("GetHelpFromTellMe")?8:"bInsights"===tb||tb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===tb?24:tb===this.Ta.u_e?2:0}fs(kb,tb){this.IT?this.IT.fs(kb,tb):Array.add(this.AYb,new w(kb,tb))}iEi(kb,tb,hb,Fb,va){if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:LaunchAddinStore",
"actiondata comes null"),16;if(this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){kb={};kb.SourceControlId=va.SourceControlId;kb.Query=va.CommandValueId;va=this.La.ie(ab.a.VEb,2,kb);if(32!==va)this.sc.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+va+".");return va}return this.La.ie(ab.a.VEb,2,va)}Ixd(kb,tb,hb,Fb,va){({AddinResultsProvider:kb}=a(973));if(1===hb)return 32;if(H.c(va))return this.sc.onError("TellMeActor:LaunchAddin",
"actiondata comes null"),16;hb=va.CommandValueId;if(H.b(hb))return this.sc.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!kb.PHa[hb])return this.sc.onError("TellMeActor:LaunchAddin","Add-in with assetId "+hb+" doesn't not exist in entitlements"),16;va=a(973).AddinResultsProvider.PHa[hb];kb={};kb.solutionId=va.id;kb.version=va.appVersion;kb.storeType=va.storeType;kb.storeId=va.storeId;kb.assetId=va.assetId;kb.assetStoreId=va.assetStoreId;kb.displayName=va.displayName;kb.targetType=
va.targetType;kb.height=va.height;kb.width=va.width;va=this.La.ie(ab.a.mif,2,kb);if(32!==va)this.sc.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+va+". AssetId: "+hb);return va}lCc(){if(!H.c(this.EE))for(let kb of h.a.instance.FEa){if("ShowContextMenuWithFloatie"===kb.commandId)return this.EE.execute(tb=>{tb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(kb.commandId&&-1===kb.commandId.indexOf("Tab"))break}return 8}u2d(kb,tb="",hb=null){kb?
this.QWa=new c.a(b.a.$h()):tb&&hb&&this.QWa.add(tb,hb)}static get instance(){return wb.Ma||(wb.Ma=new wb)}}wb.Ma=null;wb.IXj="mso_tellMeService";wb.unknown="Unknown";wb.cKh=500;Object(t.a)(wb,"TellMeActor",null,[])},727:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(745);class b{constructor(f,e){this.Ura=!1;const {Annotations:d}=a(723);if(!f)throw Error.argumentNull("annotations");if(!f.kwd(e))throw Error.argument("memberTypeID","Invalid type ID");if(d.ju(e))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.fm=f;this.DEg=e;this.Cq=[]}get k0a(){return this.fm}get isReadOnly(){return this.Ura}get tI(){return this.DEg}get items(){return this.Cq}kP(){const {Annotations:f}=a(723);let e="[";for(let d=0,h=this.items.length;d<h;++d){0<d&&(e+=", ");const r=this.fm.kP(this.tI,this.items[d]);this.tI===f.KL?(e+='"',e+=c.a.zcd(r),e+='"'):e+=r}return e+"]"}isEqual(f){const {Annotations:e}=a(723);if(this===f)return!0;if(!f||f.k0a!==this.fm||f.tI!==this.tI||f.items.length!==
this.items.length)return!1;for(let d=0;d<this.items.length;++d)if(!e.JDa(this.tI,this.items[d],f.items[d]))return!1;return!0}clone(){const f=new b(this.fm,this.tI);Array.addRange(f.items,this.items);return f}ZA(){return this.isReadOnly?this.clone():this}Eyd(){const {Annotations:f}=a(723);if(!this.isReadOnly){this.Ura=!0;for(const e of this.items)f.yPa(e)}}toString(){return this.kP()}}Object(t.a)(b,"ListValue",null,[292,291])},730:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.tellMe=
"TellMe";c.contextMenu="ContextMenu";c.unknown="Unknown";Object(t.a)(c,"TellMeScenario",null,[])},732:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,f,e=null,d=null,h=4,r=-99999,l=0){this.f2b="";this.r2b=-1;this.value=b;this.type=f;this.kgg=h;this.label=this.bA=e;this.groupType=30;this.description=d;this.score=r;this.count=l}}Object(t.a)(c,"ResultBinding",null,[])},734:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b){this.attributes=null;
this.query=b;this.Bh=[]}Ml(b){this.Bh.push(b)}lZf(b){const f=[];for(const e of this.Bh)e.groupType!==b&&f.push(e);this.Bh.length!==f.length&&(this.Bh=f)}get c9a(){return!1}}Object(t.a)(c,"SimpleResultsUpdatedEventArgs",null,[179])},735:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b=30,f=""){this.dHg=[];this.groupType=b;this.displayName=f}get results(){return this.dHg}Xl(b){b.groupType=this.groupType;Array.add(this.results,b)}QNd(b=1){if(this.results.length>=b)for(let f=
0;f<b;f++)Array.removeAt(this.results,this.results.length-1)}}Object(t.a)(c,"SimpleResultGroup",null,[178])},745:function(t,C,a){t=a(0);class c{constructor(f,e){this.Uta=f;this.value=e}}Object(t.a)(c,"AttrValuePair",null,[]);a.d(C,"a",function(){return b});class b{constructor(f){this.Ura=!1;if(!f)throw Error.argumentNull("annotations");this.fm=f;this.GD=[]}get k0a(){return this.fm}get isReadOnly(){return this.Ura}get Cnd(){return 0<this.GD.length}fj(f){if(!this.fm.K9a(f))throw Error.argument("attributeID",
"Invalid attribute ID");for(const e of this.GD)if(f===e.Uta)return f=e.value,{returnValue:!0,value:f};return{returnValue:!1,value:null}}Xn(f,e){var {Annotations:d}=a(723);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.fm.K9a(f))throw Error.argument("attributeID","Invalid attribute ID");if(!this.fm.H8a(this.fm.getAttributeType(f),e))throw Error.argument("value","Value is not of the correct type for the specified attribute");d.yPa(e);
for(d=0;d<this.GD.length;++d){const h=this.GD[d];if(f===h.Uta){h.value=e;return}}Array.add(this.GD,new c(f,e))}kwc(f){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.fm.K9a(f))throw Error.argument("attributeID","Invalid attribute ID");for(let e=0;e<this.GD.length;++e)if(f===this.GD[e].Uta){Array.removeAt(this.GD,e);break}}Scc(f){if(!f)throw Error.argumentNull("action");for(const e of this.GD)f(e.Uta,e.value)}clone(){const f=new b(this.fm);
f.ija(this);return f}ija(f){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!f)throw Error.argumentNull("other");if(f.k0a!==this.fm)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.GD);f.Scc((e,d)=>{this.Xn(e,d)})}kP(){const {Annotations:f}=a(723);let e="[",d=!0;for(const h of this.GD){d?d=!1:e+=", ";e+=this.fm.m3e(h.Uta);e+="=";const r=this.fm.getAttributeType(h.Uta),l=this.fm.kP(r,h.value);r===f.KL?(e+='"',
e+=b.zcd(l),e+='"'):e+=l}return e+"]"}isEqual(f){const {Annotations:e}=a(723);if(!f)throw Error.argumentNull("other");if(this===f)return!0;if(!f||this.fm!==f.k0a||this.Cnd!==f.Cnd)return!1;let d=0,h=null,r=!1;f.Scc((l,u)=>{++d;if(!r){var v=-1;for(let x=0,w=this.GD.length;x<w;++x)if(this.GD[x].Uta===l){v=x;break}0>v?r=!0:(h||(h=Array(this.GD.length)),h[v]=u)}});if(this.GD.length!==d||r)return!1;for(let l=0,u=this.GD.length;l<u;++l)if(!e.JDa(this.fm.getAttributeType(this.GD[l].Uta),this.GD[l].value,
h[l]))return!1;return!0}ZA(){return this.isReadOnly?this.clone():this}Eyd(){const {Annotations:f}=a(723);if(!this.isReadOnly){this.Ura=!0;for(const e of this.GD)f.yPa(e.value)}}toString(){return this.kP()}static zcd(f){return f.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(t.a)(b,"FeatureBundle",null,[290,291])},752:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.click="Click";c.Pxa="InteractionBegin";c.zNa="InteractionEnd";c.KIe="ControlActivated";
c.query="Query";c.QTf="QueryIndexRecorded";c.$Ge="Clicks";c.Tpe="ActionEvents";c.g_e="FilteredActionEvents";c.e7f="SessionContext";c.latency="Latency";c.performance="Performance";c.t0f="RenderedResults";c.events="Events";c.Mkh="CreateResultsMenu";c.tqa="UpdateRibbonControls";c.Uvj="ResultsAggregation";c.Pu="IssueQuery";c.rah="CommandSuggestions";c.error="Error";c.tyd="LoadModelData";c.COi="ModelDataWaitTime";c.timedOut="TimedOut";c.GTg="AddinQueryCommandReady";c.aTh="GetAddinEntitlements";c.FTf="ProviderMRUEvents";
c.dwh="EnableAddinSearchCommands";Object(t.a)(c,"EventNames",null,[])},758:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.tAd=null;this.HN=this.yAd=0}vgd(b,f,e){if(!b)throw Error.argumentNull("referenceList");if(0>f||f>b.length)throw Error.argumentOutOfRange("startIndex");if(0>e||e>b.length)throw Error.argumentOutOfRange("length");if(f+e>b.length)throw Error.argument("Invalid start-length range");this.tAd=b;this.yAd=f;this.HN=e}jwa(b,f,e){this.vgd(b.tAd,b.yAd+f,
e)}ma(b){if(0>b||b>=this.HN)throw Error.argumentOutOfRange("index");return this.tAd[this.yAd+b]}get count(){return this.HN}static P8c(b){const f=new c;f.vgd(b,0,b.length);return f}}Object(t.a)(c,"ReadOnlyList",null,[306])},768:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);var c;(function(b){b[b.Classifier=0]="Classifier";b[b.AppsForOffice=1]="AppsForOffice";b[b.FindInDocument=2]="FindInDocument";b[b.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";b[b.RecentlyUsed=4]="RecentlyUsed";
b[b.TryQuery=5]="TryQuery";b[b.Empty=6]="Empty";b[b.TryCommand=7]="TryCommand";b[b.Assistance=8]="Assistance";b[b.Answer=9]="Answer";b[b.Definition=10]="Definition";b[b.Entity=11]="Entity";b[b.WolframAnswer=12]="WolframAnswer";b[b.Insights=13]="Insights";b[b.People=14]="People";b[b.Document=15]="Document";b[b.Recommended=16]="Recommended";b[b.ServiceClassifier=17]="ServiceClassifier";b[b.ServiceRecommended=18]="ServiceRecommended";b[b.Image=19]="Image";b[b.Notes=20]="Notes";b[b.Learning=21]="Learning";
b[b.Feedback=22]="Feedback";b[b.Template=23]="Template";b[b.ActionAI=24]="ActionAI";b[b.ActionAICommand=25]="ActionAICommand";b[b.SummarizeDeck=26]="SummarizeDeck";b[b.Addin=27]="Addin";b[b.OfficeScript=28]="OfficeScript";b[b.AddinStoreEntry=29]="AddinStoreEntry";b[b.None=30]="None";b[b.MergedActions=31]="MergedActions";b[b.MergedScopedSearches=32]="MergedScopedSearches";b[b.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(c||(c={}));Object(t.b)("ResultGroupType",c)},781:function(t,C,a){a.r(C);
a.d(C,"CommandResultsUtility",function(){return u});t=a(0);var c=a(796),b=a(752),f=a(797),e=a(732),d=a(735),h=a(726),r=a(725),l=a(6);class u{static Mmg(v,x){if(x&&x.Yi){const w={};for(const m of v)x.qmc(m)&&(w[m]=appChrome.selectors.getModelType(m));h.TellMeActor.instance.tqa(w)}}static RXj(v){return v.startsWith("btnTellMeOfficeAddIn")}static Zxa(v){const x=h.TellMeActor.instance.ty();return!!x&&x.Yi&&!appChrome.selectors.isControlDisabled(v)}static $nc(v,x,w,m){if(h.TellMeActor.instance.sc&&v){const n=
[];for(const z of v)n.push(String.format('{{"Id":"{0}","Score":{1}}}',z.commandId,z.score));v={};v[c.a.suggestions]="[{"+n.join(",")+"}]";v[c.a.Sqf]=x;v[c.a.groupType]=w;v[c.a.provider]=m;h.TellMeActor.instance.sc.aL(b.a.rah,window.performance.now(),v)}}static iXh(v,x){const w=[],m=[];for(const n of x){x=n.commandId;let z=n;n.commandId in v&&(x=v[n.commandId],z=new f.a(x,n.score));Array.contains(m,x)||(w.push(z),m.push(x))}return w}static kzb(v,x,w,m,n,z,y,A){w.H4e&&(x=u.iXh(w.H4e,x));var F=r.a.zWh(x);
u.Mmg(F,w);var D=[],B=[];F=[];const M=new d.a(y);y=16===y||18===y||7===y||4===y?l.AFrameworkApplication.fa?l.AFrameworkApplication.fa.Dd("TellMeMaxRecommendedResultsToReturn",3):3:0===y||17===y||25===y?5:0;for(const R of x)if(!u.Msi(R.commandId)){x=u.RXj(R.commandId);if(w.qmc(R.commandId)&&!x){if(r.a.fqf(R.commandId))continue;x=null;n&&z&&(x=n.B4h(R.commandId,z));u.Zxa(R.commandId)?Array.add(D,new e.a(R.commandId,5,x,null,A,R.score)):Array.add(B,new e.a(R.commandId,5,x,null,A,R.score))}else w.eIa&&
x&&m&&Array.add(F,R.commandId.substr(21));if(D.length+F.length>=y)break}w=0;for(n=0;n<D.length&&w<y;n++,w++)M.Xl(D[n]);for(D=0;D<B.length&&w<y;D++,w++)M.Xl(B[D]);for(B=0;B<F.length&&w<y;B++,w++)m.Ufk(v,F[B],M);return M}static Msi(v){u.eAe||(l.AFrameworkApplication.fa&&l.AFrameworkApplication.fa.Sp("TellMeControlPredictionBlockList")&&l.AFrameworkApplication.fa.Ow("TellMeControlPredictionBlockList").forEach(x=>{Array.add(u.dAe,x.toLowerCase())}),u.eAe=!0);return Array.contains(u.dAe,v.toLowerCase())}static Vrd(v){return 2<
v.length&&";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&!!l.AFrameworkApplication.fa&&(l.AFrameworkApplication.fa.ra("TellMeCommandHookIsEnabled")||l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static w4e(v){const x=new d.a(0);var w=v.split(";");v=h.TellMeActor.instance.ty();for(const m of w)if(0<m.length){w=m.split(":");const n=2===w.length?w[0]:m;if(!v.qmc(n))break;if(1===w.length)w=new e.a(n,5,null,null,1),x.Xl(w);else if(2===
w.length)w=new e.a(n,5,w[1],null,1),x.Xl(w);else break}return x}static jNg(v,x,w){if(!(x&&x.results&&v&&v.results&&v.results.length))return{returnValue:!1,gZc:v,CZc:x};const m=[];for(var n of x.results)Array.add(m,n.value);n=0;const z=0<x.results.length?x.results[0].score:0;for(const y of v.results)if(y.score>w&&!Array.contains(m,y.value)&&u.Zxa(y.value)&&(0<z&&(y.score=z),Array.insert(x.results,n,y),n++),2===n)break;return 0<n?(w=x.results.length-5,0<w&&x.QNd(w),{returnValue:!0,gZc:v,CZc:x}):{returnValue:!1,
gZc:v,CZc:x}}}u.eAe=!1;u.dAe=[];Object(t.a)(u,"CommandResultsUtility",null,[])},796:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.appName="AppName";c.sH="CloseAllMenus";c.commandId="CommandId";c.context="Context";c.culture="Culture";c.message="Message";c.errorMessage="ErrorMessage";c.event="Event";c.VV="CorrelationID";c.q9i="ParentUiElement";c.query="Input";c.KRa="QueryID";c.RTf="QueryLength";c.Tcb="QueryIndex";c.Vvj="ResultsList";c.suggestions="Suggestions";c.scenario="Scenario";
c.sessionId="SessionID";c.source="Source";c.timeStamp="Time";c.klg="UiElement";c.wvc="ReactUx";c.value="Val";c.statusCode="StatusCode";c.GO="Service";c.isSuccess="IsSuccess";c.dEi="LatencyType";c.groupName="GroupName";c.QMa="GroupIndex";c.groupType="GroupType";c.Rvj="ResultInfoList";c.resultType="ResultType";c.mZd="SubResultType";c.Pvi="IsInputBlur";c.Qvi="IsInputFocus";c.Xzi="IsShortCutUsed";c.actionType="ActionType";c.count="Count";c.quh="DwellTime";c.Sqf="IsZeroTerm";c.yck="WordsCount";c.Slc="IsSearchUxEnabled";
c.YAi="IsTellMeInHeaderEnabled";c.module="Module";c.resultIndex="ResultIndex";c.oad="DisplayIndex";c.kwh="EnableList";c.provider="Provider";c.contentType="ContentType";c.Hzi="IsSelectionBased";c.VZg="BeginPerformanceMarker";c.Bwh="EndPerformanceMarker";c.L$i="PerformanceMeasure";Object(t.a)(c,"Columns",null,[])},797:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,f){this.commandId=b;this.score=f}}Object(t.a)(c,"CommandSuggestion",null,[])},826:function(t,C,a){a.d(C,"a",
function(){return c});t=a(0);class c{}c.tellMe="TellMe";c.loki="Loki";c.substrate="Substrate";c.Tcb="QueryIndex";c.Jhg="TellMeRanker";c.Khg="TellMeRankerLogging";Object(t.a)(c,"Services",null,[])},827:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.zca="HttpRequest";c.provider="Provider";Object(t.a)(c,"LatencyTypes",null,[])},828:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.data=this.landingTab=null}}Object(t.a)(c,"LaunchData",null,[])},875:function(t,
C,a){t=a(0);class c{constructor(){this.eRb=this.oBb=null;this.eBd=this.score=this.cGb=0}ZHd(w,m,n){this.score=w.ma(m);++m;this.oBb=w.ma(m)?n.AV(w.ma(m)):null;++m;this.eRb=w.ma(m)?n.AV(w.ma(m)):null;++m;this.cGb=w.ma(m);++m;this.eBd=w.ma(m);++m;return m}}Object(t.a)(c,"TokenStringGeneratorInit",null,[]);class b{constructor(w,m,n,z,y){this.$va=w;this.count=m;this.Bcc=n;this.ky=z;this.depth=y}}Object(t.a)(b,"ErrorTolerantTrieMatch",null,[]);var f=a(972),e=a(1070);class d{constructor(w=null,m=0,n=0,z=
0){this.UJg=w||new e.a;this.WZ=m;this.ky=n;this.depth=z}get nJ(){return this.UJg}getKey(){return this.nJ.fn.toString()+":"+this.WZ.toString()}}Object(t.a)(d,"TrieBookmark",null,[]);class h{constructor(w,m){this.xda=w;this.mAd=m}zKi(w){if(null==w)throw Error.argumentNull("prefix");let m={};var n=m[""]=new d;this.Nhc(n,m);for(n=0;n<w.length;++n){const z=w.charCodeAt(n),y={};for(let A in m)this.jUg(z,m[A],y);m=y}return this.v0j(m)}Nhc(w,m){if(!(w.ky>=this.mAd)&&(w=new d(f.a.x5c(w.nJ),w.WZ,w.ky+1,w.depth),
w.nJ.Yr&f.a.Lqa&&(w.WZ+=1),this.xda.qVa(w.nJ))){w.depth+=1;let n=!0;for(;n;)h.JGc(w,m),this.Nhc(w,m),w.WZ+=this.xda.O5a(w.nJ,!0)+(w.nJ.Yr&f.a.Lqa?1:0),n=this.xda.pRb(w.nJ)}}jUg(w,m,n){m.ky+1<=this.mAd&&(m.ky+=1,h.JGc(m,n),--m.ky);m.nJ.Yr&f.a.Lqa&&(m.WZ+=1);if(this.xda.qVa(m.nJ)){m.depth+=1;let z=!0;for(;z;)m.nJ.gWa===w?(h.JGc(m,n),this.Nhc(m,n)):m.ky+1<=this.mAd&&(m.ky+=1,h.JGc(m,n),this.Nhc(m,n),--m.ky),m.WZ+=this.xda.O5a(m.nJ,!0)+(m.nJ.Yr&f.a.Lqa?1:0),z=this.xda.pRb(m.nJ)}}v0j(w){const m=[];for(var n in w){const z=
w[n];if(!z.nJ.fn)continue;const y=!!(z.nJ.Yr&f.a.Lqa),A=this.xda.O5a(z.nJ,!1)+(y?1:0);Array.add(m,new b(z.WZ,A,y,z.ky,z.depth))}m.sort((z,y)=>{let A=z.$va-y.$va;return A||(A=-(z.count-y.count))?A:A=z.depth-y.depth});if(2>m.length)return m;w=[];for(n=0;n<m.length;)n+=h.Kjg(n,m,w);return w}static JGc(w,m){const n=w.getKey();n in m?(m=m[n],m.ky=Math.min(m.ky,w.ky)):m[n]=new d(f.a.x5c(w.nJ),w.WZ,w.ky,w.depth)}static Kjg(w,m,n){const z=m[w];let y=z.$va;const A=y+z.count;let F=1,D=z.Bcc;for(;w+F<m.length&&
m[w+F].$va<A;){const B=m[w+F];B.$va>y&&(Array.add(n,new b(y,B.$va-y,D,z.ky,z.depth)),D=!1);F+=h.Kjg(w+F,m,n);y=B.$va+B.count}y<A&&Array.add(n,new b(y,A-y,D,z.ky,z.depth));return F}}Object(t.a)(h,"ErrorTolerantTrieLookupEngine",null,[563]);class r extends c{constructor(w,m,n){super();this.Zgf=this.XNf=!1;this.zTe=null;if(w){var z=0;try{z=this.ZHd(w,z,m);this.XNf=1===w.ma(z);++z;this.Zgf=1===w.ma(z);++z;const y=w.ma(z);this.zTe=this.z9i(n,y)}catch(y){throw Error.argument("initData");}}}z9i(w,m){return new h(w,
m)}}Object(t.a)(r,"FuzzyMatchTokenStringGeneratorInit",c,[]);class l extends c{constructor(w,m){super();this.query=this.name=null;if(w){this.annotations=m.annotations;var n=0;try{n=this.ZHd(w,n,m),this.name=m.ha(w.ma(n)),++n,this.query=m.Kv(w.ma(n))}catch(z){throw Error.argument("initData");}}}}Object(t.a)(l,"QueryTokenStringGeneratorInit",c,[]);class u extends c{constructor(w,m){super();if(w)try{this.ZHd(w,0,m)}catch(n){throw Error.argument("initData");}}}Object(t.a)(u,"SurfaceStringTokenStringGeneratorInit",
c,[]);var v=a(758);a.d(C,"a",function(){return x});class x{constructor(w){this.$zd=w}get oBb(){return this.$zd.oBb}get eRb(){return this.$zd.eRb}get cGb(){return this.$zd.cGb}static create(w,m,n){const {SurfaceStringTokenStringGenerator:z}=a(1379),{QueryTokenStringGenerator:y}=a(1380),{FuzzyMatchTokenStringGenerator:A}=a(1381);let F=0;try{if(w.ma(F)!==x.GIa)throw Error.argument("initData","Input does not represent a token string generator");++F;const D=w.ma(F);++F;const B=new v.a;B.jwa(w,F,w.count-
F);switch(D){case z.bsb:return new z(new u(B,m));case y.bsb:return new y(new l(B,m));case A.bsb:return new A(new r(B,m,n));default:throw Error.argument("initData");}}catch(D){throw Error.argument("initData");}}static Bse(w,m,n,z,y,A){w=w.o_j.getId(m,null);if(0>w)return++A,A;x.Cse(w,n,z,y);return A}static Cse(w,m,n,z){Array.add(z.kZd,w);Array.add(z.Xfg,m);++z.ihb[n]}}x.GIa=1099767983;Object(t.a)(x,"TokenStringGenerator",null,[506])},925:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=
a(725);a=a(6);class b{static ZAi(){return!c.a.bmf()&&!c.a.MOa()&&b.isFeatureEnabled(0)}static Kpf(){return b.isFeatureEnabled(1)}static inf(){return b.isFeatureEnabled(2)}static isFeatureEnabled(f){return!!(b.CAg&1<<f)}}b.CAg=a.AFrameworkApplication.fa?a.AFrameworkApplication.fa.Dd("TellMeFeatureConfigValue",0):0;Object(t.a)(b,"TellMeFeatureAvailability",null,[])},926:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);a=a(732);class c extends a.a{constructor(b,f,e,d,h=null){super(b,f,h,null,e);
this.id=d}}Object(t.a)(c,"TryQueryResultBinding",a.a,[])},927:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b){this.Ea=b}get qna(){return this.Ea.qna}get iWj(){return 4!==this.Ea.style}get mWj(){return!0}get trie(){return this.Ea.trie}getId(b,f){if(!this.iWj)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ea.style){case 0:return this.O0h(b,f);default:throw Error.notImplemented();}}ha(b){if(!this.mWj)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>b||b>=this.qna)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ea.style){case 0:return this.n9h(b);case 4:return this.m9h(b);default:throw Error.notImplemented();}}O0h(b,f){b=this.Ea.trie.dwf(b,0,b.length,f);if(!b.succeeded)return-1;if(0>b.shb||b.shb>=this.Ea.qna)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ea.qRb?this.Ea.yKb.Vn(this.Ea.qRb+4*b.shb,4):b.shb}n9h(b){if(this.Ea.qRb){let f=0;for(;f<this.Ea.qna&&this.Ea.yKb.Vn(this.Ea.qRb+
4*f,4)!==b;++f);if(f>=this.Ea.qna)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ea.trie.U$e(f)}return this.Ea.trie.U$e(b)}m9h(b){const f=this.Ea.yKb.Vn(this.Ea.Vfg+4*b,4);b=this.Ea.yKb.Vn(this.Ea.Wfg+4*b,4);if(0>b||0>f)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const e=Array(f);for(let d=0;d<f;++d)e[d]=({eji:b}=this.ajj(b)).returnValue;return String.fromCharCode.apply(null,e)}ajj(b){let f=0;for(let e=0;3>e;++e){const d=
this.Ea.yKb.ma(this.Ea.dEe+b)^182;++b;f|=(d&127)<<7*e;if(!(d&128))break}return{returnValue:f,eji:b}}}Object(t.a)(c,"StringTable",null,[305])},928:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(972);class b{constructor(f){this.trie=null;this.dEe=this.Vfg=this.Wfg=this.qRb=0;if(f){this.yKb=f;var e=0;if(f.Vn(e,4)!==b.GIa)throw Error.argument("bytes","Input does not represent a string table");e+=4;this.qna=f.Vn(e,4);e+=4;this.style=f.Vn(e,4);e+=4;switch(this.style){case 0:const d=1===
f.Vn(e,4);e+=4;d||(this.qRb=e,e+=4*this.qna);f.Vn(e,4);this.trie=this.X9i(f,e+4);break;case 4:this.Wfg=e;this.Vfg=e+=4*this.qna;e+=4*this.qna;f.Vn(e,4);this.dEe=e+4;break;default:throw Error.argument("bytes");}}}X9i(f,e){return new c.a(f,e)}}b.GIa=1025118440;Object(t.a)(b,"StringTableInit",null,[])},967:function(t,C,a){a.r(C);t=a(0);var c=a(2),b=a(14),f=a(40);class e{constructor(){this.QuickFormatType=this.Command=0;this.Formula2=this.Formula1=null;this.Value=10;this.Unique=!1;this.TimePeriodType=
0;this.StopIfTrue=!1;this.Priority=-1;this.CustomFormat=null}}Object(t.a)(e,"ConditionalFormattingOptions",null,[]);var d=a(9),h=a(7),r=a(185),l=a(65);const u=(Qa,Z,wa,Ea,fa,Ua,Aa,Ib=null)=>{Ib=Qa.Oa(1,Ib);Ib.entireSheet=Z;Ib.selectedRanges=wa;return l.g(Qa,"GetConditionalFormattingRules",Ib,Ea,fa,Ua,Aa,4)},v=(Qa,Z,wa,Ea,fa,Ua,Aa,Ib,Pb=null)=>{Pb=Qa.Oa(9,Pb);Pb.deleteCommandType=Z;Pb.selectedRanges=wa;Pb.id=Ea;return l.g(Qa,"DeleteConditionalFormattingRules",Pb,fa,Ua,Aa,Ib,0)},x=(Qa,Z,wa,Ea,fa,Ua,
Aa,Ib=null)=>{Ib=Qa.Oa(9,Ib);Ib.sheetName=Z;Ib.id=wa;return l.g(Qa,"DuplicateConditionalFormattingRule",Ib,Ea,fa,Ua,Aa,0)},w=(Qa,Z,wa,Ea,fa,Ua,Aa,Ib,Pb=null)=>{Pb=Qa.Oa(9,Pb);Pb.conditionalFormattingOptions=Z;Pb.selectedRanges=wa;Pb.activeCell=Ea;return l.g(Qa,"AddConditionalFormattingRule",Pb,fa,Ua,Aa,Ib,0)},m=(Qa,Z,wa,Ea,fa,Ua,Aa,Ib,Pb,Fa=null)=>{Fa=Qa.Oa(9,Fa);Fa.id=Z;Fa.conditionalFormattingOptions=wa;Fa.range=Ea;Fa.activeCell=fa;return l.g(Qa,"QuickEditConditionalFormattingRule",Fa,Ua,Aa,Ib,
Pb,0)};var n=a(45),z=a(216),y=a(207),A=a(32),F=a(258);class D{constructor(){this.minimumCFObjectValues=this.midpointCFObjectValues=this.maximumCFObjectValues=this.minimumColor=this.midpointColor=this.maximumColor=null}}Object(t.a)(D,"ColorScaleFormat",null,[]);class B{constructor(){this.timePeriod=this.unique=this.value=this.formula2=this.formula1=this.quickFormat=this.command=null}}Object(t.a)(B,"ConditionalFormattingEditOptions",null,[]);class M{constructor(){this.index=this.iconSet=0}}Object(t.a)(M,
"ConditionalFormattingIconFormat",null,[]);class R{constructor(){this.ruleName=this.isPlaceholder=null;this.ruleType=0;this.ruleId=this.ruleRangeSheetName=this.ruleRange=null;this.priority=0;this.stopIfTrue=!1;this.editOptions=this.iconSetFormat=this.customFormat=this.dataBarFormat=this.colorScaleFormat=null}}Object(t.a)(R,"ConditionalFormattingRule",null,[]);class P{constructor(){this.thickness=this.themeColor=this.color=this.lineStyle=this.position=null}}Object(t.a)(P,"CustomBorderFormat",null,
[]);class E{constructor(){this.textColorThemeInfo=this.textColor=this.backgroundColorThemeInfo=this.backgroundColor=null;this.isTextDoubleUnderlined=this.isTextUnderlined=this.isTextStrikethrough=this.isTextItalic=this.isTextBold=!1;this.preserveTextColor=this.preserveBackgroundColor=this.gradientFill=this.borderFormat=null}}Object(t.a)(E,"CustomFormat",null,[]);class H{constructor(){this.isLinearGradient=!1;this.degree=0;this.gradientStops=this.radialGradientPosition=null}}Object(t.a)(H,"CustomFormatGradientFill",
null,[]);class G{constructor(){this.isBottom=this.isRight=this.isCenter=!1}}Object(t.a)(G,"CustomFormatRadialGradientPosition",null,[]);class N{constructor(){this.isGradientFill=!1;this.fillColor=this.borderColor=null;this.isNegativeValuesFillColorCustom=this.isLTRDirection=!1;this.negativeValuesFillColor=null;this.isNegativeValuesBorderColorCustom=!1;this.negativeValuesBorderColor=null;this.isShowValueEnabled=!1;this.axisColor=null;this.axisPositionType=0;this.maxBoundCFObjectValues=this.minBoundCFObjectValues=
null}}Object(t.a)(N,"DataBarFormat",null,[]);class I{constructor(){this.icons=null;this.isIconOnly=this.isReverseIconsOrder=!1;this.conditionalFormattingIconsCustomOptions=null}}Object(t.a)(I,"IconSetFormat",null,[]);const O=(Qa,Z,wa,Ea,fa)=>{b.ULS.sendTraceTag(537167185,0,50,"GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback");if(Qa&&F.a(Qa)){a:switch(Qa.Errors[0].MessageId){case -139005925:Z=1;break a;case 1557873584:Z=2;break a;default:Z=0}0!==Z?(b.ULS.sendTraceTag(593589700,
0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with expected error: ${Qa.Errors[0].MessageIdName}.`),fa(Ea,null,Z)):(Ea=A.a.xc(Qa.Errors),b.ULS.sendTraceTag(593589699,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with errors: ${Ea}.`))}else if(Qa&&Qa.Result){var Ua=Qa.Result,Aa=Ua.Rules.length,Ib=0;Qa=0;for(var Pb of Ua.Rules)Pb&&Ib++;b.ULS.sendTraceTag(537167184,0,50,`GetConditionalFormattingRulesHelper.ProcessConditionalFormattingResult got ${Aa} rules from server, ${Aa-
Ib} rules with errors.`);if(1>Ib)Z=[];else{Pb=Array(Ib);for(const xa of Ua.Rules)if(xa){Ib=new R;Ib.ruleId=xa.RuleId;Ib.ruleName=xa.Name;Ib.priority=xa.Priority;Ib.stopIfTrue=xa.StopIfTrue;Ib.ruleRange=n.i(n.g(xa.Range.Ranges),Z.listSeparator,Z,!1,!1,!1);Ib.ruleRangeSheetName=wa;var Fa;Ua=Ib;Aa=xa;switch(Aa.Type){case 0:Ua.ruleType=0;Ua.colorScaleFormat=new D;Aa.ColorScaleFormat?(Ua.colorScaleFormat.maximumColor=Aa.ColorScaleFormat.MaxPointColor,Ua.colorScaleFormat.maximumCFObjectValues={type:Aa.ColorScaleFormat.MaxPointCFValueObject.Type,
formula:Aa.ColorScaleFormat.MaxPointCFValueObject.Formula,number:Aa.ColorScaleFormat.MaxPointCFValueObject.Number},Ua.colorScaleFormat.minimumColor=Aa.ColorScaleFormat.MinPointColor,Ua.colorScaleFormat.minimumCFObjectValues={type:Aa.ColorScaleFormat.MinPointCFValueObject.Type,formula:Aa.ColorScaleFormat.MinPointCFValueObject.Formula,number:Aa.ColorScaleFormat.MinPointCFValueObject.Number},Ua.colorScaleFormat.midpointColor=Aa.ColorScaleFormat.MidPointColor,Aa.ColorScaleFormat.MidPointCFValueObject&&
(Ua.colorScaleFormat.midpointCFObjectValues={type:Aa.ColorScaleFormat.MidPointCFValueObject.Type,formula:Aa.ColorScaleFormat.MidPointCFValueObject.Formula,number:Aa.ColorScaleFormat.MidPointCFValueObject.Number})):b.ULS.shipAssertTag(537167183,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.ColorScaleFormat for color scale rule type");break;case 1:Ua.ruleType=1;Ua.dataBarFormat=new N;Aa.DataBarFormat?(Ua.dataBarFormat.isGradientFill=Aa.DataBarFormat.IsGradientFill,Ua.dataBarFormat.isLTRDirection=
Aa.DataBarFormat.IsLTRDirection,Ua.dataBarFormat.fillColor=Aa.DataBarFormat.FillColor,Ua.dataBarFormat.borderColor=Aa.DataBarFormat.BorderColor,Ua.dataBarFormat.isNegativeValuesFillColorCustom=Aa.DataBarFormat.IsNegativeValuesFillColorCustom,Ua.dataBarFormat.negativeValuesFillColor=Aa.DataBarFormat.NegativeValuesFillColor,Ua.dataBarFormat.isNegativeValuesBorderColorCustom=Aa.DataBarFormat.IsNegativeValuesBorderColorCustom,Ua.dataBarFormat.negativeValuesBorderColor=Aa.DataBarFormat.NegativeValuesBorderColor,
Ua.dataBarFormat.isShowValueEnabled=Aa.DataBarFormat.IsShowValueEnabled,Ua.dataBarFormat.axisColor=Aa.DataBarFormat.AxisColor,Ua.dataBarFormat.axisPositionType=Aa.DataBarFormat.AxisPositionType,Ua.dataBarFormat.minBoundCFObjectValues={type:Aa.DataBarFormat.MinBoundCFValueObject.Type,formula:Aa.DataBarFormat.MinBoundCFValueObject.Formula,number:Aa.DataBarFormat.MinBoundCFValueObject.Number},Ua.dataBarFormat.maxBoundCFObjectValues={type:Aa.DataBarFormat.MaxBoundCFValueObject.Type,formula:Aa.DataBarFormat.MaxBoundCFValueObject.Formula,
number:Aa.DataBarFormat.MaxBoundCFValueObject.Number}):b.ULS.shipAssertTag(537167182,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.DataBar for color data bar rule type");break;case 2:Ua.ruleType=2;Ua.iconSetFormat=new I;if(Aa.IconSetFormat){Ua.iconSetFormat.isReverseIconsOrder=Aa.IconSetFormat.ReverseOrder;Ua.iconSetFormat.isIconOnly=Aa.IconSetFormat.IsIconOnly;b.ULS.shipAssertTag(537167181,0,!!Aa.IconSetFormat.Icons,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat.Icons for icon set rule type");
Ua.iconSetFormat.icons=Array(Aa.IconSetFormat.Icons.length);Ua.iconSetFormat.conditionalFormattingIconsCustomOptions=[];for(var da=0;da<Aa.IconSetFormat.Icons.length;da++)Ua.iconSetFormat.icons[da]=new M,Ua.iconSetFormat.icons[da].index=Aa.IconSetFormat.Icons[da].Icon,Ua.iconSetFormat.icons[da].iconSet=Aa.IconSetFormat.Icons[da].IconSet,Ua.iconSetFormat.conditionalFormattingIconsCustomOptions.push({isGreaterEqual:Aa.IconSetFormat.ConditionalFormattingIconsCustomOptions[da].IsGreaterEqual,cfValueObject:{type:Aa.IconSetFormat.ConditionalFormattingIconsCustomOptions[da].CFValueObject.Type,
formula:Aa.IconSetFormat.ConditionalFormattingIconsCustomOptions[da].CFValueObject.Formula,number:Aa.IconSetFormat.ConditionalFormattingIconsCustomOptions[da].CFValueObject.Number}})}else b.ULS.shipAssertTag(537167180,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat for icon set rule type");break;case 3:Ua.ruleType=3;Ua.customFormat=new E;if(Aa.CustomFormat){Ua.customFormat.backgroundColor=Aa.CustomFormat.BackgroundColor;Ua.customFormat.textColor=Aa.CustomFormat.TextColor;
Ua.customFormat.isTextBold=Aa.CustomFormat.IsTextBold;Ua.customFormat.isTextItalic=Aa.CustomFormat.IsTextItalic;Ua.customFormat.isTextStrikethrough=Aa.CustomFormat.IsTextStrikethrough;Ua.customFormat.isTextUnderlined=Aa.CustomFormat.IsTextUnderlined;Ua.customFormat.isTextDoubleUnderlined=Aa.CustomFormat.IsTextDoubleUnderlined;if(Aa.CustomFormat.BorderFormat)for(Ua.customFormat.borderFormat=new P,Ua.customFormat.borderFormat.lineStyle=Array(4),Ua.customFormat.borderFormat.color=Array(4),Ua.customFormat.borderFormat.thickness=
Array(4),da=0;4>da;da++)Ua.customFormat.borderFormat.lineStyle[da]=Aa.CustomFormat.BorderFormat.LineStyle[da],Ua.customFormat.borderFormat.color[da]=y.a.jJ(z.a.wF(Aa.CustomFormat.BorderFormat.Color[da])),Ua.customFormat.borderFormat.thickness[da]=Aa.CustomFormat.BorderFormat.Thickness[da];da=Ua.customFormat;if(Fa=Aa.CustomFormat.GradientFill)if(!Fa.GradientStops||1>=Fa.GradientStops.length||1===Fa.Type&&2!==Fa.GradientStops.length)b.ULS.shipAssertTag(591663646,0,!1,`GetConditionalFormattingRulesHelper.GetFillGradientProperties: missing gradient stops, length=${Fa.GradientStops?
Fa.GradientStops.length:-1}.`),Fa=null;else{var K=new H;K.gradientStops=Array(Fa.GradientStops.length);for(let rb=0;rb<Fa.GradientStops.length;rb++)K.gradientStops[rb]=y.a.jJ(z.a.wF(Fa.GradientStops[rb].Color));K.isLinearGradient=0===Fa.Type;K.degree=Fa.Degree;K.isLinearGradient||(K.radialGradientPosition=new G,Fa.FillToRight&&1!==Fa.FillToRight?K.radialGradientPosition.isCenter=!0:(K.radialGradientPosition.isCenter=!1,K.radialGradientPosition.isRight=1===Fa.FillToRight,K.radialGradientPosition.isBottom=
1===Fa.FillToBottom));Fa=K}else Fa=null;da.gradientFill=Fa;Aa.EditOptions&&(Ua.editOptions=new B,Ua.editOptions.command=Aa.EditOptions.Command,Ua.editOptions.formula1=Aa.EditOptions.Formula1,Ua.editOptions.formula2=Aa.EditOptions.Formula2,Ua.editOptions.value=Aa.EditOptions.Value,Ua.editOptions.unique=Aa.EditOptions.Unique,Ua.editOptions.timePeriod=Aa.EditOptions.TimePeriodType)}else b.ULS.shipAssertTag(537167179,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.CustomFormat for custom rule type");
break;default:b.ULS.sendTraceTag(537167178,0,10,"GetConditionalFormattingRulesHelper.GetReactRuleType unexpected rule type")}Pb[Qa]=Ib;Qa++}Z=Pb}fa(Ea,Z,0)}else b.ULS.sendTraceTag(593589698,0,10,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: failed to get rules from server. Result is null: ${!Qa}.`)},U=Qa=>{b.ULS.sendTraceTag(593589697,0,50,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesFailed: status = ${Qa.data.status}, HTTP status = ${Qa.data.httpStatus}.`)},
ca=(Qa,Z)=>Qa.priority-Z.priority;var Q=a(1),Y=a(21),la=a(155);class ea extends Sys.EventArgs{constructor(Qa,Z){super();this.Jrd=Z}}Object(t.a)(ea,"ConditionalFormattingSheetProtectionOptionsChangedEventArgs",Sys.EventArgs,[]);class ha{constructor(Qa){this.M2i="OnProtectionOptionsChanged";this.HCf="OnActiveSheetChanging";this.VOa=!1;this.Qa=new f.a;this.t8b=this.inc=this.rnc=this.$Mb=0;this.N6b=null;this.Wza=(Z,wa)=>{Y.h(this.$).inRangePicker||Y.h(this.$).ni||!wa.na||(this.iFe(),Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")?
this.Gqi(wa.na)?this.Qa.raiseEvent("sheetProtectionOptionsChangedEventKey",new ea(!0,!1)):this.Mda(this.HCf,wa.na.sheetName,!1):this.Mda(this.HCf,wa.na.sheetName))};this.LCf=(Z,wa)=>{wa.newName!==wa.oldName&&wa.newName===this.$.ua.na.name&&this.a5j(wa.newName)};this.Gf=()=>{if(Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")){const {tlc:Z,DTf:wa}=this.tlc();Z&&this.$.na&&this.$.na.sheetName===wa||this.t8b===this.$.ea.jn.ConditionalFormattingRulesStateId||this.Mda("LatestCFStateIdChanged")}else this.t8b!==
this.$.ea.jn.ConditionalFormattingRulesStateId&&this.Mda("LatestCFStateIdChanged")};this.dd=(Z,wa)=>{b.ULS.sendTraceTag(537167202,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged Begin of OnSessionIdChanged");wa.XH&&this.Mda("OnSessionIdChanged");b.ULS.sendTraceTag(537167201,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged End of OnSessionIdChanged")};this.So=()=>{b.ULS.sendTraceTag(537167200,0,50,"ActiveSheetConditionalFormattingRules.OnLoadOnDemand");this.Mda("OnLoadOnDemand")};
this.U5j=(Z,wa,Ea=0)=>{Z>this.inc&&(this.inc=Z,this.N6b=wa,this.ONc=Ea,this.VOa=!0,this.Qa.raiseEvent("ConditionalFormattingRulesChangedEventKey"))};this.OYi=(Z,wa,Ea)=>{this.VOa=!1;U(Z,wa,Ea)};this.$=Qa;this.ONc=0;this.$.ea.jn&&(this.t8b=this.$.ea.jn.ConditionalFormattingRulesStateId)}get E3e(){return this.ONc}oQg(Qa){this.Qa.addHandler("ConditionalFormattingRulesChangedEventKey",Qa);this.$Mb++;1===this.$Mb&&this.Qkj();this.Mda("OnConditionalFormattingRulesChangedEventRegistered")}npj(Qa){this.Qa.removeHandler("ConditionalFormattingRulesChangedEventKey",
Qa);1>this.$Mb||(this.$Mb--,this.$Mb||this.Olg())}YSg(Qa){this.Qa.addHandler("sheetProtectionOptionsChangedEventKey",Qa)}wrj(Qa){this.Qa.removeHandler("sheetProtectionOptionsChangedEventKey",Qa)}getConditionalFormattingRules(Qa=null){let Z;Z=null;if(!this.VOa)return this.Mda("OnInvalidCache"),{returnValue:!1,M6b:Z};Z=this.Sbh(this.N6b,Qa);return{returnValue:!0,M6b:Z}}iFe(){this.inc=this.rnc;this.N6b=null;this.VOa=!0;this.ONc=0;this.Qa.raiseEvent("ConditionalFormattingRulesChangedEventKey")}dispose(){this.Olg()}Jrd(){return this.$.ua?
(new la.a(this.$.ua)).Zd(4):!1}Mda(Qa,Z=null,wa=!0){if(this.$.ea.jc)if(Z||this.$.ua.na&&this.$.ua.na.sheetName)if(Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&wa&&!this.Jrd())this.Qa.raiseEvent("sheetProtectionOptionsChangedEventKey",new ea(!0,!1));else{++this.rnc;var Ea=this.rnc;this.t8b=this.$.ea.jn?this.$.ea.jn.ConditionalFormattingRulesStateId:0;var fa=Z||this.$.ua.na.sheetName;u(this.$.pa.va,!0,this.jZh(fa),Ua=>{this.PYi(Ua,fa,Ea)},this.OYi,null,this.$.pa.va.ic())}else b.ULS.sendTraceTag(592487841,
0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Sheets Active Item is null. ActiveItem is null: {0}. ActiveItem.SheetName is null: {1}. Is during application shut down: {2}. Get rules trigger method: {3}.",!this.$.na,this.$.na?!this.$.na.sheetName:!1,!Sys.Application||Sys.Application.get_isDisposing(),Qa),this.VOa=!1;else b.ULS.sendTraceTag(592843921,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Session is not active."),this.VOa=!1}PYi(Qa,
Z,wa){Qa&&Qa.Result&&!F.a(Qa)||(this.VOa=!1);O(Qa,this.$,Z,wa,this.U5j)}a5j(Qa){for(const Z of this.N6b)Z.ruleRangeSheetName=Qa}Sbh(Qa,Z){if(!Qa)return null;const wa=[];Z=Z?n.g(Z):null;for(const Ea of Qa)Z&&!n.a(n.X(Ea.ruleRange,this.$.listSeparator),Z)||wa.push(Ea);return wa}Qkj(){this.$.ua.PJ(this.Wza);this.$.ea.Zj(this.dd);Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5080484_ConditionalFormattingManagerUpdateOnSheetRename")&&this.$.ua.FHa(this.LCf);this.$.ea.vu(this.Gf);this.$.ea.pM(this.So)}Olg(){this.$.ua.nL(this.Wza);
this.$.ea.xk(this.dd);Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5080484_ConditionalFormattingManagerUpdateOnSheetRename")&&this.$.ua.oSa(this.LCf);this.$.ea.$v(this.Gf);this.$.ea.iS(this.So)}t$a(){this.$.ea.Ee!==d.a.ue&&this.$.ea.jc&&this.Mda("LatestStateIdChanged")}tlc(){let Qa=!1,Z;const wa=this.$.ea.jn;if(wa&&wa.SheetChanges&&this.$.ua){var Ea=wa.SheetChanges;const fa=this.$.ua.na;if(!fa)return{tlc:!1,DTf:void 0};for(let Ua of Ea)Ea=128===Ua.Options||131072===Ua.Options,6!==Ua.Type&&7!==Ua.Type||
!Ea||(this.L2i(wa,fa,Ua),Z=Ua.Name,Qa=!0)}return{tlc:Qa,DTf:Z}}L2i(Qa,Z,wa){wa=this.$.Qi.getItemByName(wa.Name).index;Qa=Qa.Sheets[wa];wa=1024===(Qa.Flags&1024);const Ea=!!Qa.AllowSheetProtectionFeatures&&!!(Qa.AllowSheetProtectionFeatures&4);wa=!(16===(Qa.Flags&16)&&!wa)||Ea;if(Z=Qa.Name===Z.sheetName)wa?(this.iFe(),this.Mda(this.M2i,void 0,!1)):this.inc=this.rnc;this.Qa.raiseEvent("sheetProtectionOptionsChangedEventKey",new ea(Z,wa))}Gqi(Qa){const Z=Qa.ZHa&4;return!!Qa&&Qa.di&&!Z}jZh(Qa){return n.p(Qa,
"",0,0,0,0)}}Object(t.a)(ha,"ActiveSheetConditionalFormattingRules",null,[]);var X=a(1367),T=a(778),ua=a(167),Ha=a(355),Ca=a(154),Ga=a(41),sa=a(70);class bb{static MCf(Qa,Z){if(Z&&F.a(Z)){const wa=A.a.xc(Z.Errors);b.ULS.sendTraceTag(578336280,0,50,`OnAddConditionalFormattingRuleSuccess: request ended with errors: ${wa}.`);bb.acg(Qa,Z)}Ca.b("ConditionalFormatting_OnAddConditionalFormattingRuleSuccess")}static sTi(Qa){b.ULS.sendTraceTag(578336279,0,50,`GetConditionalFormattingRulesHelper.OnAddConditionalFormattingRuleFailed: status = ${Qa.data.status}, HTTP status = ${Qa.data.httpStatus}.`)}static jXi(Qa,
Z,wa){if(wa&&F.a(wa)){const Ea=A.a.xc(wa.Errors);b.ULS.sendTraceTag(573686987,0,50,`OnEditConditionalFormattingRuleSuccess: request ended with errors: ${Ea}.`);bb.acg(Qa,wa);bb.vOj(Qa,wa);Z.f3d()}}static iXi(Qa){b.ULS.sendTraceTag(573686986,0,50,`GetConditionalFormattingRulesHelper.OnEditConditionalFormattingRuleFailed: status = ${Qa.data.status}, HTTP status = ${Qa.data.httpStatus}.`)}static acg(Qa,Z){Z&&A.a.fh(Z.Errors,bb.conditionalFormattingAddRuleInvalidFormula)&&(Z=A.a.nd(1,1,2221,2222,0,104275673,
"ConditionalFormattingAddRuleInvalidFormula"),Q.EwaSettings.By()?new Ha.a(Qa,Z):(new ua.ErrorDialog(Qa,Z)).qg())}static vOj(Qa,Z){if(Z){let wa=null;A.a.fh(Z.Errors,bb.conditionalFormattingCantApplyRangeOutsidePivotTable)?wa=A.a.nd(1,1,2221,2223,0,666127521,"ConditionalFormattingCantApplyRangeOutsidePivotTable"):A.a.fh(Z.Errors,bb.conditionalFormattingCantApplyRangeInsidePivotTable)&&(wa=A.a.nd(1,1,2221,2224,0,1259721746,"ConditionalFormattingCantApplyRangeInsidePivotTable"));wa&&(Q.EwaSettings.By()?
new Ha.a(Qa,wa):(new ua.ErrorDialog(Qa,wa)).qg())}}static FRf(Qa,Z){if(Z.startsWith("="))return Z;if(Qa=Object(sa.c)({xna:266,new:Ga.g,registry:Qa.da,oLa:Q.EwaSettings.Kqa}))if(Qa=Qa.toXLNumber(Z),null!=Qa)return Qa.toString();return`="${Z}"`}static Qui(Qa,Z,wa){let Ea;return Qa.startsWith("=")&&({V7:Ea}=n.bb(Qa.substring(1,Qa.length),Z,wa)).returnValue?0<Ea.length&&!(1===Ea.length&&Ea[0].isSingle):!1}static Lui(Qa,Z,wa){for(let Ea of Z.ua.items){const fa=wa.extractReferences(Qa,Ea.sheetName,Z.workbookContext.WorkbookFileName,
!0);if(fa&&fa.Items.some(Ua=>Ua.IsStructRef))return!0}return!1}static getFormulaErrorType(Qa,Z,wa){return Qa?bb.Qui(Qa,Z.listSeparator,Z.ua)||Q.EwaSettings.isChangeGateEnabled("OfficeVSO:7181548_CFBlockStructuredRef")&&bb.Lui(Qa,Z,wa)?3:0:1}static getRangeErrorType(Qa,Z,wa){if(!Qa)return 1;let Ea;return({V7:Ea}=n.bb(Qa,Z,wa)).returnValue&&n.W(Ea)?0:2}static getRangeError(Qa,Z,wa,Ea){if(!Qa)return 1;let fa;return({V7:fa}=n.bb(Qa,Z,wa)).returnValue&&n.W(fa)?this.Wzi(wa,Ea)?6:0:2}static Wzi(Qa,Z){Qa=
Qa.getItemByName(Z);if(!Qa)return!1;Z=Qa.ZHa&4;return!(!Qa||!Qa.di||Z)}}bb.conditionalFormattingAddRuleInvalidFormula=[104275673];bb.conditionalFormattingCantApplyRangeOutsidePivotTable=[666127521];bb.conditionalFormattingCantApplyRangeInsidePivotTable=[1259721746];Object(t.a)(bb,"ConditionalFormattingRuleEditorHelper",null,[]);var Ba=a(1336),qa=a(33),pa=a(15);class ya{constructor(){this.getRangeError=this.getRangeErrorType=this.getFormulaErrorType=this.addNewRuleFromTaskPane=this.onRuleEdited=this.onRuleAdded=
this.setFocusOnToolbarFirstElement=this.onDeleteRulesByFilter=this.onRuleDuplicate=this.onRuleDelete=this.onRuleHoverStateChange=this.onRuleFilteringOptionsChange=this.changeTaskPaneView=null}}Object(t.a)(ya,"ConditionalFormattingTaskPaneCallbacks",null,[]);class za{constructor(){this.type=null;this.ruleFilterOption=this.taskPaneViewType=0;this.notification=this.uiElementsIds=this.error=this.borderMenuController=this.colorPickerButtonController=this.rangePickerController=this.updateTaskPaneTriggerMethodName=
this.callbacks=this.rule=this.rules=this.firstPaneElementId=null}}Object(t.a)(za,"ConditionalFormattingTaskPaneProps",null,[]);class cb{constructor(){this.ruleListId=this.loadingRuleListId=this.ruleManagerId=this.firstPaneElementId=null}}Object(t.a)(cb,"ConditionalFormattingUIElementIds",null,[]);class Pa{constructor(Qa,Z){this.XFe=null;this.YA=Qa;this.$=Z}AL(Qa,Z,wa,Ea=null){r.UISurfaces.Aj().then(fa=>{fa.showTaskPane("ConditionalFormattingTaskPane",this.Eu(Qa,Z,wa,void 0,Ea));this.YA.Q_i();return null})}fC(Qa,
Z,wa,Ea=null,fa=null,Ua=0,Aa=null){r.UISurfaces.Aj().then(Ib=>{const Pb=this.$.Rb.Qc("UserAction","ConditionalFormattingTPRenderStopwatch");Ib.updateTaskPane("ConditionalFormattingTaskPane",this.Eu(Qa,Z,wa,Ea,fa,Ua,Aa));Pb.stop();this.YA.D5i();return null})}HK(){r.UISurfaces.Aj().then(Qa=>{Qa.hideTaskPane("ConditionalFormattingTaskPane",2);return null})}Paa(){this.XFe()}RBa(){r.UISurfaces.Aj().then(Qa=>{Qa.setSelectedTaskPane("ConditionalFormattingTaskPane");return null})}Eu(Qa,Z,wa,Ea=null,fa=null,
Ua=0,Aa=null){const Ib=Object(c.a)(new ya,{onRuleFilteringOptionsChange:this.YA.onRuleFilteringOptionsChange,onRuleHoverStateChange:this.YA.onRuleHoverStateChange,setFocusOnToolbarFirstElement:this.YA.setFocusOnToolbarFirstElement,onRuleDelete:this.YA.onRuleDelete,onRuleDuplicate:this.YA.onRuleDuplicate,changeTaskPaneView:this.YA.E5i,onDeleteRulesByFilter:this.YA.onDeleteRulesByFilter,onRuleAdded:this.YA.onRuleAdded,onRuleEdited:this.YA.onRuleEdited,addNewRuleFromTaskPane:this.YA.addNewRuleFromTaskPane,
getFormulaErrorType:Fa=>bb.getFormulaErrorType(Fa,this.$,this.calcManager),getRangeErrorType:Fa=>bb.getRangeErrorType(Fa,this.$.listSeparator,this.$.ua),getRangeError:(Fa,da)=>bb.getRangeError(Fa,this.$.listSeparator,this.$.ua,da)}),Pb=Object(c.a)(new cb,{firstPaneElementId:Ba.a.firstPaneElementId,ruleManagerId:Ba.a.ruleManagerId,loadingRuleListId:Ba.a.loadingRuleListId,ruleListId:Ba.a.ruleListId});Z=Object(c.a)(new za,{type:"ConditionalFormattingTaskPaneProps",taskPaneViewType:Z,ruleFilterOption:wa,
rules:Ea,rule:fa,firstPaneElementId:Ba.a.firstPaneElementId,callbacks:Ib,rangePickerController:Y.h(this.$).Wg.r6a(),error:Ua,uiElementsIds:Pb,notification:Aa,colorPickerButtonController:this.YA.colorPickerButtonController,borderMenuController:this.YA.borderMenuController});if(qa.a.Md())return Object(c.a)(new X.a,{contentProps:Z,onOpen:()=>{this.YA.CI()},onClose:()=>{this.YA.jx()},onShow:()=>{this.YA.KJf()},onHide:()=>{this.YA.Wda()},width:320,title:pa.a.instance.ha(1299),preventCloseCallback:Fa=>
{this.YA.fGd();this.XFe=Fa}});Qa=Object(c.a)(new T.a,{container:Qa,paneProps:Z});return Object(c.a)(new X.a,{contentProps:Qa,onOpen:()=>{this.YA.CI()}})}}Object(t.a)(Pa,"ConditionalFormattingReactTaskPane",null,[973]);class nb{constructor(Qa,Z,wa,Ea,fa){this.iconSetFormat=this.colorScaleFormat=this.dataBarFormat=this.conditionalFormatting=this.range=null;this.range=Z;this.conditionalFormatting=Qa;this.dataBarFormat=wa;this.colorScaleFormat=Ea;this.iconSetFormat=fa}getRange(){return this.range}}Object(t.a)(nb,
"MacroRecorderRangeConditionalFormattingCreatedPayload",null,[145]);class Ma{constructor(Qa,Z){this.range=null;this.priority=0;this.range=Qa;this.priority=Z}getRange(){return this.range}dzb(){return this.priority}}Object(t.a)(Ma,"MacroRecorderRangeConditionalFormattingRuleDeletedPayload",null,[145]);var Oa=a(73),La=a(380),ra=a(199),V=a(53),ma=a(426),W=a(39),aa=a(125),ia=a(23),ka=a(293),Xa=a(353);class sb{constructor(){this.newJSApiPriority=this.iconSetFormat=this.colorScaleFormat=this.dataBarFormat=
this.customFormat=this.stopIfTrue=this.options=this.activeCell=this.ruleRangeSheetName=this.range=this.priority=this.addRuleType=this.guid=null}}Object(t.a)(sb,"ConditionalFormattingEditableRule",null,[]);class ib{constructor(){this.taskPaneExpandEvent=this.sheetProtectionOptionsChangedEvent=this.sheetDeletedEvent=this.sheetRenameEvent=null}}Object(t.a)(ib,"ConditionalFormattingNotification",null,[]);class Ub{constructor(){this.column=this.row=0}}Object(t.a)(Ub,"ConditionalFormattingRuleActiveCell",
null,[]);class hc{constructor(){this.sheetName=null}}Object(t.a)(hc,"SheetDeletedEventArgs",null,[]);class yb{constructor(){this.newSheetName=this.oldSheetName=null}}Object(t.a)(yb,"SheetRenameEventArgs",null,[]);class Gb{}Object(t.a)(Gb,"SheetProtectionOptionsChangedEventArgs",null,[]);class Sa{}Object(t.a)(Sa,"TaskPaneExpandEventArgs",null,[]);var db=a(60),fb=a(218),ab=a(157),wb=a(109);class kb{constructor(Qa){this.lua=this.nKc=this.f9d=this.pz=null;this.Krd=this.Yxa=this.rjc=!1;this.j4c=[28];this.Beb=
null;this.isInitialized=!1;this.Osf=this.bSb=this.GL=0;this.ELd=this.b4f=null;this.xcf=()=>{this.jx()};this.fGd=()=>{this.iZ.fC(this.lua,0,this.NU)};this.bLf=()=>{this.KRb(!1)};this.LGd=Z=>{Q.EwaSettings.isChangeGateEnabled("OfficeVSO:6008894_CFAddNewRuleRangePickerProtectedError")&&2===this.GL?this.sendNotification({sheetProtectionOptionsChangedEvent:new Gb}):1===this.GL&&Z&&(++this.bSb,this.o2d(this.bSb,[],3))};this.ycf=()=>{this.KJf()};this.$md=()=>{this.Wda()};this.E5i=Z=>{1===Z&&1!==this.GL&&
(this.GL=1,this.KRb());1!==Z&&1===this.GL&&this.pLb();0===Z&&(qa.a.Md()?this.iZ.Paa():this.pz.A$g());this.GL=Z};this.fMf=(Z,wa)=>{this.sendNotification(Object(c.a)(new ib,{sheetRenameEvent:Object(c.a)(new yb,{oldSheetName:wa.oldName,newSheetName:wa.newName})}))};this.OD=(Z,wa)=>{this.sendNotification(Object(c.a)(new ib,{sheetDeletedEvent:Object(c.a)(new hc,{sheetName:wa.item.name})}))};this.Ze=()=>{1!==this.GL||this.Esd||Y.h(this.$).inRangePicker||Y.h(this.$).ni||this.KRb()};this.onRuleFilteringOptionsChange=
Z=>{this.NU!==Z&&(b.ULS.sendTraceTag(42824727,0,50,`ConditionalFormattingPaneManager.OnRuleFilteringOptionsChange: filtering option has changed to: ${Z}`),this.NU=Z,this.KRb())};this.onRuleHoverStateChange=(Z,wa,Ea)=>{if(Z){let fa;({V7:fa}=n.bb(Ea,this.$.listSeparator,this.$.ua)).returnValue?Y.h(this.$).Jb.pA(Xa.a.$Ca(Oa.d(this.$.na),fa),this.j4c,!0):b.ULS.shipAssertTag(537948622,0,!1,"ConditionalFormattingPaneManager.OnRuleHoverStateChange: Failed to parse range when highlighting rule range")}else Y.h(this.$).Jb.ik(this.j4c)};
this.onRuleDelete=Z=>{this.deleteConditionalFormattingRules(61,this.selectedRanges,Z)};this.onRuleDuplicate=Z=>{this.iuh(Z)};this.onRuleAdded=Z=>{const {appliedRange:wa,V7:Ea}=this.V9e(Z.range,Z.ruleRangeSheetName,"onRuleAdded");if(wa){var fa={};Z.activeCell?(fa.FirstRow=Z.activeCell.row,fa.FirstColumn=Z.activeCell.column):(fa.FirstRow=wa.Ranges[0].FirstRow,fa.FirstColumn=wa.Ranges[0].FirstColumn);var Ua=this.UJb(Z,!0),Aa=()=>new nb(Ua,wa,null,null,null);this.lFc();var Ib=this.$.pa.va.ic(),{ConditionalFormattingCommandHandler:Pb}=
a(967);Q.EwaSettings.isChangeGateEnabled("OfficeVSO:7153738_CFRuleEditorLogging")&&Pb.vxb&&Ca.b("ConditionalFormatting_HighlightWhen_RuleCreated");Pb.vxb=!1;Pb=this.a4f(wa,Ea);b.ULS.sendTraceTag(526930257,0,50,`ConditionalFormattingPaneManager.OnRuleAdded: Adding a new rule with: ${Pb}`);La.a(this.$.userOperationManager,(Fa,da,K)=>w(this.$.pa.va,this.UJb(Z,!1),wa,fa,ka.b(Fa,xa=>{bb.MCf(this.$,xa)}),ka.a(da,bb.sTi),K,Ib),Fa=>new ra.a(105,0,Fa,void 0,Aa),null)}};this.onRuleEdited=Z=>{let wa;var Ea=
null;let fa;if(Z.range)if(({V7:fa,sheetName:Ea}=n.bb(Z.range,this.$.listSeparator,this.$.ua)).returnValue)if(n.W(fa))b.ULS.shipAssertTag(574410754,0,!Ea||ia.a.equals(Ea,Z.ruleRangeSheetName,!1),"ConditionalFormattingPaneManager.OnRuleEdited: Sheet name was modified in rule range, which is not allowed when editing range"),wa=n.u(Z.ruleRangeSheetName,null,fa);else{b.ULS.shipAssertTag(557601051,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Range is invalid.");return}else{b.ULS.shipAssertTag(574410753,
0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Failed to parse range when editing an existing rule");return}else wa={},wa.SheetName=Z.ruleRangeSheetName;if(this.$.ua.contains(wa.SheetName)){var Ua={FirstRow:0,FirstColumn:0};this.lFc();var Aa=this.$.pa.va.ic(),Ib=null;this.$.Qca&&(Ib=this.UJb(Z,!0));var Pb=()=>new nb(Ib,this.ELd,null,null,null);Z.range&&(Ea=this.a4f(wa,fa),b.ULS.sendTraceTag(526930256,0,50,`ConditionalFormattingPaneManager.OnRuleEdited: Editing a rule with: ${Ea}`));La.a(this.$.userOperationManager,
(Fa,da,K)=>m(this.$.pa.va,Z.guid,this.UJb(Z,!1),wa,Ua,ka.b(Fa,xa=>{bb.jXi(this.$,this,xa)}),ka.a(da,bb.iXi),K,Aa),Fa=>new ra.a(105,0,Fa,64,Pb),null)}else b.ULS.shipAssertTag(557682696,1,!1,"ConditionalFormattingPaneManager.OnRuleEdited: sheet wasn't found, might be renamed or deleted.")};this.onDeleteRulesByFilter=()=>{let Z,wa;switch(this.NU){case 0:Z=60;wa=this.selectedRanges;break;case 1:Z=59;wa=n.p(this.$.ua.na.name,"",0,0,0,0);break;default:b.ULS.sendTraceTag(590448070,0,10,`ConditionalFormattingPaneManager.OnClearRules with an unknown Rule Filtering: ${this.NU}`);
return}this.deleteConditionalFormattingRules(Z,wa,null)};this.IWi=Z=>{Z&&F.a(Z)&&(Z=A.a.xc(Z.Errors),b.ULS.sendTraceTag(595092188,0,15,`ConditionalFormattingPaneManager.OnRuleDelete: request ended with errors: ${Z}.`),this.f3d())};this.fXi=Z=>{Z&&F.a(Z)&&(Z=A.a.xc(Z.Errors),b.ULS.sendTraceTag(536966945,0,15,`ConditionalFormattingPaneManager.onDuplicateRuleSuccess: request ended with errors: ${Z}.`),this.f3d())};this.HWi=Z=>{b.ULS.sendTraceTag(595116629,0,50,`ConditionalFormattingPaneManager.OnDeleteRuleFailure: status = ${Z.data.status}, HTTP status = ${Z.data.httpStatus}.`)};
this.eXi=Z=>{b.ULS.sendTraceTag(536966944,0,50,`ConditionalFormattingPaneManager.onDuplicateRuleFailure: status = ${Z.data.status}, HTTP status = ${Z.data.httpStatus}.`)};this.setFocusOnToolbarFirstElement=()=>{qa.a.Md()?r.UISurfaces.Aj().then(Z=>{Z.focusTabbedTaskPaneArea();return null}):this.pz.setFocusOnToolbarFirstElement()};this.addNewRuleFromTaskPane=()=>{const {ConditionalFormattingCommandHandler:Z}=a(967);b.ULS.sendTraceTag(573686988,0,50,"ConditionalFormattingPaneManager.AddNewRuleFromTaskPane");
Z.vxb=!1;this.jic(Z.l9b)};this.Dc=(Z,wa)=>{!wa.Sf&&this.rjc&&this.jx()};this.$=Qa;this.iZ=new Pa(this,this.$);this.iqd=this.$.Rb.Qc("UserAction","ConditionalFormattingTPInitialLoadStopwatch");this.OY=new ha(Qa);this.NU=this.INe=0;qa.a.Md()&&this.$.wj(this.Dc)}get colorPickerButtonController(){return this.f9d}get borderMenuController(){return this.nKc}get selectedRanges(){return n.r(Y.h(this.$).ga.qa.selectedRanges,this.$)}get Esd(){return 1===this.NU}nLe(Qa=null){Ca.b("LaunchConditionalFormattingTaskPane");
const Z=Q.EwaSettings.isChangeGateEnabled("OfficeVSO:7181548_CFBlockStructuredRef");if(qa.a.Md()){const Ea=V.GetServiceTaskFactory.create(this.$.da,111,this.$.ka,0),fa=V.GetServiceTaskFactory.Sa(this.$.da,296,468,0);var wa=[Ea,fa];let Ua=null;Z&&(Ua=Q.EwaSettings.LF()?wb.d(ab.a.resolve(Ga.g,{rb:0})):V.GetServiceTaskFactory.Sa(this.$.da,266,265,0),wa.push(Ua));W.TaskExtensions.za(W.TaskExtensions.Pd(wa,this.$.ka),()=>{Ua&&(this.iZ.calcManager=Ua.result);this.mhf(Ea.result,fa.result);this.jic(Qa)},
this.$.ka,3)}else if(this.pz||this.isInitialized)this.pz&&(this.pz.$g(!0),this.jic(Qa)),db.Task.Ua(!0);else{this.isInitialized=!0;const Ea=V.GetServiceTaskFactory.Sa(this.$.da,248,249,0),fa=ma.a(this.$),Ua=V.GetServiceTaskFactory.create(this.$.da,111,this.$.ka,0),Aa=V.GetServiceTaskFactory.Sa(this.$.da,296,468,0);wa=[Ea,fa,Ua,Aa];let Ib=null;Z&&(Ib=Q.EwaSettings.LF()?wb.d(ab.a.resolve(Ga.g,{rb:0})):V.GetServiceTaskFactory.Sa(this.$.da,266,265,0),wa.push(Ib));W.TaskExtensions.za(W.TaskExtensions.Pd(wa,
this.$.ka),()=>{this.pz=Ea.result;fa.result.nR(this.pz);this.xUi();this.pz.$g(!0);Ib&&(this.iZ.calcManager=Ib.result);this.mhf(Ua.result,Aa.result);this.jic(Qa)},this.$.ka,3)}}xUi(){this.lua=this.pz.HU();this.pz.dU(this.xcf);this.pz.pSg(this.fGd);this.pz.qSg(this.$md);this.pz.rSg(this.ycf)}CI(){b.ULS.sendTraceTag(42824723,0,50,"ConditionalFormattingPaneManager.OnPaneOpen Begin of OnPaneOpen");this.Yxa||(this.HI(),this.Yxa=!0);this.Krd=!0}jx(){this.hideTaskPane();this.Yxa&&this.$md(null,null);this.GL=
0;this.NU=this.INe;this.lFc()}pLb(){Y.h(this.$).Jb.Mk(null,this.j4c)}HI(){Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&this.OY.YSg(this.LGd);this.OY.oQg(this.bLf);Y.h(this.$).ga.QJ(this.Ze);this.$.ua.FHa(this.fMf);this.$.ua.TY(this.OD)}KRb(Qa=!0){1===this.GL&&(Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&Qa&&!this.OY.Jrd()?this.LGd(!0):(++this.bSb,this.Esd||1!==this.OY.E3e)?({M6b:Qa}=this.OY.getConditionalFormattingRules(this.Esd?
null:this.selectedRanges.Ranges)).returnValue&&(this.cog(),this.o2d(this.bSb,Qa,this.OY.E3e)):(this.cog(),this.V5j()))}cog(){const Qa={};Qa.SheetName=this.selectedRanges.SheetName;Qa.NamedObjectName=this.selectedRanges.NamedObjectName;Qa.Ranges=Array(this.selectedRanges.Ranges.length);for(let Z=0;Z<this.selectedRanges.Ranges.length;Z++)Qa.Ranges[Z]=this.selectedRanges.Ranges[Z];this.ELd=Qa}V5j(){if(this.$.ea.jc){var Qa=this.selectedRanges;u(this.$.pa.va,!1,Qa,Z=>{O(Z,this.$,Qa.SheetName,this.bSb,
(wa,Ea,fa)=>{this.o2d(wa,Ea,fa)})},U,null,this.$.pa.va.ic())}else b.ULS.sendTraceTag(592843217,0,10,"ConditionalFormattingPaneManager.UpdateConditionalFormattingRulesFromSelection: Session is not active.")}o2d(Qa,Z,wa){1===this.GL&&Qa>=this.Osf&&(this.iZ.fC(this.lua,this.GL,this.NU,Z,void 0,wa),this.b4f=Z,this.Osf=Qa)}KJf(){this.Yxa||(this.HI(),this.Yxa=!0);qa.a.Md()||(this.Krd&&this.pz.F8f(),this.pz.n4c());Q.EwaSettings.isChangeGateEnabled("OfficeVSO:6008894_CFAddNewRuleRangePickerProtectedError")&&
this.sendNotification({taskPaneExpandEvent:new Sa})}Wda(){this.Yxa&&(this.d4j(),this.pLb(),this.Yxa=!1,this.Beb=null)}F3i(){this.Yxa&&(this.Beb=this.$.Rb.Qc("UserAction","ConditionalFormattingRibbonCommandRenderStopwatch"))}G3i(){this.Beb=null}d4j(){Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&this.OY.wrj(this.LGd);this.OY.npj(this.bLf);Y.h(this.$)&&Y.h(this.$).ga&&Y.h(this.$).ga.LI(this.Ze);this.$.ua.oSa(this.fMf);this.$.ua.g8(this.OD)}sendNotification(Qa){2===
this.GL&&this.iZ.fC(this.lua,2,this.NU,void 0,void 0,void 0,Qa)}deleteConditionalFormattingRules(Qa,Z,wa){b.ULS.sendTraceTag(591925914,0,50,`ConditionalFormattingPaneManager.OnRuleDelete with type: ${Qa}, id: ${wa||"empty"}`);this.lFc();const Ea=this.$.pa.va.ic(),fa=this.WUh(Qa,wa);La.a(this.$.userOperationManager,(Ua,Aa,Ib)=>v(this.$.pa.va,Qa,Z,wa,ka.b(Ua,this.IWi),ka.a(Aa,this.HWi),Ib,Ea),Ua=>new ra.a(221,0,Ua,64,fa),null)}iuh(Qa){let Z=Qa.guid;Z||b.ULS.sendTraceTag(536966946,0,10,"ConditionalFormattingPaneManager.duplicateConditionalFormattingRule with missing id!");
const {appliedRange:wa}=this.V9e(Qa.range,Qa.ruleRangeSheetName,"duplicateConditionalFormattingRule");if(wa){var Ea=this.$.pa.va.ic(),fa=this.UJb(Qa,!0),Ua=()=>new nb(fa,wa,Qa.dataBarFormat,Qa.colorScaleFormat,Qa.iconSetFormat);La.a(this.$.userOperationManager,(Aa,Ib,Pb)=>x(this.$.pa.va,Qa.ruleRangeSheetName,Z,ka.b(Aa,this.fXi),ka.a(Ib,this.eXi),Pb,Ea),Aa=>new ra.a(105,0,Aa,64,Ua),null)}}WUh(Qa,Z){let wa=-1,Ea=null;this.$.Qca&&Q.EwaSettings.isChangeGateEnabled("OfficeVSO:4296101_MakerConditionalFormatDeleteByPriority")&&
(Z?1===this.NU?{priority:wa,range:Ea}=this.OWh(Z):(wa=this.D4e(this.b4f,Z),Ea=this.ELd):Ea=59===Qa?n.r([],this.$):this.selectedRanges);return()=>new Ma(Ea,wa)}V9e(Qa,Z,wa){let Ea=null;if(({V7:Qa,sheetName:Ea}=n.bb(Qa,this.$.listSeparator,this.$.ua)).returnValue)if(n.W(Qa)){Z=n.u(Ea||Z,null,Qa);if(this.$.ua.contains(Z.SheetName))return{appliedRange:Z,V7:Qa};b.ULS.shipAssertTag(557682697,1,!1,`ConditionalFormattingPaneManager.${wa}: sheet wasn't found, might be renamed or deleted.`)}else b.ULS.shipAssertTag(557601052,
0,!1,`ConditionalFormattingPaneManager.${wa}: Range is invalid.`);else b.ULS.shipAssertTag(574410755,0,!1,`ConditionalFormattingPaneManager.${wa}: Failed to parse range when adding a new rule`)}D4e(Qa,Z){for(let wa=0;wa<Qa.length;++wa)if(Qa[wa].ruleId===Z)return Qa=wa;return 0}OWh(Qa){({M6b:Ea}=this.OY.getConditionalFormattingRules());var Z=null;for(var wa of Ea)wa.ruleId===Qa&&(Z=wa);Z=n.X(Z.ruleRange,this.$.listSeparator);var Ea=Array(Z.length);for(wa=0;wa<Z.length;++wa)Ea[wa]=n.j(Z[wa]);({M6b:Ea}=
this.OY.getConditionalFormattingRules(Ea));Ea.sort(ca);Qa=this.D4e(Ea,Qa);Z=n.r(Z,this.$);return{priority:Qa,range:Z}}dispose(){qa.a.Md()&&this.$.ll(this.Dc);this.$=null;this.hideTaskPane();this.pz&&(this.pz.eX(this.xcf),this.pz.Qqj(this.fGd),this.pz.Rqj(this.$md),this.pz.Sqj(this.ycf),this.pz=this.lua=null);this.iZ=null;this.OY.dispose();this.OY=null}f3d(){1===this.GL&&this.KRb()}v8h(Qa){return 1==Qa.Ranges.length?(Qa=Qa.Ranges[0],Qa.FirstRow===Qa.LastRow?Qa.FirstColumn===Qa.LastColumn?"Single Cell":
"Row":Qa.FirstColumn===Qa.LastColumn?"Column":"Rectangle"):"Multi"}u8h(Qa){let Z=null;for(const wa of Qa.Ranges){Qa=n.C(wa);const Ea=Object(fb.a)(this.$,Qa);Qa=null===Ea?"None":Ea.usedRange.contains(Qa)?"Containing":"Intersecting";Z=null===Z||Z===Qa?Qa:"Intersecting"}return null===Z?"None":Z}J$e(Qa){return 100*Math.ceil(Qa/100)}a4f(Qa,Z){const wa=this.v8h(Qa);Qa=this.u8h(Qa);Z=this.J$e(n.b(Z));const Ea=this.J$e(Y.h(this.$).usedRange.bottom);return`rangeType ${wa} ; tableRelation: ${Qa} ; numOfCellsInRangeBucket: ${Z} ; usedRangeRowsBucket: ${Ea}`}UJb(Qa,
Z){const wa=Qa.options;let Ea=null,fa=wa.quickFormat?wa.quickFormat:0;6===fa&&(Qa.customFormat?(Ea=this.cLh(Qa),fa=6):(b.ULS.sendTraceTag(540615491,0,15,"ConditionalFormattingPaneManager.PrepareConditionalFormattingOptions: invalid custom format."),fa=0));return Object(c.a)(new e,{Command:wa.command,QuickFormatType:fa,CustomFormat:Ea,Formula1:wa.formula1&&Z?bb.FRf(this.$,wa.formula1):wa.formula1,Formula2:wa.formula2&&Z?bb.FRf(this.$,wa.formula2):wa.formula2,Value:wa.value||0,Unique:wa.unique||!1,
TimePeriodType:wa.timePeriod?wa.timePeriod:0,StopIfTrue:Qa.stopIfTrue||!1,Priority:Qa.priority||-1})}cLh(Qa){const Z={};Z.BackgroundColor=Qa.customFormat.backgroundColor;Z.PreserveBackgroundColor=Qa.customFormat.preserveBackgroundColor||!1;Qa.customFormat.backgroundColorThemeInfo&&(Z.BackgroundColorTheme={},Z.BackgroundColorTheme.ThemeColorIndex=Qa.customFormat.backgroundColorThemeInfo.index,Z.BackgroundColorTheme.ThemeColorRow=Qa.customFormat.backgroundColorThemeInfo.row);Z.TextColor=Qa.customFormat.textColor;
Z.PreserveTextColor=Qa.customFormat.preserveTextColor||!1;Qa.customFormat.textColorThemeInfo&&(Z.TextColorTheme={},Z.TextColorTheme.ThemeColorIndex=Qa.customFormat.textColorThemeInfo.index,Z.TextColorTheme.ThemeColorRow=Qa.customFormat.textColorThemeInfo.row);Z.IsTextBold=Qa.customFormat.isTextBold;Z.IsTextItalic=Qa.customFormat.isTextItalic;Z.IsTextStrikethrough=Qa.customFormat.isTextStrikethrough;Z.IsTextUnderlined=Qa.customFormat.isTextUnderlined;Z.IsTextDoubleUnderlined=Qa.customFormat.isTextDoubleUnderlined;
this.bLh(Qa,Z);return Z}bLh(Qa,Z){Z.BorderFormat={};if(Qa.customFormat.borderFormat){if(Z.BorderFormat.Position=Qa.customFormat.borderFormat.position||15,Z.BorderFormat.LineStyle=[Qa.customFormat.borderFormat.lineStyle[0],Qa.customFormat.borderFormat.lineStyle[1],Qa.customFormat.borderFormat.lineStyle[2],Qa.customFormat.borderFormat.lineStyle[3]],Z.BorderFormat.Color=[y.a.pp(Qa.customFormat.borderFormat.color[0]).MS(),y.a.pp(Qa.customFormat.borderFormat.color[1]).MS(),y.a.pp(Qa.customFormat.borderFormat.color[2]).MS(),
y.a.pp(Qa.customFormat.borderFormat.color[3]).MS()],Z.BorderFormat.Thickness=[0,0,0,0],Z.BorderFormat.ThemeBorderColor=[null,null,null,null],Qa.customFormat.borderFormat.themeColor)for(let wa=0;wa<Qa.customFormat.borderFormat.themeColor.length;wa++)Qa.customFormat.borderFormat.themeColor[wa]&&(Z.BorderFormat.ThemeBorderColor[wa]={},Z.BorderFormat.ThemeBorderColor[wa].ThemeColorIndex=Qa.customFormat.borderFormat.themeColor[wa].index,Z.BorderFormat.ThemeBorderColor[wa].ThemeColorRow=Qa.customFormat.borderFormat.themeColor[wa].row)}else Z.BorderFormat.Position=
15,Z.BorderFormat.LineStyle=[0,0,0,0],Z.BorderFormat.Color=[0,0,0,0],Z.BorderFormat.ThemeBorderColor=[null,null,null,null],Z.BorderFormat.Thickness=[0,0,0,0]}Q_i(){this.iqd&&(this.iqd.stop(),this.iqd=null)}D5i(){this.Beb&&(this.Beb.stop(),this.Beb=null)}jic(Qa){const Z=Qa?2:1;Qa=this.V0h(Qa);this.rjc?(this.iZ.RBa(),2===Z?this.iZ.fC(this.lua,2,this.NU,void 0,Qa):1!==this.GL&&this.iZ.fC(this.lua,1,this.NU)):(this.rjc=!0,this.GL=Z,this.iZ.AL(this.lua,this.GL,this.NU,Qa))}hideTaskPane(){this.Krd=this.rjc=
!1;this.iZ.HK()}V0h(Qa){if(!Qa)return null;const Z=n.o(Y.h(this.$).ga.qa.activeCell,this.$);return Object(c.a)(new sb,{guid:null,addRuleType:Qa,activeCell:Object(c.a)(new Ub,{row:Z.FirstRow,column:Z.FirstColumn}),range:n.i(Y.h(this.$).ga.qa.selectedRanges,this.$.listSeparator,this.$,!1,!1,!1),ruleRangeSheetName:Z.SheetName})}mhf(Qa,Z){this.f9d=Qa.qgh();Qa.P$e(!1,!1,!1,!1);this.nKc=Z.JUh();this.Lak(this.nKc.getBorderLineStyleProps())}Lak(Qa){aa.b(Qa,Z=>"BorderStyleSolidLine"===Z.key)&&aa.b(Qa,Z=>"BorderStyleDashedLine"===
Z.key)&&aa.b(Qa,Z=>"BorderStyleDottedLine"===Z.key)||b.ULS.sendTraceTag(540038171,0,10,"ConditionalFormattingPaneManager.VerifyCFBorderLineStyles: CF line styles are missing.")}lFc(){Q.EwaSettings.isChangeGateEnabled("OfficeVSO:6122888_ConditionalFormattingSurvey")&&this.$.Xc(2034864146,-1,0,null)}}Object(t.a)(kb,"ConditionalFormattingPaneManager",null,[]);var tb=a(25),hb=a(80),Fb=a(98),va=a(467),jb=a(94);a.d(C,"ConditionalFormattingCommandHandler",function(){return Ab});class Ab{constructor(Qa){this.mGa=
null;this.Qa=new f.a;this.FWi=Z=>{b.ULS.sendTraceTag(537167193,0,50,"ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback Clear CF rules from ribbon command");Z&&F.a(Z)&&(Z=A.a.xc(Z.Errors),b.ULS.sendTraceTag(589947023,0,15,`ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback: Clear CF rules request ended with errors: ${Z}.`))};this.DEf=()=>{this.mGa&&this.mGa.F3i()};this.EEf=()=>{this.mGa&&this.mGa.G3i()};this.$=Qa;Ab.TZb=!0;this.jq=qa.a.jq()}get Bah(){Ab.vLc||
this.k1g();return Ab.vLc}get ePf(){this.mGa||(this.mGa=new kb(this.$));return this.mGa}Oc(){return!1}executeCommand(Qa,Z,wa){Qa=W.TaskExtensions.lk();Ab.vxb=!1;if(this.jq){var Ea=this.$.ua.na;if(Ea&&Ea.name===va.a.current.uK&&jb.c(this.$.Ue)){Ea=this.$.da.Aa(237);const fa=Y.h(this.$);Ea.c0(Z.command,fa.ga.qa.activeCell)}}if(-20558303===Z.command)return Ab.TZb=!1,this.ePf.nLe(),Qa;wa=wa[hb.a.Uc];Q.EwaSettings.isChangeGateEnabled("OfficeVSO:7153738_CFRuleEditorLogging")&&454361567===Z.command&&(wa=
Ab.l9b,Ab.vxb=!0);2063445891===Z.command&&(wa=Ab.l9b,b.ULS.sendTraceTag(542782275,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromRibbon"));Ea=this.NWh(wa);switch(Ea){case 12:case 13:case 8:case 9:case 10:case 11:case 1:case 2:case 4:case 5:case 3:case 7:case 6:case 65:Ab.TZb=!1;2063445891!==Z.command&&454361567!==Z.command&&b.ULS.sendTraceTag(573686991,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromTaskPane");this.ePf.nLe(wa);break;case 59:case 62:this.gph(Ea);break;case 60:case 61:b.ULS.shipAssertTag(589947025,
0,!1,"ConditionalFormattingCommandHandler.ExecuteCommand: Not expecting to execute command of type ConditionalFormattingCommand.DeleteCells or ConditionalFormattingCommand.DeleteRule from the Ribbon");break;default:this.zgh(Ea)}return Qa}dispose(){this.Qa.dispose()}Ac(Qa,Z){Qa=!1;switch(Z.command){case -20558303:case 2063445891:case 454361567:case -300973317:case 97385776:Qa=this.$.isEditMode}return Qa}Vc(){return!1}S4e(){return n.r(Y.h(this.$).ga.qa.selectedRanges,this.$)}odg(){if(Ab.IPj){const Qa=
new Fb.a(-847286761,hb.a.Eb,this.$.Bc,0,h.a.L0);this.$.Ia.Nb(Qa,{["InputMethod"]:hb.a.Eb,CalloutName:1})}}zgh(Qa){b.ULS.sendTraceTag(573686989,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleNonCustom");this.DEf();const Z=this.$.pa.va.ic(),wa=n.o(Y.h(this.$).ga.qa.activeCell,this.$),Ea=this.S4e(),fa=Object(c.a)(new e,{Command:Qa,StopIfTrue:!1}),Ua=()=>new nb(fa,Ea,null,null,null);La.a(this.$.userOperationManager,(Aa,Ib,Pb)=>w(this.$.pa.va,fa,Ea,wa,ka.b(Aa,Fa=>{bb.MCf(this.$,Fa)}),ka.a(Ib,
()=>{this.EEf()}),Pb,Z),Aa=>new ra.a(105,0,Aa,void 0,Ua),null);this.odg()}gph(Qa){this.DEf();const Z=this.$.pa.va.ic();let wa,Ea;59===Qa?(Ea=n.r([],this.$),wa=n.q(new tb.Range(1,1,d.a.Fg,d.a.Eg,!1,!0),this.$)):Ea=wa=this.S4e();Object(c.a)(new e,{Command:62===Qa?60:Qa});const fa=()=>new Ma(Ea,-1);La.a(this.$.userOperationManager,(Ua,Aa,Ib)=>v(this.$.pa.va,Qa,wa,null,ka.b(Ua,this.FWi),ka.a(Aa,()=>{this.EEf()}),Ib,Z),Ua=>new ra.a(221,0,Ua,void 0,fa),null);this.odg()}NWh(Qa){return this.Bah[Qa]}k1g(){Ab.vLc=
{[Ab.l9b]:Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultRuleCFExperiment",!1)?65:1,["HighlightCellsGT"]:1,["HighlightCellsLT"]:2,["HighlightCellsBetween"]:3,["HighlightCellsEQ"]:4,["HighlightCellsContains"]:5,["HighlightCellsDate"]:6,["HighlightCellsDupe"]:7,["HighlightCellsNoBlanks"]:65,["TopBottomTop10"]:8,["TopBottomTop10P"]:9,["TopBottomBot10"]:10,["TopBottomBot10P"]:11,["TopBottomAA"]:12,["TopBottomBA"]:13,["DataBarsGradientFillBlue"]:15,["DataBarsGradientFillGreen"]:16,
["DataBarsGradientFillRed"]:17,["DataBarsGradientFillOrange"]:18,["DataBarsGradientFillLightBlue"]:19,["DataBarsGradientFillPurple"]:20,["DataBarsSolidFillBlue"]:21,["DataBarsSolidFillGreen"]:22,["DataBarsSolidFillRed"]:23,["DataBarsSolidFillOrange"]:24,["DataBarsSolidFillLightBlue"]:25,["DataBarsSolidFillPurple"]:26,["ColorScalesGYR"]:28,["ColorScalesRYG"]:27,["ColorScalesGWR"]:29,["ColorScalesRWG"]:30,["ColorScalesBWR"]:31,["ColorScalesRWB"]:32,["ColorScalesWR"]:35,["ColorScalesRW"]:36,["ColorScalesGW"]:38,
["ColorScalesWG"]:37,["ColorScalesGY"]:33,["ColorScalesYG"]:34,["IconSetDirectional3Arrows"]:39,["IconSetDirectional3ArrowsGray"]:40,["IconSetDirectional3Triangles"]:57,["IconSetDirectional4ArrowsGray"]:48,["IconSetDirectional4Arrows"]:47,["IconSetDirectional5ArrowsGray"]:53,["IconSetDirectional5Arrows"]:52,["IconSetShapes3TrafficLights1"]:42,["IconSetShapes3TrafficLights2"]:43,["IconSetShapes3Signs"]:44,["IconSetShapes4TrafficLights"]:51,["IconSetShapes4RedToBlack"]:49,["IconSetIndicators3Symbols"]:45,
["IconSetIndicators3Symbols2"]:46,["IconSetIndicators3Flags"]:41,["IconSetRatings3Stars"]:56,["IconSetRatings4Rating"]:50,["IconSetRatings5Quarters"]:55,["IconSetRatings5Rating"]:54,["IconSetRatings5Boxes"]:58,["ClearRulesClearCells"]:62,["ClearRulesClearSheet"]:59}}static get IPj(){return Ab.TZb}}Ab.vLc=null;Ab.TZb=!1;Ab.l9b=Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultRuleCFExperiment",!1)?"HighlightCellsNoBlanks":"HighlightCellsGT";Ab.vxb=!1;Object(t.a)(Ab,"ConditionalFormattingCommandHandler",
null,[233,2])},972:function(t,C,a){t=a(0);class c{constructor(r){this.TAf=r;this.succeeded=!1;this.shb=r?r.shb:0;this.RAi=!1;this.length=this.rXj=0}}Object(t.a)(c,"TrieResult",null,[]);class b{constructor(r,l,u){this.rza=new c(null);this.VKi=r;this.RFb=l;this.Ewf=l+u-1}get result(){return this.rza}c8e(){let r;return this.RFb<=this.Ewf?(r=this.VKi.charAt(this.RFb),++this.RFb,{returnValue:!0,ch:r}):{returnValue:!1,ch:"\x00"}}bNd(r,l,u){r&&(this.rza.RAi=!0,this.rza.rXj=l);this.rza.length=this.RFb;this.rza.succeeded=
!0;this.rza.shb=u;this.RFb!==this.Ewf+1&&(this.rza=new c(this.rza))}}Object(t.a)(b,"LookUpStringVisitor",null,[331]);var f=a(1070);class e{constructor(){this.CDe=this.GBe=this.IBe=this.FBe=this.HBe=this.$2c=this.Z2c=this.b3c=this.Y2c=0}}Object(t.a)(e,"TRIESTATS",null,[]);class d{constructor(){this.symbol=this.eHb=0}}Object(t.a)(d,"TrieSymbol",null,[]);a.d(C,"a",function(){return h});class h{constructor(r,l){this.qI=null;this.Coc=this.$wf=this.Ywf=this.bxf=this.Uwf=this.axf=this.Zwf=this.cxf=this.Vwf=
0;this.Ru=r;if(r.Vn(l,4)!==h.GIa)throw Error.argument("Input does not represent a trie");l+=4;this.Iwf=1===r.Vn(l,4);l+=4;this.MKi=1===r.Vn(l,4);l+=4;this.JKi=r.Vn(l,4);l+=4;if(r.Vn(l,4)){r=l+4;this.qI=this.ijj(r);this.Vwf=l=r+h.J3g;this.cxf=l+=h.B4b*(this.qI.Y2c+(this.qI.Y2c%2?1:0));this.Zwf=l+=h.B4b*(this.qI.b3c+(this.qI.b3c%2?1:0));this.axf=l+=h.B4b*(this.qI.Z2c+(this.qI.Z2c%2?1:0));this.Uwf=l+=h.B4b*(this.qI.$2c+(this.qI.$2c%2?1:0));this.bxf=l+=h.d3c*this.qI.FBe;this.Ywf=l+=h.e3c*this.qI.IBe;
this.$wf=l+=h.e3c*this.qI.GBe;l+=h.e3c*this.qI.HBe;if(l!==r+this.qI.CDe)throw Error.argument("Corrupted trie binary");this.Coc=l}else this.qI=null}dwf(r,l,u,v){r=new b(r,l,u);this.Pqg(r,v);return r.result}U$e(r){if(this.Iwf)if(r)--r;else return"";if(!this.qI)throw Error.argument("Invalid trieID");const l=new f.a;l.Yr=0;this.qVa(l);const u=[];for(;;){if(l.Yr&h.Lqa)if(r)--r;else return Array.add(u,l.gWa),String.fromCharCode.apply(null,u);const v=!!(l.Yr&h.JIc),x=this.O5a(l,!0);if(v||r<x){if(Array.add(u,
l.gWa),!this.qVa(l))throw Error.argument("Invalid trieID");}else if(r-=x,!this.pRb(l))throw Error.argument("Invalid trieID");}}Pqg(r,l){let u=0;this.Iwf&&(r.bNd(this.MKi,this.JKi,0),++u);if(this.qI){var v=new f.a;v.Yr=0;if(this.qVa(v))for(;;){var x=void 0;if(!({ch:x}=r.c8e()).returnValue)break;l&&(x=l(x));x=x.toString().charCodeAt(0);let w=!1;for(;!w;){const m=!!(v.Yr&h.Lqa);if(v.gWa===x){if(w=!0,m&&r.bNd(!!(v.Yr&h.c6d),v.aEc,u),!this.qVa(v))return}else if(u+=this.O5a(v,!0),!this.pRb(v))return;m&&
++u}}}}qVa(r){if(!r.Yr)return this.R0d(r),!0;if(!(r.Yr&h.IIc))return!1;r.Aca=0;r.fn=r.Fxa;this.R0d(r);return!0}pRb(r){if(r.Yr&h.JIc)return!1;this.R0d(r);return!0}O5a(r,l){return r.Yr&h.b6d?r.A4b:r.Yr&h.IIc?!l&&r.Yr&h.JIc?this.jXh(r):1:0}jXh(r){r=h.x5c(r);if(!this.qVa(r))return 0;let l=0;do r.Yr&h.Lqa&&++l,l+=this.O5a(r,!1);while(this.pRb(r));return l}R0d(r){r.Yr||(r.Aca=0,r.fn=this.Coc);var l=this.e9b(this.Vwf,r.fn),u=l.symbol;r.fn+=l.eHb;l=this.Ru.Vn(this.Uwf+h.d3c*u,h.d3c);r.gWa=l&65535;r.Yr=l>>
16;r.Yr&h.b6d&&(r.A4b=this.Tnh(r));r.Yr&h.c6d&&(l=this.e9b(this.cxf,r.fn),u=l.symbol,r.fn+=l.eHb,r.aEc=this.Ru.Vn(this.bxf+4*u,4));r.Yr&h.$ug?(r.Fxa=this.Coc+((this.Ru.ma(r.fn)<<8|this.Ru.ma(r.fn+1))<<8|this.Ru.ma(r.fn+2)),r.fn+=3):r.Yr&h.bvg?(r.Fxa=r.fn,r.Aca=r.Fxa):r.Yr&h.cvg?(l=this.e9b(this.Zwf,r.fn),u=l.symbol,r.fn+=l.eHb,r.Fxa=this.Coc+this.Ru.Vn(this.Ywf+4*u,4)):r.Yr&h.IIc&&(l=this.e9b(this.axf,r.fn),u=l.symbol,r.fn+=l.eHb,r.Aca||(r.Aca=r.fn),r.Aca+=this.Ru.Vn(this.$wf+4*u,4),r.Fxa=r.Aca)}e9b(r,
l){const u=new d;let v=0;for(;;){v+=this.Ru.ma(l);++l;++u.eHb;const x=this.Ru.Vn(r,2);if(v<x)break;u.symbol+=x;v-=x;r+=2;v<<=8}u.symbol+=v;return u}Tnh(r){let l=this.Ru.ma(r.fn);192<=l?(l=(l&63)<<15|(this.Ru.ma(r.fn+1)&127)<<8,l|=this.Ru.ma(r.fn+2),r.fn+=3):128<=l?(l=(l&127)<<8|this.Ru.ma(r.fn+1),r.fn+=2):r.fn+=1;return l}ijj(r){const l=new e;l.Y2c=this.Ru.Vn(r+12,2);l.b3c=this.Ru.Vn(r+14,2);l.Z2c=this.Ru.Vn(r+16,2);l.$2c=this.Ru.Vn(r+18,2);l.HBe=this.Ru.Vn(r+24,4);l.FBe=this.Ru.Vn(r+28,4);l.IBe=
this.Ru.Vn(r+32,4);l.GBe=this.Ru.Vn(r+36,4);l.CDe=this.Ru.Vn(r+40,4);return l}static x5c(r){const l=new f.a;l.gWa=r.gWa;l.Yr=r.Yr;l.A4b=r.A4b;l.fn=r.fn;l.Fxa=r.Fxa;l.Aca=r.Aca;l.aEc=r.aEc;return l}}h.GIa=1654263084;h.J3g=48;h.B4b=2;h.e3c=4;h.d3c=4;h.Lqa=1;h.JIc=2;h.b6d=4;h.c6d=8;h.IIc=16;h.bvg=64;h.cvg=128;h.$ug=256;Object(t.a)(h,"Trie",null,[318])},973:function(t,C,a){a.r(C);t=a(0);a(730);var c=a(752);class b{}b.marketPlace=0;b.catalog=1;b.privateCatalog=10;Object(t.a)(b,"AppsForOfficeStoreType",
null,[]);var f=a(726),e=a(6),d=a(113),h=a(26);class r{constructor(){this.iWc=0}sfj(z,y){this.iWc=window.performance.now();this.KSb(()=>{const A=window.performance.now(),F={},D=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);y.Hue&&(F.callback=B=>{z(B,b.marketPlace,A)},D&&(F.storeType=b.marketPlace),e.AFrameworkApplication.xb.ie(h.a.Scb,2,F));y.Iue&&(F.callback=B=>{z(B,b.privateCatalog,A)},D?F.storeType=b.privateCatalog:e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",
!0)?F.storeType=10:F.storeType=b.privateCatalog,e.AFrameworkApplication.xb.ie(h.a.Scb,2,F))},0,()=>{if(f.TellMeActor.instance.sc)f.TellMeActor.instance.sc.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.iWc)+" ms")})}KSb(z,y=0,A=null){2!==e.AFrameworkApplication.xb.processAction(h.a.Scb,1)?(f.TellMeActor.instance.sc&&f.TellMeActor.instance.sc.aL(c.a.GTg,window.performance.now()-this.iWc),z()):y<r.mNi?e.AFrameworkApplication.ji.Kf(new d.a(2,
1,r.Sbk,()=>{this.KSb(z,y+1,A)})):A&&A()}static get instance(){r.Ma||(r.Ma=new r);return r.Ma}}r.Ma=null;r.mNi=20;r.Sbk=500;Object(t.a)(r,"AddinEntitlementsQuery",null,[]);class l{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Uwd=this.storeType=this.storeId=this.afj=this.iconUrl=null}}Object(t.a)(l,"AddinInfo",null,[]);var u=a(732),v=a(735),x=a(734),w=a(725),m=a(131);a.d(C,"AddinResultsProvider",
function(){return n});class n{constructor(z){this.mUc=[];this.Ta=z;this.XYi=(y,A,F)=>{if(y){const D=y.errorCode;if(f.TellMeActor.instance.sc){const B={};B.StoreType=A;B.ErrorCode=D;B.AddinCount=y.value?y.value.length:0;f.TellMeActor.instance.sc.aL(c.a.aTh,window.performance.now()-F,B)}if(0===D&&y.value){n.PHa=n.PHa||{};y=y.value;for(const B of y)y=new l,y.displayName=B[0],y.id=B[1],y.description=B[2],y.targetType=B[3],y.appVersion=4<B.length?B[4]:"",y.assetId=5<B.length?B[5]:"",y.assetStoreId=6<B.length?
B[6]:"",y.width=7<B.length?B[7]:0,y.height=8<B.length?B[8]:0,y.iconUrl=9<B.length?B[9]:"",y.afj=10<B.length?B[10]:"",y.storeId=11<B.length?B[11]:"",y.storeType=12<B.length?B[12]:"",y.Uwd=this.F1h(y),n.PHa[y.id]=y,0<y.iconUrl.length&&(A="AddinIcon_"+y.id,e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.mBa(A,y.iconUrl):appChrome.addInApi.registerAddinIcon(A,y.iconUrl))}}};r.instance.sfj(this.XYi,this.Ta)}Qw(){return"Add-ins"}tD(){return 0===
this.Ta.zl?0:1===this.Ta.zl?1:2}Pu(z,y,A,F,D=null){A=new x.a(z);D&&!Array.contains(D,27)||w.a.Nz(z)||(D=new v.a(27),D.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.d1h(z.Rd,D),A.Ml(D));y.resultsUpdated(A)}d1h(z,y){if((z=this.Rzj(z))&&0<z.length){let A=0;z.forEach(F=>{if(!(3<++A)){var D="AddinSuggestion"+A,B={};if(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var M="AddinIcon_"+F.id;0>Array.indexOf(this.mUc,M)&&0<
F.iconUrl.length&&this.mBa(M,F.iconUrl);B["default"]=0<=Array.indexOf(this.mUc,M)?M:"AppForOfficeLogo_20"}else B["default"]=0<F.iconUrl.length?"AddinIcon_"+F.id:"AppForOfficeLogo_20";M=[];M.push(appChrome.actions.setControlLabel(D,F.displayName));M.push(appChrome.actions.setControlIconSet(D,B));M.push(appChrome.actions.setCompoundButtonCommandValueId(D,F.id));M.push(appChrome.actions.updateCompoundButtonDescription(D,F.description));e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",
!0)&&(B=window.performance.now(),M.push(appChrome.actions.updateControlEnabledDisabledState(D,!1)),f.TellMeActor.instance.sc&&f.TellMeActor.instance.sc.aL(c.a.dwh,window.performance.now()-B));appChrome.api.dispatch(M);D=new u.a(D,27,void 0,void 0,1);D.f2b=Telemetry.PrivacyRules.GetPrivacyCompliantId(F.id,F.storeType,F.assetId,null,null,F.storeId);y.Xl(D)}})}}mBa(z,y){m.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(z,y),Array.add(this.mUc,z))}Rzj(z){if(!n.PHa)return null;
const y=[],A=n.PHa;for(let D in A){var F=A[D];F&&n.wMi(z,F)&&Array.add(y,F)}return y}F1h(z){return n.oTj(z.displayName)}static wMi(z,y){if(!y.Uwd)return!1;for(const A of z.split(" ")){z=!1;for(const F of y.Uwd)if(F.toLowerCase().startsWith(A.toLowerCase())){z=!0;break}if(!z)return!1}return!0}static oTj(z){const y=[];for(const A of z.split(" ")){z=0;for(let F=0;F<A.length;F++){const D=A.charAt(F);D.toString().toUpperCase()===D.toString()&&F>z&&(Array.add(y,A.substring(z,F)),z=F)}Array.add(y,A.substring(z,
A.length));z&&Array.add(y,A.substring(0,A.length))}return y}}n.PHa=null;Object(t.a)(n,"AddinResultsProvider",null,[202])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.kxta.js.map/5a3b6aa190d19955057c9b573cc64cd0/EwaDSOpt.kxta.js.map
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[49],{1495:function(t,C,a){a.r(C);var c={};a.r(c);a.d(c,"DataRefreshManager",function(){return le});var b=a(520),f=a(60),e=a(0),d=a(14),h=a(92),r=a(89),l=a(425),u=a(86),v=a(52),x=a(272),w=a(246),m=a(16),n=a(777),z=a(76);class y{}y.Oyh="ewa-bix-ltr";y.Pyh="ewa-bix-rtl";y.Syh="ewa-bix-titlebar";y.Qyh="ewa-bix-subtitle";y.Ryh="ewa-bix-title";y.dUe="ewa-bix-close";y.sz="clip16x16";y.Hyh="ewa-bix-body";y.Myh="ewa-bix-drilldetails";
y.Jyh="ewa-bix-DrillButton";y.Nyh="ewa-bix-hover";y.Kyh="ewa-bix-DrillLabel1";y.Lyh="ewa-bix-DrillLabel2";y.Tyh="ewa-bixfl";y.eUe="ewa-bixfl-NoFocus";y.Wyh="ewa-bixfl-ItemSelected";y.Uyh="ewa-bixfl-Icon";y.Vyh="ewa-bixfl-Item";y.Iyh="ewa-bix-calloutBackground";y.Qac="ewa-ipad";Object(e.a)(y,"CssClassNames",null,[]);var A=a(19),F=a(7),D=a(65),B=a(34),M=a(245),R=a(13),P=a(77),E=a(15),H=a(21),G=a(299);class N extends M.a{constructor(Ja,Kb,lc,Dc,Oc,oa){super(Kb);this.Rad=["bix-drill-action-down","bix-drill-action-up",
"bix-drill-action-to"];this.x8b=-1;this.dwa=this.Gvb=this.Fvb=this.Hvb=null;this.od=na=>{const dc=this.domElement;let Rc=na.target;for(;Rc!==dc;){if(Rc.id.startsWith("bix-drill-action")){this.drillTo(this.x8b,Rc.id);P.g(na);break}Rc=Rc.parentNode}};this.JLf=(na,dc)=>{na=-1===this.x8b;const Rc=dc.jii;this.x8b=Rc;let Fd=null;Rc===this.Rze.HierarchyId?(this.n8f(!1),this.drillUp||this.drillDown?(this.o8f(!0),R.DOMElementExtensions.setVisible(this.domElement,!0),Fd=this.Fvb||this.Hvb):R.DOMElementExtensions.setVisible(this.domElement,
!1)):(this.o8f(!1),Fd=this.Gvb,N.lEj(Fd,dc.caption,E.a.instance.ha(1195)),this.n8f(!0),R.DOMElementExtensions.setVisible(this.domElement,!0));na||this.z8f(Fd)};this.$=Ja;this.xx=lc;this.Rze=Dc.Context;Ja=Dc.DrillContext;this.drillUp=Ja.DrillUp;this.drillDown=Ja.DrillDown;this.Bod=Oc;this.KJ=oa;Oc.hSg(this.JLf);this.ihh()}dispose(){this.Bod&&this.Bod.Jqj(this.JLf);this.Rad=this.Hvb=this.Fvb=this.Gvb=this.dwa=this.KJ=this.drillUp=this.drillDown=this.Rze=this.xx=this.KJ=this.Bod=this.$=null;super.dispose()}focus(){this.setFocus(!0)}hasFocus(){var Ja=
R.DOMElementExtensions.Yp(this.domElement);if(!Ja)return!1;Ja=Ja.id;return!!Ja&&Ja.startsWith("bix-drill-action")}onKeyDown(Ja){const Kb=Ja.keyCode;Ja=Ja.shiftKey;if(this.hasFocus()){let lc=!1;13===Kb?(this.drillTo(this.x8b,this.dwa.id),lc=!0):9===Kb&&((lc=this.k0(!Ja))||this.WNe());return lc}return 9===Kb?this.setInitialFocus(!Ja):!1}setFocus(Ja){return this.hasFocus()?this.k0(Ja):this.setInitialFocus(Ja)}ihh(){R.DOMElementExtensions.Yu(this.domElement,F.a.f3b,null,null);let Ja;let Kb;if(this.drillDown){Ja=
E.a.instance.ha(1197);var lc=this.drillDown.Caption;Kb=String.format("{0} ({1})",Ja,lc?B.a.Fla(lc):"");lc=lc?B.a.Jh(lc):"";this.domElement.appendChild(this.R7c("bix-drill-action-down",Kb,"bixdddl_1",Ja,"bixdddl_2",lc))}this.drillUp&&(Ja=E.a.instance.ha(1196),lc=this.drillUp.Caption,Kb=String.format("{0} ({1})",Ja,lc?B.a.Fla(lc):""),lc=lc?B.a.Jh(lc):"",this.domElement.appendChild(this.R7c("bix-drill-action-up",Kb,"bixddul_1",Ja,"bixddul_2",lc)));this.domElement.appendChild(this.R7c("bix-drill-action-to",
"","bixddtl_1",E.a.instance.ha(1195),"bixddtl_2",""));this.Hvb=this.getElementById("bix-drill-action-up");this.Fvb=this.getElementById("bix-drill-action-down");this.Gvb=this.getElementById("bix-drill-action-to");this.Pc.la("click",this.od);this.domElement.setAttribute(F.a.B3,"");R.DOMElementExtensions.setVisible(this.domElement,!1)}R7c(Ja,Kb,lc,Dc,Oc,oa){const na=document.createElement("button");na.id=Ja;na.classList.add(y.Jyh);na.tabIndex=-1;na.title=Kb;na.style.display=G.a.none;na.onkeyup=()=>!1;
na.onkeypress=()=>!1;na.setAttribute(F.a.Kd,F.a.V0c);na.setAttribute(F.a.kH,lc+" "+Oc);Ja=document.createElement("div");Ja.id=lc;Ja.classList.add(y.Kyh);Ja.textContent=Dc;lc=document.createElement("div");lc.id=Oc;lc.classList.add(y.Lyh);lc.textContent=oa;na.appendChild(Ja);na.appendChild(lc);return na}drillTo(Ja,Kb){let lc;switch(Kb){case "bix-drill-action-up":lc=this.drillUp.Id;break;case "bix-drill-action-down":lc=this.drillDown.Id;break;case "bix-drill-action-to":lc=1;break;default:return}H.h(this.$).Xo(!0);
this.KJ.Tah((Dc,Oc,oa)=>{var na=this.xx,dc=this.$.pa.va,Rc=na.confirmationRequiredForDataOps,Fd=lc;na=D.L(dc,na.wx,na.externalSourceIndex,this.xx.bS);na.requiresConfirmation=Rc;na.hierarchyId=Ja;na.levelId=Fd;return D.g(dc,"BixDrill",na,Dc,Oc,oa,null,0)})}k0(Ja){let Kb=0;if(this.dwa)switch(this.dwa.id){case "bix-drill-action-down":Kb=0;break;case "bix-drill-action-up":Kb=1;break;case "bix-drill-action-to":Kb=2}return this.q9f(Ja?Kb+1:Kb-1,Ja)}WNe(){const Ja=this.dwa;Ja&&(Ja.blur(),this.domElement.setAttribute(F.a.B3,
""));this.dwa=null}n8f(Ja){this.Gvb&&R.DOMElementExtensions.setVisible(this.Gvb,Ja)}o8f(Ja){this.Hvb&&R.DOMElementExtensions.setVisible(this.Hvb,Ja);this.Fvb&&R.DOMElementExtensions.setVisible(this.Fvb,Ja)}z8f(Ja){Ja!==this.dwa&&this.WNe();if(!Ja)return!1;Ja.tabIndex=0;R.DOMElementExtensions.setFocus(Ja);this.domElement.setAttribute(F.a.B3,Ja.id);this.dwa=Ja;return!0}setInitialFocus(Ja){return this.q9f(Ja?0:this.Rad.length-1,Ja)}q9f(Ja,Kb){const lc=this.Rad;for(;0<=Ja&&Ja<lc.length;){const Dc=R.DOMElementExtensions.getElementById(this.domElement,
lc[Ja]);if(Dc&&R.DOMElementExtensions.isVisible(Dc))return this.z8f(Dc);Ja=Kb?Ja+1:Ja-1}return!1}static lEj(Ja,Kb,lc){lc=String.format("{0} ({1})",lc,Kb);Ja.setAttribute("title",lc);Ja.lastChild.innerText=Kb}}Object(e.a)(N,"BixDrillDetails",M.a,[]);var I=a(229),O=a(29),U=a(37),ca=a(217),Q=a(54),Y=a(139);const la=y.Vyh,ea=y.Wyh;class ha{constructor(Ja,Kb,lc,Dc,Oc){this._element=null;this.aM=this.visible=!0;this.fieldListSelector=Ja;this.MKc=Kb.Name||"";this.clientId=Kb.ClientId;this.EFa=Kb.IsCollapsible;
this.parentId=Kb.ClientParentId;this.VFg=Kb.PivotCacheIndex;this.type=Kb.TypeTag;this.qpg=Kb.UserRank;this.Vii=lc;this.rMe=Dc;this.Dmh=Oc;this.fieldListSelector.fPg(this.clientId,this);this.children=[];Kb.Children.forEach(oa=>{this.children.push(new ha(Ja,oa,lc,Dc,Oc))})}get caption(){return this.MKc}get element(){return this._element||(this._element=this.fieldListSelector.getElementById(ha.ucb+this.clientId))}get Fgi(){return-1!==this.parentId}get isCollapsed(){return this.aM}get isCollapsible(){return this.EFa}get isVisible(){return this.visible}get kQf(){return this.VFg}dispose(){this.children&&
(h.a.wc(this.children),this.children=null);this._element=null}MGe(){for(const Ja of this.children)Ja.visible=!1,Ja.EFa&&(Ja.aM=!0,Ja.v$f(),0<Ja.children.length&&Ja.MGe())}Fwe(Ja,Kb){this.visible=!Ja;var lc=11*Ja,Dc=document.createElement("div");if(this.EFa){this.aM=!0;Dc.id=this.Bwa(ha.yRf);Dc.classList.add(y.Uyh);Dc.setAttribute(Y.a.style,this.S6e(lc+4));lc=document.createElement("div");lc.classList.add(A.a.sz);var Oc=document.createElement("img");Oc.id=this.Bwa(ha.rJd);Oc.classList.add(this.rMe);
Oc.setAttribute(F.a.Kd,F.a.xr);Oc.src=Q.a.mf(9);lc.appendChild(Oc);Dc.appendChild(lc)}else Dc.setAttribute(Y.a.style,this.S6e(lc+23));lc=document.createElement("span");lc.id=this.Bwa(ha.ARf);lc.textContent=this.MKc;Oc=document.createElement("div");Oc.id=this.Bwa(ha.ucb);Oc.classList.add(la);Oc.tabIndex=-1;Oc.title=this.MKc;Oc.setAttribute(F.a.Kd,F.a.i3b);Oc.setAttribute(F.a.vM,this.Bwa(ha.ARf));Oc.setAttribute(F.a.oaa,"false");Oc.setAttribute(F.a.Xxe,Ja+1);this.EFa&&(Oc.setAttribute(F.a.lU,"false"),
Oc.setAttribute(F.a.h3b,this.Bwa(ha.zRf)));const oa=document.createElement("table");oa.setAttribute(Y.a.cellSpacing,0);oa.setAttribute(Y.a.cellPadding,0);oa.setAttribute(F.a.Kd,F.a.xr);const na=document.createElement("tr"),dc=document.createElement("td");dc.setAttribute(Y.a.style,"width: 8px");dc.appendChild(Dc);Dc=document.createElement("td");Dc.appendChild(lc);na.appendChild(dc);na.appendChild(Dc);oa.appendChild(na);Oc.appendChild(oa);Kb.appendChild(Oc);if(this.EFa){++Ja;const Rc=document.createElement("div");
Rc.id=this.Bwa(ha.zRf);Rc.setAttribute(F.a.Kd,F.a.hIa);Rc.style.display=F.a.fqc;this.children.forEach(Fd=>{Fd.Fwe(Ja,Rc)});Kb.appendChild(Rc)}}q9b(){this.element.blur();this.element.tabIndex=-1}bJh(){this.children.forEach(Ja=>{Ja.visible=!0})}d5e(Ja,Kb){const lc=this.children;for(const Dc of lc)if(!Dc.EFa&&5===Dc.type&&Dc.qpg>Kb&&(Ja=Dc,Kb=Dc.qpg,3===Kb))return{returnValue:Ja,hBd:Kb};for(const Dc of lc)if(Dc.EFa&&({hBd:Kb,returnValue:Ja}=Dc.d5e(Ja,Kb),3===Kb))break;return{returnValue:Ja,hBd:Kb}}o7h(){let Ja=
this;for(;-1!==Ja.parentId;)Ja=this.fieldListSelector.Tjd(Ja.parentId);return Ja}Kjc(Ja){let Kb=this;for(;-1!==Kb.parentId;){if(Ja.clientId===Kb.parentId)return!0;Kb=this.fieldListSelector.Tjd(Kb.parentId)}return!1}setFocus(){this.element.tabIndex=0;R.DOMElementExtensions.setFocus(this.element)}v$f(){const Ja=R.DOMElementExtensions.getElementById(this.element,this.Bwa(ha.rJd));if(Ja){var Kb=this.element.nextSibling;R.DOMElementExtensions.aDa(Ja,this.aM,this.rMe,this.Dmh);this.element.setAttribute(F.a.lU,
this.aM?F.a.vr:F.a.Dk);R.DOMElementExtensions.setVisible(Kb,!this.aM)}}BIj(){const Ja=this.fieldListSelector.domElement.querySelectorAll(`.${ea}`);for(let Kb=0;Kb<Ja.length;Kb++){const lc=Ja[Kb];lc.classList.remove(ea);lc.setAttribute(F.a.oaa,"false")}this.element.classList.add(ea);this._element.setAttribute(F.a.oaa,"true")}aRb(){(this.aM=!this.aM)?this.MGe():this.bJh();this.v$f()}Bwa(Ja){return Ja+this.clientId}S6e(Ja){return String.format(this.Vii,Ja.toString())}}ha.yRf="bixflec_";ha.rJd="bixfleci_";
ha.ucb="bixfli_";ha.ARf="bixflil_";ha.zRf="bixflg_";Object(e.a)(ha,"BixFieldListItem",null,[2]);class X extends Sys.EventArgs{constructor(Ja,Kb){super();this.jii=Ja;this.caption=Kb}}Object(e.a)(X,"BixHierarchySelectionChangedEventArgs",Sys.EventArgs,[]);var T=a(12);class ua extends M.a{constructor(Ja,Kb,lc,Dc,Oc){super(Kb);this.Q5c=0;this.wza=new U.a(!1);this.tzc=-1;this.mJ=this.WM=this.e6f=null;this.od=na=>{na.Vb&&this.Uuc(na.Vb);return!0};this.ix=na=>{na.button===Sys.UI.MouseButton.leftButton&&
na.target&&(this.Uuc(na.target),P.g(na))};this.onDoubleClick=na=>{if(na.button===Sys.UI.MouseButton.leftButton&&na.target){var dc;0!==({n0b:dc}=this.H_e(na.target)).returnValue&&(P.g(na),(na=this.a7e(dc))&&na.isCollapsible&&this.aRb(na))}};(this.touchMode=Oc)?I.a.instance.ta(m.a.click,this.domElement,this.od):(this.Pc.la("mousedown",this.ix),this.Pc.la("dblclick",this.onDoubleClick));this.Vdg=!O.a.rzi&&!Oc;let oa;Ja.isChromeRtl?(oa="padding-right:{0}px;",this.Q5c=39):(oa="padding-left:{0}px;",this.Q5c=
37);Oc=new ca.a(Dc.ExcludeHierarchies);Oc.paa.sort((na,dc)=>na-dc);Ja=-1;Kb=null;if(lc=({MEb:Ja,qe:Kb}=this.vhf(lc.FieldListItems,Oc,Ja,Kb,Dc.Context)).returnValue)1===lc.length&&(lc=[...lc[0].Children],lc.forEach(na=>{na.ClientParentId=-1})),lc.length&&(this.fieldListItems=[],lc.forEach(na=>{this.fieldListItems.push(new ha(this,na,oa,A.a.tEh,A.a.uEh))}),Kb||(Kb=ua.WLh(lc,Dc.Context.DimensionCaption)||lc[0]),this.qe=this.Tjd(Kb.ClientId),this.t8c())}hSg(Ja){this.get_events().addHandler("SelectionChanged",
Ja)}Jqj(Ja){this.get_events().removeHandler("SelectionChanged",Ja)}get Gzi(){return!!this.fieldListItems}dispose(){this.touchMode&&(I.a.instance.Ba(m.a.click,this.domElement,this.od),this.touchMode=!1);this.mJ=null;this.fieldListItems&&(h.a.wc(this.fieldListItems),this.fieldListItems=null);this.wza=null;super.dispose()}focus(){this.setFocus(!0)}fPg(Ja,Kb){this.wza.add(Ja.toString(),Kb)}Tjd(Ja){Ja=Ja.toString();return this.wza.nb(Ja)?this.wza.getItem(Ja):null}hasFocus(){var Ja=R.DOMElementExtensions.Yp(this.mJ);
return Ja?(Ja=Ja.id)&&Ja.startsWith(ha.ucb)&&this.WM?!0:!1:!1}onKeyDown(Ja){Ja=Ja.keyCode;if(this.hasFocus()){var Kb=!1;38===Ja||40===Ja?(this.k0(40===Ja),Kb=!0):37===Ja||39===Ja?(Ja=Ja===this.Q5c,Kb=this.WM,Kb.isCollapsible&&Kb.isCollapsed!==Ja?this.aRb(Kb):Ja&&Kb.Fgi&&this.k0(!1),Kb=!0):13===Ja||32===Ja?((Ja=this.WM)&&this.select(Ja),Kb=!0):9===Ja&&this.XNe(!0);return Kb}return 9===Ja?this.WM?this.uOb(this.WM):this.setInitialFocus(!0):!1}fDj(){this.mJ.setAttribute(F.a.Uxe,"bix-drilldetails")}setFocus(Ja){return this.mJ.firstChild?
this.hasFocus()?this.k0(Ja):this.WM?this.uOb(this.WM):this.setInitialFocus(Ja):!1}start(){this.qe&&(this.select(this.qe.o7h()),this.WM&&this.scroll(this.WM,!0))}t8c(){this.mJ=this.domElement;this.fieldListItems.forEach(Ja=>{Ja.Fwe(0,this.mJ)});R.DOMElementExtensions.Yu(this.mJ,F.a.j3b,null,null,null);this.mJ.setAttribute(F.a.wu,E.a.instance.ha(1198));this.mJ.classList.add(A.a.ms);this.mJ.style.position="relative"}v1h(Ja){for(;Ja&&Ja!==this.mJ;){const Kb=Ja.id;if(Kb&&Kb.startsWith(ha.ucb))return Ja;
Ja=Ja.parentNode}return null}vhf(Ja,Kb,lc,Dc,Oc){const oa=lc;if(!Ja||!Ja.length)return{returnValue:null,MEb:lc,qe:Dc};let na=0;for(let dc=0,Rc=Ja.length;dc<Rc;dc++){const Fd=Ja[dc];if(ua.Yvi(Kb,Fd))Ja[dc]=null,++na;else{Fd.ClientParentId=oa;Fd.ClientId=++lc;if(Fd.IsCollapsible&&(Fd.Children=({MEb:lc,qe:Dc}=this.vhf(Fd.Children,Kb,lc,Dc,Oc)).returnValue,!Fd.Children)){Ja[dc]=null;++na;continue}5!==Fd.TypeTag&&3!==Fd.TypeTag||Fd.PivotCacheIndex!==Oc.HierarchyId||(Fd.UserRank=3,Dc=Fd)}}return na?na===
Ja.length?{returnValue:null,MEb:lc,qe:Dc}:{returnValue:ua.noj(Ja),MEb:lc,qe:Dc}:{returnValue:Ja,MEb:lc,qe:Dc}}XNe(Ja){const Kb=this.WM;Kb&&(Kb.q9b(),this.mJ.setAttribute(F.a.B3,""));this.q9b();Ja||(this.WM=null)}q9b(){this.Vdg&&this.mJ.classList.add(y.eUe)}k0(Ja){let Kb=this.WM;if(!Kb)return this.setInitialFocus(Ja);const lc=this.wza.values,Dc=lc.length;let Oc=Array.indexOf(lc,Kb);for(Oc=Ja?++Oc:--Oc;0<=Oc&&Oc<Dc;){Kb=lc[Oc];if(Kb.isVisible)return this.uOb(Kb),this.scroll(Kb,Ja),!0;Oc=Ja?++Oc:--Oc}return!1}scroll(Ja,
Kb){var lc=Ja.element;Ja=lc.offsetHeight;lc=lc.offsetTop;const Dc=this.mJ,Oc=Dc.scrollTop,oa=(Math.floor(Dc.clientHeight/Ja)-3)*Ja;let na=Dc.scrollTop;Kb?lc>Oc+Ja+oa&&(na=lc-(Ja+oa)):lc<Oc+Ja&&(na=lc-Ja);Dc.scrollTop=na}setInitialFocus(Ja){const Kb=this.wza.count;let lc=Ja?0:Kb-1;for(;0<=lc&&lc<Kb;){const Dc=this.wza.mg(lc);if(Dc.isVisible)return this.uOb(Dc),this.scroll(Dc,!0),!0;lc=Ja?++lc:--lc}return!1}uOb(Ja){this.WM&&Ja!==this.WM&&this.XNe(!1);if(!Ja)return!1;this.mJ.setAttribute(F.a.B3,Ja.element.id);
this.WM=Ja;-1!==this.tzc&&(Ja.setFocus(),this.Vdg&&this.mJ.classList.remove(y.eUe));return!0}H_e(Ja){for(;Ja&&Ja!==this.mJ;){const Kb=Ja.id;if(Kb.startsWith(ha.ucb))return{returnValue:1,n0b:Ja};if(Kb.startsWith(ha.yRf)||Kb.startsWith(ha.rJd))return{returnValue:2,n0b:Ja};Ja=Ja.parentNode}return{returnValue:0,n0b:null}}a7e(Ja){if(!Ja.id||!Ja.id.startsWith(ha.ucb)&&(Ja=this.v1h(Ja),!Ja))return null;Ja=Ja.id.split("_")[1];return U.a.Mc(this.wza.Qu,Ja)}Uuc(Ja){var Kb;Ja=({n0b:Kb}=this.H_e(Ja)).returnValue;
if(0!==Ja&&(Kb=this.a7e(Kb)))switch(Ja){case 2:this.aRb(Kb);break;case 1:this.select(Kb)}}select(Ja){if(Ja){Ja.BIj();this.uOb(Ja);if(Ja.isCollapsible){let Kb=-1;({hBd:Kb,returnValue:Ja}=Ja.d5e(null,Kb));if(!Ja)return}this.qe=Ja;this.tzc!==Ja.kQf&&(this.tzc=Ja.kQf,this.e6f=Ja.caption,this.raiseEvent("SelectionChanged",new X(this.tzc,this.e6f)),this.hasFocus()||this.q9b())}}aRb(Ja){Ja.aRb();Ja.isCollapsed&&this.qe&&this.qe.Kjc(Ja)&&this.select(Ja);this.scroll(Ja,!Ja.isCollapsed)}static WLh(Ja,Kb){for(const lc of Ja)if(11===
lc.TypeTag&&lc.Name===Kb)return lc;return null}static Yvi(Ja,Kb){switch(Kb.TypeTag){case 5:case 3:break;default:return!1}return 0<=T.HelperMethods.Ux(Ja,0,Ja.Nwa(),Kb.PivotCacheIndex,(lc,Dc)=>lc-Dc)}static noj(Ja){let Kb=null;for(let lc=0;lc<Ja.length;lc++)Ja[lc]&&(Kb||(Kb=[]),Kb.push(Ja[lc]));return Kb}}Object(e.a)(ua,"BixFieldListSelector",M.a,[864]);var Ha=a(53),Ca=a(39),Ga=a(219),sa=a(51),bb=a(47),Ba=a(258),qa=a(293),pa=a(75),ya=a(95),za=a(109),cb=a(157),Pa=a(41),nb=a(70);class Ma extends n.a{constructor(Ja,
Kb,lc,Dc){super(Ja,E.a.instance.ha(1192),!0,4);this.fieldListSelector=this.oU=this.wPa=this.PC=this.xLc=this.Cba=null;this.qde=!1;this.cZi=(oa,na)=>{if(this.domElement&&(this.wPa.JUa(),!Ba.a(oa))){const dc=oa.Result;dc&&this.uUj(dc,na);super.s0(oa,null,"")}};this.OPj=()=>{this.Crb.textContent=E.a.instance.ha(1194);const oa=this.Ffa.querySelector("."+y.dUe);oa.tabIndex=-1;R.DOMElementExtensions.setFocus(oa)};this.Nab=()=>{this.close(1);return!0};this.domElement.id=Ja.domElement.id+"_BIExploreCallout";
this.xx=Kb;this.targetElement=lc;this.x2f=!1;this.domElement.classList.remove(this.rtl?z.a.Ocd:z.a.Ncd);this.domElement.classList.remove(A.a.Ho);this.domElement.classList.add(this.rtl?y.Pyh:y.Oyh);(this.touchMode=Dc)||this.domElement.classList.add(y.Nyh);this.Ffa.className=y.Syh;this.Ffa.style.backgroundImage="";this.Zpa.className=y.Ryh;this.uz.parentNode.className=y.dUe;Ja=this.dc;Ja.className="";Kb=document.createElement("div");Kb.id="bix-subtitle";Kb.classList.add(y.Qyh);Kb.textContent=ya.a.rf(this.xx.Uii);
lc=document.createElement("div");lc.classList.add(y.Hyh);Dc=document.createElement("div");Dc.id="bix-fieldlistselector";Dc.classList.add(y.Tyh);const Oc=document.createElement("div");Oc.id="bix-drilldetails";Oc.classList.add(y.Myh);lc.appendChild(Dc);lc.appendChild(Oc);Ja.appendChild(Kb);Ja.appendChild(lc);this.Crb=Ja.lastChild;this.jhc()}get uc(){return"BIExploreCallout"}get yri(){return this.qde}get oJa(){return 6}get gC(){return 561}Lwi(Ja){Ja=document.getElementById(Ja);return R.DOMElementExtensions.isVisible(Ja)?
(this.Cba.setFocus(!0),!0):!1}Tah(Ja){this.xLc=Ja;H.h(this.$).Xo(!0);this.qde=!0;this.close(2)}dispose(){h.a.wc([this.PC,this.wPa,this.Cba,this.fieldListSelector]);this.xx=this.Cba=this.fieldListSelector=this.wPa=this.PC=null;this.mwc();this.xLc=this.targetElement=this.Crb=null;super.dispose()}takeFocus(){this.setFocus()}close(Ja){this.mwc();super.close(Ja)}qg(Ja=!1){const Kb=Object(nb.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(za.d)(cb.a.resolve(Pa.X,{rb:0})):Ha.GetServiceTaskFactory.Sa(this.$.da,
12,477,0);Ca.TaskExtensions.za(Kb,lc=>{this.x2f||(this.wPa=lc.result.qub(this.dc,500,null,null,736),this.wPa.DUa())},this.$.ka);return Ca.TaskExtensions.ts(Ca.TaskExtensions.za(Object(nb.b)("OfficeVSO:7662199_MigrateCalloutDialogBehaviorService")?Object(za.d)(cb.a.resolve(Pa.h,{rb:0})):Ha.GetServiceTaskFactory.create(this.$.da,84,this.ka,0),lc=>{this.PC=lc.result;this.PC.init(this.domElement,this.targetElement,document.body,this.$.na.displayRtl);this.PC.S6c=8;this.PC.k0c=!0;this.PC.rcb=Ma.ybi();this.WYc();
this.PC.vq()},this.ka,3),()=>Ga.a.prototype.qg.call(this,Ja),this.ka,3,pa.a.current)}oH(){return this.xLc}i1a(){return(Ja,Kb,lc)=>{var Dc=this.$.pa.va;Ja=this.L5a(Ja);Kb=this.VLa(Kb);const Oc=D.L(Dc,this.xx.wx,this.xx.externalSourceIndex,this.xx.bS);return D.g(Dc,"GetBixAnalysis",Oc,Ja,Kb,lc,null,4)}}onShow(){this.PC.nRd();super.onShow()}s0(Ja){const Kb=Ja.Result;if(Ja.Errors&&!Ja.Errors.length&&Kb&&-1===Kb.Context.HierarchyId)this.x2f=!0,this.wPa&&this.wPa.JUa(),sa.a.instance.create(this.OPj,1,bb.a.b_g,
!0,!0),super.s0(Ja,null,"");else{var lc=Dc=>{Dc.oA=0;this.CNa(169,(Oc,oa,na)=>{var dc=this.$.pa.va,Rc=Dc.BH,Fd=Dc.eLb,de=Dc.oA;Oc=qa.b(Oc,this.cZi);const ne=D.L(dc,Dc.wx,Dc.externalSourceIndex,Dc.vjh());ne.type=4;ne.version=Rc;ne.relatedGroup=Fd;ne.selectedTab=de;return D.g(dc,"GetPivotFieldListData",ne,Oc,oa,na,Kb,4)},16)};Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.create(this.$.da,110,this.ka,0),Dc=>{lc(Dc.result)},this.ka,3)}}onKeyDown(Ja){let Kb=this.k3e();if(Ja.altKey&&85===Ja.keyCode)this.close(1),
P.g(Ja);else if(117===Ja.keyCode&&Ja.ctrlKey)this.close(1),P.g(Ja);else if(0===Kb)if(13===Ja.keyCode)this.close(1);else super.onKeyDown(Ja);else{let lc=!1;for(let Dc=0;3>Dc&&!lc;Dc++)2===Kb?(lc=this.fieldListSelector.onKeyDown(Ja))||(Kb=1):1===Kb&&((lc=this.Cba.onKeyDown(Ja))||(Kb=2));if(lc)P.g(Ja);else super.onKeyDown(Ja)}}setFocus(){(this.Cba||this.fieldListSelector)&&this.NXg(this.k3e())}NXg(Ja){let Kb=!1;for(let lc=0;2>lc&&!Kb;lc++)1===Ja&&this.Cba?(Kb=this.Cba.setFocus(!0))||(Ja=2):2===Ja&&this.fieldListSelector&&
((Kb=this.fieldListSelector.setFocus(!0))||(Ja=1))}k3e(){if(!this.fieldListSelector||!this.Cba)return 0;const Ja=this.fieldListSelector.hasFocus(),Kb=this.Cba.hasFocus();return!Ja&&!Kb||Kb?1:2}uUj(Ja,Kb){let lc=this.getElementById("bix-fieldlistselector");this.fieldListSelector=new ua(this.$,lc,Ja,Kb,this.touchMode);this.fieldListSelector.Gzi?(this.Crb.setAttribute(F.a.a3b,"true"),lc=this.getElementById("bix-drilldetails"),this.Cba=new N(this.$,lc,this.xx,Kb,this.fieldListSelector,this),this.fieldListSelector.fDj(),
this.fieldListSelector.start(),this.setFocus(),this.Crb.setAttribute(F.a.a3b,"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=null,this.Crb.textContent=E.a.instance.ha(1194))}WYc(){const Ja=this.oU=document.createElement("div");Ja.classList.add(y.Iyh);w.a.instance.ta(m.a.pointerDown,Ja,this.Nab);this.domElement.ownerDocument.body.appendChild(Ja)}mwc(){this.oU&&(w.a.instance.Ba(m.a.pointerDown,this.oU,this.Nab),R.DOMElementExtensions.Hf(this.oU),this.oU=null)}static ybi(){return Ma.rcb||
(Ma.rcb=[0,1,4,5])}}Ma.rcb=null;Object(e.a)(Ma,"BIExploreCallout",n.a,[838,304]);class Oa extends u.a{constructor(Ja,Kb,lc){super();this.$=Ja;this.sia=lc.c8b(Ja,null,Kb,A.a.Yac,Q.a.mf(9),E.a.instance.ha(1193),"BIXPointerDown")}get Gz(){return this.sia.Gz}get A5b(){return this.sia.A5b}dispose(){this.sia.dispose();this.$=null;super.dispose()}getButton(Ja){return this.sia.getButton(Ja)}QPj(Ja,Kb,lc,Dc){this.sia.to(Ja+this.A5b,Kb+this.A5b,lc,Dc)}RPj(){var Ja=H.h(this.$).ga.qa.activeCell;const Kb=H.h(this.$).lb.yi(Ja);
(Ja=H.h(this.$).Mg(Ja,Kb))&&0<=Ja.x&&0<=Ja.y?this.to(Ja.bottomRight.x+this.Gz,Ja.bottomRight.y+this.Gz,H.h(this.$).rtl,Kb):this.hide()}to(Ja,Kb,lc,Dc){this.sia.to(Ja,Kb,lc,Dc)}hide(){this.sia.hide()}domElement(Ja){return this.sia.domElement(Ja)}k4a(Ja){this.sia.k4a(Ja)}}Object(e.a)(Oa,"BIExploreLaunchButton",u.a,[]);var La=a(45);class ra{constructor(Ja){this.Kjb=!1;this.gFa=0;this.Nsa=this.ETc=this.DTc=this.nlb=null;this.$=Ja;this.reset()}get confirmationRequiredForDataOps(){return this.Kjb}get externalSourceIndex(){return this.gFa}get Uii(){return this.nlb}get D_(){return!!this.bS}get Wkf(){return!!this.wx}get bS(){return this.DTc}get pivotTableName(){return this.ETc}get wx(){return this.Nsa}reset(){this.nlb=
"";this.Nsa=this.ETc=this.DTc=null}KGj(Ja,Kb){this.reset();this.Kjb=Kb.confirmationRequiredForDataOps;this.gFa=Kb.externalSourceIndex;this.ETc=Kb.pivotTableName;this.Nsa=La.o(Ja,this.$);Ja.xd(Kb.Ns)||Ja.xd(Kb.Av)?(Kb=H.h(this.$).Ob(Ja),this.nlb=B.a.Jh(Kb.text)):(Ja=Ja.top-Kb.top,Kb.dRd&&Kb.dRd.length>Ja&&(this.nlb=Kb.dRd[Ja]))}ADj(Ja,Kb,lc){this.reset();this.gFa=Kb.ExternalSourceIndex;this.Kjb=!!(Kb.Attributes&64);this.nlb=B.a.Jh(lc.ValueString);this.DTc={};this.bS.ChartId=Ja;this.bS.AnchorValue2=
-1;switch(lc.Type){case 1:case 2:0<=lc.CategoryIndex?(this.bS.AnchorType=2,this.bS.AnchorValue1=lc.CategoryIndex):(this.bS.AnchorType=1,this.bS.AnchorValue1=lc.SeriesIndex);break;default:0>lc.CategoryIndex&&0<=lc.SeriesIndex?(this.bS.AnchorType=1,this.bS.AnchorValue1=lc.SeriesIndex):(this.bS.AnchorType=3,this.bS.AnchorValue1=lc.SeriesIndex,this.bS.AnchorValue2=lc.CategoryIndex)}this.Nsa={};this.$.gk(this.wx);this.wx.FirstRow=-1;this.wx.FirstColumn=-1}}Object(e.a)(ra,"BixSelectionContext",null,[]);
var V=a(815),ma=a(230),W=a(73),aa=a(327),ia=a(259),ka=a(733),Xa=a(465),sb=a(5),ib=a(525),Ub=a(1),hc=a(248);class yb extends u.a{constructor(Ja,Kb,lc){super();this.nNe=this.callout=this.gridView=null;this.sWi=Dc=>{if(Dc.isLoaded){this.state=1;Dc=this.$;const Oc=H.h(Dc);this.zYg(Oc);Dc.wj(this.Dc);Dc.GC(this.Kk);Oc.vv(this.UR);ib.a(Dc).vv(this.BHb);Dc.userOperationManager.tr(this.vNf);aa.a.N$(1529658657,sb.a.Dw,0,1);Dc.Ia.p3(this)}else this.dispose()};this.mAa=(Dc,Oc)=>{Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachSelectionBIExploreManagerListener",
!1)?(this.Uw(),this.nNe(Dc,Oc)):this.HLf(Dc,Oc)};this.HLf=(Dc,Oc)=>{this.allow&&0===Oc.J5&&(Dc=this.gridView.ga.Se,1===Dc?(this.B5c(),this.DX()):2!==Dc||this.xx.D_||(this.xx.reset(),this.Uw()))};this.Ki=()=>{this.Uw()};this.Dc=()=>{this.Uw()};this.od=(Dc,Oc)=>{this.callout||this.showCallout(3===Dc.Cb,Oc)};this.AEd=()=>{this.callout.rBa(this.AEd);this.callout=null;this.Kh.hide()};this.Kk=()=>{this.callout?this.Uw():this.R8a()&&this.Kh.hide()};this.BHb=()=>{3===this.state&&(this.state=1)};this.UR=()=>
{3===this.state&&this.iSe()};this.vNf=(Dc,Oc)=>{(Dc=Oc.Of?Oc.Of.operation:null)&&Dc.flags&4&&(this.allow&&0===Oc.er?(this.state=3,this.Uw()):3===this.state&&1===Oc.er&&(Oc=Dc.Cd?Dc.Cd.Errors:null)&&0<Oc.length&&this.iSe())};this.iSe=()=>{this.state=1;this.DX()};this.$=Ja;this.state=2;this.xx=new ra(Ja);this.Kh=new Oa(Ja,this.od,Kb);x.a(this.$).ti(this);b.a.Tgf(Ja.domElement.ownerDocument,Q.a.current.io(96),this.sWi);Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachSelectionBIExploreManagerListener",
!1)&&(this.nNe=hc.a(this.HLf,100));this.Ev=lc}get rc(){return this.callout?this.callout.domElement:null}get Qf(){return!!this.callout}get je(){return ia.a.e2c}get m7e(){d.ULS.shipAssertTag(537170304,8,!H.h(this.$).lb.mj,"GetLaunchMonocleButton is not supported in freeze pane");return Object(r.a)(Sys.UI.Control,this.Kh.getButton(1))}get L7e(){return this.callout}get allow(){return this.$.se.get(6)&&1===this.state&&this.$.nc.z3(135200)}JFe(){this.showCallout(!1)}dispose(){this.gridView&&(this.gridView.Jb.RLb(this.mAa),
this.gridView.hc&&this.gridView.hc.sn(this.Ki));if(this.$){const Ja=this.$;Ja.userOperationManager.ro(this.vNf);Ja.ll(this.Dc);Ja.gG(this.Kk);H.h(Ja).My(this.UR);ib.a(Ja).My(this.BHb)}h.a.Ja(this.Kh);this.xx=this.$=this.gridView=this.callout=this.Kh=null;super.dispose()}Oc(Ja,Kb){if(1529658657===Kb&&(8===Ja||!this.xx.Wkf))return!0;1247109494!==Kb&&-498523270!==Kb||this.Uw();return!1}executeCommand(Ja,Kb){this.callout?this.Uw():(this.scrollIntoView(),this.showCallout(3===Kb.method));return f.Task.Ua(!0)}Ac(Ja,
Kb){return 1529658657===Kb.command}Vc(){return!1}Uw(){this.B5c();this.Kh.hide()}pg(Ja,Kb){this.callout&&!Kb&&this.callout.takeFocus();return!Kb}Gh(Ja){return R.DOMElementExtensions.Mf(this.rc,Ja)}Bj(){}hk(){}XSf(Ja,Kb,lc,Dc,Oc){this.xx.reset();if(this.allow&&!W.e(this.$.na))if(lc&&lc.Attributes&512&&Dc&&Kb){const oa=this.$.kM;this.B5c();this.xx.ADj(Kb,lc,Dc);this.R8a()?(Kb=ib.a(this.$).domElement,lc=R.DOMElementExtensions.getLocation(Kb),Dc=Math.abs(Kb.scrollLeft),this.$.isChromeRtl&&(Sys.Browser.agent===
Sys.Browser.Safari&&(Dc=Kb.scrollWidth-Kb.offsetWidth-Dc),Dc*=-1),Ja=new v.a(Ja.x-lc.x+Dc,Ja.y-lc.y+Kb.scrollTop),oa&&(Ja.x=Kb.offsetWidth-Ja.x)):(Kb=this.gridView.hg(Oc).view.Ai,Ja=ka.a.fv(Kb,this.gridView.hg(Oc).domElement,new Sys.UI.Point(Math.round(Ja.x),Math.round(Ja.y)),oa));this.Kh.QPj(Ja.x,Ja.y,oa,Oc)}else this.Uw()}zYg(Ja){Ja&&(this.gridView=Ja,this.gridView.Jb.dqb(this.mAa),this.gridView.hc.An(this.Ki))}DX(){this.VMj()?this.Kh.RPj():this.Kh.hide()}VMj(){this.xx.reset();if(!this.allow||this.gridView.ga.Ra.oc)return!1;
const Ja=Ub.EwaSettings.Xw()?this.Ev.r5():Xa.a(this.$).r5();if(Object(l.a)(ma.PivotTableRange,Ja)&&Ja.supportsBIExplore){const Dc=this.gridView.ga.qa.activeCell,Oc=this.gridView.Ob(Dc);if(Dc&&Oc&&this.gridView.ga.qa.Q_){var Kb=Dc.left-Ja.left,lc=Dc.top-Ja.top;if(!(Ja.hah&1<<Kb||Ja.gxj&1<<lc||Ja.bah&1<<Kb||Ja.bxj&1<<lc||Oc.hasAutoFilter)&&(Kb=Dc.xd(Ja.Ns)||Dc.xd(Ja.Av),lc=!1,Ja.Ns&&Ja.Av?lc=Dc.top<Ja.Ns.top&&Dc.left<Ja.Av.left||Dc.top<Ja.Av.top:Ja.Av&&(lc=Dc.top<Ja.Av.top),!Kb&&!lc&&0<Oc.text.length||
Kb&&(0<Oc.text.length||Oc.wya||Oc.$8a)))return this.xx.KGj(Dc,Ja),!0}}return!1}showCallout(Ja,Kb=1){const lc=Dc=>{Dc&&this.xx.Wkf&&(this.callout=new Ma(this.$,this.xx,this.Kh.domElement(Kb),Ja),this.callout.initialize(),this.Kh.k4a(Kb),this.callout.oM(this.AEd),this.callout.qg());this.Kh.getButton(1).meb()};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Dc=>{Dc.ak(this.xx.confirmationRequiredForDataOps,lc)}):Xa.a(this.$).ak(this.xx.confirmationRequiredForDataOps,
lc)}B5c(){this.Kh.getButton(1).meb();this.callout&&!this.callout.yri&&(this.callout.rBa(this.AEd),this.callout.zv(),this.callout=null)}scrollIntoView(){var Ja=this.gridView.ga;if(1===Ja.Se){Ja=Ja.qa.activeCell;const Kb=this.gridView.view.visibleArea,lc=this.gridView.Mg(Ja);Kb&&lc&&!Kb.contains(lc)&&this.gridView.Nv(Ja,3,"BIExploreManager.ScrollIntoView")}}R8a(){return this.$.ea.isNamedObjectViewMode&&W.f(this.$.na)}static la(Ja,Kb,lc){V.a(Ja)||Ja.da.Ha(2,new yb(Ja,Kb,lc))}}Object(e.a)(yb,"BIExploreManager",
u.a,[233,810,36,2,811]);var Gb=a(10),Sa=a(718),db=a(94),fb=a(477),ab=a(155),wb=a(31),kb=a(197);class tb{constructor(Ja,Kb,lc){Kb||d.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");this.$=Ja;this.fieldManagerPane=Kb;this.DLg=lc}Oc(Ja,Kb){return(2140436015===Kb||-1006032470===Kb)&&!(new ab.a(this.DLg)).Zd(8192)}executeCommand(Ja,Kb,lc,Dc){Ja=Kb.command;Dc=Dc.EV();switch(Ja){case 2140436015:case -1006032470:this.fieldManagerPane&&(this.fieldManagerPane.aCc(!db.h(this.$.Ue),
Kb,!1),d.ULS.sendTraceTag(537162717,0,50,`${2140436015===Ja?"Show":"Hide"} Field List`));break;case 589118293:case -1687560254:return this.o$b(!0,!1,Dc);case 1176256599:return this.o$b(!1,!1,Dc);case -1751201991:return this.o$b(!0,!0,Dc);case -232434744:return this.o$b(!1,!0,Dc);default:return kb.a(Ja)}return f.Task.Ua(!0)}Ac(Ja,Kb){Ja=!1;switch(Kb.command){case 2140436015:case -1006032470:Ja=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:Ja=!0}return Ja}Vc(){return!1}o$b(Ja,
Kb,lc){const Dc=wb.a.Ya.kc,Oc=H.h(this.$).ga.qa.activeCell;lc=Object(nb.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(za.d)(cb.a.resolve(Pa.X,{rb:lc})):Ha.GetServiceTaskFactory.Sa(this.$.da,12,477,lc);return Ca.TaskExtensions.za(lc,()=>{const oa=na=>{if(na){H.h(this.$).Xo(!0);const dc=La.o(Oc,this.$);this.$.Tc(-867563466,(Rc,Fd,de)=>D.J(this.$.pa.va,dc,0,!1,!1,!1,Ja,Kb,Rc,Fd,de,null,null),Dc,0,6,161,()=>new fb.a(dc,Kb))}};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",
!1)?void cb.a.resolve(Pa.o,{rb:1}).then(na=>{na.ak(!1,oa)}):Xa.a(this.$).ak(!1,oa)},this.$.ka,3)}static R2a(Ja,Kb,lc){const Dc={};Ja.gk(Dc);Dc.FirstRow=Kb;Dc.FirstColumn=lc;return Dc}}Object(e.a)(tb,"FieldListCommandHandler",null,[233]);class hb extends Sa.a{constructor(Ja){super(Ja)}Fd(){Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.Sa(this.$.da,16,74,this.Na),Ja=>{this.qd([new tb(this.$,Ja.result,this.$.ua)])},this.ka,3)}static la(Ja){Sa.a.Yd(75,new hb(Ja))}}Object(e.a)(hb,"FieldListCommandHandlerFactory",
Sa.a,[]);var Fb=a(228);class va{constructor(Ja,Kb,lc){this.uma=this.hud=this.tma=this.klc=!1;this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.yke=-1;this.Wle=1;this.gFa=this.Pae=this.Oae=-1;this.Nsa=null;if(Ja&&(this.oA=Kb,this.tma=this.klc=!1,Ja.na)){var Dc=H.h(Ja),Oc=Kb=null;if(W.f(Ja.na))lc=ib.a(Ja),lc.jd&&lc.jd.Attributes&4&&(this.chartId=lc.chartId,Kb=lc.jd);else if(W.i(Ja.na)){const oa=Dc.ga.Ra.oc;oa?(lc=oa.floatingObject)&&0===lc.type&&lc.jd&&
lc.jd.Attributes&4&&(this.chartId=oa.floatingObject.id,Kb=lc.jd):Dc.ga.qa.activeCell&&(lc=Ub.EwaSettings.Xw()?lc.r5():Xa.a(Ja).r5(),Object(l.a)(ma.PivotTableRange,lc)&&(Oc=lc))}Kb?(this.tma=!0,this.hud=!!(Kb.Attributes&256),this.anchorType=7,this.uma=!!(Kb.Attributes&128),this.confirmationRequiredForDataOps=!!(Kb.Attributes&64),this.gFa=Kb.ExternalSourceIndex,this.BH=Kb.FieldListVersion,this.SM=Kb.FieldWellVersion,Kb=this.Nsa={},Ja.gk(Kb),Kb.FirstColumn=Kb.FirstRow=-1):Oc&&(this.klc=!0,this.hud=Oc.isActionable,
this.anchorType=0,this.uma=Oc.isOlap,this.confirmationRequiredForDataOps=Oc.confirmationRequiredForDataOps,this.gFa=Oc.externalSourceIndex,this.BH=Oc.sKh,this.SM=Oc.xKh,this.pivotTableName=Oc.pivotTableName,this.Nsa=La.o(Oc,Ja))}}get eLb(){return this.yke}set eLb(Ja){this.yke=Ja}get oA(){return this.Wle}set oA(Ja){this.Wle=Ja}get BH(){return this.Oae}set BH(Ja){this.Oae=Ja}get SM(){return this.Pae}set SM(Ja){this.Pae=Ja}get vOa(){return this.tma||this.klc}get Ixi(){return this.vOa&&!this.hud}get externalSourceIndex(){return this.gFa}get wx(){return this.Nsa}get sheetName(){return this.wx?
this.wx.SheetName:null}get Qub(){return this.chartId+"_"+this.pivotTableName+"_"+this.BH+"_"+this.SM}vjh(){const Ja={};Ja.AnchorType=this.anchorType;7===this.anchorType&&(Ja.ChartId=this.chartId);Ja.AnchorValue1=Ja.AnchorValue2=-1;return Ja}static Q7b(){return new va(null,-1,null)}static create(Ja,Kb,lc){return new va(Ja,Kb,lc)}static bqf(Ja,Kb){return Ja.vOa!==Kb.vOa||Ja.anchorType!==Kb.anchorType||Ja.chartId!==Kb.chartId||Ja.pivotTableName!==Kb.pivotTableName||!!Ja.wx&&!!Kb.wx&&Ja.wx.SheetName!==
Kb.wx.SheetName}static CBi(Ja,Kb){return va.bqf(Ja,Kb)||Ja.eLb!==Kb.eLb||Ja.oA!==Kb.oA}}Object(e.a)(va,"FieldListRequestState",null,[830]);class jb extends Fb.a{constructor(Ja){super();this.$=Ja;this.Mb()}create(){if(Ub.EwaSettings.Xw())void cb.a.resolve(Pa.o,{rb:1}).then(Ja=>{Ja=va.create(this.$,-1,Ja);this.vb(Ja)});else{const Ja=va.create(this.$,-1,null);this.vb(Ja)}}dispose(){this.$=null;super.dispose()}static la(Ja){Ja.da.Ha(110,new jb(Ja))}}Object(e.a)(jb,"FieldListRequestStateFactory",Fb.a,
[]);var Ab=a(426),Qa=a(33),Z=a(816),wa=a(114),Ea=a(6),fa=a(91);class Ua{constructor(){this.rE=0;this.request=null;this.wl=!0}get correlationId(){return this.rE}EAf(){return this.rE=this.correlationId+1}}Object(e.a)(Ua,"DataRequestInfo",null,[]);class Aa{}Aa.$Ah="ewa-flp-react-pane";Aa.ZAh="ewa-flp-react-header";Aa.aBh="ewa-flp-react-title";Aa.XAh="ewa-flp-react-body";Aa.YAh="ewa-flp-react-close-button";Object(e.a)(Aa,"CssClassNames",null,[]);var Ib=a(25),Pb=a(597),Fa=a(199),da=a(294),K=a(120),xa=
a(567),rb=a(23);const Qb=(Ja,Kb,lc)=>{if(Ja)for(let Dc=0,Oc=Ja.length;Dc<Oc;Dc++){const oa=Ja[Dc];oa.ClientId=lc++;oa.ClientParentId=Kb;lc=Qb(oa.Children,oa.ClientId,lc)}return lc},pc=(Ja,Kb,lc,Dc)=>{for(const Oc of Ja){if(Oc.PivotCacheIndex===Kb&&(Oc.TypeTag===lc||0===lc))return Oc;if(Dc&&(Ja=pc(Oc.Children,Kb,lc,Dc)))return Ja}return null},Lb=(Ja,Kb,lc)=>{if(Ja)for(let Oc=0,oa=Ja.length;Oc<oa;Oc++){var Dc=Ja[Oc];if(Dc.ClientId===Kb||lc&&(Dc=Lb(Dc.Children,Kb,lc)))return Dc}return null};var qb=a(2),
bc=a(185),sc=a(1367),Tb=a(778);class $a{constructor(){this.type=null;this.dataUpdateType=0;this.fieldWellsItems=this.fieldListItems=null;this.isSortAscending=this.isPivotChart=this.isOlap=this.isDataModel=!1;this.focusResetId=this.focusResetType=this.fieldListSizePercentage=this.selectedTab=0;this.onFieldListItemMenuClickV2=this.onFieldWellItemMenuClickV2=this.onFieldCheckedChanged=this.onFieldExpandCollapse=this.onFieldMove=this.onExpandCollapseAll=this.onSortOrderChanged=this.onSelectedTabChanged=
this.onSaveFieldListSizePercentage=null;this.isRichPivotFieldList=!1;this.onSearchInputChanged=this.fieldListSearchInfo=null}}Object(e.a)($a,"FieldListTaskPaneProps",null,[]);class Nb{constructor(Ja,Kb){this.$=Ja;this.fieldManagerPane=Kb}AL(Ja){bc.UISurfaces.Aj().then(Kb=>{Kb.showTaskPane("FieldListTaskPane",this.Eu(Ja,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})}fC(Ja,Kb,lc,Dc,Oc,oa,na,dc,Rc,Fd,de){bc.UISurfaces.Aj().then(ne=>{ne.updateTaskPane("FieldListTaskPane",this.Eu(Ja,Kb,lc,Dc,Oc,oa,
na,dc,Rc,Fd,de));return null})}RBa(){bc.UISurfaces.Aj().then(Ja=>{Ja.setSelectedTaskPane("FieldListTaskPane");return null})}HK(){bc.UISurfaces.Aj().then(Ja=>{Ja.hideTaskPane("FieldListTaskPane",2);return null})}Eu(Ja,Kb,lc,Dc,Oc,oa,na,dc,Rc,Fd,de){Kb=Object(qb.a)(new $a,{type:"FieldListTaskPaneProps",fieldListItems:lc,fieldWellsItems:Dc,dataUpdateType:Kb,isDataModel:Oc,selectedTab:oa,isSortAscending:na,focusResetType:dc,focusResetId:Rc,isRichPivotFieldList:Fd,fieldListSearchInfo:de,isOlap:this.fieldManagerPane.uma,
isPivotChart:this.fieldManagerPane.tma,fieldListSizePercentage:this.fieldManagerPane.lij,onFieldExpandCollapse:this.fieldManagerPane.hij,onExpandCollapseAll:this.fieldManagerPane.gij,onFieldCheckedChanged:this.fieldManagerPane.qij,onFieldListItemMenuClickV2:this.fieldManagerPane.jij,onSortOrderChanged:this.fieldManagerPane.bij,onSaveFieldListSizePercentage:this.fieldManagerPane.Lij,onSearchInputChanged:this.fieldManagerPane.kij,onSelectedTabChanged:ne=>{this.fieldManagerPane.cij(ne)},onFieldMove:(ne,
cf,Bf,Af)=>{this.fieldManagerPane.tij(ne,cf,Bf,Af)},onFieldWellItemMenuClickV2:(ne,cf,Bf,Af)=>{this.fieldManagerPane.mij(ne,cf,Bf,Af)}});if(Qa.a.Md())return Object(qb.a)(new sc.a,{contentProps:Kb,onOpen:()=>{this.fieldManagerPane.nKf()},onClose:()=>{this.fieldManagerPane.U2i()},onManualClose:()=>{this.fieldManagerPane.V2i()},title:this.fieldManagerPane.tma?E.a.instance.ha(1183):E.a.instance.ha(1182),width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950});Ja=Object(qb.a)(new Tb.a,{type:"ExcelLegacyTaskPaneProps",
container:Ja,paneProps:Kb});return Object(qb.a)(new sc.a,{contentProps:Ja,onOpen:()=>{this.fieldManagerPane.nKf()}})}}Object(e.a)(Nb,"FieldListReactTaskPane",null,[886]);class Ra{constructor(Ja,Kb,lc){this.cachedItemIndex=this.cachedSourceAxis=0;this.cachedItemName=null;this.cachedSourceAxis=Ja;this.cachedItemIndex=Kb;this.cachedItemName=lc}}Object(e.a)(Ra,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);class ob{constructor(Ja,Kb,lc,Dc){this.activeCell=this.additionalInformation=this.pivotData=
this.pivotName=null;this.pivotName=Ja;this.pivotData=Kb;this.additionalInformation=lc;this.activeCell=Dc}getActiveCell(){return this.activeCell}}Object(e.a)(ob,"MacroRecorderPivotTablePivotedPayload",null,[145]);var mb=a(168),gb=a(98),lb=a(32),Xb=a(110),Xd=a(74),Qd=a(728);class te{constructor(){this.id=0;this.name=null;this.type=0;this.showSeparator=this.showMenu=this.showCheckBox=this.canDrag=this.isMoreFields=this.isChecked=this.isCollapsed=this.isCollapsible=!1;this.children=null;this.isBolded=
!1}}Object(e.a)(te,"FieldListItem",null,[]);class Pc{constructor(){this.searchRestoreValue=null;this.searchWithNoMatch=this.needSearchReset=this.needSearchRestore=!1}}Object(e.a)(Pc,"FieldListSearchInfo",null,[]);class Ne{constructor(){this.id=0;this.name=null}}Object(e.a)(Ne,"FieldWellItem",null,[]);class Hb{constructor(){this.valuesWellItems=this.rowsWellItems=this.columnsWellItems=this.filtersWellItems=null}}Object(e.a)(Hb,"FieldWellsItems",null,[]);class pb extends M.a{constructor(Ja,Kb,lc,Dc,
Oc){var oa;super(Ja);this.Hed=300;this.MQ=new Ua;this.NQ=new Ua;this.Y$c={};this.Wva=this.rk=this.pk=null;this.Wrb=this.w4b=this.Ncc=!1;this.currentState=va.Q7b();this.yIa=this.dIa=null;this.dda=0;this.KTd=this.std=!1;this.Vva=null;this.Xnf=this.oh=!1;this.bGe=this.CKb=this.aBa=null;this.FKb=-1;this.ZW=[];this.BKb=!1;this.PRa=null;this.AKb=this.AVf=this.LLd=!1;this.zKb="";this.ORa=null;this.X7=0;this.W7="";this.JLd=!1;this.yVf=null;this.tj=!1;this.gw=0;this.qij=(na,dc)=>{this.rk&&this.xma&&(na=Lb(this.rk.FieldListItems,
na,!0))&&(d.ULS.sendTraceTag(554317778,0,50,"React Field List: check/uncheck a field."),this.yCi(na,dc))};this.hij=na=>{this.rk&&(na=Lb(this.rk.FieldListItems,na,!0))&&na.IsCollapsible&&(5===na.TypeTag&&na.IsCollapsed&&!na.Children.length?(this.ZW.length=0,this.ZW.push(na),this.bed()):(na.IsCollapsed=!na.IsCollapsed,this.oh&&this.jdc(0,-1,!1,!1,!1,!1)))};this.gij=na=>{this.rk&&(d.ULS.sendTraceTag(554317777,0,50,"React Field List: expand/collapse all fields."),0<this.ZW.length&&(this.ZW.length=0),
this.wVf(this.rk.FieldListItems,na)?this.bed():this.oh&&this.jdc(0,-1,!1,!1,!1,!1))};this.jij=(na,dc,Rc)=>{if(this.rk){var Fd=document.getElementById(dc);if(Fd){var de=Lb(this.rk.FieldListItems,na,!0);if(de){na={};na.domElement=Fd;na.fieldItem=de;na.versionkey=this.Qub;na.isChart=!!this.chartId;na.isPpm=this.rk.IsPpm;na.isOlap=this.currentState.uma;na.supportsImplicitMeasures=this.rk.SupportsImplicitMeasures;na.isKeyboardInput=Rc;this.PRa=dc;dc=new gb.a(330754562,0,this.$.Bc,30,null);var ne;this.BKb=
!mb.a(ne=this.$.Ia.Nb(dc,na))&&(6!==ne.status||ne.result)}}}};this.bij=na=>{d.ULS.sendTraceTag(554317775,0,50,"React Field List: change field list sort order.");const dc=pb.lub(this.currentState);this.$.userOperationManager.Tc(new Fa.a(251,0,(Rc,Fd,de)=>{var ne=this.$.pa.va;const cf=D.L(ne,this.currentState.wx,this.currentState.externalSourceIndex,dc);cf.isAscending=na;return D.g(ne,"ChangePivotFieldListSortOrder",cf,Rc,Fd,de,null,0)}),null)};this.Lij=na=>{this.lke=na};this.kij=na=>{na!==this.W7&&
(d.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),this.W7=na,this.jdc(0,-1,!1,!0,!1,!1))};this.mKf=()=>{if(this.BKb&&this.PRa){const na=document.getElementById(this.PRa);na&&na.classList.add("fieldItemMenuOpen")}};this.lKf=()=>{if(this.BKb&&this.PRa){const na=document.getElementById(this.PRa);na&&(na.classList.remove("fieldItemMenuOpen"),na.classList.contains("fieldItemOnHover")||na.classList.contains("fieldItemOnFocus")||(na.style.visibility="hidden"))}this.BKb=!1;this.PRa=
null};this.Cl=()=>{this.GTd(!0,null);this.hideTaskPane();return!0};this.vaa=()=>{if(this.$)if(Xd.a(this.$).ONa&&this.isVisible&&this.currentState.vOa&&this.$.ea.jc){if(this.MQ.wl&&!this.MQ.request){var na=this.MQ;var dc=this.$.pa.va;var Rc=this.currentState.BH,Fd=this.currentState.eLb,de=this.currentState.oA,ne=this.aZi,cf=this.bZi,Bf=this.MQ.EAf();const Af=D.L(dc,this.currentState.wx,this.currentState.externalSourceIndex,pb.lub(this.currentState));Af.type=1;Af.version=Rc;Af.relatedGroup=Fd;Af.selectedTab=
de;dc=D.g(dc,"GetPivotFieldListData",Af,ne,cf,null,Bf,4);na.request=dc}this.NQ.wl&&!this.NQ.request&&(na=this.NQ,dc=this.$.pa.va,Rc=this.currentState.SM,Fd=this.dZi,de=this.eZi,ne=this.NQ.EAf(),cf=D.L(dc,this.currentState.wx,this.currentState.externalSourceIndex,pb.lub(this.currentState)),cf.type=1,cf.version=Rc,dc=D.g(dc,"GetPivotFieldManagerData",cf,Fd,de,null,ne,4),na.request=dc)}else pb.eZ(this.MQ),pb.eZ(this.NQ)};this.aZi=(na,dc)=>{this.NRf(na,dc,this.MQ)&&(na=na.Result)&&(this.currentState.BH=
na.FieldListVersion,this.MQ.wl=!1,this.mng(na));Ub.EwaSettings.Xw()?this.Ev.IVa():Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Rc=>{Rc.IVa()}):Xa.a(this.$).IVa();this.refresh()};this.bZi=na=>{this.bFf(na,this.MQ)};this.dZi=(na,dc)=>{this.NRf(na,dc,this.NQ)&&(na=na.Result)&&(this.currentState.SM=na.FieldWellVersion,this.NQ.wl=!1,this.dng(na));this.refresh()};this.eZi=na=>{this.bFf(na,this.NQ)};this.STi=na=>{if(lb.a.lg(na.Errors)){this.Wrb=
!1;this.dIa=null;for(let Rc=0,Fd=na.Errors.length;Rc<Fd;++Rc)if(1244452614===na.Errors[Rc].MessageId){if(Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")){na=H.h(this.$);var dc=na.wb.rp(na.ga.qa.activeCell);dc&&(dc=Ib.Range.Lc(dc.I3f+1,dc.left),dc=La.v(dc,this.$),na.Bg(dc,null,null,null,3,"FieldManagerPane.OnApplyPivotSuccess"))}this.currentState.BH=-1;this.currentState.SM=-1;this.refresh();break}}this.Ncc=!0};this.CXi=na=>{this.w4b=!1;if(!lb.a.lg(na.Errors)){if(0<
this.ZW.length)for(na=0;na<this.ZW.length;++na)this.ZW[na].IsCollapsed=!1;this.currentState.BH=-1;this.refresh()}};this.yna=()=>{const na=H.h(this.$).ga;na.Ra.Jtd&&na.Se&470||H.h(this.$).inRangePicker||H.h(this.$).ni||this.OKb(!0,!0)};this.Gf=()=>{this.refresh();this.$.ea.jn.FieldListForceOnTop&&this.aCc(!1,null,!0)};this.vrc=()=>{this.OKb(!0,!0)};this.yd=()=>{this.OKb(!0,!1)};this.Fj=(na,dc)=>{na=W.e(dc.RB)||W.e(dc.na);this.OKb(!0,na)};this.cr=(na,dc)=>{for(let Rc of dc.q9j)this.nng(Rc);this.std&&
(this.std=!1,this.Dma||this.taskPaneManager.Qh&&1===this.taskPaneManager.Qh.taskPane.Uh||this.taskPaneManager.VI(this,!0));this.OKb(!1,!0)};this.nHf=(na,dc)=>{H.h(this.$).Tr||this.nng(dc.hd.hash)};this.RDf=()=>{this.refresh()};this.dd=()=>{this.qL()};this.So=()=>{this.qL()};this.MMf=()=>{this.refresh()};this.PNf=()=>{this.vaa()};this.Ev=Oc;this.$=Kb;this.Ue=Kb.Ue;this.taskPaneManager=lc;this.taskPaneManager.PE(this.MMf);this.azi=Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",
!1)&&Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",!1);this.Dma=Qa.a.Md();this.lke=.5;this.Vva=new Nb(this.$,this);this.$.Ia.Lte(this.mKf);this.$.Ia.G_a(this.lKf);this.Hed=400;this.Dma||(Ja.style.width=T.HelperMethods.Ic(this.Hed));rb.a.equals("rtl",Ja.dir,!0)&&(this.tj=!0);this.wKh=[4,2,1,8];this.$.rl(this.yd);Ja=H.h(this.$);Ja.Ca.uu(this.nHf);Ja.cU(this.cr);ib.a(this.$).Ca.uu(this.RDf);Ja.ga.FC(this.yna);Ja.OE(this.yna);Ja.ga.Ra.QQg(this.vrc);null===(oa=Xb.a(this.$))||
void 0===oa?void 0:oa.T1b(this.vrc);this.$.ua.kg(this.Fj);this.$.ea.vu(this.Gf);this.$.ea.Zj(this.dd);this.$.ea.pM(this.So);Xd.a(this.$).RZc(this.PNf);x.a(this.$).ti(this);this.refresh()}eU(Ja){this.get_events().addHandler(pb.JZe,Ja)}fX(Ja){this.get_events().removeHandler(pb.JZe,Ja)}PE(Ja){this.addHandler(pb.Hwb,Ja)}iG(Ja){this.removeHandler(pb.Hwb,Ja)}OQg(Ja){this.addHandler(pb.HZe,Ja)}Ipj(Ja){this.removeHandler(pb.HZe,Ja)}NQg(Ja){this.addHandler(pb.GZe,Ja)}Hpj(Ja){this.removeHandler(pb.GZe,Ja)}get pivotName(){return this.currentState.pivotTableName}get chartId(){return this.currentState.chartId}get wx(){return this.currentState.wx}get uma(){return this.currentState.uma}get tma(){return this.currentState.tma}get confirmationRequiredForDataOps(){return this.currentState.confirmationRequiredForDataOps}get externalSourceIndex(){return this.currentState.externalSourceIndex}get BH(){return this.currentState.BH}get SM(){return this.currentState.SM}get Qub(){return this.currentState.Qub}get isRtl(){return this.tj}get UVd(){return this.g0a}get xma(){return!(!this.isVisible||
this.MQ.wl||this.NQ.wl||this.w4b||this.Wrb)}get parentElement(){return this.$.domElement}get rc(){return this.domElement}get isVisible(){return super.isVisible}set isVisible(Ja){Ja=this.h0a&&Ja;!Ja||this.yIa||this.Xnf||this.Zli();Ja!==super.isVisible&&(super.isVisible=Ja,this.raiseEvent(pb.Hwb));this.vXf(null,Ja)}get Qf(){return this.isVisible}get je(){return ia.a.uKh}get Uh(){return 1}get tk(){return A.a.vFh}get jR(){return E.a.instance.ha(1069)}get oq(){return this.Hed}get isResizable(){return!0}get titleText(){return E.a.instance.ha(1182)}get lij(){return this.lke}get cC(){return this.taskPaneManager.mwa(this.rc,
this.titleText,this.oq,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.oq)}get g0a(){return this.$.nc.z3(36896)&&this.h0a}get h0a(){const Ja=new ab.a(this.$.ua);return this.$.isEditMode&&Ja.Zd(8192)||!Ja.di}get hnh(){return(this.pivotName||"")+(this.chartId||"")}$g(){}Zq(){return this.g0a&&!db.h(this.Ue)}Tt(){const Ja=va.create(this.$,this.FKb,this.Ev);return Ja.vOa&&!Ja.Ixi&&!db.h(this.Ue)}BW(){}yse(Ja,Kb){(Ja=pc(this.rk.FieldListItems,
Ja,this.currentState.uma?5:17,!0))&&Ja.CanDrag&&this.nK(Ja,Kb,0,null,null)}nK(Ja,Kb,lc,Dc,Oc){let oa,na,dc;if(Dc&&!rb.a.equals(Dc,this.Qub,!1))alert(E.a.instance.Va(18));else{({axis:Dc,pos:na,qQf:dc}=this.o3e(Ja.PivotCacheIndex,Ja.PivotTableIndex));-1!==Ja.PivotTableIndex?oa=Dc:(na=oa=0,dc=Ja.PivotCacheIndex);if(0===oa){if(7===Ja.TypeTag&&(Ja=0<=Ja.ClientParentId?Lb(this.rk.FieldListItems,Ja.ClientParentId,!0):null,!Ja))return;na=0;dc=Ja.PivotCacheIndex}if(oa!==Kb||0===Kb||na!==lc&&na!==lc-1){var Rc=
new Ra(Dc,Ja.PivotCacheIndex,Ja.Name),Fd=de=>{de&&this.applyPivot(this.currentState,oa,na,Ja.TypeTag,dc,Kb,lc,Oc,H.h(this.$),Rc,Ja)};Ub.EwaSettings.Xw()?this.Ev.ak(this.currentState.confirmationRequiredForDataOps,Fd):Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(de=>{de.ak(this.currentState.confirmationRequiredForDataOps,Fd)}):Xa.a(this.$).ak(this.currentState.confirmationRequiredForDataOps,Fd)}}}tij(Ja,Kb,lc,
Dc){if(this.rk&&this.pk){var Oc=null;switch(Kb){case 0:Oc=Lb(this.rk.FieldListItems,Ja,!0);break;case 1:Oc=Lb(this.pk.RowAxis,Ja,!1);break;case 2:Oc=Lb(this.pk.ColumnAxis,Ja,!1);break;case 4:Oc=Lb(this.pk.FilterAxis,Ja,!1);break;case 8:Oc=Lb(this.pk.DataAxis,Ja,!1)}Oc&&(d.ULS.sendTraceTag(554317779,0,50,"React Field List: drag and drop a field."),this.nK(Oc,lc,Dc,null,null))}}wVf(Ja,Kb){let lc;lc=!1;for(let Dc=0;Dc<Ja.length;Dc++){const Oc=Ja[Dc];Kb&&Oc.IsCollapsible&&5===Oc.TypeTag&&Oc.IsCollapsed&&
!Oc.Children.length?(this.ZW.push(Oc),lc=!0):Kb&&Oc.IsCollapsible&&Oc.IsCollapsed?Oc.IsCollapsed=!1:Kb||!Oc.IsCollapsible||Oc.IsCollapsed||(Oc.IsCollapsed=!0);Oc.IsCollapsible&&Oc.Children&&0<Oc.Children.length&&this.wVf(Oc.Children,Kb)&&(lc=!0)}return lc}jdc(Ja,Kb,lc,Dc,Oc,oa){if(this.rk){var na=!1,dc=!1,Rc=!1,Fd=null;Rc=null;var de=Ja;Dc&&0<this.ZW.length&&(this.ZW.length=0);({Zzb:dc,cva:Rc,isRichPivotFieldList:na,returnValue:Fd}=this.Xgd(this.rk.FieldListItems,Dc,!1));Rc?this.w4b||this.bed():(Rc=
new Pc,Rc.needSearchReset=oa,Rc.needSearchRestore=!oa&&Oc,Rc.searchRestoreValue=Rc.needSearchRestore?this.W7:"",Rc.searchWithNoMatch=""!==this.W7&&!dc,Rc.searchWithNoMatch&&Dc&&Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.Sa(this.$.da,211,212,0),ne=>{ne.result.readText(E.a.instance.ha(778))},this.$.ka,3),""!==this.W7&&2===Ja&&(Rc.searchWithNoMatch?de=1:lc&&Fd&&0<Fd.length&&(Kb=Fd[0].id)),this.Vva.fC(this.yIa,0,Fd,null,this.rk.IsPpm,this.rk.SelectedTab,this.rk.IsSortAscending,de,Kb,na,Rc))}}cij(Ja){d.ULS.sendTraceTag(554317776,
0,50,"React Field List: change All/Active tab.");this.FKb=Ja;this.OWj()}mij(Ja,Kb,lc,Dc){if(this.pk){var Oc=document.getElementById(lc);if(Oc){var oa=null,na=-1;switch(Kb){case 4:oa=Lb(this.pk.FilterAxis,Ja,!1);na=this.pk.FilterAxis.length;break;case 2:oa=Lb(this.pk.ColumnAxis,Ja,!1);na=this.pk.ColumnAxis.length;break;case 1:oa=Lb(this.pk.RowAxis,Ja,!1);na=this.pk.RowAxis.length;break;case 8:oa=Lb(this.pk.DataAxis,Ja,!1),na=this.pk.DataAxis.length}if(oa){var dc={};this.currentState.tma?(dc.AnchorType=
8,dc.ChartId=this.currentState.chartId):dc.AnchorType=9;dc.AnchorValue1=oa.PivotTableIndex;dc.AnchorValue2=oa.PivotCacheIndex;var Rc,Fd;({axis:Rc,pos:Fd}=this.o3e(oa.PivotCacheIndex,oa.PivotTableIndex));Ja=new gb.a(-1453503574,0,this.$.Bc,30,null);Kb={};Kb.domElement=Oc;Kb.fieldItem=oa;Kb.zoneCount=na;Kb.sourceAxis=Rc;Kb.sourceAxisPos=Fd;Kb.optionalPivotMenuAnchorParameter=dc;Kb.isOlap=this.currentState.uma;Kb.isPpm=this.rk.IsPpm;Kb.versionkey=this.Qub;Kb.isKeyboardInput=Dc;Kb.cell=this.currentState.wx;
Kb.externalSourceIndex=this.externalSourceIndex;Dc=!1;Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&this.currentState.uma&&!this.rk.IsPpm&&this.rk.SupportsImplicitMeasures&&(oa=pc(this.rk.FieldListItems,oa.PivotCacheIndex,5,!0),Dc=!!oa&&!oa.IsCollapsible);Kb.fieldItemsupportsImplicitMeasures=Dc;this.PRa=lc;var de;this.BKb=!mb.a(de=this.$.Ia.Nb(Ja,Kb))&&(6!==de.status||de.result)}}}}iij(Ja){Ja&&Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.Sa(this.$.da,103,
104,0),Kb=>{var lc=Kb.result;const Dc=H.h(this.$),Oc=La.v(Ib.Range.Lc(1,1),this.$).SheetName;Kb=lc.uib(Dc);let oa,na,dc,Rc;Kb?(lc=Kb.re,oa=lc.Ge.top,na=lc.Ge.left,dc=Kb.rJ.x,Rc=Kb.rJ.y):(oa=na=1,Kb=lc.GMa(Dc),dc=Kb.x,Rc=Kb.y);this.$.userOperationManager.Tc(new Fa.a(203,0,(Fd,de,ne)=>da.t(this.$.pa.va,Oc,this.pivotName,Ja.PivotCacheIndex,0,oa,na,dc,Rc,Fd,de,ne,null),void 0,()=>new Pb.a(Oc,this.pivotName,Ja.PivotCacheIndex,0)),null)},this.$.ka,8)}dispose(){var Ja;if(this.$){this.$.lm(this.yd);this.$.Ia.r_f(this.mKf);
this.$.Ia.KLb(this.lKf);this.ZW.length=0;const Kb=H.h(this.$);Kb&&(Kb.pO(this.cr),Kb.hG(this.yna),Kb.ga&&(Kb.ga.JI(this.yna),Kb.ga.Ra.Kpj(this.vrc)),Kb.Ca&&Kb.Ca.Ls(this.nHf));null===(Ja=Xb.a(this.$))||void 0===Ja?void 0:Ja.cxc(this.vrc);Ja=ib.a(this.$);(null===Ja||void 0===Ja?0:Ja.Ca)&&Ja.Ca.Ls(this.RDf);this.$.ua&&this.$.ua.Gg(this.Fj);if(Ja=this.$.ea)Ja.$v(this.Gf),Ja.xk(this.dd),Ja.iS(this.So);Xd.a(this.$)&&Xd.a(this.$).Jwc(this.PNf)}this.taskPaneManager&&this.taskPaneManager.iG(this.MMf);this.aBa&&
(I.a.instance.Ba(m.a.click,this.aBa,this.Cl),wa.KeyInputManager.instance.Cx(this.aBa,this.bGe));this.hideTaskPane();this.taskPaneManager=this.$=this.Vva=null;super.dispose()}pg(Ja,Kb){if(!Kb){Ja=R.DOMElementExtensions.Pl(this.domElement.querySelectorAll(R.DOMElementExtensions.Uq));if(!Ja)return!1;R.DOMElementExtensions.setFocus(Ja)}return!Kb}Gh(Ja){return R.DOMElementExtensions.Mf(this.rc,Ja)}Bj(){}hk(){}OWj(){this.refresh()}yCi(Ja,Kb){Ja&&Ja.CanDrag&&this.nK(Ja,Kb?-1:0,-1,null,null)}u7(){this.Dma&&
this.Zq()&&this.Tt()&&(this.isVisible=!0)}nKf(){this.LLd=!0;this.refresh()}U2i(){this.hideTaskPane()}V2i(){this.GTd(!0,null);this.hideTaskPane()}Zli(){this.Xnf=this.oh=!0;this.Dma||this.uni();this.Vva.AL(this.yIa)}showTaskPane(){this.isVisible=!0;""!==this.W7&&(this.JLd=!0);this.oh?this.Dma?this.Vva.RBa():this.taskPaneManager.VI(this,!0):(this.oh=!0,this.Vva.AL(this.yIa),this.Dma||this.taskPaneManager.VI(this,!0))}hideTaskPane(){this.isVisible=this.LLd=this.oh=!1;this.Vva.HK()}aCc(Ja,Kb,lc){this.GTd(Ja,
Kb);this.std=lc;this.KTd=!Ja&&!!Kb||lc;Ja?this.hideTaskPane():this.showTaskPane()}bed(){const Ja=Kb=>{Kb&&this.expandPivotFieldListLevels(this.currentState)};Ub.EwaSettings.Xw()?this.Ev.ak(this.currentState.confirmationRequiredForDataOps,Ja):Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Kb=>{Kb.ak(this.currentState.confirmationRequiredForDataOps,Ja)}):Xa.a(this.$).ak(this.currentState.confirmationRequiredForDataOps,
Ja)}LV(){return!1}jWg(){const Ja=document.getElementsByTagName("head")[0];if(Ja){const Kb=document.createElement("link");Kb.setAttribute("rel","stylesheet");Kb.setAttribute("type","text/css");Kb.setAttribute("href",R.DOMElementExtensions.$Z(this.domElement,"data-cssfile",null));Ja.appendChild(Kb)}}uni(){const Ja=document.getElementById(this.$.Ib+F.a.IZe);if(Ja){this.jWg();Ja.classList.add(pb.Aij);var Kb=this.wkh();Ja.appendChild(Kb);Kb=Qd.b("div",pb.xij,pb.wij);Ja.appendChild(Kb);this.yIa=Kb}}wkh(){const Ja=
Qd.b("div",pb.Cij,pb.Bij);this.CKb=Qd.b("span",pb.Eij,pb.Dij);this.CKb.innerText=this.titleText;this.aBa=Z.a.tb(pb.yij,pb.zij,E.a.instance.ha(10),"ClosePaneGlyph_16x16x32",!1);this.aBa.classList.add(Ea.AFrameworkApplication.isRtl?F.a.oka:F.a.pka);I.a.instance.ta(m.a.click,this.aBa,this.Cl);this.bGe=wa.KeyInputManager.instance.$t(this.aBa,this.Cl,fa.a.Wh);Ja.appendChild(this.CKb);Ja.appendChild(this.aBa);return Ja}mng(Ja){if(this.rk=Ja)this.currentState.BH=this.rk.FieldListVersion,this.dda=Qb(this.rk.FieldListItems,
-1,this.dda);if(this.rk)if(this.oh){this.FKb=this.currentState.oA=this.rk.SelectedTab;this.pGi();Ja=-1;var Kb=0,lc=!1;this.KTd?(this.rk.FieldListItems&&0<this.rk.FieldListItems.length&&(Ja=this.rk.FieldListItems[0].ClientId,Kb=2,lc=!0),this.KTd=!1):this.Ncc&&0===this.X7&&(this.ORa||this.AKb?this.rk.FieldListItems&&0<this.rk.FieldListItems.length&&(Ja=this.AKb?this.rk.FieldListItems[0].ClientId:this.ORa.ClientId,Kb=2,lc=this.AKb):this.AVf&&(Ja=this.rk.FieldListItems[0].ClientId,Kb=1),this.V5b());var Dc=
!1;this.yVf!==this.rk.PivotXluid&&(this.yVf=this.rk.PivotXluid,Dc=!0,this.W7="");this.jdc(Kb,Ja,lc,!1,!Dc&&this.JLd&&""!==this.W7,Dc);this.JLd=!1}else this.V5b()}V5b(){this.X7=0;this.ORa=null;this.zKb="";this.Ncc=this.AKb=this.AVf=!1}jNj(Ja){return 7===Ja.TypeTag?!1:Ja.ShowFilterArrow||Ja.ShowCheckBox}ACi(Ja){return Ja.IsCollapsible&&(!Ja.IsCollapsed||2===Ja.Image)&&!!Ja.Children&&0<Ja.Children.length}Zzb(Ja,Kb){const lc=Kb.length;return 2<lc&&'"'===Kb.charAt(0)&&'"'===Kb.charAt(lc-1)?rb.a.contains(Ja,
Kb.substring(1,lc-1),!0):rb.a.B2a(Kb,"*")||rb.a.B2a(Kb,"?")?(Kb=Kb.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),Kb="^"+rb.a.sSa(rb.a.sSa(Kb,"\\\\?",".",!0),"\\\\*",".*",!0)+"$",0<=Ja.search(new RegExp(Kb,"i"))):rb.a.contains(Ja,Kb,!0)}Xgd(Ja,Kb,lc){let Dc,Oc,oa,na;Dc=na=oa=Oc=!1;const dc=[];for(let de=0;de<Ja.length;de++){const ne=Ja[de];var Rc=!1;let cf=!1,Bf=!1,Af,mg=[];if(""===this.W7){if(this.ACi(ne)){var Fd=void 0;({Zzb:cf,cva:Af,wef:Fd,isRichPivotFieldList:Rc,returnValue:mg}=this.Xgd(ne.Children,
Kb,!1));ne.ShowCheckBox||(ne.IsChecked=Fd)}}else 2!==ne.Image&&this.Zzb(ne.Name,this.W7)&&(Dc=Bf=!0,Kb&&ne.IsCollapsible&&ne.IsCollapsed&&(5!==ne.TypeTag||ne.Children.length?ne.IsCollapsed=!1:(this.ZW.push(ne),Oc=!0))),Kb&&lc&&ne.IsCollapsible&&ne.IsCollapsed&&(5!==ne.TypeTag||ne.Children.length?ne.IsCollapsed=!1:(this.ZW.push(ne),Oc=!0)),ne.IsCollapsible&&ne.Children&&0<ne.Children.length&&({Zzb:cf,cva:Af,wef:Fd,isRichPivotFieldList:Rc,returnValue:mg}=this.Xgd(ne.Children,Kb,Bf||lc),ne.ShowCheckBox||
(ne.IsChecked=Fd),cf&&(Dc=!0,Kb&&(ne.IsCollapsed=!1)),Af&&(Oc=!0));this.azi&&(Rc||66===ne.TypeTag)&&(na=!0);ne.IsChecked&&(oa=!0);if(""===this.W7||Bf||cf||lc)Rc=new te,Rc.id=ne.ClientId,Rc.name=ne.Name,Rc.type=ne.TypeTag,Rc.isCollapsible=ne.IsCollapsible,Rc.showCheckBox=ne.ShowCheckBox,Rc.isMoreFields=2===ne.Image,Rc.canDrag=ne.CanDrag&&7!==ne.TypeTag,Rc.showSeparator=ne.ShowSeparator,Rc.showMenu=this.jNj(ne),Rc.isCollapsed=ne.IsCollapsed,Rc.isChecked=ne.IsChecked,Rc.isBolded=ne.IsBolded,Rc.children=
mg,dc.push(Rc)}return{returnValue:dc,Zzb:Dc,cva:Oc,wef:oa,isRichPivotFieldList:na}}pdc(Ja){const Kb=Array(Ja.length);for(let lc=0;lc<Ja.length;lc++){const Dc=Ja[lc],Oc=new Ne;Oc.id=Dc.ClientId;Oc.name=Dc.Name;Kb[lc]=Oc}return Kb}pyj(){this.O4f(this.rk.FieldListItems,"")}pGi(){this.Ytf(this.rk.FieldListItems,"")}Ybc(Ja,Kb){return Ja.Name+"_"+Ja.UniqueName+"_"+Ja.TypeTag+"_"+(Kb||this.hnh)}O4f(Ja,Kb){if(Ja)for(let lc=0,Dc=Ja.length;lc<Dc;lc++){const Oc=Ja[lc];let oa="";if(Oc.IsCollapsible||Oc.Children)oa=
this.Ybc(Oc,Kb),Oc.IsCollapsible&&(this.Y$c[oa]=!!Oc.IsCollapsed),Oc.Children&&this.O4f(Oc.Children,oa);this.ORa&&Oc.ClientId===this.ORa.ClientId&&(this.zKb=oa||this.Ybc(Oc,Kb))}}Ytf(Ja,Kb){if(Ja)for(let lc=0,Dc=Ja.length;lc<Dc;lc++){const Oc=Ja[lc];let oa="";if(Oc.IsCollapsible||Oc.Children)oa=this.Ybc(Oc,Kb),Oc.IsCollapsible&&oa in this.Y$c&&(Oc.IsCollapsed=U.a.xg(this.Y$c,oa)),Oc.Children&&this.Ytf(Oc.Children,oa);this.zKb&&rb.a.equals(this.zKb,oa||this.Ybc(Oc,Kb),!1)&&(this.ORa=Oc,this.zKb="")}}dng(Ja){if(this.pk=
Ja)this.currentState.SM=this.pk.FieldWellVersion,this.dda=Qb(this.pk.FilterAxis,-1,this.dda),this.dda=Qb(this.pk.ColumnAxis,-1,this.dda),this.dda=Qb(this.pk.RowAxis,-1,this.dda),this.dda=Qb(this.pk.DataAxis,-1,this.dda);this.Wva?this.Wva.length=0:this.Wva=[];if(this.pk)if(this.Wva.push(this.pk.FilterAxis),this.Wva.push(this.pk.ColumnAxis),this.Wva.push(this.pk.RowAxis),this.Wva.push(this.pk.DataAxis),this.oh){Ja=-1;var Kb=0;if(this.Ncc&&0!==this.X7){switch(this.X7){case 1:0<this.pk.RowAxis.length&&
(Ja=this.pk.RowAxis[0].ClientId,Kb=3);break;case 2:0<this.pk.ColumnAxis.length&&(Ja=this.pk.ColumnAxis[0].ClientId,Kb=3);break;case 4:0<this.pk.FilterAxis.length&&(Ja=this.pk.FilterAxis[0].ClientId,Kb=3);break;case 8:0<this.pk.DataAxis.length&&(Ja=this.pk.DataAxis[0].ClientId,Kb=3)}this.V5b()}var lc=new Hb;lc.filtersWellItems=this.pdc(this.pk.FilterAxis);lc.columnsWellItems=this.pdc(this.pk.ColumnAxis);lc.rowsWellItems=this.pdc(this.pk.RowAxis);lc.valuesWellItems=this.pdc(this.pk.DataAxis);this.Vva.fC(this.yIa,
1,null,lc,!1,-1,!1,Kb,Ja,!1,null)}else this.V5b()}n6j(){this.CKb&&(this.CKb.innerText=this.currentState.tma?E.a.instance.ha(1183):this.titleText)}refresh(){if(this.LLd){var Ja=va.create(this.$,this.FKb,this.Ev);this.vXf(Ja)}}vXf(Ja,Kb=!1){if(this.isVisible&&(this.Dma||this.yIa)){Ja=Ja||va.create(this.$,this.FKb,this.Ev);const lc=this.currentState;this.rk&&this.pyj();this.currentState=Ja;if(va.CBi(lc,Ja)||Kb){if(this.Wrb=!1,this.MQ.wl=Ja.vOa,pb.eZ(this.MQ),va.bqf(lc,Ja)||Kb)this.NQ.wl=Ja.vOa,pb.eZ(this.NQ),
this.mng(null),this.dng(null),this.n6j()}else lc.BH<Ja.BH?(this.MQ.wl=!0,pb.eZ(this.MQ)):this.currentState.BH=lc.BH,lc.SM<Ja.SM?(this.Wrb=!1,this.NQ.wl=!0,pb.eZ(this.NQ)):this.currentState.SM=lc.SM}sa.a.instance.create(this.vaa,0,bb.a.tKh,!0,!0)}GTd(Ja,Kb){this.applyPivotFieldManagerHiddenState(Ja,Kb);this.Ue=T.HelperMethods.IO(Ja,this.Ue,4);this.refresh();this.raiseEvent(pb.Hwb);this.Dma&&this.$.zf()}applyPivotFieldManagerHiddenState(Ja,Kb){this.$.userOperationManager.Tc(new Fa.a(144,0,(lc,Dc,Oc)=>
{const oa=La.o(H.h(this.$).ga.qa.activeCell,this.$);var na=this.$.pa.va;const dc=na.Oa(9);dc.hidden=Ja;dc.activeCell=oa;return D.g(na,"ApplyPivotFieldManagerHiddenStateV2",dc,lc,Dc,Oc,null,0)},16),Kb)}NRf(Ja,Kb,lc){lc.wl=!1;if(!lc.request||Kb!==lc.correlationId)return!1;lc.request=null;return lb.a.lg(Ja.Errors)?(this.$.ea.qo(Ja.Errors),!1):!0}bFf(Ja,Kb){const lc=K.a.Ye(Ja.data);this.$.ea.qo(lc);Kb.request=null;10!==Ja.data.status&&(Kb.wl=!1);this.vaa()}applyPivot(Ja,Kb,lc,Dc,Oc,oa,na,dc,Rc,Fd,de){0<
Rc.getRangeInformation(Rc.ga.qa.activeCell).length?this.Wrb=!0:(this.MQ.wl=!0,this.NQ.wl=!0);Ja.klc&&(this.dIa=Ja.pivotTableName);const ne=pb.lub(Ja),cf={FieldListType:1};cf.FieldListVersion=Ja.BH;cf.FieldWellVersion=Ja.SM;cf.SourceAxis=Kb;cf.SourceAxisPosition=lc;cf.ItemType=Dc;cf.ItemIndex=Oc;cf.DestinationAxis=oa;cf.DestinationAxisPosition=na;this.k8j(de,Kb,oa);Kb=new Fa.a(145,0,(Bf,Af,mg)=>{var Kf=this.$.pa.va;Bf=qa.b(Bf,this.STi);const Zf=D.L(Kf,Ja.wx,Ja.externalSourceIndex,ne);Zf.pivotFieldApplyData=
cf;return D.g(Kf,"ApplyPivot",Zf,Bf,Af,mg,null,0)},4,()=>new ob(this.pivotName,cf,Fd,Ja.wx));this.$.userOperationManager.Tc(Kb,dc)}k8j(Ja,Kb,lc){if(this.rk&&this.pk)if(0===Kb)this.X7=0,this.ORa=Ja;else if(0!==lc)this.X7=lc;else switch(this.X7=0,this.AKb=!0,Kb){case 1:1<this.pk.RowAxis.length&&(this.X7=1);break;case 2:1<this.pk.ColumnAxis.length&&(this.X7=2);break;case 4:1<this.pk.FilterAxis.length&&(this.X7=4);break;case 8:1<this.pk.DataAxis.length&&(this.X7=8)}}expandPivotFieldListLevels(Ja){const Kb=
pb.lub(Ja);this.w4b=!0;this.$.userOperationManager.Tc(new Fa.a(146,0,(lc,Dc,Oc)=>{var oa=this.$.pa.va;lc=qa.b(lc,this.CXi);const na=D.L(oa,Ja.wx,Ja.externalSourceIndex,Kb);na.type=1;return D.g(oa,"ExpandPivotFieldListLevels",na,lc,Dc,Oc,null,0)}),null)}o3e(Ja,Kb){var lc;for(let Oc=pb.Lrg;Oc<=pb.Mrg;Oc++){const oa=this.Wva[Oc];for(lc=oa.length-1;0<=lc;lc--){var Dc=oa[lc];if(Dc.PivotCacheIndex===Ja&&(-1===Kb||Dc.PivotTableIndex===Kb))return Ja=this.M4h(Oc),Dc=Dc.PivotTableIndex,{returnValue:!0,axis:Ja,
pos:lc,qQf:Dc}}}return{returnValue:!1,axis:0,pos:-1,qQf:-1}}lCi(Ja){return Ja>=pb.Lrg&&Ja<=pb.Mrg}clear(){this.currentState=va.Q7b();this.refresh()}M4h(Ja){return this.lCi(Ja)?this.wKh[Ja]:0}OKb(Ja,Kb){Ja&&(this.dIa=null);this.refresh();Kb&&(this.Dma?!this.oh&&this.Tt()&&this.Zq()?this.showTaskPane():!this.oh||this.Zq()&&this.Tt()||this.hideTaskPane():this.raiseEvent(pb.Hwb))}QSh(){var Ja=H.h(this.$);let Kb=null;Ja=Ja.getRangeInformation(Ja.ga.qa.activeCell);for(let lc=0,Dc=Ja.length;lc<Dc;++lc){const Oc=
Ja[lc];if(Object(l.a)(ma.PivotTableRange,Oc)){Kb=Oc.pivotTableName;break}}return Kb}nng(Ja){const Kb=H.h(this.$);var lc=Kb.Ca.Ol(Ja);if(lc){if(this.dIa){Ja=lc.ranges;if(!Ja)return;for(lc=Ja.length-1;0<=lc;--lc){var Dc=Ja[lc];if(Object(l.a)(ma.PivotTableRange,Dc)&&rb.a.equals(Dc.pivotTableName,this.dIa,!1)){Ja=this.QSh();Ja&&rb.a.equals(Ja,this.dIa,!1)||(Ja=La.v(Dc.topLeft,this.$),Kb.Bg(Ja,null,null,null,0,"FieldManagerPane.UpdateFieldsPaneStatus"));this.dIa=null;break}}}H.h(this.$).Tr||this.refresh()}else d.ULS.sendTraceTag(537162690,
0,15,`Block ${Ja} was removd from BlockManager`)}qL(){this.clear()}static bYg(Ja,Kb,lc,Dc){let Oc=xa.a(Ja);if(!Oc){const oa=document.getElementById(Ja.Ib+F.a.IZe);oa?Oc=Ja.da.Ha(16,new pb(oa,Ja,Kb,lc,Dc)):d.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null.")}return Oc}static lub(Ja){const Kb={};Kb.AnchorType=Ja.anchorType;7===Ja.anchorType&&(Kb.ChartId=Ja.chartId,Kb.AnchorValue1=Kb.AnchorValue2=-1);return Kb}static eZ(Ja){Ja.request&&(Ea.AFrameworkApplication.Od.gv(Ja.request.xu),
Ja.request=null)}}pb.Hwb="fieldListPaneVisibilityChanged";pb.HZe="FieldListPaneChanging";pb.GZe="FieldListPaneChanged";pb.JZe="FieldManagerRemovePaneEventKey";pb.Lrg=0;pb.Mrg=3;pb.Cij="FieldListReactPaneHeaderId";pb.xij="FieldListReactPaneBodyId";pb.Eij="FieldListReactPaneTitleId";pb.yij="FieldListReactPaneCloseButtonId";pb.Aij=Aa.$Ah;pb.Bij=Aa.ZAh;pb.Dij="cui-taskPaneTitle "+Aa.aBh;pb.wij=Aa.XAh;pb.zij=Aa.YAh;Object(e.a)(pb,"FieldManagerPane",M.a,[825,382,2,339,36]);class mc extends Fb.a{constructor(Ja){super();
this.pzb=()=>Object(nb.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(za.d)(cb.a.resolve(Pa.X,{rb:this.Na})):Ha.GetServiceTaskFactory.Sa(this.$.da,12,477,this.Na);this.$=Ja;this.Mb()}create(){const Ja=Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7079204_pivotTableFieldPanePain")?f.Task.Ua(null):this.pzb(),Kb=Ab.a(this.$),lc=Ub.EwaSettings.Xw()?Object(za.d)(cb.a.resolve(Pa.o,{rb:this.Na})):f.Task.Ua(null),Dc=[Ja,Kb,lc];if(!Qa.a.Md()){const Oc=Ha.GetServiceTaskFactory.create(this.$.da,
203,this.ka,this.Na),oa=Ha.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);Dc.push(Oc);Dc.push(oa)}Ca.TaskExtensions.za(Ca.TaskExtensions.Pd(Dc,this.ka),()=>{const Oc=pb.bYg(this.$,Kb.result,Ja.result,lc.result);Oc&&(Qa.a.Md()||Kb.result.nR(Oc),Oc.u7());this.vb(Oc)},this.ka,3)}dispose(){this.$=null;super.dispose()}static la(Ja){Ja.da.Ha(74,new mc(Ja))}}Object(e.a)(mc,"FieldManagerTaskPaneFactory",Fb.a,[]);var Kc=a(170),Nc=a(84);class pd{constructor(){this.y9b=this.sourceRange=this.rfa=
null}}Object(e.a)(pd,"SelectedRangeForPivot",null,[]);var Vd=a(563),$d=a(198),ue=a(275),he=a(160),Ge=a(187);class Ad{static get dg(){return he.a.Wp(Ad.Goi,Ge.a.ha(66),Ge.a.ha(67),Ge.a.ha(68),Ge.a.ha(69),Ge.a.ha(70),Ge.a.ha(71),Ge.a.ha(72))}}Ad.Goi="<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(e.a)(Ad,"InsertPivotTableDialogHtml",null,[]);var Ie=a(174),me=a(380);class cc{constructor(Ja,Kb){this.y_b=Ja;this.xGg=Kb;this.fvc=null}get textBox(){return this.y_b}get Ycb(){return this.xGg}bindAction(Ja){this.Ycb&&Ja&&(this.fvc=Ja,this.Ycb.fQg(this.fvc))}t3j(){this.Ycb&&this.fvc&&this.Ycb.epj(this.fvc)}isValid(){return!!this.Ycb&&!!this.textBox}}Object(e.a)(cc,"TextBoxRadioButtonPair",null,[875]);var $c=a(899),rd=a(296);class Nd{constructor(Ja,Kb){this.title=Ja;this.dg=Kb}}Object(e.a)(Nd,
"DialogData",null,[]);const ed=(Ja,Kb,lc,Dc,Oc,oa,na,dc=null)=>{dc=Ja.Oa(41,dc);dc.sheetRange=Kb;dc.destinationRange=lc;return D.g(Ja,"InsertPivotTable",dc,Dc,Oc,oa,na,0)},yd=(Ja,Kb,lc,Dc,Oc,oa,na,dc,Rc=null)=>{Rc=Ja.Oa(41,Rc);Rc.activeCell=Kb;Rc.newRange=lc;Rc.isDataSource=Dc;return D.g(Ja,"ChangePivotLocation",Rc,Oc,oa,na,dc,0)},Ed=(Ja,Kb,lc,Dc,Oc,oa,na=null)=>{na=Ja.Oa(1,na);na.activeCell=Kb;return D.g(Ja,"GetDataSourceRangeForPivotTable",na,lc,Dc,Oc,oa,0)};class Ud{constructor(Ja,Kb){this.destinationRange=
this.sourceRange=null;this.sourceRange=Ja;this.destinationRange=Kb}}Object(e.a)(Ud,"MacroRecorderPivotTableCreatedPayload",null,[145]);var fe=a(390),We=a(184),lf=a(250);class Se extends fe.a{constructor(Ja){super(Ja)}o6a(Ja){let Kb,lc=({cmc:Kb}=super.o6a(Ja)).returnValue;if(!lc){const Dc=Object(r.a)(lf.a,this.$.Hb);Dc&&Dc.Ik(Ja)&&(lc=(Ja=Dc.getItemByName(Ja))&&1!==Ja.type?2===Ja.type?We.a(Ja):Ja.usedRange:null,Kb=2===Ja.type)}return{returnValue:lc,cmc:Kb}}}Object(e.a)(Se,"PivotTableRangeHighlightPolicy",
fe.a,[]);class Ae extends ue.a{constructor(Ja,Kb){super(Ja,new Se(Ja));this.B_d=this.destinationRange=this.Mba=this.Nza=this.AUa=null;this.HCa=!1;this.Fv=0;this.sOe="";this.nif=(lc,Dc)=>{this.hide();if(1===lc){let Oc=lc="";2!==this.Fv&&(lc=Ae.YHd(Dc[Ae.KCc],this.$.ua),this.PSj(lc,this.$)&&d.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));1!==this.Fv&&Dc[Ae.Ydd]&&(Oc=Ae.YHd(Dc[Ae.x9b],this.$.ua));2===this.Fv&&Oc===this.sOe||
this.boi(lc,Oc)}else this.vPb(!0,!0),d.ULS.sendTraceTag(537155780,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};this.Su=()=>{this.HRb()};this.drc=()=>{this.destinationRange.disabled=!this.Mba.checked;this.HRb();return!1};this.hFf=()=>{this.HRb();return!1};this.zMf=()=>{this.HRb();return!1};this.IFd=lc=>{if(Ba.a(lc))this.vPb(!0,!0),d.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");else{d.ULS.sendTraceTag(537155743,0,50,
"InsertPivotTableDialog.OnInsertPivotTableDone - success.");const Dc=lc.Result;if(Dc){if(lc=this.$.ua.getItemByName(Dc.SheetName))lc.activate(),this.gridView.Bg(Dc,null,null,null,3,"InsertPivotTableDialog.OnInsertPivotTableDone"),this.vPb(!0,!1),0===this.Fv&&this.GEj(),lc=F.a.tvc,lc!==Ie.a(this.$).Fp.oA&&(Ie.a(this.$).gvc(2),Ie.a(this.$).Fp.activateRibbonTab(lc))}else this.vPb(!0,!1)}};this.gridView=H.h(this.$);this.mR=Vd.a.instance;this.Hx=!1;-1128516639===Kb?(this.Fv=1,d.ULS.sendTraceTag(537155785,
0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):-63037693===Kb?(this.Fv=2,d.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):d.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog")}dispose(){d.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.MFc();super.dispose()}get uc(){return"InsertPivotTableDialog"}get zsb(){return!0}get ODe(){return!0}get NDe(){return!0}Mka(){return new $d.a([Ae.KCc,
Ae.x9b])}kqh(){let Ja=!1;2!==this.Fv&&(Ja=Ae.mqh(this.AUa.value));Ja||1===this.Fv||(Ja=Ae.lqh(this.Mba.checked,this.destinationRange.value));return Ja}get MD(){return()=>{let Ja=this.destinationRange.value;1!==this.Fv&&this.destinationRange.disabled&&(Ja="");this.nif(1,Ae.U6e(this.AUa.value,Ja))}}fic(Ja){d.ULS.sendTraceTag(537155779,0,50,"InsertPivotTableDialog.InitAndShow");const Kb=this.wid();this.dg=Kb.dg;var lc="";2!==this.Fv&&(lc=Ae.YHd(Ja.rfa,this.$.ua));lc=Ae.U6e(lc,Ja.y9b);1!==this.Fv&&2===
this.Fv&&(this.sOe=Ja.y9b);this.vPb(!1,!1);this.initializeAndShow(Kb.title,this.nif,lc);this.oZd();this.SEj();this.HRb();d.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")}PSj(Ja,Kb){let lc=!1;Ja=({cmc:lc}=(new Se(Kb)).o6a(Ja)).returnValue;return!!Ja&&Ja.v6&&!lc}HRb(){this.d1a.disabled=this.kqh()}oZd(){this.mR.ta(m.a.change,this.Nza,this.drc);this.mR.ta(m.a.change,this.Mba,this.drc);this.mR.ta(m.a.Vd,this.AUa,this.zMf);this.mR.ta(m.a.Vd,this.destinationRange,this.hFf);
this.cQg(this.Su);this.HCa=!0}MFc(){this.HCa&&(this.mR.Ba(m.a.change,this.Nza,this.drc),this.mR.Ba(m.a.change,this.Mba,this.drc),this.mR.Ba(m.a.Vd,this.AUa,this.zMf),this.mR.Ba(m.a.Vd,this.destinationRange,this.hFf),this.cpj(this.Su),this.HCa=!1)}SEj(){2===this.Fv?this.destinationRange.focus():this.AUa.focus()}rgg(){const Ja=new rd.a(this.destinationRange),Kb=new $c.a(this.Mba,!1);this.B_d=new cc(Ja,Kb);this.qZd(this.B_d)}jmg(){this.$1d(this.B_d)}Rt(){super.Rt();d.ULS.sendTraceTag(537155777,0,50,
"InsertPivotTableDialog.InitializeDialogElements");this.AUa=document.getElementById(Ae.KCc);this.Nza=document.getElementById(Ae.OAf);this.Mba=document.getElementById(Ae.Ydd);this.destinationRange=document.getElementById(Ae.x9b);switch(this.Fv){case 0:case 2:this.destinationRange.value?Ae.h$f(this.Mba,this.Nza):(this.destinationRange.disabled=!0,Ae.h$f(this.Nza,this.Mba));db.m(this.$.Ue)&&(this.Nza.checked=!1,this.Nza.disabled=!0,this.destinationRange.value="",this.Mba.checked=!0);if(2===this.Fv){this.AUa.disabled=
!0;var Ja=document.getElementById(Ae.qnh);Ja.style.visibility="hidden";Ja.style.display="none"}break;case 1:this.destinationRange.disabled=!0,this.Nza.disabled=!0,this.Mba.disabled=!0,Ja=document.getElementById(Ae.haj),Ja.style.visibility="hidden",Ja.style.display="none"}}boi(Ja,Kb){d.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");const lc=this.$.pa.va;let Dc=1;const Oc=lc.ic(),oa=La.o(H.h(this.$).ga.qa.activeCell,this.$);let na=null,dc=null;switch(this.Fv){case 0:Dc=
132;na=(Rc,Fd,de)=>ed(lc,Ja,Kb,qa.b(Rc,this.IFd),Fd,de,null,Oc);dc=()=>new Ud(Ja,Kb);break;case 2:Dc=219;na=(Rc,Fd,de)=>yd(lc,oa,Kb,!1,qa.b(Rc,this.IFd),Fd,de,null,Oc);break;case 1:Dc=219,na=(Rc,Fd,de)=>yd(lc,oa,Ja,!0,qa.b(Rc,this.IFd),Fd,de,null,Oc)}me.a(this.$.userOperationManager,na,Rc=>new Fa.a(Dc,0,Rc,void 0,dc),null)}wid(){let Ja=0;switch(this.Fv){case 0:Ja=65;break;case 1:Ja=2157;break;case 2:Ja=2153}return new Nd(E.a.instance.ha(Ja),Ad.dg)}GEj(){const Ja=this.$.da.Aa(16);Ja&&Ja.aCc(!1,null,
!0)}vPb(Ja,Kb){const lc=!Ja,Dc=this.$.da.Aa(183);Dc&&Dc.Gcg(lc,Kb);Ja&&this.gridView.Wg&&this.gridView.Wg.Gp(F.a.IV)}set zsb(Ja){super.zsb=Ja}set MD(Ja){super.MD=Ja}static U6e(Ja,Kb){const lc=!Kb;return{[Ae.KCc]:Ja,[Ae.x9b]:Kb,[Ae.OAf]:lc,[Ae.Ydd]:!lc}}static h$f(Ja,Kb){Ja.tabIndex=Ae.lOh;Kb.tabIndex=Ae.YQi}static YHd(Ja,Kb){let lc,Dc;Ja=Ja.startsWith("=")?Ja.substring(1,Ja.length):Ja;({sheetName:lc,range:Dc}=La.ab(Ja,Kb)).returnValue&&Dc&&(lc||(lc=Kb.na.name),Ja=La.x(Dc,lc,!1,!0));return Ja}static mqh(Ja){return rb.a.$q(Ja)}static lqh(Ja,
Kb){return Ja&&rb.a.$q(Kb)}}Ae.gSe="";Ae.lOh=0;Ae.YQi=-1;Ae.KCc="sourceRange";Ae.x9b="destinationRange";Ae.OAf="newWorksheet";Ae.Ydd="existingWorksheet";Ae.qnh="DataSourceDiv";Ae.haj="PivotDestinationDiv";Object(e.a)(Ae,"InsertPivotTableDialog",ue.a,[]);class Qe{constructor(Ja){this.qpd=!1;this.o0a=null;this.$=Ja;this.gridView=H.h(Ja);Nc.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Kb=>{this.o0a=Kb;Kb.isFeatureEnabled(Qe.Agf,!1).then(lc=>this.qpd=lc);Kb.kBa(Qe.Agf,
lc=>{this.qpd=lc.isEnabled})})}Oc(){return!1}executeCommand(Ja,Kb,lc){var Dc;Ja=Ca.TaskExtensions.lk();const Oc=Kb.command;let oa;const na=new Kc.a;Kb=this.gridView.ga.qa;switch(Oc){case 2137617149:Ja=null!==(Dc=lc.Qug)&&void 0!==Dc?Dc:Kb.selectedRanges;this.c6h(Ja,na);if(Qa.a.ymf(this.$)&&this.qpd){const Fd=new Kc.a;na.task.Fo(de=>{lc.SourceSelection=mb.b(de)&&de.result&&de.result.rfa?de.result.rfa:"";return this.$.Xc(-1444574190,0,0,lc).continueWith(ne=>{mb.b(ne)&&ne.result||(oa=new Ae(this.$,Oc),
oa.fic(de.result));Fd.setResult(!0)})});Ja=Fd.task}else oa=new Ae(this.$,Oc),Ja=na.task.continueWith(()=>{oa.fic(na.task.result)});break;case -1128516639:const dc=this.$.pa.va.ic(),Rc=La.o(Kb.activeCell,this.$);Dc=new Fa.a(554,0,(Fd,de,ne)=>Ed(this.$.pa.va,Rc,qa.b(Fd,cf=>{this.RGf(cf,na,!1)}),qa.a(de,()=>{Qe.QGf(na,this.$)}),ne,null,dc),88);Dc.gCa(()=>!0);this.$.userOperationManager.Tc(Dc,null);oa=new Ae(this.$,Oc);Ja=na.task.continueWith(()=>{oa.fic(na.task.result)});break;case -63037693:Dc=new pd;
if(Kb=this.gridView.wb.rp(Kb.activeCell))Kb=Ib.Range.Lc(Kb.I3f+1,Kb.left),Dc.y9b=La.h(Kb,this.$,!0,void 0,!0);na.setResult(Dc);oa=new Ae(this.$,Oc);Ja=na.task.continueWith(()=>{oa.fic(na.task.result)})}return Ja}RGf(Ja,Kb,lc){const Dc=Ja.Result,Oc=new pd;if(lc||Dc){const oa=this.gridView.ga.qa.ph;Ba.a(Ja)?oa&&(Oc.rfa=this.gridView.ga.k$e(!0)):(Oc.rfa=Dc,oa&&lc&&this.awh()&&!this.gridView.wb.mh(this.gridView.ga.qa.gd)&&(Oc.y9b=this.gridView.ga.jhd(!0,!0)))}else if(Ja=this.gridView.wb.rp(this.gridView.ga.qa.activeCell))Oc.rfa=
Ja.dataSource;Kb.setResult(Oc)}awh(){var Ja=this.gridView.ga.qa.activeCell;Ja=new Ib.Range(Ja.top,Ja.left,Ja.top+1,Ja.left+1,!1,!1);Ja=this.gridView.dk("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",Ja);try{for(Ja.$$rst();Ja.$$mn();)if(Ja.$$cu().text)return!1}finally{Ja&&Ja.dispose()}return!0}c6h(Ja,Kb){if(1!==Ja.length)Kb.setResult(Object(qb.a)(new pd,{rfa:""}));else{Ja=Ja[0];const lc=this.gridView.wb.mh(Ja);if(lc)Kb.setResult(Object(qb.a)(new pd,{rfa:lc.name,sourceRange:lc.usedRange}));
else{const Dc=this.$.pa.va.ic(),Oc=La.o(Ja,this.$),oa=La.v(Ja,this.$);Ja=new Fa.a(511,0,(na,dc,Rc)=>{const Fd=de=>de(this.$.pa.va,oa,Oc,qa.b(na,ne=>{this.RGf(ne,Kb,!0)}),qa.a(dc,()=>{Qe.QGf(Kb,this.$)}),Rc,null,Dc);return Ha.GetServiceTaskFactory.Sa(this.$.da,482,483,1).Fo(de=>{mb.b(de)&&Fd(de.result.getExpandedRangeForPivotTable)})},88);Ja.gCa(()=>!0);this.$.userOperationManager.Tc(Ja,null)}}}Ac(Ja,Kb){Ja=!1;switch(Kb.command){case -1128516639:case -63037693:case 2137617149:Ja=!0}return Ja}Vc(){return!1}static QGf(Ja,
Kb){d.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");H.h(Kb).ga.qa.ph?Ja.setResult(Object(qb.a)(new pd,{rfa:H.h(Kb).ga.xja})):Ja.setResult(Object(qb.a)(new pd,{rfa:""}))}}Qe.Agf="ExcelIdeas";Object(e.a)(Qe,"InsertPivotTableCommandHandler",null,[233]);class $e extends Sa.a{constructor(Ja){super(Ja)}Fd(){const Ja=Ha.GetServiceTaskFactory.create(this.$.da,128,this.ka,this.Na);Ca.TaskExtensions.za(Ca.TaskExtensions.Pd([Ja],
this.ka),()=>{this.qd([new Qe(this.$)])},this.ka,3)}static la(Ja){Sa.a.Yd(91,new $e(Ja))}}Object(e.a)($e,"InsertPivotTableCommandHandlerFactory",Sa.a,[]);var of=a(295);class re extends of.a{constructor(Ja,Kb,lc){super(Ja);this.ieg=null;this.Hoi=(Dc,Oc)=>{1===Dc?(Dc=Oc.indices,d.ULS.sendTraceTag(537155741,0,50,`InsertSlicerDialog.ClickedOK: User clicked OK, inserting ${Dc.length} Slicers`),0<Dc.length&&this.zqh(Dc)):d.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};
this.pZi=Dc=>{this.ieg=Dc.Result;Dc={["id"]:this.uc,["singleDimFields"]:this.ieg};this.initializeAndShow(E.a.instance.ha(2154),this.Hoi,Dc)};this.gridView=H.h(Ja);this.qa=this.gridView.ga.qa;this.ga=H.h(Ja).ga;this.pivotTableName=Kb;this.HId=lc;H.h(Ja).wb.rp(this.ga.qa.activeCell);d.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");this.coi()}get uc(){return"InsertSlicerDialog"}zqh(Ja){Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.Sa(this.$.da,103,
104,0),Kb=>{var lc=Kb.result,Dc=H.h(this.$),Oc=lc.uib(Dc);if(Oc){var oa=Oc.re;Kb=oa.Ge.top;oa=oa.Ge.left;lc=Oc.rJ.x;Oc=Oc.rJ.y}else Kb=oa=1,Oc=lc.GMa(Dc),lc=Oc.x,Oc=Oc.y;Dc=0;for(const na of Ja)this.Ioi(parseInt(na,10),Kb,oa,lc+Dc,Oc+Dc),Dc+=22},this.$.ka,8)}Ioi(Ja,Kb,lc,Dc,Oc){const oa=new Fa.a(203,0,(na,dc,Rc)=>{const Fd=this.$.pa.va.ic();return da.t(this.$.pa.va,this.HId,this.pivotTableName,Ja,0,Kb,lc,Dc,Oc,na,dc,Rc,Fd)},void 0,()=>new Pb.a(this.HId,this.pivotTableName,Ja,0));this.$.userOperationManager.Tc(oa,
null)}coi(){const Ja=new Fa.a(596,0,(Kb,lc,Dc)=>{const Oc=this.$.pa.va.ic();return da.j(this.$.pa.va,this.pivotTableName,this.HId,qa.b(Kb,this.pZi),lc,Dc,Oc)},16);this.$.userOperationManager.Tc(Ja,null)}}Object(e.a)(re,"InsertSlicerDialog",of.a,[]);class zf{constructor(Ja){this.activeCell=this.Tb=null;this.$=Ja;this.ga=H.h(this.$).ga}Oc(){return!1}executeCommand(Ja,Kb){Ja=Ca.TaskExtensions.lk();Kb=Kb.command;this.activeCell=this.ga.qa.activeCell;switch(Kb){case -1924368815:(this.Tb=H.h(this.$).wb.rp(this.activeCell))&&
!this.Tb.isOlap&&new re(this.$,this.Tb.pivotTableName,this.$.ua.na.sheetName)}return Ja}Ac(Ja,Kb){Ja=!1;switch(Kb.command){case -1924368815:Ja=!0}return Ja}Vc(){return!1}}Object(e.a)(zf,"InsertSlicerCommandHandler",null,[233]);class Lf extends Sa.a{constructor(Ja){super(Ja)}Fd(){this.qd([new zf(this.$)])}static la(Ja){Sa.a.Yd(353,new Lf(Ja))}}Object(e.a)(Lf,"InsertSlicerCommandHandlerFactory",Sa.a,[]);var Ze=a(83),ec=a(384),Lc=a(561),Da=a(337),Cb=a(35),Zb=a(608),yc=a(61),Vc=a(201),jd=a(126);class ld{constructor(Ja){this.interactiveReportView=
Ja}executeCommand(Ja,Kb){return f.Task.Ua(this.interactiveReportView.refreshSelectedConnection(Kb))}Ac(Ja,Kb){return 32===Ja&&2054778433===Kb.command}Vc(){return!1}Oc(Ja,Kb){return 32===Ja&&(1588554917===Kb||1891435765===Kb||2054778433===Kb&&!this.interactiveReportView.Gyi)}static la(Ja,Kb){Ja.Ia.p3(new ld(Kb))}}Object(e.a)(ld,"InteractiveReportCommandHandler",null,[233]);var Bd=a(138);class Td{constructor(Ja,Kb){this.iframe=document.createElement("iframe");this.iframe.src=Kb;this.iframe.frameBorder=
"0";this.iframe.scrolling="no";this.iframe.id=Ja;this.Wja=Bd.a.instance.ke(this.iframe);this.Wja.la("load",()=>{InteractiveReportAPI.SetHost(this.contentWindow,Kb)})}get Waa(){return this.iframe}get Ehf(){return 1}get contentWindow(){return this.iframe.contentWindow}xTa(){}setVisible(Ja){this.iframe&&this.iframe.style&&(this.iframe.style.visibility=Ja?"visible":"hidden")}dispose(){h.a.Ja(this.Wja);this.Wja=null}}Object(e.a)(Td,"IFrameContentElement",null,[865,2]);class Jd{constructor(Ja){this.x7a=
document.createElement("img");R.DOMElementExtensions.setVisible(this.x7a,!0);this.x7a.setAttribute("style","height: 80%; width: auto");this.k$b=document.createElement("div");this.k$b.id=Ja;this.k$b.appendChild(this.x7a)}get Waa(){return this.k$b}get Ehf(){return 7}get contentWindow(){return null}xTa(Ja){this.x7a&&(this.x7a.src="data:image/png;charset=utf-8;base64,"+Ja,R.DOMElementExtensions.setVisible(this.x7a,!0))}setVisible(Ja){R.DOMElementExtensions.setVisible(this.k$b,Ja)}dispose(){}}Object(e.a)(Jd,
"ImageContentElement",null,[865,2]);class ce{constructor(Ja,Kb,lc,Dc,Oc){this.interactiveReportContent=this.guc=this.JG=null;this.Eif=!1;this.Kaj=()=>{this.interactiveReportView.Fdc(this)};this.$ce=Ja;this.FCg=lc;this.$=Oc;this.JG=Dc?new Jd(Kb):new Td(Kb,lc);this.x_=this.JG.Ehf;this.JVa()}get interactiveReportView(){return this.$ce}get Qxa(){return this.FCg}get Qck(){return this.$.workbookContext.WorkbookUri}get Waa(){return this.JG.Waa}get contentWindow(){return this.JG.contentWindow}xTa(Ja){this.JG.xTa(Ja)}JVa(){this.interactiveReportView.isVisible&&
this.Waa&&this.Waa.style&&(R.DOMElementExtensions.pJ(this.Waa,this.interactiveReportView.domElement.clientHeight),R.DOMElementExtensions.iw(this.Waa,this.interactiveReportView.domElement.clientWidth))}setVisible(Ja){this.JG.setVisible(Ja)}Mwh(){h.a.Ja(this.guc);this.guc=sa.a.instance.create(this.Kaj,2E3,bb.a.ipi)}dispose(){R.DOMElementExtensions.Hf(this.JG.Waa);h.a.wc([this.guc,this.JG]);this.$ce=this.JG=this.guc=null}}Object(e.a)(ce,"InteractiveReportFrameInfo",null,[2]);class ie{constructor(Ja,
Kb){this.DCc=Ja;this.Mbc=Kb}}Object(e.a)(ie,"InteractiveReportSheetData",null,[]);class we{constructor(){this.cEb=this.Sca=this.vDb=!1}}Object(e.a)(we,"SheetVisibilityStateData",null,[]);const zc=(Ja,Kb,lc,Dc,Oc,oa=null)=>{oa=Ja.Oa(1,oa);return D.g(Ja,"GetSessionInformation",oa,Kb,lc,Dc,Oc,4)};var Sc=a(49),td=a(63),Md=a(8),wd=a(42);class Ta extends Da.a{constructor(Ja,Kb,lc,Dc){super(Kb,Ja,!1);this.oj=this.d7d=null;this.cBc=new U.a(!0);this.u4=new U.a(!0);this.fMb=this.l3a=this.Xua=null;this.CSb=
!1;this.hashCode=this.yEb=null;this.iFc=!1;this.HUa=null;this.h$a=wb.a.Ya.kc;this.businessBar=null;this.XR=(Oc,oa)=>{oa&&oa.Result&&(Oc=oa.Result,Oc.DataConnections&&Oc.DataConnections.DataConnections&&this.iXf(Oc.DataConnections))};this.xf=(Oc,oa)=>{switch(oa.hd.block.state){case 1:case 3:case 5:this.ifa(oa)}};this.qn=()=>{};this.Qo=(Oc,oa)=>{this.Vbd();oa.na&&this.isVisible&&this.YEi(!W.j(oa.na));this.clearCache();this.rR=!1};this.VN=Oc=>{switch(Oc.Ju){case 1:this.iFc&&this.Fdc(this.oj)}};this.yd=
(Oc,oa)=>{oa.hW||(this.Vbd(),Oc=this.$,this.Bwb=db.d(Oc.Ue),Oc.ea.VDa.getTime()>this.VDa.getTime()&&(this.b6b(),this.VDa=Oc.ea.VDa),this.zya&&this.Fdc(this.oj))};this.he=()=>{this.GUa(!1)};this.ix=()=>{this.$.ea.Una()};this.onKeyDown=Oc=>{Oc=this.$.shortcutKeyManager.Kt(Oc);this.executeRibbonCommand(Oc)};this.Kk=()=>{this.oj&&this.oj.JVa()};this.B7=()=>{this.ohc();this.iK.Sca=!0};this.A7=()=>{this.iK.vDb||this.iK.cEb||this.CRb();this.iK.Sca=!1};this.LIf=()=>{this.ohc();this.iK.Sca=!0};this.Fy=()=>
{this.iK.vDb||this.iK.cEb||this.CRb();this.iK.Sca=!1};this.VKf=()=>{this.iK.vDb=this.LMb.WK&&this.LMb.Saj;this.iK.vDb?this.ohc():this.iK.Sca||this.iK.cEb||this.CRb()};this.gKf=()=>{switch(Sc.a(this.$).state){case 0:case 1:case 2:case 4:this.iK.vDb||this.iK.Sca||this.CRb();this.iK.cEb=!1;break;case 5:case 3:case 7:case 8:case 6:this.ohc(),this.iK.cEb=!0}};this.IYi=(Oc,oa)=>{if(this.COa(3)||this.zya){var na=Oc.Result;Oc=this.zya;if(null===na||void 0===na?0:na.ReportData)this.fMb=na.ReportData;if(na&&
na.DataConnectionsInfo)if(na=na.DataConnectionsInfo,1===na.DataConnections.length&&na.DataConnections[0].StreamingFailed)this.b6b(),this.GUa(!0);else{var dc=!0;this.l3a=na.DataSources;for(const Rc of na.DataConnections)if(Rc.IsReady||0>Rc.SourceIndex){const Fd=Rc.ConnectionName.toLowerCase();this.u4.getItem(Fd)||this.u4.add(Fd,Rc)}else{oa.Mwh();dc=!1;break}dc&&(Oc?this.iXf(na):(this.oj.x_=4,this.Thb(oa,null)))}else this.oj.x_=1}};this.XZi=Oc=>{Oc&&this.$.ea.qo(Oc.Errors)};this.L7a=new Zb.a(Ja,Ja.ea,
Ja.pa.dl,4,0);this.VDa=Ja.ea.VDa;this.Bwb=!Ja.nc.refreshConfirmationRequired||db.d(Ja.Ue);this.RTe=!1;this.domElement.classList.add(Cb.a.ibc);this.domElement.style.overflow="hidden";this.domElement.tabIndex=0;this.GUa(!1);this.Pc.la("mousedown",this.ix);this.Pc.la("keydown",this.onKeyDown);Ja.ua.PJ(this.Qo);Ja.Hb.PJ(this.Qo);Ja.Hb.kg(this.he);Ja.ua.kg(this.he);Ja.GC(this.Kk);Ja.ub.a2b(this.B7);Ja.ub.$1b(this.A7);Ja.Ia.Lte(this.LIf);Ja.Ia.G_a(this.Fy);Sc.a(Ja).Iq(this.gKf);this.Ca.uu(this.xf);this.Ca.hH(this.qn);
Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Oc=>{Oc.p_c(this.XR)}):Xa.a(Ja).p_c(this.XR);Ja.rl(this.yd);this.vv(this.aAa);Xd.a(Ja).TQ(Md.a.idle).Iq(this.VN);this.LMb=lc;this.LMb.PE(this.VKf);this.iK=new we;this.v4b=Dc;ld.la(Ja,this)}get Ca(){return this.L7a}get Se(){return 32}get Gyi(){if(this.zya){const Ja=this.f$e();return!!Ja&&-1!==Ja.SourceIndex}return!1}get vUj(){this.HUa=this.HUa||new Vc.a;return this.HUa.token}N9a(){return!0}get hwe(){return this.d7d||
(this.d7d=Ta.Lfh(this.$))}get E0b(){return this.$.na.index.toString()}get D0b(){return this.cBc.getItem(this.E0b)}get npi(){if(Ub.EwaSettings.ya(23)){let Ja=Ze.a.aU(this.$.workbookContext.FullDocumentInfo.InteractiveReportsServiceUrl,Ta.tpi,this.$.workbookContext.FullDocumentInfo.WorkbookPath);Ja=Ze.a.aU(Ja,Ta.opi,Ta.ppi);Ja=Ze.a.aU(Ja,Ta.epi,this.$.xa.DataCultureTag);return Ja=Ze.a.aU(Ja,Ta.qpi,this.$.xa.UICultureTag)}return Q.a.current.dA.InteractiveReportServiceUrl}get zya(){return this.COa(5)}dispose(){if(this.$){const Ja=
this.$;Ja.ua.nL(this.Qo);Ja.Hb.nL(this.Qo);Ja.Hb.Gg(this.he);Ja.ua.Gg(this.he);Sc.a(Ja).gr(this.gKf);Ja.gG(this.Kk);Ja.ub.ixc(this.B7);Ja.ub.hxc(this.A7);Ja.Ia.r_f(this.LIf);Ja.Ia.KLb(this.Fy);this.LMb.iG(this.VKf);this.LMb=null}this.L7a&&(this.L7a.Ls(this.xf),this.L7a.KI(this.qn));this.My(this.aAa);Ta.Ula.includes(this)&&Array.remove(Ta.Ula,this);this.clearCache();h.a.wc([this.HUa,this.L7a,this.oj]);this.oj=this.L7a=this.HUa=null;R.DOMElementExtensions.Hf(this.domElement);this.cBc.clear();this.u4.clear();
this.v4b=this.businessBar=this.yEb=this.Xua=this.l3a=this.fMb=null;super.dispose()}refreshSelectedConnection(Ja){const Kb=this.f$e();if(Kb){const lc=Kb.IsEmbedded?-1:Kb.SourceIndex;Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Dc=>{Dc.mL(Kb.ConnectionName,lc,Ja)}):Xa.a(this.$).mL(Kb.ConnectionName,lc,Ja);return!0}return!1}Fdc(Ja){d.ULS.sendTraceTag(537155663,0,15,"InteractiveReportView.GetBootstrapData()");const Kb=
this.$,lc=this.fMb;td.c(Kb)?d.ULS.sendTraceTag(537155662,0,50,"InteractiveReportView.GetBootstrapData: During RenderCachedContent"):Xd.a(Kb).Zh.activityName!==Md.a.idle?this.iFc=!0:(this.iFc=!1,Kb.userOperationManager.Tc(new Fa.a(512,0,(Dc,Oc,oa)=>{var na=Kb.pa.va.ic(),dc=Kb.pa.va;Dc=qa.b(Dc,this.IYi);var Rc=!!lc;na=dc.Oa(1,na);na.connectionsOnly=Rc;return D.g(dc,"GetInteractiveReportBootstrapData",na,Dc,Oc,oa,Ja,0)},64),null))}f$e(){for(let Ja=0;Ja<this.u4.count;++Ja){const Kb=this.u4.mg(Ja);for(const lc of Kb.SlidesIds)if(lc===
this.Xua)return Kb}return null}pMg(Ja,Kb){this.hashCode=this.Ca.sta(Ja,Kb,this.hashCode)}clearCache(){this.Ca.iSa(this.hashCode);this.hashCode=null}ujf(){this.Vbd();const Ja=this.$.na;return this.isVisible=!!Ja&&W.j(Ja)}rNg(){Ta.Ula.includes(this)||Ta.Ula.push(this)}Z5g(){h.a.Ja(this.HUa);this.HUa=null}GUa(Ja){this.ujf()&&(this.rNg(),this.Z5g(),Ca.TaskExtensions.za(this.hwe,()=>{const Kb=6===this.hwe.status;Kb&&!this.RTe&&(this.cpi(),this.RTe=!0);this.ujf()&&(this.gGi(Ja||!Kb),Kb||this.tgj(),this.$.u_||
this.focus())},this.vUj,0))}Vbd(){const Ja=this.$.workbookContext.WorkbookFileVersionId;Ja&&(this.yEb||(this.yEb=Ja),this.yEb!==Ja&&this.b6b())}iXf(Ja){this.l3a=Ja.DataSources;for(const Kb of Ja.DataConnections){Ja=Kb.ConnectionName.toLowerCase();const lc=this.u4.getItem(Ja);lc&&(lc.ConnectionString!==Kb.ConnectionString||new Date(lc.RefreshTimestampUTC)<new Date(Kb.RefreshTimestampUTC))&&(Kb.IsEmbedded&&this.pjj(Kb.SecurityToken),this.Ikj(Kb.DataSourceName),this.u4.remove(Ja));this.u4.add(Ja,Kb)}this.COa(8)&&
this.isVisible&&this.Thb(this.oj,null)}pjj(Ja){if(this.zya){const Kb=Ea.AFrameworkApplication.Od.d$a,lc=this.$.ea.sessionId;try{InteractiveReportAPI.Rebind(this.oj.contentWindow,this.oj.Qxa,this.l3a,Ja,Kb,lc)}catch(Dc){d.ULS.sendTraceTag(537155657,0,10,`RebindInteractiveReport: Failed to call Rebind: ${Dc.message}`)}}}Ikj(Ja){if(this.zya){const Kb=Ea.AFrameworkApplication.Od.d$a,lc=this.$.ea.sessionId;try{InteractiveReportAPI.Refresh(this.oj.contentWindow,this.oj.Qxa,0,Ja,Kb,lc)}catch(Dc){d.ULS.sendTraceTag(537155655,
0,10,`RefreshInteractiveReport: Failed to call Refresh: ${Dc.message}`)}}}ifa(Ja){if(Ja.hd.block.na.active){Ja=Ja.hd.block.me;const Kb=new ie(Ja.SlideId,Ja.FallbackImage);this.cBc.add(this.E0b,Kb);this.oj.interactiveReportContent||(this.oj.interactiveReportContent=Ja);this.Thb(this.oj,Kb)}}YEi(Ja){if(this.zya)try{InteractiveReportAPI.LeaveSlide(this.oj.contentWindow,this.oj.Qxa)}catch(Kb){d.ULS.sendTraceTag(537155651,0,10,`LeaveInteractiveReport(): Failed to call LeaveSlide: ${Kb.message}`)}this.Xua=
null;Ja&&(this.oj.setVisible(!1),this.$.isEditMode&&this.mLd(!0))}b6b(){h.a.Ja(this.oj);this.oj=null;this.u4.clear();this.cBc.clear();this.fMb=this.l3a=this.Xua=null;this.iFc=this.CSb=!1;this.yEb=this.$.workbookContext.WorkbookFileVersionId;this.clearCache()}CRb(){if(this.oj&&this.CSb&&W.j(this.$.na))try{InteractiveReportAPI.UnHideWindowedElements(this.oj.contentWindow,this.oj.Qxa),this.CSb=!1}catch(Ja){d.ULS.sendTraceTag(537155618,0,10,`UnHideInteractiveReport: UnHideWindowedElements failed - ${Ja.message}`)}}ohc(){if(this.oj&&
!this.CSb&&W.j(this.$.na))try{InteractiveReportAPI.HideWindowedElements(this.oj.contentWindow,this.oj.Qxa),this.CSb=!0}catch(Ja){d.ULS.sendTraceTag(537155617,0,10,`HideInteractiveReport: HideWindowedElements failed - ${Ja.message}`)}}gGi(Ja){const Kb=this.$;if(this.oj)this.CRb(),this.oj.JVa(),this.oj.setVisible(!0);else{try{InteractiveReportAPI.ClearState()}catch(oa){}const Dc=this.domElement.id+"_irframe";var lc=document.getElementById(Dc);lc&&this.domElement.removeChild(lc);lc=Kb.nc;Ja=Ja||!(lc.allowFiltering&&
lc.allowSorting&&lc.allowInteractivity);let Oc=this.npi;Oc&&(lc.allowHyperlinks||(Oc+=Ta.gpi),lc.inEmbedView&&(Oc+=Ta.hpi),lc.isBiPreviewOverride&&(Oc+=Ta.dpi));this.oj=new ce(this,Dc,Oc,Ja||!this.Bwb,Kb);this.domElement.appendChild(this.oj.Waa);Ja||this.Bwb||(this.oj.x_=8)}(this.zya||this.COa(1)||this.COa(7))&&this.Thb(this.oj,this.D0b);this.pMg(Kb.na,yc.a.f9b)}eIe(Ja){Ja.x_=2;const Kb=lc=>{Ja.x_=8;lc&&(this.Bwb=!0,this.b6b(),this.GUa(!1))};Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",
!1)?void cb.a.resolve(Pa.o,{rb:1}).then(lc=>{lc.ak(!0,Kb)}):Xa.a(this.$).ak(!0,Kb)}V7i(Ja){var Kb=this.u4.count;const lc=Array(Kb);for(var Dc=0;Dc<Kb;++Dc){var Oc=this.u4.mg(Dc);const oa={};oa.Name=Oc.ConnectionName;oa.Qdk=Oc.ConnectionString;oa.SecurityToken=Oc.SecurityToken;oa.DataSourceName=Oc.DataSourceName;oa.Xdk=0>Oc.SourceIndex&&Oc.IsEmbedded;lc[Dc]=oa}Kb=Ea.AFrameworkApplication.Od.d$a;Dc=this.$.ea.sessionId;Oc=this.D0b.DCc;try{InteractiveReportAPI.OpenReport(Ja.contentWindow,Ja.Qxa,this.fMb,
null,Oc,this.l3a,lc,Ja.Qck,Kb,Dc),this.$.isEditMode&&this.mLd()}catch(oa){d.ULS.sendTraceTag(537155605,0,10,`OnGetBootstrapDataSuccess: Failed to call OpenReport: ${oa.message}`);return}Ja.x_=5;this.Xua=Oc;this.Thb(Ja,null)}Thb(Ja,Kb){switch(Ja.x_){case 6:this.xTa(this.oj,Kb);break;case 1:this.Bwb?(this.Fdc(Ja),Ja.x_=3):this.eIe(Ja);break;case 4:Ja.Eif&&Ja.interactiveReportContent&&this.V7i(Ja);break;case 5:this.YPi(Ja,Kb);break;case 8:this.Y7f(Kb);this.eIe(Ja);break;case 7:this.Y7f(Kb)}}cpi(){try{InteractiveReportAPI.RegisterEvent("Initialized",
Ta.mpi),InteractiveReportAPI.RegisterEvent("UserInteractivity",Ta.rpi),InteractiveReportAPI.RegisterEvent("GetFallbackImage",Ta.jpi),InteractiveReportAPI.RegisterEvent("HostKeyPressed",Ta.lpi),Ub.EwaSettings.ya(33)&&InteractiveReportAPI.RegisterEvent("UserModifiedPV",Ta.fpi)}catch(Ja){}}BSb(Ja){return!!this.oj&&!!this.oj.Waa&&this.oj.contentWindow===Ja}g0i(Ja){this.BSb(Ja)&&(this.oj.Eif=!0,this.COa(5)?this.oj.x_=4:this.COa(6)&&(this.oj.x_=1),this.isVisible&&this.Thb(this.oj,this.D0b))}h0i(Ja){this.isVisible&&
this.BSb(Ja)&&jd.a(wb.a.Ya,this.h$a)>=Ta.nDi&&this.$.ea.jc&&(this.h$a=wb.a.Ya.kc,zc(this.$.pa.va,this.XZi,null,null,null))}e0i(Ja,Kb){if(this.BSb(Ja)){const lc=this.$,Dc=Kb.SessionId;Kb.Rdk&&lc.userOperationManager.Tc(new Fa.a(513,0,(Oc,oa,na)=>{var dc=lc.pa.va.ic(),Rc=lc.pa.va;Oc=qa.b(Oc);dc=Rc.Oa(9,dc);dc.sessionId=Dc;return D.g(Rc,"InteractiveReportDataWasModified",dc,Oc,oa,na,null,0)},64),null)}}B_i(Ja,Kb){if(this.BSb(Ja)&&Kb){Ja=[];Kb.cek&&Ja.push("Control");Kb.dek&&Ja.push("Meta");Kb.bek&&Ja.push("Alt");
Kb.eek&&Ja.push("Shift");const lc=document.createEvent("KeyboardEvent");lc.initKeyboardEvent("keypress",!0,!0,null,String.fromCharCode(Kb.Zdk),0,Ja.join(" "),!1);Kb=new Sys.UI.DomEvent(lc);Kb=this.$.shortcutKeyManager.Kt(Kb);this.executeRibbonCommand(Kb)}}executeRibbonCommand(Ja){1461300262!==Ja&&(Ja=new gb.a(Ja,1,1,6,null),this.$.Ia.Nb(Ja))}f0i(Ja){this.BSb(Ja)&&(this.oj.x_=6,this.xTa(this.oj,this.D0b))}Y7f(Ja){this.isVisible&&Ja&&Ja.Mbc&&this.oj.xTa(Ja.Mbc)}xTa(Ja,Kb){if(this.isVisible&&Kb&&Kb.Mbc)try{InteractiveReportAPI.SetFallbackImage(Ja.contentWindow,
Ja.Qxa,Kb.Mbc)}catch(lc){}}YPi(Ja,Kb){if(this.isVisible){if(Kb&&(!this.Xua||Kb.DCc!==this.Xua)){const lc=Ea.AFrameworkApplication.Od.d$a,Dc=this.$.ea.sessionId;try{this.$.isEditMode&&this.mLd(),InteractiveReportAPI.Navigate(Ja.contentWindow,Ja.Qxa,Kb.DCc,lc,Dc)}catch(Oc){d.ULS.sendTraceTag(537155593,0,10,`NavigateToActiveSheetSlide: Failed to call InteractiveReportApi.Navigate: ${Oc.message}`);return}this.Xua=Kb.DCc}this.uKb(!0)}}COa(Ja){return!!this.oj&&this.oj.x_===Ja}mLd(Ja=!1){this.businessBar?
Ja?this.businessBar.removeEntry(19):this.businessBar.eh(19,null):this.v4b&&Ca.TaskExtensions.za(this.v4b.value,Kb=>{this.businessBar=Kb=Kb.result;this.v4b=null;Ja?Kb.removeEntry(19):Kb.eh(19,null)},this.$.ka)}static lIa(Ja){if(!Ja.da.Aa(36)){const Kb=new Lc.a(()=>Object(nb.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(za.d)(cb.a.resolve(Pa.f,{rb:1})):Ha.GetServiceTaskFactory.Sa(Ja.da,5,4,1)),lc=Ha.GetServiceTaskFactory.create(Ja.da,168,Ja.ka,1);Ca.TaskExtensions.za(lc,()=>{var Dc=
Ja.Df;Dc=new Ta(Ja,Dc.appendChild(Dc.ownerDocument.createElement("div")),lc.result,Kb);Ja.da.Ha(36,Dc)},Ja.ka)}}static fpi(Ja,Kb){Ta.Ula.forEach(lc=>{lc.e0i(Ja,Kb)})}static mpi(Ja){Ta.Ula.forEach(Kb=>{Kb.g0i(Ja)})}static rpi(Ja){Ta.Ula.forEach(Kb=>{Kb.h0i(Ja)})}static jpi(Ja){Ta.Ula.forEach(Kb=>{Kb.f0i(Ja)})}static lpi(Ja,Kb){Ta.Ula.forEach(lc=>{lc.B_i(Ja,Kb)})}static Lfh(Ja){Ja=Ub.EwaSettings.ya(23)?Ta.Xkh(Ja.workbookContext.FullDocumentInfo.InteractiveReportsApiUrl).task:Q.a.loadScript(81,4,1,!0);
return Ca.TaskExtensions.za(Ja,()=>{try{InteractiveReportAPI.InitScript(wd.c,wd.b)}catch(Kb){throw Kb;}},Q.a.ka)}static Xkh(Ja){const Kb=new Kc.a;if(!Ja)return d.ULS.sendTraceTag(537155588,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: interactive report api url is null"),Kb.setException(Error.create("apiUrl is null")),Kb;ec.a.MSe(Ja,(lc,Dc)=>{Dc.succeeded?Kb.setResult(!0):(Kb.setException(Error.create("Network")),d.ULS.sendTraceTag(537155585,0,10,`InteractiveReportView.CreateApiLoadAndInitializeTask: script ${Ja} failed to load successfully`))},
4,!0);return Kb}}Ta.gpi="&EnableHyperlinks=false";Ta.hpi="&EmbeddedView=true";Ta.dpi="&BIPreview=true";Ta.tpi="WORKBOOKURL";Ta.opi="ServiceName";Ta.ppi="ExcelServices";Ta.epi="culture";Ta.qpi="uiculture";Ta.nDi=3E4;Ta.Ula=[];Object(e.a)(Ta,"InteractiveReportView",Da.a,[]);var Vb=a(123),qc=a(1016),Ic=a(215),gd=a(87);class Kd extends Vb.a{constructor(Ja,Kb){super(Ja,Kb)}execute(Ja){const Kb=Object(r.a)(7,Ja.Oe),lc=Q.a.current.dA;Ja.activityState[gd.a.lM]=gd.a.pab;Ja.activityState[gd.a.l3]=Kd.lhh(Kb,
lc.OfferPowerBiTrialUrl,lc.OfferPowerBiTrialCompleteSignUpParameter);Ja.activityState[gd.a.KYc]=!0;Kb.kl.jz("PowerBiTrial");return 3}static lhh(Ja,Kb,lc){Ja=new Sys.StringBuilder(Ja.isEditMode?Ja.workbookContext.FullDocumentInfo.HostEditUrl:Ja.workbookContext.FullDocumentInfo.HostViewUrl);Ic.a.cl(Ja,qc.a.Cfj,"1");Ja=encodeURIComponent(Ja.toString());return`${Kb}&${"ru"}=${lc}${encodeURIComponent(`?${"returnUrl"}=${Ja}`)}`}}Object(e.a)(Kd,"OfferPowerBiTrialActivity",Vb.a,[]);class oe extends Fb.a{constructor(){super();
this.Mb()}create(){this.vb(new Kd(Md.a.FYd,Md.a.m0))}static la(Ja){Ja.da.Ha(79,new oe)}}Object(e.a)(oe,"OfferPowerBiTrialFactory",Fb.a,[]);var Ce=a(1343),ze=a(80),af=a(59),Za=a(598);const Rb=(Ja,Kb,lc,Dc,Oc,oa,na,dc=null)=>{dc=Ja.Oa(41,dc);dc.activeCell=Kb;dc.showDrillInIndicator=lc;return D.g(Ja,"PivotTableShowExpandButton",dc,Dc,Oc,oa,na,0)},rc=(Ja,Kb,lc,Dc,Oc,oa,na=null)=>{na=Ja.Oa(41,na);na.activeCell=Kb;return D.g(Ja,"PivotTableShowDetails",na,lc,Dc,Oc,oa,0)},Jc=(Ja,Kb,lc,Dc,Oc,oa,na,dc,Rc,Fd=
null)=>{Fd=Ja.Oa(41,Fd);Fd.activeCell=Kb;Fd.option=lc;Fd.userInputText=Dc;Fd.userInputInt=Oc;return D.g(Ja,"PivotTableSettingsPaneOperations",Fd,oa,na,dc,Rc,0)};class Sb{constructor(Ja){this.activeCell=this.Tb=null;this.T4i=Kb=>{Ba.a(Kb)||(Kb=this.$.ua.getItemByName(Kb.Result.toString()),Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7288763_FixGarbageSheetNameValueShowDetails")?(null===Kb||void 0===Kb?0:Kb.name)&&Kb.activate():Kb&&Kb.activate(),Kb=document.querySelector(".ewa-stb-tabs .tab-active"),
this.q1j(Kb))};this.HZi=Kb=>{Kb&&!lb.a.lg(Kb.Errors)&&this.Pxd(Kb.Result)};this.GZi=()=>{};this.JZi=Kb=>{Kb&&!lb.a.lg(Kb.Errors)&&this.Qxd(Kb.Result)};this.IZi=()=>{};this.FZi=(Kb,lc)=>{Kb&&!lb.a.lg(Kb.Errors)&&this.Kxd(Kb.Result,lc)};this.EZi=()=>{};this.$=Ja;this.ga=H.h(this.$).ga}Oc(){return!1}executeCommand(Ja,Kb,lc){Ja=Ca.TaskExtensions.lk();const Dc=Kb.command,Oc=this.$.pa.va;let oa=null,na=1;const dc=this.$.pa.va.ic();this.activeCell=La.o(this.ga.qa.activeCell,this.$);this.Tb=H.h(this.$).wb.rp(this.ga.qa.activeCell);
switch(Dc){case 498319061:d.ULS.sendTraceTag(537154699,0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.Tb)return Ja;oa=(Rc,Fd,de)=>Rb(Oc,this.activeCell,!this.Tb.showDrillIndicators,Rc,Fd,de,null,dc);na=218;break;case 1529441790:Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.Sa(this.$.da,441,442,0),Rc=>{(Rc=Rc.result)&&Rc.pPj()},this.$.ka,3);break;case -1556797033:this.Tb&&this.Ikd(this.HZi,this.GZi);break;case -1611233597:this.Tb&&this.Ikd(this.JZi,this.IZi);
break;case 786260386:this.Tb&&(lc=Number.parseInvariant(lc.MenuItemId),this.Ikd(this.FZi,this.EZi,lc));break;case 1771091375:this.showDetails();break;default:Ja=kb.a(Dc)}oa&&(Ja=me.a(this.$.userOperationManager,oa,Rc=>new Fa.a(na,0,Rc,void 0,null),Kb));return Ja}Ac(Ja,Kb){Ja=!1;switch(Kb.command){case 498319061:case 1529441790:case -1556797033:case 786260386:case -1611233597:Ja=!0;break;case 1771091375:Ja=Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return Ja}Vc(){return!1}dispose(){this.$=
null}showDetails(){me.a(this.$.userOperationManager,(Ja,Kb,lc)=>rc(this.$.pa.va,this.activeCell,qa.b(Ja,this.T4i),Kb,lc,null),Ja=>new Fa.a(262,0,Ja,void 0,null),null)}q1j(Ja){const Kb=Nc.a.instance.$b("Common.ISystemInitiatedFeedback");Kb&&Ja?(Kb.execute(lc=>{lc.logActivity("TeachingUIForShowDetails",null)}),d.ULS.sendTraceTag(523613786,0,50,"TeachingUIForShowDetails triggered an LPP activity")):d.ULS.sendTraceTag(523613787,0,15,"TeachingUIForShowDetails failed to get a sifFuture")}Ikd(Ja,Kb,lc=0){this.$.userOperationManager.Tc(new Fa.a(1016,
0,(Dc,Oc,oa)=>D.q(this.$.pa.va,this.activeCell,this.Tb.externalSourceIndex,this.Tb.pivotTableName,this.$.domElement.id,this.$.isChromeRtl,this.$.workbookContext.NovMode,qa.b(Dc,Ja),qa.a(Oc,Kb),oa,0!==lc?lc:null,null,!0),16),null)}Pxd(Ja){if(this.gwd(Ja))if(this.hwd(Ja)){var Kb=Ja.PivotFields[0];if(this.cwd(Kb)){var lc={};lc.FieldId=Kb.IdString;lc.Location=this.activeCell;lc.DataSourceIndex=this.Tb.externalSourceIndex;lc.SelectedFieldIndex=Kb.SortByValueIndex;var Dc=Kb.DisplayString;Dc.length>Ce.n&&
(Dc=Dc.substring(0,Ce.n)+"...");lc.ColumnName=B.a.Jh(Dc);lc.SortAscend=Kb.IsSortedAscending&&Kb.IsSortedByValue;Ja=Object(qb.a)(new Za.a,{pivotName:this.Tb.pivotTableName,TPb:lc,$ua:this.Tka(Ja.PivotDataItems,!1),ava:this.Tka(Ja.PivotDataItems,!0)});this.$.Xc(-1681601147,ze.a.Eb,0,{["launchSortByValueDialogCommandData"]:Ja})}else this.Ij(154,"AutoFilterSortByValueIncorrectSelection")}else this.Ij(750,"SortByValueNoDataFields")}Qxd(Ja){if(this.gwd(Ja))if(this.hwd(Ja)){var Kb=Ja.PivotFields[0];if(this.cwd(Kb)){var lc=
{};lc.FilterType=Ce.e;lc.AdvancedFilter=Ja.AdvancedFiltering;lc.Location=this.activeCell;lc.DataSourceIndex=this.Tb.externalSourceIndex;lc.MaxCount=Ce.a;lc.Title=Kb.DisplayString;lc.IsPivotFilter=!0;lc.FieldId=Kb.IdString;lc.AnchorType=0;(Kb=Kb.FilterParameter)?(lc.Count=0<Kb.FilterValue?Kb.FilterValue.toString():"",lc.Top=Kb.IsTopFilter,lc.Type=Kb.FilterType,lc.SelectedFieldIndex=Ce.g(Ja.PivotDataFields,Kb.DataFieldId)):(lc.Count=Ce.b,lc.Top=!0,lc.Type=1,lc.SelectedFieldIndex=Ce.o);Kb=new gb.a(856841605,
ze.a.Eb,this.$.Bc,0,null);var Dc={};Dc.Top10FilterParameters=lc;Dc.PivotName=this.Tb.pivotTableName;Dc.DataFieldIds=this.Tka(Ja.PivotDataFields,!1);Dc.DataFieldNames=this.Tka(Ja.PivotDataFields,!0);Ja={};Ja[ze.a.$f]=af.a.Fc(Dc);this.$.Ia.Nb(Kb,Ja)}}else this.Ij(246,"ValueFilterNoDataFields")}gwd(Ja){return 1===Ja.PivotFields.length}hwd(Ja){return 0<Ja.PivotDataFields.length&&0<Ja.PivotDataItems.length}cwd(Ja){return!Ja.IsDataField&&!Ja.IsFieldInPageFilterArea}Kxd(Ja,Kb){if(this.gwd(Ja))if(Ce.m(Kb)&&
!this.hwd(Ja))this.Ij(246,"ValueFilterNoDataFields");else{var lc=Ja.PivotFields[0];if(this.cwd(lc)){var Dc=this.aMh(lc.PivotFilterParameters,Kb),Oc={};Oc.ActiveCompareType=this.Ymh(Kb);Oc.ShowDataFields=Ce.m(Kb);Oc.FilterType=this.UZh(Kb);Oc.ValueTypeText=Ce.j(Kb);Oc.Location=this.activeCell;Oc.ColumnName=lc.DisplayString;Oc.IsPivotFilter=!0;Oc.IsTimeSlicer=!1;Oc.NonNumericCaptionFilteringEnabled=lc.IsNonnumericCaptionFilteringEnabled;Oc.FieldId=lc.IdString;Oc.AnchorType=0;Oc.ControlGroupOrder=Ce.h();
Oc.ShowWholeDays=lc.IsDateField&&!Ce.m(Kb);Oc.EnabledWholeDays=lc.IsEnabledWholeDays;Oc.WholeDays=lc.IsWholeDays;Oc.MemberProperties=!1;Oc.SelectedFieldIndex=Ce.o;Dc&&(Ce.m(Kb)||lc.IsDataField?(Oc.Value1=Dc.FilterValue1.toString(),Oc.Value2=Dc.FilterValue2.toString(),Ce.m(Kb)&&(Oc.SelectedFieldIndex=Ce.g(Ja.PivotDataFields,Dc.DataFieldId))):(Oc.Value1=Dc.FilterString1,Oc.Value2=Dc.FilterString2));Kb=new gb.a(-2042011094,ze.a.Eb,this.$.Bc,0,null);Dc={};Dc.CustomFilterParameters=Oc;Dc.FieldId=lc.IdString;
Dc.PivotName=this.Tb.pivotTableName;Dc.DataFieldIds=this.Tka(Ja.PivotDataFields,!1);Dc.DataFieldNames=this.Tka(Ja.PivotDataFields,!0);Ja={};Ja[ze.a.$f]=af.a.Fc(Dc);this.$.Ia.Nb(Kb,Ja)}}}Tka(Ja,Kb){const lc=[];for(let Dc=0;Dc<Ja.length;++Dc)Kb?lc.push(Ja[Dc].DisplayString):lc.push(Ja[Dc].IdString);return lc}Ymh(Ja){switch(Ja){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;
case 13:case 21:case 64:return 9;case 14:case 22:case 27:return 10;case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;case 17:case 25:case 65:return 13}return 14}UZh(Ja){return Ce.j(Ja)?Ce.c:Ce.m(Ja)?Ce.f:Ce.k(Ja)?Ce.d:""}aMh(Ja,Kb){for(let lc=0;lc<Ja.length;++lc)if(Ja[lc].FilterType===Kb)return Ja[lc];return null}Ij(Ja,Kb){Ja=lb.a.nd(1,0,0,Ja,0,0,Kb);Sc.a(this.$).Ij(Ja)}}Object(e.a)(Sb,"PivotCommandHandler",null,[233,2]);class Cc extends Sa.a{constructor(Ja){super(Ja)}Fd(){const Ja=
Ha.GetServiceTaskFactory.create(this.$.da,128,this.ka,this.Na);this.$.Fz(()=>{Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)?Ca.TaskExtensions.za(Ca.TaskExtensions.Pd([Ja],this.ka),()=>{this.qd([new Sb(this.$)])},this.ka,3):this.qd([new Sb(this.$)])})}static la(Ja){Ja.da.Ha(345,new Cc(Ja))}}Object(e.a)(Cc,"PivotCommandHandlerFactory",Sa.a,[]);class cd{constructor(Ja,Kb,lc,Dc,Oc){this.pivotTableName=this.activeCell=null;this.opType=0;this.userInputText=null;
this.userInputInt=0;this.activeCell=Ja;this.pivotTableName=Kb;this.opType=lc;this.userInputText=Dc;this.userInputInt=Oc}getActiveCell(){return this.activeCell}}Object(e.a)(cd,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[145]);class Wd{constructor(){this.rQf=0;this.sQf=null}}Object(e.a)(Wd,"PivotTableSettingsPaneOperationsUserContext",null,[]);class je{constructor(){this.onSettingChange=this.settingsInfo=this.type=null;this.hasLessThanTwoRowFields=this.expandAllByDefault=this.isNativePivotTable=
this.isRangeChanged=!1;this.onSaveSectionCollapseState=this.sectionCollapseStates=null;this.needFocusOnFirstElement=!1}}Object(e.a)(je,"PivotTableSettingsTaskPaneProps",null,[]);class Ee{constructor(Ja,Kb){this.$=Ja;this.pivotTableSettingsPaneManager=Kb}AL(Ja){bc.UISurfaces.Aj().then(Kb=>{Kb.showTaskPane("PivotTableSettingsTaskPane",this.Eu(null,Ja,!1,!1,!1,null,!1));return null})}fC(Ja,Kb,lc,Dc,Oc,oa,na){bc.UISurfaces.Aj().then(dc=>{dc.updateTaskPane("PivotTableSettingsTaskPane",this.Eu(Ja,Kb,lc,
Dc,Oc,oa,na));return null})}HK(){bc.UISurfaces.Aj().then(Ja=>{Ja.hideTaskPane("PivotTableSettingsTaskPane",2);return null})}Eu(Ja,Kb,lc,Dc,Oc,oa,na){Ja=Object(qb.a)(new je,{type:"PivotTableSettingsTaskPaneProps",settingsInfo:Ja,isRangeChanged:lc,isNativePivotTable:Dc,expandAllByDefault:!0,hasLessThanTwoRowFields:Oc,sectionCollapseStates:this.pivotTableSettingsPaneManager.sectionCollapseStates,needFocusOnFirstElement:na,onSaveSectionCollapseState:(dc,Rc)=>{this.pivotTableSettingsPaneManager.onSaveSectionCollapseState(dc,
Rc)},onSettingChange:(dc,Rc,Fd)=>{this.pivotTableSettingsPaneManager.x2i(dc,Rc,Fd,oa)}});if(Qa.a.Md())return Object(qb.a)(new sc.a,{contentProps:Ja,onOpen:()=>{this.pivotTableSettingsPaneManager.CI()},onClose:()=>{this.pivotTableSettingsPaneManager.jx()},onManualClose:()=>{this.pivotTableSettingsPaneManager.gGd()},title:E.a.instance.ha(1078),width:320,enableResize:!0,minResizeWidth:320,maxResizeWidth:900});Kb=Object(qb.a)(new Tb.a,{type:"ExcelLegacyTaskPaneProps",container:Kb,paneProps:Ja});return Object(qb.a)(new sc.a,
{contentProps:Kb,onOpen:()=>{this.pivotTableSettingsPaneManager.CI()}})}}Object(e.a)(Ee,"PivotTableSettingsReactTaskPane",null,[862]);class Ue{constructor(){this.pivotTableName=null;this.rwGrandTotalOn=this.colGrandTotalOn=!1;this.indentIncrement=0;this.displayNullString=this.displayErrorString=this.showItemsWithNoDataOnCol=this.showItemsWithNoDataOnRw=this.showDrillIndicators=this.autoFormatOnUpdate=!1;this.nullString=this.errorString=null;this.refreshOnLoad=this.saveSourceDataWithFile=!1;this.slicerConnections=
this.altTextSummary=this.altText=null}}Object(e.a)(Ue,"PivotTableSettingsInfo",null,[]);class gf{constructor(){this.enabled=!1;this.caption=this.sheet=this.name=null}}Object(e.a)(gf,"SlicerConnectionItem",null,[]);class rf{constructor(Ja){this.auc=this.EJb=this.pivotTableSettingsTaskPane=null;this.oh=!1;this.qea="";this.OAa=!1;this.dSf=0;this.n4=this.foa=this.q8b=this.cSf=null;this.ls=this.fQa=!1;this.y2i=(Kb,lc)=>{if(Ba.a(Kb)){const Dc=Kb.Errors[0].Description;Kb=Kb.Errors[0].MessageId;const Oc=
lc.rQf;lc=lc.sQf;let oa=this.fla();if(!oa||lc!==oa.kea)if(this.foa&&lc===this.foa.kea)oa=this.foa;else{d.ULS.sendTraceTag(537154689,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${Oc}`);return}switch(Oc){case 1:oa.pivotTableName=this.qea;break;case 2:oa.rwGrandTotalOn=this.OAa;break;case 3:oa.colGrandTotalOn=this.OAa;break;case 12:oa.errorString=this.qea;break;case 13:oa.nullString=this.qea;break;case 14:oa.saveSourceDataWithFile=this.OAa;break;case 15:oa.refreshOnLoad=this.OAa;
break;case 16:oa.altText=this.qea;break;case 17:oa.altTextSummary=this.qea;break;case 20:oa.indentIncrement=this.dSf}d.ULS.sendTraceTag(537154688,0,50,`OnPivotTableSettingsChangedSuccessCallback encounters error ${Kb} ${Dc} for opType: ${Oc}`);this.updateTaskPane(this.fla())}};this.nIb=()=>{this.hideTaskPane(!0)};this.yna=()=>{const Kb=this.gridView.inRangePicker||this.gridView.ni||!!(this.ga.Se&470);Qa.a.Md()?(this.Zq()&&!Kb&&this.Img(),this.XGc()):this.oh&&!Kb&&(this.Img(),this.n4!==this.foa&&this.n4&&
this.updateTaskPane(this.fla(),!0))};this.cr=()=>{Qa.a.Md()?(this.Zq()&&(this.n4=this.fla()),this.XGc()):this.oh&&(this.n4=this.fla(),this.updateTaskPane(this.n4))};this.$=Ja;this.gridView=H.h(this.$);this.oni(Ja);this.ga=this.gridView.ga;this.ga.FC(this.yna);this.gridView.OE(this.yna);this.gridView.cU(this.cr);this.gM=Array(6);for(Ja=0;Ja<this.gM.length;Ja++)this.gM[Ja]=!1}get sectionCollapseStates(){return this.gM}get g0a(){return this.$.nc.z3(4128)&&this.h0a}get h0a(){const Ja=new ab.a(this.$.ua);
return this.$.isEditMode&&Ja.Zd(8192)||!Ja.di}pPj(){if(Qa.a.Md())this.oh?(this.ls=!1,this.hideTaskPane(!0)):(this.ls=!0,this.showTaskPane(!0)),this.$.zf();else if(this.pivotTableSettingsTaskPane)this.pivotTableSettingsTaskPane.$g(!this.oh),this.oh?this.hideTaskPane(!0):this.showTaskPane(!0);else{const Ja=Ha.GetServiceTaskFactory.Sa(this.$.da,346,347,0),Kb=Ab.a(this.$);Ca.TaskExtensions.za(Ca.TaskExtensions.Pd([Ja,Kb],this.$.ka),()=>{this.pivotTableSettingsTaskPane=Ja.result;Kb.result.nR(this.pivotTableSettingsTaskPane);
this.u7();this.pivotTableSettingsTaskPane.$g(!0);this.showTaskPane(!0)},this.$.ka,3)}}onSaveSectionCollapseState(Ja,Kb){this.gM&&0<=Ja&&Ja<this.gM.length&&(this.gM[Ja]=Kb)}x2i(Ja,Kb,lc,Dc){let Oc=this.q8b,oa=this.n4;if(!oa||Dc!==oa.kea)if(this.foa&&Dc===this.foa.kea)oa=this.foa,Oc=this.cSf;else{d.ULS.sendTraceTag(537154690,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${Ja}`);return}switch(Ja){case 1:this.qea=oa.pivotTableName;Kb=255<Kb.length?Kb.substring(0,255):Kb;oa.pivotTableName=
Kb;break;case 2:this.OAa=oa.rwGrandTotalOn;oa.rwGrandTotalOn=!!lc;break;case 3:this.OAa=oa.colGrandTotalOn;oa.colGrandTotalOn=!!lc;break;case 6:oa.autoFormatOnUpdate=!!lc;break;case 7:oa.showDrillIndicators=!!lc;break;case 8:oa.showItemsWithNoDataOnRw=!!lc;break;case 9:oa.showItemsWithNoDataOnCol=!!lc;break;case 10:oa.displayErrorString=!!lc;break;case 11:oa.displayNullString=!!lc;break;case 12:this.qea=oa.errorString;oa.errorString=Kb;break;case 13:this.qea=oa.nullString;oa.nullString=Kb;break;case 14:this.OAa=
oa.saveSourceDataWithFile;oa.saveSourceDataWithFile=!!lc;break;case 15:this.OAa=oa.refreshOnLoad;oa.refreshOnLoad=!!lc;break;case 16:this.qea=oa.altText;oa.altText=Kb;break;case 17:this.qea=oa.altTextSummary;oa.altTextSummary=Kb;break;case 20:this.dSf=oa.indentIncrement,oa.indentIncrement=lc}d.ULS.sendTraceTag(595125196,0,50,`OnPivotTableSettingsChanged for opType: ${Ja}`);this.$.userOperationManager.Tc(new Fa.a(225,0,(na,dc,Rc)=>{const Fd=new Wd;Fd.rQf=Ja;Fd.sQf=Dc;return Jc(this.$.pa.va,Oc,Ja,Kb,
lc,qa.b(na,this.y2i),dc,Rc,Fd)},64,()=>new cd(Oc,oa.pivotTableName,Ja,Kb,lc)),null)}oni(Ja){this.EJb=new Ee(Ja,this)}u7(){this.auc=this.pivotTableSettingsTaskPane.HU();this.pivotTableSettingsTaskPane.dU(this.nIb)}dispose(){this.ga.JI(this.yna);this.gridView.hG(this.yna);this.gridView.pO(this.cr);this.$=this.gridView=this.ga=null;this.hideTaskPane();this.pivotTableSettingsTaskPane&&(this.pivotTableSettingsTaskPane.eX(this.nIb),this.pivotTableSettingsTaskPane=this.auc=null);this.gM=this.EJb=null}CI(){this.q8b=
La.o(this.ga.qa.activeCell,this.$);this.n4=this.fla();this.updateTaskPane(this.fla())}jx(){this.hideTaskPane()}gGd(){this.ls=!1;this.hideTaskPane(!0);this.$.zf()}Zq(){return this.g0a&&this.ls}Tt(){const Ja=H.h(this.$).wb.rp(this.ga.qa.activeCell);return!(this.ga.Se&470)&&!!Ja&&!Ja.UOa(!0)&&this.ls}showTaskPane(Ja=!1){Ja&&(this.fQa=!0,d.ULS.sendTraceTag(537154659,0,50,"PivotTable settings pane is opened by the user."));this.oh=!0;this.EJb.AL(this.auc)}updateTaskPane(Ja,Kb=!1){if(this.oh&&Ja&&!Ja.UOa(!0)){var lc=
new Ue;lc.pivotTableName=Ja.xLd;lc.colGrandTotalOn=Ja.colGrandTotalOn;lc.rwGrandTotalOn=Ja.rwGrandTotalOn;lc.indentIncrement=Ja.indentIncrement;lc.autoFormatOnUpdate=Ja.autoFormatOnUpdate;lc.showDrillIndicators=Ja.showDrillIndicators;lc.showItemsWithNoDataOnRw=Ja.showItemsWithNoDataOnRw;lc.showItemsWithNoDataOnCol=Ja.showItemsWithNoDataOnCol;lc.displayErrorString=Ja.displayErrorString;lc.errorString=Ja.errorString;lc.displayNullString=Ja.displayNullString;lc.nullString=Ja.nullString;lc.saveSourceDataWithFile=
Ja.saveSourceDataWithFile;lc.refreshOnLoad=Ja.refreshOnLoad;lc.altText=Ja.altText;lc.altTextSummary=Ja.altTextSummary;lc.slicerConnections=this.PRj(Ja.slicerConnections);this.EJb.fC(lc,this.auc,Kb,!Ja.isOlap,!Ja.tL||2>Ja.tL.length,Ja.kea,this.fQa);this.fQa=!1}}hideTaskPane(Ja=!1){this.oh=!1;this.EJb.HK();Ja&&d.ULS.sendTraceTag(537154658,0,50,"PivotTable settings pane is closed by the user.")}PRj(Ja){const Kb=new $d.a;if(Ja)for(let lc=0;lc<Ja.length;lc++){const Dc=Ja[lc],Oc=new gf;Oc.name=Dc.Name;
Oc.caption=Dc.Caption;Oc.sheet=Dc.WorksheetName;Oc.enabled=Dc.Enabled||!1;Kb.add(Oc)}return Kb.toArray()}fla(){return this.gridView.wb.rp(this.ga.qa.activeCell)}XGc(){this.Zq()&&this.Tt()?this.oh?this.n4!==this.foa&&this.n4&&this.updateTaskPane(this.fla(),!0):this.showTaskPane():this.oh&&this.hideTaskPane()}Img(){this.cSf=this.q8b;this.foa=this.n4;this.q8b=La.o(this.ga.qa.activeCell,this.$);this.n4=this.fla()}}Object(e.a)(rf,"PivotTableSettingsPaneManager",null,[826,2]);class xf extends Fb.a{constructor(Ja){super();
this.$=Ja;this.Mb()}create(){this.vb(this.$.da.Aa(441)||this.$.da.Ha(441,new rf(this.$)))}static la(Ja){Ja.da.Ha(442,new xf(Ja))}}Object(e.a)(xf,"PivotTableSettingsPaneManagerFactory",Fb.a,[]);class Vf{}Vf.MCh="ewa-ptsp-pane";Vf.LCh="ewa-ptsp-header";Vf.NCh="ewa-ptsp-title";Vf.JCh="ewa-ptsp-body";Vf.KCh="ewa-ptsp-close-button";Object(e.a)(Vf,"CssClassNames",null,[]);const Bb=Vf.MCh,ac=Vf.LCh,tc="cui-taskPaneTitle "+Vf.NCh,ub=Vf.JCh,jc=Vf.KCh;class Ka extends M.a{constructor(Ja,Kb,lc){super(Ja);this.hGe=
this.Ie=null;this.gw=0;this.ls=!1;this.Dc=(Dc,Oc)=>{Oc.Sf||this.$g(!1)};this.Cl=()=>{this.$g(!1);this.raiseEvent("PivotTableSettingsTaskPaneClosed");return!0};this.$=Kb;this.taskPaneManager=lc;this.$.wj(this.Dc);this.ga=H.h(this.$).ga;x.a(Kb).ti(this)}eU(Ja){this.get_events().addHandler("PivotTableSettingsTaskPaneRemoved",Ja)}fX(Ja){this.get_events().removeHandler("PivotTableSettingsTaskPaneRemoved",Ja)}dU(Ja){this.addHandler("PivotTableSettingsTaskPaneClosed",Ja)}eX(Ja){this.removeHandler("PivotTableSettingsTaskPaneClosed",
Ja)}get isVisible(){return super.isVisible}set isVisible(Ja){super.isVisible!==Ja&&(super.isVisible=Ja)}get Qf(){return this.isVisible}get je(){return ia.a.qaj}get Uh(){return 14}get tk(){return A.a.AXe}get jR(){return E.a.instance.ha(1078)}get titleText(){return E.a.instance.ha(1078)}get oq(){return 320}get isResizable(){return!0}get rc(){return this.domElement}get height(){return this.taskPaneManager.WO.offsetHeight}get g0a(){return this.$.nc.z3(4128)&&this.h0a}get h0a(){const Ja=new ab.a(this.$.ua);
return this.$.isEditMode&&Ja.Zd(8192)||!Ja.di}Zq(){return this.g0a&&this.ls}Tt(){const Ja=H.h(this.$).wb.rp(this.ga.qa.activeCell);return!(this.ga.Se&470)&&!!Ja&&!Ja.UOa(!0)&&this.ls}BW(){}Bj(){}hk(){}LV(){return!1}dispose(){this.$&&this.$.ll(this.Dc);this.Ie&&(I.a.instance.Ba(m.a.click,this.Ie,this.Cl),wa.KeyInputManager.instance.Cx(this.Ie,this.hGe));this.Ie=this.taskPaneManager=this.$=null;super.dispose()}pg(Ja,Kb){if(!Kb){Ja=R.DOMElementExtensions.getElementById(this.domElement,"PivotTableName");
if(!Ja&&(Ja=R.DOMElementExtensions.Pl(this.domElement.querySelectorAll(R.DOMElementExtensions.Uq)),!Ja))return!1;R.DOMElementExtensions.setFocus(Ja)}return!Kb}Gh(Ja){return R.DOMElementExtensions.Mf(this.rc,Ja)}$g(Ja){this.ls=Ja;const Kb=this.taskPaneManager;this.isVisible=Ja;this.taskPaneManager.eC();const lc=!!this.taskPaneManager.Qh&&14===this.taskPaneManager.Qh.taskPane.Uh;Ja&&0<Kb.iE.length&&(!lc||Kb.isCollapsed)&&Kb.VI(this,!0);this.$.zf()}HU(){const Ja=document.getElementById(this.$.Ib+F.a.GId);
var Kb=this.KM();Ja.appendChild(Kb);Kb=Qd.b("div","PivotTableSettingsPaneBodyId",ub);Ja.appendChild(Kb);return Kb}KM(){const Ja=Qd.b("div","PivotTableSettingsPaneHeaderId",ac),Kb=Qd.b("span","PivotTableSettingsPaneTitleId",tc);Kb.innerText=this.titleText;this.Ie=Z.a.tb("PivotTableSettingsPaneCloseButtonId",jc,E.a.instance.ha(10),"ClosePaneGlyph_16x16x32",!1);this.Ie.classList.add(Ea.AFrameworkApplication.isRtl?F.a.oka:F.a.pka);I.a.instance.ta(m.a.click,this.Ie,this.Cl);this.hGe=wa.KeyInputManager.instance.$t(this.Ie,
this.Cl,fa.a.Wh);Ja.appendChild(Kb);Ja.appendChild(this.Ie);return Ja}static la(Ja,Kb){var lc=Ja.Ib;let Dc=document.getElementById(lc+F.a.GId);Dc||(Dc=document.createElement("div"),Dc.id=Ja.Ib+F.a.GId,Dc.classList.add(Bb),document.getElementById(lc+F.a.vW).appendChild(Dc));lc=Ja.da;return lc.Aa(346)||lc.Ha(346,new Ka(Dc,Ja,Kb))}}Object(e.a)(Ka,"PivotTableSettingsTaskPane",M.a,[827,2,339,36]);class zb extends Fb.a{constructor(Ja){super();this.rh=this.ui=null;this.$=Ja;this.Mb()}get RD(){this.ui||(this.ui=
Ca.TaskExtensions.za(Ab.a(this.$),Ja=>{this.rh=Ka.la(this.$,Ja.result)},this.ka,3));return this.ui}create(){const Ja=Ha.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),Kb=Ha.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);Ca.TaskExtensions.za(Ca.TaskExtensions.ts(Ca.TaskExtensions.Pd([Ja,Kb],this.ka),()=>this.RD,this.ka),()=>{this.vb(this.rh)},this.ka,3)}dispose(){this.rh=this.ui=this.$=null;super.dispose()}static la(Ja){Ja.da.Ha(347,new zb(Ja))}}Object(e.a)(zb,"PivotTableSettingsTaskPaneFactory",
Fb.a,[]);class Yb extends Sa.a{constructor(Ja){super(Ja)}Fd(){Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.create(this.$.da,472,this.ka,this.Na),()=>{const Ja=Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?cb.a.jo(Pa.o):this.$.da.Aa(13);this.qd([Ja])},this.$.ka,3)}static la(Ja){Sa.a.Yd(78,new Yb(Ja))}}Object(e.a)(Yb,"BICommandHandlerFactory",Sa.a,[]);var oc=a(159),Wc=a(660),vd=a(40),Dd=a(850),be=a(328),se=a(366),Oe=a(428);class Me{constructor(Ja,
Kb){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=Ja;this.pivotTableName=Kb}}Object(e.a)(Me,"MacroRecorderPivotTableRefreshedPayload",null,[145]);var Ia=a(403);class Jb extends Ia.a{constructor(Ja,Kb,lc,Dc,Oc=Ia.a.A$c,oa=null){super(Ja,Kb,lc,Dc,Oc,oa)}get vAa(){return 4}get aNb(){return!!(this.flags&64)}}Object(e.a)(Jb,"DepartableRefreshWebMethodOperation",Ia.a,[]);var xc=a(167);class Zc extends xc.ErrorDialog{constructor(Ja,Kb){super(Ja,Zc.YQ(Kb))}vq(){super.vq();this.$pa=String.format(E.a.instance.Va(7),
null)}static YQ(Ja){const Kb=lb.a.nd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");Kb.Description=Ja;Kb.HelpDescription=E.a.instance.ha(1319);Kb.HelpTopicId=Dd.a.G6c;return Kb}}Object(e.a)(Zc,"DataRefreshConfirmationDialog",xc.ErrorDialog,[]);const qd=(Ja,Kb,lc,Dc,Oc,oa,na,dc,Rc)=>{const Fd=dc?"RefreshAllDirtyDataSources":"RefreshAll";Rc=Ja.Oa(1,Rc);const de=Rc.context;de.RequestId=lc;de.CompleteResponseTimeout=Dc;Rc.periodic=Kb;return D.g(Ja,Fd,Rc,Oc,oa,na,dc,Kb?8:0)};var Pd=a(355);Object(cb.b)(Pa.o,
{oI:"singleton"})(Ja=>Object(oc.a)(void 0,void 0,void 0,function*(){const Kb=yield cb.a.resolve(Pa.u,Ja);return Ub.EwaSettings.UCb()?new le(Kb):Kb.da.Aa(13)}));class le extends u.a{constructor(Ja){super();this.Wtc=null;this.ydb=!1;this.$Aa=null;this.CMd=!1;this.Qa=new vd.a;this.Yx=null;this.FGg=new Map;this.nRa=new Map;this.OYb=[];this.Zz=(lc,Dc)=>{2===Dc.er?this.nRa.clear():1===Dc.er&&this.nRa&&this.nRa.forEach((Oc,oa)=>{Dc.Of==Oc&&this.nRa.delete(oa)})};this.spi=lc=>{this.i1c(lc.Ca)};this.d5g=()=>
{this.kUd(0);this.fXf(!0,null,!1)};this.s2i=lc=>{lc.RequestId||(this.kcb=null,this.$.ea.qo(lc.Errors))};this.t2i=lc=>{this.kcb=null;lc=K.a.Ye(lc.data);this.$.ea.qo(lc)};this.AKf=lc=>{this.BKf(lc);(lc.DepartableWebMethodOperationCompleted||lc.Errors&&0<lc.Errors.length)&&this.Qa.raiseEvent("refreshAllCompleted",lc,this)};this.WZi=lc=>{lc&&!Ba.a(lc)&&(!(lc=lc.Result)||1>lc.length||(this.Yx&&this.Yx.cancel(),this.Yx=new Wc.a,this.jkg(lc,0,this.Yx.token)))};this.VZi=lc=>{d.ULS.sendTraceTag(537163298,
306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");lc=K.a.Ye(lc.data);this.$.ea.qo(lc)};this.$c=()=>{this.crd()};this.YF=()=>{Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:6013906_MarkRefreshRangeInvalidWhenCurrentSheetIsChanged")&&this.crd()};this.Oab=(lc,Dc)=>{const Oc=Dc.hd.block;var oa=Oc.me.PeriodicRefreshExpiryInSeconds;void 0!==oa&&this.D9f(oa);oa=H.h(this.$);5===Oc.state&&lc===oa.Ca&&((lc=(lc=oa.hC(Dc.hd.hash))?lc.Ge:null)&&!lc.xd(oa.ga.qa.activeCell)||this.crd())};this.dd=
()=>{this.$.ea.jc||this.clear()};this.$=Ja;this.yId=-1;this.kcb=null;Ja=H.h(this.$);const Kb=Ja.ga;Kb.qM(this.$c);Kb.t3(this.$c);Ja.Ca.R$(this.Oab);this.$.ua.xta(this.YF);this.$.Hb.xta(this.YF);this.$.userOperationManager.tr(this.Zz);this.i1c(Ja.Ca);this.i1c(ib.a(this.$).Ca);this.$.da.kb(36,this.spi);this.$.ea.Zj(this.dd);Ja=this.$.xa.StartupDelayMultiplierForLabelsOnRefreshOnOpen*this.$.xa.TimeToWaitForApplyingSensitivityLabels;d.ULS.sendTraceTag(537163332,306,50,`DataRefreshManager async call to UpdateSensitivityLabels after ${Ja} ms.`);
sa.a.instance.create(()=>{this.IVa()},Ja,bb.a.pnh,!0,!0)}p_c(Ja){this.Qa.addHandler("refreshCompleted",Ja)}NZc(Ja){this.Qa.addHandler("beforeSingleRefreshStarted",Ja)}XNd(Ja){this.Qa.removeHandler("beforeSingleRefreshStarted",Ja)}M_a(Ja){this.Qa.addHandler("singleRefreshCompleted",Ja)}Xdb(Ja){this.Qa.removeHandler("singleRefreshCompleted",Ja)}get Dud(){return!!this.r5()||le.rIe(this.$)||le.Eud(this.$)}get UKb(){return this.OYb}get Mvc(){return this.FGg}get confirmationRequired(){return this.$.nc.refreshConfirmationRequired}Oc(){return!1}executeCommand(Ja,
Kb,lc,Dc){Ja=Kb.command;switch(Ja){case -1193102612:this.fXf(!1,Kb,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===lc.SourceControlId);break;case 2054778433:this.refreshSelected(Kb,Dc);break;default:return kb.a(Ja)}return f.Task.Ua(!0)}Ac(Ja,Kb){Ja=!1;switch(Kb.command){case 2054778433:case -1193102612:Ja=!0}return Ja}Vc(){return!1}dispose(){if(this.$){const Ja=H.h(this.$),Kb=Ja.ga;Kb.jS(this.$c);Kb.Iea(this.$c);this.$.Hb.qBa(this.YF);this.$.ua.qBa(this.YF);this.$.userOperationManager.ro(this.Zz);
Ja.Ca.Ls(this.Oab);Ja.Ca.nSa(this.Oab);ib.a(this.$).Ca.Ls(this.Oab);this.$.da.Aa(36)&&this.$.da.Aa(36).Ca.Ls(this.Oab);this.$.ea&&this.$.ea.xk(this.dd)}this.clear();h.a.wc([this.Wtc,this.Qa]);this.$=this.Qa=null;super.dispose()}F2j(Ja,Kb,lc,Dc){this.$.ea.jc&&this.$.userOperationManager.Tc(new Fa.a(604,0,(Oc,oa,na)=>da.f(this.$.pa.va,Ja,Kb,lc,qa.b(Oc,dc=>{dc=dc.Result;null===dc||""===dc.DataConnectionName||-1===dc.ExternalSourceIndex?this.hXd():this.mL(dc.DataConnectionName,dc.ExternalSourceIndex,
Dc)}),qa.a(oa,dc=>{d.ULS.sendTraceTag(509696077,306,15,"DataRefreshManager::onGetConnectionNameFailure");this.hXd();dc=K.a.Ye(dc.data);this.$.ea.qo(dc)}),na,null,null),80,()=>new Oe.a),null)}mL(Ja,Kb,lc){if(this.$.ea.jc){var Dc=Oc=>{var oa=null;if(this.$Aa&&Object(l.a)(ma.PivotTableRange,this.$Aa)){const na=this.$Aa;oa=()=>new Me(na.kea,na.pivotTableName)}oa=this.$.userOperationManager.Tc(new Jb(50,0,(na,dc,Rc,Fd)=>{var de=this.$.pa.va.ic();de.FlightHolder=this.$.xa.FlightHolder;null==na&&this.Mvc.set(Ja,
de.ClientRequestId);var ne=this.$.pa.va;dc=qa.b(this.x6h(Ja),dc);de=ne.Oa(1,de);const cf=de.context;cf.RequestId=na;cf.CompleteResponseTimeout=2E3;de.connectionName=Ja;de.externalSourceIndex=Kb;de.userAadToken=Oc;return D.g(ne,"Refresh",de,dc,Rc,Fd,null,0)},68,250,oa),lc);this.nRa.set(Ja,oa);this.a5i(Ja)};this.gUi(Ja);if(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)){const Oc=Ha.GetServiceTaskFactory.Sa(this.$.da,470,471,0);Ca.TaskExtensions.za(Oc,
oa=>{oa.result.g5h(Ja).then(na=>{Dc(na)},na=>{d.ULS.sendTraceTag(520680469,0,10,`DataRefreshManager.RefreshConnection: failed to get power query aad token ${na}`)})},this.$.ka,3)}else Dc(null)}}ak(Ja,Kb){var lc=null;if(this.confirmationRequired&&Ja)if(this.ydb)Kb(!0);else if(lc=lc||le.$Li,Ub.EwaSettings.By()){Ja=lb.a.nd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");Ja.Caption=E.a.instance.Va(7);Ja.Description=lc;Ja.HelpDescription=E.a.instance.ha(1319);Ja.HelpTopicId=Dd.a.G6c;const Dc=new Pd.a(this.$,
Ja);Dc.oM(()=>{this.ydb=2===Dc.returnValue;Kb(this.ydb)})}else{const Dc=new Zc(this.$,lc);Dc.oM(()=>{Dc.hide();this.ydb=2===Dc.returnValue;Kb(this.ydb)});Dc.qg()}else Kb(!0)}r5(){if(!this.CMd){var Ja=H.h(this.$);Ja=Ja.getRangeInformation(Ja.ga.qa.activeCell);for(let Kb=0,lc=Ja.length;Kb<lc;++Kb){const Dc=Ja[Kb];if(Object(l.a)(se.a,Dc)){this.$Aa=Dc;break}}this.CMd=!0}return this.$Aa}IVa(){var Ja=this.$.pa.va.ic(),Kb=this.$.pa.va,lc=this.WZi,Dc=this.VZi;Ja=Kb.Oa(1,Ja);D.g(Kb,"GetSensitivityLabelsForPowerBIDatasets",
Ja,lc,Dc,null,null,4)}i1d(Ja){return this.nRa.has(Ja)?(this.$.userOperationManager.fva(this.nRa.get(Ja)),!0):!1}static rIe(Ja){if(Ub.EwaSettings.ya(123)){var Kb=Ja.nc;if(!Kb||Kb.inEmbedView||Kb.inWebPart||Kb.inViewerFromWebPart)return!1;Ja=H.h(Ja);Kb=Ja.ga.qa.selectedRanges;for(let lc=0;lc<Kb.length;lc++)if(Ja.wb.xlc(Kb[lc]))return!0}return!1}hXd(){const Ja=lb.a.nd(1,0,0,1503,0,-853845742,"ErrorConnectingToDataSource");Sc.a(this.$).fu([Ja])}fXf(Ja,Kb,lc){if(this.$.ea.jc){this.ynj();if(0<this.$.workbookContext.LegacyConnections.length){const Dc=
lb.a.nd(32,2,1649,1662,0,-73730134,"BB_LegacyConnectionsWarning");Dc.HelpDescription=E.a.instance.ha(1644);Dc.HelpTopicId=be.a.dFi;const Oc=Object(nb.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(za.d)(cb.a.resolve(Pa.f,{rb:0})):Ha.GetServiceTaskFactory.Sa(this.$.da,5,4,0);Ca.TaskExtensions.za(Oc,()=>{const oa=Oc.result;oa&&oa.eh(33,Dc)},this.$.ka,3)}Ja?(Ja=this.$.pa.va.ic(),this.kcb=qd(this.$.pa.va,!0,null,0,qa.b(this.s2i,this.AKf),this.t2i,null,null,Ja)):this.$.userOperationManager.Tc(new Jb(51,
0,(Dc,Oc,oa,na)=>{const dc=this.$.pa.va.ic();dc.FlightHolder=this.$.xa.FlightHolder;let Rc=null;lc&&(Rc={});return qd(this.$.pa.va,!1,Dc,2E3,qa.b(this.AKf,Oc),oa,na,Rc,dc)},68,250,()=>new Oe.a),Kb)}}refreshSelected(Ja,Kb){if(this.$.ea.jc&&W.i(this.$.na)&&!this.MBb()){var lc=this.r5();if(!le.rIe(this.$)||lc&&Object(l.a)(ma.PivotTableRange,lc))lc?this.mL(this.$Aa.xch,this.$Aa.externalSourceIndex,Ja):Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIQueryTablesRefreshSelectedEnabled",
!1)&&H.h(this.$).ga.qa.qjf()?this.F2j(this.$.ua.na.sheetName,this.$.ua.na.activeCell.top-1,this.$.ua.na.activeCell.left-1,Ja):this.hXd();else{let Dc;Ja=Ha.GetServiceTaskFactory.Sa(this.$.da,271,272,Kb.EV());Ca.TaskExtensions.za(Ja,Oc=>{(Dc=Oc.result)&&Dc.refreshLinkedEntitiesInRange()},this.$.ka,3)}}}clear(){this.kUd(0);this.ydb=!1;this.yId=-1;le.PRc=null;this.kcb&&(Ea.AFrameworkApplication.Od.gv(this.kcb.xu),this.kcb=null)}static Eud(Ja){var Kb=!1;Ja=H.h(Ja).ga;2===Ja.Se&&(Kb=Ja.Ra.oc,Ja=(null===
Kb||void 0===Kb?0:Kb.floatingObject)?Kb.floatingObject.jd:null,Kb=Kb.vx&&!!Ja&&!!(Ja.Attributes&4));return Kb}MBb(){return 2===H.h(this.$).ga.Se}crd(){this.CMd=!1;this.$Aa=null}kUd(Ja){let Kb=0<Ja;!Kb||this.$.ea.jc&&this.$.nc.allowPeriodicDataRefresh||(Kb=!1);h.a.Ja(this.Wtc);this.Wtc=null;Kb&&(this.Wtc=sa.a.instance.cD(this.d5g,Ja,bb.a.nnh))}BKf(Ja){Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:6837645_SensitivityLabelOnRefreshCompleted")?Ja.RequestId||(this.Qa.raiseEvent("refreshCompleted",Ja,this),
this.IVa()):(Ja.RequestId||this.Qa.raiseEvent("refreshCompleted",Ja,this),this.IVa())}x6h(Ja){return Kb=>{var lc;this.BKf(Kb);Kb&&(Kb.DepartableWebMethodOperationCompleted||Kb.Errors&&0<Kb.Errors.length)&&(Array.remove(this.OYb,Ja),Kb.Result=null!==(lc=Kb.Result)&&void 0!==lc?lc:{},Kb.Result.ConnectionName=Ja,this.Qa.raiseEvent("singleRefreshCompleted",Kb,this))}}gUi(Ja){this.Qa.raiseEvent("beforeSingleRefreshStarted",Ja,this)}a5i(Ja){this.OYb.includes(Ja)||this.OYb.push(Ja);this.Qa.raiseEvent("singleRefreshStarted",
Ja,this)}jkg(Ja,Kb,lc){const Dc=Ha.GetServiceTaskFactory.Sa(this.$.da,274,275,0);let Oc=!1;lc.nN?d.ULS.sendTraceTag(537163297,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):Ca.TaskExtensions.za(Dc,()=>{if(({r8a:Oc}=Dc.result.z1c(Ja,Oc)).returnValue)d.ULS.sendTraceTag(537163293,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the ${Kb} attempt.`);else if(Oc&&3>Kb)if(lc.nN)d.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");
else{var oa=this.$.xa.TimeToWaitForApplyingSensitivityLabels;d.ULS.sendTraceTag(537163295,306,100,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after ${oa} ms on the ${oa} attempt.`);sa.a.instance.create(()=>{this.jkg(Ja,Kb+1,lc)},oa,bb.a.onh,!0,!0)}else d.ULS.sendTraceTag(537163294,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the ${Kb} attempt.  Not scheduling anymore retries.`)},
lc,3)}i1c(Ja){Ja.uu(this.Oab);Ja=Ja.N$i;0<Ja&&this.D9f(Ja)}D9f(Ja){const Kb=this.$.ea.Ee;Kb>this.yId&&(this.yId=Kb,this.kUd(1E3*Ja))}ynj(){const Ja=Object(nb.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(za.d)(cb.a.resolve(Pa.f,{rb:0})):Ha.GetServiceTaskFactory.Sa(this.$.da,5,4,0);Ca.TaskExtensions.za(Ja,()=>{const Kb=Ja.result;Kb&&Kb.hma(58)&&Kb.removeEntry(58)},this.$.ka,3)}static get $Li(){return le.PRc||(le.PRc=E.a.instance.Va(8)+"<br /><br />"+E.a.instance.Va(10))}static la(Ja){Ja.da.Ha(13,
new le(Ja))}}le.PRc=null;Object(e.a)(le,"DataRefreshManager",u.a,[14,233]);class ke extends Sa.a{constructor(Ja){super(Ja)}Fd(){Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.Sa(this.$.da,470,471,this.Na),Ja=>{this.qd([Ja.result])},this.$.ka,3)}static la(Ja){Sa.a.Yd(472,new ke(Ja))}}Object(e.a)(ke,"PowerQueryManagerCommandHandlerFactory",Sa.a,[]);var jf=a(143);const nf=(Ja,Kb,lc,Dc,Oc,oa,na,dc=null)=>{dc=Ja.Oa(1,dc);dc.groupOperation=Kb;dc.groupOperationPayload=lc;return D.g(Ja,"EditPowerQueryGroup",
dc,Dc,Oc,oa,na,0)},pe=(Ja,Kb,lc,Dc,Oc,oa,na,dc=null)=>{dc=Ja.Oa(1,dc);dc.queryAction=Kb;dc.queryActionPayload=lc;return D.g(Ja,"PowerQueryQueryAction",dc,Dc,Oc,oa,na,0)},Re=(Ja,Kb,lc,Dc,Oc,oa,na,dc=null)=>{dc=Ja.Oa(1,dc);dc.powerQueryDataSourceConnections=Kb;dc.operationType=lc;return D.g(Ja,"WritePowerQueryRoaming",dc,Dc,Oc,oa,na,4)};var bf=a(900);class Pf{constructor(Ja,Kb,lc){this.U6b=this.stateId=0;this.TMe=!1;this.Jbe=null;this.lee=!1;this.wbe=null;this.jIe=Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",
!1);this.RKb=Dc=>{if(this.ylc(Dc)&&this.E5g(Dc)&&this.XD.nb(Dc))if(!this.$.xa.DocumentHostInfo.AADUserObjectId&&0!==rb.a.compare(this.$.xa.DocumentHostInfo.HostTier,"TestHost",!0)&&Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1))this.tPj();else if(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryCleanRoamingOnRefresh",!1))Re(this.$.pa.va,[],0,()=>{d.ULS.sendTraceTag(509682770,0,100,"PowerQueryManager:WriteRoaming ClearAllConnections: succeeded");
const Oc=this.XD.getItem(Dc);Ub.EwaSettings.Xw()?this.Ev.mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null):Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(oa=>{oa.mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null)}):Xa.a(this.$).mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null)},()=>{d.ULS.sendTraceTag(509682769,0,100,"PowerQueryManager:WriteRoaming ClearAllConnections: Failed");const Oc=this.XD.getItem(Dc);Ub.EwaSettings.Xw()?
this.Ev.mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null):Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(oa=>{oa.mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null)}):Xa.a(this.$).mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null)},null,null);else{const Oc=this.XD.getItem(Dc);Ub.EwaSettings.Xw()?this.Ev.mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null):Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",
!1)?void cb.a.resolve(Pa.o,{rb:1}).then(oa=>{oa.mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null)}):Xa.a(this.$).mL(Oc.ConnectionName,Oc.ExternalSourceIndex,null)}};this.lli=()=>{const Dc=document.createElement("div");Dc.id=this.$.Ib+"PowerQueryMashupClientId";this.$.Qp.appendChild(Dc);appChrome.initPowerQueryMashupClient(Dc,this.whd,this.$.xa.UICultureTag,this.$.xa.UserSessionId,this.$.xa.PowerQueryHostContextType,this.$.xa.PowerQueryEndpointUrl).finally(()=>{this.$.Qp.removeChild(Dc)})};this.tPj=
()=>{let Dc=lb.a.nd(32,1,2216,0,0,1580811823,"powerQueryRefreshHostNotSupported");Dc.HelpTopicId=be.a.Lkj;void cb.a.resolve(Pa.f,{rb:0}).then(Oc=>{Oc.eh(67,Dc)})};this.k9e=Dc=>this.queries.find(Oc=>Oc.Name===Dc);this.hKf=(Dc,Oc)=>{Dc=this.k9e(2===Dc?Oc.ExtraData:Oc.Name);this.Xxf(Dc,-1)};this.Xxf=(Dc,Oc)=>{Dc&&(Dc.CurrentRunningOperation=Oc)};this.Gf=()=>{const Dc=this.$.ea.jn.PowerQueryStateId,Oc=this.$.ea.jn.ConnectionsStateId;d.ULS.sendTraceTag(537154444,0,50,`PowerQueryManager.OnWorkbookMetadataChanged: powerQueryStateId: ${Dc}, this.stateId: ${this.stateId}. connectionsStateId: ${Oc}, this.connectionsStateId: ${this.U6b}`);
Dc>this.stateId&&this.dka().continueWith(oa=>{oa.result?this.stateId=Dc:d.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")});this.jIe&&Oc>this.U6b&&this.Ced().continueWith(oa=>{oa.result?this.U6b=Oc:d.ULS.sendTraceTag(509371268,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local legacy connections state")})};this.So=()=>{this.dka();this.Ced()};this.Lng=Dc=>{if(Dc&&!Ba.a(Dc)){Dc=Dc.Result;if(Dc.Queries){const oa=
this.queries.filter(na=>-1!==na.CurrentRunningOperation);this.Vcb.clear();for(const na of Dc.Queries)try{var Oc=oa.find(dc=>dc.Name===na.Name);Oc&&(na.CurrentRunningOperation=Oc.CurrentRunningOperation);this.Vcb.add(na.Name,na)}catch(dc){d.ULS.sendTraceTag(523534750,0,10,"PowerQueryManager.OnGetQueriesSuccess: more than one query with the same name in queryInfo.")}}this.Jbe=Dc.QueryGroups;d.ULS.sendTraceTag(537154441,0,50,`PowerQueryManager.OnGetQueriesSuccess: no. queries: ${this.queries?this.queries.length.toString():
"null"}`);if(Dc.PowerQueryConnectionsInfo){this.XD.clear();Oc=[];for(const oa of Dc.PowerQueryConnectionsInfo)try{this.XD.add(oa.QueryName,oa)}catch(na){d.ULS.sendTraceTag(523534749,0,10,"PowerQueryManager.OnGetQueriesSuccess: same query with more than one connection."),Oc.push(oa.QueryName)}Oc.forEach(oa=>{this.XD.remove(oa)})}this.wbe=Dc.Formulas;this.TMe=!0}};this.Hng=Dc=>{if(Dc&&!Ba.a(Dc)){Dc=Dc.Result;if(Dc.LegacyConnections){this.Yxd.clear();for(const Oc of Dc.LegacyConnections)try{this.Yxd.add(Oc.Name,
Oc)}catch(oa){d.ULS.sendTraceTag(509696094,0,10,"PowerQueryManager.OnGetLegacyConnectionsSuccess: more than one legacy connection with the same name in LegacyConnections.")}}d.ULS.sendTraceTag(509696093,0,50,`PowerQueryManager.OnGetLegacyConnectionsSuccess: Legacy connections: ${this.mda?this.mda.length.toString():"null"}`)}};this.zrc=()=>{d.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.aHf=()=>{d.ULS.sendTraceTag(509696092,0,15,"PowerQueryManager.OnGetLegacyConnectionsFailure")};
this.Wsc=Dc=>{this.Qa.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",Dc);Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebRefreshOnOpen",!1)&&this.xMd(Oc=>Oc.IsPendingRefresh)};this.oNf=Dc=>{this.Qa.raiseEvent("OnUpdatePowerQueryDataFailed",Dc)};this.qNf=Dc=>{this.Qa.raiseEvent("OnUpdatePowerQueryLegacyConnectionsSucceeded",Dc)};this.pNf=Dc=>{this.Qa.raiseEvent("OnUpdatePowerQueryLegacyConnectionsFailed",Dc)};this.XR=(Dc,Oc)=>{if(Oc&&Oc.Result&&!(Oc.Errors&&0<Oc.Errors.length)&&
Oc.Result.PowerQueryRefreshChallengeResult){if(!Oc.Result.ConnectionName)throw Error.argumentNull;this.$.Ia.Nb(new gb.a(-1496653501,0,this.$.Bc,8,null),{["kind"]:Oc.Result.PowerQueryRefreshChallengeResult.Kind,["path"]:Oc.Result.PowerQueryRefreshChallengeResult.Path,["queryName"]:this.l9e(Oc.Result.ConnectionName)})}};this.whd=Dc=>{d.ULS.sendTraceTag(520734801,0,50,"PowerQueryManager:GetToken: Token requested for PQO service");try{return this.kHb.JL("PowerQueryWeb",null!==Dc&&void 0!==Dc?Dc:this.$.xa.PowerQueryAudienceUri).then(Oc=>
{if(Oc.IsSuccess)return d.ULS.sendTraceTag(520734800,0,20,"PowerQueryManager.getAuthToken: successfully fetch token."),Oc.Token;d.ULS.sendTraceTag(520734799,0,15,`PowerQueryManager.getAuthToken: failed to get token. Error code: ${Oc.ErrorCode}, Error message : ${Oc.ErrorMessage}`);return Promise.resolve(null)},()=>{d.ULS.sendTraceTag(520734798,0,15,"PowerQueryManager.getAuthToken: got rejected promise, use fallback value");return Promise.resolve(null)})}catch(Oc){return d.ULS.sendTraceTag(520734797,
0,10,`PowerQueryManager.getAuthToken: Exception thrown when fetching token, Exception: ${Oc}`),Promise.resolve(null)}};this.$=Ja;this.kHb=Kb;this.Ev=lc;this.Vcb=new U.a(!1);this.Yxd=new U.a(!1);this.tGg=new U.a(!1);this.Qa=new vd.a;this.$.ea.vu(this.Gf);this.$.ea.pM(this.So);this.$.ea.jn&&(this.stateId=this.$.ea.jn.PowerQueryStateId,this.U6b=this.$.ea.jn.ConnectionsStateId);Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&(Ub.EwaSettings.Xw()?this.Ev.M_a(this.XR):
Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Dc=>{Dc.M_a(this.XR)}):Xa.a(this.$).M_a(this.XR),Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7597596_InitPowerQueryClientOnDemandv2")&&this.$.Fz(Dc=>{void Dc.k5(1).then(this.lli)}));Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebRefreshOnOpen",!1)&&this.dka();Nc.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Dc=>
{Dc.isFeatureEnabled("ExcelPowerQuery",!1).then(Oc=>{this.lee=Oc;return null})})}get Lxi(){return this.lee}get queries(){return this.Vcb.values}get groups(){return this.Jbe}get mda(){return this.Yxd.values}get formulas(){return this.wbe}get XD(){return this.tGg}pTg(Ja){this.Qa.addHandler("OnUpdatePowerQueryDataKeySucceeded",Ja)}Irj(Ja){this.Qa.removeHandler("OnUpdatePowerQueryDataKeySucceeded",Ja)}qTg(Ja){this.Qa.addHandler("OnUpdatePowerQueryLegacyConnectionsSucceeded",Ja)}Jrj(Ja){this.Qa.removeHandler("OnUpdatePowerQueryLegacyConnectionsSucceeded",
Ja)}ylc(Ja){if(this.Vcb.nb(Ja)){const Kb=this.Vcb.getItem(Ja);if(1!==Kb.FillObjectType&&!Kb.LoadedToDataModel&&this.XD.nb(Ja))return!0}else d.ULS.sendTraceTag(537154446,0,10,"Query not present in the queryNameToQueryInfo dictionary");return!1}dka(){const Ja=new Kc.a;Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7597823_PowerQueryManagerSendProxyRequests")?bf.d(this.$.pa.va,qa.b(this.Lng,this.Wsc,()=>{Ja.setResult(!0)}),qa.a(this.zrc,this.oNf,()=>{Ja.setResult(!0)}),null,null):this.$.userOperationManager.Tc(new Fa.a(587,
0,(Kb,lc,Dc)=>bf.d(this.$.pa.va,qa.b(Kb,this.Lng,this.Wsc,()=>{Ja.setResult(!0)}),qa.a(lc,this.zrc,this.oNf,()=>{Ja.setResult(!0)}),Dc,null),80,()=>new Oe.a),null);return Ja.task}Ced(){const Ja=new Kc.a;if(!this.jIe)return Ja.setResult(!1),Ja.task;Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7597823_PowerQueryManagerSendProxyRequests")?bf.b(this.$.pa.va,qa.b(this.Hng,this.qNf,()=>{Ja.setResult(!0)}),qa.a(this.aHf,this.pNf,()=>{Ja.setResult(!0)}),null,null):this.$.userOperationManager.Tc(new Fa.a(603,
0,(Kb,lc,Dc)=>bf.b(this.$.pa.va,qa.b(Kb,this.Hng,this.qNf,()=>{Ja.setResult(!0)}),qa.a(lc,this.aHf,this.pNf,()=>{Ja.setResult(!0)}),Dc,null),80,()=>new Oe.a),null);return Ja.task}hDe(Ja){if(this.XD.nb(Ja)){Ja=this.XD.getItem(Ja).ConnectionName;const Kb=Ub.EwaSettings.Xw()?this.Ev.Mvc:Xa.a(this.$).Mvc;if(Kb&&Kb.has(Ja))d.ULS.sendTraceTag(525342226,0,50,"PowerQueryManager.cancelRefreshQuery: sending cancellation request"),Ja=Kb.get(Ja),D.h(this.$.pa.va,Ja,null,null,null);else if(Ub.EwaSettings.Xw()?
!this.Ev.i1d(Ja):!Xa.a(this.$).i1d(Ja))return d.ULS.sendTraceTag(525342225,0,15,"PowerQueryManager.cancelRefreshQuery: cannot find canceled connection on running requests map"),!1}return!0}handleQueryGroupOperation(Ja,Kb){this.cyh(Ja,Kb);this.$.userOperationManager.Tc(new Fa.a(1023,0,(lc,Dc,Oc)=>nf(this.$.pa.va,Ja,Kb,qa.b(oa=>{0<oa.Errors.length&&this.dka()},lc),qa.a(()=>{this.dka()},Dc),Oc,null),4),null)}cyh(Ja,Kb){let lc=this.groups.find(Dc=>Dc.Id===Kb.Id);if(lc){switch(Ja){case 3:this.hyh(Kb,lc);
break;case 2:this.ayh(Kb);break;case 4:this.eyh(Kb,lc);break;default:return}this.Wsc(void 0,void 0,void 0)}else d.ULS.sendTraceTag(509752481,0,10,"PowerQueryManager.estimateGroupOperation: Group not found")}hyh(Ja,Kb){Kb.Name=Ja.Name}ayh(Ja){let Kb=this.groups.findIndex(lc=>lc.Id===Ja.Id);-1===Kb?d.ULS.sendTraceTag(509752480,0,10,"PowerQueryManager.estimateDeleteGroup: Group index not found"):this.groups.splice(Kb,1)}eyh(Ja,Kb){const lc=Ja.ParentId?Ja.ParentId:"{00000000-0000-0000-0000-000000000000}";
let Dc=-1;this.groups.forEach(Oc=>{Oc.ParentId===lc&&Oc.Order>Dc&&(Dc=Oc.Order)});Kb.ParentId=lc;Kb.Order=Dc+1}handleQueryAction(Ja,Kb){const lc=()=>{this.gyh(Ja,Kb);this.kUj(Ja,Kb)};Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7671632_ConfirmationDialogBeforeDeleteQuery")&&1===Ja?this.mai(E.a.instance.ha(2289),String.format(E.a.instance.qb(215),Kb.Name),lc):lc()}mai(Ja,Kb,lc){const Dc=new jf.StandardDialog;Dc.Xb=11;Dc.yc(1,E.a.instance.ha(2290));Dc.yc(2,E.a.instance.ha(5));Dc.Tl(Ja,Kb,1,Oc=>{1===
Oc&&lc()})}kUj(Ja,Kb){this.$.userOperationManager.Tc(new Fa.a(1023,0,(lc,Dc,Oc)=>pe(this.$.pa.va,Ja,Kb,qa.b(oa=>{this.hKf(Ja,Kb);0<oa.Errors.length&&this.dka()},lc),qa.a(()=>{this.hKf(Ja,Kb);this.dka()},Dc),Oc,null),68),null)}gyh(Ja,Kb){const lc=this.k9e(Kb.Name);this.Xxf(lc,Ja);switch(Ja){case 2:this.iyh(lc,Kb);break;case 1:this.byh(lc);break;default:return}this.Wsc(void 0,void 0,void 0)}byh(Ja){Ja.IsDeleting=!0}iyh(Ja,Kb){Ja.Name=Kb.ExtraData;Ja.LoadedToDataModel||((Ja=this.XD.getItem(Kb.Name))?
(Ja.ConnectionName="Query - "+Kb.ExtraData,Ja.QueryName=Kb.ExtraData,this.XD.remove(Kb.Name),this.XD.add(Kb.ExtraData,Ja)):d.ULS.sendTraceTag(512492568,0,10,"PowerQueryManager.estimateRenameQuery: Connection info not found"))}Vc(){return!1}Oc(){return!1}executeCommand(Ja,Kb){Ja=Ca.TaskExtensions.lk();return-1193102612===Kb.command?(this.ykj(),Ja):kb.a(Kb.command)}Ac(Ja,Kb){switch(Kb.command){case -1193102612:return!0}return!1}g5h(Ja){return this.l9e(Ja)?this.whd():Promise.resolve(null)}dispose(){h.a.wc([this.Qa]);
Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&(Ub.EwaSettings.Xw()?this.Ev.Xdb(this.XR):Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Ja=>{Ja.Xdb(this.XR)}):Xa.a(this.$).Xdb(this.XR));this.$.ea.$v(this.Gf);this.$.ea.iS(this.So);this.$=null}QOj(Ja,Kb){let lc=lb.a.nd(1,2,2211,0,0,Ja,"PowerQueryRefreshValidationFailed");switch(Ja){case -1543585732:lc.MessageIdName=
"PowerQueryRefreshProtectedSheetFailed";lc.Description=String.format(E.a.instance.Va(709),Kb,E.a.instance.ha(2212));break;case 165156185:lc.MessageIdName="PowerQueryRefreshSheetViewFailed";lc.Description=String.format(E.a.instance.Va(709),Kb,E.a.instance.ha(2213));break;default:d.ULS.sendTraceTag(529069344,0,10,`PowerQueryManager.showEwaErrorDialog: unhandled error id ${Ja}`)}Ub.EwaSettings.By()?new Pd.a(this.$,lc):(Ja=new xc.ErrorDialog(this.$,lc),Ja.initialize(),Ja.qg())}E5g(Ja){var Kb=this.Vcb.getItem(Ja);
return Kb?(Kb=this.qZh(Kb))?(this.QOj(Kb,Ja),!1):!0:(d.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),!1)}qZh(Ja){if((Ja=this.t8h(Ja))&&Ja.di)return-1543585732;if(Ja&&Ja.Be.wB)return 165156185}t8h(Ja){let Kb=void 0,lc=void 0;if(3===Ja.FillObjectType||2===Ja.FillObjectType)Kb=Ja.FillObjectName.split("!")[0];else if(0==Ja.FillObjectType){if(!Ja.FillObjectName)return d.ULS.sendTraceTag(523534751,0,15,"PowerQueryManager.getSheetFromLoadDestination: FillObjectName is undefined for Query loaded to table."),
lc;(Ja=this.$.Hb.getItemByName(Ja.FillObjectName))?Kb=Ja.sheetName:d.ULS.sendTraceTag(527743194,0,15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query")}Kb&&(lc=this.$.ua.getItemByName(Kb));return lc}ykj(){this.TMe?this.xMd(()=>!0):this.dka().continueWith(Ja=>{Ja.result?this.xMd(()=>!0):d.ULS.sendTraceTag(537154445,0,10,"PowerQueryManager.RefreshAllQueries failed to fetch queries")})}xMd(Ja){this.queries.filter(Ja).forEach(Kb=>this.RKb(Kb.Name))}l9e(Ja){var Kb;for(const lc of this.queries)if((null===
(Kb=this.XD.getItem(lc.Name))||void 0===Kb?void 0:Kb.ConnectionName)===Ja)return lc.Name;return null}}Object(e.a)(Pf,"PowerQueryManager",null,[829,233,2]);var pg=a(721);class $f extends Fb.a{constructor(Ja){super();this.$=Ja;this.Mb()}create(){const Ja=this.$.da,Kb=Object(nb.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")?Object(za.d)(cb.a.resolve(Pa.O,{rb:this.Na})):Ha.GetServiceTaskFactory.Sa(Ja,349,350,this.Na),lc=Ub.EwaSettings.Xw()?Object(za.d)(cb.a.resolve(Pa.o,{rb:this.Na})):f.Task.Ua(null);
Ca.TaskExtensions.za(Ca.TaskExtensions.Pd([Kb,lc],this.$.ka),()=>{this.vb(Object(pg.a)(Ja,470,()=>new Pf(this.$,Kb.result,lc.result)))},this.$.ka,3)}static la(Ja){Ja.da.Ha(471,new $f(Ja))}}Object(e.a)($f,"PowerQueryManagerFactory",Fb.a,[]);var Ya;(function(Ja){Ja[Ja.null=-1]="null";Ja[Ja.table=0]="table";Ja[Ja.connectionOnly=1]="connectionOnly";Ja[Ja.pivotTable=2]="pivotTable";Ja[Ja.pivotChart=3]="pivotChart"})(Ya||(Ya={}));Object(e.b)("FillObjectType",Ya);var Db=a(232);a(356);a(125);class Wb{constructor(){this.name=
this.key=null;this.startIndex=this.count=0;this.data=this.children=null;this.order=this.level=0;this.parentKey=null}}Object(e.a)(Wb,"GroupInfo",null,[]);class Bc{constructor(){this.onLegacyConnectionDelete=this.onLegacyConnectionCancelRefresh=this.onLegacyConnectionRefresh=this.handleQueryAction=this.onCancelQueryRefresh=this.handleQueryGroupOperation=this.onQueryRefresh=this.onQuerySelected=null}}Object(e.a)(Bc,"PowerQueryTaskPaneCallbacks",null,[]);class Tc{constructor(){this.callbacks=this.selectedQueryKey=
this.groups=this.connections=this.queries=this.type=null}}Object(e.a)(Tc,"PowerQueryTaskPaneProps",null,[]);class id{constructor(){this.name=null;this.rowsLoaded=0;this.lastRefresh=null;this.fillObjectType=0;this.loadedToDataModel=!1;this.queryError=0;this.groupKey=null;this.rowsWithError=this.nestingDepth=0;this.isDeleting=this.refreshEnabled=this.inRefresh=!1;this.currentRunningOperation=0}}Object(e.a)(id,"QueryInfo",null,[]);class k{constructor(){this.description=this.name=null;this.fillObjectType=
0;this.refreshEnabled=this.inRefresh=this.loadedToDataModel=!1}}Object(e.a)(k,"ConnectionInfo",null,[]);class Ob{constructor(Ja,Kb,lc){new U.a(!1);new U.a(!0);new U.a(!0);this.Zxd=this.Xbf=this.WAa=null;this.hXf=0;this.onCancelQueryRefresh=Dc=>{this.powerQueryManager.hDe(Dc)&&this.aZd([Dc])};this.handleQueryGroupOperation=(Dc,Oc)=>{const oa={};oa.Id=Oc.id;oa.Name=Oc.name;oa.Description=Oc.description;oa.ParentId=Oc.parentId;this.powerQueryManager.handleQueryGroupOperation(Dc,oa)};this.handleQueryAction=
(Dc,Oc)=>{const oa={};oa.Name=Oc.name;oa.ExtraData=Oc.extraData;oa.Formulas=this.powerQueryManager.formulas;this.powerQueryManager.handleQueryAction(Dc,oa)};this.$=Ja;this.suc=lc;this.isVisible=!1;this.Rvc=new U.a(!0);this.GMd={};this.powerQueryManager=Kb}RBa(){bc.UISurfaces.Aj().then(Ja=>{Ja.setSelectedTaskPane("PowerQueryTaskPane");return null})}AL(Ja){this.isVisible=!0;bc.UISurfaces.Aj().then(Kb=>{Kb.showTaskPane("PowerQueryTaskPane",this.Q7c(Ja));return null})}fC(Ja,Kb,lc=null,Dc=null,Oc=null){if(this.isVisible){var oa=
this.Q7c(Ja,Kb,lc,Dc,Oc);bc.UISurfaces.Aj().then(na=>{na.updateTaskPane("PowerQueryTaskPane",oa||this.Q7c(Ja,Kb,lc,Dc,Oc));return null})}else this.Bog(Kb,lc,Dc)}HK(){this.isVisible=!1;bc.UISurfaces.Aj().then(Ja=>{Ja.hideTaskPane("PowerQueryTaskPane",2);return null})}afg(Ja){if(!Db.a.Yg(Ja)){for(const Kb of this.WAa)Ja.includes(Kb.name)&&(this.Rvc.add(Kb.name,Kb),this.GMd[Kb.name]=++this.hXf,d.ULS.sendTraceTag(537154401,0,50,`Refresh started for query #: ${this.hXf}`));this.fC(null,this.powerQueryManager.queries,
this.powerQueryManager.groups,this.powerQueryManager.mda)}}aZd(Ja){if(!Db.a.Yg(Ja)){for(const Kb of this.WAa)Ja.includes(Kb.name)&&(Kb.name in this.GMd&&d.ULS.sendTraceTag(537154400,0,50,`Refresh stoped for query #: ${this.GMd[Kb.name]}`),this.Rvc.remove(Kb.name));this.fC(null,this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.mda)}}Bog(Ja=null,Kb=null,lc=null){this.S8j(Ja,Kb,lc)}S8j(Ja=null,Kb=null,lc=null){Ja&&(this.WAa=[],null===Ja||void 0===Ja?void 0:Ja.forEach(Dc=>
this.WAa.push(this.jkh(Dc))));lc&&(this.Zxd=[],null===lc||void 0===lc?void 0:lc.forEach(Dc=>this.Zxd.push(this.Bgh(Dc))));Kb&&(this.Xbf=this.Xhh(Kb));this.Ycj()}Q7c(Ja,Kb=null,lc=null,Dc=null,Oc=null){this.Bog(Kb,lc,Dc);Kb=Object(qb.a)(new Bc,{onQuerySelected:this.suc.onQuerySelected,onQueryRefresh:this.powerQueryManager.RKb,onCancelQueryRefresh:this.onCancelQueryRefresh,handleQueryGroupOperation:this.handleQueryGroupOperation,handleQueryAction:this.handleQueryAction});Oc=Object(qb.a)(new Tc,{type:"PowerQueryTaskPaneProps",
callbacks:Kb,queries:this.WAa,groups:this.Xbf,connections:this.Zxd,selectedQueryKey:Oc});if(Qa.a.Md())return Object(qb.a)(new sc.a,{contentProps:Oc,onOpen:()=>{this.suc.CI()},onClose:()=>{this.suc.jx()},width:320,title:E.a.instance.ha(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?2288:2201)});Ja=Object(qb.a)(new Tb.a,{container:Ja,paneProps:Oc});return Object(qb.a)(new sc.a,{contentProps:Ja,onOpen:()=>{this.suc.CI()}})}Ycj(){if(this.WAa)for(let Kb=
0;Kb<this.WAa.length;Kb++){var Ja=!1;const lc=this.WAa[Kb],Dc=this.Rvc.getItem(lc.name);null!=Dc&&(Ja=new Date(lc.lastRefresh),(Ja=(new Date(Dc.lastRefresh)).getTime()===Ja.getTime())||this.Rvc.remove(Dc.name));lc.inRefresh=Ja;lc.refreshEnabled=this.powerQueryManager.XD.nb(lc.name)}}jkh(Ja){var Kb;return Object(qb.a)(new id,{name:Ja.Name,rowsLoaded:Ja.RowsLoaded,lastRefresh:Ja.LastRefresh,fillObjectType:Ja.FillObjectType,loadedToDataModel:Ja.LoadedToDataModel,queryError:Ja.QueryError,nestingDepth:0,
rowsWithError:Ja.RowsWithError,groupKey:Ja.GroupID,isDeleting:Ja.IsDeleting,currentRunningOperation:null!==(Kb=Ja.CurrentRunningOperation)&&void 0!==Kb?Kb:-1})}Bgh(Ja){return Object(qb.a)(new k,{name:Ja.Name,description:Ja.Description,fillObjectType:Ja.FillObjectType,loadedToDataModel:Ja.LoadedToDataModel,inRefresh:Ja.InRefresh,refreshEnabled:Ja.RefreshEnabled})}Xhh(Ja){const Kb=[];Ja.forEach(lc=>{lc=Object(qb.a)(new Wb,{key:lc.Id,name:lc.Name,order:lc.Order,parentKey:lc.ParentId,data:lc.Description});
Kb.push(lc)});return Kb}}Object(e.a)(Ob,"PowerQueryReactTaskPane",null,[877]);class kc{constructor(Ja,Kb){this.ruc=this.mea=this.dEc=this.powerQueryTaskPane=null;this.nRf=this.utc=this.oh=!1;this.onQuerySelected=lc=>{for(var Dc of this.powerQueryManager.queries)if(Dc.FillObjectName&&Dc.Name===lc){3!==Dc.FillObjectType&&2!==Dc.FillObjectType||rb.a.contains(Dc.FillObjectName,"!",!0)||d.ULS.sendTraceTag(537154438,0,15,`PowerQueryPaneManager.OnQuerySelected: Selection Query of type : ${Ya[Dc.FillObjectType]} and no ! on FillObjectName`);
3===Dc.FillObjectType?(lc=Dc.PivotChartSheetRange,lc.SheetName=Dc.FillObjectName.split("!")[0],Dc=Dc.FillObjectName.split("!")[1],H.h(this.$).ga.Ra.YIa(lc,Dc,0).continueWith(Oc=>{Oc.result||d.ULS.sendTraceTag(537154437,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):(Dc=2===Dc.FillObjectType?Dc.FillObjectName.split("!")[1]:Dc.FillObjectName,(Dc=this.$.Hb.getItemByName(Dc))&&Dc.activate(Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7317913_FixFocusLostOnQuerySelection")));
break}};this.mIb=()=>{this.hideTaskPane();this.$.Hb.Gg(this.he)};this.onCancelQueryRefresh=lc=>{this.powerQueryManager.hDe(lc)&&this.mea.aZd([lc])};this.onQueryRefresh=lc=>{this.powerQueryManager.RKb(lc)};this.Dof=lc=>this.powerQueryManager.XD.nb(lc);this.fHf=()=>{this.RZi()};this.bHf=()=>{this.sZi()};this.he=(lc,Dc)=>{Dc.na&&2===Dc.na.type&&this.a_d.nb(Dc.na.name)&&this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.mda,this.a_d.getItem(Dc.na.name))};
this.wsc=(lc,Dc)=>{lc=[];for(const Oc of this.powerQueryManager.XD.values)if(Dc===Oc.ConnectionName){const oa=Oc.QueryName;if(this.powerQueryManager.ylc(oa)){lc.push(oa);break}}this.mea.afg(lc)};this.XR=(lc,Dc)=>{if(Dc&&Dc.Result){lc=Dc.Result.ConnectionName;Dc=[];for(const Oc of this.powerQueryManager.XD.values)if(lc===Oc.ConnectionName){const oa=Oc.QueryName;if(this.powerQueryManager.ylc(oa)){Dc.push(oa);break}}this.mea.aZd(Dc)}};this.$=Ja;this.powerQueryManager=Kb;this.a_d=new U.a(!0);this.eXj=
new U.a(!0);this.pni(Ja);Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(lc=>{lc.M_a(this.XR);lc.NZc(this.wsc)}):(Xa.a(this.$).M_a(this.XR),Xa.a(this.$).NZc(this.wsc));this.powerQueryManager.pTg(this.fHf);this.powerQueryManager.qTg(this.bHf);d.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}fQj(){if(Qa.a.Md())this.showTaskPane();else if(this.powerQueryTaskPane||this.nRf)this.powerQueryTaskPane&&
(this.powerQueryTaskPane.$g(!0),this.showTaskPane());else{this.nRf=!0;const Ja=Ha.GetServiceTaskFactory.Sa(this.$.da,408,409,0),Kb=Ab.a(this.$);Ca.TaskExtensions.za(Ca.TaskExtensions.Pd([Ja,Kb],this.$.ka),()=>{this.powerQueryTaskPane=Ja.result;Kb.result.nR(this.powerQueryTaskPane);this.u7();this.powerQueryTaskPane.$g(!0);this.showTaskPane()},this.$.ka,3)}}pni(Ja){this.mea=new Ob(Ja,this.powerQueryManager,this)}u7(){this.ruc=this.powerQueryTaskPane.HU();this.powerQueryTaskPane.dU(this.mIb)}dispose(){Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",
!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Ja=>{Ja.Xdb(this.XR);Ja.XNd(this.wsc)}):(Xa.a(this.$).Xdb(this.XR),Xa.a(this.$).XNd(this.wsc));this.powerQueryManager.Irj(this.fHf);this.powerQueryManager.Jrj(this.bHf);this.$=null;this.hideTaskPane();this.powerQueryTaskPane&&(this.powerQueryTaskPane.eX(this.mIb),this.powerQueryTaskPane=this.ruc=null);this.mea=null}CI(){this.powerQueryManager.dka();this.powerQueryManager.Ced();this.$.Hb.kg(this.he)}jx(){this.oh=!1}handleQueryGroupOperation(Ja,Kb){me.a(this.$.userOperationManager,
(lc,Dc,Oc)=>nf(this.$.pa.va,Ja,Kb,lc,Dc,Oc,null),lc=>new Fa.a(1021,0,lc),null)}showTaskPane(){this.oh?Qa.a.Md()&&this.mea.RBa():(this.dEc=this.$.Rb.Qc("UserAction","PowerQueryTaskPaneInitialLoadTime"),this.oh=!0,this.mea.AL(this.ruc))}updateTaskPane(Ja,Kb,lc,Dc){this.mea.fC(this.ruc,Ja,Kb,lc,Dc);this.dEc&&(this.dEc.stop(),this.dEc=null);for(Ja=0;Ja<this.powerQueryManager.queries.length;Ja++)Kb=this.powerQueryManager.queries[Ja],0===Kb.FillObjectType&&this.a_d.add(Kb.FillObjectName,Kb.Name),Kb.LastRefresh||
d.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.");Ja=this.powerQueryManager.mda;for(Kb=0;Kb<Ja.length;Kb++)lc=Ja[Kb],0===lc.FillObjectType&&this.eXj.add(lc.FillObjectName,lc.Name)}hideTaskPane(){this.oh=!1;this.mea.HK()}RZi(){this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.mda,null);this.utc||(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",
!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Ja=>{this.hsc(Ja.UKb)}):this.hsc(Xa.a(this.$).UKb),this.utc=!0)}sZi(){this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,this.powerQueryManager.mda,null);this.utc||(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void cb.a.resolve(Pa.o,{rb:1}).then(Ja=>{this.hsc(Ja.UKb)}):this.hsc(Xa.a(this.$).UKb),this.utc=!0)}hsc(Ja){const Kb=[];for(const lc of Ja)for(const Dc of this.powerQueryManager.XD.values)if(lc===
Dc.ConnectionName&&(Ja=Dc.QueryName,this.powerQueryManager.ylc(Ja))){Kb.push(Ja);break}this.mea.afg(Kb)}}Object(e.a)(kc,"PowerQueryPaneManager",null,[861]);class wc{constructor(Ja,Kb){this.tuc=null;this.$=Ja;this.mcj=Kb}Vc(){return!1}Oc(){return!1}executeCommand(Ja,Kb){this.tuc||(this.tuc=new kc(this.$,this.mcj));Ja=Ca.TaskExtensions.lk();return 1156885807===Kb.command?(this.tuc.fQj(),Ja):kb.a(Kb.command)}dispose(){this.$=this.tuc=null}Ac(Ja,Kb){return 1156885807===Kb.command}}Object(e.a)(wc,"PowerQueryPaneCommandHandler",
null,[233,2]);class ad extends Sa.a{constructor(Ja){super(Ja)}Fd(){this.$.Fz(()=>{Ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient")?Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.Sa(this.$.da,470,471,1),Ja=>{this.qd([new wc(this.$,Ja.result)])},this.$.ka,3):this.qd([new wc(this.$,null)])})}static la(Ja){Sa.a.Yd(407,new ad(Ja))}}Object(e.a)(ad,"PowerQueryPaneCommandHandlerFactory",Sa.a,[]);class sd{}sd.tCh="ewa-pqtp-pane";sd.sCh="ewa-pqtp-header";sd.uCh="ewa-pqtp-title";
sd.qCh="ewa-pqtp-body";sd.rCh="ewa-pqtp-close-button";Object(e.a)(sd,"CssClassNames",null,[]);const Gd=sd.tCh,Yd=sd.sCh,ve=sd.qCh,De=sd.uCh,Pe=F.a.CQb+sd.rCh;class Xe extends M.a{constructor(Ja,Kb,lc){super(Ja);this.fGe=this.Ie=null;this.Xs=!1;this.gw=0;this.Dc=(Dc,Oc)=>{Oc.Sf||this.$g(!1)};this.Cl=()=>{this.$g(!1);this.raiseEvent("PQTPC");return!0};this.$=Kb;this.taskPaneManager=lc;x.a(Kb).ti(this);this.$.wj(this.Dc)}eU(Ja){this.get_events().addHandler("PQTPR",Ja)}fX(Ja){this.get_events().removeHandler("PQTPR",
Ja)}dU(Ja){this.addHandler("PQTPC",Ja)}eX(Ja){this.removeHandler("PQTPC",Ja)}get isVisible(){return super.isVisible}set isVisible(Ja){super.isVisible!==Ja&&(super.isVisible=Ja)}get Qf(){return this.isVisible}get je(){return ia.a.lcj}get Uh(){return 17}get tk(){return A.a.zFh}get jR(){return E.a.instance.ha(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?2288:2201)}get titleText(){return E.a.instance.ha(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",
!1)?2288:2201)}get oq(){return 320}get rc(){return this.domElement}get height(){return this.taskPaneManager.WO.offsetHeight}get isResizable(){return!1}Zq(){return this.Xs}Tt(){return this.Xs}BW(){}LV(){return!1}Bj(){}hk(){}dispose(){this.$&&this.$.ll(this.Dc);this.Ie&&(I.a.instance.Ba(m.a.click,this.Ie,this.Cl),wa.KeyInputManager.instance.Cx(this.Ie,this.fGe));this.Ie=this.taskPaneManager=this.$=null;super.dispose()}pg(Ja,Kb){Kb||(Ja=R.DOMElementExtensions.getElementById(this.domElement,"PowerQueryContainerId-1"),
Ja||(Ja=this.Ie),R.DOMElementExtensions.setFocus(Ja));return!Kb}Gh(Ja){return R.DOMElementExtensions.Mf(this.rc,Ja)}$g(Ja){this.Xs=Ja;const Kb=this.taskPaneManager;this.isVisible=Ja;this.taskPaneManager.eC();Ja&&0<Kb.iE.length&&(!Kb.Qh||17!==Kb.Qh.taskPane.Uh||Kb.isCollapsed)&&Kb.VI(this,!0)}HU(){const Ja=document.getElementById(this.$.Ib+F.a.mJd);Ja.setAttribute(Y.a.ariaLabel,E.a.instance.ha(Ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?2288:2201));
var Kb=this.KM();Ja.appendChild(Kb);Kb=Qd.b("div","PowerQueryPaneBodyId",ve);Ja.appendChild(Kb);return Kb}KM(){const Ja=Qd.b("div","PowerQueryPaneHeaderId",Yd),Kb=Qd.b("span","PowerQueryPaneTitleId",De);Kb.innerText=this.titleText;this.Ie=Z.a.tb("PowerQueryPaneCloseButtonId",Pe,E.a.instance.ha(10),"ClosePaneGlyph_16x16x32",!1);this.Ie.classList.add(Ea.AFrameworkApplication.isRtl?F.a.oka:F.a.pka);I.a.instance.ta(m.a.click,this.Ie,this.Cl);this.fGe=wa.KeyInputManager.instance.$t(this.Ie,this.Cl,fa.a.Wh);
Ja.appendChild(Kb);Ja.appendChild(this.Ie);return Ja}static la(Ja,Kb){var lc=Ja.Ib;let Dc=document.getElementById(lc+F.a.mJd);Dc||(Dc=document.createElement("div"),Dc.id=Ja.Ib+F.a.mJd,Qa.a.Md()||document.getElementById(lc+F.a.vW).appendChild(Dc));Dc.classList.add(Gd);lc=Ja.da;return lc.Aa(408)||lc.Ha(408,new Xe(Dc,Ja,Kb))}}Object(e.a)(Xe,"PowerQueryTaskPane",M.a,[828,2,339,36]);class yf extends Fb.a{constructor(Ja){super();this.rh=this.ui=null;this.$=Ja;this.Mb()}get RD(){this.ui||(this.ui=Ca.TaskExtensions.za(Ab.a(this.$),
Ja=>{this.rh=Xe.la(this.$,Ja.result)},this.ka,3));return this.ui}create(){const Ja=Ha.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),Kb=Ha.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Na);Ca.TaskExtensions.za(Ca.TaskExtensions.ts(Ca.TaskExtensions.Pd([Ja,Kb],this.ka),()=>this.RD,this.ka),()=>{this.vb(this.rh)},this.ka,3)}dispose(){this.rh=this.ui=this.$=null;super.dispose()}static la(Ja){Ja.da.Ha(409,new yf(Ja))}}Object(e.a)(yf,"PowerQueryTaskPaneFactory",Fb.a,[]);var ug=a(649);
class ag extends of.a{constructor(Ja,Kb,lc,Dc){super(Ja);this.pvj=(Oc,oa)=>{this.hide();switch(Oc){case 0:this.FUi();break;case 1:this.OVi(oa)}d.ULS.sendTraceTag(509613449,0,20,`PowerQueryReactFlowDialog.ResolveChallengeFlow committed with action button: ${ug.a[Oc]}`)};d.ULS.sendTraceTag(512267668,0,50,"PowerQueryReactFlowDialog.PowerQueryReactFlowDialog");this.Pq=Kb;this.Pq.id=this.uc;this.FUi=Dc;this.OVi=lc}get uc(){return"PowerQueryFlowDialog"}Cg(){d.ULS.sendTraceTag(509613450,0,50,`PowerQueryReactFlowDialog.initializeAndShowDialog started. FlowID: ${this.Pq.FlowProps.flowId}`);
this.initializeAndShow("",this.pvj,this.Pq)}}Object(e.a)(ag,"PowerQueryReactFlowDialog",of.a,[]);class wg{constructor(){this.flowId=0}}Object(e.a)(wg,"PowerQueryFlowProps",null,[]);class Bg extends wg{constructor(){super();this.resourcePath=this.resourceKind=null}}Object(e.a)(Bg,"PowerQueryResolveChallengeFlowProps",wg,[]);class qg{constructor(Ja,Kb){this.ovj={["height"]:440,["width"]:580};this.$=Kb;this.$ye=Ja}Z7c(Ja,Kb,lc,Dc){let Oc;switch(lc){case -1496653501:Oc=this.X6h(Dc.kind,Dc.path)}return new ag(this.$,
Oc,Ja,Kb)}dispose(){this.$ye=this.$=null}X6h(Ja,Kb){const lc=this.lYh();lc.bodyProps=this.ovj;let Dc=new Bg;Dc.flowId=0;Dc.resourceKind=Ja;Dc.resourcePath=Kb;lc.FlowProps=Dc;return lc}lYh(){const Ja={isModal:!0};Ja.Locale=this.$.xa.UICultureTag;Ja.SessionId=this.$.xa.UserSessionId;Ja.HostContextType=this.$.xa.PowerQueryHostContextType;Ja.PowerQueryEndpointUrl=this.$.xa.PowerQueryEndpointUrl;Ja.AuthTokenAsyncCallback=this.$ye;return Ja}}Object(e.a)(qg,"PowerQueryReactFlowDialogBuilder",null,[]);class Gf{constructor(Ja,
Kb){this.Oya="kind";this.gId="path";this.ych="connectionName";this.Ucb="queryName";this.MYd=()=>{const lc=this.Z1j();lc&&(d.ULS.sendTraceTag(509613448,0,50,`PowerQueryUIFlowManager:ResolveChallenge: starting resolve challenge flow.
         Kind: ${lc[this.Oya]}`),this.kJd.Z7c(this.JWh(lc[this.Ucb]),this.nvj,-1496653501,lc).Cg())};this.nvj=()=>{this.uDb=!1;this.MYd()};this.$=Ja;this.powerQueryManager=Kb;this.kJd=new qg(Kb.whd,Ja);this.CSa=[];this.uDb=!1;this.xMb=new U.a(!1)}Vc(){return!1}Oc(){return!1}executeCommand(Ja,Kb,lc){Ja=Ca.TaskExtensions.lk();switch(Kb.command){case -1496653501:return this.kkg(lc)||(Array.enqueue(this.CSa,lc),this.MYd()),Ja;default:return kb.a(Kb.command)}}dispose(){this.$=this.powerQueryManager=null;
this.kJd.dispose();this.xMb=this.CSa=this.kJd=null}Ac(Ja,Kb){switch(Kb.command){case -1496653501:return!0;default:return!1}}Z1j(){return!this.uDb&&0<this.CSa.length?(this.uDb=!0,Array.dequeue(this.CSa)):null}O1j(){for(let Ja=this.CSa.length-1;0<=Ja;Ja--){let Kb=this.CSa[Ja];this.kkg(Kb)&&d.ULS.sendTraceTag(509636695,0,50,`PowerQueryUIFlowManager:ResolveChallenge: auto resolve challenge succeeded.
           Kind: ${Kb[this.Oya]}`)}this.Zjg()}kkg(Ja){var Kb=this.wPf(Ja);Kb=this.xMb.getItem(Kb);if(!Kb||Array.contains(Kb,Ja[this.Ucb]))return d.ULS.sendTraceTag(509613447,0,50,`PowerQueryUIFlowManager:ResolveChallenge: try auto resolve challenge failed.
         isCached: ${!!Kb},
         prevResolved: ${Array.contains(Kb,Ja[this.Ucb])}`),!1;Array.remove(this.CSa,Ja);this.uDb=!1;Array.add(Kb,Ja[this.Ucb]);this.powerQueryManager.RKb(Ja[this.Ucb]);return!0}l8j(Ja){var Kb=this.wPf(Ja);const lc=Ja[this.Ucb];this.xMb.nb(Kb)?(Kb=this.xMb.getItem(Kb),Kb.includes(lc)||Array.add(Kb,lc)):this.xMb.add(Kb,[lc]);d.ULS.sendTraceTag(509613446,0,50,`PowerQueryUIFlowManager:ResolveChallenge: Cache updated with Kind: ${Ja[this.Oya]}`)}wPf(Ja){return Ja[this.Oya].concat("_",Ja[this.gId])}Zjg(){this.uDb=
!1;this.MYd()}JWh(Ja){return Kb=>Object(oc.a)(this,void 0,void 0,function*(){if(Kb){var lc=[];Kb.forEach(Dc=>{lc.push({K:Dc[this.Oya],P:Dc[this.gId],ID:Dc[this.ych],V:null})});Re(this.$.pa.va,lc,2,Dc=>{!Dc||0<Dc.Errors.length?d.ULS.sendTraceTag(509743360,0,10,`PowerQueryUIFlowManager:ResolveChallenge: success callback failure: ${Dc.Result}`):(1<Kb.length&&d.ULS.sendTraceTag(509649952,0,10,"PowerQueryUIFlowManager:ResolveChallenge: commit result array contains more than one result"),this.powerQueryManager.RKb(Ja),
d.ULS.sendTraceTag(509613445,0,20,`PowerQueryUIFlowManager:ResolveChallenge: Write Roaming succeeded, challenge resolved.
          Kind: ${Kb[0][this.Oya]}`),this.l8j({kind:Kb[0][this.Oya],path:Kb[0][this.gId],queryName:Ja}),this.O1j())},()=>{d.ULS.sendTraceTag(509743330,0,10,`PowerQueryUIFlowManager:ResolveChallenge: Write Roaming failed,
          Kind: ${Kb[0][this.Oya]}`);this.Zjg()},null,null)}else d.ULS.sendTraceTag(509691530,0,10,"PowerQueryUIFlowManager:ResolveChallenge: commit result null")})}}Object(e.a)(Gf,"PowerQueryUIFlowManager",null,[233,2]);class Rg extends Sa.a{constructor(Ja){super(Ja)}Fd(){this.$.Fz(()=>{Ca.TaskExtensions.za(Ha.GetServiceTaskFactory.Sa(this.$.da,470,471,this.Na),Ja=>{this.qd([new Gf(this.$,Ja.result)])},this.$.ka,3)})}static la(Ja){Sa.a.Yd(512,new Rg(Ja))}}Object(e.a)(Rg,"PowerQueryUIFlowManagerFactory",
Sa.a,[]);class lh{getExpandedRangeForPivotTable(Ja,Kb,lc,Dc,Oc,oa,na,dc=null){dc=Ja.Oa(1,dc);dc.sheetRange=Kb;dc.activeCell=lc;return D.g(Ja,"GetExpandedRangeForPivotTable",dc,Dc,Oc,oa,na,0)}}Object(e.a)(lh,"ExpandRange",null,[695]);class qe extends Fb.a{constructor(Ja){super();this.$=Ja;this.Mb()}static la(Ja){Ja.da.Ha(483,new qe(Ja))}create(){var Ja;this.vb(null!==(Ja=this.$.da.Aa(482))&&void 0!==Ja?Ja:this.$.da.Ha(482,new lh))}}Object(e.a)(qe,"ExpandRangeFactory",Fb.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");b.a.Hi(".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}");b.a.Hi('.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}');
b.a.Hi('.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}');
(()=>{Gb.a.Fa(Ja=>{const Kb=Object(nb.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(za.d)(cb.a.resolve(Pa.X,{rb:1})):Ha.GetServiceTaskFactory.Sa(Ja.da,12,477,1),lc=Ub.EwaSettings.Xw()?Object(za.d)(cb.a.resolve(Pa.o,{rb:1})):f.Task.Ua(null);Ca.TaskExtensions.za(Ca.TaskExtensions.Pd([Kb,lc],Ja.ka),()=>{yb.la(Ja,Kb.result,lc.result)},Ja.ka)})})();(()=>{Gb.a.Fa(Ja=>{mc.la(Ja);jb.la(Ja);hb.la(Ja)})})();Gb.a.Fa($e.la);(()=>{Gb.a.Fa(Ja=>{Lf.la(Ja)})})();Gb.a.Fa(Ta.lIa);Gb.a.Fa(oe.la);
(()=>{Gb.a.Fa(Ja=>{Cc.la(Ja);zb.la(Ja);xf.la(Ja)})})();(()=>{Gb.a.Fa(Ja=>{Ub.EwaSettings.UCb()||le.la(Ja);Yb.la(Ja)})})();(()=>{Gb.a.Fa(Ja=>{ad.la(Ja);ke.la(Ja);yf.la(Ja);$f.la(Ja);Rg.la(Ja)})})();(()=>{Gb.a.Fa(Ja=>{qe.la(Ja)})})();String(c);window.___1680633106472_closurehack=c}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.bi.js.map/6797b7d3340de666fa407cde22af7beb/EwaDSOpt.bi.js.map
!function o(a,s,u){function l(e,t){if(!s[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[e]={exports:{}};a[e][0].call(r.exports,function(t){return l(a[e][1][t]||t)},r,r.exports,o,a,s,u)}return s[e].exports}for(var c="function"==typeof require&&require,t=0;t<u.length;t++)l(u[t]);return l}({1:[function(t,e,n){"use strict";var i,r,o=(a.prototype.getCount=function(t){return this.isValidIndex(t)?this.currentCounts[t]:0},a.prototype.getSessionCount=function(t){return this.isValidIndex(t)?this.currentSessionCounts[t]:0},a.prototype.getStartTime=function(t){return this.isValidIndex(t)?this.currentStartTimes[t]:null},a.prototype.moveSessionCountIntoBaseCount=function(t){if(!this.isValidIndex(t))return 0;var e=this.currentSessionCounts[t];return this.currentSessionCounts[t]=0,e},a.prototype.initCounts=function(t,e,n){void 0===n&&(n=!1);for(var i=0;i<this.trackedActivities.length&&!(this.isOrdered&&i>this.currentIndex);i++)i<e.length&&e[i]&&(this.currentSessionCounts[i]=this.currentCounts[i]=e[i].tracker.getSessionCount(e[i].index),this.currentStartTimes[i]=e[i].tracker.getStartTime(e[i].index)),this.trackedActivities[i].getIsAggregate()&&i<t.length&&(this.currentCounts[i]+=t[i]),this.hasCountCrossedThreshold(i)&&this.finishActivityAtIndex(i);this.isActivated()&&!n&&(this.isActivationByInitPending=!0)},a.prototype.generateActivityIndexList=function(){for(var t=new Array,e=0;e<this.trackedActivities.length;e++){var n=new a.ActivityIndex;n.activity=this.trackedActivities[e].getActivity(),n.index=e,t.push(n)}return t},a.prototype.incrementActivity=function(t,e){if(!this.isValidIndex(t))return a.IncrementResult.Pending;if(e<0)throw new Error("increment must be non-negative");if(this.isOrdered&&t>this.currentIndex)return a.IncrementResult.Pending;var n=!this.hasCountCrossedThreshold(t);return this.currentCounts[t]+=e,this.currentSessionCounts[t]+=e,this.isActivationByInitPending?this.isPermittedIndexForActivationByInit(t)?this.commitActivation():a.IncrementResult.Pending:n&&this.hasCountCrossedThreshold(t)?(this.finishActivityAtIndex(t),this.isActivated()?this.commitActivation():a.IncrementResult.SingleActivityActivated):a.IncrementResult.Pending},a.prototype.startTime=function(t,e){this.isValidIndex(t)&&(this.currentStartTimes[t]=e||new Date)},a.prototype.stopTime=function(t,e){if(!this.isValidIndex(t))return 0;var n=this.currentStartTimes[t];return this.currentStartTimes[t]=null,n?(e=e||new Date)<n?0:(e.getTime()-n.getTime())/1e3:0},a.prototype.isValidIndex=function(t){return t<this.trackedActivities.length},a.prototype.isActivated=function(){return(this.currentActivationFlags&this.activationMask)===this.activationMask},a.prototype.finishActivityAtIndex=function(t){if(!this.isValidIndex(t))throw new Error("Index is not valid");this.currentActivationFlags|=1<<t,t+1<this.trackedActivities.length&&(this.currentIndex=t+1)},a.prototype.hasCountCrossedThreshold=function(t){if(!this.isValidIndex(t))throw new Error("Index is not valid");return this.currentCounts[t]>=this.trackedActivities[t].getCount()},a.prototype.isPermittedIndexForActivationByInit=function(t){return!this.isOrdered||t+1===this.currentCounts.length},a.prototype.commitActivation=function(){return this.isActivationByInitPending=!1,a.IncrementResult.AllActivitiesActivated},a);function a(t){if(!t)throw new Error("trackingSet must not be null");if(32<t.getList().length)throw new Error("trackingSet list size must be less than 32");this.isOrdered=t.getIsOrdered(),this.trackedActivities=t.getList(),this.currentIndex=0,this.activationMask=0,this.currentActivationFlags=0,this.isActivationByInitPending=!1,this.currentCounts=new Array(this.trackedActivities.length),this.currentStartTimes=new Array(this.trackedActivities.length),this.currentSessionCounts=new Array(this.trackedActivities.length);for(var e=0;e<this.trackedActivities.length;e++)this.currentCounts[e]=0,this.currentSessionCounts[e]=0;for(e=0;e<this.trackedActivities.length;e++)this.activationMask|=1<<e,this.trackedActivities[e].getCount()<1&&this.trackedActivities[e].setCount(1)}function s(){}(i=o=o||{}).ActivityIndex=s,(r=i.IncrementResult||(i.IncrementResult={}))[r.Pending=0]="Pending",r[r.SingleActivityActivated=1]="SingleActivityActivated",r[r.AllActivitiesActivated=2]="AllActivitiesActivated",e.exports=o},{}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(r.prototype.getActivity=function(){return this.activity},r.prototype.getCount=function(){return this.count},r.prototype.setCount=function(t){this.count=t},r.prototype.getIsAggregate=function(){return this.isAggregate},r);function r(t,e,n){this.activity=t,this.count=e,this.isAggregate=n}n.ActivityTrackingData=i},{}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(r.prototype.getIsOrdered=function(){return this.isOrdered},r.prototype.getList=function(){return this.list},r);function r(t,e){this.isOrdered=t,this.list=e}n.ActivityTrackingSet=i},{}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./../ISurveyInfo");n.ISurveyInfo=i;var r=t("./IActivityListener");n.IActivityListener=r;var o=t("./IFloodgateSettingIdMap");n.IFloodgateSettingIdMap=o;var a=t("./IFloodgateStorageProvider");n.IFloodgateStorageProvider=a;var s=t("./IFloodgateStringProvider");n.IFloodgateStringProvider=s;var u=t("./ISurvey");n.ISurvey=u;var l=t("./ISurveyComponent");n.ISurveyComponent=l;var c=t("../Campaign/CampaignDefinitionProvider");n.CampaignDefinition=c.CampaignDefinition},{"../Campaign/CampaignDefinitionProvider":12,"./../ISurveyInfo":23,"./IActivityListener":5,"./IFloodgateSettingIdMap":6,"./IFloodgateStorageProvider":7,"./IFloodgateStringProvider":8,"./ISurvey":10,"./ISurveyComponent":11}],5:[function(t,e,n){"use strict";var i,r,o;function a(){}r=i=i||{},a.AppLaunch="AppLaunch",a.AppUsageTime="AppUsageTime",a.AppResume="AppResume",o=a,r.ActivityName=o,e.exports=i},{}],6:[function(t,e,n){"use strict";var i;(i||(i={})).RoamingSettingIdMap={CampaignStates:1258,GovernedChannelStates:1257,SurveyActivationStats:1259},e.exports=i},{}],7:[function(t,e,n){"use strict";var i,r,o;r=i=i||{},(o=r.FileType||(r.FileType={}))[o.FloodgateSettings=0]="FloodgateSettings",o[o.SurveyActivationStats=1]="SurveyActivationStats",o[o.SurveyEventActivityStats=2]="SurveyEventActivityStats",o[o.CampaignDefinitions=3]="CampaignDefinitions",o[o.CampaignStates=4]="CampaignStates",o[o.GovernedChannelStates=5]="GovernedChannelStates",o[o.TmsCache_MessageMetadata=6]="TmsCache_MessageMetadata",o[o.TmsCache_UserGovernance=7]="TmsCache_UserGovernance",o[o.TmsCache_CampaignContent=8]="TmsCache_CampaignContent",o[o.Tms_DynamicSettings=9]="Tms_DynamicSettings",o[o.LogLevelSettings=10]="LogLevelSettings",e.exports=i},{}],8:[function(t,e,n){"use strict";var i,r,o;r=i=i||{},(o=r.StringType||(r.StringType={}))[o.NpsPromptTitle=0]="NpsPromptTitle",o[o.NpsPromptQuestion=1]="NpsPromptQuestion",o[o.NpsPromptYesLabel=2]="NpsPromptYesLabel",o[o.NpsPromptNotNowLabel=3]="NpsPromptNotNowLabel",o[o.NpsRatingQuestion=4]="NpsRatingQuestion",o[o.Nps11RatingValue0=5]="Nps11RatingValue0",o[o.Nps11RatingValue1=6]="Nps11RatingValue1",o[o.Nps11RatingValue2=7]="Nps11RatingValue2",o[o.Nps11RatingValue3=8]="Nps11RatingValue3",o[o.Nps11RatingValue4=9]="Nps11RatingValue4",o[o.Nps11RatingValue5=10]="Nps11RatingValue5",o[o.Nps11RatingValue6=11]="Nps11RatingValue6",o[o.Nps11RatingValue7=12]="Nps11RatingValue7",o[o.Nps11RatingValue8=13]="Nps11RatingValue8",o[o.Nps11RatingValue9=14]="Nps11RatingValue9",o[o.Nps11RatingValue10=15]="Nps11RatingValue10",o[o.Nps5RatingValue1=16]="Nps5RatingValue1",o[o.Nps5RatingValue2=17]="Nps5RatingValue2",o[o.Nps5RatingValue3=18]="Nps5RatingValue3",o[o.Nps5RatingValue4=19]="Nps5RatingValue4",o[o.Nps5RatingValue5=20]="Nps5RatingValue5",o[o.NpsCommentQuestion=21]="NpsCommentQuestion",o[o.PsatPromptTitle=22]="PsatPromptTitle",o[o.PsatPromptQuestion=23]="PsatPromptQuestion",o[o.PsatPromptYesLabel=24]="PsatPromptYesLabel",o[o.PsatPromptNotNowLabel=25]="PsatPromptNotNowLabel",o[o.PsatRatingQuestion=26]="PsatRatingQuestion",o[o.PsatRatingValue1=27]="PsatRatingValue1",o[o.PsatRatingValue2=28]="PsatRatingValue2",o[o.PsatRatingValue3=29]="PsatRatingValue3",o[o.PsatRatingValue4=30]="PsatRatingValue4",o[o.PsatRatingValue5=31]="PsatRatingValue5",o[o.PsatCommentQuestion=32]="PsatCommentQuestion",o[o.BpsPromptTitle=33]="BpsPromptTitle",o[o.BpsPromptQuestion=34]="BpsPromptQuestion",o[o.BpsPromptYesLabel=35]="BpsPromptYesLabel",o[o.BpsPromptNotNowLabel=36]="BpsPromptNotNowLabel",o[o.BpsRatingQuestion=37]="BpsRatingQuestion",o[o.BpsRatingValue1=38]="BpsRatingValue1",o[o.BpsRatingValue2=39]="BpsRatingValue2",o[o.BpsCommentQuestion=40]="BpsCommentQuestion",e.exports=i},{}],9:[function(t,e,n){"use strict";var i,r,o;r=i=i||{},(o=r.PromptButton||(r.PromptButton={}))[o.Unselected=0]="Unselected",o[o.Yes=1]="Yes",o[o.No=2]="No",e.exports=i},{}],10:[function(t,e,n){"use strict";var i,r,o;r=i=i||{},(o=r.Type||(r.Type={}))[o.Feedback=0]="Feedback",o[o.Nps=1]="Nps",o[o.Psat=2]="Psat",o[o.Bps=3]="Bps",o[o.Fps=4]="Fps",o[o.Nlqs=5]="Nlqs",o[o.GenericMessagingSurface=12]="GenericMessagingSurface",r.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey",r.DOM_NPS_TAGNAME="Nps",r.DOM_PSAT_TAGNAME="Psat",r.DOM_BPS_TAGNAME="Bps",r.DOM_FPS_TAGNAME="Fps",r.DOM_NLQS_TAGNAME="Nlqs",r.LAUNCHER_TYPE_DEFAULT="survey",e.exports=i},{}],11:[function(t,e,n){"use strict";var i,r,o;r=i=i||{},(o=r.Type||(r.Type={}))[o.Prompt="Prompt"]="Prompt",o[o.Comment="Comment"]="Comment",o[o.Rating="Rating"]="Rating",o[o.MultipleChoice="MultipleChoice"]="MultipleChoice",r.DOM_PROMPT_TAGNAME="Prompt",r.DOM_COMMENT_TAGNAME="Comment",r.DOM_RATING_TAGNAME="Rating",r.DOM_MULTIPLECHOICE_TAGNAME="MultipleChoice",r.JSON_PROMPT_KEYNAME="prompt",r.JSON_PROMPTTITLE_KEYNAME="title",r.JSON_PROMPTYESTEXT_KEYNAME="yesButtonText",r.JSON_PROMPTNOTEXT_KEYNAME="noButtonText",r.JSON_COMMENT_KEYNAME="comment",r.JSON_RATING_KEYNAME="rating",r.JSON_RATINGOPTIONS_KEYNAME="options",r.JSON_QUESTION_KEYNAME="question",r.JSON_MULTIPLECHOICE_KEYNAME="multipleChoice",r.JSON_APPLICATION_KEYNAME="application",r.JSON_EXTENDEDMANIFESTDATA_KEYNAME="extendedManifestData",r.JSON_SURVEYSTRINGS_KEYNAME="surveyStrings",r.JSON_SURVEYSPECIFICDATA_KEYNAME="surveySpecificData",e.exports=i},{}],12:[function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=t("../Api/IFloodgateStorageProvider"),a=t("../FloodgateEngine"),s=t("../GovernedChannel"),u=t("../ISurveyInfo"),l=t("../Utils"),c=t("es6-promise"),d=(p.deserialize=function(t){var e;return t&&0===t.Type&&(e=f.deserialize(t)),void 0===e?null:e},p.prototype.validate=function(){return!0},p);function p(){}n.CampaignLanguageRange=d;var g,f=(r(h,g=d),h.deserialize=function(t){var e=new h;return t&&(e.languageSubTag=t.Value),e.validate()?e:null},h.prototype.isInRange=function(t){if(l.isNullOrUndefined(t))return!1;var e=l.extractLanguageSubtag(t);return!l.isNullOrUndefined(e)&&e.toLocaleUpperCase()===this.languageSubTag.toLocaleUpperCase()},h.prototype.validate=function(){return!(!g.prototype.validate.call(this)||l.isNullOrUndefined(this.languageSubTag)||!l.isString(this.languageSubTag)||!l.isValidLanguageSubTag(this.languageSubTag))},h);function h(){return g.call(this)||this}n.CampaignLanguageRangeLanguageSubtag=f;var m=(v.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=S.deserialize(t);break;case 1:e=T.deserialize(t)}return void 0===e?null:e},v.prototype.validate=function(){return!0},v);function v(){}n.CampaignScope=m;var y,S=(r(b,y=m),b.deserialize=function(t){return new b},b.prototype.isInScope=function(t){return!0},b.prototype.validate=function(){return!!y.prototype.validate.call(this)},b);function b(){return y.call(this)||this}n.CampaignScopeAny=S;var C,T=(r(w,C=m),w.deserialize=function(t){var e=new w,n=[];if(l.isNullOrUndefined(t))return null;for(var i in t.Languages)if(t.Languages.hasOwnProperty(i)){var r=t.Languages[i];r&&n.push(d.deserialize(r))}return 0===n.length&&(n=null),e.languageRanges=n,e.validate()?e:null},w.prototype.isInScope=function(t){if(l.isNullOrUndefined(this.languageRanges))return!0;if(l.isNullOrUndefined(t)||!t.getLanguage())return!1;for(var e in this.languageRanges)if(this.languageRanges.hasOwnProperty(e)&&this.languageRanges[e].isInRange(t.getLanguage()))return!0;return!1},w.prototype.validate=function(){if(!C.prototype.validate.call(this))return!1;if(this.languageRanges)for(var t in this.languageRanges)if(this.languageRanges.hasOwnProperty(t)&&!this.languageRanges[t])return!1;return!0},w);function w(){return C.call(this)||this}n.CampaignScopeEnvironmentCrossProduct=T;var A=(I.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=F.deserialize(t);break;case 1:e=D.deserialize(t)}return void 0===e?null:e},I.prototype.validate=function(){return!0},I);function I(){}n.CampaignDuration=A;var E,F=(r(O,E=A),O.deserialize=function(t){var e=new O;return t&&(e.intervalSeconds=t.IntervalSeconds),e.validate()?e:null},O.prototype.asTimeIntervalSeconds=function(){return this.intervalSeconds},O.prototype.validate=function(){return!!E.prototype.validate.call(this)&&!!l.isNumber(this.intervalSeconds)},O);function O(){return E.call(this)||this}n.CampaignDurationTimeInterval=F;var _,D=(r(N,_=A),N.deserialize=function(t){return new N},N.prototype.asTimeIntervalSeconds=function(){return null},N);function N(){return _.call(this)||this}n.CampaignDurationSingleBuildChange=D;var x=(B.deserialize=function(t){var e=new B;if(!l.isNullOrUndefined(t)){e.additionalData=[];for(var n=0,i=t;n<i.length;n++)"EmailAddress"===i[n]&&e.additionalData.push(u.AdditionalDataType.EmailAddress)}return e.validate()?e:null},B.prototype.validate=function(){return!l.isNullOrUndefined(this.additionalData)},B);function B(){}n.CampaignAdditionalDataRequested=x;var k=(L.deserialize=function(t){var e;return t&&0===t.Type&&(e=U.deserialize(t)),void 0===e?null:e},L.prototype.validate=function(){return!0},L);function L(){}n.CampaignDistribution=k;var P,U=(r(M,P=k),M.deserialize=function(t){var e=new M;return t&&(e.maxDelaySeconds=t.MaxDelaySeconds,e.chunks=t.Chunks),e.validate()?e:null},M.prototype.validate=function(){return!(!P.prototype.validate.call(this)||!l.isNumber(this.maxDelaySeconds)||this.maxDelaySeconds<0||!l.isNumber(this.chunks)||this.chunks<0)},M);function M(){return P.call(this)||this}n.CampaignDistributionRamp=U;var R=(V.deserialize=function(t){var e;return t&&0===t.Type&&(e=z.deserialize(t)),void 0===e?null:e},V.prototype.getActiveSurveyTimeIntervalSeconds=function(){var t=this.nominationPeriod.asTimeIntervalSeconds();return l.isNumber(t)?t:this.fallbackSurveyDurationSeconds},V.prototype.calculateSurveyStartTimeFromDate=function(t){return t||new Date},V.prototype.calculateSurveyExpirationTimeFromSurveyStartTime=function(t){return t=t||new Date,l.addSecondsWithoutOverflow(t,this.getActiveSurveyTimeIntervalSeconds())},V.prototype.getCampaignCooldown=function(t){return t?this.cooldownPeriod:this.nominationPeriod},V.prototype.validate=function(){return!(l.isNullOrUndefined(this.nominationPeriod)||(l.isNullOrUndefined(this.cooldownPeriod)&&(this.cooldownPeriod=this.nominationPeriod),!l.isNumber(this.nominationPeriod.asTimeIntervalSeconds())&&(!l.isNumber(this.fallbackSurveyDurationSeconds)||this.fallbackSurveyDurationSeconds<=0)))},V);function V(){}n.CampaignNominationScheme=R;var G,z=(r(q,G=R),q.deserialize=function(t){var e=new q;return l.isNullOrUndefined(t)?null:(t.DistributionModel&&(e.distributionModel=k.deserialize(t.DistributionModel)),t.CooldownPeriod&&(e.cooldownPeriod=A.deserialize(t.CooldownPeriod)),t.NominationPeriod&&(e.nominationPeriod=A.deserialize(t.NominationPeriod)),e.fallbackSurveyDurationSeconds=t.FallbackSurveyDurationSeconds,e.percentageDenominator=t.PercentageDenominator,e.percentageNumerator=t.PercentageNumerator,e.validate()?e:null)},q.prototype.evaluateNominationRules=function(){var t=Math.random();return Math.floor(t*this.percentageDenominator)<this.percentageNumerator},q.prototype.validate=function(){return!(!G.prototype.validate.call(this)||!l.isNumber(this.percentageDenominator)||!l.isNumber(this.percentageNumerator)||this.percentageDenominator<=0||this.percentageNumerator<0||this.percentageNumerator>this.percentageDenominator)},q);function q(){return G.call(this)||this}n.CampaignNominationSchemeRatioPercentage=z;var W=(H.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case 0:e=J.deserialize(t);break;case 1:e=K.deserialize(t)}return void 0===e?null:e},H.prototype.validate=function(){return!0},H);function H(){}n.CampaignSurveyEvent=W;var j,J=(r(Q,j=W),Q.deserialize=function(t){var e=new Q;return l.isNullOrUndefined(t)?null:(e.activity=t.Activity,e.count=t.Count,e.isAggregate=t.IsAggregate,e.validate()?e:null)},Q.prototype.validate=function(){return!(!j.prototype.validate.call(this)||l.isNullOrUndefined(this.activity)||!l.isString(this.activity)||!l.isNumber(this.count)||this.count<=0||!l.isBoolean(this.isAggregate))},Q);function Q(){return j.call(this)||this}n.CampaignSurveyEventCountedActivity=J;var Y,K=(r(Z,Y=W),Z.deserialize=function(t){var e=new Z,n=[];if(l.isNullOrUndefined(t))return null;for(var i in t.Sequence)if(t.Sequence.hasOwnProperty(i)){var r=t.Sequence[i];r&&n.push(J.deserialize(r))}return 0===n.length&&(n=null),e.sequence=n,e.validate()?e:null},Z.prototype.validate=function(){if(!Y.prototype.validate.call(this))return!1;if(l.isNullOrUndefined(this.sequence))return!1;for(var t in this.sequence)if(this.sequence.hasOwnProperty(t)&&!this.sequence[t])return!1;return!0},Z);function Z(){return Y.call(this)||this}n.CampaignSurveyEventCountedActivitySequence=K;var X=($.deserialize=function(t,e){var n=new $;return l.isNullOrUndefined(t)?null:(n.prompt=nt.deserialize(t.Prompt),n.rating=rt.deserialize(t.Rating),n.comment=at.deserialize(t.Question),n.multipleChoice=tt.deserialize(t.MultipleChoice),n.validate(e)?n:null)},$.prototype.validate=function(t){return!(l.isNullOrUndefined(this.prompt)||(t?l.isNullOrUndefined(this.rating)&&l.isNullOrUndefined(this.multipleChoice)&&l.isNullOrUndefined(this.comment):l.isNullOrUndefined(this.rating)||l.isNullOrUndefined(this.comment)))},$);function $(){}n.CampaignSurveyContent=X;var tt=(et.deserialize=function(t){var e=new et;return l.isNullOrUndefined(t)?null:(e.question=t.Question,e.availableOptions=t.AvailableOptions,e.minNumberOfSelectedOptions=t.MinNumberOfSelectedOptions,e.maxNumberOfSelectedOptions=t.MaxNumberOfSelectedOptions,e.validate()?e:null)},et.prototype.validate=function(){if(l.isNullOrUndefined(this.question)||!l.isString(this.question)||l.isNullOrUndefined(this.availableOptions)||!Array.isArray(this.availableOptions)||this.availableOptions.length<2||l.isNullOrUndefined(this.minNumberOfSelectedOptions)||!l.isNumber(this.minNumberOfSelectedOptions)||l.isNullOrUndefined(this.maxNumberOfSelectedOptions)||!l.isNumber(this.maxNumberOfSelectedOptions))return!1;for(var t in this.availableOptions)if(this.availableOptions.hasOwnProperty(t)&&!l.isString(this.availableOptions[t]))return!1;return!0},et);function et(){}n.CampaignSurveyContentMultipleChoice=tt;var nt=(it.deserialize=function(t){var e=new it;return l.isNullOrUndefined(t)?null:(e.title=t.Title,e.question=t.Question,e.yesLabel=t.YesLabel,e.noLabel=t.NoLabel,e.validate()?e:null)},it.prototype.validate=function(){return!(l.isNullOrUndefined(this.title)||!l.isString(this.title)||l.isNullOrUndefined(this.question)||!l.isString(this.question)||l.isNullOrUndefined(this.yesLabel)||!l.isString(this.yesLabel)||l.isNullOrUndefined(this.noLabel)||!l.isString(this.noLabel))},it);function it(){}n.CampaignSurveyContentPrompt=nt;var rt=(ot.deserialize=function(t){var e=new ot;return l.isNullOrUndefined(t)?null:(e.isZeroBased=t.IsZeroBased,e.question=t.Question,e.ratingValuesAscending=t.RatingValuesAscending,e.validate()?e:null)},ot.prototype.validate=function(){if(l.isNullOrUndefined(this.question)||!l.isString(this.question)||l.isNullOrUndefined(this.ratingValuesAscending)||!Array.isArray(this.ratingValuesAscending)||this.ratingValuesAscending.length<2||11<this.ratingValuesAscending.length)return!1;if(l.isNullOrUndefined(this.isZeroBased))this.isZeroBased=!1;else if(!l.isBoolean(this.isZeroBased))return!1;for(var t in this.ratingValuesAscending)if(this.ratingValuesAscending.hasOwnProperty(t)&&!l.isString(this.ratingValuesAscending[t]))return!1;return!0},ot);function ot(){}n.CampaignSurveyContentRating=rt;var at=(st.deserialize=function(t){var e=new st;return l.isNullOrUndefined(t)?null:(e.question=t.Question,e.validate()?e:null)},st.prototype.validate=function(){return!(l.isNullOrUndefined(this.question)||!l.isString(this.question))},st);function st(){}n.CampaignSurveyContentComment=at;var ut=(lt.deserialize=function(t){if(l.isNullOrUndefined(t))return null;var e=new lt;return e.contentMetadata=t.ContentMetadata,e.validate()?e:null},lt.prototype.validate=function(){return!(l.isNullOrUndefined(this.contentMetadata)||!l.isObject(this.contentMetadata))},lt);function lt(){}n.CampaignSurveyMetadata=ut;var ct,dt,pt=(gt.deserialize=function(t){var e;if(l.isNullOrUndefined(t))return null;switch(t.Type){case gt.Type.Nps5PointStatic:e=At.deserialize(t);break;case gt.Type.Nps11PointStatic:e=Ft.deserialize(t);break;case gt.Type.Fps:e=ht.deserialize(t);break;case gt.Type.Nlqs:e=yt.deserialize(t);break;case gt.Type.Nps:e=Ct.deserialize(t);break;case gt.Type.GenericMessagingSurface:e=Dt.deserialize(t)}return void 0===e?null:e},gt.prototype.validate=function(){return!l.isNullOrUndefined(this.activationEvent)},gt);function gt(){}n.CampaignSurveyTemplate=pt,ct=pt=n.CampaignSurveyTemplate||(n.CampaignSurveyTemplate={}),(dt=ct.Type||(ct.Type={}))[dt.Nps5PointStatic=0]="Nps5PointStatic",dt[dt.Nps11PointStatic=1]="Nps11PointStatic",dt[dt.Fps=2]="Fps",dt[dt.Nlqs=3]="Nlqs",dt[dt.Nps=4]="Nps",dt[dt.GenericMessagingSurface=22]="GenericMessagingSurface",n.CampaignSurveyTemplate=pt;var ft,ht=(r(mt,ft=pt),mt.deserialize=function(t){var e=new mt;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.content=X.deserialize(t.Content,!0),e.validate()?e:null)},mt.prototype.validate=function(){return!(!ft.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},mt);function mt(){return ft.call(this)||this}n.CampaignSurveyTemplateFps=ht;var vt,yt=(r(St,vt=pt),St.deserialize=function(t){var e=new St;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.content=X.deserialize(t.Content),e.validate()?e:null)},St.prototype.validate=function(){return!(!vt.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},St);function St(){return vt.call(this)||this}n.CampaignSurveyTemplateNlqs=yt;var bt,Ct=(r(Tt,bt=pt),Tt.deserialize=function(t){var e=new Tt;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.content=X.deserialize(t.Content),e.validate()?e:null)},Tt.prototype.validate=function(){return!(!bt.prototype.validate.call(this)||l.isNullOrUndefined(this.content))},Tt);function Tt(){return bt.call(this)||this}n.CampaignSurveyTemplateNps=Ct;var wt,At=(r(It,wt=pt),It.deserialize=function(t){var e=new It;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.validate()?e:null)},It.prototype.validate=function(){return!!wt.prototype.validate.call(this)},It);function It(){return wt.call(this)||this}n.CampaignSurveyTemplateNps5PointStatic=At;var Et,Ft=(r(Ot,Et=pt),Ot.deserialize=function(t){var e=new Ot;return l.isNullOrUndefined(t)?null:(e.activationEvent=W.deserialize(t.ActivationEvent),e.validate()?e:null)},Ot.prototype.validate=function(){return!!Et.prototype.validate.call(this)},Ot);function Ot(){return Et.call(this)||this}n.CampaignSurveyTemplateNps11PointStatic=Ft;var _t,Dt=(r(Nt,_t=pt),Nt.deserialize=function(t){if(l.isNullOrUndefined(t))return null;var e=new Nt;return e.activationEvent=W.deserialize(t.ActivationEvent),e.metadata=ut.deserialize(t.Metadata),e.validate()?e:null},Nt.prototype.validate=function(){return!(!_t.prototype.validate.call(this)||l.isNullOrUndefined(this.metadata))},Nt);function Nt(){return _t.call(this)||this}n.CampaignSurveyTemplateGenericMessagingSurface=Dt;var xt=(Bt.deserialize=function(t){var e=new Bt;if(l.isNullOrUndefined(t))return null;e.campaignId=t.CampaignId,e.governedChannelType=t.GovernedChannelType,e.startTime=t.StartTimeUtc,e.endTime=t.EndTimeUtc,e.launcherType=t.LauncherType;var n=x.deserialize(t.AdditionalDataRequested);return e.additionalDataRequested=n?n.additionalData:[],t.SurveyTemplate&&(e.surveyTemplate=pt.deserialize(t.SurveyTemplate)),t.NominationScheme&&(e.nominationScheme=R.deserialize(t.NominationScheme)),t.Scope&&(e.scope=m.deserialize(t.Scope)),e.validate()?e:null},Bt.prototype.validate=function(){if(l.isNullOrUndefined(this.scope)&&(this.scope=new S),l.isNullOrUndefined(this.campaignId)||!l.isString(this.campaignId))return!1;if(!l.isNumber(this.governedChannelType)||!l.isEnumValue(this.governedChannelType,s.GovernedChannelType))return!1;if(l.isNullOrUndefined(this.nominationScheme))return!1;if(l.isNullOrUndefined(this.surveyTemplate))return!1;if(!l.isNullOrUndefined(this.launcherType)&&!l.isString(this.launcherType))return!1;if(l.isNullOrUndefined(this.startTime))this.startTime=l.getDistantFuture();else{if(!l.isUtcDatetimeString(this.startTime))return!1;this.startTime=l.stringToDate(this.startTime)}if(l.isNullOrUndefined(this.endTime))this.endTime=l.getDistantFuture();else{if(!l.isUtcDatetimeString(this.endTime))return!1;this.endTime=l.stringToDate(this.endTime)}return!0},Bt);function Bt(){}function kt(t){var e=[];if(l.isNullOrUndefined(t))return{result:e,error:"Empty"};if(!Array.isArray(t))return{result:e,error:"Not an array"};for(var n=[],i=0;i<t.length;i++){var r=t[i];if(r){var o=xt.deserialize(r);o?e.push(o):n.push(i)}else n.push(i)}return{result:e,error:0<n.length?"Invalid campaign definitions at indexes: "+n.toString():void 0}}n.CampaignDefinition=xt,n.FilterValidCampaignDefinitions=kt;var Lt=(Pt.prototype.load=function(){var t,e=this.storage.read(o.FileType.CampaignDefinitions);if(l.isNullOrUndefined(e))return[];try{t=JSON.parse(e)}catch(t){return a.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed(t.toString()),[]}return kt(t).result},Pt.prototype.loadAsync=function(){var e=this.load();return new c.Promise(function(t){t(e)})},Pt);function Pt(t){if(l.isNullOrUndefined(t))throw new Error("storage must not be null");this.storage=t}n.FileSystemCampaignDefinitionProvider=Lt},{"../Api/IFloodgateStorageProvider":7,"../FloodgateEngine":17,"../GovernedChannel":19,"../ISurveyInfo":23,"../Utils":42,"es6-promise":43}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var l=t("../FloodgateEngine"),d=t("../Utils"),r=t("./CampaignDefinitionProvider"),p=t("./CampaignStateProvider"),o=t("./CampaignSurveyFactory"),c=t("es6-promise"),i=(g.isStateUpForNomination=function(t,e,n,i){if(!t||!e)return!1;if(n=n||new Date,t.ForceCandidacy)return!0;var r=e.nominationScheme.getCampaignCooldown(t.IsCandidate&&t.DidCandidateTriggerSurvey);return!!r&&(!!g.hasBuildChangeDurationElapsed(r,t.LastNominationBuildNumber,i)||g.hasTimeIntervalDurationElapsed(r,t.getCooldownStartDate(),n))},g.isDateInRange=function(t,e,n){return t=t||new Date,e=e||d.getDistantPast(),n=n||d.getDistantFuture(),e.getTime()<=t.getTime()&&n.getTime()>=t.getTime()},g.hasTimeIntervalDurationElapsed=function(t,e,n){if(d.isNullOrUndefined(t)||!(t instanceof r.CampaignDurationTimeInterval))return!1;if(!e||!n)return!1;var i=d.addSecondsWithoutOverflow(e,t.intervalSeconds);return n.getTime()>=i.getTime()},g.hasBuildChangeDurationElapsed=function(t,e,n){return!d.isNullOrUndefined(t)&&t instanceof r.CampaignDurationSingleBuildChange&&(d.isNullOrUndefined(e)||d.isNullOrUndefined(n)?null===e!=(null===n):!(e===n))},g.isCampaignInScope=function(t,e,n){return!(!t||(e=e||new Date,!g.isDateInRangeWithDefinition(e,t)||t.scope&&!t.scope.isInScope(n)))},g.isDateInRangeWithDefinition=function(t,e){return!!e&&(t=t||new Date,g.isDateInRange(t,e.startTime?e.startTime:d.getDistantFuture(),e.endTime))},g.prototype.getActiveSurveys=function(){var t={};for(var e in this.campaignStates)if(this.campaignStates.hasOwnProperty(e)){var n=this.campaignStates[e];if(!n.IsCandidate)continue;var i=this.campaignDefinitions[n.CampaignId];if(!i)continue;var r=o.CampaignSurveyFactory.makeSurvey(n,i.governedChannelType,i.surveyTemplate,this.stringProvider,i.additionalDataRequested,i.launcherType);if(!r)continue;t[r.getSurveyInfo().getId()]=r}return t},g.prototype.onCampaignSurveyActivated=function(t,e){var n=this.campaignStates[t];n&&(e=e||new Date,n.markCurrentSurveyTakenOnDate(e,this.campaignDefinitions[t].nominationScheme.cooldownPeriod.asTimeIntervalSeconds()),this.saveCurrentState())},g.prototype.getCampaignStates=function(){return this.campaignStates},g.prototype.getCampaignDefinitions=function(){return this.campaignDefinitions},g.prototype.onSurveyActivated=function(t){t&&this.onCampaignSurveyActivated(t.getBackEndId(),new Date)},g.prototype.refreshSurveyDefinitions=function(t,e){this.refreshSurveyDefinitionsPrivate(t,e||new Date)},g.prototype.refreshSurveyDefinitionsAsync=function(n,i){var r=this;return new c.Promise(function(t,e){r.refreshSurveyDefinitionsPrivateAsync(n,i||new Date).then(function(){t()}).catch(function(t){e(t)})})},g.prototype.getAppSurveys=function(){return this.getActiveSurveys()},g.prototype.saveCurrentState=function(){var t=d.makeArrayFromObjectValuesSortedByKeyString(this.campaignStates);this.stateProvider.save(t)},g.prototype.refreshSurveyDefinitionsPrivate=function(t,e){this.campaignStates={},this.campaignDefinitions={},this.loadAndFilterCampaignData(e,t),this.evaluateCampaigns(e)},g.prototype.refreshSurveyDefinitionsPrivateAsync=function(n,i){this.campaignStates={},this.campaignDefinitions={};var r=this;return new c.Promise(function(t,e){r.loadAndFilterCampaignDataAsync(i,n).then(function(){r.evaluateCampaigns(i),t()}).catch(function(t){e(t)})})},g.prototype.loadAndFilterCampaignDataAsync=function(o,a){o=o||new Date;for(var s=[],e=[],t=0,n=Object.keys(this.definitionProviders);t<n.length;t++){var i=n[t],r=this.definitionProviders[i].loadAsync();d.isNullOrUndefined(r)||(r=r.catch(function(){l.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider"),c.Promise.resolve()}),e.push(r))}var u=this;return new c.Promise(function(r,t){c.Promise.all(e).then(function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var i=t[n[e]];d.isArray(i)&&(s=s.concat(i))}u.FilterCampaignData(o,a,s),r()}).catch(function(){l.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider")})})},g.prototype.loadAndFilterCampaignData=function(t,e){t=t||new Date;for(var n=[],i=0,r=Object.keys(this.definitionProviders);i<r.length;i++){var o=r[i];try{var a=this.definitionProviders[o].load();d.isArray(a)&&(n=n.concat(a))}catch(t){l.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed("Failed to load from campaign definition provider. "+t.toString())}}this.FilterCampaignData(t,e,n)},g.prototype.FilterCampaignData=function(t,e,n){var i={};for(var r in n)if(n.hasOwnProperty(r)){if(i[(u=n[r]).campaignId]=u,e&&e.indexOf(u.governedChannelType)<0)continue;if(!g.isCampaignInScope(u,t,this.environmentProvider))continue;this.campaignDefinitions[u.campaignId]=u}var o=this.stateProvider.load(),a=[];for(var r in o)if(o.hasOwnProperty(r)){var s=o[r];this.campaignDefinitions.hasOwnProperty(s.CampaignId)||a.push(s),this.campaignStates[s.CampaignId]=s}for(var r in a)if(a.hasOwnProperty(r)){if(!(s=a[r]))continue;var u,l=!1;(u=i[s.CampaignId])?g.isStateUpForNomination(s,u,t,this.currentBuildNumber)&&(l=!0):s.LastNominationTimeUtc.getTime()<=d.subtractSecondsWithoutOverflow(t,s.DeleteAfterSecondsWhenStale).getTime()&&(l=!0),l&&delete this.campaignStates[s.CampaignId]}},g.prototype.evaluateCampaigns=function(t){for(var e in t=t||new Date,this.campaignDefinitions)if(this.campaignDefinitions.hasOwnProperty(e)){var n=this.campaignDefinitions[e],i=this.campaignStates[n.campaignId];if(!i||g.isStateUpForNomination(i,n,t,this.currentBuildNumber)){var r=i?i.LastSurveyId:"",o=i?i.LastSurveyStartTimeUtc:d.getDistantPast(),a=i?i.LastSurveyExpirationTimeUtc:d.getDistantPast(),s=i?i.LastSurveyActivatedTimeUtc:d.getDistantPast(),u=i?i.LastCooldownEndTimeUtc:d.getDistantPast(),l=i&&i.ForceCandidacy||n.nominationScheme.evaluateNominationRules();l&&(r=d.guid(),o=n.nominationScheme.calculateSurveyStartTimeFromDate(t),a=n.nominationScheme.calculateSurveyExpirationTimeFromSurveyStartTime(o));var c=new p.CampaignState(n.campaignId,t,this.currentBuildNumber,n.nominationScheme.getActiveSurveyTimeIntervalSeconds(),!1,l,!1,s,r,o,a,u);this.campaignStates[c.CampaignId]=c}}},g);function g(t,e,n,i,r,o){if(!t)throw new Error("stateProvider must not be null");if(!d.isArray(e))throw new Error("definitionProviders is either null or not an array type");if(!n)throw new Error("stringProvider must not be null");if(d.isNullOrUndefined(r))throw new Error("currentBuildNumber must not be null");this.campaignStates={},this.campaignDefinitions={},this.stateProvider=t,this.definitionProviders=e,this.stringProvider=n,this.environmentProvider=i,this.currentBuildNumber=r,o=o||new Date}n.CampaignManager=i},{"../FloodgateEngine":17,"../Utils":42,"./CampaignDefinitionProvider":12,"./CampaignStateProvider":14,"./CampaignSurveyFactory":15,"es6-promise":43}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Api/IFloodgateStorageProvider"),s=t("../Constants"),u=t("../FloodgateEngine"),l=t("../StateProviderHelpers"),r=t("../Utils"),c=i.FileType,a=l.StateListType,d=(o.deserialize=function(t){var e;if(!t)return null;try{e=new o(t.CampaignId,t.LastNominationTimeUtc,t.LastNominationBuildNumber,t.DeleteAfterSecondsWhenStale,!1,t.IsCandidate,t.DidCandidateTriggerSurvey,t.LastSurveyActivatedTimeUtc,t.LastSurveyId,t.LastSurveyStartTimeUtc,t.LastSurveyExpirationTimeUtc,t.LastCooldownEndTimeUtc)}catch(t){return u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.CampaignState.Deserialize.Failed,{ErrorMessage:t.toString()}),null}return e},o.prototype.validate=function(){if(!this.CampaignId||!r.isString(this.CampaignId))return!1;if(r.isNullOrUndefined(this.LastNominationBuildNumber)||!r.isString(this.LastNominationBuildNumber))return!1;if(!r.isNumber(this.DeleteAfterSecondsWhenStale)||this.DeleteAfterSecondsWhenStale<0)return!1;if(!r.isBoolean(this.IsCandidate)||!r.isBoolean(this.DidCandidateTriggerSurvey))return!1;if(this.IsCandidate){if(r.isNullOrUndefined(this.LastSurveyStartTimeUtc)||r.isNullOrUndefined(this.LastSurveyExpirationTimeUtc))return!1;if(!r.isString(this.LastSurveyId))return!1}if(this.DidCandidateTriggerSurvey&&r.isNullOrUndefined(this.LastSurveyActivatedTimeUtc))return!1;if(r.isNullOrUndefined(this.LastSurveyId))this.LastSurveyId="";else if(!r.isString(this.LastSurveyId))return!1;if(r.isUtcDatetimeString(this.LastNominationTimeUtc))this.LastNominationTimeUtc=r.stringToDate(this.LastNominationTimeUtc);else if(!r.isDate(this.LastNominationTimeUtc))return!1;if(r.isNullOrUndefined(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=r.getDistantPast();else if(r.isUtcDatetimeString(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=r.stringToDate(this.LastSurveyActivatedTimeUtc);else if(!r.isDate(this.LastSurveyActivatedTimeUtc))return!1;if(r.isNullOrUndefined(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=r.getDistantPast();else if(r.isUtcDatetimeString(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=r.stringToDate(this.LastSurveyStartTimeUtc);else if(!r.isDate(this.LastSurveyStartTimeUtc))return!1;if(r.isNullOrUndefined(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=r.getDistantPast();else if(r.isUtcDatetimeString(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=r.stringToDate(this.LastSurveyExpirationTimeUtc);else if(!r.isDate(this.LastSurveyExpirationTimeUtc))return!1;if(r.isNullOrUndefined(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=r.getDistantPast();else if(r.isUtcDatetimeString(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=r.stringToDate(this.LastCooldownEndTimeUtc);else if(!r.isDate(this.LastCooldownEndTimeUtc))return!1;return!0},o.prototype.markCurrentSurveyTakenOnDate=function(t,e){this.DidCandidateTriggerSurvey=!0,this.LastSurveyActivatedTimeUtc=null!=t?t:new Date,this.LastCooldownEndTimeUtc=r.addSecondsWithoutOverflow(this.LastSurveyActivatedTimeUtc,e)},o.prototype.getCooldownStartDate=function(){return this.IsCandidate?this.DidCandidateTriggerSurvey?this.LastSurveyActivatedTimeUtc:this.LastSurveyStartTimeUtc:this.LastNominationTimeUtc},o);function o(t,e,n,i,r,o,a,s,u,l,c,d){if(this.CampaignId=t,this.LastNominationTimeUtc=e,this.LastNominationBuildNumber=n,this.DeleteAfterSecondsWhenStale=i,this.ForceCandidacy=r,this.IsCandidate=o,this.DidCandidateTriggerSurvey=a,this.LastSurveyActivatedTimeUtc=s,this.LastSurveyId=u,this.LastSurveyStartTimeUtc=l,this.LastSurveyExpirationTimeUtc=c,this.LastCooldownEndTimeUtc=d,!this.validate())throw new Error("Constructor arguments are not valid")}n.CampaignState=d;var p=(g.make=function(t,e){return e?new h(t,e):new v(t)},g);function g(){}n.CampaignStateProviderFactory=p;var f=function(){},h=(m.prototype.load=function(){var t,e=this.getStatesFromHost();return this.fileBasedStateProvider&&(t=this.fileBasedStateProvider.load()),l.MergeAndUpdateCampaignStates(t,e).find(a.Merged)},m.prototype.save=function(t){var n=this;if(t){var e=this.getStatesFromHost(),i=l.MergeAndUpdateCampaignStates(t,e),r=i.find(a.ToBeUpdated),o=i.find(a.Merged);r&&r.forEach(function(t){var e=l.makeSettingItemValue(JSON.stringify(t));n.hostBasedStorage.upsertSettingItem(c[c.CampaignStates],t.CampaignId,e)}),this.fileBasedStateProvider&&this.fileBasedStateProvider.save(o)}},m.prototype.getStatesFromHost=function(){var t=[],e=this.hostBasedStorage.readSettingList(c[c.CampaignStates]);for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],r=l.extractSettingItemValueSubString(i),o={};try{o=JSON.parse(r);var a=d.deserialize(o);a&&t.push(a)}catch(t){u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.HostBasedCampaignStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+r})}}return t},m);function m(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStateProvider=new v(t))}n.HostBasedCampaignStateProvider=h;var v=(y.prototype.load=function(){var t,e=this.storage.read(i.FileType.CampaignStates);if(!e)return[];try{t=JSON.parse(e);var n=[];return t&&t.CampaignStates&&t.CampaignStates.forEach(function(t){var e=d.deserialize(t);e&&n.push(e)}),n}catch(t){return u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.FileBasedCampaignStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+e}),[]}},y.prototype.save=function(t){if(t){var e=new f;e.CampaignStates=t;var n=JSON.stringify(e);this.storage.write(i.FileType.CampaignStates,n)}},y);function y(t){if(!t)throw new Error("storage must not be null");this.storage=t}n.FileBasedCampaignStateProvider=v},{"../Api/IFloodgateStorageProvider":7,"../Constants":16,"../FloodgateEngine":17,"../StateProviderHelpers":25,"../Utils":42}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Api/ISurvey"),s=t("../SurveyEvents"),i=t("../SurveyMetadata"),u=t("../Surveys/FpsSurvey"),l=t("../Surveys/GenericMessagingSurfaceSurvey"),c=t("../Surveys/NlqsSurvey"),d=t("../Surveys/NpsSurvey"),p=t("../Surveys/SurveyDataSource"),g=t("../Utils"),f=t("./CampaignDefinitionProvider"),r=(h.makeSurvey=function(t,e,n,i,r,o){return t&&n&&i?n instanceof f.CampaignSurveyTemplateNps5PointStatic?d.make5Point(h.makeSurveyDataSourceData(t,e,n,r,o),i):n instanceof f.CampaignSurveyTemplateNps11PointStatic?d.make11Point(h.makeSurveyDataSourceData(t,e,n,r,o),i):n instanceof f.CampaignSurveyTemplateFps?u.makeFps(h.makeSurveyDataSourceData(t,e,n,r,o),i,n):n instanceof f.CampaignSurveyTemplateNlqs?c.makeNlqs(h.makeSurveyDataSourceData(t,e,n,r,o),i,n):n instanceof f.CampaignSurveyTemplateNps?d.makeCustom(h.makeSurveyDataSourceData(t,e,n,r,o),i,n):n instanceof f.CampaignSurveyTemplateGenericMessagingSurface?l.makeCustom(h.makeSurveyDataSourceData(t,e,n,r,o)):null:null},h.makeSurveyDataSourceData=function(t,e,n,i,r){if(!t||!n)return null;var o=new p.SurveyDataSourceData;return o.activationEvent=h.makeEvent(t,n.activationEvent),o.metadata=h.makeMetadata(n.metadata),o.id=t.LastSurveyId,o.backEndIdentifier=t.CampaignId,o.expirationTimeUtc=g.dateToShortUtcString(t.LastSurveyExpirationTimeUtc),o.governedChannelType=e,o.startTimeUtc=g.dateToShortUtcString(t.LastSurveyStartTimeUtc),o.additionalDataRequested=i||[],o.launcherType=r||a.LAUNCHER_TYPE_DEFAULT,o},h.makeCountedActivityEventData=function(t){if(!t)return null;var e=new s.CountedActivityEventData;return e.activity=t.activity,e.count=t.count,e.isAggregate=t.isAggregate,e},h.makeCountedActivityEvent=function(t,e){if(!t||!e)return null;var n=h.makeCountedActivityEventData(e);return n?new s.CountedActivityEvent(n):null},h.makeCountedActivitySequenceEvent=function(t,e){if(!t||!e)return null;var n=new s.CountedActivitySequenceEventData;n.sequence=[];for(var i=0,r=e.sequence;i<r.length;i++){var o=r[i],a=h.makeCountedActivityEventData(o);if(!a)return null;n.sequence.push(a)}return new s.CountedActivitySequenceEvent(n)},h.makeEvent=function(t,e){return e instanceof f.CampaignSurveyEventCountedActivity?h.makeCountedActivityEvent(t,e):e instanceof f.CampaignSurveyEventCountedActivitySequence?h.makeCountedActivitySequenceEvent(t,e):null},h.makeMetadata=function(t){if(g.isNullOrUndefined(t)||g.isNullOrUndefined(t.contentMetadata))return null;var e=new i.Metadata;return e.contentMetadata=t.contentMetadata,new i.SurveyMetadata(e)},h);function h(){}n.CampaignSurveyFactory=r},{"../Api/ISurvey":10,"../SurveyEvents":31,"../SurveyMetadata":32,"../Surveys/FpsSurvey":36,"../Surveys/GenericMessagingSurfaceSurvey":37,"../Surveys/NlqsSurvey":38,"../Surveys/NpsSurvey":39,"../Surveys/SurveyDataSource":41,"../Utils":42,"./CampaignDefinitionProvider":12}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,r,o,a,s,u,l,c,d,p,g,f,h,m,v,y,S,b,C,T,w,A,I,E,F,O,_,D,N,x,B=(k.CampaignState=((i=function(){}).Deserialize=((r=function(){}).Failed="FloodgateCore_CampaignState_Deserialize_Failed",r),i),k.FileBasedCampaignStateProvider=((o=function(){}).Load=((a=function(){}).Failed="FloodgateCore_FileBasedCampaignStateProvider_Load_Failed",a),o),k.HostBasedCampaignStateProvider=((s=function(){}).GetStatesFromHost=((u=function(){}).Failed="FloodgateCore_HostBasedCampaignStateProvider_GetStatesFromHost_Failed",u),s),k.Floodgate=((l=function(){}).Initialize=((c=function(){}).Failed="FloodgateCore_Floodgate_Initialize_Failed",c),l.Start=((d=function(){}).Failed="FloodgateCore_Floodgate_Start_Failed",d),l),k.FloodgateEngine=((p=function(){}).Make=((g=function(){}).Failed="FloodgateCore_FloodgateEngine_Make_Failed",g),p.Start=((f=function(){}).Failed="FloodgateCore_FloodgateEngine_Start_Failed",f),p.StartAsync=((h=function(){}).Failed="FloodgateCore_FloodgateEngine_StartAsync_Failed",h.Stopped="FloodgateCore_FloodgateEngine_StartAsync_Stopped",h),p.OnSurveyActivated=((m=function(){}).ActivationStatsSuppressedSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationStatsSuppressedSurvey",m.ClosedChannelType="FloodgateCore_FloodgateEngine_OnSurveyActivated_ClosedChannelType",m),p),k.GovernedChannelState=((v=function(){}).Deserialize=((y=function(){}).Failed="FloodgateCore_GovernedChannelState_Deserialize_Failed",y),v),k.FileBasedGovernedChannelStateProvider=((S=function(){}).Load=((b=function(){}).Failed="FloodgateCore_FileBasedGovernedChannelStateProvider_Load_Failed",b),S),k.HostBasedGovernedChannelStateProvider=((C=function(){}).GetStatesFromHost=((T=function(){}).Failed="FloodgateCore_HostBasedGovernedChannelStateProvider_GetStatesFromHost_Failed",T),C),k.SurveyStatCollectionActivation=((w=function(){}).FromJson=((A=function(){}).Failed="FloodgateCore_SurveyStatCollectionActivation_FromJson_Failed",A),w.ToJson=((I=function(){}).Failed="FloodgateCore_SurveyStatCollectionActivation_ToJson_Failed",I),w),k.HostBasedSurveyActivationStatsProvider=((E=function(){}).GetSurveyStatsFromHost=((F=function(){}).Failed="FloodgateCore_HostBasedSurveyActivationStatsProvider_GetSurveyStatsFromHost_Failed",F),E),k.SurveyStatCollectionEventActivity=((O=function(){}).FromJson=((_=function(){}).Failed="FloodgateCore_SurveyStatCollectionEventActivity_FromJson_Failed",_),O.ToJson=((D=function(){}).Failed="FloodgateCore_SurveyStatCollectionEventActivity_ToJson_Failed",D),O),k.SurveyActivity=((N=function(){}).LogActivity=((x=function(){}).EventsDropped="FloodgateCore_SurveyActivity_LogActivity_EventsDropped",x),N),k);function k(){}n.TelemetryEvent=B},{}],17:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("./Api/IFloodgateStorageProvider"),p=t("./Campaign/CampaignDefinitionProvider"),g=t("./Campaign/CampaignManager"),f=t("./Campaign/CampaignStateProvider"),h=t("./Constants"),i=t("./FloodgateSettings"),r=t("./GovernedChannel"),m=t("./GovernedChannelStateProvider"),v=t("./Governor"),y=t("./SurveyActivityListener"),S=t("./SurveyStatCollectionActivation"),l=t("./SurveyStatCollectionEventActivity"),a=t("es6-promise"),s=(u.prototype.log_TriggerMet=function(t,e,n){},u.prototype.log_UserSelected=function(t,e,n){},u.prototype.log_CampaignLoad_Failed=function(t){},u.prototype.log_Event=function(t,e){},u);function u(){}var b={run:function(t){},shouldAcceptActivity:function(t){return!0}},c=(C.setTelemetryLogger=function(t){if(!t)throw new Error("telemetryLogger must not be null");C.telemetryLogger=t},C.getTelemetryLogger=function(){return C.telemetryLogger},C.getTransportFactory=function(){return C.transporterFactory},C.make=function(t,e,n,i,r,o,a,s,u){try{var l=m.GovernedChannelStateProviderFactory.make(i,r),c=S.SurveyActivationStatsProviderFactory.make(i,r),d=f.CampaignStateProviderFactory.make(i,r);return u.push(new p.FileSystemCampaignDefinitionProvider(i)),new C(new g.CampaignManager(d,u,o,a,t,new Date),new y(b,this.getTelemetryLogger),e,n,i,new v.Governor(l),c,s)}catch(t){this.telemetryLogger.log_Event(h.TelemetryEvent.FloodgateEngine.Make.Failed,{ErrorMessage:t.toString()})}},C.prototype.mergeAndSave=function(){this.saveSettings(),this.saveSurveyActivationHistory(),this.saveSurveyEventActivityHistory(),this.surveyClient.saveCurrentState(),this.governor.saveChannelStates()},C.prototype.start=function(){if(2!==this.initializationStatus&&3!==this.initializationStatus)try{this.setInitializationStatus(2),this.loadSettingsAndPriorEventCounts();var t=this.getAvailableChannelTypes();this.surveyClient.refreshSurveyDefinitions(t),this.setPendingSurveysAndStartFloodgate(),this.setInitializationStatus(3)}catch(t){this.setInitializationStatus(1),C.getTelemetryLogger().log_Event(h.TelemetryEvent.FloodgateEngine.Start.Failed,{ErrorMessage:t&&t.toString()})}},C.prototype.startAsync=function(){if(2===this.initializationStatus||3===this.initializationStatus)return a.Promise.resolve();try{this.setInitializationStatus(2),this.loadSettingsAndPriorEventCounts();var n=this.getAvailableChannelTypes(),i=this;return new a.Promise(function(t,e){i.surveyClient.refreshSurveyDefinitionsAsync(n).then(function(){4===i.initializationStatus?(i.setInitializationStatus(3),i.stop(),C.getTelemetryLogger().log_Event(h.TelemetryEvent.FloodgateEngine.StartAsync.Stopped,{ErrorMessage:"Stopped because of a pending stop() call"})):i.setPendingSurveysAndStartFloodgate(),t()}).catch(function(t){i.setInitializationStatus(1),C.getTelemetryLogger().log_Event(h.TelemetryEvent.FloodgateEngine.StartAsync.Failed,{ErrorMessage:t&&t.message}),e(t)})})}catch(t){return this.setInitializationStatus(1),C.getTelemetryLogger().log_Event(h.TelemetryEvent.FloodgateEngine.StartAsync.Failed,{ErrorMessage:t&&t.toString()}),a.Promise.resolve()}},C.prototype.stop=function(){3===this.initializationStatus&&(this.mergeAndSave(),this.setPendingSurveys(null),this.updateActivityListenerWithCurrentSurveyDefinitions()),this.setInitializationStatus(4)},C.prototype.getActivityListener=function(){return this.activityListener},C.prototype.setInitializationStatus=function(t){this.initializationStatus=t},C.prototype.saveSettings=function(){this.storage.fileLock(o.FileType.FloodgateSettings);try{this.writeString(o.FileType.FloodgateSettings,i.FloodgateSettings.toJson(this.floodgateSettings))}finally{this.storage.fileUnlock(o.FileType.FloodgateSettings)}},C.prototype.loadSettingsAndPriorEventCounts=function(){this.floodgateSettings=i.FloodgateSettings.fromJson(this.readString(o.FileType.FloodgateSettings)),this.previousSurveyActivationStats=this.surveyActivationStatsProvider.load(),this.previousSurveyEventActivityStats=l.SurveyStatCollectionEventActivity.fromJson(this.readString(o.FileType.SurveyEventActivityStats))},C.prototype.getAvailableChannelTypes=function(){var t=this.governor.getAvailableChannelData(),e=[];return t.forEach(function(t){t&&e.push(t.getType())}),e},C.prototype.setPendingSurveysAndStartFloodgate=function(){this.setPendingSurveys(this.surveyClient.getAppSurveys()),this.updateActivityListenerWithCurrentSurveyDefinitions(),this.setInitializationStatus(3),this.loggedFirstStart||(this.loggedFirstStart=!0,this.getActivityListener().logActivity(y.FloodgateStartActivityName))},C.prototype.saveSurveyActivationHistory=function(){this.storage.fileLock(o.FileType.SurveyActivationStats);try{var t=this.surveyActivationStatsProvider.load(),e=new S.SurveyStatCollectionActivation;for(var n in this.launchedSurveys)if(this.launchedSurveys.hasOwnProperty(n)){var i=new S.SurveyActivationStats,r=this.launchedSurveys[n];i.Type=r.getType(),i.ExpirationTimeUtc=r.getSurveyInfo().getExpirationTimeUtc(),i.ActivationTimeUtc=new Date,e.addStats(r.getSurveyInfo().getId(),i)}t.accumulate(e),this.surveyActivationStatsProvider.save(t),this.previousSurveyActivationStats=t}finally{this.storage.fileUnlock(o.FileType.SurveyActivationStats)}},C.prototype.saveSurveyEventActivityHistory=function(){this.storage.fileLock(o.FileType.SurveyEventActivityStats);try{var t=l.SurveyStatCollectionEventActivity.fromJson(this.readString(o.FileType.SurveyEventActivityStats)),a=new Date,s=new l.SurveyStatCollectionEventActivity,e=function(t){if(u.candidateSurveys.hasOwnProperty(t)){var e=new l.SurveyEventActivityStats,n=u.candidateSurveys[t];if(!n.getSurveyInfo().isActiveForDate(a))return"continue";e.ExpirationTimeUtc=n.getSurveyInfo().getExpirationTimeUtc();var i=n.getSurveyInfo().getActivationEvent().getTrackingSet(),r=[];if(i.getList().forEach(function(t){t&&t.getIsAggregate()&&r.push(t.getActivity())}),0===r.length)return"continue";e.Counts=new Array(r.length);for(var o=0;o<r.length;o++)e.Counts[o]=u.activityListener.moveSessionCountIntoBaseCount(r[o]);s.addStats(n.getSurveyInfo().getId(),e)}},u=this;for(var n in this.candidateSurveys)e(n);t.accumulate(s),this.writeString(o.FileType.SurveyEventActivityStats,l.SurveyStatCollectionEventActivity.toJson(t)),this.previousSurveyEventActivityStats=t}finally{this.storage.fileUnlock(o.FileType.SurveyEventActivityStats)}},C.prototype.setPendingSurveys=function(t){if(this.candidateSurveys={},t)for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];this.launcherFactory.AcceptsSurvey(n)&&(this.candidateSurveys[e]=n)}},C.prototype.updateActivityListenerWithCurrentSurveyDefinitions=function(){var t=new Array;for(var e in this.candidateSurveys)if(this.candidateSurveys.hasOwnProperty(e)){var n=this.candidateSurveys[e];if(this.previousSurveyActivationStats.getBySurveyId(n.getSurveyInfo().getId()))continue;if(!n.getSurveyInfo().isActiveForDate(new Date))continue;C.telemetryLogger.log_UserSelected(n.getSurveyInfo().getBackEndId(),n.getSurveyInfo().getId(),n.getType()),t.push(n)}this.activityListener.setSurveys(t,this.previousSurveyEventActivityStats)},C.prototype.shouldAcceptActivity=function(t){return 3===this.initializationStatus||t===y.FloodgateStartActivityName},C.prototype.onSurveyActivated=function(t){C.telemetryLogger.log_TriggerMet(t.getSurveyInfo().getBackEndId(),t.getSurveyInfo().getId(),t.getType());var e=!1,n=t.getSurveyInfo().getGovernedChannelType();this.candidateSurveys[t.getSurveyInfo().getId()]&&t.getSurveyInfo().isActiveForDate(new Date)&&(this.governor.refreshChannelData(),this.governor.isChannelOpen(n)?this.surveyActivationStatsProvider.load().getBySurveyId(t.getSurveyInfo().getId())?C.getTelemetryLogger().log_Event(h.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationStatsSuppressedSurvey,{CampaignId:t.getSurveyInfo().getBackEndId(),SurveyId:t.getSurveyInfo().getId()}):0===Object.keys(this.launchedSurveys).length&&(this.launchedSurveys[t.getSurveyInfo().getId()]=t,e=!0):C.getTelemetryLogger().log_Event(h.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ClosedChannelType,{ClosedChannelType:r.GovernedChannelType[n]})),this.mergeAndSave(),this.activityListener.clearSurveys(),e&&(this.governor.startChannelCooldown(n),this.surveyClient.onSurveyActivated(t.getSurveyInfo()),this.launchLauncher(t))},C.prototype.readString=function(t){return this.storage.read(t)},C.prototype.writeString=function(t,e){this.storage.write(t,e)},C.prototype.launchLauncher=function(t){var e=this.launcherFactory.makeSurveyLauncher(t);e&&(this.launchedLaunchers.push(e),this.onSurveyActivatedCallback.onSurveyActivated(e,t))},C.telemetryLogger=new s,C);function C(t,e,n,i,r,o,a,s){if(this.initializationStatus=0,this.candidateSurveys={},this.launchedSurveys={},this.launchedLaunchers=[],!t)throw new Error("surveyClient must not be null");if(!e)throw new Error("activityListener must not be null");if(!n)throw new Error("launcherFactory must not be null");if(!i)throw new Error("onSurveyActivatedCallback must not be null");if(!r)throw new Error("storage must not be null");if(!o)throw new Error("governor must not be null");if(!s)throw new Error("transporterFactory must not be null");this.surveyClient=t,this.activityListener=e,this.launcherFactory=n,this.onSurveyActivatedCallback=i,this.storage=r,this.governor=o,this.surveyActivationStatsProvider=a,C.transporterFactory=s,this.loggedFirstStart=!1,this.setPendingSurveys(null),this.activityListener.clearSurveys();var u=this;this.activityListener.setCallback({run:function(t){u.onSurveyActivated(t)},shouldAcceptActivity:function(t){return u.shouldAcceptActivity(t)}})}n.FloodgateEngine=c},{"./Api/IFloodgateStorageProvider":7,"./Campaign/CampaignDefinitionProvider":12,"./Campaign/CampaignManager":13,"./Campaign/CampaignStateProvider":14,"./Constants":16,"./FloodgateSettings":18,"./GovernedChannel":19,"./GovernedChannelStateProvider":20,"./Governor":21,"./SurveyActivityListener":26,"./SurveyStatCollectionActivation":34,"./SurveyStatCollectionEventActivity":35,"es6-promise":43}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(r.toJson=function(t){return JSON.stringify(t)},r.fromJson=function(t){return JSON.parse(t)},r);function r(){}n.FloodgateSettings=i},{}],19:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i,o,a=t("./Utils");(i=n.GovernedChannelType||(n.GovernedChannelType={}))[i.Standard=0]="Standard",i[i.Urgent=1]="Urgent",i[i.Banner=2]="Banner",i[i.TeachingMessage=3]="TeachingMessage",(o=r=n.GovernedChannelType||(n.GovernedChannelType={})).getDefault=function(){return o.Standard};var s=(u.prototype.setCooldownStartTime=function(t){this.cooldownStartTime=t,a.isNullOrUndefined(this.cooldownStartTime)?this.cooldownEndTime=a.getDistantPast():this.cooldownEndTime=a.addSecondsWithoutOverflow(this.cooldownStartTime,this.cooldownSeconds)},u.prototype.isOpen=function(){return this.isOpenAtDate(new Date)},u.prototype.isOpenAtDate=function(t){return!!t&&t>this.cooldownEndTime},u.prototype.getType=function(){return this.type},u.prototype.getName=function(){return this.name},u.prototype.getCooldownSeconds=function(){return this.cooldownSeconds},u.prototype.getCooldownStartTime=function(){return this.cooldownStartTime},u.prototype.getCooldownEndTime=function(){return this.cooldownEndTime},u);function u(t,e,n,i){if(!a.isEnumValue(t,r))throw new Error("type is not a valid GovernedChannelType");if(!e)throw new Error("name must not be null or empty");if(n<0)throw new Error("cooldownSeconds must not be negative");this.type=t,this.name=e,this.cooldownSeconds=n,this.setCooldownStartTime(i)}n.GovernedChannel=s},{"./Utils":42}],20:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Api/IFloodgateStorageProvider"),s=t("./Constants"),u=t("./FloodgateEngine"),r=t("./GovernedChannel"),l=t("./StateProviderHelpers"),o=t("./Utils"),c=i.FileType,a=l.StateListType,d=(p.deserialize=function(t){var e;if(!t)return null;try{e=new p(t.ChannelType,t.CooldownStartTimeUtc)}catch(t){return u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.GovernedChannelState.Deserialize.Failed,{ErrorMessage:t.toString()}),null}return e},p.prototype.validate=function(){return!!o.isEnumValue(this.ChannelType,r.GovernedChannelType)&&(o.isUtcDatetimeString(this.CooldownStartTimeUtc)?this.CooldownStartTimeUtc=o.stringToDate(this.CooldownStartTimeUtc):!o.isNullOrUndefined(this.CooldownStartTimeUtc)&&o.isDate(this.CooldownStartTimeUtc)||(this.CooldownStartTimeUtc=o.getDistantPast()),!0)},p.prototype.getType=function(){return this.ChannelType},p.prototype.getCooldownStartTime=function(){return this.CooldownStartTimeUtc},p);function p(t,e){if(this.ChannelType=t,this.CooldownStartTimeUtc=e,!this.validate())throw new Error("Constructor arguments are not valid")}n.GovernedChannelState=d;var g=(f.make=function(t,e){return e?new m(t,e):new y(t)},f);function f(){}n.GovernedChannelStateProviderFactory=g;var h=function(){},m=(v.prototype.load=function(){var t,e=this.getStatesFromHost();return this.fileBasedStateProvider&&(t=this.fileBasedStateProvider.load()),l.MergeAndUpdateGovernedChannelStates(t,e).find(a.Merged)},v.prototype.save=function(t){var n=this;if(t){var e=this.getStatesFromHost(),i=l.MergeAndUpdateGovernedChannelStates(t,e),r=i.find(a.ToBeUpdated),o=i.find(a.Merged);r&&r.forEach(function(t){var e=l.makeSettingItemValue(JSON.stringify(t));n.hostBasedStorage.upsertSettingItem(c[c.GovernedChannelStates],String(t.getType()),e)}),this.fileBasedStateProvider&&this.fileBasedStateProvider.save(o)}},v.prototype.getStatesFromHost=function(){var t=[],e=this.hostBasedStorage.readSettingList(c[c.GovernedChannelStates]);for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],r=l.extractSettingItemValueSubString(i),o={};try{o=JSON.parse(r);var a=d.deserialize(o);a&&t.push(a)}catch(t){u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.HostBasedGovernedChannelStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+r})}}return t},v);function v(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStateProvider=new y(t))}n.HostBasedGovernedChannelStateProvider=m;var y=(S.prototype.load=function(){var t,e=this.storage.read(c.GovernedChannelStates);if(!e)return[];try{t=JSON.parse(e);var n=[];return t&&t.ChannelStates&&t.ChannelStates.forEach(function(t){var e=d.deserialize(t);e&&n.push(e)}),n}catch(t){return u.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.FileBasedGovernedChannelStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+e}),[]}},S.prototype.save=function(t){if(t){var e=new h;e.ChannelStates=t;var n=JSON.stringify(e);this.storage.write(c.GovernedChannelStates,n)}},S);function S(t){if(!t)throw new Error("storage must not be null");this.storage=t}n.FileBasedGovernedChannelStateProvider=y},{"./Api/IFloodgateStorageProvider":7,"./Constants":16,"./FloodgateEngine":17,"./GovernedChannel":19,"./StateProviderHelpers":25,"./Utils":42}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("./GovernedChannel"),r=t("./GovernedChannelStateProvider"),i=t("./Utils"),o=function(t,e){this.name=t,this.cooldownSeconds=e},s=(u.prototype.refreshChannelData=function(){this.loadChannels()},u.prototype.getAvailableChannelData=function(){var t=[];for(var e in this.channels)if(this.channels.hasOwnProperty(e)){var n=this.channels[e];n.isOpen()&&t.push(n)}return t},u.prototype.isChannelOpen=function(t){if(i.isNullOrUndefined(t))throw new Error("type must not be null");return this.channels[t].isOpen()},u.prototype.startChannelCooldown=function(t,e){if(i.isNullOrUndefined(t))throw new Error("type must not be null");e=e||new Date,this.channels[t].setCooldownStartTime(e),this.saveChannelStates()},u.prototype.saveChannelStates=function(){var t=[];for(var e in this.channels)if(this.channels.hasOwnProperty(e)){var n=this.channels[e],i=new r.GovernedChannelState(n.getType(),n.getCooldownStartTime());t.push(i)}this.channelStateProvider.save(t)},u.prototype.loadChannels=function(){for(var t in this.loadChannelStatesFromProvider(),a.GovernedChannelType)if(a.GovernedChannelType.hasOwnProperty(t)){var e=Number(t);if(isNaN(e)||this.channels[e])continue;var n=u.defaultChannelData[e],i=new a.GovernedChannel(e,n.name,n.cooldownSeconds,null);this.channels[e]=i}},u.prototype.loadChannelStatesFromProvider=function(){this.channels=[];var t=this.channelStateProvider.load();for(var e in t)if(t.hasOwnProperty(e)){var n=t[e],i=n.getType(),r=u.defaultChannelData[i],o=new a.GovernedChannel(i,r.name,r.cooldownSeconds,n.getCooldownStartTime());this.channels[o.getType()]=o}},u.day=24*(u.hour=60*(u.minute=60)),u.defaultChannelData=[new o(a.GovernedChannelType[a.GovernedChannelType.Standard],14*u.day),new o(a.GovernedChannelType[a.GovernedChannelType.Urgent],0),new o(a.GovernedChannelType[a.GovernedChannelType.Banner],15*u.day),new o(a.GovernedChannelType[a.GovernedChannelType.TeachingMessage],15*u.day)],u);function u(t){if(!t)throw new Error("channelStateProvider must not be null");this.channelStateProvider=t,this.loadChannels()}n.Governor=s},{"./GovernedChannel":19,"./GovernedChannelStateProvider":20,"./Utils":42}],22:[function(t,e,n){"use strict";var i,r,o;r=i=i||{},(o=r.Type||(r.Type={}))[o.CountedActivity="CountedActivity"]="CountedActivity",o[o.CountedActivitySequence="CountedActivitySequence"]="CountedActivitySequence",e.exports=i},{}],23:[function(t,e,n){"use strict";var i,r,o,a;r=i=i||{},(o=r.LaunchType||(r.LaunchType={}))[o.Default="Default"]="Default",o[o.Notification="Notification"]="Notification",o[o.Modal="Modal"]="Modal",(a=r.AdditionalDataType||(r.AdditionalDataType={}))[a.EmailAddress=0]="EmailAddress",r.DOM_TYPE_TAGNAME="Type",r.DOM_TYPE_VALUE="Survey",r.DOM_ID_TAGNAME="SurveyID",r.JSON_SURVEY_KEYNAME="survey",r.JSON_ID_KEYNAME="surveyId",e.exports=i},{}],24:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});function i(){}n.IndexedTracker=i},{}],25:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var d,i,p=t("../src/SurveyStatCollectionActivation");(i=d=n.StateListType||(n.StateListType={}))[i.Merged=0]="Merged",i[i.ToBeUpdated=1]="ToBeUpdated";var g=(r.prototype.add=function(t,e){this.items[t]||this.itemCount++,this.items[t]=e},r.prototype.find=function(t){return this.items[t]},r.prototype.remove=function(t){var e=this.items[t];return e&&(delete this.items[t],this.itemCount--),e},r.prototype.count=function(){return this.itemCount},r);function r(){this.items={},this.itemCount=0}n.ItemCollection=g,n.extractSettingItemValueSubString=function(t){if(!t)return t;var e=t.indexOf(o)+o.length,n=t.indexOf(a);return e<0||n<0?t:t.substring(e,n)},n.makeSettingItemValue=function(t){return t?o+t+a:o+a},n.MergeAndUpdateGovernedChannelStates=function(t,r){var e=new g;if(!t&&!r)return e;if(!t)return e.add(d.Merged,r),e;if(!r)return e.add(d.Merged,t),e.add(d.ToBeUpdated,t),e;var o=[],a=[];return t&&t.forEach(function(t){for(var e,n=-1,i=0;i<r.length;i++)if((e=r[i]).getType()===t.getType()){n=i;break}if(-1===n)return o.push(t),void a.push(t);t.getCooldownStartTime()>e.getCooldownStartTime()?(o.push(t),a.push(t)):o.push(e),r.splice(n,1)}),r&&r.forEach(function(t){o.push(t)}),e.add(d.Merged,o),0<a.length&&e.add(d.ToBeUpdated,a),e},n.MergeAndUpdateCampaignStates=function(t,o){var e=new g;if(!t&&!o)return e;if(!t)return e.add(d.Merged,o),e;if(!o)return e.add(d.Merged,t),e.add(d.ToBeUpdated,t),e;var a=[],s=[];return t&&t.forEach(function(t){for(var e,n=new Date,i=-1,r=0;r<o.length;r++)if((e=o[r]).CampaignId===t.CampaignId){i=r;break}return-1===i?(a.push(t),void s.push(t)):(e.LastCooldownEndTimeUtc>n?a.push(e):t.LastCooldownEndTimeUtc>n?(a.push(t),s.push(t)):t.getCooldownStartDate()>e.getCooldownStartDate()||t.getCooldownStartDate()===e.getCooldownStartDate()&&t.LastNominationTimeUtc>e.LastNominationTimeUtc?(a.push(t),s.push(t)):a.push(e),void o.splice(i,1))}),o&&o.forEach(function(t){a.push(t)}),e.add(d.Merged,a),0<s.length&&e.add(d.ToBeUpdated,s),e},n.MergeAndUpdateSurveyActivationStats=function(t,e){var n=new g;if(!t&&!e)return n;if(!t)return n.add(d.Merged,e),n;if(!e)return n.add(d.Merged,t),n.add(d.ToBeUpdated,t),n;var i=new p.SurveyStatCollectionActivation,r=new p.SurveyStatCollectionActivation,o=t.getStats(),a=e.getStats();for(var s in o)if(o.hasOwnProperty(s)){var u=a[s];if(!u){i.addStats(s,o[s]),r.addStats(s,o[s]);continue}o[s].ActivationTimeUtc>u.ActivationTimeUtc?(i.addStats(s,o[s]),r.addStats(s,o[s])):i.addStats(s,a[s]),delete a[s]}for(var s in a)a.hasOwnProperty(s)&&i.addStats(s,a[s]);n.add(d.Merged,i);var l=r.getStats();for(var c in l)if(l.hasOwnProperty(c)){n.add(d.ToBeUpdated,r);break}return n};var o="<data>",a="</data>"},{"../src/SurveyStatCollectionActivation":34}],26:[function(t,e,n){"use strict";var i,r,w=t("./ActivityTracker"),a=t("./Constants"),A=t("./IndexedTracker"),I=t("./SurveyStatCollectionEventActivity"),s=0,o=(u.prototype.logActivity=function(t,e){void 0===e&&(e=1),this.logActivity_private(t,u.LogActionType.Increment,e,null)},u.prototype.logActivityStartTime=function(t,e){this.logActivity_private(t,u.LogActionType.StartTime,0,e)},u.prototype.logActivityStopTime=function(t,e){this.logActivity_private(t,u.LogActionType.StopTime,0,e)},u.prototype.setSurveys=function(t,e){if(void 0===e&&(e=new I.SurveyStatCollectionEventActivity),t&&0!==t.length&&e){for(var n=new Object,i=0,r=t;i<r.length;i++){for(var o=r[i],a=o.getSurveyInfo().getActivationEvent().getTrackingSet(),s=!1,u=0,l=a.getList();u<l.length;u++){var c=l[u];if(n.hasOwnProperty(c.getActivity())){s=!0;break}}if(!s){for(var d=e.getBySurveyId(o.getSurveyInfo().getId()),p=[a.getList().length],g=new Array(a.getList().length),f=0,h=0,m=0,v=a.getList();m<v.length;m++)c=v[m],p[h]=0,c.getIsAggregate()&&d&&f<d.Counts.length&&(p[h]=d.Counts[f++]),g[h]=this.trackedActivityMap[c.getActivity()],h++;var y=new w(a);y.initCounts(p,g,!1);for(var S=0,b=y.generateActivityIndexList();S<b.length;S++){var C=b[S],T=new A.IndexedTracker;T.index=C.index,T.survey=o,T.tracker=y,n[C.activity]=T}}}this.copyObject(this.trackedActivityMap,n)}},u.prototype.clearSurveys=function(){var e=this;Object.getOwnPropertyNames(this.trackedActivityMap).forEach(function(t){delete e.trackedActivityMap[t]})},u.prototype.getCount=function(t){var e;return(e=this.trackedActivityMap[t])?e.tracker.getCount(e.index):0},u.prototype.getSessionCount=function(t){var e;return(e=this.trackedActivityMap[t])?e.tracker.getSessionCount(e.index):0},u.prototype.moveSessionCountIntoBaseCount=function(t){var e;return(e=this.trackedActivityMap[t])?e.tracker.moveSessionCountIntoBaseCount(e.index):0},u.prototype.getSurvey=function(t){var e;return(e=this.trackedActivityMap[t])?e.survey:null},u.prototype.setCallback=function(t){this.callback=t},u.prototype.logActivity_private=function(t,e,n,i){if(this.callback&&!this.callback.shouldAcceptActivity(t)&&s++,t===u.FloodgateStartActivityName){if(0<s){var r=this.loggerCallback&&this.loggerCallback();r&&r.log_Event(a.TelemetryEvent.SurveyActivity.LogActivity.EventsDropped,{Count:s})}s=0}var o=this.trackedActivityMap[t];if(o){switch(e){case u.LogActionType.StartTime:return void o.tracker.startTime(o.index,i);case u.LogActionType.StopTime:n=o.tracker.stopTime(o.index,i);case u.LogActionType.Increment:break;default:return}o.tracker.incrementActivity(o.index,n)===w.IncrementResult.AllActivitiesActivated&&this.executeCallback(o.survey)}},u.prototype.executeCallback=function(t){this.callback.run(t)},u.prototype.copyObject=function(e,n){Object.keys(n).forEach(function(t){e[t]=n[t]})},u.FloodgateStartActivityName="FloodgateFirstStart",u);function u(t,e){if(!t)throw new Error("callback must not be null");this.trackedActivityMap={},this.callback=t,this.loggerCallback=e}i=o=o||{},(r=i.LogActionType||(i.LogActionType={}))[r.Increment=0]="Increment",r[r.StartTime=1]="StartTime",r[r.StopTime=2]="StopTime",e.exports=o},{"./ActivityTracker":1,"./Constants":16,"./IndexedTracker":24,"./SurveyStatCollectionEventActivity":35}],27:[function(t,e,n){"use strict";var i=t("./../Api/ISurveyComponent"),r=(o.make=function(t){try{return new o(t)}catch(t){return null}},o.prototype.getType=function(){return i.Type.Comment},o.prototype.getQuestion=function(){return this.data.question},o.prototype.setSubmittedText=function(t){this.userComment=t},o.prototype.getSubmittedText=function(){return this.userComment},o.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(i.DOM_COMMENT_TAGNAME);return e.appendChild(t.createTextNode(this.getSubmittedText())),[e]},o.prototype.getJsonElements=function(){var t={};return t[i.JSON_COMMENT_KEYNAME]=this.getSubmittedText(),t},o.prototype.getComponentJson=function(){var t;return(t={})[i.JSON_QUESTION_KEYNAME]=this.getQuestion(),t},o);function o(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");this.data=t,this.userComment=""}(r||(r={})).CommentComponentData=function(){},e.exports=r},{"./../Api/ISurveyComponent":11}],28:[function(t,e,n){"use strict";var i=t("./../Api/ISurveyComponent"),r=(o.make=function(t){try{return new o(t)}catch(t){return null}},o.prototype.getType=function(){return i.Type.MultipleChoice},o.prototype.getQuestion=function(){return this.data.question},o.prototype.getAvailableOptions=function(){return this.data.availableOptions},o.prototype.getOptionSelectedStates=function(){return this.optionStates},o.prototype.getMinNumberofSelectedOptions=function(){return this.data.minNumberOfSelectedOptions},o.prototype.getMaxNumberofSelectedOptions=function(){return this.data.maxNumberOfSelectedOptions},o.prototype.setOptionSelectedStates=function(t){for(var e=0;e<t.length;e++)this.optionStates[e]=t[e]},o.prototype.ValidateMinNumberofSelectedOptions=function(){var e=0;return this.optionStates.forEach(function(t){t&&e++}),e>=this.getMinNumberofSelectedOptions()},o.prototype.ValidateMaxNumberofSelectedOptions=function(){var e=0;return this.optionStates.forEach(function(t){t&&e++}),e<=this.getMaxNumberofSelectedOptions()},o.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(i.DOM_MULTIPLECHOICE_TAGNAME);return e.appendChild(t.createTextNode(this.getOptionSelectedStates().toString())),[e]},o.prototype.getJsonElements=function(){var t={};return t[i.JSON_MULTIPLECHOICE_KEYNAME]=this.getOptionSelectedStates().toString(),t},o.prototype.getComponentJson=function(){var t;return(t={})[i.JSON_QUESTION_KEYNAME]=this.getQuestion(),t[i.JSON_RATINGOPTIONS_KEYNAME]=this.getAvailableOptions(),t},o);function o(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");if(!t.availableOptions||t.availableOptions.length<2)throw new Error("data.availableOptions must not be null or have less than two choices");t.availableOptions.forEach(function(t){if(!t)throw new Error("Option values must not contain null or empty")}),this.data=t,this.optionStates=new Array(t.availableOptions.length);for(var e=0;e<this.optionStates.length;e++)this.optionStates[e]=!1}(r||(r={})).MultipleChoiceComponentData=function(){},e.exports=r},{"./../Api/ISurveyComponent":11}],29:[function(t,e,n){"use strict";var i=t("./../Api/IPrompt"),r=t("./../Api/ISurveyComponent"),o=(a.make=function(t){try{return new a(t)}catch(t){return null}},a.prototype.getType=function(){return r.Type.Prompt},a.prototype.getTitle=function(){return this.data.title},a.prototype.getQuestion=function(){return this.data.question},a.prototype.getYesButtonText=function(){return this.data.yesButtonLabel},a.prototype.getNoButtonText=function(){return this.data.noButtonLabel},a.prototype.setButtonSelected=function(t){t&&(this.selectedButton=t)},a.prototype.getButtonSelected=function(){return this.selectedButton},a.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(r.DOM_PROMPT_TAGNAME);return e.appendChild(t.createTextNode(this.promptButtonToString(this.getButtonSelected()))),[e]},a.prototype.getJsonElements=function(){var t={};return t[r.JSON_PROMPT_KEYNAME]=this.promptButtonToString(this.getButtonSelected()),t},a.prototype.getComponentJson=function(){var t;return(t={})[r.JSON_PROMPTTITLE_KEYNAME]=this.getTitle(),t[r.JSON_QUESTION_KEYNAME]=this.getQuestion(),t[r.JSON_PROMPTYESTEXT_KEYNAME]=this.getYesButtonText(),t[r.JSON_PROMPTNOTEXT_KEYNAME]=this.getNoButtonText(),t},a.prototype.promptButtonToString=function(t){switch(t){case i.PromptButton.Unselected:return"Unselected";case i.PromptButton.Yes:return"Yes";case i.PromptButton.No:return"No";default:return"Unknown"}},a);function a(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");if(!t.title)throw new Error("data.title must not be null or empty");if(!t.yesButtonLabel)throw new Error("data.yesButtonLabel must not be null or empty");if(!t.noButtonLabel)throw new Error("data.noButtonLabel must not be null or empty");this.data=t,this.selectedButton=i.PromptButton.Unselected}(o||(o={})).PromptComponentData=function(){},e.exports=o},{"./../Api/IPrompt":9,"./../Api/ISurveyComponent":11}],30:[function(t,e,n){"use strict";var i=t("./../Api/ISurveyComponent"),r=(o.make=function(t){try{return new o(t)}catch(t){return null}},o.prototype.getType=function(){return i.Type.Rating},o.prototype.getQuestion=function(){return this.data.question},o.prototype.getRatingValuesAscending=function(){return this.data.ratingValuesAscending},o.prototype.getSelectedRating=function(){return this.isRatingIndexValid(this.selectedIndex)?this.data.ratingValuesAscending[this.selectedIndex]:""},o.prototype.setSelectedRatingIndex=function(t){this.isRatingIndexValid(t)?this.selectedIndex=t:this.selectedIndex=-1},o.prototype.getSelectedRatingIndex=function(){return this.selectedIndex},o.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(i.DOM_RATING_TAGNAME);return this.isRatingIndexValid(this.getSelectedRatingIndex())?e.appendChild(t.createTextNode(this.getNormalizedRatingScore().toFixed(6))):e.appendChild(t.createTextNode("Not rated")),[e]},o.prototype.getJsonElements=function(){var t={};return this.isRatingIndexValid(this.getSelectedRatingIndex())?t[i.JSON_RATING_KEYNAME]=this.getNormalizedRatingScore():t[i.JSON_RATING_KEYNAME]="Not rated",t},o.prototype.getComponentJson=function(){var t;return(t={})[i.JSON_QUESTION_KEYNAME]=this.getQuestion(),t[i.JSON_RATINGOPTIONS_KEYNAME]=this.getRatingValuesAscending(),t},o.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.getSelectedRatingIndex())?this.data.isZeroBased?this.selectedIndex/(this.data.ratingValuesAscending.length-1):(this.selectedIndex+1)/this.data.ratingValuesAscending.length:-1},o.prototype.isRatingIndexValid=function(t){return 0<=t&&t<this.data.ratingValuesAscending.length},o);function o(t){if(!t)throw new Error("data must not be null");if(!t.question)throw new Error("data.question must not be null or empty");if(!t.ratingValuesAscending||t.ratingValuesAscending.length<2)throw new Error("data.ratingValuesAscending must not be null or have less than two choices");t.ratingValuesAscending.forEach(function(t){if(!t)throw new Error("rating values must not contain null or empty")}),this.data=t,this.selectedIndex=-1}(r||(r={})).RatingComponentData=function(){},e.exports=r},{"./../Api/ISurveyComponent":11}],31:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("./ActivityTrackingData"),o=t("./ActivityTrackingSet"),i=t("./ISurveyEvent"),a=(s.make=function(t){try{return new s(t)}catch(t){return null}},s.prototype.getActivity=function(){return this.data.activity},s.prototype.getCount=function(){return this.data.count},s.prototype.isAggregate=function(){return this.data.isAggregate},s.prototype.getType=function(){return i.Type.CountedActivity},s.prototype.getTrackingSet=function(){var t=new Array;return t.push(new r.ActivityTrackingData(this.data.activity,this.data.count,this.data.isAggregate)),new o.ActivityTrackingSet(!1,t)},s);function s(t){if(!t)throw new Error("data must not be null");if(t.count<=0)throw new Error("count must be greater than 0");if(!t.activity||0===t.activity.length)throw new Error("activity must not be null or an empty string");this.data=t}n.CountedActivityEvent=a;function u(){}n.CountedActivityEventData=u;var l=(c.make=function(t){try{return new c(t)}catch(t){return null}},c.prototype.getSequence=function(){return this.data},c.prototype.getType=function(){return i.Type.CountedActivitySequence},c.prototype.getTrackingSet=function(){for(var t=new Array,e=0,n=this.data;e<n.length;e++){var i=n[e];t.push(new r.ActivityTrackingData(i.getActivity(),i.getCount(),i.isAggregate()))}return new o.ActivityTrackingSet(!0,t)},c);function c(t){if(!t)throw new Error("data must not be null");if(!t.sequence)throw new Error("data.sequence must not be null");if(0===t.sequence.length)throw new Error("data.sequence size must be greater than 0");this.data=[];for(var e=0,n=t.sequence;e<n.length;e++){var i=n[e];this.data.push(new a(i))}}n.CountedActivitySequenceEvent=l;var d=(p.prototype.CountedActivitySequenceEventData=function(){},p);function p(){}n.CountedActivitySequenceEventData=d},{"./ActivityTrackingData":2,"./ActivityTrackingSet":3,"./ISurveyEvent":22}],32:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Utils"),r=(o.make=function(t){try{return new o(t)}catch(t){return null}},o.prototype.getContentMetadata=function(){return this.data.contentMetadata},o);function o(t){if(!t)throw new Error("data must not be null");if(!t.contentMetadata)throw new Error("content metadata must not be null");if(!i.isObject(t.contentMetadata))throw new Error("content metadata must be of object type");this.data=t}n.SurveyMetadata=r;function a(){}n.Metadata=a},{"./Utils":42}],33:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=(r.prototype.addStats=function(t,e){this.Surveys[t]=e},r.prototype.getBySurveyId=function(t){return this.Surveys[t]},r.prototype.getStats=function(){return this.Surveys},r);function r(){this.Surveys={},this.Surveys={}}n.SurveyStatCollection=i},{}],34:[function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a=t("./Api/IFloodgateStorageProvider"),u=a.FileType,s=t("./Api/ISurvey"),l=t("./Constants"),c=t("./FloodgateEngine"),d=t("./StateProviderHelpers"),p=t("./SurveyStatCollection"),g=t("./Utils"),f=(o=p.SurveyStatCollection,r(h,o),h.fromJson=function(t){var e,n=new h;if(!t)return c.FloodgateEngine.getTelemetryLogger().log_Event(l.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Input json is null or empty."}),n;try{e=JSON.parse(t)}catch(t){return c.FloodgateEngine.getTelemetryLogger().log_Event(l.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()}),n}return n.deserialize(e)?n:new h},h.toJson=function(t){return t||(c.FloodgateEngine.getTelemetryLogger().log_Event(l.TelemetryEvent.SurveyStatCollectionActivation.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),t=new h),JSON.stringify(t)},h.prototype.accumulate=function(t){if(t){var e=t.getStats();for(var n in e)e.hasOwnProperty(n)&&this.addStats(n,e[n])}},h.prototype.deserialize=function(t){var e=t.Surveys,n=new Date;for(var i in e)if(e.hasOwnProperty(i)){var r=new T;r.deserialize(e[i])&&r.ExpirationTimeUtc>n&&this.addStats(i,r)}return this.validate()},h.prototype.validate=function(){return g.isObject(this.getStats())},h);function h(){return null!==o&&o.apply(this,arguments)||this}n.SurveyStatCollectionActivation=f;var m=(v.make=function(t,e){return e?new y(t,e):new b(t)},v);function v(){}n.SurveyActivationStatsProviderFactory=m;var y=(S.prototype.load=function(){var t=this.getSurveyStatsFromHost(),e=new f;return this.fileBasedStorageProvider&&(e=this.fileBasedStorageProvider.load()),d.MergeAndUpdateSurveyActivationStats(e,t).find(d.StateListType.Merged)},S.prototype.save=function(t){if(t){var e=this.getSurveyStatsFromHost(),n=d.MergeAndUpdateSurveyActivationStats(t,e),i=n.find(d.StateListType.ToBeUpdated),r=n.find(d.StateListType.Merged);if(i){var o=i.getStats();for(var a in o)if(o.hasOwnProperty(a)){var s=d.makeSettingItemValue(JSON.stringify(o[a]));this.hostBasedStorage.upsertSettingItem(u[u.SurveyActivationStats],a,s)}}this.fileBasedStorageProvider&&this.fileBasedStorageProvider.save(r)}},S.prototype.getSurveyStatsFromHost=function(){var t=new f,e=this.hostBasedStorage.readSettingList(u[u.SurveyActivationStats]);for(var n in e)if(e.hasOwnProperty(n)){var i=d.extractSettingItemValueSubString(e[n]),r=new T,o=void 0;try{o=JSON.parse(i),r.deserialize(o)}catch(t){c.FloodgateEngine.getTelemetryLogger().log_Event(l.TelemetryEvent.HostBasedSurveyActivationStatsProvider.GetSurveyStatsFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+t.toString()+".  Input:"+i})}var a=new Date;r.ExpirationTimeUtc<=a?this.hostBasedStorage.deleteSettingItem(u[u.SurveyActivationStats],n):t.addStats(n,r)}return t},S);function S(t,e){if(!e)throw new Error("host-based storage must not be null");this.hostBasedStorage=e,t&&(this.fileBasedStorageProvider=new b(t))}n.HostBasedSurveyActivationStatsProvider=y;var b=(C.prototype.load=function(){var t=this.storage.read(a.FileType.SurveyActivationStats);return t?f.fromJson(t):new f},C.prototype.save=function(t){if(t){var e=f.toJson(t);this.storage.write(a.FileType.SurveyActivationStats,e)}},C);function C(t){if(!t)throw new Error("storage must not be null");this.storage=t}n.FileBasedSurveyActivationStatsProvider=b;var T=(w.prototype.deserialize=function(t){return this.ActivationTimeUtc=t.ActivationTimeUtc,this.ExpirationTimeUtc=t.ExpirationTimeUtc,this.Type=t.Type,this.validate()},w.prototype.validate=function(){return!!g.isUtcDatetimeString(this.ActivationTimeUtc)&&(this.ActivationTimeUtc=g.stringToDate(this.ActivationTimeUtc),!!g.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=g.stringToDate(this.ExpirationTimeUtc),g.isEnumValue(this.Type,s.Type)))},w);function w(){}n.SurveyActivationStats=T},{"./Api/IFloodgateStorageProvider":7,"./Api/ISurvey":10,"./Constants":16,"./FloodgateEngine":17,"./StateProviderHelpers":25,"./SurveyStatCollection":33,"./Utils":42}],35:[function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a=t("./Constants"),s=t("./FloodgateEngine"),u=t("./SurveyStatCollection"),l=t("./Utils"),c=(o=u.SurveyStatCollection,r(d,o),d.fromJson=function(t){var e,n=new d;if(!t)return s.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Input json is null or empty."}),n;try{e=JSON.parse(t)}catch(t){return s.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+t.toString()}),n}return n.deserialize(e)?n:new d},d.toJson=function(t){return t||(s.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionEventActivity.ToJson.Failed,{ErrorMessage:"Input json is null or empty."}),t=new d),JSON.stringify(t)},d.prototype.accumulate=function(t){if(t){var e=t.getStats();for(var n in e)if(e.hasOwnProperty(n)){var i=this.getBySurveyId(n);if(i||((i=new p).Counts=[],this.addStats(n,i)),i.ExpirationTimeUtc=e[n].ExpirationTimeUtc,i.Counts.length<e[n].Counts.length){var r=i.Counts.slice();i.Counts=r}for(var o=0;o<e[n].Counts.length;o++)i.Counts[o]||(i.Counts[o]=0),i.Counts[o]+=e[n].Counts[o]}}},d.prototype.deserialize=function(t){var e=t.Surveys,n=new Date;for(var i in e)if(e.hasOwnProperty(i)){var r=new p;r.deserialize(e[i])&&r.ExpirationTimeUtc>n&&this.addStats(i,r)}return this.validate()},d.prototype.validate=function(){return l.isObject(this.getStats())},d);function d(){return null!==o&&o.apply(this,arguments)||this}n.SurveyStatCollectionEventActivity=c;var p=(g.prototype.deserialize=function(t){return this.ExpirationTimeUtc=t.ExpirationTimeUtc,this.Counts=t.Counts,this.validate()},g.prototype.validate=function(){if(!this.Counts)return!1;for(var t=0;t<this.Counts.length;t++){var e=this.Counts[t];if(!l.isNumber(e))return!1;e<0&&(this.Counts[t]=0)}return!!l.isUtcDatetimeString(this.ExpirationTimeUtc)&&(this.ExpirationTimeUtc=l.stringToDate(this.ExpirationTimeUtc),!0)},g);function g(){}n.SurveyEventActivityStats=p},{"./Constants":16,"./FloodgateEngine":17,"./SurveyStatCollection":33,"./Utils":42}],36:[function(t,e,n){"use strict";var i,r,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=t("../Api/ISurvey"),s=t("../Api/ISurveyComponent"),g=t("../SurveyComponents/CommentComponent"),f=t("../SurveyComponents/MultipleChoiceComponent"),h=t("../SurveyComponents/PromptComponent"),m=t("../SurveyComponents/RatingComponent"),v=t("../Utils"),u=t("./Survey"),l=t("./SurveyDataSource"),c=(r=u.Survey,o(y,r),y.make=function(t){try{return new y(t)}catch(t){return null}},y.makeFps=function(t,e,n){if(v.isNullOrUndefined(t)||v.isNullOrUndefined(e)||v.isNullOrUndefined(n))return null;var i=[],r=[],o=n.content;if(v.isNullOrUndefined(o)||v.isNullOrUndefined(o.prompt)||v.isNullOrUndefined(o.rating)&&v.isNullOrUndefined(o.multipleChoice)&&v.isNullOrUndefined(o.comment))return null;var a=new y.FpsSurveyData;if(a.baseData=t,a.promptData=new h.PromptComponentData,a.promptData.title=e.getCustomString(o.prompt.title),a.promptData.question=e.getCustomString(o.prompt.question),a.promptData.yesButtonLabel=e.getCustomString(o.prompt.yesLabel),a.promptData.noButtonLabel=e.getCustomString(o.prompt.noLabel),v.isNullOrUndefined(a.promptData.title)||v.isNullOrUndefined(a.promptData.question)||v.isNullOrUndefined(a.promptData.yesButtonLabel)||v.isNullOrUndefined(a.promptData.noButtonLabel))return null;if(o.rating){a.ratingData=new m.RatingComponentData,a.ratingData.question=e.getCustomString(o.rating.question),a.ratingData.isZeroBased=o.rating.isZeroBased;for(var s=0,u=o.rating.ratingValuesAscending;s<u.length;s++){var l=u[s],c=e.getCustomString(l);if(v.isNullOrUndefined(c))return null;i.push(c)}if(a.ratingData.ratingValuesAscending=i,v.isNullOrUndefined(a.ratingData.question)||v.isNullOrUndefined(a.ratingData.ratingValuesAscending))return null}if(o.multipleChoice){a.multipleChoiceData=new f.MultipleChoiceComponentData,a.multipleChoiceData.question=e.getCustomString(o.multipleChoice.question),a.multipleChoiceData.minNumberOfSelectedOptions=o.multipleChoice.minNumberOfSelectedOptions,a.multipleChoiceData.maxNumberOfSelectedOptions=o.multipleChoice.maxNumberOfSelectedOptions;for(var d=0,p=o.multipleChoice.availableOptions;d<p.length;d++){if(l=p[d],c=e.getCustomString(l),v.isNullOrUndefined(c))return null;r.push(c)}if(a.multipleChoiceData.availableOptions=r,v.isNullOrUndefined(a.multipleChoiceData.question)||v.isNullOrUndefined(a.multipleChoiceData.availableOptions))return null}return o.comment&&(a.commentData=new g.CommentComponentData,a.commentData.question=e.getCustomString(o.comment.question),v.isNullOrUndefined(a.commentData.question))?null:this.make(a)},y.prototype.getType=function(){return a.Type.Fps},y.prototype.getSurveyInfo=function(){return this.surveyInfo},y.prototype.getCommentComponent=function(){return this.question},y.prototype.getPromptComponent=function(){return this.prompt},y.prototype.getRatingComponent=function(){return this.rating},y.prototype.getMultipleChoiceComponent=function(){return this.multipleChoice},y.prototype.getComponent=function(t){switch(t){case s.Type.Comment:return this.getCommentComponent();case s.Type.Prompt:return this.getPromptComponent();case s.Type.Rating:return this.getRatingComponent();case s.Type.MultipleChoice:return this.getMultipleChoiceComponent();default:return null}},y.prototype.getDomElements=function(t){if(v.isNullOrUndefined(t))throw new Error("Document must not be null");var e=t.createElement(a.DOM_FPS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach(function(t){v.isNullOrUndefined(t)||e.appendChild(t)}),this.getCommentComponent().getDomElements(t).forEach(function(t){v.isNullOrUndefined(t)||e.appendChild(t)}),this.getRatingComponent()&&this.getRatingComponent().getDomElements(t).forEach(function(t){v.isNullOrUndefined(t)||e.appendChild(t)}),this.getMultipleChoiceComponent()&&this.getMultipleChoiceComponent().getDomElements(t).forEach(function(t){v.isNullOrUndefined(t)||e.appendChild(t)}),[e]},y.prototype.getJsonElements=function(){var t,e={};return(e=v.overrideValues(this.getSurveyInfo().getJsonElements(),e))[s.JSON_APPLICATION_KEYNAME]={},e[s.JSON_APPLICATION_KEYNAME][s.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify(((t={})[s.JSON_SURVEYSTRINGS_KEYNAME]=this.makeSurveyStrings(),t[s.JSON_SURVEYSPECIFICDATA_KEYNAME]=this.makeResponseString(),t)),e},y.prototype.makeResponseString=function(){var t={};return this.question&&(t[s.JSON_COMMENT_KEYNAME]=[this.getCommentComponent().getSubmittedText()]),this.multipleChoice&&(t[s.JSON_MULTIPLECHOICE_KEYNAME]=[this.getMultipleChoiceComponent().getOptionSelectedStates()]),this.rating&&(t[s.JSON_RATING_KEYNAME]=[{numberOfOptions:this.getRatingComponent().getRatingValuesAscending().length,selectedRating:this.getRatingComponent().getSelectedRatingIndex()}]),JSON.stringify(t)},y.prototype.makeSurveyStrings=function(){var t={};return this.prompt&&(t[s.JSON_PROMPT_KEYNAME]=this.prompt.getComponentJson()),this.rating&&(t[s.JSON_RATING_KEYNAME]=[this.rating.getComponentJson()]),this.question&&(t[s.JSON_COMMENT_KEYNAME]=[this.question.getComponentJson()]),this.multipleChoice&&(t[s.JSON_MULTIPLECHOICE_KEYNAME]=[this.multipleChoice.getComponentJson()]),JSON.stringify(t)},y);function y(t){var e=r.call(this)||this;if(v.isNullOrUndefined(t))throw new Error("data must not be null");return e.surveyInfo=new l(t.baseData),e.prompt=new h(t.promptData),e.question=t.commentData?new g(t.commentData):null,e.rating=t.ratingData?new m(t.ratingData):null,e.multipleChoice=t.multipleChoiceData?new f(t.multipleChoiceData):null,e}(c||(c={})).FpsSurveyData=function(){},e.exports=c},{"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":27,"../SurveyComponents/MultipleChoiceComponent":28,"../SurveyComponents/PromptComponent":29,"../SurveyComponents/RatingComponent":30,"../Utils":42,"./Survey":40,"./SurveyDataSource":41}],37:[function(t,e,n){"use strict";var i,r,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=t("../Api/ISurvey"),s=t("../Utils"),u=t("./Survey"),l=t("./SurveyDataSource"),c=(r=u.Survey,o(d,r),d.make=function(t){try{return new d(t)}catch(t){return null}},d.makeCustom=function(t){if(s.isNullOrUndefined(t))return null;var e=new d.GenericMessagingSurfaceSurveyData;return e.baseData=t,this.make(e)},d.prototype.getType=function(){return a.Type.GenericMessagingSurface},d.prototype.getSurveyInfo=function(){return this.surveyInfo},d.prototype.getComponent=function(t){return null},d.prototype.getDomElements=function(t){return[]},d.prototype.getJsonElements=function(){return{}},d);function d(t){var e=r.call(this)||this;if(!t)throw new Error("data must not be null");if(e.surveyInfo=new l(t.baseData),s.isNullOrUndefined(e.surveyInfo.getMetadata()))throw new Error("metadata must not be null");return e}(c||(c={})).GenericMessagingSurfaceSurveyData=function(){},e.exports=c},{"../Api/ISurvey":10,"../Utils":42,"./Survey":40,"./SurveyDataSource":41}],38:[function(t,e,n){"use strict";var i,r,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=t("../Api/ISurvey"),s=t("../Api/ISurveyComponent"),c=t("../SurveyComponents/CommentComponent"),d=t("../SurveyComponents/PromptComponent"),p=t("../SurveyComponents/RatingComponent"),g=t("../Utils"),u=t("./Survey"),l=t("./SurveyDataSource"),f=(r=u.Survey,o(h,r),h.make=function(t){try{return new h(t)}catch(t){return null}},h.makeNlqs=function(t,e,n){if(g.isNullOrUndefined(t)||g.isNullOrUndefined(e)||g.isNullOrUndefined(n))return null;var i=[],r=n.content;if(g.isNullOrUndefined(r)||g.isNullOrUndefined(r.comment)||g.isNullOrUndefined(r.prompt)||g.isNullOrUndefined(r.rating))return null;var o=new h.NlqsSurveyData;o.baseData=t,o.promptData=new d.PromptComponentData,o.ratingData=new p.RatingComponentData,o.commentData=new c.CommentComponentData,o.promptData.title=e.getCustomString(r.prompt.title),o.promptData.question=e.getCustomString(r.prompt.question),o.promptData.yesButtonLabel=e.getCustomString(r.prompt.yesLabel),o.promptData.noButtonLabel=e.getCustomString(r.prompt.noLabel),o.ratingData.question=e.getCustomString(r.rating.question),o.ratingData.isZeroBased=r.rating.isZeroBased,o.commentData.question=e.getCustomString(r.comment.question);for(var a=0,s=r.rating.ratingValuesAscending;a<s.length;a++){var u=s[a],l=e.getCustomString(u);if(g.isNullOrUndefined(l))return null;i.push(l)}return o.ratingData.ratingValuesAscending=i,g.isNullOrUndefined(o.ratingData.question)||g.isNullOrUndefined(o.commentData.question)||g.isNullOrUndefined(o.promptData.title)||g.isNullOrUndefined(o.promptData.question)||g.isNullOrUndefined(o.promptData.yesButtonLabel)||g.isNullOrUndefined(o.promptData.noButtonLabel)||g.isNullOrUndefined(o.ratingData.ratingValuesAscending)?null:this.make(o)},h.prototype.getType=function(){return a.Type.Nlqs},h.prototype.getSurveyInfo=function(){return this.surveyInfo},h.prototype.getCommentComponent=function(){return this.question},h.prototype.getPromptComponent=function(){return this.prompt},h.prototype.getRatingComponent=function(){return this.rating},h.prototype.getComponent=function(t){switch(t){case s.Type.Comment:return this.getCommentComponent();case s.Type.Prompt:return this.getPromptComponent();case s.Type.Rating:return this.getRatingComponent();default:return null}},h.prototype.getDomElements=function(t){if(g.isNullOrUndefined(t))throw new Error("Document must not be null");var e=t.createElement(a.DOM_NLQS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach(function(t){g.isNullOrUndefined(t)||e.appendChild(t)}),this.getCommentComponent().getDomElements(t).forEach(function(t){g.isNullOrUndefined(t)||e.appendChild(t)}),this.getRatingComponent().getDomElements(t).forEach(function(t){g.isNullOrUndefined(t)||e.appendChild(t)}),[e]},h.prototype.getJsonElements=function(){var t={};return t=g.overrideValues(this.getSurveyInfo().getJsonElements(),t),t=g.overrideValues(this.getCommentComponent().getJsonElements(),t),t=g.overrideValues(this.getRatingComponent().getJsonElements(),t)},h);function h(t){var e=r.call(this)||this;if(g.isNullOrUndefined(t))throw new Error("data must not be null");return e.surveyInfo=new l(t.baseData),e.prompt=new d(t.promptData),e.question=new c(t.commentData),e.rating=new p(t.ratingData),e}(f||(f={})).NlqsSurveyData=function(){},e.exports=f},{"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":27,"../SurveyComponents/PromptComponent":29,"../SurveyComponents/RatingComponent":30,"../Utils":42,"./Survey":40,"./SurveyDataSource":41}],39:[function(t,e,n){"use strict";var i,r,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=t("../Api/IFloodgateStringProvider"),s=t("../Api/ISurvey"),u=t("../Api/ISurveyComponent"),c=t("../SurveyComponents/CommentComponent"),d=t("../SurveyComponents/PromptComponent"),p=t("../SurveyComponents/RatingComponent"),g=t("../Utils"),l=t("./Survey"),f=t("./SurveyDataSource"),h=(r=l.Survey,o(m,r),m.make=function(t){try{return new m(t)}catch(t){return null}},m.makeCustom=function(t,e,n){if(g.isNullOrUndefined(t)||g.isNullOrUndefined(e)||g.isNullOrUndefined(n))return null;var i=[],r=n.content;if(g.isNullOrUndefined(r)||g.isNullOrUndefined(r.comment)||g.isNullOrUndefined(r.prompt)||g.isNullOrUndefined(r.rating))return null;var o=new m.NpsSurveyData;o.baseData=t,o.promptData=new d.PromptComponentData,o.ratingData=new p.RatingComponentData,o.commentData=new c.CommentComponentData,o.promptData.title=e.getCustomString(r.prompt.title),o.promptData.question=e.getCustomString(r.prompt.question),o.promptData.yesButtonLabel=e.getCustomString(r.prompt.yesLabel),o.promptData.noButtonLabel=e.getCustomString(r.prompt.noLabel),o.ratingData.question=e.getCustomString(r.rating.question),o.ratingData.isZeroBased=r.rating.isZeroBased,o.commentData.question=e.getCustomString(r.comment.question);for(var a=0,s=r.rating.ratingValuesAscending;a<s.length;a++){var u=s[a],l=e.getCustomString(u);if(g.isNullOrUndefined(l))return null;i.push(l)}return o.ratingData.ratingValuesAscending=i,g.isNullOrUndefined(o.ratingData.question)||g.isNullOrUndefined(o.commentData.question)||g.isNullOrUndefined(o.promptData.title)||g.isNullOrUndefined(o.promptData.question)||g.isNullOrUndefined(o.promptData.yesButtonLabel)||g.isNullOrUndefined(o.promptData.noButtonLabel)||g.isNullOrUndefined(o.ratingData.ratingValuesAscending)?null:this.make(o)},m.make5Point=function(t,e){if(!t||!e)return null;var n=new m.NpsSurveyData;n.baseData=t,n.ratingData=new p.RatingComponentData,n.ratingData.isZeroBased=!1,n.commentData=new c.CommentComponentData,n.promptData=new d.PromptComponentData,n.ratingData.question=e.loadStringResource(a.StringType.NpsRatingQuestion),n.commentData.question=e.loadStringResource(a.StringType.NpsCommentQuestion),n.promptData.title=e.loadStringResource(a.StringType.NpsPromptTitle),n.promptData.question=e.loadStringResource(a.StringType.NpsPromptQuestion),n.promptData.yesButtonLabel=e.loadStringResource(a.StringType.NpsPromptYesLabel),n.promptData.noButtonLabel=e.loadStringResource(a.StringType.NpsPromptNotNowLabel);var i=new Array(5);return i[0]=e.loadStringResource(a.StringType.Nps5RatingValue1),i[1]=e.loadStringResource(a.StringType.Nps5RatingValue2),i[2]=e.loadStringResource(a.StringType.Nps5RatingValue3),i[3]=e.loadStringResource(a.StringType.Nps5RatingValue4),i[4]=e.loadStringResource(a.StringType.Nps5RatingValue5),n.ratingData.question&&n.commentData.question&&n.promptData.title&&n.promptData.question&&n.promptData.yesButtonLabel&&n.promptData.noButtonLabel&&i[0]&&i[1]&&i[2]&&i[3]&&i[4]?(n.ratingData.ratingValuesAscending=i,this.make(n)):null},m.make11Point=function(t,e){if(!t||!e)return null;var n=new m.NpsSurveyData;n.baseData=t,n.ratingData=new p.RatingComponentData,n.ratingData.isZeroBased=!0,n.commentData=new c.CommentComponentData,n.promptData=new d.PromptComponentData,n.ratingData.question=e.loadStringResource(a.StringType.NpsRatingQuestion),n.commentData.question=e.loadStringResource(a.StringType.NpsCommentQuestion),n.promptData.title=e.loadStringResource(a.StringType.NpsPromptTitle),n.promptData.question=e.loadStringResource(a.StringType.NpsPromptQuestion),n.promptData.yesButtonLabel=e.loadStringResource(a.StringType.NpsPromptYesLabel),n.promptData.noButtonLabel=e.loadStringResource(a.StringType.NpsPromptNotNowLabel);var i=new Array(11);return i[0]=e.loadStringResource(a.StringType.Nps11RatingValue0),i[1]=e.loadStringResource(a.StringType.Nps11RatingValue1),i[2]=e.loadStringResource(a.StringType.Nps11RatingValue2),i[3]=e.loadStringResource(a.StringType.Nps11RatingValue3),i[4]=e.loadStringResource(a.StringType.Nps11RatingValue4),i[5]=e.loadStringResource(a.StringType.Nps11RatingValue5),i[6]=e.loadStringResource(a.StringType.Nps11RatingValue6),i[7]=e.loadStringResource(a.StringType.Nps11RatingValue7),i[8]=e.loadStringResource(a.StringType.Nps11RatingValue8),i[9]=e.loadStringResource(a.StringType.Nps11RatingValue9),i[10]=e.loadStringResource(a.StringType.Nps11RatingValue10),n.ratingData.question&&n.commentData.question&&n.promptData.title&&n.promptData.question&&n.promptData.yesButtonLabel&&n.promptData.noButtonLabel&&i[0]&&i[1]&&i[2]&&i[3]&&i[4]&&i[5]&&i[6]&&i[7]&&i[8]&&i[9]&&i[10]?(n.ratingData.ratingValuesAscending=i,this.make(n)):null},m.prototype.getType=function(){return s.Type.Nps},m.prototype.getSurveyInfo=function(){return this.surveyInfo},m.prototype.getCommentComponent=function(){return this.question},m.prototype.getPromptComponent=function(){return this.prompt},m.prototype.getRatingComponent=function(){return this.rating},m.prototype.getComponent=function(t){switch(t){case u.Type.Comment:return this.getCommentComponent();case u.Type.Prompt:return this.getPromptComponent();case u.Type.Rating:return this.getRatingComponent();default:return null}},m.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(s.DOM_NPS_TAGNAME);return this.getSurveyInfo().getDomElements(t).forEach(function(t){t&&e.appendChild(t)}),this.getCommentComponent().getDomElements(t).forEach(function(t){t&&e.appendChild(t)}),this.getRatingComponent().getDomElements(t).forEach(function(t){t&&e.appendChild(t)}),[e]},m.prototype.getJsonElements=function(){var t,e={};return e=g.overrideValues(this.getSurveyInfo().getJsonElements(),e),e=g.overrideValues(this.getCommentComponent().getJsonElements(),e),(e=g.overrideValues(this.getRatingComponent().getJsonElements(),e))[u.JSON_APPLICATION_KEYNAME]={},e[u.JSON_APPLICATION_KEYNAME][u.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify(((t={})[u.JSON_SURVEYSTRINGS_KEYNAME]=this.makeSurveyStrings(),t)),e},m.prototype.makeSurveyStrings=function(){var t={};return this.prompt&&(t[u.JSON_PROMPT_KEYNAME]=this.prompt.getComponentJson()),this.rating&&(t[u.JSON_RATING_KEYNAME]=[this.rating.getComponentJson()]),this.question&&(t[u.JSON_COMMENT_KEYNAME]=[this.question.getComponentJson()]),JSON.stringify(t)},m);function m(t){var e=r.call(this)||this;if(!t)throw new Error("data must not be null");return e.surveyInfo=new f(t.baseData),e.prompt=new d(t.promptData),e.question=new c(t.commentData),e.rating=new p(t.ratingData),e}(h||(h={})).NpsSurveyData=function(){},e.exports=h},{"../Api/IFloodgateStringProvider":8,"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":27,"../SurveyComponents/PromptComponent":29,"../SurveyComponents/RatingComponent":30,"../Utils":42,"./Survey":40,"./SurveyDataSource":41}],40:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Api/ISurvey"),r=t("../FloodgateEngine"),o=(a.prototype.getCampaignId=function(){return this.getSurveyInfo().getBackEndId()},a.prototype.getLauncherType=function(){return this.getSurveyInfo().getLauncherType()},a.prototype.submit=function(){var t=i.Type[this.getType()],e=r.FloodgateEngine.getTransportFactory().makeTransporter(t);e.setManifestValues(this.getJsonElements()),e.submit()},a);function a(){}n.Survey=o},{"../Api/ISurvey":10,"../FloodgateEngine":17}],41:[function(t,e,n){"use strict";var i=t("../../src/Api/ISurvey"),r=t("../GovernedChannel"),o=t("../ISurveyInfo"),a=t("../Utils"),s=(u.prototype.getId=function(){return this.data.id},u.prototype.getBackEndId=function(){return this.data.backEndIdentifier},u.prototype.getGovernedChannelType=function(){return this.data.governedChannelType},u.prototype.getRawStartTimeUtc=function(){return this.data.startTimeUtc},u.prototype.getStartTimeUtc=function(){if(a.isNullOrUndefined(this.data.startTimeUtc))return a.getDistantPast();var t=new Date(this.data.startTimeUtc);return a.isDate(t)?t:a.getDistantFuture()},u.prototype.getExpirationTimeUtc=function(){if(a.isNullOrUndefined(this.data.expirationTimeUtc))return a.getDistantPast();var t=new Date(this.data.expirationTimeUtc);return a.isDate(t)?t:a.getDistantPast()},u.prototype.getRawExpirationTimeUtc=function(){return this.data.expirationTimeUtc},u.prototype.isActiveForDate=function(t){return!a.isNullOrUndefined(t)&&t>=this.getStartTimeUtc()&&t<=this.getExpirationTimeUtc()},u.prototype.getActivationEvent=function(){return this.data.activationEvent},u.prototype.getPreferredLaunchType=function(){return this.data.preferredLaunchType},u.prototype.isAdditionalDataRequested=function(t){if(a.isNullOrUndefined(this.data.additionalDataRequested))return!1;for(var e=0,n=this.data.additionalDataRequested;e<n.length;e++)if(n[e]===t)return!0;return!1},u.prototype.getLauncherType=function(){return this.data.launcherType},u.prototype.getMetadata=function(){return this.data.metadata},u.prototype.getDomElements=function(t){if(!t)throw new Error("Document must not be null");var e=t.createElement(o.DOM_TYPE_TAGNAME);e.appendChild(t.createTextNode(o.DOM_TYPE_VALUE));var n=t.createElement(o.DOM_ID_TAGNAME);return n.appendChild(t.createTextNode(this.getBackEndId())),[e,n]},u.prototype.getJsonElements=function(){var t={};t[o.JSON_ID_KEYNAME]=this.getBackEndId();var e={};return e[o.JSON_SURVEY_KEYNAME]=t,e},u);function u(t){if(a.isNullOrUndefined(t))throw new Error("data must not be null");if(a.isNullOrUndefined(t.id)||""===t.id)throw new Error("data.id must not be null or empty");if(a.isNullOrUndefined(t.governedChannelType)&&(t.governedChannelType=r.GovernedChannelType.getDefault()),a.isNullOrUndefined(t.expirationTimeUtc)||""===t.expirationTimeUtc)throw new Error("data.expirationTimeUtc must not be null or empty");if(a.isNullOrUndefined(t.activationEvent))throw new Error("data.activationEvent must not be null");!a.isNullOrUndefined(t.backEndIdentifier)&&""!==t.backEndIdentifier||(t.backEndIdentifier=t.id),a.isNullOrUndefined(t.launcherType)&&(t.launcherType=i.LAUNCHER_TYPE_DEFAULT),this.data=t}(s||(s={})).SurveyDataSourceData=function(){this.preferredLaunchType=o.LaunchType.Default},e.exports=s},{"../../src/Api/ISurvey":10,"../GovernedChannel":19,"../ISurveyInfo":23,"../Utils":42}],42:[function(t,e,i){"use strict";function n(t){return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())}function r(t){return null==t}function o(t){return"string"==typeof t}function a(t,e){if(!t)return null;if(e<0)return e=-e,this.addSecondsWithoutOverflow(t,e);var n=t.getTime()-1e3*e;return n>i.MIN_DATE_MILLISECONDS?new Date(n):new Date(i.MIN_DATE_MILLISECONDS)}Object.defineProperty(i,"__esModule",{value:!0}),i.timeAdd=function(t,e,n){switch(e.toLowerCase()){case"h":case"hour":return new Date(t.getTime()+36e5*n);case"m":case"minute":return new Date(t.getTime()+6e4*n);case"s":case"second":return new Date(t.getTime()+1e3*n);default:throw new Error("Invalid interval value of "+e)}},i.isDate=n,i.isEnumValue=function(t,e){return t in e},i.isNumber=function(t){return null!==t&&!isNaN(t)&&isFinite(t)},i.isNullOrUndefined=r,i.isObject=function(t){return null!=t&&"object"==typeof t},i.isArray=function(t){return null!=t&&Array.isArray(t)},i.isString=o,i.isBoolean=function(t){return"boolean"==typeof t},i.getDistantPast=function(){return new Date(-116444736e5)},i.getDistantFuture=function(){return new Date(640922112e5)},i.MAX_DATE_MILLISECONDS=864e13,i.MIN_DATE_MILLISECONDS=-864e13,i.addSecondsWithoutOverflow=function(t,e){if(!t)return null;if(e<0)return a(t,-1*e);var n=t.getTime()+1e3*e;return n<i.MAX_DATE_MILLISECONDS?new Date(n):new Date(i.MAX_DATE_MILLISECONDS)},i.subtractSecondsWithoutOverflow=a;var s="^((?:[a-zA-Z]{2,3}(?:-[a-zA-Z]{3}){0,3})|(?:[a-zA-Z]{4,8}))(?:-([a-zA-Z]{4}))?(?:-([a-zA-Z]{2}|[0-9]{3}))?(-.*)?$";function u(t){if(!t)return null;var e=t.match(s);return!e||e.length<1||!r(e[4])?null:e[0]}function l(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}i.isValidLanguageSubTag=function(t){if(!t)return!1;var e=u(t);return!!e&&e===t},i.extractLanguageSubtag=u,i.guid=function(){return(l()+l()+"-"+l()+"-4"+l().substr(0,3)+"-"+l()+"-"+l()+l()+l()).toLowerCase()},i.makeArrayFromObjectValuesSortedByKeyString=function(t){var e=Object.keys(t);e.sort();var n=[];for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];n.push(t[r])}return n},i.stringToDate=function(t){if(!o(t))return null;var e=t?new Date(t):null;return n(e)?e:null},i.overrideValues=function(t,e){if(!e)return e;var n=e;if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},i.isUtcDatetimeString=function(t){return!!o(t)&&/^(\d{4}\-\d\d\-\d\dT\d\d:\d\d:\d\d(\.\d\d\d)?Z)$/.test(t)},i.dateToShortUtcString=function(t){if(!n(t))return null;function e(t){return t<10?"0"+t:t.toString()}return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"Z"}},{}],43:[function(q,n,i){(function(G,z){var t,e;t=this,e=function(){"use strict";function u(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=0,e=void 0,r=void 0,a=function(t,e){p[i]=t,p[i+1]=e,2===(i+=2)&&(r?r(g):y())};var t="undefined"!=typeof window?window:void 0,o=t||{},s=o.MutationObserver||o.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==G&&"[object process]"==={}.toString.call(G),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(g,1)}}var p=new Array(1e3);function g(){for(var t=0;t<i;t+=2){(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0}i=0}var f,h,m,v,y=void 0;function S(t,e){var n=this,i=new this.constructor(T);void 0===i[C]&&P(i);var r=n._state;if(r){var o=arguments[r-1];a(function(){return k(r,i,o,n._result)})}else x(n,i,t,e);return i}function b(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(T);return O(e,t),e}y=l?function(){return G.nextTick(g)}:s?(h=0,m=new s(g),v=document.createTextNode(""),m.observe(v,{characterData:!0}),function(){v.data=h=++h%2}):c?((f=new MessageChannel).port1.onmessage=g,function(){return f.port2.postMessage(0)}):void 0===t&&"function"==typeof q?function(){try{var t=Function("return this")().require("vertx");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(g)}:d()}catch(t){return d()}}():d();var C=Math.random().toString(36).substring(2);function T(){}var w=void 0,A=1,I=2;function E(t,i,r){a(function(e){var n=!1,t=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(r,i,function(t){n||(n=!0,i!==t?O(e,t):D(e,t))},function(t){n||(n=!0,N(e,t))},e._label);!n&&t&&(n=!0,N(e,t))},t)}function F(t,e,n){var i,r;e.constructor===t.constructor&&n===S&&e.constructor.resolve===b?(i=t,(r=e)._state===A?D(i,r._result):r._state===I?N(i,r._result):x(r,void 0,function(t){return O(i,t)},function(t){return N(i,t)})):void 0===n?D(t,e):u(n)?E(t,e,n):D(t,e)}function O(e,t){if(e===t)N(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=t),null===i||"object"!=r&&"function"!=r)D(e,t);else{var n=void 0;try{n=t.then}catch(t){return void N(e,t)}F(e,t,n)}var i,r}function _(t){t._onerror&&t._onerror(t._result),B(t)}function D(t,e){t._state===w&&(t._result=e,t._state=A,0!==t._subscribers.length&&a(B,t))}function N(t,e){t._state===w&&(t._state=I,t._result=e,a(_,t))}function x(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+A]=n,r[o+I]=i,0===o&&t._state&&a(B,t)}function B(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,r=void 0,o=t._result,a=0;a<e.length;a+=3)i=e[a],r=e[a+n],i?k(n,i,r,o):r(o);t._subscribers.length=0}}function k(t,e,n,i){var r=u(n),o=void 0,a=void 0,s=!0;if(r){try{o=n(i)}catch(t){s=!1,a=t}if(e===o)return void N(e,new TypeError("A promises callback cannot return that same promise."))}else o=i;e._state!==w||(r&&s?O(e,o):!1===s?N(e,a):t===A?D(e,o):t===I&&N(e,o))}var L=0;function P(t){t[C]=L++,t._state=void 0,t._result=void 0,t._subscribers=[]}var U=(M.prototype._enumerate=function(t){for(var e=0;this._state===w&&e<t.length;e++)this._eachEntry(t[e],e)},M.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===b){var r=void 0,o=void 0,a=!1;try{r=e.then}catch(t){a=!0,o=t}if(r===S&&e._state!==w)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===R){var s=new n(T);a?N(s,o):F(s,e,r),this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},M.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===w&&(this._remaining--,t===I?N(i,n):this._result[e]=n),0===this._remaining&&D(i,this._result)},M.prototype._willSettleAt=function(t,e){var n=this;x(t,void 0,function(t){return n._settledAt(A,e,t)},function(t){return n._settledAt(I,e,t)})},M);function M(t,e){this._instanceConstructor=t,this.promise=new t(T),this.promise[C]||P(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&D(this.promise,this._result))):N(this.promise,new Error("Array Methods must be provided an Array"))}var R=(V.prototype.catch=function(t){return this.then(null,t)},V.prototype.finally=function(e){var n=this.constructor;return u(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},V);function V(t){this[C]=L++,this._result=this._state=void 0,this._subscribers=[],T!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof V?function(e,t){try{t(function(t){O(e,t)},function(t){N(e,t)})}catch(t){N(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return R.prototype.then=S,R.all=function(t){return new U(this,t).promise},R.race=function(r){var o=this;return n(r)?new o(function(t,e){for(var n=r.length,i=0;i<n;i++)o.resolve(r[i]).then(t,e)}):new o(function(t,e){return e(new TypeError("You must pass an array to race."))})},R.resolve=b,R.reject=function(t){var e=new this(T);return N(e,t),e},R._setScheduler=function(t){r=t},R._setAsap=function(t){a=t},R._asap=a,R.polyfill=function(){var t=void 0;if(void 0!==z)t=z;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=R},R.Promise=R},"object"==typeof i&&void 0!==n?n.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}).call(this,q("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:45}],44:[function(q,n,i){(function(G,z){var t,e;t=this,e=function(){"use strict";function u(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},i=0,e=void 0,r=void 0,a=function(t,e){p[i]=t,p[i+1]=e,2===(i+=2)&&(r?r(g):y())};var t="undefined"!=typeof window?window:void 0,o=t||{},s=o.MutationObserver||o.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==G&&"[object process]"==={}.toString.call(G),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(g,1)}}var p=new Array(1e3);function g(){for(var t=0;t<i;t+=2){(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0}i=0}var f,h,m,v,y=void 0;function S(t,e){var n=this,i=new this.constructor(T);void 0===i[C]&&P(i);var r=n._state;if(r){var o=arguments[r-1];a(function(){return k(r,i,o,n._result)})}else x(n,i,t,e);return i}function b(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(T);return O(e,t),e}y=l?function(){return G.nextTick(g)}:s?(h=0,m=new s(g),v=document.createTextNode(""),m.observe(v,{characterData:!0}),function(){v.data=h=++h%2}):c?((f=new MessageChannel).port1.onmessage=g,function(){return f.port2.postMessage(0)}):void 0===t&&"function"==typeof q?function(){try{var t=Function("return this")().require("vertx");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(g)}:d()}catch(t){return d()}}():d();var C=Math.random().toString(36).substring(2);function T(){}var w=void 0,A=1,I=2;function E(t,i,r){a(function(e){var n=!1,t=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(r,i,function(t){n||(n=!0,i!==t?O(e,t):D(e,t))},function(t){n||(n=!0,N(e,t))},e._label);!n&&t&&(n=!0,N(e,t))},t)}function F(t,e,n){var i,r;e.constructor===t.constructor&&n===S&&e.constructor.resolve===b?(i=t,(r=e)._state===A?D(i,r._result):r._state===I?N(i,r._result):x(r,void 0,function(t){return O(i,t)},function(t){return N(i,t)})):void 0===n?D(t,e):u(n)?E(t,e,n):D(t,e)}function O(e,t){if(e===t)N(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=t),null===i||"object"!=r&&"function"!=r)D(e,t);else{var n=void 0;try{n=t.then}catch(t){return void N(e,t)}F(e,t,n)}var i,r}function _(t){t._onerror&&t._onerror(t._result),B(t)}function D(t,e){t._state===w&&(t._result=e,t._state=A,0!==t._subscribers.length&&a(B,t))}function N(t,e){t._state===w&&(t._state=I,t._result=e,a(_,t))}function x(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+A]=n,r[o+I]=i,0===o&&t._state&&a(B,t)}function B(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,r=void 0,o=t._result,a=0;a<e.length;a+=3)i=e[a],r=e[a+n],i?k(n,i,r,o):r(o);t._subscribers.length=0}}function k(t,e,n,i){var r=u(n),o=void 0,a=void 0,s=!0;if(r){try{o=n(i)}catch(t){s=!1,a=t}if(e===o)return void N(e,new TypeError("A promises callback cannot return that same promise."))}else o=i;e._state!==w||(r&&s?O(e,o):!1===s?N(e,a):t===A?D(e,o):t===I&&N(e,o))}var L=0;function P(t){t[C]=L++,t._state=void 0,t._result=void 0,t._subscribers=[]}var U=(M.prototype._enumerate=function(t){for(var e=0;this._state===w&&e<t.length;e++)this._eachEntry(t[e],e)},M.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===b){var r=void 0,o=void 0,a=!1;try{r=e.then}catch(t){a=!0,o=t}if(r===S&&e._state!==w)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===R){var s=new n(T);a?N(s,o):F(s,e,r),this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},M.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===w&&(this._remaining--,t===I?N(i,n):this._result[e]=n),0===this._remaining&&D(i,this._result)},M.prototype._willSettleAt=function(t,e){var n=this;x(t,void 0,function(t){return n._settledAt(A,e,t)},function(t){return n._settledAt(I,e,t)})},M);function M(t,e){this._instanceConstructor=t,this.promise=new t(T),this.promise[C]||P(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&D(this.promise,this._result))):N(this.promise,new Error("Array Methods must be provided an Array"))}var R=(V.prototype.catch=function(t){return this.then(null,t)},V.prototype.finally=function(e){var n=this.constructor;return u(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},V);function V(t){this[C]=L++,this._result=this._state=void 0,this._subscribers=[],T!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof V?function(e,t){try{t(function(t){O(e,t)},function(t){N(e,t)})}catch(t){N(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return R.prototype.then=S,R.all=function(t){return new U(this,t).promise},R.race=function(r){var o=this;return n(r)?new o(function(t,e){for(var n=r.length,i=0;i<n;i++)o.resolve(r[i]).then(t,e)}):new o(function(t,e){return e(new TypeError("You must pass an array to race."))})},R.resolve=b,R.reject=function(t){var e=new this(T);return N(e,t),e},R._setScheduler=function(t){r=t},R._setAsap=function(t){a=t},R._asap=a,R.polyfill=function(){var t=void 0;if(void 0!==z)t=z;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=R},R.Promise=R},"object"==typeof i&&void 0!==n?n.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}).call(this,q("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:45}],45:[function(t,e,n){var i,r,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(t){i=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var l,c=[],d=!1,p=-1;function g(){d&&l&&(d=!1,l.length?c=l.concat(c):p=-1,c.length&&f())}function f(){if(!d){var t=u(g);d=!0;for(var e=c.length;e;){for(l=c,c=[];++p<e;)l&&l[p].run();p=-1,e=c.length}l=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new h(t,e)),1!==c.length||d||u(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],46:[function(t,e,n){"use strict";n.__esModule=!0;var o=t("./UIStrings/UIStrings"),a=t("./Version"),s=t("./Configuration/Configuration"),u=t("./Window/Window"),l=t("./Logging/Logging"),c=t("./Theme"),i=t("es6-promise"),d=t("./Window/DomUtils"),p="OfficeFeedbackSDK",g=!1;n.initialize=function(){return new i.Promise(function(e,n){if(g)e();else{if(!u.get().OfficeBrowserFeedback.initOptions)return void n("Window.OfficeBrowserFeedback.initOptions not set");u.get().OfficeBrowserFeedback.sdkVersion=a.default,s.get().setCommonInitOptions(u.get().OfficeBrowserFeedback.initOptions);var i=s.get().getCommonInitOptions();d.loadStylesheet(i.stylesUrl);var r=i.intlUrl+i.locale.toLowerCase()+"/"+i.intlFilename;d.loadScript(r).then(function(){var t;o.getUIStrings()?(t=i,l.initialize(t.environment,p,a.default,t.telemetryGroup?t.telemetryGroup.audienceGroup:void 0,t.appId.toString(),t.sessionId,t.build,s.get().getSdkSessionId()),c.initialize(t.primaryColour,t.secondaryColour),g=!0,e()):n("UiStrings were not loaded from "+r)}).catch(function(){n("Script load failed for "+r)})}})},n.reset=function(){g=!1},u.setSetUiStrings(function(t){o.setUIStrings(t)})},{"./Configuration/Configuration":48,"./Logging/Logging":53,"./Theme":59,"./UIStrings/UIStrings":64,"./Version":84,"./Window/DomUtils":86,"./Window/Window":87,"es6-promise":44}],47:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./App_Common"),o=t("./Configuration/Configuration"),a=t("./Logging/Logging"),s=t("./UI/UI"),r=t("./Window/Window"),u=t("es6-promise"),l=!1;function c(){return new u.Promise(function(t,e){l?t():i.initialize().then(function(){r.get().OfficeBrowserFeedback.initOptions?(o.get().setInAppFeedbackInitOptions(r.get().OfficeBrowserFeedback.initOptions),l=!0,t()):e("Window.OfficeBrowserFeedback.initOptions not set")}).catch(function(t){e("Initialization failed: {"+t+"}")})})}n.initialize=c;var d=!1;function p(n){return new u.Promise(function(t,e){d?e("Control already open"):c().then(function(){o.get().setInAppFeedbackLaunchOptions(n),s.createBellyBandMulti(function(){d=!1}),a.getLogger().logEvent(a.EventIds.InApp.UI.Picker.Shown.VALUE,1,{IsBugEnabled:o.get().getInAppFeedbackInitOptions().bugForm,IsIdeaEnabled:void 0!==o.get().getInAppFeedbackInitOptions().userVoice}),d=!0,t()}).catch(function(t){e("Initialization failed: {"+t+"}")})})}function g(i,r){return new u.Promise(function(t,e){if(d)e("Control already open");else{var n=o.validateFeedbackType(i);c().then(function(){o.get().setInAppFeedbackLaunchOptions(r),s.createBellyBandSingle(function(){d=!1},n),a.getLogger().logEvent(a.EventIds.InApp.UI.Form.Shown.VALUE,1,{FeedbackType:n}),d=!0,t()}).catch(function(t){e("Initialization failed: {"+t+"}")})}})}n.multiFeedback=p,n.singleFeedback=g,n.reset=function(){i.reset(),d=l=!1},r.setMultiFeedback(p),r.setSingleFeedback(g)},{"./App_Common":46,"./Configuration/Configuration":48,"./Logging/Logging":53,"./UI/UI":81,"./Window/Window":87,"es6-promise":44}],48:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("./../Utils"),i=t("./../Constants"),o=t("./../Localization"),a=(s.validateCategoryOptions=function(t){if(!t)return{show:!1};if(r.expectBoolean(t.show,"categories.show"),t.customCategories){r.expectArray(t.customCategories,"categories.customCategories");for(var e=0,n=t.customCategories;e<n.length;e++){var i=n[e];if(r.expectString(i,"custom category '"+i+"'"),20<i.length)throw"custom category '"+i+"' too long, max 20 characters."}}return t},s.prototype.getCommonInitOptions=function(){return this.commonInitOptions},s.prototype.getInAppFeedbackInitOptions=function(){return this.inAppFeedbackInitOptions},s.prototype.getInAppFeedbackLaunchOptions=function(){return this.inAppFeedbackLaunchOptions},s.prototype.getFloodgateInitOptions=function(){return this.floodgateInitOptions},s.prototype.getFloodgateSurvey=function(){return this.floodgateSurvey},s.prototype.getSdkSessionId=function(){return this.sdkSessionId||(this.sdkSessionId=r.guid()),this.sdkSessionId},s.prototype.setCommonInitOptions=function(t){r.expectObject(t,"passedInitOptions");var e={appId:t.appId,applicationGroup:t.applicationGroup||{},build:t.build,cid:t.cid,environment:t.environment,intlFilename:t.intlFilename,intlUrl:t.intlUrl,webSurfacesResourceBaseUrl:t.webSurfacesResourceBaseUrl,locale:t.locale,onError:t.onError,originalLocale:t.locale,primaryColour:t.primaryColour,secondaryColour:t.secondaryColour,sessionId:t.sessionId,stylesUrl:t.stylesUrl,telemetryGroup:t.telemetryGroup||{},userEmail:t.userEmail,userEmailConsentDefault:t.userEmailConsentDefault,webGroup:t.webGroup||{}};if(r.expectNumber(e.appId,"initOptions.appId"),!(e.appId%1==0&&0<e.appId))throw"initOptions.appId is not a positive integer: "+e.appId;if(r.expectString(e.stylesUrl,"initOptions.stylesUrl"),r.expectString(e.intlUrl,"initOptions.intlUrl"),void 0!==e.intlFilename?r.expectString(e.intlFilename,"initOptions.intlFilename"):e.intlFilename="officebrowserfeedbackstrings.js",r.expectNumber(e.environment,"initOptions.environment"),1!==e.environment&&0!==e.environment)throw"initOptions.environment has a bad value: "+e.environment;void 0!==e.userEmail&&r.expectString(e.userEmail,"initOptions.userEmail"),void 0!==e.userEmailConsentDefault&&r.expectBoolean(e.userEmailConsentDefault,"initOptions.userEmailConsentDefault"),void 0!==e.sessionId?r.expectString(e.sessionId,"initOptions.sessionId"):e.sessionId="00000000-0000-0000-0000-000000000000",e.telemetryGroup.processSessionId=e.sessionId,void 0!==e.cid&&(r.expectString(e.cid,"initOptions.cid"),e.applicationGroup.extendedManifestData=JSON.stringify({cid:e.cid})),void 0!==e.build?(r.expectString(e.build,"initOptions.build"),new RegExp("^[0-9]{1,9}(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?$").test(e.build)||(e.build="0.0.0.0")):e.build="0.0.0.0",e.telemetryGroup.officeBuild=e.build;var n=new RegExp("^#[0-9a-f]{3}([0-9a-f]{3})?$","i");void 0!==e.primaryColour&&(n.test(e.primaryColour)||(e.primaryColour=void 0)),void 0!==e.secondaryColour&&(n.test(e.secondaryColour)||(e.secondaryColour=void 0)),void 0!==e.locale?(r.expectString(e.locale,"initOptions.locale"),e.locale=o.validate(e.locale)):e.locale="en",void 0===e.onError&&(e.onError=function(t){}),this.commonInitOptions=e},s.prototype.setInAppFeedbackInitOptions=function(t){r.expectObject(t,"passedInitOptions");var e={bugForm:t.bugForm,onDismiss:t.onDismiss,screenshot:t.screenshot,userEmail:t.userEmail,userVoice:void 0!==t.userVoice?{url:t.userVoice.url}:void 0};void 0===e.onDismiss&&(e.onDismiss=function(t){}),void 0!==e.bugForm?r.expectBoolean(e.bugForm,"initOptions.bugForm"):e.bugForm=!1,void 0!==e.userEmail&&r.expectString(e.userEmail,"initOptions.userEmail"),void 0!==e.screenshot?r.expectBoolean(e.screenshot,"initOptions.screenshot"):e.screenshot=!0,void 0!==e.userVoice&&(r.expectObject(e.userVoice,"initOptions.userVoice"),r.expectString(e.userVoice.url,"initOptions.userVoice.url")),this.inAppFeedbackInitOptions=e},s.prototype.setInAppFeedbackLaunchOptions=function(t){if(!this.commonInitOptions)throw"commonInitOptions not set";t=t||{},this.commonInitOptions.applicationGroup=r.overrideValues(t.applicationGroup,this.commonInitOptions.applicationGroup),this.commonInitOptions.telemetryGroup=r.overrideValues(t.telemetryGroup,this.commonInitOptions.telemetryGroup),this.commonInitOptions.webGroup=r.overrideValues(t.webGroup,this.commonInitOptions.webGroup),t.categories=s.validateCategoryOptions(t.categories),this.inAppFeedbackLaunchOptions=t},s.prototype.setFloodgateInitOptions=function(t){r.expectObject(t,"passedInitOptions");var e={autoDismiss:t.autoDismiss,campaignDefinitions:t.campaignDefinitions,campaignFlights:t.campaignFlights,campaignQueryParameters:t.campaignQueryParameters,onDismiss:t.onDismiss,onSurveyActivatedCallback:t.onSurveyActivatedCallback,settingStorageCallback:t.settingStorageCallback,uIStringGetter:t.uIStringGetter,authTokenCallback:t.authTokenCallback};void 0===e.autoDismiss&&(e.autoDismiss=i.AutoDismissValues.NoAutoDismiss),void 0===e.onDismiss&&(e.onDismiss=function(t,e){}),void 0===e.onSurveyActivatedCallback&&(e.onSurveyActivatedCallback={onSurveyActivated:function(t){t.launch()}}),void 0===e.uIStringGetter&&(e.uIStringGetter=function(t){return t}),this.floodgateInitOptions=e},s.prototype.setFloodgateSurvey=function(t){this.floodgateSurvey=t},s);function s(){}var u=new(n.Configuration=a);n.get=function(){return u},n.validateFeedbackType=function(t){if(r.expectString(t,"feedbackType"),t===i.FeedbackType[i.FeedbackType.Smile])return i.FeedbackType.Smile;if(t===i.FeedbackType[i.FeedbackType.Frown])return i.FeedbackType.Frown;if(t===i.FeedbackType[i.FeedbackType.Bug])return i.FeedbackType.Bug;throw"feedbackType should be one of Smile, Frown or Bug"}},{"./../Constants":49,"./../Localization":51,"./../Utils":83}],49:[function(t,e,n){"use strict";n.__esModule=!0;var i=(r.AriaLabel="aria-label",r.AriaSelected="aria-selected",r.AriaOrientation="aria-orientation",r.AriaExpanded="aria-expanded",r.AriaControls="aria-controls",r.AriaHasPopups="aria-haspopup",r.AriaModal="aria-modal",r.AriaLabelledBy="aria-labelledby",r.AriaDescribedBy="aria-describedby",r.Class="class",r.DataHtml2CanvasIgnore="data-html2canvas-ignore",r.Disabled="disabled",r.Fill="fill",r.For="for",r.Form="form",r.Height="height",r.HRef="href",r.Id="id",r.MaxLength="maxlength",r.Name="name",r.Placeholder="placeholder",r.Points="points",r.Rel="rel",r.Role="role",r.Source="src",r.Stroke="stroke",r.TabIndex="tabindex",r.Target="target",r.Transform="transform",r.Type="type",r.Value="value",r.ViewBox="viewBox",r.Width="width",r.xlinkHref="xlink:href",r.X="x",r.Y="y",r);function r(){}n.AttributeName=i;var o=(a.BlankWindow="_blank",a.Button="button",a.Dialog="dialog",a.Tab="tab",a.TabList="tablist",a.TabPanel="tabpanel",a.Checkbox="checkbox",a.Checked="checked",a.False="false",a.Zero="0",a.Polite="polite",a.Radio="radio",a.Submit="submit",a.Text="text",a.TextAreaMaxLength="1000",a.True="true",a.Unchecked="unchecked",a.NoReferrer="noreferrer",a.AriaOrientationValueVertical="vertical",a);function a(){}n.AttributeValue=o;var s=(u.CLCID="CLCID",u);function u(){}n.UrlParameters=s;var l=(c.CheckBox="obf-CheckBox",c.FontSubtitle="obf-FontSubtitle",c.FontText="obf-FontText",c.FontSubText="obf-FontSubText",c.FontSubSubText="obf-FontSubSubText",c.Hidden="obf-Hidden",c.Link="obf-Link",c.MarginLeft60px="obf-MarginLeft60px",c.NarrowLayout="obf-NarrowLayout",c.PrivacyStatementLinkDiv="obf-PrivacyStatementLinkDiv",c.Rtl="obf-Rtl",c.Spinner="obf-Spinner",c.SpinnerCircle="obf-SpinnerCircle",c.SubmitButton="obf-SubmitButton",c.TextInput="obf-TextInput",c.Visible="obf-Visible",c.Rating="obf-Rating",c.RatingGraphic="obf-RatingGraphic",c.RatingGraphicFilled="obf-RatingGraphic-Filled",c.ChoiceGroup="obf-ChoiceGroup",c.ChoiceGroupIcon="obf-ChoiceGroupIcon",c.OverallAnchor="obf-OverallAnchor",c.OverallAnchorActive="obf-OverallAnchorActive",c.OverallImage="obf-OverallImage",c.OverallText="obf-OverallText",c.SingleLayout="obf-SingleLayout",c.ShowRightBorder="obf-ShowRightBorder",c.SlideLeft="obf-slideLeft",c.TextAlignLeft="obf-TextAlignLeft",c.FormContainer="obf-FormContainer",c.FormQuestionMiddleText="obf-FormQuestionMiddleText",c.FormMiddleText="obf-FormMiddleText",c.FormCategoriesDropdown="obf-FormCategoriesDropdown",c.FormComment="obf-FormComment",c.FormRatingContainer="obf-FormRatingContainer",c.FormRatingLabel="obf-FormRatingLabel",c.FormRating="obf-FormRating",c.FormEmailInput="obf-FormEmailInput",c.FormBottomContainer="obf-FormBottomContainer",c.FormSubmitButtonContainer="obf-FormSubmitButtonContainer",c.FormScreenshotContainer="obf-FormScreenshotContainer",c.FormScreenshotLabel="obf-FormScreenshotLabel",c.FormScreenshotCheckbox="obf-FormScreenshotCheckbox",c.TFormEmailCheckbox="obf-TFormEmailCheckbox",c.TFormEmailLabel="obf-TFormEmailLabel ",c.EmailCheckBoxLabel="obf-EmailCheckBoxLabel",c.Toast="obf-Toast",c);function c(){}n.Classes=l;var d=(p.ColumnSeparatorDiv="obf-ColumnSeparatorDiv",p.OverallAnchorsContainer="obf-OverallAnchorsContainer",p.OverallFrownAnchor="obf-OverallFrownAnchor",p.OverallFrownDiv="obf-OverallFrownDiv",p.OverallFrownImage="obf-OverallFrownImage",p.OverallFrownText="obf-OverallFrownText",p.OverallSmileAnchor="obf-OverallSmileAnchor",p.OverallSmileDiv="obf-OverallSmileDiv",p.OverallSmileImage="obf-OverallSmileImage",p.OverallSmileText="obf-OverallSmileText",p.OverallIdeaAnchor="obf-OverallIdeaAnchor",p.OverallIdeaDiv="obf-OverallIdeaDiv",p.OverallIdeaImage="obf-OverallIdeaImage",p.OverallIdeaText="obf-OverallIdeaText",p.OverallBugAnchor="obf-OverallBugAnchor",p.OverallBugDiv="obf-OverallBugDiv",p.OverallBugImage="obf-OverallBugImage",p.OverallBugText="obf-OverallBugText",p.QuestionLeftText="obf-QuestionLeftText",p.LeftFormContainer="obf-LeftFormContainer",p.MainContainer="obf-MainContainer",p.MainContentHolder="obf-MainContentHolder",p.MiddleFormContainer="obf-MiddleFormContainer",p.OverlayBackground="obf-OverlayBackground",p.PrivacyStatementLink="obf-PrivacyStatementLink",p.FirstTabbable="obf-FirstTabbable",p.LastTabbable="obf-LastTabbable",p.SingleFormContainer="obf-SingleFormContainer",p.SingleFormQuestionMiddleText="obf-SingleFormQuestionMiddleText",p.SingleFormCategoriesDropdown="obf-SingleFormCategoriesDropdown",p.SingleFormComment="obf-SingleFormComment",p.SingleFormEmailInput="obf-SingleFormEmailInput",p.SingleFormRating="obf-SingleFormRating",p.SingleFormScreenshotCheckbox="obf-SingleFormScreenshotCheckbox",p.SingleFormSubmitButton="obf-SingleFormSubmitButton",p.SingleFormSubmitButtonSpinner="obf-SingleFormSubmitButtonSpinner",p.BasicFormContainer="obf-BasicFormContainer",p.BasicFormQuestionMiddleText="obf-BasicFormQuestionMiddleText",p.BasicFormCategoriesDropdown="obf-BasicFormCategoriesDropdown",p.BasicFormComment="obf-BasicFormComment",p.BasicFormEmailInput="obf-BasicFormEmailInput",p.BasicFormRating="obf-BasicFormRating",p.BasicFormScreenshotCheckbox="obf-BasicFormScreenshotCheckbox",p.BasicFormSubmitButton="obf-BasicFormSubmitButton",p.BasicFormSubmitButtonSpinner="obf-BasicFormSubmitButtonSpinner",p.UserVoiceFormContainer="obf-UserVoiceFormContainer",p.UserVoiceFormGoButton="obf-UserVoiceFormGoButton",p.ToastContainer="obf-ToastContainer",p.ToastCancel="obf-ToastCancel",p.TPromptContainer="obf-TPromptContainer",p.TPromptTitle="obf-TPromptTitle",p.TPromptText="obf-TPromptText",p.TFormContainer="obf-TFormContainer",p.TFormTitle="obf-TFormTitle",p.TFormRating="obf-TFormRating",p.TFormRatingQuestion="obf-TFormRatingQuestion",p.TFormComment="obf-TFormComment",p.TFormEmailTextBox="obf-TFormEmailTextBox",p.TFormEmailCheckBox="obf-TFormEmailCheckBox",p.TFormEmailLabel="obf-TFormEmailLabel",p.TFormSubmitButton="obf-TFormSubmitButton",p.TFormSubmitButtonSpinner="obf-TFormSubmitButtonSpinner",p.TFormSubmitButtonContainer="obf-TFormSubmitButtonContainer",p);function p(){}n.IDs=d;var g,f,h,m=(v.Esc=27,v.Tab=9,v);function v(){}n.Keys=m,(g=n.FeedbackType||(n.FeedbackType={}))[g.Smile=0]="Smile",g[g.Frown=1]="Frown",g[g.Idea=2]="Idea",g[g.Bug=3]="Bug",(f=n.Environment||(n.Environment={}))[f.Production=0]="Production",f[f.Int=1]="Int",(h=n.AutoDismissValues||(n.AutoDismissValues={}))[h.NoAutoDismiss=0]="NoAutoDismiss",h[h.SevenSeconds=1]="SevenSeconds",h[h.FourteenSeconds=2]="FourteenSeconds",h[h.TwentyOneSeconds=3]="TwentyOneSeconds",h[h.TwentyEightSeconds=4]="TwentyEightSeconds";var y=(S.Anchor="A",S.Button="button",S.Defs="defs",S.Div="div",S.FieldSet="fieldset",S.Form="form",S.Img="img",S.Input="input",S.Label="label",S.Legend="legend",S.Option="option",S.Polygon="polygon",S.Select="select",S.Span="span",S.Svg="svg",S.TextArea="textarea",S.Use="use",S);function S(){}n.Tags=y;var b=(C.PrivacyStatementLink="http://go.microsoft.com/fwlink/?LinkID=390004",C);function C(){}n.Urls=b;var T=(w.WebSurfacesLink="https://contentstorage.osi.office.net/dynamiccanvas/programmablesurfaces/prod/officewebsurfaces.core.min.js",w);function w(){}n.DynamicScriptUrls=T;var A=(I.TMSAppID="4c4f550b-42b2-4a16-93f9-fdb9e01bb6ed",I);function I(){}n.GUIDs=A},{}],50:[function(t,e,n){"use strict";var i;n.__esModule=!0;var r=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),o=t("./../Window/Window"),a=t("./../Logging/Logging"),s=r.IFloodgateStorageProvider.FileType,u=((i={})[s.CampaignDefinitions]="obf-CampaignDefinitions",i[s.CampaignStates]="obf-CampaignStates",i[s.FloodgateSettings]="obf-FloodgateSettings",i[s.GovernedChannelStates]="obf-GovernedChannelStates",i[s.SurveyActivationStats]="obf-SurveyActivationStats",i[s.SurveyEventActivityStats]="obf-SurveyEventActivityStats",i[s.TmsCache_CampaignContent]="obf-TmsCampaignContent",i[s.TmsCache_MessageMetadata]="obf-TmsMessageMetadata",i[s.TmsCache_UserGovernance]="obf-TmsUserGovernance",i[s.Tms_DynamicSettings]="obf-TmsDynamicSettings",i[s.LogLevelSettings]="obf-LogLevelSettings",i),l=(c.isStorageAvailable=function(){try{var t="__storage_test__";return o.get().localStorage.setItem(t,t),o.get().localStorage.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==o.get().localStorage.length}},c.prototype.fileLock=function(t){},c.prototype.fileUnlock=function(t){},c.prototype.read=function(t){if(!(t in s))return"";var e,n=u[t];try{e=o.get().localStorage.getItem(n)}catch(t){return a.getLogger().logEvent(a.EventIds.Survey.Floodgate.FileRead.Failed.VALUE,2,{ErrorMessage:t.toString(),FileName:n}),""}return e},c.prototype.write=function(t,e){if(t in s){var n=u[t];try{o.get().localStorage.setItem(n,e)}catch(t){return void a.getLogger().logEvent(a.EventIds.Survey.Floodgate.FileWrite.Failed.VALUE,2,{ErrorMessage:t.toString(),FileName:n})}}},c);function c(){}n.default=l},{"./../Logging/Logging":53,"./../Window/Window":87,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":4}],51:[function(t,e,n){"use strict";n.__esModule=!0;var u=["af","am","ar","as","az","be","bg","bn-BD","bn-IN","bs","ca","ca-Es-VALENCIA","chr-Cher","cs","cy","da","de","el","en-GB","es","es-MX","et","eu","fa","fi","fil","fr","fr-CA","ga","gd","gl","gu","ha-Latn-NG","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-KH","kn","ko","kok","ky","lb","lo","lt","lv","mi","mk","ml","mn","mr","ms","mt","nb-NO","ne","nl","nn-NO","or","pa","pl","prs","pt-BR","pt-PT","quz","ro","ru","sd","si","sk","sl","sq","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv","sw","ta","te","th","tk","tr","tt","ug","uk","ur","uz-Latn-UZ","vi","zh-Hans","zh-Hant"],l={"ZH-CN":"zh-Hans","ZH-HK":"zh-Hant","ZH-MO":"zh-Hant","ZH-SG":"zh-Hans","ZH-TW":"zh-Hant"};n.validate=function(t){var e=t.toLocaleUpperCase();if(e in l)return l[e];for(var n=0,i=u;n<i.length;n++){if((s=i[n]).toUpperCase()===e)return s}for(var r=e.split("-")[0],o=0,a=u;o<a.length;o++){var s;if((s=a[o]).toUpperCase()===r)return s}return"en"}},{}],52:[function(t,e,n){"use strict";n.__esModule=!0;var i,r,o,a,s,u,l,c,d,p,g,f,h,m,v,y,S,b,C,T,w,A,I,E,F,O,_,D,N,x,B,k,L,P,U,M,R,V,G,z,q=(W.InApp=((i=function(){}).UI=((r=function(){}).Picker=((o=function(){}).Shown=((a=function(){}).VALUE={name:"InApp_UI_Picker_Shown"},a),o),r.Form=((s=function(){}).Shown=((u=function(){}).VALUE={name:"InApp_UI_Form_Shown"},u),s.Submit=((l=function(){}).VALUE={name:"InApp_UI_Form_Submit"},l),s),r),i),W.Survey=((c=function(){}).UI=((d=function(){}).Prompt=((p=function(){}).Shown=((g=function(){}).VALUE={name:"Survey_UI_Prompt_Shown"},g),p),d.Form=((f=function(){}).Shown=((h=function(){}).VALUE={name:"Survey_UI_Form_Shown"},h),f.Submit=((m=function(){}).VALUE={name:"Survey_UI_Form_Submit"},m),f),d),c.Floodgate=((v=function(){}).TriggerMet=((y=function(){}).VALUE={name:"Survey_Floodgate_TriggerMet"},y),v.UserSelected=((S=function(){}).VALUE={name:"Survey_Floodgate_UserSelected"},S),v.CampaignLoad=((b=function(){}).Failed=((C=function(){}).VALUE={name:"Survey_Floodgate_CampaignLoad_Failed"},C),b),v.FileWrite=((T=function(){}).Failed=((w=function(){}).VALUE={name:"Survey_Floodgate_FileWrite_Failed"},w),T),v.FileRead=((A=function(){}).Failed=((I=function(){}).VALUE={name:"Survey_Floodgate_FileRead_Failed"},I),A),v),c),W.Shared=((E=function(){}).Upload=((F=function(){}).Failed=((O=function(){}).VALUE={name:"Shared_Upload_Failed"},O),F),E.Screenshot=((_=function(){}).Render=((D=function(){}).Failed=((N=function(){}).VALUE={name:"Shared_Screenshot_Render_Failed"},N),D.Success=((x=function(){}).VALUE={name:"Shared_Screenshot_Render_Success"},x),D),_.GetContent=((B=function(){}).Failed=((k=function(){}).DefaultImage=((L=function(){}).Returned=((P=function(){}).VALUE={name:"Shared_Screenshot_GetContent_Failed_DefaultImage_Returned"},P),L),k),B),_),E),W.WebSurfaces=((U=function(){}).Common=((M=function(){}).Error=((R=function(){}).VALUE={name:"WebSurfaces_Common_Error"},R),M.Info=((V=function(){}).VALUE={name:"WebSurfaces_Common_Info"},V),M),U.Messaging=((G=function(){}).Requests=((z=function(){}).VALUE={name:"WebSurfaces_Messaging_Requests"},z),G),U),W);function W(){}n.EventIds=q},{}],53:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("./../Constants"),u=t("./Telemetry/Contracts"),o=t("./../Utils"),l=t("./Telemetry/TelemetryLoggerFactory"),a=t("../FloodgateCore/FloodgateStorageProvider"),s=t("@ms-ofb/officefloodgatecore/dist/src/Api/IFloodgateStorageProvider"),i=t("./Constants");n.EventIds=i.EventIds;var c,d;n.initialize=function(t,e,n,i,r,o,a,s){c=new p(l.default.create(f.getTenantToken(t),"Office_Feedback",new u.App(e,n),new u.Session(s),new u.Host(r,o,a),new u.Release(i))),d=t},n.getLogger=function(){return c};var p=(g.prototype.logEvent=function(t,e,n){if(!t)throw new Error("eventId must not be null");if(o.isNullorUndefined(e)||0===e){if(d===r.Environment.Production){var i="logSeverity must not be null or none";this.isConsoleLogEnabled&&console&&console.log("Floodgate event: ",g.EVENT_NAME,i),this.telemetryLogger.logEvent(g.EVENT_NAME,{ErrorMessage:i})}return!1}return(n=n||{})[g.EVENT_ID]=t.name,this.isLoggingEnabled(e)&&this.telemetryLogger.logEvent(g.EVENT_NAME,n),this.isConsoleLogEnabled&&console&&console.log("Floodgate event: ",g.EVENT_NAME,e,n),!0},g.prototype.isLoggingEnabled=function(t){if(o.isNullorUndefined(this.logLevel)){var e=this.getCurrentLogLevel();this.logLevel=o.isNullorUndefined(e)?2:e}return t<=this.logLevel},g.prototype.getCurrentLogLevel=function(){try{var t="undefined"!=typeof URLSearchParams&&new URLSearchParams(window.location.search);t&&t.get("obfconsolelog")&&(this.isConsoleLogEnabled=!0);var e=t&&t.get("obfloglevel");if(!o.isNullorUndefined(e))return this.isConsoleLogEnabled=!0,parseInt(e,10);if(a.default.isStorageAvailable()){var n=(new a.default).read(s.FileType.LogLevelSettings);if(!o.isNullorUndefined(n)){var i=this.parseObject(n);if(!o.isNullorUndefined(i)&&i.content)return i.content.consoleLog&&(this.isConsoleLogEnabled=!0),i.content.logLevel}}}catch(t){return void(this.isConsoleLogEnabled&&console.log("Error while getting the current log level: ",t))}return null},g.prototype.parseObject=function(t){try{return JSON.parse(t)}catch(t){return this.isConsoleLogEnabled&&console.log("Error while parsing the json string for log level: ",t),null}},g.EVENT_NAME="SDK",g.EVENT_ID="EventId",g);function g(t){if(!t)throw new Error("telemetryLogger must not be null");this.telemetryLogger=t}n.Logger=p;var f=(h.getTenantToken=function(t){return t===r.Environment.Production?h.TENANT_TOKEN_PRODUCTION:h.TENANT_TOKEN_PRE_PRODUCTION},h.TENANT_TOKEN_PRODUCTION="d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360",h.TENANT_TOKEN_PRE_PRODUCTION="2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736",h);function h(){}},{"../FloodgateCore/FloodgateStorageProvider":50,"./../Constants":49,"./../Utils":83,"./Constants":52,"./Telemetry/Contracts":56,"./Telemetry/TelemetryLoggerFactory":57,"@ms-ofb/officefloodgatecore/dist/src/Api/IFloodgateStorageProvider":7}],54:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../thirdparty/aria-webjs-compact-sdk-1.2.2");n.AWT=function(){return i.AWT}},{"./../../thirdparty/aria-webjs-compact-sdk-1.2.2":88}],55:[function(t,e,n){"use strict";n.__esModule=!0;var a=t("./Aria"),o=t("./Contracts"),i=(s.setApp=function(t,e){t["App.Name"]=e.getName(),t["App.Platform"]=e.getPlatform(),t["App.Version"]=e.getVersion()},s.setSession=function(t,e){t["Session.Id"]=e.getId()},s.setHost=function(t,e){e&&(t["Host.Id"]=e.getId(),t["Host.Version"]=e.getVersion())},s.setEvent=function(t,e){t["Event.Name"]=e.getName(),t["Event.Id"]=e.getId(),t["Event.Source"]=e.getSource(),t["Event.SchemaVersion"]=e.getSchemaVersion(),t["Event.Sequence"]=e.getSequence()},s.setRelease=function(t,e){e&&(t["Release.AudienceGroup"]=e.getAudienceGroup())},s.prototype.logEvent=function(t,e){if(!t)throw new Error("eventName must not be null");var n=new o.Event(this.namespace+s.EVENT_NAME_DELIMITER+t,this.oesSession.getId(),this.sequence),i={};if(null!=e)for(var r in e)e.hasOwnProperty(r)&&(i[s.CUSTOM_PROPERTIES_FIELD_PREFIX+r]=e[r]);s.setApp(i,this.oesApp),s.setSession(i,this.oesSession),s.setHost(i,this.oesHost),s.setRelease(i,this.oesRelease),s.setEvent(i,n),a.AWT().logEvent({name:n.getName(),properties:i}),this.sequence++},s.EVENT_NAME_DELIMITER="_",s.CUSTOM_PROPERTIES_FIELD_PREFIX="Data.",s);function s(t,e,n,i,r,o){if(!t)throw new Error("tenantToken must not be null");if(!e)throw new Error("namespace must not be null");if(!n)throw new Error("app must not be null");if(!i)throw new Error("session must not be null");a.AWT().initialize(t),this.namespace=e,this.oesApp=n,this.oesSession=i,this.oesHost=r,this.oesRelease=o,this.sequence=1}n.default=i},{"./Aria":54,"./Contracts":56}],56:[function(t,e,n){"use strict";n.__esModule=!0;var i=(r.prototype.getName=function(){return this.name},r.prototype.getPlatform=function(){return r.PLATFORM},r.prototype.getVersion=function(){return this.version},r.PLATFORM="Web",r);function r(t,e){if(!t)throw new Error("name must not be null");if(!e)throw new Error("version must not be null");this.name=t,this.version=e}n.App=i;var o=(a.prototype.getId=function(){return this.id},a);function a(t){if(!t)throw new Error("id must not be null");this.id=t}n.Session=o;var s=(u.prototype.getId=function(){return this.id},u.prototype.getSessionId=function(){return this.sessionId},u.prototype.getVersion=function(){return this.version},u);function u(t,e,n){this.id=t,this.sessionId=e,this.version=n}n.Host=s;var l=(c.prototype.getName=function(){return this.name},c.prototype.getId=function(){return this.id},c.prototype.getSource=function(){return c.SOURCE},c.prototype.getSchemaVersion=function(){return c.SCHEMA_VERSION},c.prototype.getSequence=function(){return this.sequence},c.ID_DELIMITER=".",c.SOURCE="MsoThin",c.SCHEMA_VERSION=1,c);function c(t,e,n){if(!t)throw new Error("name must not be null");if(!e)throw new Error("sessionId must not be null");if(!n&&0!==n||n<0)throw new Error("sequence must not be negative");this.name=t,this.id=e+c.ID_DELIMITER+n,this.sequence=n}n.Event=l;var d=(p.prototype.getAudienceGroup=function(){return this.audienceGroup},p);function p(t){this.audienceGroup=t}n.Release=d},{}],57:[function(t,e,n){"use strict";n.__esModule=!0;var a=t("./AriaTelemetryLogger"),i=(r.create=function(t,e,n,i,r,o){return new a.default(t,e,n,i,r,o)},r);function r(){}n.default=i},{"./AriaTelemetryLogger":55}],58:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./Window/Window");n.createScreenShot=function(){return i.get().OfficeBrowserFeedback.html2canvas()(document.body,{background:"#ffffff"})}},{"./Window/Window":87}],59:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./Constants");n.initialize=function(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),t=t||"#0167B0",e=e||"#194789";var n=document.createElement("style");n.textContent="."+i.Classes.OverallAnchor+":focus { background-color: "+t+" } ."+i.Classes.OverallAnchor+":hover { background-color: "+e+" } ."+i.Classes.OverallAnchorActive+" { background-color: "+t+" } ."+i.Classes.SpinnerCircle+" { background-color: "+t+" } ."+i.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+i.Classes.ChoiceGroupIcon+" { border-color: "+t+" } ."+i.Classes.ChoiceGroup+" input[type=radio]:hover+label>."+i.Classes.ChoiceGroupIcon+" { border-color: "+e+" } ."+i.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+i.Classes.ChoiceGroupIcon+">span { background-color: "+t+" } ."+i.Classes.SubmitButton+" { background-color: "+t+" } ."+i.Classes.SubmitButton+":hover { background-color: "+e+" } ."+i.Classes.Link+" { color: "+t+" } ."+i.Classes.Link+":hover { color: "+e+" } #"+i.IDs.TPromptTitle+" { color: "+t+" } #"+i.IDs.TFormTitle+" { color: "+t+" } ",document.body.appendChild(n)}},{"./Constants":49}],60:[function(t,e,n){"use strict";n.__esModule=!0;var l=t("./../../Constants"),i=t("./../../Utils"),r=(o.prototype.setComment=function(t){this.manifestData.comment=t},o.prototype.setEmail=function(t){this.manifestData.email=t},o.prototype.setCategory=function(t){this.manifestData.telemetry=this.manifestData.telemetry||{},this.manifestData.telemetry.featureArea=t},o.prototype.setValues=function(t){if(t)for(var e in t)t.hasOwnProperty(e)&&(this.manifestData.hasOwnProperty(e)?this.manifestData[e]=i.overrideValues(t[e],this.manifestData[e]):this.manifestData[e]=t[e])},o.prototype.getContent=function(){return new Blob([JSON.stringify(this.manifestData)],{type:"application/json"})},o);function o(t,e,n,i,r,o,a,s){var u;this.manifestData={appId:e,application:o,clientFeedbackId:r,manifestType:t,source:"Client",submitTime:n,telemetry:a,type:(u=i,"Survey"===u?u:l.FeedbackType[u]),web:s}}n.Manifest=r},{"./../../Constants":49,"./../../Utils":83}],61:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("./../../Logging/Logging"),i=(o.prototype.getContent=function(){var e;try{e=this.screenshot.toDataURL("image/jpeg").split(",")[1]}catch(t){r.getLogger().logEvent(r.EventIds.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE,2,{ErrorMessage:t.toString()}),e="iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSFlzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsvwXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQJZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPdsswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0CbqaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII="}for(var t=atob(e),n=[],i=0;i<t.length;i++)n.push(t.charCodeAt(i));return new Blob([new Uint8Array(n)],{type:"image/jpeg"})},o);function o(t){this.screenshot=t}n.Screenshot=i},{"./../../Logging/Logging":53}],62:[function(t,e,n){"use strict";n.__esModule=!0;var c=t("es6-promise"),d=4e3;n.send=function(t,e,n,i){if(void 0===e)return c.Promise.reject(new Error("Manifest cannot be undefined"));var r,o,a,s,u,l=new FormData;return l.append("Manifest",e),n&&l.append("Screenshot",n),i&&l.append("Diagnostics",i),r="POST",o=t?"https://petrol.office.microsoft.com/v1/feedback":"https://petrol-int.office.microsoft.com/v1/feedback",a=l,s=function(t,e,n){200!==t.status&&n(new Error("Non-200 response with status code: "+t.status+", response: "+t.responseText)),e()},(u=function(i){return new c.Promise(function(t,e){var n=new XMLHttpRequest;n.open(r,o,!0),n.timeout=d,n.onload=function(){s(n,t,e)},n.ontimeout=function(){0<i?u(i-1).then(t,e):e(new Error("Request to '"+o+"' timed out. timeout: "+d))},n.onerror=function(){0<i?u(i-1).then(t,e):e(new Error("Request to '"+o+"' errored. "+n.status+": "+n.responseText))},n.send(a)})})(2)}},{"es6-promise":44}],63:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants"),s=t("./../Utils"),r=t("./../Logging/Logging"),o=t("./Petrol"),a=t("./Files/Screenshot"),u=t("../Configuration/Configuration"),l=t("./Files/Manifest"),c=(d.prototype.setComment=function(t){this.manifest.setComment(t)},d.prototype.setEmail=function(t){this.manifest.setEmail(t)},d.prototype.setCategory=function(t){this.manifest.setCategory(t)},d.prototype.setScreenshot=function(t){this.screenshot=new a.Screenshot(t)},d.prototype.setManifestValues=function(t){this.manifest.setValues(t)},d.prototype.submit=function(){var t=this.manifest.getContent(),e=void 0;return this.screenshot&&(e=this.screenshot.getContent()),o.send(this.environment===i.Environment.Production,t,e).catch(function(t){u.get().getCommonInitOptions().onError("Payload submission failed: "+t.message),r.getLogger().logEvent(r.EventIds.Shared.Upload.Failed.VALUE,2,{ErrorMessage:t.message})})},d);function d(t,e,n,i,r,o,a){this.manifest=new l.Manifest(e,n,(new Date).toISOString(),i,s.guid(),r,o,a),this.environment=t}n.Transporter=c},{"../Configuration/Configuration":48,"./../Constants":49,"./../Logging/Logging":53,"./../Utils":83,"./Files/Manifest":60,"./Files/Screenshot":61,"./Petrol":62}],64:[function(t,e,n){"use strict";var i;n.__esModule=!0,n.setUIStrings=function(t){i=t},n.getUIStrings=function(){return i}},{}],65:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Constants"),r=t("./Events"),o=t("./Layout"),a=t("./../Renderer"),s=t("./../Utils"),u=t("./../../WindowProperties"),l=t("./FormTemplates/BasicFormTemplate"),c=t("./FormTemplates/UserVoiceFormTemplate"),d=t("./../../Configuration/Configuration");function p(t){document.body.insertBefore(t,document.body.firstChild),s.setElementVisibility(i.IDs.OverlayBackground,!0),9<s.getInternetExplorerVersion()||-1===s.getInternetExplorerVersion()?setTimeout(g,900):g()}function g(){s.setElementVisibility(i.IDs.MainContentHolder,!0),document.getElementById(i.IDs.OverallSmileAnchor)?document.getElementById(i.IDs.OverallSmileAnchor).focus():document.getElementById(i.IDs.SingleFormComment)&&document.getElementById(i.IDs.SingleFormComment).focus()}n.createMulti=function(e){var t={};t[i.FeedbackType.Smile]=l,t[i.FeedbackType.Frown]=l,d.get().getInAppFeedbackInitOptions().userVoice&&"en"===d.get().getCommonInitOptions().locale?t[i.FeedbackType.Idea]=c:t[i.FeedbackType.Idea]=l,d.get().getInAppFeedbackInitOptions().bugForm&&(t[i.FeedbackType.Bug]=l),p(a.elementFromJson(o.generateMulti(t)));var n=u.isNarrow();r.registerMulti(t,n,function(t){s.setElementVisibility(i.IDs.OverlayBackground,!1),s.deleteElementById(i.IDs.OverlayBackground),d.get().getInAppFeedbackInitOptions().onDismiss(t),e()}),n&&s.addClassById(i.IDs.OverlayBackground,i.Classes.NarrowLayout)},n.createSingle=function(e,t){p(a.elementFromJson(o.generateSingle())),r.registerSingle(t,function(t){s.setElementVisibility(i.IDs.OverlayBackground,!1),s.deleteElementById(i.IDs.OverlayBackground),d.get().getInAppFeedbackInitOptions().onDismiss(t),e()}),s.addClassById(i.IDs.OverlayBackground,i.Classes.SingleLayout)},n.dismiss=function(){}},{"./../../Configuration/Configuration":48,"./../../Constants":49,"./../../WindowProperties":85,"./../Renderer":76,"./../Utils":82,"./Events":66,"./FormTemplates/BasicFormTemplate":67,"./FormTemplates/UserVoiceFormTemplate":70,"./Layout":71}],66:[function(t,e,n){"use strict";n.__esModule=!0;var i,r,m=t("./../../Transport/Transport"),v=t("./../../Configuration/Configuration"),o=t("./../../Constants"),y=t("./../../Logging/Logging"),S=t("./../../Screenshot"),b=t("./../SpinnerControl"),C=t("./../Utils"),a=t("./TabFocus"),s=!1,T=void 0,u=[o.IDs.OverallSmileAnchor,o.IDs.OverallFrownAnchor,o.IDs.OverallIdeaAnchor,o.IDs.OverallBugAnchor];function l(t){var e;for(e=0;e<u.length;e++)u[e]===t?C.setAttributeOnHtmlElement(u[e],o.AttributeName.AriaSelected,o.AttributeValue.True):C.setAttributeOnHtmlElement(u[e],o.AttributeName.AriaSelected,o.AttributeValue.False)}function w(t){C.removeEventListenerHelper(window,"keyup",f),function(){for(var t=0,e=c;t<e.length;t++){var n=e[t];C.unregisterListener(n.id,n.event,n.listener)}c=[]}(),i(t)}var c=[];function d(t,e,n){C.registerListener(t,e,n),c.push({event:e,id:t,listener:n})}function p(t){i=t,C.addEventListenerHelper(window,"keyup",f),d(o.IDs.OverlayBackground,"click",h),d(o.IDs.MainContainer,"click",A),d(o.IDs.MainContainer,"keyup",g),d(o.IDs.PrivacyStatementLink,"click",I)}function g(t){(t.keyCode||t.which)===o.Keys.Tab&&(document.activeElement.id===o.IDs.FirstTabbable&&t.shiftKey||document.activeElement.id===o.IDs.LastTabbable&&!t.shiftKey)&&(t.stopPropagation(),a.cycleTabFocus(document.activeElement))}function f(t){t.keyCode===o.Keys.Esc&&(t.preventDefault(),t.stopPropagation(),w(!1))}function h(t){t.preventDefault(),t.stopPropagation(),w(!1)}function A(t){t.stopPropagation()}function I(t){t.stopPropagation()}function E(t,e){t.preventDefault(),t.stopPropagation(),C.replaceClassesById(o.IDs.OverallSmileAnchor,o.Classes.OverallAnchorActive),C.replaceClassesById(o.IDs.OverallFrownAnchor,o.Classes.OverallAnchorActive),C.replaceClassesById(o.IDs.OverallIdeaAnchor,o.Classes.OverallAnchorActive),C.replaceClassesById(o.IDs.OverallBugAnchor,o.Classes.OverallAnchorActive),C.addClassById(e,o.Classes.OverallAnchorActive),y.getLogger().logEvent(y.EventIds.InApp.UI.Form.Shown.VALUE,1,{FeedbackType:T});var n=r[T];!function(t){for(var e in r)r.hasOwnProperty(e)&&C.setElementVisibility(r[e].containerId,!1);s?(C.setElementVisibility(o.IDs.LeftFormContainer,!1),C.setElementVisibility(o.IDs.MiddleFormContainer,!0),C.setElementVisibility(t,!0)):(C.addClassById(o.IDs.ColumnSeparatorDiv,o.Classes.ShowRightBorder),C.setElementVisibility(o.IDs.MiddleFormContainer,!0),C.setElementVisibility(t,!0),C.addClassById(o.IDs.LeftFormContainer,o.Classes.SlideLeft),C.addClassById(o.IDs.MiddleFormContainer,o.Classes.SlideLeft))}(n.containerId),n.onSelect(T)}function F(t){T=o.FeedbackType.Smile,l(o.IDs.OverallSmileAnchor),C.setAttributeOnHtmlElement(o.IDs.MiddleFormContainer,o.AttributeName.AriaExpanded,o.AttributeValue.True),C.setAttributeOnHtmlElement(o.IDs.MiddleFormContainer,o.AttributeName.AriaLabelledBy,o.IDs.OverallSmileAnchor),E(t,o.IDs.OverallSmileAnchor)}function O(t){T=o.FeedbackType.Frown,l(o.IDs.OverallFrownAnchor),C.setAttributeOnHtmlElement(o.IDs.MiddleFormContainer,o.AttributeName.AriaExpanded,o.AttributeValue.True),C.setAttributeOnHtmlElement(o.IDs.MiddleFormContainer,o.AttributeName.AriaLabelledBy,o.IDs.OverallFrownAnchor),E(t,o.IDs.OverallFrownAnchor)}function _(t){T=o.FeedbackType.Idea,l(o.IDs.OverallIdeaAnchor),C.setAttributeOnHtmlElement(o.IDs.MiddleFormContainer,o.AttributeName.AriaExpanded,o.AttributeValue.True),C.setAttributeOnHtmlElement(o.IDs.MiddleFormContainer,o.AttributeName.AriaLabelledBy,o.IDs.OverallIdeaAnchor),E(t,o.IDs.OverallIdeaAnchor)}function D(t){T=o.FeedbackType.Bug,l(o.IDs.OverallBugAnchor),C.setAttributeOnHtmlElement(o.IDs.MiddleFormContainer,o.AttributeName.AriaExpanded,o.AttributeValue.True),C.setAttributeOnHtmlElement(o.IDs.MiddleFormContainer,o.AttributeName.AriaLabelledBy,o.IDs.OverallBugAnchor),E(t,o.IDs.OverallBugAnchor)}function N(c,d,p,g,f,h){return function(t){t.preventDefault(),t.stopPropagation(),C.setElementVisibility(c,!1);var e=new b.Spinner(d),n=new m.Transporter(v.get().getCommonInitOptions().environment,"Sas",v.get().getCommonInitOptions().appId,T,v.get().getCommonInitOptions().applicationGroup,v.get().getCommonInitOptions().telemetryGroup,v.get().getCommonInitOptions().webGroup),i=document.getElementById(p);i&&!!i.value&&n.setComment(i.value);var r=document.getElementById(g),o=r&&!!r.value;o&&n.setEmail(r.value);var a=document.getElementById(f),s=a&&a.checked,u=document.getElementById(h);if(u&&0<u.selectedIndex&&n.setCategory(u.value),y.getLogger().logEvent(y.EventIds.InApp.UI.Form.Submit.VALUE,1,{FeedbackType:T,IsEmailIncluded:o,IsScreenshotIncluded:s}),s){var l=performance.now();S.createScreenShot().then(function(t){var e=performance.now();y.getLogger().logEvent(y.EventIds.Shared.Screenshot.Render.Success.VALUE,1,{TimeMilliseconds:e-l}),n.setScreenshot(t),n.submit()}).catch(function(t){var e=performance.now();y.getLogger().logEvent(y.EventIds.Shared.Screenshot.Render.Failed.VALUE,2,{ErrorMessage:t,TimeMilliseconds:e-l}),n.submit()})}else n.submit();e.destroy(),w(!0)}}function x(t){t.preventDefault(),t.stopPropagation(),window.open(document.getElementById(o.IDs.UserVoiceFormGoButton).getAttribute(o.AttributeName.Source)),w(!1)}n.registerSingle=function(t,e){void 0===e&&(e=function(t){}),T=t,d(o.IDs.SingleFormSubmitButton,"click",N(o.IDs.SingleFormSubmitButton,o.IDs.SingleFormSubmitButtonSpinner,o.IDs.SingleFormComment,o.IDs.SingleFormEmailInput,o.IDs.SingleFormScreenshotCheckbox,o.IDs.SingleFormCategoriesDropdown)),p(e)},n.registerMulti=function(t,e,n){void 0===n&&(n=function(t){}),s=e,r=t,d(o.IDs.OverallSmileAnchor,"click",F),d(o.IDs.OverallFrownAnchor,"click",O),d(o.IDs.OverallIdeaAnchor,"click",_),d(o.IDs.OverallBugAnchor,"click",D),d(o.IDs.BasicFormSubmitButton,"click",N(o.IDs.BasicFormSubmitButton,o.IDs.BasicFormSubmitButtonSpinner,o.IDs.BasicFormComment,o.IDs.BasicFormEmailInput,o.IDs.BasicFormScreenshotCheckbox,o.IDs.BasicFormCategoriesDropdown)),d(o.IDs.UserVoiceFormGoButton,"click",x),p(n)}},{"./../../Configuration/Configuration":48,"./../../Constants":49,"./../../Logging/Logging":53,"./../../Screenshot":58,"./../../Transport/Transport":63,"./../SpinnerControl":77,"./../Utils":82,"./TabFocus":72}],67:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../../UIStrings/UIStrings"),r=t("./FormTemplateType"),o=t("./../../CategoriesDropdown"),a=t("./../../RatingControl"),s=t("./../../../Constants"),u=t("./../../../Configuration/Configuration");n.generate=function(){var t=u.get().getInAppFeedbackLaunchOptions().categories;return{children:[{attributes:[{name:s.AttributeName.For,value:s.IDs.BasicFormComment}],classes:[s.Classes.FontSubtitle,s.Classes.TextAlignLeft,s.Classes.FormQuestionMiddleText],id:s.IDs.BasicFormQuestionMiddleText,tag:s.Tags.Label},{attributes:[{name:s.AttributeName.Id,value:s.IDs.BasicFormCategoriesDropdown}],brs:t.show,children:o.generate(t?t.customCategories:null),classes:[s.Classes.FontSubText,s.Classes.FormCategoriesDropdown,s.Classes.TextInput],tag:s.Tags.Select},{attributes:[{name:s.AttributeName.Placeholder,value:i.getUIStrings().Form.CommentPlaceholder},{name:s.AttributeName.MaxLength,value:s.AttributeValue.TextAreaMaxLength}],classes:[s.Classes.FontSubText,s.Classes.FormComment,s.Classes.TextInput],id:s.IDs.BasicFormComment,tag:s.Tags.TextArea},{brs:!1,children:[{attributes:[{name:s.AttributeName.For,value:s.IDs.BasicFormRating}],classes:[s.Classes.FontText,s.Classes.TextAlignLeft,s.Classes.FormRatingLabel],innerText:i.getUIStrings().Form.RatingLabel,tag:s.Tags.Label},a.generate(s.IDs.BasicFormRating)],classes:[s.Classes.FormRatingContainer]},{attributes:[{name:s.AttributeName.Type,value:s.AttributeValue.Text},{name:s.AttributeName.Placeholder,value:i.getUIStrings().Form.EmailPlaceholder},{name:s.AttributeName.AriaLabel,value:i.getUIStrings().Form.EmailPlaceholder},{name:s.AttributeName.Name,value:s.IDs.BasicFormEmailInput},{name:s.AttributeName.MaxLength,value:s.AttributeValue.TextAreaMaxLength},{name:s.AttributeName.Value,value:u.get().getInAppFeedbackInitOptions().userEmail?u.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[s.Classes.FontSubText,s.Classes.FormEmailInput,s.Classes.TextInput],id:s.IDs.BasicFormEmailInput,tag:s.Tags.Input},{children:[{attributes:[{name:s.AttributeName.HRef,value:s.Urls.PrivacyStatementLink},{name:s.AttributeName.Target,value:s.AttributeValue.BlankWindow},{name:s.AttributeName.Rel,value:s.AttributeValue.NoReferrer}],classes:[s.Classes.Link],id:s.IDs.PrivacyStatementLink,innerText:i.getUIStrings().PrivacyStatement,tag:s.Tags.Anchor}],classes:[s.Classes.FontSubSubText,s.Classes.TextAlignLeft,s.Classes.PrivacyStatementLinkDiv]},{children:[{children:[{attributes:[{name:s.AttributeName.Type,value:s.AttributeValue.Checkbox},{name:s.AttributeName.Value,value:s.AttributeValue.Unchecked}],brs:u.get().getInAppFeedbackInitOptions().screenshot,classes:[s.Classes.FormScreenshotCheckbox,s.Classes.CheckBox],id:s.IDs.BasicFormScreenshotCheckbox,tag:s.Tags.Input},{attributes:[{name:s.AttributeName.For,value:s.IDs.BasicFormScreenshotCheckbox}],brs:u.get().getInAppFeedbackInitOptions().screenshot,classes:[s.Classes.FontText,s.Classes.TextAlignLeft,s.Classes.FormScreenshotLabel],innerText:i.getUIStrings().Form.ScreenshotLabel,tag:s.Tags.Label}],classes:[s.Classes.FormScreenshotContainer]},{children:[{classes:[s.Classes.SubmitButton],id:s.IDs.BasicFormSubmitButton,innerText:i.getUIStrings().Form.Submit,tag:s.Tags.Button},{classes:[s.Classes.Spinner,s.Classes.Hidden],id:s.IDs.BasicFormSubmitButtonSpinner,tag:s.Tags.Div}],classes:[s.Classes.FormSubmitButtonContainer]}],classes:[s.Classes.FormBottomContainer]}],classes:[s.Classes.Hidden,s.Classes.MarginLeft60px],id:n.containerId}},n.containerId=s.IDs.BasicFormContainer,n.onSelect=function(t){switch(t){case s.FeedbackType.Smile:document.getElementById(s.IDs.BasicFormQuestionMiddleText).textContent=i.getUIStrings().SmileForm.Title;break;case s.FeedbackType.Frown:document.getElementById(s.IDs.BasicFormQuestionMiddleText).textContent=i.getUIStrings().FrownForm.Title;break;case s.FeedbackType.Idea:document.getElementById(s.IDs.BasicFormQuestionMiddleText).textContent=i.getUIStrings().IdeaForm.Title;break;case s.FeedbackType.Bug:document.getElementById(s.IDs.BasicFormQuestionMiddleText).textContent=i.getUIStrings().BugForm.Title}document.getElementById(s.IDs.BasicFormComment).focus()},n.type=r.FormTemplateType.Basic},{"./../../../Configuration/Configuration":48,"./../../../Constants":49,"./../../../UIStrings/UIStrings":64,"./../../CategoriesDropdown":73,"./../../RatingControl":75,"./FormTemplateType":68}],68:[function(t,e,n){"use strict";var i;n.__esModule=!0,(i=n.FormTemplateType||(n.FormTemplateType={}))[i.Single=0]="Single",i[i.Basic=1]="Basic",i[i.UserVoice=2]="UserVoice"},{}],69:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../../UIStrings/UIStrings"),r=t("./FormTemplateType"),o=t("./../../CategoriesDropdown"),a=t("./../../RatingControl"),s=t("./../../../Configuration/Configuration"),u=t("./../../../Constants");n.generate=function(){var t=s.get().getInAppFeedbackLaunchOptions().categories;return{children:[{attributes:[{name:u.AttributeName.For,value:u.IDs.SingleFormComment}],classes:[u.Classes.FontSubtitle,u.Classes.TextAlignLeft,u.Classes.FormQuestionMiddleText],id:u.IDs.SingleFormQuestionMiddleText,innerText:i.getUIStrings().SingleForm.Title,tag:u.Tags.Label},{attributes:[{name:u.AttributeName.Id,value:u.IDs.SingleFormCategoriesDropdown}],brs:t.show,children:o.generate(t?t.customCategories:null),classes:[u.Classes.FontSubText,u.Classes.FormCategoriesDropdown,u.Classes.TextInput],tag:u.Tags.Select},{attributes:[{name:u.AttributeName.Placeholder,value:i.getUIStrings().Form.CommentPlaceholder},{name:u.AttributeName.MaxLength,value:u.AttributeValue.TextAreaMaxLength}],classes:[u.Classes.FontSubText,u.Classes.FormComment,u.Classes.TextInput],id:u.IDs.SingleFormComment,tag:u.Tags.TextArea},{brs:!1,children:[{attributes:[{name:u.AttributeName.For,value:u.IDs.SingleFormRating}],classes:[u.Classes.FontSubText,u.Classes.TextAlignLeft,u.Classes.FormRatingLabel],innerText:i.getUIStrings().Form.RatingLabel,tag:u.Tags.Label},a.generate(u.IDs.SingleFormRating)],classes:[u.Classes.FormRatingContainer]},{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Text},{name:u.AttributeName.Placeholder,value:i.getUIStrings().Form.EmailPlaceholder},{name:u.AttributeName.AriaLabel,value:i.getUIStrings().Form.EmailPlaceholder},{name:u.AttributeName.Name,value:u.IDs.SingleFormEmailInput},{name:u.AttributeName.MaxLength,value:u.AttributeValue.TextAreaMaxLength},{name:u.AttributeName.Value,value:s.get().getInAppFeedbackInitOptions().userEmail?s.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[u.Classes.FontSubText,u.Classes.FormEmailInput,u.Classes.TextInput],id:u.IDs.SingleFormEmailInput,tag:u.Tags.Input},{children:[{attributes:[{name:u.AttributeName.HRef,value:u.Urls.PrivacyStatementLink},{name:u.AttributeName.Target,value:u.AttributeValue.BlankWindow},{name:u.AttributeName.Rel,value:u.AttributeValue.NoReferrer}],classes:[u.Classes.Link],id:u.IDs.PrivacyStatementLink,innerText:i.getUIStrings().PrivacyStatement,tag:u.Tags.Anchor}],classes:[u.Classes.FontSubSubText,u.Classes.TextAlignLeft,u.Classes.PrivacyStatementLinkDiv]},{children:[{children:[{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Checkbox},{name:u.AttributeName.Value,value:u.AttributeValue.Unchecked}],brs:s.get().getInAppFeedbackInitOptions().screenshot,classes:[u.Classes.FormScreenshotCheckbox,u.Classes.CheckBox],id:u.IDs.SingleFormScreenshotCheckbox,tag:u.Tags.Input},{attributes:[{name:u.AttributeName.For,value:u.IDs.SingleFormScreenshotCheckbox}],brs:s.get().getInAppFeedbackInitOptions().screenshot,classes:[u.Classes.FontText,u.Classes.TextAlignLeft,u.Classes.FormScreenshotLabel],innerText:i.getUIStrings().Form.ScreenshotLabel,tag:u.Tags.Label}],classes:[u.Classes.FormScreenshotContainer]},{children:[{classes:[u.Classes.SubmitButton],id:u.IDs.SingleFormSubmitButton,innerText:i.getUIStrings().Form.Submit,tag:u.Tags.Button},{classes:[u.Classes.Spinner,u.Classes.Hidden],id:u.IDs.SingleFormSubmitButtonSpinner,tag:u.Tags.Div}],classes:[u.Classes.FormSubmitButtonContainer]}],classes:[u.Classes.FormBottomContainer]}],id:n.containerId}},n.containerId=u.IDs.SingleFormContainer,n.onSelect=function(t){document.getElementById(u.IDs.SingleFormComment).focus()},n.type=r.FormTemplateType.Single},{"./../../../Configuration/Configuration":48,"./../../../Constants":49,"./../../../UIStrings/UIStrings":64,"./../../CategoriesDropdown":73,"./../../RatingControl":75,"./FormTemplateType":68}],70:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../../UIStrings/UIStrings"),r=t("./FormTemplateType"),o=t("./../../../Constants"),a=t("./../../../Configuration/Configuration");n.generate=function(){var t=a.get().getInAppFeedbackInitOptions().userVoice;return{children:[{classes:[o.Classes.FontSubtitle,o.Classes.TextAlignLeft,o.Classes.FormQuestionMiddleText],innerText:i.getUIStrings().UserVoiceForm.Title},{classes:[o.Classes.FontText,o.Classes.TextAlignLeft,o.Classes.FormMiddleText],innerText:i.getUIStrings().UserVoiceForm.Text},{children:[{children:[{attributes:[{name:o.AttributeName.Source,value:t.url}],classes:[o.Classes.SubmitButton],id:o.IDs.UserVoiceFormGoButton,innerText:i.getUIStrings().UserVoiceForm.Button,tag:o.Tags.Button}],classes:[o.Classes.FormSubmitButtonContainer]}],classes:[o.Classes.FormBottomContainer]}],classes:[o.Classes.Hidden,o.Classes.MarginLeft60px],id:n.containerId}},n.containerId=o.IDs.UserVoiceFormContainer,n.onSelect=function(t){document.getElementById(o.IDs.UserVoiceFormGoButton).focus()},n.type=r.FormTemplateType.UserVoice},{"./../../../Configuration/Configuration":48,"./../../../Constants":49,"./../../../UIStrings/UIStrings":64,"./FormTemplateType":68}],71:[function(t,e,n){"use strict";n.__esModule=!0;var o=t("./../../Constants"),i=t("./../../UIStrings/UIStrings"),r=t("./../Utils"),a=t("./FormTemplates/SingleFormTemplate");function s(t,e,n,i,r){return{attributes:[{name:o.AttributeName.Type,value:o.AttributeValue.Button},{name:o.AttributeName.Role,value:o.AttributeValue.Tab},{name:o.AttributeName.AriaLabel,value:r},{name:o.AttributeName.AriaSelected,value:o.AttributeValue.False}],children:[{classes:[o.Classes.OverallImage],id:e,innerHTML:n,tag:o.Tags.Div},{classes:[o.Classes.FontSubtitle,o.Classes.OverallText],id:i,innerText:r}],classes:[o.Classes.OverallAnchor,o.Classes.TextAlignLeft],id:t,tag:o.Tags.Button}}n.generateMulti=function(t){return{attributes:[{name:o.AttributeName.DataHtml2CanvasIgnore,value:o.AttributeValue.True}],children:[{attributes:[{name:o.AttributeName.Role,value:o.AttributeValue.Dialog},{name:o.AttributeName.AriaModal,value:o.AttributeValue.True}],children:[{attributes:[{name:o.AttributeName.Role,value:o.AttributeValue.TabList},{name:o.AttributeName.AriaDescribedBy,value:o.IDs.QuestionLeftText},{name:o.AttributeName.AriaLabel,value:i.getUIStrings().FeedbackSubtitle},{name:o.AttributeName.AriaOrientation,value:o.AttributeValue.AriaOrientationValueVertical}],children:[{attributes:[{name:o.AttributeName.TabIndex,value:o.AttributeValue.Zero}],id:o.IDs.FirstTabbable},{children:[{children:[{classes:[o.Classes.FontSubtitle,o.Classes.TextAlignLeft],id:o.IDs.QuestionLeftText,innerText:i.getUIStrings().FeedbackSubtitle},{children:[{children:function(t){var e={children:[]};o.FeedbackType.Smile in t&&e.children.push(s(o.IDs.OverallSmileAnchor,o.IDs.OverallSmileImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM36 58.6c-8.5 0-16-4.1-20.9-10.4l3.5-3.6c3.5 4.5 9.9 7.6 17.4 7.6 7.4 0 13.9-3.1 17.4-7.6l3.6 3.6C52.1 54.4 44.4 58.6 36 58.6Z"/></svg>',o.IDs.OverallSmileText,i.getUIStrings().SmileForm.Anchor));o.FeedbackType.Frown in t&&e.children.push(s(o.IDs.OverallFrownAnchor,o.IDs.OverallFrownImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM52.8 57.9c-3.3-4.4-9.6-7.3-16.7-7.3 -7.2 0-13.4 3-16.7 7.3l-3.4-3.4c4.7-6.1 11.9-10 20.1-10 8.2 0 15.5 4 20.2 10L52.8 57.9Z"/></svg>',o.IDs.OverallFrownText,i.getUIStrings().FrownForm.Anchor));o.FeedbackType.Idea in t&&e.children.push(s(o.IDs.OverallIdeaAnchor,o.IDs.OverallIdeaImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M42.3 62H29.2c-1.1 0-2 0.9-2 2s1.9 2 3 2h11.1c1.1 0 3-0.9 3-2S43.4 62 42.3 62ZM36 1.1C25 1.1 14.8 7 14.8 20.6c0 2.2 0.8 4.4 0.7 4.1 1.2 2.9 2.7 5.6 6.3 10.9 4.2 6.3 4.7 7.6 4.8 11.1v1.3c0 1.3 1 3 2.7 3h13.5c1.7 0 2.8-1.7 2.8-3v-1.5c0.1-3.5 0.1-4.7 4.2-10.9 3.6-5.4 5.7-8.4 6.8-11 0 0 0.6-1.6 0.6-4.1C57.2 6.9 47 1.1 36 1.1ZM31.9 11.9c-3.2 0-5.6 4.2-5.5 6.2 0.2 4-4.4 3.8-4.4 0.6 0-5.3 2.8-10.3 8.5-10.9C34.6 7.3 34.6 11.9 31.9 11.9ZM43.6 55h-15c-1.1 0-2 0.9-2 2v1c0 1.1 0.9 2 2 2h15c1.1 0 2-0.9 2-2v-1C45.6 55.9 44.7 55 43.6 55ZM39.1 68h-6c-0.8 0-1.5 0.7-1.5 1.5s1.2 1.5 2 1.5h5c0.8 0 2-0.7 2-1.5S39.9 68 39.1 68Z"/></svg>',o.IDs.OverallIdeaText,i.getUIStrings().IdeaForm.Anchor));o.FeedbackType.Bug in t&&e.children.push(s(o.IDs.OverallBugAnchor,o.IDs.OverallBugImage,'<svg viewBox="150 100 1748 1748" width="24px" height="24px" focusable="false"><path d="M1824 1088q0 26-19 45t-45 19h-224q0 171-67 290l208 209q19 19 19 45t-19 45q-18 19-45 19t-45-19l-198-197q-5 5-15 13t-42 28.5-65 36.5-82 29-97 13v-896h-128v896q-51 0-101.5-13.5t-87-33-66-39-43.5-32.5l-15-14-183 207q-20 21-48 21-24 0-43-16-19-18-20.5-44.5t15.5-46.5l202-227q-58-114-58-274h-224q-26 0-45-19t-19-45 19-45 45-19h224v-294l-173-173q-19-19-19-45t19-45 45-19 45 19l173 173h844l173-173q19-19 45-19t45 19 19 45-19 45l-173 173v294h224q26 0 45 19t19 45zm-480-576h-640q0-133 93.5-226.5t226.5-93.5 226.5 93.5 93.5 226.5z"/></svg>',o.IDs.OverallBugText,i.getUIStrings().BugForm.Anchor));return e.children}(t),id:o.IDs.OverallAnchorsContainer}],id:o.IDs.ColumnSeparatorDiv},{children:[{attributes:[{name:o.AttributeName.HRef,value:o.Urls.PrivacyStatementLink},{name:o.AttributeName.Target,value:o.AttributeValue.BlankWindow},{name:o.AttributeName.Rel,value:o.AttributeValue.NoReferrer}],classes:[o.Classes.Link],id:o.IDs.PrivacyStatementLink,innerText:i.getUIStrings().PrivacyStatement,tag:o.Tags.Anchor}],classes:[o.Classes.FontSubSubText,o.Classes.TextAlignLeft,o.Classes.PrivacyStatementLinkDiv]}],classes:[o.Classes.FormContainer],id:o.IDs.LeftFormContainer},{children:function(t){var e={children:[]},n={};for(var i in t){if(t.hasOwnProperty(i))!(t[i].containerId in n)&&(e.children.push(t[i].generate()),n[t[i].containerId]=!0)}return e.children}(t),classes:[o.Classes.FormContainer,o.Classes.Hidden],attributes:[{name:o.AttributeName.Role,value:o.AttributeValue.TabPanel},{name:o.AttributeName.AriaExpanded,value:o.AttributeValue.False}],id:o.IDs.MiddleFormContainer}],classes:[o.Classes.Hidden],id:o.IDs.MainContentHolder,tag:o.Tags.Form},{attributes:[{name:o.AttributeName.TabIndex,value:o.AttributeValue.Zero}],id:o.IDs.LastTabbable}],id:o.IDs.MainContainer}],classes:[r.isRightToLeft()?o.Classes.Rtl:""],id:o.IDs.OverlayBackground}]}},n.generateSingle=function(){return{attributes:[{name:o.AttributeName.DataHtml2CanvasIgnore,value:o.AttributeValue.True}],children:[{children:[{attributes:[{name:o.AttributeName.TabIndex,value:o.AttributeValue.Zero}],id:o.IDs.FirstTabbable},{children:[{children:[a.generate()],classes:[o.Classes.FormContainer],id:o.IDs.MiddleFormContainer}],classes:[o.Classes.Hidden],id:o.IDs.MainContentHolder,tag:o.Tags.Form},{attributes:[{name:o.AttributeName.TabIndex,value:o.AttributeValue.Zero}],id:o.IDs.LastTabbable}],id:o.IDs.MainContainer}],classes:[o.Classes.SingleLayout,r.isRightToLeft()?o.Classes.Rtl:""],id:o.IDs.OverlayBackground}}},{"./../../Constants":49,"./../../UIStrings/UIStrings":64,"./../Utils":82,"./FormTemplates/SingleFormTemplate":69}],72:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("./../../Constants");function o(t){if(!t.parentElement)return!1;if(/\S/.test(t.parentElement.id)){if(0<=t.parentElement.className.indexOf(r.Classes.Visible))return!0;if(0<=t.parentElement.className.indexOf(r.Classes.Hidden))return!1}return o(t.parentElement)}n.cycleTabFocus=function(t){var e=document.getElementById(r.IDs.MainContainer).querySelectorAll("a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']), select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex ='-1']), object, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]");if(t.id===r.IDs.LastTabbable)for(var n=0;n<e.length;n++){if((i=e[n]).id!==r.IDs.FirstTabbable&&o(i))return void i.focus()}else if(t.id===r.IDs.FirstTabbable)for(n=e.length-1;0<=n;n--){var i;if((i=e[n]).id!==r.IDs.LastTabbable&&o(i))return void i.focus()}}},{"./../../Constants":49}],73:[function(t,e,n){"use strict";n.__esModule=!0;var a=t("./../UIStrings/UIStrings"),s=t("./../Constants");n.generate=function(t){for(var e=t||[],n=[{attributes:[{name:"selected",value:"true"}],innerText:a.getUIStrings().Form.CategoryPlaceholder,tag:s.Tags.Option}],i=0,r=e;i<r.length;i++){var o=r[i];n.push({innerText:o,tag:s.Tags.Option})}return n}},{"./../Constants":49,"./../UIStrings/UIStrings":64}],74:[function(t,e,n){"use strict";n.__esModule=!0;var c=t("./../Constants");n.generateRadioGroup=function(t,e,n){for(var i,r,o,a={children:[{classes:[c.Classes.FontSubText],id:c.IDs.TFormRatingQuestion,innerText:e,tag:c.Tags.Legend,attributes:[{name:"tabindex",value:"0"}]}],tag:c.Tags.FieldSet},s=0,u=n;s<u.length;s++){var l=u[s];Array.prototype.push.apply(a.children,(i=l[0].toString(),r=l[1],o=t,[{attributes:[{name:c.AttributeName.Type,value:c.AttributeValue.Radio},{name:c.AttributeName.Value,value:i},{name:c.AttributeName.Name,value:o}],id:i,tag:c.Tags.Input},{attributes:[{name:c.AttributeName.For,value:i}],children:[{children:[{tag:c.Tags.Span}],classes:[c.Classes.ChoiceGroupIcon],tag:c.Tags.Span},{classes:["obf-ChoiceGroupLabel"],innerHTML:r,tag:c.Tags.Span}],classes:[c.Classes.FontSubText],tag:c.Tags.Label}]))}return{children:[a],classes:[c.Classes.ChoiceGroup],id:t}}},{"./../Constants":49}],75:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants"),r="obf-star",o={children:[{attributes:[{name:i.AttributeName.Id,value:r},{name:i.AttributeName.X,value:"0"},{name:i.AttributeName.Y,value:"0"},{name:i.AttributeName.Width,value:"105"},{name:i.AttributeName.Height,value:"100"},{name:i.AttributeName.Points,value:"52.5, 80.3 84, 100 76.3, 63 105, 38 67.2, 35 52.5, 0 37.8, 35 0, 38 28.7, 63 20, 100 52.5, 80.3"}],id:r,tag:i.Tags.Polygon}],tag:i.Tags.Defs},a={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+r}],tag:i.Tags.Use},s={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+r},{name:i.AttributeName.Transform,value:"translate(105 0)"}],tag:i.Tags.Use},u={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+r},{name:i.AttributeName.Transform,value:"translate(210 0)"}],tag:i.Tags.Use},l={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+r},{name:i.AttributeName.Transform,value:"translate(315 0)"}],tag:i.Tags.Use},c={attributes:[{name:i.AttributeName.xlinkHref,value:"#"+r},{name:i.AttributeName.Transform,value:"translate(420 0)"}],tag:i.Tags.Use},d={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 525 100"}],children:[o,a,s,u,l,c],classes:[i.Classes.RatingGraphic],tag:i.Tags.Svg},p={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 105 100"}],children:[o,a],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg},g={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 210 100"}],children:[o,a,s],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg},f={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 315 100"}],children:[o,a,s,u],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg},h={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 420 100"}],children:[o,a,s,u,l],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg},m={attributes:[{name:i.AttributeName.ViewBox,value:"0 0 525 100"}],children:[o,a,s,u,l,c],classes:[i.Classes.RatingGraphic,i.Classes.RatingGraphicFilled],tag:i.Tags.Svg};n.generate=function(t){return{children:[d,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"1"}],tag:i.Tags.Input},p,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"2"}],tag:i.Tags.Input},g,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"3"}],tag:i.Tags.Input},f,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"4"}],tag:i.Tags.Input},h,{attributes:[{name:i.AttributeName.Type,value:"radio"},{name:i.AttributeName.Name,value:t},{name:i.AttributeName.Value,value:"5"}],tag:i.Tags.Input},m],classes:[i.Classes.Rating],id:t,tag:i.Tags.Span}}},{"./../Constants":49}],76:[function(t,e,n){"use strict";n.__esModule=!0;var l=t("./../Constants");n.elementFromJson=function t(e,n){if(void 0===e.brs&&(e.brs=!0),!e.brs)return null;var i;if(e.tag||(e.tag=l.Tags.Div),e.tag===l.Tags.Svg&&(n=!0),i=n?document.createElementNS("http://www.w3.org/2000/svg",e.tag):document.createElement(e.tag),e.attributes)for(var r=void 0,o=0;o<e.attributes.length;o++)(r=e.attributes[o]).name===l.AttributeName.xlinkHref?i.setAttributeNS("http://www.w3.org/1999/xlink",l.AttributeName.HRef,r.value):i.setAttribute(r.name,r.value);if(e.id&&(i.id=e.id),e.classes){var a=e.classes.join(" ");n?i.setAttribute(l.AttributeName.Class,a):i.className=a}if(e.innerText&&!n&&(i.textContent=e.innerText),e.innerHTML&&!n&&(i.innerHTML=e.innerHTML),e.children)for(o=0;o<e.children.length;o++){var s=e.children[o];if(s){var u=t(s,n);u&&i.appendChild(u)}}return i}},{"./../Constants":49}],77:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants"),r=t("./Utils"),l=.2,c=34,o=1/8,a=(s.prototype.destroy=function(){r.setElementVisibility(this.spinnerId,!1),this.stop()},s.prototype.start=function(){var e=this;this.stop(),this.interval=setInterval(function(){for(var t=e.circleObjects.length;t--;)u(e.circleObjects[t])},90)},s.prototype.stop=function(){clearInterval(this.interval)},s.prototype.createCirclesAndArrange=function(){for(var t,e=0,n=c*l,i=2*Math.PI/8,r=8,o=.5*(c-n);r--;){var a=p(),s=Math.round(.5*c+o*Math.cos(e)-.5*a.clientWidth)-.5*n,u=Math.round(.5*c+o*Math.sin(e)-.5*a.clientHeight)-.5*n;this.spinner.appendChild(a),a.style.left=s+"px",a.style.top=u+"px",e+=i,t={element:a,j:r},this.circleObjects.push(t)}},s.prototype.initializeOpacities=function(){for(var t,e=0,n=1;e<8;e++){var i=this.circleObjects[e];t=o*n++,d(i.element,t)}},s);function s(t){this.circleObjects=[],this.spinnerId=t,this.spinner=document.getElementById(this.spinnerId),this.createCirclesAndArrange(),this.initializeOpacities(),this.start(),r.setElementVisibility(t,!0)}function u(t){var e,n=(e=t.element,parseFloat(window.getComputedStyle(e).getPropertyValue("opacity"))-o);n<=0&&(n=1),d(t.element,n)}function d(t,e){t.style.opacity=e.toString()}function p(){var t=document.createElement("div");return t.classList.add(i.Classes.SpinnerCircle),t.style.width=t.style.height=c*l+"px",t}n.Spinner=a},{"./../Constants":49,"./Utils":82}],78:[function(t,e,n){"use strict";n.__esModule=!0;var o,a,u=t("./../../Transport/Transport"),l=t("./../../Constants"),c=t("./../Utils"),d=t("./../SpinnerControl"),p=t("./../../Logging/Logging"),g=t("./../../Configuration/Configuration"),f=t("@ms-ofb/officefloodgatecore/dist/src/Api/Api");function h(t){!function(){for(var t=0,e=i;t<e.length;t++){var n=e[t];c.unregisterListener(n.id,n.event,n.listener)}i=[]}(),o(t)}var i=[];function s(t,e,n){c.registerListener(t,e,n),i.push({event:e,id:t,listener:n})}function m(t){var e=document.getElementById(l.IDs.TFormEmailCheckBox);if(e){var n=document.getElementById(l.IDs.TFormEmailTextBox);n.value=e.checked?g.get().getCommonInitOptions().userEmail:null,n.disabled=!e.checked}}function v(t){t.keyCode===l.Keys.Esc&&(t.preventDefault(),t.stopPropagation(),h(!1))}function y(t){t.preventDefault(),t.stopPropagation(),h(!1)}function S(t){t.preventDefault(),t.stopPropagation(),b()}function b(){a=!1,c.setElementVisibility(l.IDs.TPromptContainer,!1),c.setElementVisibility(l.IDs.TFormContainer,!0),document.getElementById(l.IDs.TFormRatingQuestion)&&document.getElementById(l.IDs.TFormRatingQuestion).focus(),p.getLogger().logEvent(p.EventIds.Survey.UI.Form.Shown.VALUE,1,{CampaignId:g.get().getFloodgateSurvey().getCampaignId(),SurveyId:g.get().getFloodgateSurvey().getId(),SurveyType:g.get().getFloodgateSurvey().getSurveyType()})}function C(t){document.getElementById(l.IDs.TFormSubmitButton).disabled=!1}function T(t){t.preventDefault(),t.stopPropagation(),c.setElementVisibility(l.IDs.TFormSubmitButton,!1);var e=new d.Spinner(l.IDs.TFormSubmitButtonSpinner),n=new u.Transporter(g.get().getCommonInitOptions().environment,f.ISurvey.Type[g.get().getFloodgateSurvey().getSurveyType()],g.get().getCommonInitOptions().appId,"Survey",g.get().getCommonInitOptions().applicationGroup,g.get().getCommonInitOptions().telemetryGroup,g.get().getCommonInitOptions().webGroup),i=document.getElementById(l.IDs.TFormComment),r=i&&!!i.value,o=document.querySelector('input[name="'+l.IDs.TFormRating+'"]:checked');g.get().getFloodgateSurvey().setValues(Number(o.value),r?i.value:""),n.setManifestValues(g.get().getFloodgateSurvey().getJsonElements());var a=document.getElementById(l.IDs.TFormEmailCheckBox),s=document.getElementById(l.IDs.TFormEmailTextBox);a&&a.checked&&""!==s.value&&n.setEmail(s.value),n.submit(),e.destroy(),h(!0),p.getLogger().logEvent(p.EventIds.Survey.UI.Form.Submit.VALUE,1,{CampaignId:g.get().getFloodgateSurvey().getCampaignId(),SurveyId:g.get().getFloodgateSurvey().getId(),SurveyType:g.get().getFloodgateSurvey().getSurveyType()})}n.register=function(t){void 0===t&&(t=function(t){}),o=t,a=!0,s(l.IDs.ToastContainer,"keyup",v),s(l.IDs.ToastCancel,"click",y),s(l.IDs.TPromptContainer,"click",S),s(l.IDs.TFormSubmitButton,"click",T),s(l.IDs.TFormEmailCheckBox,"click",m),m(null);for(var e=document.querySelectorAll('input[name="'+l.IDs.TFormRating+'"]'),n=0;n<e.length;++n)c.registerListenerToElement(e[n],"click",C);g.get().getFloodgateSurvey().showPrompt?p.getLogger().logEvent(p.EventIds.Survey.UI.Prompt.Shown.VALUE,1,{CampaignId:g.get().getFloodgateSurvey().getCampaignId(),SurveyId:g.get().getFloodgateSurvey().getId(),SurveyType:g.get().getFloodgateSurvey().getSurveyType()}):b();var i=g.get().getFloodgateInitOptions().autoDismiss;if(i!==l.AutoDismissValues.NoAutoDismiss){var r=void 0;switch(i){case l.AutoDismissValues.SevenSeconds:r=7e3;break;case l.AutoDismissValues.FourteenSeconds:r=14e3;break;case l.AutoDismissValues.TwentyOneSeconds:r=21e3;break;case l.AutoDismissValues.TwentyEightSeconds:r=28e3}void 0!==r&&setTimeout(function(){a&&h(!1)},r)}}},{"./../../Configuration/Configuration":48,"./../../Constants":49,"./../../Logging/Logging":53,"./../../Transport/Transport":63,"./../SpinnerControl":77,"./../Utils":82,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":4}],79:[function(t,e,n){"use strict";n.__esModule=!0;var a=t("./../ChoiceGroupControl"),s=t("./../../Configuration/Configuration"),u=t("./../../Constants"),i=t("./../../UIStrings/UIStrings"),r=t("./../Utils"),o=t("./../../Constants");n.generate=function(){return{attributes:[{name:u.AttributeName.DataHtml2CanvasIgnore,value:u.AttributeValue.True},{name:u.AttributeName.Role,value:"alert"},{name:"aria-labelledby",value:u.IDs.TPromptTitle},{name:"aria-describedby",value:u.IDs.TPromptText}],children:[{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Button},{name:u.AttributeName.AriaLabel,value:i.getUIStrings().CloseLabel}],id:u.IDs.ToastCancel,innerHTML:'<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z" fill="#000"/></svg>',tag:u.Tags.Button},{attributes:[{name:"aria-labelledby",value:u.IDs.TPromptTitle}],children:[{classes:[u.Classes.FontText,u.Classes.TextAlignLeft],id:u.IDs.TPromptTitle,innerText:s.get().getFloodgateSurvey().getTitle()},{classes:[u.Classes.FontSubText,u.Classes.TextAlignLeft],id:u.IDs.TPromptText,innerText:s.get().getFloodgateSurvey().getPromptQuestion()}],id:u.IDs.TPromptContainer,tag:u.Tags.Button},{children:[{classes:[u.Classes.FontText,u.Classes.TextAlignLeft],id:u.IDs.TFormTitle,innerText:s.get().getFloodgateSurvey().getTitle()},function(){for(var t=[],e=s.get().getFloodgateSurvey().getRatingValuesAscending(),n=0,i=0,r=e;i<r.length;i++){var o=r[i];t.push([n,o]),n++}return a.generateRadioGroup(u.IDs.TFormRating,s.get().getFloodgateSurvey().getRatingQuestion(),t.reverse())}(),{attributes:[{name:u.AttributeName.Placeholder,value:s.get().getFloodgateSurvey().getCommentQuestion()},{name:u.AttributeName.AriaLabel,value:s.get().getFloodgateSurvey().getCommentQuestion()},{name:u.AttributeName.MaxLength,value:u.AttributeValue.TextAreaMaxLength}],classes:[u.Classes.FontSubText,u.Classes.TextInput],id:u.IDs.TFormComment,tag:u.Tags.TextArea},{brs:s.get().getFloodgateSurvey().showEmailRequest,children:[{attributes:[{name:o.AttributeName.Type,value:o.AttributeValue.Checkbox},{name:s.get().getCommonInitOptions().userEmailConsentDefault?o.AttributeValue.Checked:o.AttributeValue.Unchecked,value:""}],classes:[o.Classes.TFormEmailCheckbox,o.Classes.CheckBox],id:o.IDs.TFormEmailCheckBox,tag:o.Tags.Input},{attributes:[{name:o.AttributeName.For,value:o.IDs.TFormEmailCheckBox}],classes:[o.Classes.FontSubText,o.Classes.TextAlignLeft,o.Classes.TFormEmailLabel],innerText:i.getUIStrings().Form.EmailCheckBoxLabel,tag:o.Tags.Label},{attributes:[{name:o.AttributeName.Type,value:o.AttributeValue.Text},{name:o.AttributeName.Placeholder,value:i.getUIStrings().Form.EmailPlaceholder},{name:o.AttributeName.AriaLabel,value:i.getUIStrings().Form.EmailPlaceholder},{name:o.AttributeName.Name,value:o.IDs.BasicFormEmailInput},{name:o.AttributeName.MaxLength,value:o.AttributeValue.TextAreaMaxLength},{name:o.AttributeName.Value,value:s.get().getCommonInitOptions().userEmailConsentDefault?s.get().getCommonInitOptions().userEmail:""}],classes:[o.Classes.FontSubText,o.Classes.FormEmailInput,o.Classes.TextInput],id:o.IDs.TFormEmailTextBox,tag:o.Tags.Input}]},{children:[{attributes:[{name:o.AttributeName.HRef,value:o.Urls.PrivacyStatementLink},{name:o.AttributeName.Target,value:o.AttributeValue.BlankWindow},{name:o.AttributeName.Rel,value:o.AttributeValue.NoReferrer}],classes:[o.Classes.Link],id:o.IDs.PrivacyStatementLink,innerText:i.getUIStrings().PrivacyStatement,tag:o.Tags.Anchor}],classes:[o.Classes.FontSubSubText,o.Classes.TextAlignLeft,o.Classes.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:u.AttributeName.HRef,value:u.Urls.PrivacyStatementLink},{name:u.AttributeName.Target,value:u.AttributeValue.BlankWindow},{name:u.AttributeName.Rel,value:u.AttributeValue.NoReferrer}],classes:[u.Classes.Link],innerText:i.getUIStrings().PrivacyStatement,tag:u.Tags.Anchor}],classes:[u.Classes.FontSubSubText,u.Classes.TextAlignLeft,u.Classes.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:u.AttributeName.Disabled,value:u.AttributeValue.True}],classes:[u.Classes.FontSubText,u.Classes.SubmitButton],id:u.IDs.TFormSubmitButton,innerText:i.getUIStrings().Form.Submit,tag:u.Tags.Button},{classes:[u.Classes.Spinner,u.Classes.Hidden],id:u.IDs.TFormSubmitButtonSpinner,tag:u.Tags.Div}],id:u.IDs.TFormSubmitButtonContainer}],classes:[u.Classes.Hidden],id:u.IDs.TFormContainer}],classes:[u.Classes.Toast,r.isRightToLeft()?u.Classes.Rtl:""],id:u.IDs.ToastContainer}}},{"./../../Configuration/Configuration":48,"./../../Constants":49,"./../../UIStrings/UIStrings":64,"./../ChoiceGroupControl":74,"./../Utils":82}],80:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../../Constants"),r=t("./Events"),o=t("./Layout"),a=t("./../Renderer"),s=t("./../Utils"),u=t("./../../Configuration/Configuration");n.createSurvey=function(e){var t;t=a.elementFromJson(o.generate()),document.body.insertBefore(t,document.body.firstChild),s.setElementVisibility(i.IDs.ToastContainer,!0),r.register(function(t){s.setElementVisibility(i.IDs.ToastContainer,!1),s.deleteElementById(i.IDs.ToastContainer),u.get().getFloodgateInitOptions().onDismiss(u.get().getFloodgateSurvey().getCampaignId(),t),e()})}},{"./../../Configuration/Configuration":48,"./../../Constants":49,"./../Renderer":76,"./../Utils":82,"./Events":78,"./Layout":79}],81:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./BellyBand/BellyBand");n.createBellyBandMulti=i.createMulti;var r=t("./BellyBand/BellyBand");n.createBellyBandSingle=r.createSingle;var o=t("./Toast/Toast");n.createSurvey=o.createSurvey},{"./BellyBand/BellyBand":65,"./Toast/Toast":80}],82:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("./../Constants");function r(t,e){var n=document.getElementById(t);n&&(n.className.match(new RegExp("\\b"+e+"\\b"))||(n.className=n.className+" "+e))}function o(t,e){var n=document.getElementById(t);n&&(n.className=n.className.split(new RegExp("\\b"+e+"\\b","i")).join(" "),n.className=n.className.split(/\s+/).join(" "))}function a(t,e,n){o(t,e),r(t,n)}function s(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function u(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent("on"+e,n)}n.setElementVisibility=function(t,e){a(t,e?i.Classes.Hidden:i.Classes.Visible,e?i.Classes.Visible:i.Classes.Hidden)},n.deleteElementById=function(t){var e=document.getElementById(t);null!=e&&null!=e.parentNode&&e.parentNode.removeChild(e)},n.addClassById=r,n.deleteClassById=o,n.replaceClassesById=a,n.setAttributeOnHtmlElement=function(t,e,n){var i=document.getElementById(t);i&&i.setAttribute(e,n)},n.addEventListenerHelper=s,n.removeEventListenerHelper=u,n.registerListener=function(t,e,n){var i=document.getElementById(t);i&&s(i,e,n)},n.registerListenerToElement=function(t,e,n){t&&s(t,e,n)},n.unregisterListener=function(t,e,n){var i=document.getElementById(t);i&&u(i,e,n)},n.getInternetExplorerVersion=function(){var t=-1,e=window.navigator.userAgent;return-1<e.indexOf("Trident")&&null!=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1),t+=4),t},n.isRightToLeft=function(){return"rtl"===getComputedStyle(document.documentElement).direction}},{"./../Constants":49}],83:[function(t,e,n){"use strict";function i(t){return"string"==typeof t}function r(t){return"boolean"==typeof t}function o(t){return null==t}function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.__esModule=!0,n.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},n.isBoolean=r,n.isNullorUndefined=o,n.expectObject=function(t,e){if(o(n=t)||"object"!=typeof n)throw e+" is not an object: "+t;var n},n.expectNumber=function(t,e){if("number"!=typeof t)throw e+" is not a number: "+t},n.expectString=function(t,e){if(!i(t))throw e+" is not a string: "+t},n.expectBoolean=function(t,e){if(!r(t))throw e+" is not a boolean: "+t},n.expectGuid=function(t,e){if(!i(n=t)||!/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(n))throw e+" is not a guid: "+t;var n},n.expectArray=function(t,e){if(!Array.isArray(t))throw e+" is not an array: "+t},n.guid=function(){return(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase()},n.overrideValues=function(t,e){if(!e)return e;var n=e;if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}},{}],84:[function(t,e,n){"use strict";n.__esModule=!0,n.default="1.4.7"},{}],85:[function(t,e,n){"use strict";n.__esModule=!0,n.isNarrow=function(){return!window.innerWidth||window.innerWidth<800}},{}],86:[function(t,e,n){"use strict";n.__esModule=!0;var i=t("es6-promise");n.loadStylesheet=function(t){var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)},n.loadScript=function(r,o){return void 0===o&&(o=window.origin),new i.Promise(function(t,e){var n=document.createElement("script");n.async=!0,n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){t()},n.onerror=function(){e()},n.src=r,o&&"null"!==o&&(n.crossOrigin="anonymous");var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)})}},{"es6-promise":44}],87:[function(t,e,n){"use strict";n.__esModule=!0,n.get=function(){return window},n.setSetUiStrings=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.setUiStrings=t},n.setSingleFeedback=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.singleFeedback=t},n.setMultiFeedback=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.multiFeedback=t},n.setFloodgateShowSurvey=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.showSurvey=t},n.setFloodgateShowCustomSurvey=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.showCustomSurvey=t},n.setFloodgateInitialize=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.initialize=t},n.setFloodgateStart=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.start=t},n.setFloodgateStop=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.stop=t},n.setFloodgateGetEngine=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.getEngine=t},n.getSettingIdMap=function(t){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.getSettingIdMap=t}},{}],88:[function(t,r,o){!function(t,e){if("object"==typeof o&&"object"==typeof r)r.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var i in n)("object"==typeof o?o:t)[i]=n[i]}}(this,function(){return r={},i.m=n=[function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(r.prototype.Equals=function(t){var e=new r(t);return this.low===e.low&&this.high===e.high},r);function r(t){this.low=0,this.high=0,this.low=parseInt(t,10),this.low<0&&(this.high=-1)}e.Int64=i;var o=(a.prototype.Equals=function(t){var e=new a(t);return this.low===e.low&&this.high===e.high},a);function a(t){this.low=0,this.high=0,this.low=parseInt(t,10)}e.UInt64=o;var s=(u.ToByte=function(t){return this.ToUInt8(t)},u.ToInt16=function(t){return 32767&t|(32768&t)<<16>>16},u.ToInt32=function(t){return 2147483647&t|2147483648&t},u.ToUInt8=function(t){return 255&t},u.ToUInt32=function(t){return 4294967295&t},u);function u(){}e.Number=s},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),(i=e.AWTPiiKind||(e.AWTPiiKind={}))[i.NotSet=0]="NotSet",i[i.DistinguishedName=1]="DistinguishedName",i[i.GenericData=2]="GenericData",i[i.IPV4Address=3]="IPV4Address",i[i.IPv6Address=4]="IPv6Address",i[i.MailSubject=5]="MailSubject",i[i.PhoneNumber=6]="PhoneNumber",i[i.QueryString=7]="QueryString",i[i.SipAddress=8]="SipAddress",i[i.SmtpAddress=9]="SmtpAddress",i[i.Identity=10]="Identity",i[i.Uri=11]="Uri",i[i.Fqdn=12]="Fqdn",i[i.IPV4AddressLegacy=13]="IPV4AddressLegacy"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),a=n(1),s=n(3),i=(r.getPayloadBlob=function(i,t){var e=new o.IO.MemoryStream,r=new o.CompactBinaryProtocolWriter(e);return r.WriteFieldBegin(o.BondDataType.BT_MAP,3),r.WriteMapContainerBegin(t,o.BondDataType.BT_STRING,o.BondDataType.BT_LIST),Object.keys(i).forEach(function(t){r.WriteString(t);var e=i[t];r.WriteContainerBegin(1,o.BondDataType.BT_STRUCT),r.WriteFieldBegin(o.BondDataType.BT_STRING,2),r.WriteString("act_default_source"),r.WriteFieldBegin(o.BondDataType.BT_STRING,5),r.WriteString(s.newGuid()),r.WriteFieldBegin(o.BondDataType.BT_INT64,6),r.WriteInt64(s.numberToBondInt64(Date.now())),r.WriteFieldBegin(o.BondDataType.BT_LIST,8),r.WriteContainerBegin(e.length,o.BondDataType.BT_STRUCT);for(var n=0;n<e.length;++n)r.WriteBlob(e[n]);r.WriteStructEnd(!1)}),r.WriteStructEnd(!1),e.GetBuffer()},r.getEventBlob=function(e){var t=new o.IO.MemoryStream,n=new o.CompactBinaryProtocolWriter(t);n.WriteFieldBegin(o.BondDataType.BT_STRING,1),n.WriteString(e.id),n.WriteFieldBegin(o.BondDataType.BT_INT64,3),n.WriteInt64(s.numberToBondInt64(e.timestamp)),n.WriteFieldBegin(o.BondDataType.BT_STRING,5),n.WriteString(e.type),n.WriteFieldBegin(o.BondDataType.BT_STRING,6),n.WriteString(e.name);var i=[],r=[];return Object.keys(e.properties).forEach(function(t){e.properties[t].pii===a.AWTPiiKind.NotSet?i.push(t):r.push(t)}),i.length&&(n.WriteFieldBegin(o.BondDataType.BT_MAP,13),n.WriteMapContainerBegin(i.length,o.BondDataType.BT_STRING,o.BondDataType.BT_STRING),i.forEach(function(t){n.WriteString(t),n.WriteString(e.properties[t].value)})),r.length&&(n.WriteFieldBegin(o.BondDataType.BT_MAP,30),n.WriteMapContainerBegin(r.length,o.BondDataType.BT_STRING,o.BondDataType.BT_STRUCT),r.forEach(function(t){n.WriteString(t),n.WriteFieldBegin(o.BondDataType.BT_INT32,1),n.WriteInt32(1),n.WriteFieldBegin(o.BondDataType.BT_INT32,2),n.WriteInt32(e.properties[t].pii),n.WriteFieldBegin(o.BondDataType.BT_STRING,3),n.WriteString(e.properties[t].value),n.WriteStructEnd(!1)})),n.WriteStructEnd(!1),t.GetBuffer()},r.base64Encode=function(t){return o.Encoding.Base64.GetString(t)},r);function r(){}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=/[xy]/g;e.numberToBondInt64=function(t){var e=new i.Int64("0");return e.low=4294967295&t,e.high=Math.floor(t/4294967296),e},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(r,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},e.isPii=function(t){return!isNaN(t)&&null!==t&&0<=t&&t<=13}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Version="1.2.2",e.FullVersionString="AWT-Web-CJS-"+e.Version},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1);e.AWTPiiKind=i.AWTPiiKind;var r=n(13);e.AWT=r.default,e.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",e.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(t,e,n){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),(i=e.BondDataType||(e.BondDataType={}))[i.BT_STOP=0]="BT_STOP",i[i.BT_STOP_BASE=1]="BT_STOP_BASE",i[i.BT_UINT8=3]="BT_UINT8",i[i.BT_UINT32=5]="BT_UINT32",i[i.BT_UINT64=6]="BT_UINT64",i[i.BT_STRING=9]="BT_STRING",i[i.BT_STRUCT=10]="BT_STRUCT",i[i.BT_LIST=11]="BT_LIST",i[i.BT_MAP=13]="BT_MAP",i[i.BT_INT32=16]="BT_INT32",i[i.BT_INT64=17]="BT_INT64",i[i.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),i=(r.GetBytes=function(t){for(var e=[],n=0;n<t.length;++n){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||57344<=i?e.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++n)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e},r);function r(){}e.Utf8=i;var o=(s.GetString=function(t){for(var e,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[],r=t.length%3,o=0,a=t.length-r;o<a;o+=3){var s=(t[o]<<16)+(t[o+1]<<8)+t[o+2];i.push([n.charAt((e=s)>>18&63),n.charAt(e>>12&63),n.charAt(e>>6&63),n.charAt(63&e)].join(""))}switch(r){case 1:s=t[t.length-1],i.push(n.charAt(s>>2)),i.push(n.charAt(s<<4&63)),i.push("==");break;case 2:var u=(t[t.length-2]<<8)+t[t.length-1];i.push(n.charAt(u>>10)),i.push(n.charAt(u>>4&63)),i.push(n.charAt(u<<2&63)),i.push("=")}return i.join("")},s);function s(){}e.Base64=o;var u=(l.GetBytes=function(t){for(var e=[];4294967168&t;)e.push(127&t|128),t>>>=7;return e.push(127&t),e},l);function l(){}e.Varint=u;var c=(d.GetBytes=function(t){for(var e=t.low,n=t.high,i=[];n||4294967168&e;)i.push(127&e|128),e=(127&n)<<25|e>>>7,n>>>=7;return i.push(127&e),i},d);function d(){}e.Varint64=c;var p=(g.EncodeZigzag32=function(t){return(t=a.Number.ToInt32(t))<<1^t>>31},g.EncodeZigzag64=function(t){var e=t.low,n=t.high,i=n<<1|e>>>31,r=e<<1;2147483648&n&&(i=~i,r=~r);var o=new a.UInt64("0");return o.low=r,o.high=i,o},g);function g(){}e.Zigzag=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=(o.prototype.WriteByte=function(t){this._buffer.push(i.Number.ToByte(t))},o.prototype.Write=function(t,e,n){for(;n--;)this.WriteByte(t[e++])},o.prototype.GetBuffer=function(){return this._buffer},o);function o(){this._buffer=[]}e.MemoryStream=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6);e.BondDataType=i.BondDataType;var r=n(7);e.Encoding=r;var o=n(8);e.IO=o;var a=n(0);e.Int64=a.Int64,e.UInt64=a.UInt64,e.Number=a.Number;var s=(u.prototype.WriteBlob=function(t){this._stream.Write(t,0,t.length)},u.prototype.WriteContainerBegin=function(t,e){this.WriteUInt8(e),this.WriteUInt32(t)},u.prototype.WriteMapContainerBegin=function(t,e,n){this.WriteUInt8(e),this.WriteUInt8(n),this.WriteUInt32(t)},u.prototype.WriteFieldBegin=function(t,e){e<=5?this._stream.WriteByte(t|e<<5):e<=255?(this._stream.WriteByte(192|t),this._stream.WriteByte(e)):(this._stream.WriteByte(224|t),this._stream.WriteByte(e),this._stream.WriteByte(e>>8))},u.prototype.WriteInt32=function(t){t=r.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},u.prototype.WriteInt64=function(t){this.WriteUInt64(r.Zigzag.EncodeZigzag64(t))},u.prototype.WriteString=function(t){if(""===t)this.WriteUInt32(0);else{var e=r.Utf8.GetBytes(t);this.WriteUInt32(e.length),this._stream.Write(e,0,e.length)}},u.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?i.BondDataType.BT_STOP_BASE:i.BondDataType.BT_STOP)},u.prototype.WriteUInt32=function(t){var e=r.Varint.GetBytes(a.Number.ToUInt32(t));this._stream.Write(e,0,e.length)},u.prototype.WriteUInt64=function(t){var e=r.Varint64.GetBytes(t);this._stream.Write(e,0,e.length)},u.prototype.WriteUInt8=function(t){this._stream.WriteByte(a.Number.ToUInt8(t))},u);function u(t){this._stream=t}e.CompactBinaryProtocolWriter=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(r.prototype.setKillSwitchTenants=function(t,e){var n=this;if(t&&e)try{var i=t.split(",");if("this-request-only"===e)return i;var r=1e3*parseInt(e,10);i.forEach(function(t){n._killedTokenDictionary[t]=Date.now()+r})}catch(t){return[]}return[]},r.prototype.isTenantKilled=function(t){return void 0!==this._killedTokenDictionary[t]&&this._killedTokenDictionary[t]>Date.now()||(delete this._killedTokenDictionary[t],!1)},r);function r(){this._killedTokenDictionary={}}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=(o.prototype.addEventToBatch=function(t){var e=i.default.getEventBlob(t);e.length>this._maxRequestSize||(this._currentBatchSize+e.length>this._maxRequestSize?this.flushBatch():(void 0===this._currentBatch[t.tenantToken]&&(this._currentBatch[t.tenantToken]=[]),this._currentBatch[t.tenantToken].push(e),this._currentBatchSize+=e.length))},o.prototype.flushBatch=function(){0<this._currentBatchSize&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentBatchSize=0)},o);function o(t,e){this._maxRequestSize=t,this._outboundQueue=e,this._currentBatch={},this._currentBatchSize=0}e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(r.shouldRetryForStatus=function(t){return!(300<=t&&t<500&&408!==t||501===t||505===t)},r.getMillisToBackoffForRetry=function(t){var e,n=Math.floor(1200*Math.random())+2400;return e=Math.pow(4,t)*n,Math.min(e,12e4)},r);function r(){}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(14),o=n(3),a=n(4),s="allTkns",u=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,l=/\./g,c=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,d=(p.initialize=function(t,e){if(void 0===e&&(e={}),this._isInitialized)throw"Already Initialized";this._defaultTenantToken=t,this._overrideValuesFromConfig(e),r.default.initialize(this._config),this._isInitialized=!0},p.flush=function(t){this._isInitialized&&!this._isDestroyed&&r.default.flush(t)},p.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._isDestroyed=!0,r.default.flushAndTeardown())},p.setContext=function(t,e,n){void 0===n&&(n=s),null!==(e=this._sanitizeProperty(t,e))&&(this._contextProperties[n]||(this._contextProperties[n]={}),this._contextProperties[n][t]=e)},p.logEvent=function(e){var n=this;if(this._isInitialized){if(!e.name||!e.properties)return;e.name=e.name.toLowerCase(),e.name.replace(l,"_");var t="";if(e.type?(e.type.toLowerCase(),t="custom."):e.type="custom",!u.test(e.name)||!u.test(e.type))return;if(e.type=t+e.type,isNaN(e.timestamp)&&(e.timestamp=(new Date).getTime()),e.tenantToken||(e.tenantToken=this._defaultTenantToken),e.id=o.newGuid(),Object.keys(e.properties).forEach(function(t){e.properties[t]=n._sanitizeProperty(t,e.properties[t]),null===e.properties[t]&&delete e.properties[t]}),this._addContextIfAbsent(e,e.tenantToken),this._addContextIfAbsent(e,s),0===Object.keys(e.properties).length)return;this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.tenantToken)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.tenantToken)),this._setDefaultProperty(e,"EventInfo.SdkVersion",a.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),r.default.sendEvent(e)}},p._overrideValuesFromConfig=function(t){t.collectorUrl&&(this._config.collectorUrl=t.collectorUrl),1e3<t.sendingTimer&&(this._config.sendingTimer=t.sendingTimer)},p._getInitId=function(t){return void 0===this._initIdMap[t]&&(this._initIdMap[t]=o.newGuid()),this._initIdMap[t]},p._getSequenceId=function(t){return void 0===this._sequenceIdMap[t]&&(this._sequenceIdMap[t]=0),(++this._sequenceIdMap[t]).toString()},p._setDefaultProperty=function(t,e,n){t.properties[e]={value:n,pii:i.AWTPiiKind.NotSet}},p._addContextIfAbsent=function(e,t){if(this._contextProperties[t]){var n=this._contextProperties[t];Object.keys(n).forEach(function(t){e.properties[t]||(e.properties[t]=n[t])})}},p._sanitizeProperty=function(t,e){return"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e||(e={value:e}),c.test(t)&&null!=e&&null!==e.value&&void 0!==e.value&&""!==e.value?(void 0===e.pii&&(e.pii=i.AWTPiiKind.NotSet),e.value=e.value.toString(),o.isPii(e.pii)?e:null):null},p._isInitialized=!1,p._isDestroyed=!1,p._contextProperties={},p._sequenceIdMap={},p._initIdMap={},p._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3},p);function p(){}e.default=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),u=n(2),s=n(12),r=n(10),o=n(4),a=(l.initialize=function(t){this._inboundQueues.push([]),this._recordBatcher=new i.default(2936012,this._outboundQueue),this._newEventsAllowed=!0,"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64"),this._sendingTimer=t.sendingTimer,this._urlString=t.collectorUrl+this._urlString+"&x-apikey="},l.sendEvent=function(t){var e=this;this._newEventsAllowed&&(this._inboundQueues[this._inboundQueues.length-1].push(t),!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout(function(){return e._batchAndSendEvents(!1)},this._sendingTimer)))},l.flushAndTeardown=function(){this._newEventsAllowed=!1,this._batchAndSendEvents(!0)},l.flush=function(t){this._inboundQueues.push([]),this._isCurrentlyFlushing?this._flushQueue.push(t):(this._isCurrentlyFlushing=!0,this._flush(t))},l._batchAndSendEvents=function(t){for(this._running=!0;0<this._inboundQueues[0].length&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch(),this._sendRequest(this._outboundQueue.pop(),0,t)},l._retryRequestIfNeeded=function(t,e,n,i,r){var o=this,a=!0;t&&void 0!==t.status&&(this._killSwitch.setKillSwitchTenants(t.getResponseHeader("kill-tokens"),t.getResponseHeader("kill-duration-seconds")).forEach(function(t){delete e[t],n--}),(!s.default.shouldRetryForStatus(t.status)||n<=0)&&(a=!1)),a&&r<4?setTimeout(function(){return o._sendRequest(e,r+1,!1)},s.default.getMillisToBackoffForRetry(r)):this._handleRequestFinished(null)},l._sendRequest=function(e,t,n){var i=this;try{var r=new XMLHttpRequest,o=0,a="";if(Object.keys(e).forEach(function(t){i._killSwitch.isTenantKilled(t)?delete e[t]:(0<a.length&&(a+=","),a+=t,o++)}),r.open("POST",this._urlString+a,!n),n||(r.ontimeout=function(){i._retryRequestIfNeeded(r,e,o,a,t)},r.onerror=function(){i._retryRequestIfNeeded(r,e,o,a,t)},r.onload=function(){i._handleRequestFinished(r)}),0<o){var s=u.default.getPayloadBlob(e,o);"undefined"==typeof Uint8Array?r.send(u.default.base64Encode(s)):r.send(new Uint8Array(s))}else n&&this._handleRequestFinished(null)}catch(t){this._handleRequestFinished(null)}},l._handleRequestFinished=function(t){var e=this;t&&this._killSwitch.setKillSwitchTenants(t.getResponseHeader("kill-tokens"),t.getResponseHeader("kill-duration-seconds")),0<this._inboundQueues[0].length?this._timeout=setTimeout(function(){return e._batchAndSendEvents(!1)},this._sendingTimer):(this._timeout=-1,this._running=!1)},l._flush=function(t){var e=this;this._running||(-1<this._timeout&&(clearTimeout(this._timeout),this._timeout=-1),0<this._inboundQueues[0].length&&this._batchAndSendEvents(!1)),this._checkPrimaryInboundQueueEmpty(function(){e._inboundQueues.shift(),null!=t&&t(),0<e._flushQueue.length?setTimeout(function(){return e._flush(e._flushQueue.shift())},e._sendingTimer):(e._isCurrentlyFlushing=!1,0<e._inboundQueues[0].length&&(e._timeout=setTimeout(function(){return e._batchAndSendEvents(!1)},e._sendingTimer)))})},l._checkPrimaryInboundQueueEmpty=function(t){var e=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(t):setTimeout(function(){return e._checkPrimaryInboundQueueEmpty(t)},250)},l._checkOutboundQueueEmptyAndSent=function(t){var e=this;this._running?setTimeout(function(){return e._checkOutboundQueueEmptyAndSent(t)},250):t()},l._outboundQueue=[],l._inboundQueues=[],l._newEventsAllowed=!1,l._killSwitch=new r.default,l._isCurrentlyFlushing=!1,l._flushQueue=[],l._running=!1,l._timeout=-1,l._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+o.FullVersionString,l);function l(){}e.default=a},function(t,e,n){t.exports=n(5)}],i.c=r,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=15);function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var n,r})},{}],89:[function(d,t,e){(function(n){var tt=d("es6-promise").Promise;window.OfficeBrowserFeedback.html2canvas=function(){var U,t,e;return function o(a,s,u){function l(n,t){if(!s[n]){if(!a[n]){var e=typeof d=="function"&&d;if(!t&&e)return e(n,!0);if(c)return c(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=s[n]={exports:{}};a[n][0].call(r.exports,function(t){var e=a[n][1][t];return l(e?e:t)},r,r.exports,o,a,s,u)}return s[n].exports}var c=typeof d=="function"&&d;for(var t=0;t<u.length;t++)l(u[t]);return l}({1:[function(t,L,P){(function(k){(function(t){var e=typeof P=="object"&&P;var n=typeof L=="object"&&L&&L.exports==e&&L;var i=typeof k=="object"&&k;if(i.global===i||i.window===i){t=i}var r,v=2147483647,y=36,S=1,b=26,o=38,a=700,C=72,T=128,w="-",s=/^xn--/,u=/[^ -~]/,l=/\x2E|\u3002|\uFF0E|\uFF61/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=y-S,A=Math.floor,I=String.fromCharCode,p;function E(t){throw RangeError(c[t])}function g(t,e){var n=t.length;while(n--){t[n]=e(t[n])}return t}function f(t,e){return g(t.split(l),e).join(".")}function F(t){var e=[],n=0,i=t.length,r,o;while(n<i){r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){o=t.charCodeAt(n++);if((o&64512)==56320){e.push(((r&1023)<<10)+(o&1023)+65536)}else{e.push(r);n--}}else{e.push(r)}}return e}function m(t){return g(t,function(t){var e="";if(t>65535){t-=65536;e+=I(t>>>10&1023|55296);t=56320|t&1023}e+=I(t);return e}).join("")}function O(t){if(t-48<10){return t-22}if(t-65<26){return t-65}if(t-97<26){return t-97}return y}function _(t,e){return t+22+75*(t<26)-((e!=0)<<5)}function D(t,e,n){var i=0;t=n?A(t/a):t>>1;t+=A(t/e);for(;t>d*b>>1;i+=y){t=A(t/d)}return A(i+(d+1)*t/(t+o))}function h(t){var e=[],n=t.length,i,r=0,o=T,a=C,s,u,l,c,d,p,g,f,h;s=t.lastIndexOf(w);if(s<0){s=0}for(u=0;u<s;++u){if(t.charCodeAt(u)>=128){E("not-basic")}e.push(t.charCodeAt(u))}for(l=s>0?s+1:0;l<n;){for(c=r,d=1,p=y;;p+=y){if(l>=n){E("invalid-input")}g=O(t.charCodeAt(l++));if(g>=y||g>A((v-r)/d)){E("overflow")}r+=g*d;f=p<=a?S:p>=a+b?b:p-a;if(g<f){break}h=y-f;if(d>A(v/h)){E("overflow")}d*=h}i=e.length+1;a=D(r-c,i,c==0);if(A(r/i)>v-o){E("overflow")}o+=A(r/i);r%=i;e.splice(r++,0,o)}return m(e)}function N(t){var e,n,i,r,o,a,s,u,l,c,d,p=[],g,f,h,m;t=F(t);g=t.length;e=T;n=0;o=C;for(a=0;a<g;++a){d=t[a];if(d<128){p.push(I(d))}}i=r=p.length;if(r){p.push(w)}while(i<g){for(s=v,a=0;a<g;++a){d=t[a];if(d>=e&&d<s){s=d}}f=i+1;if(s-e>A((v-n)/f)){E("overflow")}n+=(s-e)*f;e=s;for(a=0;a<g;++a){d=t[a];if(d<e&&++n>v){E("overflow")}if(d==e){for(u=n,l=y;;l+=y){c=l<=o?S:l>=o+b?b:l-o;if(u<c){break}m=u-c;h=y-c;p.push(I(_(c+m%h,0)));u=A(m/h)}p.push(I(_(u,0)));o=D(n,f,i==r);n=0;++i}}++n;++e}return p.join("")}function x(t){return f(t,function(t){return s.test(t)?h(t.slice(4).toLowerCase()):t})}function B(t){return f(t,function(t){return u.test(t)?"xn--"+N(t):t})}r={version:"1.2.4",ucs2:{decode:F,encode:m},decode:h,encode:N,toASCII:B,toUnicode:x};if(typeof U=="function"&&typeof U.amd=="object"&&U.amd){U("punycode",function(){return r})}else if(e&&!e.nodeType){if(n){n.exports=r}else{for(p in r){r.hasOwnProperty(p)&&(e[p]=r[p])}}}else{t.punycode=r}})(this)}).call(this,typeof n!=="undefined"?n:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],2:[function(t,e,n){var i=t("./log");function l(t,e,n){if(t.defaultView&&(e!==t.defaultView.pageXOffset||n!==t.defaultView.pageYOffset)){t.defaultView.scrollTo(e,n)}}function r(e,t){try{if(t){t.width=e.width;t.height=e.height;t.getContext("2d").putImageData(e.getContext("2d").getImageData(0,0,e.width,e.height),0,0)}}catch(t){i("Unable to copy canvas content from",e,t)}}function c(t,e){var n=t.nodeType===3?document.createTextNode(t.nodeValue):t.cloneNode(false);var i=t.firstChild;while(i){if(e===true||i.nodeType!==1||i.nodeName!=="SCRIPT"){n.appendChild(c(i,e))}i=i.nextSibling}if(t.nodeType===1){n._scrollTop=t.scrollTop;n._scrollLeft=t.scrollLeft;if(t.nodeName==="CANVAS"){r(t,n)}else if(t.nodeName==="TEXTAREA"||t.nodeName==="SELECT"){n.value=t.value}}return n}function d(t){if(t.nodeType===1){t.scrollTop=t._scrollTop;t.scrollLeft=t._scrollLeft;var e=t.firstChild;while(e){d(e);e=e.nextSibling}}}e.exports=function(t,e,n,i,r,o,a){var s=c(t.documentElement,r.javascriptEnabled);var u=e.createElement("iframe");u.className="html2canvas-container";u.style.visibility="hidden";u.style.position="fixed";u.style.left="-10000px";u.style.top="0px";u.style.border="0";u.width=n;u.height=i;u.scrolling="no";e.body.appendChild(u);return new tt(function(e){var n=u.contentWindow.document;u.contentWindow.onload=u.onload=function(){var t=setInterval(function(){if(n.body.childNodes.length>0){d(n.documentElement);clearInterval(t);if(r.type==="view"){u.contentWindow.scrollTo(o,a);if(/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(u.contentWindow.scrollY!==a||u.contentWindow.scrollX!==o)){n.documentElement.style.top=-a+"px";n.documentElement.style.left=-o+"px";n.documentElement.style.position="absolute"}}e(u)}},50)};n.open();n.write("<!DOCTYPE html><html></html>");l(t,o,a);n.replaceChild(n.adoptNode(s),n.documentElement);n.close()})}},{"./log":13}],3:[function(t,e,n){function i(t){this.r=0;this.g=0;this.b=0;this.a=null;var e=this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}i.prototype.darken=function(t){var e=1-t;return new i([Math.round(this.r*e),Math.round(this.g*e),Math.round(this.b*e),this.a])};i.prototype.isTransparent=function(){return this.a===0};i.prototype.isBlack=function(){return this.r===0&&this.g===0&&this.b===0};i.prototype.fromArray=function(t){if(Array.isArray(t)){this.r=Math.min(t[0],255);this.g=Math.min(t[1],255);this.b=Math.min(t[2],255);if(t.length>3){this.a=t[3]}}return Array.isArray(t)};var r=/^#([a-f0-9]{3})$/i;i.prototype.hex3=function(t){var e=null;if((e=t.match(r))!==null){this.r=parseInt(e[1][0]+e[1][0],16);this.g=parseInt(e[1][1]+e[1][1],16);this.b=parseInt(e[1][2]+e[1][2],16)}return e!==null};var o=/^#([a-f0-9]{6})$/i;i.prototype.hex6=function(t){var e=null;if((e=t.match(o))!==null){this.r=parseInt(e[1].substring(0,2),16);this.g=parseInt(e[1].substring(2,4),16);this.b=parseInt(e[1].substring(4,6),16)}return e!==null};var a=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;i.prototype.rgb=function(t){var e=null;if((e=t.match(a))!==null){this.r=Number(e[1]);this.g=Number(e[2]);this.b=Number(e[3])}return e!==null};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;i.prototype.rgba=function(t){var e=null;if((e=t.match(s))!==null){this.r=Number(e[1]);this.g=Number(e[2]);this.b=Number(e[3]);this.a=Number(e[4])}return e!==null};i.prototype.toString=function(){return this.a!==null&&this.a!==1?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"};i.prototype.namedColor=function(t){t=t.toLowerCase();var e=u[t];if(e){this.r=e[0];this.g=e[1];this.b=e[2]}else if(t==="transparent"){this.r=this.g=this.b=this.a=0;return true}return!!e};i.prototype.isColor=true;var u={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};e.exports=i},{}],4:[function(t,e,n){var g=t("./support");var a=t("./renderers/canvas");var f=t("./imageloader");var h=t("./nodeparser");var i=t("./nodecontainer");var m=t("./log");var r=t("./utils");var o=t("./clone");var s=t("./proxy").loadUrlDocument;var v=r.getBounds;var d="data-html2canvas-node";var u=0;function l(t,e){var n=u++;e=e||{};if(e.logging){m.options.logging=true;m.options.start=Date.now()}e.async=typeof e.async==="undefined"?true:e.async;e.allowTaint=typeof e.allowTaint==="undefined"?false:e.allowTaint;e.removeContainer=typeof e.removeContainer==="undefined"?true:e.removeContainer;e.javascriptEnabled=typeof e.javascriptEnabled==="undefined"?false:e.javascriptEnabled;e.imageTimeout=typeof e.imageTimeout==="undefined"?1e4:e.imageTimeout;e.renderer=typeof e.renderer==="function"?e.renderer:a;e.strict=!!e.strict;if(typeof t==="string"){if(typeof e.proxy!=="string"){return tt.reject("Proxy must be used when rendering url")}var i=e.width!=null?e.width:window.innerWidth;var r=e.height!=null?e.height:window.innerHeight;return s(w(t),e.proxy,document,i,r,e).then(function(t){return y(t.contentWindow.document.documentElement,t,e,i,r)})}var o=(t===undefined?[document.documentElement]:t.length?t:[t])[0];o.setAttribute(d+n,n);return p(o.ownerDocument,e,o.ownerDocument.defaultView.innerWidth,o.ownerDocument.defaultView.innerHeight,n).then(function(t){if(typeof e.onrendered==="function"){m("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas");e.onrendered(t)}return t})}l.CanvasRenderer=a;l.NodeContainer=i;l.log=m;l.utils=r;var c=typeof document==="undefined"||typeof Object.create!=="function"||typeof document.createElement("canvas").getContext!=="function"?function(){return tt.reject("No canvas support")}:l;e.exports=c;if(typeof U==="function"&&U.amd){U("html2canvas",[],function(){return c})}function p(a,s,u,l,c){return o(a,a,u,l,s,a.defaultView.pageXOffset,a.defaultView.pageYOffset).then(function(t){m("Document cloned");var e=d+c;var n="["+e+"='"+c+"']";a.querySelector(n).removeAttribute(e);var i=t.contentWindow;var r=i.document.querySelector(n);var o=typeof s.onclone==="function"?tt.resolve(s.onclone(i.document)):tt.resolve(true);return o.then(function(){return y(r,t,s,u,l)})})}function y(e,n,i,t,r){var o=n.contentWindow;var a=new g(o.document);var s=new f(i,a);var u=v(e);var l=i.type==="view"?t:C(o.document);var c=i.type==="view"?r:T(o.document);var d=new i.renderer(l,c,s,i,document);var p=new h(e,d,a,s,i);return p.ready.then(function(){m("Finished rendering");var t;if(i.type==="view"){t=b(d.canvas,{width:d.canvas.width,height:d.canvas.height,top:0,left:0,x:0,y:0})}else if(e===o.document.body||e===o.document.documentElement||i.canvas!=null){t=d.canvas}else{t=b(d.canvas,{width:i.width!=null?i.width:u.width,height:i.height!=null?i.height:u.height,top:u.top,left:u.left,x:0,y:0})}S(n,i);return t})}function S(t,e){if(e.removeContainer){t.parentNode.removeChild(t);m("Cleaned up container")}}function b(t,e){var n=document.createElement("canvas");var i=Math.min(t.width-1,Math.max(0,e.left));var r=Math.min(t.width,Math.max(1,e.left+e.width));var o=Math.min(t.height-1,Math.max(0,e.top));var a=Math.min(t.height,Math.max(1,e.top+e.height));n.width=e.width;n.height=e.height;var s=r-i;var u=a-o;m("Cropping canvas at:","left:",e.left,"top:",e.top,"width:",s,"height:",u);m("Resulting crop with width",e.width,"and height",e.height,"with x",i,"and y",o);n.getContext("2d").drawImage(t,i,o,s,u,e.x,e.y,s,u);return n}function C(t){return Math.max(Math.max(t.body.scrollWidth,t.documentElement.scrollWidth),Math.max(t.body.offsetWidth,t.documentElement.offsetWidth),Math.max(t.body.clientWidth,t.documentElement.clientWidth))}function T(t){return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}function w(t){var e=document.createElement("a");e.href=t;e.href=e.href;return e}},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(t,e,n){var i=t("./log");var r=t("./utils").smallImage;function o(t){this.src=t;i("DummyImageContainer for",t);if(!this.promise||!this.image){i("Initiating DummyImageContainer");o.prototype.image=new Image;var n=this.image;o.prototype.promise=new tt(function(t,e){n.onload=t;n.onerror=e;n.src=r();if(n.complete===true){t(n)}})}}e.exports=o},{"./log":13,"./utils":26}],6:[function(t,e,n){var u=t("./utils").smallImage;function i(t,e){var n=document.createElement("div"),i=document.createElement("img"),r=document.createElement("span"),o="Hidden Text",a,s;n.style.visibility="hidden";n.style.fontFamily=t;n.style.fontSize=e;n.style.margin=0;n.style.padding=0;document.body.appendChild(n);i.src=u();i.width=1;i.height=1;i.style.margin=0;i.style.padding=0;i.style.verticalAlign="baseline";r.style.fontFamily=t;r.style.fontSize=e;r.style.margin=0;r.style.padding=0;r.appendChild(document.createTextNode(o));n.appendChild(r);n.appendChild(i);a=i.offsetTop-r.offsetTop+1;n.removeChild(r);n.appendChild(document.createTextNode(o));n.style.lineHeight="normal";i.style.verticalAlign="super";s=i.offsetTop-n.offsetTop+1;document.body.removeChild(n);this.baseline=a;this.lineWidth=1;this.middle=s}e.exports=i},{"./utils":26}],7:[function(t,e,n){var i=t("./font");function r(){this.data={}}r.prototype.getMetrics=function(t,e){if(this.data[t+"-"+e]===undefined){this.data[t+"-"+e]=new i(t,e)}return this.data[t+"-"+e]};e.exports=r},{"./font":6}],8:[function(o,t,e){var n=o("./utils");var a=n.getBounds;var r=o("./proxy").loadUrlDocument;function i(e,t,n){this.image=null;this.src=e;var i=this;var r=a(e);this.promise=(!t?this.proxyLoad(n.proxy,r,n):new tt(function(t){if(e.contentWindow.document.URL==="about:blank"||e.contentWindow.document.documentElement==null){e.contentWindow.onload=e.onload=function(){t(e)}}else{t(e)}})).then(function(t){var e=o("./core");return e(t.contentWindow.document.documentElement,{type:"view",width:t.width,height:t.height,proxy:n.proxy,javascriptEnabled:n.javascriptEnabled,removeContainer:n.removeContainer,allowTaint:n.allowTaint,imageTimeout:n.imageTimeout/2})}).then(function(t){return i.image=t})}i.prototype.proxyLoad=function(t,e,n){var i=this.src;return r(i.src,t,i.ownerDocument,e.width,e.height,n)};t.exports=i},{"./core":4,"./proxy":16,"./utils":26}],9:[function(t,e,n){function i(t){this.src=t.value;this.colorStops=[];this.type=null;this.x0=.5;this.y0=.5;this.x1=.5;this.y1=.5;this.promise=tt.resolve(true)}i.TYPES={LINEAR:1,RADIAL:2};i.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i;e.exports=i},{}],10:[function(t,e,n){function i(n,i){this.src=n;this.image=new Image;var r=this;this.tainted=null;this.promise=new tt(function(t,e){r.image.onload=t;r.image.onerror=e;if(i){r.image.crossOrigin="anonymous"}r.image.src=n;if(r.image.complete===true){t(r.image)}})}e.exports=i},{}],11:[function(t,e,n){var o=t("./log");var i=t("./imagecontainer");var r=t("./dummyimagecontainer");var a=t("./proxyimagecontainer");var s=t("./framecontainer");var u=t("./svgcontainer");var l=t("./svgnodecontainer");var c=t("./lineargradientcontainer");var d=t("./webkitgradientcontainer");var p=t("./utils").bind;function g(t,e){this.link=null;this.options=t;this.support=e;this.origin=this.getOrigin(window.location.href)}g.prototype.findImages=function(t){var e=[];t.reduce(function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t},[]).forEach(this.addImage(e,this.loadImage),this);return e};g.prototype.findBackgroundImage=function(t,e){e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this);return t};g.prototype.addImage=function(n,i){return function(e){e.args.forEach(function(t){if(!this.imageExists(n,t)){n.splice(0,0,i.call(this,e));o("Added image #"+n.length,typeof t==="string"?t.substring(0,100):t)}},this)}};g.prototype.hasImageBackground=function(t){return t.method!=="none"};g.prototype.loadImage=function(t){if(t.method==="url"){var e=t.args[0];if(this.isSVG(e)&&!this.support.svg&&!this.options.allowTaint){return new u(e)}else if(e.match(/data:image\/.*;base64,/i)){return new i(e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),false)}else if(this.isSameOrigin(e)||this.options.allowTaint===true||this.isSVG(e)){return new i(e,false)}else if(this.support.cors&&!this.options.allowTaint&&this.options.useCORS){return new i(e,true)}else if(this.options.proxy){return new a(e,this.options.proxy)}else{return new r(e)}}else if(t.method==="linear-gradient"){return new c(t)}else if(t.method==="gradient"){return new d(t)}else if(t.method==="svg"){return new l(t.args[0],this.support.svg)}else if(t.method==="IFRAME"){return new s(t.args[0],this.isSameOrigin(t.args[0].src),this.options)}else{return new r(t)}};g.prototype.isSVG=function(t){return t.substring(t.length-3).toLowerCase()==="svg"||u.prototype.isInline(t)};g.prototype.imageExists=function(t,e){return t.some(function(t){return t.src===e})};g.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin};g.prototype.getOrigin=function(t){var e=this.link||(this.link=document.createElement("a"));e.href=t;e.href=e.href;return e.protocol+e.hostname+e.port};g.prototype.getPromise=function(e){return this.timeout(e,this.options.imageTimeout)["catch"](function(){var t=new r(e.src);return t.promise.then(function(t){e.image=t})})};g.prototype.get=function(e){var n=null;return this.images.some(function(t){return(n=t).src===e})?n:null};g.prototype.fetch=function(t){this.images=t.reduce(p(this.findBackgroundImage,this),this.findImages(t));this.images.forEach(function(e,n){e.promise.then(function(){o("Succesfully loaded image #"+(n+1),e)},function(t){o("Failed loading image #"+(n+1),e,t)})});this.ready=tt.all(this.images.map(this.getPromise,this));o("Finished searching images");return this};g.prototype.timeout=function(n,i){var r;var t=tt.race([n.promise,new tt(function(t,e){r=setTimeout(function(){o("Timed out loading image",n);e(n)},i)})]).then(function(t){clearTimeout(r);return t});t["catch"](function(){clearTimeout(r)});return t};e.exports=g},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(t,e,n){var r=t("./gradientcontainer");var o=t("./color");function i(t){r.apply(this,arguments);this.type=r.TYPES.LINEAR;var e=i.REGEXP_DIRECTION.test(t.args[0])||!r.REGEXP_COLORSTOP.test(t.args[0]);if(e){t.args[0].split(/\s+/).reverse().forEach(function(t,e){switch(t){case"left":this.x0=0;this.x1=1;break;case"top":this.y0=0;this.y1=1;break;case"right":this.x0=1;this.x1=0;break;case"bottom":this.y0=1;this.y1=0;break;case"to":var n=this.y0;var i=this.x0;this.y0=this.y1;this.x0=this.x1;this.x1=i;this.y1=n;break;case"center":break;default:var r=parseFloat(t,10)*.01;if(isNaN(r)){break}if(e===0){this.y0=r;this.y1=1-this.y0}else{this.x0=r;this.x1=1-this.x0}break}},this)}else{this.y0=0;this.y1=1}this.colorStops=t.args.slice(e?1:0).map(function(t){var e=t.match(r.REGEXP_COLORSTOP);var n=+e[2];var i=n===0?"%":e[3];return{color:new o(e[1]),stop:i==="%"?n/100:null}});if(this.colorStops[0].stop===null){this.colorStops[0].stop=0}if(this.colorStops[this.colorStops.length-1].stop===null){this.colorStops[this.colorStops.length-1].stop=1}this.colorStops.forEach(function(n,i){if(n.stop===null){this.colorStops.slice(i).some(function(t,e){if(t.stop!==null){n.stop=(t.stop-this.colorStops[i-1].stop)/(e+1)+this.colorStops[i-1].stop;return true}else{return false}},this)}},this)}i.prototype=Object.create(r.prototype);i.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i;e.exports=i},{"./color":3,"./gradientcontainer":9}],13:[function(t,e,n){var i=function(){if(i.options.logging&&window.console&&window.console.log){Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-i.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))}};i.options={logging:false};e.exports=i},{}],14:[function(t,e,n){var o=t("./color");var i=t("./utils");var r=i.getBounds;var a=i.parseBackgrounds;var s=i.offsetBounds;function u(t,e){this.node=t;this.parent=e;this.stack=null;this.bounds=null;this.borders=null;this.clip=[];this.backgroundClip=[];this.offsetBounds=null;this.visible=null;this.computedStyles=null;this.colors={};this.styles={};this.backgroundImages=null;this.transformData=null;this.transformMatrix=null;this.isPseudoElement=false;this.opacity=null}u.prototype.cloneTo=function(t){t.visible=this.visible;t.borders=this.borders;t.bounds=this.bounds;t.clip=this.clip;t.backgroundClip=this.backgroundClip;t.computedStyles=this.computedStyles;t.styles=this.styles;t.backgroundImages=this.backgroundImages;t.opacity=this.opacity};u.prototype.getOpacity=function(){return this.opacity===null?this.opacity=this.cssFloat("opacity"):this.opacity};u.prototype.assignStack=function(t){this.stack=t;t.children.push(this)};u.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:this.css("display")!=="none"&&this.css("visibility")!=="hidden"&&!this.node.hasAttribute("data-html2canvas-ignore")&&(this.node.nodeName!=="INPUT"||this.node.getAttribute("type")!=="hidden")};u.prototype.css=function(t){if(!this.computedStyles){this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)}return this.styles[t]||(this.styles[t]=this.computedStyles[t])};u.prototype.prefixedCss=function(e){var t=["webkit","moz","ms","o"];var n=this.css(e);if(n===undefined){t.some(function(t){n=this.css(t+e.substr(0,1).toUpperCase()+e.substr(1));return n!==undefined},this)}return n===undefined?null:n};u.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)};u.prototype.cssInt=function(t){var e=parseInt(this.css(t),10);return isNaN(e)?0:e};u.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new o(this.css(t)))};u.prototype.cssFloat=function(t){var e=parseFloat(this.css(t));return isNaN(e)?0:e};u.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal";break}return t};u.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);if(t){return{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}}return null};u.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=a(this.css("backgroundImage")))};u.prototype.cssList=function(t,e){var n=(this.css(t)||"").split(",");n=n[e||0]||n[0]||"auto";n=n.trim().split(" ");if(n.length===1){n=[n[0],d(n[0])?"auto":n[0]]}return n};u.prototype.parseBackgroundSize=function(t,e,n){var i=this.cssList("backgroundSize",n);var r,o;if(d(i[0])){r=t.width*parseFloat(i[0])/100}else if(/contain|cover/.test(i[0])){var a=t.width/t.height,s=e.width/e.height;return a<s^i[0]==="contain"?{width:t.height*s,height:t.height}:{width:t.width,height:t.width/s}}else{r=parseInt(i[0],10)}if(i[0]==="auto"&&i[1]==="auto"){o=e.height}else if(i[1]==="auto"){o=r/e.width*e.height}else if(d(i[1])){o=t.height*parseFloat(i[1])/100}else{o=parseInt(i[1],10)}if(i[0]==="auto"){r=o/e.height*e.width}return{width:r,height:o}};u.prototype.parseBackgroundPosition=function(t,e,n,i){var r=this.cssList("backgroundPosition",n);var o,a;if(d(r[0])){o=(t.width-(i||e).width)*(parseFloat(r[0])/100)}else{o=parseInt(r[0],10)}if(r[1]==="auto"){a=o/e.width*e.height}else if(d(r[1])){a=(t.height-(i||e).height)*parseFloat(r[1])/100}else{a=parseInt(r[1],10)}if(r[0]==="auto"){o=a/e.height*e.width}return{left:o,top:a}};u.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]};u.prototype.parseTextShadows=function(){var t=this.css("textShadow");var e=[];if(t&&t!=="none"){var n=t.match(this.TEXT_SHADOW_PROPERTY);for(var i=0;n&&i<n.length;i++){var r=n[i].match(this.TEXT_SHADOW_VALUES);e.push({color:new o(r[0]),offsetX:r[1]?parseFloat(r[1].replace("px","")):0,offsetY:r[2]?parseFloat(r[2].replace("px","")):0,blur:r[3]?r[3].replace("px",""):0})}}return e};u.prototype.parseTransform=function(){if(!this.transformData){if(this.hasTransform()){var t=this.parseBounds();var e=this.prefixedCss("transformOrigin").split(" ").map(p).map(g);e[0]+=t.left;e[1]+=t.top;this.transformData={origin:e,matrix:this.parseTransformMatrix()}}else{this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]}}}return this.transformData};u.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var t=this.prefixedCss("transform");var e=t?c(t.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=e?e:[1,0,0,1,0,0]}return this.transformMatrix};u.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?s(this.node):r(this.node))};u.prototype.hasTransform=function(){return this.parseTransformMatrix().join(",")!=="1,0,0,1,0,0"||this.parent&&this.parent.hasTransform()};u.prototype.getValue=function(){var t=this.node.value||"";if(this.node.tagName==="SELECT"){t=l(this.node)}else if(this.node.type==="password"){t=Array(t.length+1).join("•")}return t.length===0?this.node.placeholder||"":t};u.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/;u.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g;u.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;u.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/;function l(t){var e=t.options[t.selectedIndex||0];return e?e.text||"":""}function c(t){if(t&&t[1]==="matrix"){return t[2].split(",").map(function(t){return parseFloat(t.trim())})}else if(t&&t[1]==="matrix3d"){var e=t[2].split(",").map(function(t){return parseFloat(t.trim())});return[e[0],e[1],e[4],e[5],e[12],e[13]]}}function d(t){return t.toString().indexOf("%")!==-1}function p(t){return t.replace("px","")}function g(t){return parseFloat(t)}e.exports=u},{"./color":3,"./utils":26}],15:[function(t,e,n){var s=t("./log");var u=t("punycode");var l=t("./nodecontainer");var c=t("./textcontainer");var d=t("./pseudoelementcontainer");var p=t("./fontmetrics");var g=t("./color");var f=t("./stackingcontext");var i=t("./utils");var h=i.bind;var a=i.getBounds;var m=i.parseBackgrounds;var v=i.offsetBounds;function r(t,e,n,i,r){s("Starting NodeParser");this.renderer=e;this.options=r;this.range=null;this.support=n;this.renderQueue=[];this.stack=new f(true,1,t.ownerDocument,null);var o=new l(t,null);if(r.background){e.rectangle(0,0,e.width,e.height,new g(r.background))}if(t===t.ownerDocument.documentElement){var a=new l(o.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null);e.rectangle(0,0,e.width,e.height,a.color("backgroundColor"))}o.visibile=o.isElementVisible();this.createPseudoHideStyles(t.ownerDocument);this.disableAnimations(t.ownerDocument);this.nodes=Y([o].concat(this.getChildren(o)).filter(function(t){return t.visible=t.isElementVisible()}).map(this.getPseudoElements,this));this.fontMetrics=new p;s("Fetched nodes, total:",this.nodes.length);s("Calculate overflow clips");this.calculateOverflowClips();s("Start fetching images");this.images=i.fetch(this.nodes.filter(G));this.ready=this.images.ready.then(h(function(){s("Images loaded, starting parsing");s("Creating stacking contexts");this.createStackingContexts();s("Sorting stacking contexts");this.sortStackingContexts(this.stack);this.parse(this.stack);s("Render queue created with "+this.renderQueue.length+" items");return new tt(h(function(t){if(!r.async){this.renderQueue.forEach(this.paint,this);t()}else if(typeof r.async==="function"){r.async.call(this,this.renderQueue,t)}else if(this.renderQueue.length>0){this.renderIndex=0;this.asyncRenderer(this.renderQueue,t)}else{t()}},this))},this))}r.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(t){if(G(t)){if(z(t)){t.appendToDOM()}t.borders=this.parseBorders(t);var e=t.css("overflow")==="hidden"?[t.borders.clip]:[];var n=t.parseClip();if(n&&["absolute","fixed"].indexOf(t.css("position"))!==-1){e.push([["rect",t.bounds.left+n.left,t.bounds.top+n.top,n.right-n.left,n.bottom-n.top]])}t.clip=o(t)?t.parent.clip.concat(e):e;t.backgroundClip=t.css("overflow")!=="hidden"?t.clip.concat([t.borders.clip]):t.clip;if(z(t)){t.cleanDOM()}}else if(q(t)){t.clip=o(t)?t.parent.clip:[]}if(!z(t)){t.bounds=null}},this)};function o(t){return t.parent&&t.parent.clip.length}r.prototype.asyncRenderer=function(t,e,n){n=n||Date.now();this.paint(t[this.renderIndex++]);if(t.length===this.renderIndex){e()}else if(n+20>Date.now()){this.asyncRenderer(t,e,n)}else{setTimeout(h(function(){this.asyncRenderer(t,e)},this),0)}};r.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+d.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }'+"."+d.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')};r.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; "+"-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")};r.prototype.createStyles=function(t,e){var n=t.createElement("style");n.innerHTML=e;t.body.appendChild(n)};r.prototype.getPseudoElements=function(t){var e=[[t]];if(t.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(t,":before");var i=this.getPseudoElement(t,":after");if(n){e.push(n)}if(i){e.push(i)}}return Y(e)};function y(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})}r.prototype.getPseudoElement=function(t,e){var n=t.computedStyle(e);if(!n||!n.content||n.content==="none"||n.content==="-moz-alt-content"||n.display==="none"){return null}var i=K(n.content);var r=i.substr(0,3)==="url";var o=document.createElement(r?"img":"html2canvaspseudoelement");var a=new d(o,t,e);for(var s=n.length-1;s>=0;s--){var u=y(n.item(s));o.style[u]=n[u]}o.className=d.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+d.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;if(r){o.src=m(i)[0].args[0];return[a]}else{var l=document.createTextNode(i);o.appendChild(l);return[a,new c(l,a)]}};r.prototype.getChildren=function(n){return Y([].filter.call(n.node.childNodes,L).map(function(t){var e=[t.nodeType===Node.TEXT_NODE?new c(t,n):new l(t,n)].filter(Q);return t.nodeType===Node.ELEMENT_NODE&&e.length&&t.tagName!=="TEXTAREA"?e[0].isElementVisible()?e.concat(this.getChildren(e[0])):[]:e},this))};r.prototype.newStackingContext=function(t,e){var n=new f(e,t.getOpacity(),t.node,t.parent);t.cloneTo(n);var i=e?n.getParentStack(this):n.parent.stack;i.contexts.push(n);t.stack=n};r.prototype.createStackingContexts=function(){this.nodes.forEach(function(t){if(G(t)&&(this.isRootElement(t)||H(t)||P(t)||this.isBodyWithTransparentRoot(t)||t.hasTransform())){this.newStackingContext(t,true)}else if(G(t)&&(U(t)&&_(t)||R(t)||M(t))){this.newStackingContext(t,false)}else{t.assignStack(t.parent.stack)}},this)};r.prototype.isBodyWithTransparentRoot=function(t){return t.node.nodeName==="BODY"&&t.parent.color("backgroundColor").isTransparent()};r.prototype.isRootElement=function(t){return t.parent===null};r.prototype.sortStackingContexts=function(t){t.contexts.sort(W(t.contexts.slice(0)));t.contexts.forEach(this.sortStackingContexts,this)};r.prototype.parseTextBounds=function(a){return function(t,e,n){if(a.parent.css("textDecoration").substr(0,4)!=="none"||t.trim().length!==0){if(this.support.rangeBounds&&!a.parent.hasTransform()){var i=n.slice(0,e).join("").length;return this.getRangeBounds(a.node,i,t.length)}else if(a.node&&typeof a.node.data==="string"){var r=a.node.splitText(t.length);var o=this.getWrapperBounds(a.node,a.parent.hasTransform());a.node=r;return o}}else if(!this.support.rangeBounds||a.parent.hasTransform()){a.node=a.node.splitText(t.length)}return{}}};r.prototype.getWrapperBounds=function(t,e){var n=t.ownerDocument.createElement("html2canvaswrapper");var i=t.parentNode,r=t.cloneNode(true);n.appendChild(t.cloneNode(true));i.replaceChild(n,t);var o=e?v(n):a(n);i.replaceChild(r,n);return o};r.prototype.getRangeBounds=function(t,e,n){var i=this.range||(this.range=t.ownerDocument.createRange());i.setStart(t,e);i.setEnd(t,e+n);return i.getBoundingClientRect()};function S(){}r.prototype.parse=function(t){var e=t.contexts.filter(F);var n=t.children.filter(G);var i=n.filter(V(M));var r=i.filter(V(U)).filter(V(D));var o=n.filter(V(U)).filter(M);var a=i.filter(V(U)).filter(D);var s=t.contexts.concat(i.filter(U)).filter(_);var u=t.children.filter(q).filter(x);var l=t.contexts.filter(O);e.concat(r).concat(o).concat(a).concat(s).concat(u).concat(l).forEach(function(t){this.renderQueue.push(t);if(N(t)){this.parse(t);this.renderQueue.push(new S)}},this)};r.prototype.paint=function(t){try{if(t instanceof S){this.renderer.ctx.restore()}else if(q(t)){if(z(t.parent)){t.parent.appendToDOM()}this.paintText(t);if(z(t.parent)){t.parent.cleanDOM()}}else{this.paintNode(t)}}catch(t){s(t);if(this.options.strict){throw t}}};r.prototype.paintNode=function(t){if(N(t)){this.renderer.setOpacity(t.opacity);this.renderer.ctx.save();if(t.hasTransform()){this.renderer.setTransform(t.parseTransform())}}if(t.node.nodeName==="INPUT"&&t.node.type==="checkbox"){this.paintCheckbox(t)}else if(t.node.nodeName==="INPUT"&&t.node.type==="radio"){this.paintRadio(t)}else{this.paintElement(t)}};r.prototype.paintElement=function(n){var i=n.parseBounds();this.renderer.clip(n.backgroundClip,function(){this.renderer.renderBackground(n,i,n.borders.borders.map(J))},this);this.renderer.clip(n.clip,function(){this.renderer.renderBorders(n.borders.borders)},this);this.renderer.clip(n.backgroundClip,function(){switch(n.node.nodeName){case"svg":case"IFRAME":var t=this.images.get(n.node);if(t){this.renderer.renderImage(n,i,n.borders,t)}else{s("Error loading <"+n.node.nodeName+">",n.node)}break;case"IMG":var e=this.images.get(n.node.src);if(e){this.renderer.renderImage(n,i,n.borders,e)}else{s("Error loading <img>",n.node.src)}break;case"CANVAS":this.renderer.renderImage(n,i,n.borders,{image:n.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(n);break}},this)};r.prototype.paintCheckbox=function(t){var e=t.parseBounds();var n=Math.min(e.width,e.height);var i={width:n-1,height:n-1,top:e.top,left:e.left};var r=[3,3];var o=[r,r,r,r];var a=[1,1,1,1].map(function(t){return{color:new g("#A5A5A5"),width:t}});var s=w(i,o,a);this.renderer.clip(t.backgroundClip,function(){this.renderer.rectangle(i.left+1,i.top+1,i.width-2,i.height-2,new g("#DEDEDE"));this.renderer.renderBorders(C(a,i,s,o));if(t.node.checked){this.renderer.font(new g("#424242"),"normal","normal","bold",n-3+"px","arial");this.renderer.text("✔",i.left+n/6,i.top+n-1)}},this)};r.prototype.paintRadio=function(t){var e=t.parseBounds();var n=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,function(){this.renderer.circleStroke(e.left+1,e.top+1,n,new g("#DEDEDE"),1,new g("#A5A5A5"));if(t.node.checked){this.renderer.circle(Math.ceil(e.left+n/4)+1,Math.ceil(e.top+n/4)+1,Math.floor(n/2),new g("#424242"))}},this)};r.prototype.paintFormValue=function(e){var t=e.getValue();if(t.length>0){var n=e.node.ownerDocument;var i=n.createElement("html2canvaswrapper");var r=["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"];r.forEach(function(t){try{i.style[t]=e.css(t)}catch(t){s("html2canvas: Parse: Exception caught in renderFormValue: "+t.message)}});var o=e.parseBounds();i.style.position="fixed";i.style.left=o.left+"px";i.style.top=o.top+"px";i.textContent=t;n.body.appendChild(i);this.paintText(new c(i.firstChild,e));n.body.removeChild(i)}};r.prototype.paintText=function(n){n.applyTextTransform();var t=u.ucs2.decode(n.node.data);var i=(!this.options.letterRendering||B(n))&&!$(n.node.data)?Z(t):t.map(function(t){return u.ucs2.encode([t])});var e=n.parent.fontWeight();var r=n.parent.css("fontSize");var o=n.parent.css("fontFamily");var a=n.parent.parseTextShadows();this.renderer.font(n.parent.color("color"),n.parent.css("fontStyle"),n.parent.css("fontVariant"),e,r,o);if(a.length){this.renderer.fontShadow(a[0].color,a[0].offsetX,a[0].offsetY,a[0].blur)}else{this.renderer.clearShadow()}this.renderer.clip(n.parent.clip,function(){i.map(this.parseTextBounds(n),this).forEach(function(t,e){if(t){this.renderer.text(i[e],t.left,t.bottom);this.renderTextDecoration(n.parent,t,this.fontMetrics.getMetrics(o,r))}},this)},this)};r.prototype.renderTextDecoration=function(t,e,n){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+n.baseline+n.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+n.middle+n.lineWidth),e.width,1,t.color("color"));break}};var b={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};r.prototype.parseBorders=function(o){var t=o.parseBounds();var e=k(o);var n=["Top","Right","Bottom","Left"].map(function(t,e){var n=o.css("border"+t+"Style");var i=o.color("border"+t+"Color");if(n==="inset"&&i.isBlack()){i=new g([255,255,255,i.a])}var r=b[n]?b[n][e]:null;return{width:o.cssInt("border"+t+"Width"),color:r?i[r[0]](r[1]):i,args:null}});var i=w(t,e,n);return{clip:this.parseBackgroundClip(o,i,n,e,t),borders:C(n,t,i,e)}};function C(a,s,u,l){return a.map(function(t,e){if(t.width>0){var n=s.left;var i=s.top;var r=s.width;var o=s.height-a[2].width;switch(e){case 0:o=a[0].width;t.args=I({c1:[n,i],c2:[n+r,i],c3:[n+r-a[1].width,i+o],c4:[n+a[3].width,i+o]},l[0],l[1],u.topLeftOuter,u.topLeftInner,u.topRightOuter,u.topRightInner);break;case 1:n=s.left+s.width-a[1].width;r=a[1].width;t.args=I({c1:[n+r,i],c2:[n+r,i+o+a[2].width],c3:[n,i+o],c4:[n,i+a[0].width]},l[1],l[2],u.topRightOuter,u.topRightInner,u.bottomRightOuter,u.bottomRightInner);break;case 2:i=i+s.height-a[2].width;o=a[2].width;t.args=I({c1:[n+r,i+o],c2:[n,i+o],c3:[n+a[3].width,i],c4:[n+r-a[3].width,i]},l[2],l[3],u.bottomRightOuter,u.bottomRightInner,u.bottomLeftOuter,u.bottomLeftInner);break;case 3:r=a[3].width;t.args=I({c1:[n,i+o+a[2].width],c2:[n,i],c3:[n+r,i+a[0].width],c4:[n+r,i+o]},l[3],l[0],u.bottomLeftOuter,u.bottomLeftInner,u.topLeftOuter,u.topLeftInner);break}}return t})}r.prototype.parseBackgroundClip=function(t,e,n,i,r){var o=t.css("backgroundClip"),a=[];switch(o){case"content-box":case"padding-box":E(a,i[0],i[1],e.topLeftInner,e.topRightInner,r.left+n[3].width,r.top+n[0].width);E(a,i[1],i[2],e.topRightInner,e.bottomRightInner,r.left+r.width-n[1].width,r.top+n[0].width);E(a,i[2],i[3],e.bottomRightInner,e.bottomLeftInner,r.left+r.width-n[1].width,r.top+r.height-n[2].width);E(a,i[3],i[0],e.bottomLeftInner,e.topLeftInner,r.left+n[3].width,r.top+r.height-n[2].width);break;default:E(a,i[0],i[1],e.topLeftOuter,e.topRightOuter,r.left,r.top);E(a,i[1],i[2],e.topRightOuter,e.bottomRightOuter,r.left+r.width,r.top);E(a,i[2],i[3],e.bottomRightOuter,e.bottomLeftOuter,r.left+r.width,r.top+r.height);E(a,i[3],i[0],e.bottomLeftOuter,e.topLeftOuter,r.left,r.top+r.height);break}return a};function T(t,e,n,i){var r=4*((Math.sqrt(2)-1)/3);var o=n*r,a=i*r,s=t+n,u=e+i;return{topLeft:A({x:t,y:u},{x:t,y:u-a},{x:s-o,y:e},{x:s,y:e}),topRight:A({x:t,y:e},{x:t+o,y:e},{x:s,y:u-a},{x:s,y:u}),bottomRight:A({x:s,y:e},{x:s,y:e+a},{x:t+o,y:u},{x:t,y:u}),bottomLeft:A({x:s,y:u},{x:s-o,y:u},{x:t,y:e+a},{x:t,y:e})}}function w(t,e,n){var i=t.left,r=t.top,o=t.width,a=t.height,s=e[0][0]<o/2?e[0][0]:o/2,u=e[0][1]<a/2?e[0][1]:a/2,l=e[1][0]<o/2?e[1][0]:o/2,c=e[1][1]<a/2?e[1][1]:a/2,d=e[2][0]<o/2?e[2][0]:o/2,p=e[2][1]<a/2?e[2][1]:a/2,g=e[3][0]<o/2?e[3][0]:o/2,f=e[3][1]<a/2?e[3][1]:a/2;var h=o-l,m=a-p,v=o-d,y=a-f;return{topLeftOuter:T(i,r,s,u).topLeft.subdivide(.5),topLeftInner:T(i+n[3].width,r+n[0].width,Math.max(0,s-n[3].width),Math.max(0,u-n[0].width)).topLeft.subdivide(.5),topRightOuter:T(i+h,r,l,c).topRight.subdivide(.5),topRightInner:T(i+Math.min(h,o+n[3].width),r+n[0].width,h>o+n[3].width?0:l-n[3].width,c-n[0].width).topRight.subdivide(.5),bottomRightOuter:T(i+v,r+m,d,p).bottomRight.subdivide(.5),bottomRightInner:T(i+Math.min(v,o-n[3].width),r+Math.min(m,a+n[0].width),Math.max(0,d-n[1].width),p-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:T(i,r+y,g,f).bottomLeft.subdivide(.5),bottomLeftInner:T(i+n[3].width,r+y,Math.max(0,g-n[3].width),f-n[2].width).bottomLeft.subdivide(.5)}}function A(s,u,l,c){var d=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:s,startControl:u,endControl:l,end:c,subdivide:function(t){var e=d(s,u,t),n=d(u,l,t),i=d(l,c,t),r=d(e,n,t),o=d(n,i,t),a=d(r,o,t);return[A(s,e,r,a),A(a,o,i,c)]},curveTo:function(t){t.push(["bezierCurve",u.x,u.y,l.x,l.y,c.x,c.y])},curveToReversed:function(t){t.push(["bezierCurve",l.x,l.y,u.x,u.y,s.x,s.y])}}}function I(t,e,n,i,r,o,a){var s=[];if(e[0]>0||e[1]>0){s.push(["line",i[1].start.x,i[1].start.y]);i[1].curveTo(s)}else{s.push(["line",t.c1[0],t.c1[1]])}if(n[0]>0||n[1]>0){s.push(["line",o[0].start.x,o[0].start.y]);o[0].curveTo(s);s.push(["line",a[0].end.x,a[0].end.y]);a[0].curveToReversed(s)}else{s.push(["line",t.c2[0],t.c2[1]]);s.push(["line",t.c3[0],t.c3[1]])}if(e[0]>0||e[1]>0){s.push(["line",r[1].end.x,r[1].end.y]);r[1].curveToReversed(s)}else{s.push(["line",t.c4[0],t.c4[1]])}return s}function E(t,e,n,i,r,o,a){if(e[0]>0||e[1]>0){t.push(["line",i[0].start.x,i[0].start.y]);i[0].curveTo(t);i[1].curveTo(t)}else{t.push(["line",o,a])}if(n[0]>0||n[1]>0){t.push(["line",r[0].start.x,r[0].start.y])}}function F(t){return t.cssInt("zIndex")<0}function O(t){return t.cssInt("zIndex")>0}function _(t){return t.cssInt("zIndex")===0}function D(t){return["inline","inline-block","inline-table"].indexOf(t.css("display"))!==-1}function N(t){return t instanceof f}function x(t){return t.node.data.trim().length>0}function B(t){return/^(normal|none|0px)$/.test(t.parent.css("letterSpacing"))}function k(i){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){var e=i.css("border"+t+"Radius");var n=e.split(" ");if(n.length<=1){n[1]=n[0]}return n.map(j)})}function L(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function P(t){var e=t.css("position");var n=["absolute","relative","fixed"].indexOf(e)!==-1?t.css("zIndex"):"auto";return n!=="auto"}function U(t){return t.css("position")!=="static"}function M(t){return t.css("float")!=="none"}function R(t){return["inline-block","inline-table"].indexOf(t.css("display"))!==-1}function V(t){var e=this;return function(){return!t.apply(e,arguments)}}function G(t){return t.node.nodeType===Node.ELEMENT_NODE}function z(t){return t.isPseudoElement===true}function q(t){return t.node.nodeType===Node.TEXT_NODE}function W(n){return function(t,e){return t.cssInt("zIndex")+n.indexOf(t)/n.length-(e.cssInt("zIndex")+n.indexOf(e)/n.length)}}function H(t){return t.getOpacity()<1}function j(t){return parseInt(t,10)}function J(t){return t.width}function Q(t){return t.node.nodeType!==Node.ELEMENT_NODE||["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)===-1}function Y(t){return[].concat.apply([],t)}function K(t){var e=t.substr(0,1);return e===t.substr(t.length-1)&&e.match(/'|"/)?t.substr(1,t.length-2):t}function Z(t){var e=[],n=0,i=false,r;while(t.length){if(X(t[n])===i){r=t.splice(0,n);if(r.length){e.push(u.ucs2.encode(r))}i=!i;n=0}else{n++}if(n>=t.length){r=t.splice(0,n);if(r.length){e.push(u.ucs2.encode(r))}}}return e}function X(t){return[32,13,10,9,45].indexOf(t)!==-1}function $(t){return/[^\u0000-\u00ff]/.test(t)}e.exports=r},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(t,e,n){var a=t("./xhr");var i=t("./utils");var s=t("./log");var u=t("./clone");var l=i.decode64;function c(t,e,n){var i="withCredentials"in new XMLHttpRequest;if(!e){return tt.reject("No proxy configured")}var r=p(i);var o=g(e,t,r);return i?a(o):d(n,o,r).then(function(t){return l(t.content)})}var r=0;function o(t,e,n){var i="crossOrigin"in new Image;var r=p(i);var o=g(e,t,r);return i?tt.resolve(o):d(n,o,r).then(function(t){return"data:"+t.type+";base64,"+t.content})}function d(r,o,a){return new tt(function(e,n){var t=r.createElement("script");var i=function(){delete window.OfficeBrowserFeedback.html2canvas.proxy[a];r.body.removeChild(t)};window.OfficeBrowserFeedback.html2canvas.proxy[a]=function(t){i();e(t)};t.src=o;t.onerror=function(t){i();n(t)};r.body.appendChild(t)})}function p(t){return!t?"html2canvas_"+Date.now()+"_"+ ++r+"_"+Math.round(Math.random()*1e5):""}function g(t,e,n){return t+"?url="+encodeURIComponent(e)+(n.length?"&callback=html2canvas.proxy."+n:"")}function f(o){return function(e){var t=new DOMParser,n;try{n=t.parseFromString(e,"text/html")}catch(t){s("DOMParser not supported, falling back to createHTMLDocument");n=document.implementation.createHTMLDocument("");try{n.open();n.write(e);n.close()}catch(t){s("createHTMLDocument write not supported, falling back to document.body.innerHTML");n.body.innerHTML=e}}var i=n.querySelector("base");if(!i||!i.href.host){var r=n.createElement("base");r.href=o;n.head.insertBefore(r,n.head.firstChild)}return n}}function h(t,e,n,i,r,o){return new c(t,e,window.document).then(f(t)).then(function(t){return u(t,n,i,r,o,0,0)})}n.Proxy=c;n.ProxyURL=o;n.loadUrlDocument=h},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(t,e,n){var o=t("./proxy").ProxyURL;function i(n,i){var t=document.createElement("a");t.href=n;n=t.href;this.src=n;this.image=new Image;var r=this;this.promise=new tt(function(t,e){r.image.crossOrigin="Anonymous";r.image.onload=t;r.image.onerror=e;new o(n,i,document).then(function(t){r.image.src=t})["catch"](e)})}e.exports=i},{"./proxy":16}],18:[function(t,e,n){var i=t("./nodecontainer");function r(t,e,n){i.call(this,t,e);this.isPseudoElement=true;this.before=n===":before"}r.prototype.cloneTo=function(t){r.prototype.cloneTo.call(this,t);t.isPseudoElement=true;t.before=this.before};r.prototype=Object.create(i.prototype);r.prototype.appendToDOM=function(){if(this.before){this.parent.node.insertBefore(this.node,this.parent.node.firstChild)}else{this.parent.node.appendChild(this.node)}this.parent.node.className+=" "+this.getHideClass()};r.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node);this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")};r.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]};r.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before";r.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after";e.exports=r},{"./nodecontainer":14}],19:[function(t,e,n){var u=t("./log");function i(t,e,n,i,r){this.width=t;this.height=e;this.images=n;this.options=i;this.document=r}i.prototype.renderImage=function(t,e,n,i){var r=t.cssInt("paddingLeft"),o=t.cssInt("paddingTop"),a=t.cssInt("paddingRight"),s=t.cssInt("paddingBottom"),u=n.borders;var l=e.width-(u[1].width+u[3].width+r+a);var c=e.height-(u[0].width+u[2].width+o+s);this.drawImage(i,0,0,i.image.width||l,i.image.height||c,e.left+r+u[3].width,e.top+o+u[0].width,l,c)};i.prototype.renderBackground=function(t,e,n){if(e.height>0&&e.width>0){this.renderBackgroundColor(t,e);this.renderBackgroundImage(t,e,n)}};i.prototype.renderBackgroundColor=function(t,e){var n=t.color("backgroundColor");if(!n.isTransparent()){this.rectangle(e.left,e.top,e.width,e.height,n)}};i.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)};i.prototype.renderBorder=function(t){if(!t.color.isTransparent()&&t.args!==null){this.drawShape(t.args,t.color)}};i.prototype.renderBackgroundImage=function(o,a,s){var t=o.parseBackgroundImages();t.reverse().forEach(function(t,e,n){switch(t.method){case"url":var i=this.images.get(t.args[0]);if(i){this.renderBackgroundRepeating(o,a,i,n.length-(e+1),s)}else{u("Error loading background-image",t.args[0])}break;case"linear-gradient":case"gradient":var r=this.images.get(t.value);if(r){this.renderBackgroundGradient(r,a,s)}else{u("Error loading background-image",t.args[0])}break;case"none":break;default:u("Unknown background-image type",t.args[0])}},this)};i.prototype.renderBackgroundRepeating=function(t,e,n,i,r){var o=t.parseBackgroundSize(e,n.image,i);var a=t.parseBackgroundPosition(e,n.image,i,o);var s=t.parseBackgroundRepeat(i);switch(s){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,a,o,e,e.left+r[3],e.top+a.top+r[0],99999,o.height,r);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,a,o,e,e.left+a.left+r[3],e.top+r[0],o.width,99999,r);break;case"no-repeat":this.backgroundRepeatShape(n,a,o,e,e.left+a.left+r[3],e.top+a.top+r[0],o.width,o.height,r);break;default:this.renderBackgroundRepeat(n,a,o,{top:e.top,left:e.left},r[3],r[0]);break}};e.exports=i},{"./log":13}],20:[function(t,e,n){var i=t("../renderer");var r=t("../lineargradientcontainer");var o=t("../log");function a(t,e){i.apply(this,arguments);this.canvas=this.options.canvas||this.document.createElement("canvas");if(!this.options.canvas){this.canvas.width=t;this.canvas.height=e}this.ctx=this.canvas.getContext("2d");this.taintCtx=this.document.createElement("canvas").getContext("2d");this.ctx.textBaseline="bottom";this.variables={};o("Initialized CanvasRenderer with size",t,"x",e)}a.prototype=Object.create(i.prototype);a.prototype.setFillStyle=function(t){this.ctx.fillStyle=typeof t==="object"&&!!t.isColor?t.toString():t;return this.ctx};a.prototype.rectangle=function(t,e,n,i,r){this.setFillStyle(r).fillRect(t,e,n,i)};a.prototype.circle=function(t,e,n,i){this.setFillStyle(i);this.ctx.beginPath();this.ctx.arc(t+n/2,e+n/2,n/2,0,Math.PI*2,true);this.ctx.closePath();this.ctx.fill()};a.prototype.circleStroke=function(t,e,n,i,r,o){this.circle(t,e,n,i);this.ctx.strokeStyle=o.toString();this.ctx.stroke()};a.prototype.drawShape=function(t,e){this.shape(t);this.setFillStyle(e).fill()};a.prototype.taints=function(e){if(e.tainted===null){this.taintCtx.drawImage(e.image,0,0);try{this.taintCtx.getImageData(0,0,1,1);e.tainted=false}catch(t){this.taintCtx=document.createElement("canvas").getContext("2d");e.tainted=true}}return e.tainted};a.prototype.drawImage=function(t,e,n,i,r,o,a,s,u){if(!this.taints(t)||this.options.allowTaint){this.ctx.drawImage(t.image,e,n,i,r,o,a,s,u)}};a.prototype.clip=function(t,e,n){this.ctx.save();t.filter(s).forEach(function(t){this.shape(t).clip()},this);e.call(n);this.ctx.restore()};a.prototype.shape=function(t){this.ctx.beginPath();t.forEach(function(t,e){if(t[0]==="rect"){this.ctx.rect.apply(this.ctx,t.slice(1))}else{this.ctx[e===0?"moveTo":t[0]+"To"].apply(this.ctx,t.slice(1))}},this);this.ctx.closePath();return this.ctx};a.prototype.font=function(t,e,n,i,r,o){this.setFillStyle(t).font=[e,n,i,r,o].join(" ").split(",")[0]};a.prototype.fontShadow=function(t,e,n,i){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",n).setVariable("shadowBlur",i)};a.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")};a.prototype.setOpacity=function(t){this.ctx.globalAlpha=t};a.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]);this.ctx.transform.apply(this.ctx,t.matrix);this.ctx.translate(-t.origin[0],-t.origin[1])};a.prototype.setVariable=function(t,e){if(this.variables[t]!==e){this.variables[t]=this.ctx[t]=e}return this};a.prototype.text=function(t,e,n){this.ctx.fillText(t,e,n)};a.prototype.backgroundRepeatShape=function(t,e,n,i,r,o,a,s,u){var l=[["line",Math.round(r),Math.round(o)],["line",Math.round(r+a),Math.round(o)],["line",Math.round(r+a),Math.round(s+o)],["line",Math.round(r),Math.round(s+o)]];this.clip([l],function(){this.renderBackgroundRepeat(t,e,n,i,u[3],u[0])},this)};a.prototype.renderBackgroundRepeat=function(t,e,n,i,r,o){var a=Math.round(i.left+e.left+r),s=Math.round(i.top+e.top+o);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,n),"repeat"));this.ctx.translate(a,s);this.ctx.fill();this.ctx.translate(-a,-s)};a.prototype.renderBackgroundGradient=function(t,e){if(t instanceof r){var n=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1);t.colorStops.forEach(function(t){n.addColorStop(t.stop,t.color.toString())});this.rectangle(e.left,e.top,e.width,e.height,n)}};a.prototype.resizeImage=function(t,e){var n=t.image;if(n.width===e.width&&n.height===e.height){return n}var i,r=document.createElement("canvas");r.width=e.width;r.height=e.height;i=r.getContext("2d");i.drawImage(n,0,0,n.width,n.height,0,0,e.width,e.height);return r};function s(t){return t.length>0}e.exports=a},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(t,e,n){var r=t("./nodecontainer");function i(t,e,n,i){r.call(this,n,i);this.ownStacking=t;this.contexts=[];this.children=[];this.opacity=(this.parent?this.parent.stack.opacity:1)*e}i.prototype=Object.create(r.prototype);i.prototype.getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack};e.exports=i},{"./nodecontainer":14}],22:[function(t,e,n){function i(t){this.rangeBounds=this.testRangeBounds(t);this.cors=this.testCORS();this.svg=this.testSVG()}i.prototype.testRangeBounds=function(t){var e,n,i,r,o=false;if(t.createRange){e=t.createRange();if(e.getBoundingClientRect){n=t.createElement("boundtest");n.style.height="123px";n.style.display="block";t.body.appendChild(n);e.selectNode(n);i=e.getBoundingClientRect();r=i.height;if(r===123){o=true}t.body.removeChild(n)}}return o};i.prototype.testCORS=function(){return typeof(new Image).crossOrigin!=="undefined"};i.prototype.testSVG=function(){var t=new Image;var e=document.createElement("canvas");var n=e.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0);e.toDataURL()}catch(t){return false}return true};e.exports=i},{}],23:[function(t,e,n){var i=t("./xhr");var r=t("./utils").decode64;function o(t){this.src=t;this.image=null;var n=this;this.promise=this.hasFabric().then(function(){return n.isInline(t)?tt.resolve(n.inlineFormatting(t)):i(t)}).then(function(e){return new tt(function(t){window.OfficeBrowserFeedback.html2canvas.svg.fabric.loadSVGFromString(e,n.createCanvas.call(n,t))})})}o.prototype.hasFabric=function(){return!window.OfficeBrowserFeedback.html2canvas.svg||!window.OfficeBrowserFeedback.html2canvas.svg.fabric?tt.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg")):tt.resolve()};o.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)};o.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")};o.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)};o.prototype.createCanvas=function(i){var r=this;return function(t,e){var n=new window.OfficeBrowserFeedback.html2canvas.svg.fabric.StaticCanvas("c");r.image=n.lowerCanvasEl;n.setWidth(e.width).setHeight(e.height).add(window.OfficeBrowserFeedback.html2canvas.svg.fabric.util.groupSVGElements(t,e)).renderAll();i(n.lowerCanvasEl)}};o.prototype.decode64=function(t){return typeof window.atob==="function"?window.atob(t):r(t)};e.exports=o},{"./utils":26,"./xhr":28}],24:[function(t,e,n){var i=t("./svgcontainer");function r(n,t){this.src=n;this.image=null;var i=this;this.promise=t?new tt(function(t,e){i.image=new Image;i.image.onload=t;i.image.onerror=e;i.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(n);if(i.image.complete===true){t(i.image)}}):this.hasFabric().then(function(){return new tt(function(t){window.OfficeBrowserFeedback.html2canvas.svg.fabric.parseSVGDocument(n,i.createCanvas.call(i,t))})})}r.prototype=Object.create(i.prototype);e.exports=r},{"./svgcontainer":23}],25:[function(t,e,n){var i=t("./nodecontainer");function r(t,e){i.call(this,t,e)}r.prototype=Object.create(i.prototype);r.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))};r.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,o);case"uppercase":return e.toUpperCase();default:return e}};function o(t,e,n){if(t.length>0){return e+n.toUpperCase()}}e.exports=r},{"./nodecontainer":14}],26:[function(t,e,n){n.smallImage=function t(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"};n.bind=function(t,e){return function(){return t.apply(e,arguments)}};n.decode64=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var n=t.length,i,r,o,a,s,u,l,c;var d="";for(i=0;i<n;i+=4){r=e.indexOf(t[i]);o=e.indexOf(t[i+1]);a=e.indexOf(t[i+2]);s=e.indexOf(t[i+3]);u=r<<2|o>>4;l=(o&15)<<4|a>>2;c=(a&3)<<6|s;if(a===64){d+=String.fromCharCode(u)}else if(s===64||s===-1){d+=String.fromCharCode(u,l)}else{d+=String.fromCharCode(u,l,c)}}return d};n.getBounds=function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect();var n=t.offsetWidth==null?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+n,left:e.left,width:n,height:t.offsetHeight==null?e.height:t.offsetHeight}}return{}};n.offsetBounds=function(t){var e=t.offsetParent?n.offsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}};n.parseBackgrounds=function(t){var e=" \r\n\t",n,i,r,o,a,s=[],u=0,l=0,c,d;var p=function(){if(n){if(i.substr(0,1)==='"'){i=i.substr(1,i.length-2)}if(i){d.push(i)}if(n.substr(0,1)==="-"&&(o=n.indexOf("-",1)+1)>0){r=n.substr(0,o);n=n.substr(o)}s.push({prefix:r,method:n.toLowerCase(),value:a,args:d,image:null})}d=[];n=r=i=a=""};d=[];n=r=i=a="";t.split("").forEach(function(t){if(u===0&&e.indexOf(t)>-1){return}switch(t){case'"':if(!c){c=t}else if(c===t){c=null}break;case"(":if(c){break}else if(u===0){u=1;a+=t;return}else{l++}break;case")":if(c){break}else if(u===1){if(l===0){u=0;a+=t;p();return}else{l--}}break;case",":if(c){break}else if(u===0){p();return}else if(u===1){if(l===0&&!n.match(/^url$/i)){d.push(i);i="";a+=t;return}}break}a+=t;if(u===0){n+=t}else{i+=t}});p();return s}},{}],27:[function(t,e,n){var i=t("./gradientcontainer");function r(t){i.apply(this,arguments);this.type=t.args[0]==="linear"?i.TYPES.LINEAR:i.TYPES.RADIAL}r.prototype=Object.create(i.prototype);e.exports=r},{"./gradientcontainer":9}],28:[function(t,e,n){function i(i){return new tt(function(t,e){var n=new XMLHttpRequest;n.open("GET",i);n.onload=function(){if(n.status===200){t(n.responseText)}else{e(new Error(n.statusText))}};n.onerror=function(){e(new Error("Network Error"))};n.send()})}e.exports=i},{}]},{},[4])(4)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"es6-promise":44}]},{},[47,89]);
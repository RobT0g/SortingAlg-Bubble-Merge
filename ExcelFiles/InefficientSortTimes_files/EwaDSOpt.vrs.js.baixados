'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1177:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi(".ewa-svg-icon{height:100%;width:100%}")}},1178:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1195:function(t,C,a){var c=a(10),b=a(0),f=a(718),e=a(53),d=a(39),h=a(197),r=a(60);class l{constructor(qb){this.cuh=qb}Oc(){return!1}executeCommand(qb,bc){qb=bc.command;bc=null;switch(qb){case 1243860697:this.cuh.f_j();break;default:bc=h.a(qb)}return bc||r.Task.Ua(!0)}Ac(qb,bc){return 1243860697===bc.command}Vc(){return!1}}Object(b.a)(l,"SheetDropdownMenuCommandHandler",null,[233]);var u=a(70),v=a(157),x=a(41);class w extends f.a{constructor(qb){super(qb)}Fd(){Object(u.b)("OfficeVSO:7624897_MigrateContextMenuController")?
void v.a.resolve(x.S,{rb:this.Na}).then(()=>{d.TaskExtensions.za(e.GetServiceTaskFactory.Sa(this.$.da,32,33,this.Na),qb=>{this.qd([new l(qb.result.mag)])},this.$.ka)}):this.$.Fz(qb=>{qb.hic().then(()=>{d.TaskExtensions.za(e.GetServiceTaskFactory.Sa(this.$.da,32,33,this.Na),bc=>{this.qd([new l(bc.result.mag)])},this.$.ka)})})}static la(qb){f.a.Yd(392,new w(qb))}}Object(b.a)(w,"SheetDropdownMenuCommandHandlerFactory",f.a,[]);var m=a(228),n=a(7),z=a(82),y=a(14),A=a(29),F=a(190),D=a(16),B=a(92),M=a(50),
R=a(246),P=a(169),E=a(114),H=a(43),G=a(425),N=a(89),I=a(15),O=a(37);class U{constructor(){this.qPe=new O.a(!0);this.rMc=0}get dad(){return this.rMc}get navigationButtonsDisabled(){return!!(this.dad&1)}get operationButtonsDisabled(){return!!(this.dad&2)}yWg(qb,bc){this.qPe.add(qb,bc);this.VS()}VS(){this.rMc=0;O.a.forEach(this.qPe.Qu,qb=>{this.rMc=this.dad|qb.value})}}Object(b.a)(U,"SheetTabBarDisabledStateManager",null,[]);var ca=a(245),Q=a(35);class Y{}Y.NDh="ewa-stb-uir";Y.zDh="ewa-stb-navarea";
Y.ADh="ewa-stb-navarea-dimensions";Y.CDh="ewa-stb-navbutton";Y.JU="cui-disabled";Y.BDh="ewa-stb-navareaextra";Y.sja="cui-img-container";Y.tDh="ewa-stb-contentarea";Y.AVe="ewa-stb-left-scrollable";Y.FVe="ewa-stb-right-scrollable";Y.LDh="ewa-stb-tabarea";Y.KDh="ewa-stb-sheettabmoveindicator";Y.HVe="ewa-stb-tabs";Y.KWj="tab-active";Y.SWj="tab-inactive";Y.RWj="tab-hover";Y.MDh="ewa-stb-tabs-ghost";Y.MWj="tab-anchor-text";Y.dark="dark";Y.light="light";Y.LWj="tab-active-text";Y.PWj="tab-content-container";
Y.UWj="tab-text";Y.EDh="ewa-stb-nsv-inactive-svg";Y.DDh="ewa-stb-nsv-active-svg";Y.lCh="ewa_nsv_margin";Y.uDh="ewa-stb-disable-scrollbar";Y.$Ei="leave-size-fixed-on-tab-hover-old";Y.ZEi="leave-size-fixed-on-tab-hover";Y.BVe="ewa-stb-locked-sheet-svg-16px";Y.vDh="ewa-stb-dropdown-menu-button";Y.yyh="ewa-active-sheet-menu-item";Object(b.a)(Y,"CssClassNames",null,[]);var la=a(759),ea=a(19),ha=a(272),X=a(94),T=a(199),ua=a(33),Ha=a(259),Ca=a(47),Ga=a(298),sa=a(54),bb=a(13),Ba=a(77),qa=a(1),pa=a(248),ya=
a(12),za=a(106),cb=a(357),Pa=a(21),nb=a(183),Ma=a(381),Oa=a(377),La=a(49),ra=a(229),V=a(91);class ma extends ca.a{constructor(qb,bc,sc=!1){super(qb);this.wcb=this.eua=null;this.$=bc;this.mY=sc}get disabled(){return this.mY}dispose(){this.wcb=this.eua=this.$=null;super.dispose()}NS(qb){this.mY=qb;this.domElement.setAttribute(n.a.Qta,qb.toString());bb.DOMElementExtensions.toggleCssClass(this.domElement,la.a.JU,qb)}}Object(b.a)(ma,"SheetBarButton",ca.a,[]);var W=a(736);class aa extends ma{constructor(qb,
bc,sc,Tb=!1){super(document.createElement("a"),bc,Tb);this.od=$a=>{this.disabled||this.$.Xc(-1935155518,$a.Cb,30,null);return!0};this.WFd=$a=>{$a="mouseover"===$a.type||"focus"===$a.type;const Nb=Ma.a(this.$)?this.wcb:this.eua;ya.HelperMethods.$ig(Nb,aa.Eia,aa.Eia+n.a.epd,$a&&!Pa.h(this.$).inRangePicker)};this.Ki=()=>{this.NS(!0)};this.Wf=()=>{qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)&&Pa.h(this.$).cellTextEditBox.jb||this.NS(!1)};this.eua=
sc.tb(this.domElement,I.a.instance.ha(509),0,aa.Eia,I.a.instance.ha(510),W.a.r6c,Tb);qb.appendChild(this.domElement);this.Pc.la("contextmenu",$a=>{Ba.g($a)});ra.a.instance.ta(D.a.click,this.domElement,this.od);this.Hma=E.KeyInputManager.instance.$t(this.domElement,this.od,V.a.Wh,V.a.TX);Pa.h(this.$).cellTextEditBox.An(this.Ki);qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)?Pa.h(this.$).cellTextEditBox.y1b(this.Wf):Pa.h(this.$).cellTextEditBox.Bm(this.Wf)}dispose(){ra.a.instance.Ba(D.a.click,
this.domElement,this.od);E.KeyInputManager.instance.Cx(this.domElement,this.Hma);Pa.h(this.$)&&Pa.h(this.$).cellTextEditBox&&(Pa.h(this.$).cellTextEditBox.sn(this.Ki),qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DetachEndEditInsertSheetButtonListener",!1)?Pa.h(this.$).cellTextEditBox.eOd(this.Wf):Pa.h(this.$).cellTextEditBox.km(this.Wf));super.dispose()}NS(qb){const bc=aa.Tag(this.$);super.NS(qb||bc)}static Tag(qb){return!qb.isEditMode||!qb.ua.count}}aa.Eia=ea.a.Zcd;Object(b.a)(aa,
"InsertSheetButton",ma,[]);class ia extends ma{constructor(qb,bc,sc){super(document.createElement("a"),bc);this.od=Tb=>{this.$.Xc(-684145703,Tb.Cb,0,null);return!0};this.WFd=Tb=>{ya.HelperMethods.$ig(this.yBe,ia.Eia,ia.Eia+n.a.epd,("mouseover"===Tb.type||"focus"===Tb.type)&&!Pa.h(this.$).inRangePicker)};this.$=bc;this.yBe=sc.tb(this.domElement,I.a.instance.ha(511),0,ia.Eia,I.a.instance.ha(512),W.a.r6c);qb.appendChild(this.domElement);this.Pc.la("contextmenu",Tb=>{Ba.g(Tb)});this.Pc.la("mouseover",
this.WFd);this.Pc.la("mouseout",this.WFd);ra.a.instance.ta(D.a.click,this.domElement,this.od);this.Hma=E.KeyInputManager.instance.$t(this.domElement,this.od,V.a.Wh,V.a.TX)}dispose(){ra.a.instance.Ba(D.a.click,this.domElement,this.od);E.KeyInputManager.instance.Cx(this.domElement,this.Hma);this.yBe=null;super.dispose()}}ia.Eia=ea.a.Zcd;Object(b.a)(ia,"InsertTemplateButton",ma,[]);class ka{constructor(qb,bc){this.sheetName=null;this.newSheetIndex=0;this.sheetName=qb;this.newSheetIndex=bc}getSheetName(){return this.sheetName}}
Object(b.a)(ka,"MacroRecorderSheetReorderedPayload",null,[145]);var Xa=a(98);class sb extends ca.a{constructor(qb,bc){super(document.createElement("div"));this.ZR=()=>{y.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.m0f(!1,"OnSheetsChanged")};this.dXi=()=>{this.Mi()};this.cXi=()=>{this.Oi()};this.$=qb;this.tXj=bc;this.jV=!1;this.dRb=0}dispose(){this.Oi();super.dispose()}f_j(){this.m0f(!0,"TogglerSheetDropdownMenu")}m0f(qb,bc){y.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${bc}, toggle: ${qb}, toggleStateId: ${this.dRb}`);
qb&&(this.dRb+=1);const sc=this.$.Rb.Qc("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${bc}, toggle: ${qb}, toggleStateId: ${this.dRb}, sheetCount: ${this.$.ua.count}`);qb=this.ilh();appChrome.renderSheetDropdownMenu(this.domElement,this.tXj,qb,this.dRb,this.dXi,this.cXi,()=>{sc.stop()},Ma.a(this.$))}ilh(){const qb=this.$.ua,bc=[];for(let Tb=0;Tb<qb.count;Tb++){var sc=Object(N.a)(za.a,qb.getItem(Tb));0===sc.YB&&(sc=this.hlh(sc),bc.push(sc))}return bc}hlh(qb){const bc={};bc.key=
qb.name;bc.text=qb.name;bc.onClick=this.jlh(qb);qb.active&&(bc.className=Ma.a(this.$)?"ewa-active-sheet-menu-item-present-mode":Y.yyh);return bc}jlh(qb){return()=>{const bc=new Xa.a(-1876836819,0,this.$.Bc,30,null);this.$.Ia.Nb(bc,{[n.a.yVd]:qb.name})}}Mi(){if(!this.jV){const qb=this.$.ua;qb.kg(this.ZR);qb.PZc(this.ZR);qb.TY(this.ZR);qb.Yha(this.ZR);qb.FHa(this.ZR);qb.Dte(this.ZR);qb.F_a(this.ZR);this.jV=!0}}Oi(){if(this.jV){const qb=this.$.ua;qb.Gg(this.ZR);qb.$Nd(this.ZR);qb.g8(this.ZR);qb.Aoa(this.ZR);
qb.oSa(this.ZR);qb.l_f(this.ZR);qb.ILb(this.ZR);this.jV=!1}}}Object(b.a)(sb,"SheetDropdownMenu",ca.a,[475,2]);var ib=a(361);class Ub extends ma{constructor(qb,bc,sc){super(document.createElement("a"),qb,!0);this.gg=()=>{this.NS(!1);this.$.ea.rn(this.gg)};this.od=Tb=>{this.ajg(Tb.Cb);return!0};this.onKeyDown=Tb=>13===Tb.Da.keyCode||32===Tb.Da.keyCode?(this.ajg(Tb.Cb),!0):!1;this.eua=bc.tb(this.domElement,I.a.instance.ha(513),0,ea.a.sDh,I.a.instance.ha(513),W.a.Cci,this.disabled);this.domElement.classList.add(Y.vDh);
sc.appendChild(this.domElement);this.ewh();this.olj()}dispose(){this.e4j();super.dispose()}NS(qb){super.NS(qb||!this.$.ea.bma)}ewh(){const qb=this.$.ea;qb.Bf?this.NS(!1):qb.mk(this.gg)}ajg(qb){this.disabled||(y.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${ib.a[qb]}`),this.$.Ia.Nb(new Xa.a(1243860697,qb,this.$.Bc,30,null)))}olj(){ra.a.instance.ta(D.a.click,this.domElement,this.od);E.KeyInputManager.instance.ta(D.a.fc,this.domElement,this.onKeyDown)}e4j(){ra.a.instance.Ba(D.a.click,
this.domElement,this.od);E.KeyInputManager.instance.Ba(D.a.fc,this.domElement,this.onKeyDown)}}Object(b.a)(Ub,"SheetDropdownMenuAnchor",ma,[]);var hc=a(65);const yb=(qb,bc,sc,Tb,$a,Nb,Ra,ob=null)=>{ob=qb.Oa(9,ob);ob.sheetName=bc;ob.newSheetIndex=sc;return hc.g(qb,"ReorderSheets",ob,Tb,$a,Nb,Ra,0)};var Gb=a(185),Sa=a(140),db=a(198),fb=a(134),ab=a(61),wb=a(216),kb=a(207),tb=a(177),hb=a(135);class Fb{constructor(qb){this.sheet=qb;this.altText=I.a.instance.ha(1994)}iW(){return this.sheet.active}jtd(){return this.sheet.isLockPausedInSession}Qpa(){return this.sheet.di?
W.a.CTf:W.a.R3j}NZd(){return 16}qua(){return null}rua(){return Y.BVe}q0d(){return null}Ts(){return null}t0c(){return!0}}Object(b.a)(Fb,"LockPausedSheetIconDataSource",null,[482]);class va{constructor(qb){this.sheet=qb;this.altText=I.a.instance.ha(1993)}iW(){return this.sheet.active}jtd(){return this.sheet.di}Qpa(){return W.a.CTf}NZd(){return 16}qua(){return null}rua(){return Y.BVe}q0d(){return null}Ts(){return null}t0c(){return!0}}Object(b.a)(va,"LockedSheetIconDataSource",null,[482]);class jb{constructor(qb,
bc,sc){this.sheet=qb;this.altText=I.a.instance.ha(1908);this.u_j=bc;this.VNj=sc}iW(){return this.sheet.active}jtd(){return this.sheet.Be.wB}qua(){return this.iW()?Y.DDh:Y.EDh}Qpa(){return!this.iW()&&this.VNj()?W.a.uKj:W.a.tKj}NZd(){return 14}rua(){return Y.lCh}q0d(){return this.sheet.Be.kpb}Ts(){return this.u_j}t0c(){return!1}}Object(b.a)(jb,"NamedSeetViewSheetIconDataSource",null,[482]);var Ab=a(170),Qa=a(138);class Z{constructor(qb,bc){this.wRc=this.u2=this.JCa=this.xp=null;this.lof=!1;this.eWc=
this.Qpa=this.rua=this.qua=null;this.YN=()=>{this.dataSource.iW()&&d.TaskExtensions.za(this.duf,()=>{dialogControls.renderToolTip(this.dataSource.Ts(),"SheetIconTooltip",this.dataSource.q0d(),this.HS,10,!1,!1,1)},this.$.ka,3)};this.XN=()=>{this.dataSource.iW()&&this.clearToolTip()};this.$=qb;this.dataSource=bc}get Pc(){return this.u2||(this.u2=Qa.a.instance.ke(this.HS))}get duf(){if(this.wRc)return this.wRc;const qb=new Ab.a;this.$.Fz(bc=>{d.TaskExtensions.za(bc.Otf(),()=>{qb.setResult(!0)},this.$.ka,
3)});return this.wRc=qb.task}get HS(){return this.eWc}wng(){if(this.HS&&(this.xp||this.JCa)){var qb=this.dataSource.Qpa();this.Qpa!==qb&&(this.JCa&&this.JCa.parentNode.removeChild(this.JCa),this.iif(),this.Qpa=qb);qb=this.dataSource.qua();this.qua!==qb&&(this.osj(this.JCa,this.qua,qb),this.qua=qb);qb=this.dataSource.rua();this.rua!==qb&&(this.nsj(this.HS,this.rua,qb),this.rua=qb);this.dataSource.Ts()&&!this.dataSource.iW()&&this.clearToolTip()}}nPj(qb,bc,sc){this.Ini(qb,bc,sc);bb.DOMElementExtensions.setVisible(this.HS,
this.dataSource.jtd())}clearToolTip(){d.TaskExtensions.za(this.duf,()=>{dialogControls.clearToolTip(this.dataSource.Ts())},this.$.ka,3)}Ini(qb,bc,sc){this.HS&&this.lof!==qb&&(this.HS.parentNode.removeChild(this.HS),this.rua=this.qua=this.Qpa=this.eWc=null,this.dataSource.Ts()&&(this.Pc.detach("mouseover",!0),this.Pc.detach("mouseout",!0)));this.HS||(this.eWc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.HS,la.a.sja),Sys.UI.DomElement.addCssClass(this.HS,ea.a.sz),qb===this.dataSource.t0c()?
bc.appendChild(this.HS):bc.insertBefore(this.HS,sc),this.iif(),this.dataSource.Ts()&&(this.Pc.la("mouseover",this.YN,!0),this.Pc.la("mouseout",this.XN,!0)),this.lof=qb)}osj(qb,bc,sc){qb&&(Sys.UI.DomElement.removeCssClass(qb,bc),Sys.UI.DomElement.addCssClass(qb,sc))}nsj(qb,bc,sc){bc&&Sys.UI.DomElement.removeCssClass(qb,bc);sc&&Sys.UI.DomElement.addCssClass(qb,sc)}dispose(){B.a.Ja(this.u2)}iif(){const qb=this.$.da.Aa(388);qb?(this.JCa=qb.ila(this.dataSource.Qpa(),this.dataSource.NZd()))?this.HS.appendChild(this.JCa):
y.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Qpa()} was not found.`):y.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(b.a)(Z,"SheetIcon",null,[2]);var wa=a(362),Ea=a(101),fa=a(168);class Ua extends Ea.a{constructor(qb,bc){super(qb.domElement);this.onKeyDown=sc=>{121===sc.keyCode&&sc.shiftKey&&!this.qpa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.qpa.anchor),
Ba.g(sc))};this.Oda=sc=>{if(!this.$.isEditMode||this.qpa.disabled)return!0;this.rename(!1,sc.Cb);return!0};this.gm=sc=>this.qpa.disabled?!0:this.showContextMenu(sc.clientPoint,sc.Cb,sc.Vb);this.yme=qb;this.$=bc;ra.a.instance.ta(D.a.Gk,qb.domElement,this.Oda);wa.a.instance.ta(qb.domElement,this.gm);this.Pc.la("keydown",this.onKeyDown)}get qpa(){return this.yme}dispose(){this.qpa&&(ra.a.instance.Ba(D.a.Gk,this.qpa.domElement,this.Oda),wa.a.instance.Ba(this.qpa.domElement,this.gm),this.yme=null);this.$=
null;super.dispose()}showContextMenu(qb,bc,sc){this.qpa.activate(bc,ua.a.Wpf());bc=new Xa.a(-1075099431,bc,this.$.Bc,30,null);let Tb;return!fa.a(Tb=this.$.Ia.Nb(bc,{[n.a.oag]:qb,[Ua.lKj]:this.qpa.sheet,[n.a.pag]:sc}))&&(6!==Tb.status||Tb.result)}rename(qb,bc){this.$.Xc(817296323,bc,qb?19:0,null)}}Ua.lKj="Sheet";Object(b.a)(Ua,"SheetOpsSheetClickHelper",Ea.a,[]);var Aa=a(42),Ib=a(62),Pb=a(109);class Fa extends ma{constructor(qb,bc,sc,Tb,$a){super(document.createElement("li"),qb);this.jKj=100;this.kKj=
500;this.RGe=this.QGe=0;this.CMe=.5;this.jV=this.wVd=!1;this.color=this.dMc=this.cK=this.JGb=this.aP=null;this.nlc=this.$mf=!1;this.K8b="#BEBBB8";this.DJc=null;this.onKeyDown=Nb=>13!==Nb.Da.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Xz=Nb=>32!==Nb.Da.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.YN=()=>{this.disabled||this.q1.xR||this.hpa(!0,void 0,"OnMouseOver")};this.XN=()=>{this.disabled||this.hpa(!1,void 0,"OnMouseOut")};this.hIb=()=>{this.q1.xR||(this.UTj(),Object(Ib.c)(this.sheet.sheetProcessedData)||
Pa.h(this.$).yBa(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.t7=()=>{this.ySe(!1);return!1};this.od=Nb=>{if(this.disabled)return!0;const Ra=Pa.h(this.$);this.sheet.active||3!==Nb.Cb||!ua.a.SOa()&&!this.$Db||Ra.jb||Ra.ni||Ra.kvb();this.activateSheet(Nb.Cb);return 3!==Nb.Cb};this.onPointerDown=Nb=>{if(this.disabled)return!0;this.ySe(!0);Pa.h(this.$).inRangePicker&&y.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var Ra=3===Nb.Cb;if(2===Nb.Cb||Ra&&this.yya)this.hpa(!0,!Ra,"OnPointerDown"),Ra=r.Task.delay(Ra?this.kKj:this.jKj).Fo(()=>!0),this.sDb&&(this.nlc=!0,this.q1.txc=d.TaskExtensions.za(Ra,()=>{this.nlc&&this.q1.R4i(this,Nb)},this.ka,11));return!1};this.qh=Nb=>{if(this.disabled||!this.sDb&&qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.nlc=!1;this.hpa(2===Nb.Cb,void 0,"OnPointerUp");this.q1.txc&&(d.TaskExtensions.za(this.q1.txc,()=>{this.q1.Q4i()},
this.ka,11),this.q1.txc=null);return!1};this.bO=()=>{this.nlc=!1;this.wVd||this.hpa(!1,void 0,"OnTouchMove");return!1};this.IFe=new Ua(this,qb);this.$Db=ua.a.$Db();this.QGe=18;this.RGe=20;this.$=qb;this.GZb=Tb;this.q1=$a;this.sDb=$a.zve();this.slh();this.ofh();this.dpd=qb.Rb.Dg("UserAction",this.name);this.itd=!1;bb.DOMElementExtensions.Yu(this.domElement,n.a.xr,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.cK);this.opa=new db.a;qb=new va(this.sheet);this.opa.add(new Z(this.$,
qb));this.$.ea.POb&&(qb=new Fb(this.sheet),this.opa.add(new Z(this.$,qb)));qb=new jb(this.sheet,this.q1.dBc,()=>this.color?Fa.BWd(this.color):!1);this.JGb=new Z(this.$,qb);this.opa.add(this.JGb);this.yya=this.q1.yya;this.gib();this.Hmj();this.CAe=new Ga.a(this.domElement,1);bc.insertBefore(this.domElement,sc);Ma.a(this.$)&&this.rog(!0)}get Ioh(){return this.dMc||(this.dMc=kb.a.pp("#F5F5F5"))}get name(){return this.aP.innerText}set name(qb){this.aP&&(this.aP.innerText=qb,this.YFc(),this.sog())}get sheet(){return this.GZb}get anchor(){return this.DJc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(qb){this.anchor.tabIndex=
qb}s_h(){return bb.DOMElementExtensions.Qf(this.anchor)?this.anchor:null}dispose(){if(this.jV){R.a.instance.Ba(D.a.pointerDown,this.domElement,this.onPointerDown);E.KeyInputManager.instance.Ba(D.a.fc,this.domElement,this.onKeyDown);E.KeyInputManager.instance.Ba(D.a.Ap,this.domElement,this.Xz);ra.a.instance.Ba(D.a.click,this.domElement,this.od);R.a.instance.Ba(D.a.QW,this.domElement,this.hIb);R.a.instance.Ba(D.a.OB,this.domElement,this.t7);if(this.sDb||qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))R.a.instance.Ba(D.a.og,
this.domElement,this.qh),this.yya&&(P.a.instance.Ba(D.a.Fe,this.domElement,this.qh),P.a.instance.Ba(D.a.wg,this.domElement,this.bO));this.jV=!1;this.K8b="#BEBBB8"}B.a.wc([this.IFe,this.CAe]);this.aP=this.cK=this.DJc=this.q1=this.CAe=this.IFe=null;if(this.opa){for(let qb of this.opa)qb.dispose();this.opa=null}this.color=this.GZb=null;super.dispose()}NS(qb){qb&&this.hpa(!1,!1);super.NS(qb)}Scg(qb){if(ab.a.Ag.wR){this.yPe();var bc=Object(u.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Object(Pb.d)(v.a.resolve(x.L,
{rb:1})):e.GetServiceTaskFactory.Sa(this.$.da,322,323,1);d.TaskExtensions.za(bc,sc=>{Gb.UISurfaces.OH().then(Tb=>{const $a=sc.result;$a.oGj(Tb);$a.show(qb);return null},Tb=>{y.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Tb}`);return null})},this.ka,3)}}tOg(){if(this.sheet.active&&this.$.Qp){var qb=this.$.Qp,bc=Pa.h(this.$),sc=bc.Dj;if(this.sheet.Be.wB){if(!this.JGb){const Tb=new jb(this.sheet,this.q1.dBc,()=>this.color?Fa.BWd(this.color):
!1);this.JGb=new Z(this.$,Tb);this.opa.add(this.JGb)}sc&&bc.Vhb(1);qb.classList.add(ea.a.TXe);qb=Fa.Q7e(n.a.mAf);bc=Fa.Q7e(n.a.pCd);"true"===qb&&"true"===bc?this.$.ea.rWd&&this.$.ea.gPb&&(this.sheet.Be.CN?(qb=1,Sa.a.Qs(n.a.pCd,"false",Sa.a.h0),this.$.ea.gPb=!1):qb=0,Sa.a.Qs(n.a.mAf,"false",Sa.a.h0),this.$.ea.rWd=!1,this.Scg(qb)):this.sheet.Be.CN&&"true"===bc&&this.$.ea.gPb&&(Sa.a.Qs(n.a.pCd,"false",Sa.a.h0),this.$.ea.gPb=!1,this.Scg(2))}else this.yPe(),sc&&bc.Vhb(0),qb.classList.remove(ea.a.TXe)}}yPe(){const qb=
Object(u.a)({xna:322,new:x.L,registry:this.$.da,j7g:"OfficeVSO:7629405_namedSheetViewPublic_Migration"});qb&&qb.dismiss()}gib(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.U8a()?Y.KWj:Y.SWj;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.aP.parentNode.classList.add(Y.ZEi):this.aP.parentNode.classList.add(Y.$Ei);this.sog();this.oPj();this.Aog();this.YFc();this.tOg()}P4i(){this.wVd=!0;this.hpa(!0,!0,"OnSheetReorderStarted")}O4i(){this.wVd=
!1;this.hpa(!1,void 0,"OnSheetReorderEnded")}activate(qb=0,bc=!1){this.G5b()||(this.sheet.activate(),bc&&Pa.h(this.$).focus(),qb={["InputMethod"]:ib.a[qb],["AppMode"]:this.$.Bc,["Location"]:"canvas"},hb.b(this.$).rd(fb.a.gKj,qb))}rog(qb){this.K8b=qb?"#797775":"#BEBBB8";this.CMe=qb?-.5:.5;this.dMc=qb?kb.a.pp("#3B3A39"):kb.a.pp("#F5F5F5");this.Aog()}YCj(qb){this.sDb=qb}SEd(qb){qb.H6c();this.WDe(qb)}WDe(qb){qb.s2a();this.sheet.activate()}CLg(qb){qb=new Xa.a(-1876836819,qb,this.$.Bc,30,null);return this.$.Ia.Nb(qb,
{[n.a.yVd]:this.sheet.name})}sog(){this.aP.parentNode.setAttribute("sheet-title",this.aP.innerText)}YFc(){const qb=this.RTh();this.anchor.setAttribute(n.a.wu,qb);this.anchor.setAttribute(n.a.oaa,this.sheet.active.toString())}RTh(){const qb=this.sheet.Be.wB,bc=this.sheet.Be.kpb,sc=this.sheet.di,Tb=this.sheet.isLockPausedInSession;return qb&&sc?String.format(I.a.instance.qb(20),this.name,bc):qb&&Tb?String.format(I.a.instance.qb(22),this.name,bc):qb?String.format(I.a.instance.qb(19),this.name,bc):sc?
String.format(I.a.instance.qb(18),this.name):Tb?String.format(I.a.instance.qb(21),this.name):this.name}activateSheet(qb=0){if(ua.a.Wpf()){if(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.G5b())return r.Task.Ua(!1);tb.a.current.zO="ActivateSheet";this.sheet.activate();return r.Task.Ua(!0)}return this.CLg(qb)}Aog(){const qb=this.sheet.tabColor;this.color=qb?kb.a.pp(qb):this.Ioh;this.$mf=Fa.BWd(this.color);this.hpa(!1,void 0,"UpdateTabColor")}hpa(qb,bc=
!1,sc=null){if(this.sheet){sc=this.sheet.active;var Tb=this.U8a(),$a=!!this.sheet.tabColor,Nb=kb.a.jJ(sc||Tb?wb.a.white:this.color);this.cK.style.background="";sc||Tb?($a&&(qa.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.eNa?this.cIj():this.bIj()),this.cK.style.height=this.QGe.toString()+"px"):(this.cK.style.filter="",this.cK.style.backgroundColor=Nb,this.cK.style.height=this.RGe.toString()+"px");this.aP.className=sc?Y.LWj:Tb?Y.dark:this.$mf?Y.light:
Y.dark;for(let Ra of this.opa)Ra.wng();qb&&!$a&&(this.cK.style.backgroundColor="#E1DFDD");bb.DOMElementExtensions.toggleCssClass(this.domElement,Y.RWj,qb);bc?($a||(this.cK.style.backgroundColor=this.K8b),this.domElement.style.backgroundColor=this.K8b):($a||(this.cK.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.aP.style.fontWeight=sc||Tb?"600":""}else y.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${sc}`)}bIj(){const qb=
this.cK.style,bc=kb.a.jJ(Fa.f7g(this.color,this.CMe));qb.background=bc}cIj(){this.cK.style.background="transparent"}ofh(){this.DJc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=Y.MWj;bb.DOMElementExtensions.Yu(this.anchor,n.a.Zqb,null,null);this.tabIndex=-1}slh(){this.cK=document.createElement("span");this.cK.className=Y.PWj;this.aP=document.createElement("span");this.aP.className=Y.UWj;this.aP.dir=this.sheet.rtlName?"rtl":"ltr";this.cK.appendChild(this.aP)}oPj(){const qb=
this.$.kM;for(let bc of this.opa)bc.nPj(qb,this.cK,this.aP)}U8a(){return Pa.h(this.$).U8a(this.sheet)}UTj(){this.dpd.start();this.itd=!0}ySe(qb){this.itd&&(this.dpd.stop(),y.ULS.sendTraceTag(537153686,0,50,Aa.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.dpd.Jc,["Has been clicked"]:qb})),this.itd=!1)}Hmj(){R.a.instance.ta(D.a.pointerDown,this.domElement,this.onPointerDown);E.KeyInputManager.instance.ta(D.a.fc,this.domElement,this.onKeyDown);E.KeyInputManager.instance.ta(D.a.Ap,
this.domElement,this.Xz);this.Pc.la("mouseover",this.YN);this.Pc.la("mouseout",this.XN);R.a.instance.ta(D.a.QW,this.domElement,this.hIb);R.a.instance.ta(D.a.OB,this.domElement,this.t7);if(this.sDb||qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))R.a.instance.ta(D.a.og,this.domElement,this.qh),this.yya&&(P.a.instance.ta(D.a.Fe,this.domElement,this.qh),P.a.instance.ta(D.a.wg,this.domElement,this.bO));ra.a.instance.ta(D.a.click,this.domElement,this.od);this.jV=
!0}G5b(){const qb=this.$.da.Aa(65);return qb&&qb.cma()?(qb.Oyc(),this.WDe(qb),!0):!1}static Q7e(qb){let bc=Sa.a.get(qb);bc||(Sa.a.Qs(qb,"true",Sa.a.h0),bc=Sa.a.get(qb));return bc}static f7g(qb,bc){if(1<bc||-1>bc)return qb;let sc=qb.r,Tb=qb.g;qb=qb.b;0<bc?(sc=sc*(1-bc)+255*bc,Tb=Tb*(1-bc)+255*bc,qb=qb*(1-bc)+255*bc):(sc*=1+bc,Tb*=1+bc,qb*=1+bc);return wb.a.wxb(Math.round(sc),Math.round(Tb),Math.round(qb))}static BWd(qb){return 128>=(222*qb.r+707*qb.g+71*qb.b)/1E3}}Object(b.a)(Fa,"SheetTabButton",ma,
[]);class da extends ma{constructor(qb,bc,sc){super(document.createElement("a"),bc);this.Eia=ea.a.Zcd;sc.tb(this.domElement,I.a.instance.ha(713),0,this.Eia,I.a.instance.ha(713),W.a.r6c,!0);qb.appendChild(this.domElement);this.Pc.la("contextmenu",Tb=>{Ba.g(Tb)})}}Object(b.a)(da,"WorkbookProtectionButton",ma,[]);var K=a(55),xa=a(46),rb=a(63);class Qb extends ca.a{constructor(qb,bc,sc=null){super(bc);this.sheetTabActivatePreviousHidden=I.a.instance.ha(722);this.sheetTabActivateNextHidden=I.a.instance.ha(724);
this.svgIconProvider=null;this.Dh=[];this.JN=Array(6);this.yCd=Array(6);this.QTa=this.pBb=this.oR=this.Gfb=this.EVd=this.DVd=this.Rm=null;this.isRtl=!1;this.nW=this.Dz=0;this.y$b=this.sxc=!1;this.duc=this.Poa=0;this.OM=this.G4=this.Bba=this.I$b=null;this.cgc=this.uD=0;this.sQb=null;this.vEb=-1;this.r4=null;this.ltc=0;this.$Cc=-1;this.koa=0;this.jva=new U;this.kQc=!1;this.txc=this.hBc=this.QOb=this.vme=this.l0=null;this.uee=!1;this.ume=null;this.OD=(Tb,$a)=>{this.dMf($a.item)};this.pAa=(Tb,$a)=>{Tb=
this.$.ua.na.index;for(let Nb=0,Ra=this.Dh.length;Nb<Ra;Nb++){const ob=this.GV(Nb);if(ob.name===$a.oldName){ob.name=$a.newName;this.Q0();Nb===Tb&&this.Zea(6);break}}};this.hMf=(Tb,$a)=>{(Tb=this.Mwb($a.item))&&Tb.gib()};this.iMf=(Tb,$a)=>{$a.visible?(this.ITa(!1),this.eMf($a.item)):this.dMf($a.item)};this.o7=Tb=>{this.xR?(this.r4=Tb,this.NRb()):(this.r4&&(this.duc+=this.r4.clientPoint.x-Tb.clientPoint.x),this.r4=Tb,Math.abs(this.duc)>=this.Vth&&this.NRb());return!0};this.bO=Tb=>{Tb.Da.preventDefault();
return!1};this.M5f=Tb=>{this.J5f(Tb,!0)};this.L5f=Tb=>{this.J5f(Tb,!1)};this.p7=Tb=>{if(this.xR){this.y$b=this.bui(Tb);let $a;Tb=($a=this.GV(this.uD+1))?$a.sheet:null;this.reorderSheets(Tb,this.uD+1===this.BVd,!0)}this.cV();return!0};this.Fj=(Tb,$a)=>{$a.RB&&this.g3d($a.RB);this.lAc(!1);this.Q0();$a.na&&(this.g3d($a.na),this.Zea(6),this.ea.Una())};this.ECf=(Tb,$a)=>{this.TGc($a.item)};this.FCf=(Tb,$a)=>{this.TGc($a.item)};this.GCf=(Tb,$a)=>{this.TGc($a.item)};this.zQa=(Tb,$a)=>{this.TGc($a.item)};
this.Zza=()=>{this.i5c()};this.yd=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.i5c();this.a9c();if(rb.d(this.$)||rb.e(this.$))xa.PageLoadTrackingInfo.instance.iX(n.a.mCa,["sheetTabBar"]),xa.PageLoadTrackingInfo.instance.hX(n.a.mCa,["sheetTabBar"]);this.J8c();this.Q0();this.ITa(!0);this.Zea(6)};this.Kk=()=>{this.isVisible&&(this.Q0(),this.Zea(6))};this.Gf=()=>{Object(G.a)(aa,this.oR)===X.m(this.$.Ue)&&this.J8c();for(const Tb of this.Dh)Tb.YCj(!X.m(this.$.Ue))};this.gMf=(Tb,$a)=>{this.esj($a.item,
$a.isUserOperation)};this.xIb=(Tb,$a)=>{this.eMf($a.item)};this.onKeyDown=Tb=>{switch(Tb.keyCode){case 9:var $a=this.domElement.querySelectorAll(bb.DOMElementExtensions.Uq);const Nb=bb.DOMElementExtensions.Pl($a);$a=bb.DOMElementExtensions.mB($a);bb.DOMElementExtensions.eCa(Tb,Nb,$a);break;case 39:case 37:bb.DOMElementExtensions.H8f(Tb,this.domElement.querySelectorAll(bb.DOMElementExtensions.Uq),39===Tb.keyCode?!this.isRtl:this.isRtl)}y.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${Tb.keyCode}`)};
this.onScroll=()=>{this.Rm.scrollLeft!==this.Poa&&this.wYj()};this.$N=Tb=>{if(Tb.ctrlKey||Tb.e4)return!1;this.Rm.scrollLeft+=Math.floor(30*Tb.SDa);if(this.xR){const $a=this.n6e("OnMouseWheel");$a&&this.QZd(0<Tb.SDa,$a.x+$a.width/2)}return!0};this.$F=(Tb,$a)=>{if(this.jva)this.hdf("PartialInteractivity",$a.iM?3:0);else{this.cV(!1);this.gUd($a.iM);for(const Nb of this.wze)Nb&&Nb.NS($a.iM);for(const Nb of this.Dh)Nb&&Nb.NS($a.iM)}};this.IHb=(Tb,$a)=>{Tb=0;$a.nqe&&(Tb=2|($a.mKj?1:0));this.hdf("ComponentRangePicker",
Tb)};this.$=qb;this.ea=this.$.ea;this.Q$b=!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.Apf=!this.$.Tv;this.uee=!A.a.Ww;this.Jvi=qa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.VPi=this.$.xa.SheetTabNavigateButtonLongKeyPressPeriodMS;this.UPi=this.$.xa.SheetTabNavigateButtonIntervalPeriodMS;this.Vth=this.$.xa.SheetTabDragStartPixelThreshold;this.pRa=this.qRa=-1;this.c7c=!1;this.svgIconProvider=
sc;this.NC=new Ga.a(this.domElement,3);this.domElement.classList.add(Y.NDh);this.bjh();this.Fgh();this.cjh();qa.EwaSettings.uN()&&document.getElementById(n.a.sca)||this.fkh();this.lAc(!0);this.yd(null,null);qb=this.$.ua;qb.kg(this.Fj);qb.PZc(this.Zza);qb.TY(this.OD);qb.Yha(this.xIb);qb.FHa(this.pAa);qb.Dte(this.gMf);qb.F_a(this.iMf);qb.qRg(this.hMf);qb.a_c(this.ECf);qb.Ate(this.FCf);qb.Bte(this.GCf);qb.Cte(this.zQa);this.$.rl(this.yd);this.$.GC(this.Kk);ha.a(this.$).ti(this);this.$.da.Ha(32,this);
qa.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.vu(this.Gf);this.gBc=this.De.ke(this.domElement);this.gBc.la("keydown",this.onKeyDown);La.a(this.$).iq()&&this.$F(null,new Oa.a(!0));La.a(this.$).ig.V$(this.$F);Pa.h(this.$).Yse(this.IHb);this.gBc.la("mousedown",Tb=>{Tb.preventDefault()});F.a.instance.ta(D.a.HD,this.domElement,this.$N);this.CVd=this.De.ke(this.Rm);this.CVd.la("scroll",this.onScroll);this.wYj=pa.b(()=>{this.Q0()},200,this.$.ka,Ca.a.rKj,
!0);this.$.qB(n.a.uRj);this.Apf&&(this.ume=new sb(this.$,this.QTa.domElement));xa.PageLoadTrackingInfo.instance.U0(n.a.mCa,["sheetTabBar"])}get rc(){return this.domElement}get Qf(){return this.isVisible}get je(){return Ha.a.AVd}get xR(){return this.kQc}get BVd(){return this.Dh.length}get dBc(){return this.vme}get yya(){return this.uee}get navigationButtonsDisabled(){return!!this.jva&&this.jva.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.jva&&this.jva.operationButtonsDisabled}get gQi(){return this.$.kM?
[ea.a.zVe,ea.a.DVe,ea.a.EVe,ea.a.yVe,ea.a.Uac,ea.a.Uac]:[ea.a.yVe,ea.a.EVe,ea.a.DVe,ea.a.zVe,ea.a.Uac,ea.a.Uac]}get zCd(){return this.$.kM?[null,W.a.AHe,W.a.yHe]:[null,W.a.yHe,W.a.AHe]}get VRf(){return this.$.kM?[null,W.a.BHe,W.a.zHe]:[null,W.a.zHe,W.a.BHe]}get aFb(){if(this.isRtl){if(A.a.NF)return 0;if(A.a.Nf)return-1*(this.Rm.scrollWidth-this.Rm.clientWidth);if(A.a.Ww)return this.Rm.scrollWidth-this.Rm.clientWidth;y.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get OMb(){if(this.isRtl){if(A.a.NF)return this.Rm.scrollWidth-
this.Rm.clientWidth;if(A.a.Nf||A.a.Ww)return 0;y.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Rm.scrollWidth-this.Rm.clientWidth}get wze(){return this.jva?[this.oR,this.pBb]:[this.oR,this.pBb,this.QTa]}get TWj(){return this.Dh.concat(this.QTa)}get mag(){return this.ume}tb(qb,bc,sc,Tb,$a,Nb,Ra=!1){qb.removeAttribute("Href");qb.setAttribute(n.a.Kd,n.a.rt);qb.className=Y.CDh;qb.title=bc;qb.tabIndex=0;Nb?sc=this.svgIconProvider.Fca(Nb,12,12,qb,
24,24):(bc=document.createElement("span"),bc.className=ea.a.Y9g,bc.classList.add(la.a.sja),bc.tabIndex=-1,qb.appendChild(bc),Nb=document.createElement("img"),Nb.src=sa.a.mf(sc),Nb.className=Tb,Nb.alt=$a,Nb.tabIndex=-1,bc.appendChild(Nb),sc=Nb);Ra&&qb.classList.add(la.a.JU);return sc}dispose(){if(this.$){var qb=this.$.ua;qb.Gg(this.Fj);qb.$Nd(this.Zza);qb.g8(this.OD);qb.Aoa(this.xIb);qb.oSa(this.pAa);qb.l_f(this.gMf);qb.ILb(this.iMf);qb.cqj(this.hMf);qb.nOd(this.ECf);qb.i_f(this.FCf);qb.j_f(this.GCf);
qb.k_f(this.zQa);this.$.lm(this.yd);this.$.gG(this.Kk);La.a(this.$)&&La.a(this.$).ig.Lea(this.$F);this.jva&&Pa.h(this.$).LZf(this.IHb);F.a.instance.Ba(D.a.HD,this.domElement,this.$N)}B.a.wc(this.yCd);this.yCd=null;if(this.JN)for(qb=0;qb<this.JN.length;qb++){const bc=bb.DOMElementExtensions.yK(this.JN[qb],this.domElement,!1,"a");bc&&M.a.uoa(bc)}B.a.Ja(this.NC);B.a.Ja(this.gBc);B.a.Ja(this.CVd);this.CVd=this.gBc=this.pBb=this.oR=this.NC=null;this.$&&this.cV(!1);this.Bba=null;this.ATd(null,"Dispose");
this.sQb=this.OM=this.I$b=null;this.i5c();this.Gfb=this.EVd=this.DVd=this.Rm=this.JN=this.$=this.ea=null;super.dispose()}pg(qb,bc){if(!bc){y.ULS.shipAssertTag(537153760,0,0<this.Dh.length,"There is no sheet tab button.");if(!this.Dh.length)return!1;qb=null;for(const sc of this.Dh)if(qb=sc.s_h())break;if(!qb)return y.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;bb.DOMElementExtensions.setFocus(qb)}return!bc}Gh(qb){return bb.DOMElementExtensions.Mf(this.rc,qb)}Bj(){}hk(){}reorderSheets(qb,
bc,sc){if(this.l0&&this.l0!==qb){const Tb=this.l0.index;this.dsj(this.l0,qb,bc);qb=qb?qb.index-1:bc?this.$.ua.count-1:0;Tb!==qb&&(this.yJi(Tb,qb,sc),this.Nwh(this.l0.name,qb))}}Qai(qb){qb=this.jka(qb);return-1!==qb&&this.Dz<=qb&&qb<=this.nW?this.Dh[qb].domElement:null}A8j(qb){for(var bc=0;bc<this.JN.length;bc++){const sc=this.JN[bc];if(sc&&this.svgIconProvider){const Tb=sc.parentNode;this.pZf(sc);Tb&&(this.JN[bc]=this.svgIconProvider.Fca(qb?this.VRf[bc]:this.zCd[bc],12,12,Tb,24,24))}}for(bc=0;bc<
this.Dh.length;bc++)this.Dh[bc].rog(qb);this.QTa&&this.QTa.eua&&this.qog(W.a.Dci,this.QTa,qb);this.oR&&this.oR.eua&&this.qog(W.a.fbh,this.oR,qb)}qog(qb,bc,sc){bc.wcb||(bc.wcb=this.svgIconProvider.Fca(qb,12,12,bc.eua.parentNode,24,24));bc.wcb&&(bb.DOMElementExtensions.setVisible(bc.eua,!sc),bb.DOMElementExtensions.setVisible(bc.wcb,sc))}R4i(qb,bc){var sc=Pa.h(this.$);const Tb=sc.inRangePicker,$a=ya.HelperMethods.Ko(bc);if(sc.jb&&!Tb){const Nb=sc.am?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";
let Ra=void 0;qa.EwaSettings.W8a&&(Ra=[Object(nb.a)(sc.cellTextEditBox.textBox.SCa)]);nb.b(this.$).jDa($a.rawEvent,Nb,Ra);sc.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}sc=this.yya&&3===bc.Cb;!(2===bc.Cb&&$a.button===Sys.UI.MouseButton.leftButton||sc)||Tb||this.xR||La.a(this.$).iq()||(sc&&qb.P4i(),this.vEb=bc.clientPoint.x,this.r4=bc,this.XZg(qb))}Q4i(){this.Q0()}zve(){return this.$.isEditMode&&!X.m(this.$.Ue)}Q0(){const qb=ya.HelperMethods.PR(()=>{this.w6j();this.HHj();this.gUd()});y.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${qb}`)}HHj(){const qb=this.nW===this.Dh.length-1;bb.DOMElementExtensions.toggleCssClass(this.Gfb,this.$.kM?Y.FVe:Y.AVe,!!this.Dz);bb.DOMElementExtensions.toggleCssClass(this.Gfb,this.$.kM?Y.AVe:Y.FVe,!qb)}gUd(qb=!1){const bc=!this.Dz,sc=this.nW===this.Dh.length-1;this.m9f(4,this.sheetTabActivatePreviousHidden,!bc);this.m9f(5,this.sheetTabActivateNextHidden,!sc);this.zAc(0,bc||qb);this.zAc(1,bc||qb);this.zAc(2,sc||qb);this.zAc(3,
sc||qb)}m9f(qb,bc,sc){if(qb=this.JN[qb]){bb.DOMElementExtensions.setVisible(qb,sc);var Tb=this.V7e(qb);Tb.title="img"===qb.nodeName?qb.alt=0<this.Dh.length&&sc?bc:"":qb.title=0<this.Dh.length&&sc?bc:"";Tb.tabIndex=sc?0:-1}}V7e(qb){return qb.parentNode}zAc(qb,bc){if(qb=this.JN[qb])qb=this.V7e(qb),void 0!==qb&&null!==qb&&(!this.Dh.length||bc?(qb.classList.add(la.a.JU),qb.setAttribute(n.a.Qta,"true")):(qb.classList.remove(la.a.JU),qb.setAttribute(n.a.Qta,"false")))}ITa(qb){const bc=this.$.kM?this.Dh.length-
1:0;let sc=this.z$e(this.$.kM?0:this.Dh.length-1);sc&&(sc.borderRightWidth=qb?"1px":"0");this.Dz!==this.nW&&(sc=this.z$e(bc))&&(sc.borderRightWidth="0")}pse(qb,bc){this.Dh||(this.Dh=[]);-1===bc?this.Dh.push(qb):this.Dh.splice(bc,0,qb)}g8b(qb,bc){let sc=-1,Tb=null;bc||(sc=this.A3h(qb.index),-1!==sc&&(Tb=this.CMa(sc)));qb=new Fa(this.$,this.Rm,Tb,qb,this);this.pse(qb,sc);bb.DOMElementExtensions.setVisible(qb.domElement,!0)}Zea(qb){const bc=ya.HelperMethods.PR(()=>{switch(qb){case 0:this.ezc(0);break;
case 1:this.ezc(this.Dz-1);break;case 2:this.ezc(this.Dz+1);break;case 3:this.scrollIntoView(this.Dh.length-1);break;case 4:this.Dz&&1<=this.Dh.length&&(this.aqe(this.Dz-1),this.TRd());break;case 5:this.nW!==this.Dh.length-1&&1<=this.Dh.length&&(this.aqe(this.nW+1),this.TRd());break;case 6:this.TRd()}});this.Q$b&&this.xR&&this.NRb();y.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${qb}, duration = ${bc}`)}aqe(qb){(qb=this.GV(qb))&&qb.activate()}BMh(qb){if(0===qb.YB){const bc=
this.$.ua;let sc=0;for(let Tb=0,$a=bc.count;Tb<$a;Tb++){const Nb=Object(N.a)(za.a,bc.getItem(Tb));if(Nb===qb)return sc;0===Nb.YB&&sc++}}return-1}pMh(qb){const bc=this.$.ua;for(let sc=qb.index+1,Tb=bc.count;sc<Tb;sc++)if(qb=Object(N.a)(za.a,bc.getItem(sc)),0===qb.YB)return qb;return null}jka(qb){for(let bc=0;bc<this.Dh.length;bc++){const sc=this.GV(bc);if(!sc)y.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${bc}] is null even though index is not out of bounds!`);
else if(sc.sheet===qb)return bc}return-1}Mwb(qb){qb=this.jka(qb);return this.GV(qb)}yJi(qb,bc,sc){const Tb={};Tb.a=this.$.xa.UserSessionId;Tb.b=sc;Tb.c=this.y$b;Tb.d=qb;Tb.e=bc;Tb.f=this.$.ua.count;K.b().gf(2,Tb,sc)}dsj(qb,bc,sc){const Tb=Object(N.a)(cb.a,this.$.ua);bc?(bc=bc.index,bc=qb.index<bc?bc-1:bc):bc=sc?Tb.count-1:0;Tb.reorderSheet(qb,bc,!0)}kFj(qb){Pa.h(this.$).Wg.Gp(qb)}XZg(qb){if(!this.sxc){const bc=this.domElement.ownerDocument.body;R.a.instance.ta(D.a.vk,document.documentElement,this.o7);
this.yya&&(P.a.instance.ta(D.a.wg,document.documentElement,this.o7),P.a.instance.ta(D.a.wg,this.domElement,this.bO));R.a.instance.ta(D.a.og,document.documentElement,this.p7);P.a.instance.ta(D.a.Fe,bc,this.p7);this.sxc=!0}this.l0=qb.sheet;this.y$b=!1;this.OM=null;this.I$b=qb;this.Bba=qb.domElement;this.ATd(bb.DOMElementExtensions.getBoundingClientRect(this.Bba),"BeginSheetTabButtonDrag")}cV(qb=!0){if(this.sxc){this.kFj(n.a.IV);const bc=this.domElement.ownerDocument.body;R.a.instance.Ba(D.a.vk,document.documentElement,
this.o7);this.yya&&(P.a.instance.Ba(D.a.wg,document.documentElement,this.o7),P.a.instance.Ba(D.a.wg,this.domElement,this.bO));R.a.instance.Ba(D.a.og,document.documentElement,this.p7);P.a.instance.Ba(D.a.Fe,bc,this.p7);this.kQc=this.sxc=!1}this.duc=0;this.y$b=!1;this.l0=null;this.Bba&&(this.Bba.style.visibility="visible",this.Bba=null);this.I$b=null;this.ATd(null,"EndSheetTabButtonDrag");this.OM&&(this.OM.parentNode&&this.OM.parentNode.removeChild(this.OM),this.OM=null);this.uuj(qb)}uuj(qb){this.bZd(qb);
this.uD=this.vEb=-1}Nwh(qb,bc){const sc=this.$.pa,Tb=sc?sc.va:null;this.$.userOperationManager.Tc(new T.a(557,0,($a,Nb,Ra)=>yb(Tb,qb,bc,$a,Nb,Ra,null),64,()=>new ka(qb,bc)),null)}GV(qb){return 0<=qb&&qb<this.Dh.length?this.Dh[qb]:null}z8h(qb){return(qb=this.GV(qb))?qb.sheet:null}CMa(qb){return(qb=this.GV(qb))?qb.domElement:null}z$e(qb){return(qb=this.CMa(qb))?qb.style:null}A3h(qb){const bc=this.$.ua;qb+=1;let sc=-1;const Tb=this.Dh?this.Dh.length:0;for(;qb<bc.count;){const $a=Object(N.a)(za.a,bc.getItem(qb));
if(0===$a.YB){for(sc=0;sc<Tb&&this.z8h(sc)!==$a;sc++);break}qb++}return-1===sc||sc===Tb?-1:sc}dMf(qb){var bc=this.Mwb(qb);bc&&(this.xR&&(y.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.cV()),this.Rm.removeChild(bc.domElement),bc=Array.indexOf(this.Dh,bc),this.Dh.splice(bc,1),this.Q0(),(!this.isRtl&&
bc===this.Dh.length||this.isRtl&&!bc)&&this.ITa(!0),this.Q$b&&this.xR?qb===this.l0?(this.cV(),this.Zea(6)):this.NRb():this.Zea(6))}eMf(qb){const bc=Object(N.a)(za.a,qb);this.xR&&(y.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.cV());if(0===bc.YB){this.ITa(!1);var sc=this.jka(qb);
-1===sc&&(y.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.g8b(bc,!1),sc=this.jka(qb));this.rdf(sc,!0)}}esj(qb,bc){const sc=this.Mwb(qb);sc&&(this.xR&&!bc&&(y.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.cV()),qb=this.GWj(qb,sc),!qa.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&qb&&bc&&qb.O4i())}GWj(qb,bc){var sc=Array.indexOf(this.Dh,bc);const Tb=this.BMh(Object(N.a)(za.a,qb));if(-1===Tb||-1===sc)return null;this.ITa(!1);({dNh:this.Dz,bEi:this.nW}=Qb.asj(sc,Tb,this.Dz,this.nW));bc&&bc.domElement.parentNode===this.Rm&&(this.Rm.removeChild(bc.domElement),this.Dh.splice(sc,1));bc=this.pMh(qb);sc=this.jka(bc);bc=new Fa(this.$,this.Rm,this.CMa(sc),Object(N.a)(za.a,
qb),this);this.pse(bc,sc);sc=this.jka(qb);this.rdf(sc,!1);return bc}Cxh(){const qb=this.Dh?this.Dh.length:0,bc=this.Dz,sc=this.nW;for(let Tb=0;Tb<qb;Tb++){const $a=this.GV(Tb),Nb=Tb>=bc;$a&&($a.tabIndex=Nb&&Tb<=sc?0:-1)}}i5j(){const qb=this.Dh?this.Dh.length:0;for(let bc=0;bc<qb;bc++){const sc=this.GV(bc);sc&&sc.gib()}}rdf(qb,bc){bc&&qb<=this.Dz&&this.Dz++;this.Cxh();this.ITa(!0);this.Q0();this.Q$b&&this.xR&&this.NRb()}lAc(qb){const bc=this.$.kM;if(qb||this.isRtl!==bc)this.isRtl=bc,this.domElement.classList.remove(this.isRtl?
ea.a.CVe:ea.a.GVe),this.domElement.classList.add(this.isRtl?ea.a.GVe:ea.a.CVe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.i5j();qb||this.ITa(!0);for(qb=0;qb<this.JN.length;qb++)0!==qb&&3!==qb&&4!==qb&&5!==qb&&this.n9f(qb)}bjh(){const qb=this.DVd=document.createElement("div");qb.className=Y.zDh;qb.classList.add(Y.ADh);this.domElement.appendChild(qb);this.ZKe(qb,1,717,716);this.ZKe(qb,2,719,718);this.Apf&&(this.QTa=new Ub(this.$,this,qb))}cjh(){const qb=this.EVd=document.createElement("div");qb.className=
Y.BDh;this.domElement.appendChild(qb);this.J8c()}fkh(){const qb=document.getElementById(n.a.hKj),bc=document.getElementById(n.a.iKj);qb&&!bc&&y.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${qb.parentNode.id}. progressBar div has child: ${!!qb.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(n.a.tVd)}`);const sc=ua.a.Fpf(this.$);if(sc&&qb&&bc)this.domElement.appendChild(qb),this.QOb=qb.firstChild,
this.hBc=document.getElementById(n.a.tVd),bc.style.visibility="visible";else{const Tb=document.createElement("div"),$a=document.createElement("div");Tb.className=ea.a.IDh;$a.className=ea.a.GDh;qa.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&($a.id=n.a.Cfb);$a.style.display="none";const Nb=document.createElement("div");Nb.className=ea.a.JDh;const Ra=document.createElement("div");Ra.className=ea.a.HDh;const ob=document.createElement("div");ob.className=ea.a.FDh;$a.appendChild(Nb);
$a.appendChild(Ra);$a.appendChild(ob);Tb.appendChild($a);this.domElement.appendChild(Tb);this.QOb=$a;this.hBc=Ra;y.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",sc,qb,bc)}}n9f(qb){var bc=this.JN[qb];if(bc){const sc=bc.parentNode;this.pZf(bc);bc=Ma.a(this.$)?this.VRf[qb]:this.zCd[qb];this.JN[qb]=this.svgIconProvider.Fca(bc,12,
12,sc,24,24)}}pZf(qb){(null===qb||void 0===qb?0:qb.parentNode)&&qb.parentNode.removeChild(qb)}Fgh(){const qb=this.Gfb=document.createElement("div");qb.className=Y.tDh;this.domElement.appendChild(qb);this.klh(qb)}klh(qb){const bc=document.createElement("div");bc.className=Y.LDh;bc.classList.add(Y.uDh);this.$.printingEnabled||bc.classList.add(Q.a.MXe);qb.appendChild(bc);this.Rm=document.createElement("ul");bb.DOMElementExtensions.Yu(this.Rm,n.a.Z0c,null,null);this.Rm.className=Q.a.HVe;bc.appendChild(this.Rm);
this.Vih();this.vme=document.createElement("div");this.dBc.id="SheetIconTooltipContainer";bc.appendChild(this.dBc)}Vih(){const qb=document.createElement("div"),bc=document.createElement("div"),sc=sa.a.o4e(ea.a.JEh);bc.className=ea.a.b$g;bc.appendChild(sc);qb.appendChild(bc);qb.className=Y.KDh;bb.DOMElementExtensions.setVisible(qb,!1);this.Rm.appendChild(qb)}a9c(){const qb=this.$.ua;for(let bc=0,sc=qb.count;bc<sc;bc++){const Tb=Object(N.a)(za.a,qb.getItem(bc));0===Tb.YB&&(this.g8b(Tb,!0),Tb.active&&
Tb.activate())}}i5c(){B.a.wc(this.Dh);this.Dh=[];this.nW=this.Dz=0}ZKe(qb,bc,sc,Tb){const $a=document.createElement("a");qb.appendChild($a);qb=this.zCd[bc];this.JN[bc]=this.tb($a,I.a.instance.ha(Tb),0,this.gQi[bc],I.a.instance.ha(sc),qb);if(5===bc||4===bc)bb.DOMElementExtensions.yK(this.JN[bc],$a,!1,"span").style.marginTop="10px";this.n9f(bc);sc=this.yCd[bc]=this.De.ke($a);R.a.instance.ta(D.a.pointerDown,$a,Ra=>Ra.ctrlKey&&this.vWi(bc)?!0:this.kJf(bc));R.a.instance.ta(D.a.og,$a,()=>this.lJf());P.a.instance.ta(D.a.Fe,
$a,()=>this.lJf());R.a.instance.ta(D.a.pointerOut,$a,()=>this.a5c());E.KeyInputManager.instance.ta(D.a.fc,$a,Ra=>13!==Ra.Da.keyCode&&32!==Ra.Da.keyCode||this.c7c?!1:(this.c7c=!0,this.kJf(bc)));E.KeyInputManager.instance.ta(D.a.Vd,$a,Ra=>13===Ra.Da.keyCode||32===Ra.Da.keyCode?(this.c7c=!1,this.a5c()):!1);const Nb=this.zve();Tb=Ra=>{"mouseup"===Ra.type&&this.xR||Ba.g(Ra);!$a.classList.contains(la.a.JU)&&Nb&&this.z1i(Ra,bc)};sc.la("mouseover",Tb);sc.la("mouseout",Tb);sc.la("focus",Tb);sc.la("blur",Tb);
Nb&&sc.la("mouseup",Tb)}bui(qb){let bc=!1;const sc=this.$.Df;sc&&(bc=H.a.vR(bb.DOMElementExtensions.getBoundingClientRect(sc),qb.clientPoint));return bc}NRb(){if(!this.OM){y.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.OM=this.Bba.cloneNode(!0);if(!this.l4f(this.OM,this.Bba,!0,"UpdateDragAndDropState"))return;this.Bba.style.visibility="hidden";this.OM.classList.add(Y.MDh);this.OM.style.borderRightWidth="";this.cgc=this.r4.clientPoint.x-
this.G4.width/2;this.OM.style.left=this.cgc+"px";this.uD=this.jka(this.l0);0>this.uD&&y.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Q$b&&(this.uD=this.jka(this.l0));var qb=bb.DOMElementExtensions.getBoundingClientRect(this.Rm);const bc=qb.x;qb=qb.x+qb.width;let sc=this.r4.clientPoint.x-this.G4.width/2;sc=Math.min(sc,qb-this.G4.width);sc=Math.max(sc,bc);this.OM.style.transform="translateX("+Math.abs(sc-this.cgc)*(this.cgc<sc?1:-1)+"px)";const Tb=
this.r4.clientPoint.x>this.vEb;let $a=this.r4.clientPoint.x;sc>=qb-this.G4.width?($a=qb-this.G4.width/2,this.QRd()||this.koa||(y.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.ltc=this.Rm.scrollLeft,this.koa=window.requestAnimationFrame(this.M5f))):sc<=bc?($a=bc+this.G4.width/2,this.PRd()||this.koa||(y.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.ltc=this.Rm.scrollLeft,this.koa=window.requestAnimationFrame(this.L5f))):this.koa&&(y.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.bZd());this.r4.clientPoint.x!==this.vEb&&(this.QZd(Tb,$a),this.vEb=this.r4.clientPoint.x);this.kQc=!0}QZd(qb,bc){let sc;for(;({e5b:sc}=this.Wth(bc,qb)).returnValue;)this.sQb=sc,this.pVg(qb)}pVg(qb){if(this.sQb){var bc=(qb?1:-1)*this.G4.width;if(qb&&!this.$.kM||!qb&&this.$.kM){var sc=
this.Bba;var Tb=this.uD+1;var $a=!0}else sc=(Tb=this.GV(this.uD+1))?Tb.domElement:null,Tb=this.uD-1,$a=!1;if(this.l4f(this.sQb,sc,$a,"AnimateSheetSwap")){y.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.uD} and other sheet-index ${Tb}. amount of sheets in the bar: ${this.BVd} isMovingRight: ${qb}`);0<=this.uD&&this.uD<this.Dh.length&&0<=Tb&&Tb<this.Dh.length?(qb=this.Dh[Tb],this.Dh[Tb]=this.Dh[this.uD],this.Dh[this.uD]=qb):(y.ULS.sendTraceTag(537153737,
0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.Dh.length}, ghostIndex: ${this.uD}, swappedSheetIndex: ${Tb}`),this.cV());this.uD=Tb;var Nb=this.sQb;Nb.style.transform="translateX("+bc+"px)";window.requestAnimationFrame(()=>{Nb.style.transform="translateX(0px)"})}}}l4f(qb,bc,sc,Tb){const $a=Nb=>Nb?`Node ID: ${Nb.id} , Node class: ${Nb.className}, Node name: ${Nb.nodeName},`:null;try{return this.Rm.insertBefore(qb,bc),!0}catch(Nb){return qb=this.Mwb(this.l0),y.ULS.sendTraceTag(537153736,
0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",qb?qb!==this.I$b?"Changed":"NoChange":"Removed",Tb,$a(bc),$a(bc.parentNode),$a(this.Rm),sc,this.uD,this.BVd,Nb),this.cV(),!1}}Wth(qb,bc){var sc=this.$.kM===bc?this.GV(this.uD-
1):this.GV(this.uD+1);if(!sc)return{returnValue:!1,e5b:null};sc=sc.domElement;const Tb=bb.DOMElementExtensions.getBoundingClientRect(sc);return this.G4?bc?{returnValue:qb+this.G4.width/2>=Tb.x+.5*Tb.width,e5b:sc}:{returnValue:qb-this.G4.width/2<=Tb.x+.5*Tb.width,e5b:sc}:(y.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.cV(),{returnValue:!1,e5b:sc})}J5f(qb,bc){let sc;
sc=bc?this.M5f:this.L5f;if(-1===this.$Cc)this.$Cc=qb,this.koa=window.requestAnimationFrame(sc);else{qb=Math.floor((qb-this.$Cc)/1E3*300);var Tb=this.OMb>this.aFb?1:-1;this.scrollLeft(Math.abs(this.Rm.scrollLeft-(bc?this.ltc+qb*Tb:this.ltc-qb*Tb))*(bc?-1:1));if(qb=this.n6e("ScrollStep"))this.QZd(bc,qb.x+qb.width/2),bc&&!this.QRd()||!bc&&!this.PRd()?this.koa=window.requestAnimationFrame(sc):(y.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.bZd())}}QRd(){const qb=this.OMb>this.aFb;return qb&&this.Poa>=this.OMb||!qb&&this.Poa<=this.OMb}PRd(){const qb=this.OMb>this.aFb;return qb&&this.Poa<=this.aFb||!qb&&this.Poa>=this.aFb}bZd(qb=!0){this.Rm&&(this.Poa=this.Rm.scrollLeft);window.cancelAnimationFrame(this.koa);this.koa=0;this.$Cc=-1;qb&&this.Q0()}ATd(qb,bc){qb||y.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${bc}`);this.G4=qb}vWi(qb){return 2===qb?(this.Zea(3),
!0):1===qb?(this.Zea(0),!0):!1}kJf(qb){y.ULS.shipAssertTag(537153732,0,-1===this.qRa&&-1===this.pRa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.qRa&&(window.clearTimeout(this.qRa),this.qRa=-1);-1!==this.pRa&&(window.clearInterval(this.pRa),this.pRa=-1);this.Zea(qb);this.qRa=window.setTimeout(()=>{this.jUj(qb)},this.VPi);return!0}jUj(qb){this.pRa=window.setInterval(()=>{this.Zea(qb)},this.UPi)}lJf(){this.a5c();
return!this.xR}a5c(){window.clearTimeout(this.qRa);window.clearInterval(this.pRa);this.pRa=this.qRa=-1;return!0}z1i(qb,bc){const sc=this.ukc(bc),Tb=5===bc;"mouseup"!==qb.type||!Tb&&4!==bc||(sc||this.reorderSheets(null,Tb,!1),this.cV())}ukc(qb){return!!bb.DOMElementExtensions.djd(this.JN[qb],"a").title}TGc(qb){this.g3d(qb);this.Q0()}g3d(qb){(qb=this.Mwb(qb))&&qb.gib()}TRd(){var qb=this.$.ua;if(qb.na&&(!rb.e(this.$)||qb.count))if(qb=this.jka(qb.na),-1===qb)y.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");
else{var bc=this.CMa(qb);qb<this.Dz?this.ezc(qb):qb>this.Dz&&!this.Gvd(bc)&&this.scrollIntoView(qb)}}w6j(){this.Dz=0;this.nW=this.Dh.length-1;let qb=!1;for(let bc=0;bc<this.Dh.length;bc++){const sc=this.GV(bc);if(!sc)break;const Tb=this.Gvd(sc.domElement);sc.tabIndex=Tb?0:-1;if(!qb&&Tb)this.Dz=bc,qb=!0;else if(qb&&!Tb){this.nW=bc-1;break}}}ezc(qb){this.$.ua.count&&(this.Dh.length||this.a9c(),this.B7f(this.CMa(Math.max(0,Math.min(qb,this.Dh.length-1)))),this.Q0())}scrollIntoView(qb){y.ULS.shipAssertTag(537153697,
0,qb>=this.Dz,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.ua.count){this.Dh.length||this.a9c();var bc=this.CMa(Math.max(0,Math.min(qb,this.Dh.length-1))),sc=this.CMa(this.Dz);if(!this.Gvd(bc)){bc=bb.DOMElementExtensions.getBoundingClientRect(bc);var Tb=bb.DOMElementExtensions.getBoundingClientRect(this.Gfb);bc=this.isRtl?Tb.x-bc.x:bc.x+bc.width-(Tb.x+Tb.width);for(Tb=0;sc&&Tb<bc;){const $a=bb.DOMElementExtensions.getBoundingClientRect(sc);
Tb+=$a.width;sc=sc.nextSibling}sc?this.B7f(sc):y.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.Dz}, lastVisibleSheetTabIndex = ${this.nW}, scroll to index: ${qb}`)}this.Q0()}}B7f(qb){const bc=bb.DOMElementExtensions.getBoundingClientRect(this.Rm);qb=bb.DOMElementExtensions.getBoundingClientRect(qb);this.isRtl?this.scrollLeft(Math.floor(bc.x+bc.width-(qb.x+qb.width+.5))):this.scrollLeft(Math.ceil(bc.x-qb.x-.5))}scrollLeft(qb){(0>
qb&&this.QRd()||0<qb&&this.PRd())&&y.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const bc=this.Rm.scrollLeft;if(this.isRtl){if(A.a.NF||A.a.Nf){this.Rm.scrollLeft=this.Poa=bc-qb;return}if(A.a.bI){this.Rm.scrollLeft=this.Poa=bc+qb;return}y.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Rm.scrollLeft=this.Poa=bc-qb}Gvd(qb){qb=bb.DOMElementExtensions.getBoundingClientRect(qb);const bc=
bb.DOMElementExtensions.getBoundingClientRect(this.Gfb);return qb&&bc?qb.x>=bc.x-1&&qb.x+qb.width<=bc.x+bc.width+1:(y.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}wjh(){const qb=this.EVd;aa.Tag(this.$)?(B.a.Ja(this.oR),this.oR=new aa(qb,this.$,this,!0)):(B.a.Ja(this.oR),X.m(this.$.Ue)?this.oR=new da(qb,this.$,this):this.oR=new aa(qb,this.$,this))}iLe(qb,bc){var sc=this.$.ua;if(!this.$.isEditMode||!sc.count)B.a.Ja(bc),
bc=null;else if(!bc)if(sc=this.DVd,X.m(this.$.Ue))bc=new da(sc,this.$,this);else switch(qb){case 0:bc=new aa(sc,this.$,this);break;case 1:bc=new ia(sc,this.$,this);break;default:y.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return bc}J8c(){this.Jvi?(this.oR=this.iLe(0,this.oR),this.pBb=this.iLe(1,this.pBb)):this.wjh()}n6e(qb){const bc=
bb.DOMElementExtensions.getBoundingClientRect(this.OM);bc||(y.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${qb}: GetBoundingClientRect returned null for the dragged sheet.`),this.cV());return bc}hdf(qb,bc){this.jva.yWg(qb,bc);this.cV(!1);this.gUd(this.navigationButtonsDisabled);for(const sc of this.TWj)sc&&sc.NS(this.navigationButtonsDisabled);for(const sc of this.wze)sc&&sc.NS(this.operationButtonsDisabled)}static asj(qb,bc,sc,Tb){qb<sc?(bc>sc&&sc--,bc>Tb&&Tb--):qb>Tb?(bc<sc&&sc++,bc<Tb&&
Tb++):bc<sc&&sc++;return{dNh:sc,bEi:Tb}}}Object(b.a)(Qb,"SheetTabBarControl",ca.a,[444,2,36]);class pc extends m.a{constructor(qb){super();this.$=qb;this.Mb()}create(){const qb=this.$.Ib;if(z.a(this.$.xa,1))xa.PageLoadTrackingInfo.instance.Oea(n.a.mCa,["sheetTabBar"]);else{var bc=document.getElementById(qb+n.a.g$c);if(bc){xa.PageLoadTrackingInfo.instance.$Ba(n.a.mCa);var sc=e.GetServiceTaskFactory.Sa(this.$.da,388,387,this.Na);d.TaskExtensions.za(d.TaskExtensions.Pd([sc],this.$.ka),()=>{this.vb(this.$.da.Aa(32)||
new Qb(this.$,bc,sc.result))},this.$.ka,3)}else xa.PageLoadTrackingInfo.instance.Oea(n.a.mCa,["sheetTabBar"])}}static la(qb){qb.da.Ha(33,new pc(qb))}}Object(b.a)(pc,"SheetTabBarFactory",m.a,[]);a.d(C,"a",function(){return Lb});const Lb=()=>{c.a.Fa(qb=>{pc.la(qb);w.la(qb)})}},1218:function(t,C,a){var c=a(10);t=a(0);var b=a(228),f=a(53),e=a(39),d=a(1),h=a(2),r=a(573),l=a(15),u=a(14),v=a(6),x=a(569),w=a(383),m=a(621);class n{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(t.a)(n,"ColorCellProps",
null,[]);var z=a(425),y=a(19),A=a(54),F=a(216),D=a(207),B=a(34),M=a(232),R=a(89),P=a(217),E=a(269),H=a(12),G=a(357),N=a(23),I=a(21);class O{constructor(pa){this.mKc=null;this.$=pa;this.grid=I.h(this.$)}get borderFormatManager(){this.mKc||(this.mKc=this.$.da.Aa(296));return this.mKc}E0h(pa){let ya=null;switch(pa){case 467002767:pa={};this.$.gk(pa);ya=Object(R.a)(G.a,this.$.ua).A$e(pa.SheetName,!0);break;case -236759591:ya=this.IUh();break;case 1970784898:ya=this.d6e(0);break;case 1650812936:case 1378078823:ya=
this.d6e(1);break;case -400966242:ya=this.getShapeOutlineColor();break;default:u.ULS.sendTraceTag(537154460,0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${pa}'`)}return ya}IUh(){let pa=null;this.borderFormatManager&&(pa=this.borderFormatManager.o4);(pa="black"===pa?"000000":pa)&&(pa=B.a.n6a(pa));return pa}getShapeOutlineColor(){let pa=null;if(this.grid.ga.Ra&&this.grid.ga.Ra.oc){const ya=this.grid.ga.Ra.oc.floatingObject;5===ya.type&&
ya.Gb&&-1!==ya.Gb.ShapeOutlineColor&&(pa=D.a.wG(ya.Gb.ShapeOutlineColor),pa=pa.toUpperCase())}return pa}d6e(pa){let ya=null;if(this.grid.ga.Ra&&this.grid.ga.Ra.oc){var za=this.grid.ga.Ra.oc.floatingObject;5===za.type&&za.Gb?1===pa&&-1!==za.Gb.ShapeFillColor?(ya=D.a.wG(za.Gb.ShapeFillColor),ya=ya.toUpperCase()):u.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):u.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");
return ya}za=this.grid.hba("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ga.qa.selectedRanges,1,!0);try{for(za.$$rst();za.$$mn();){const cb=za.$$cu().cell;if(!cb)continue;let Pa="#000000";if(0===pa){Pa=cb.color;if(d.EwaSettings.zb()&&this.grid.jb)return this.v_h();cb.hasRichText&&(Pa=this.w_h(cb))}else if(1===pa){const nb=cb.backgroundColor;Pa=N.a.compare(nb,"transparent",!0)&&nb?cb.backgroundColor:null}if(!ya)ya=Pa;else if(ya!==Pa){ya=null;break}}}finally{za&&za.dispose()}return ya}v_h(){var pa=
null,ya=this.grid.hc,za=this.grid.cellTextEditBox.formattedText;if(za){pa=za.TextRuns;const cb=M.a.map(pa,Pa=>Pa.StartIndex);za=za.Fonts;ya=ya.textBox.caretPosition;ya=H.HelperMethods.r_e(new P.a(cb),cb.length,ya,H.HelperMethods.WF);pa=za[pa[ya].FontID].Color}return pa?pa.toUpperCase():null}w_h(pa){pa=E.a(pa.formattedText.Fonts);if(E.e(pa,32))(pa=D.a.Uea(D.a.wG(pa.FontColor)))&&(pa="#"+pa.toUpperCase());else return null;return pa}}Object(t.a)(O,"ColorHighlighterHelper",null,[721]);var U=a(324);class ca{constructor(pa,
ya,za){this.Cvc=this.XPb=this.VCa=null;this.i6f="-1";this.$=pa;this.moreColorsHelper=ya;this.themesManager=za;this.SGe=new O(pa);this.DD=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}D7e(pa,ya=null,za=null,cb=null,Pa=null,nb=null,Ma=null,Oa=null,La=null){return this.uQ(null!=ya,null!=za,null!=cb,null!=Oa,!0,pa,ya,za,cb,Pa,nb,Ma,Oa,La)}Z8h(pa,ya,za,cb){return this.uQ(pa,ya,za,cb,!1)}E7e(pa,ya=null,za=null,cb=null,Pa=null,nb=null){const Ma=[];pa=this.D7e(pa,ya,za,cb,void 0,
void 0,void 0,Pa,nb);for(let Oa=0,La=pa.length;Oa<La;Oa++)Ma.push(U.r(pa[Oa]));return Ma}uQ(pa,ya,za,cb,Pa,nb=null,Ma=null,Oa=null,La=null,ra=null,V=null,ma=null,W=null,aa=null){u.ULS.shipAssertTag(537154456,0,!Pa||null!=nb,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");const ia=[];let ka=null,Xa=3,sb=null,ib=null,Ub=null;this.Dxh();if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.$&&this.$.isEditMode&&!this.Cbj(aa))return u.ULS.sendTraceTag(537154455,
0,50,`Theme Info not present at the time of ${aa} menu opening`),ia;pa&&(Pa&&null==Ma?u.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):ia.push(this.AMa(ca.mZg,this.qQh(ca.oze,Ma,ma,V))));Pa&&null!=nb&&this.pmf()&&this.SGe&&(ib=sb="-1",ka=this.SGe.E0h(nb))&&(u.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${nb} is not null .`),ka=D.a.Uea(ka),Xa=this.I6e(ka),sb=this.jld(ka,Xa,0,!0),
ib=this.jld(ka,Xa,1,!1));ia.push(this.AMa(ca.mYj,this.Pgd(ca.dig,sb,this.VCa,nb,ra,V),1341));ia.push(this.AMa(ca.ETj,this.Pgd(ca.DTj,ib,this.XPb,nb,ra,V),1342));this.$&&this.$.isEditMode&&this.moreColorsHelper&&(this.Abj(),Pa&&this.pmf()&&(Ub="-1",ka&&(Ub=this.jld(ka,Xa,2,!0))),this.moreColorsHelper&&this.moreColorsHelper.iFb&&0<this.moreColorsHelper.iFb.count&&ia.push(this.AMa(ca.yjj,this.Pgd(ca.xjj,Ub,this.Cvc,nb,ra,V),1349)));ya&&(Pa&&null==Oa?u.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):
ia.push(this.AMa(ca.PQi,this.tQh(ca.hFe,Oa,this.eWh(Oa),ma,V))));za&&(v.AFrameworkApplication.Fs("XLS-HighlightWhenCFExperiment-Treatment;XLS-HighlightWhenCFExperiment-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HighlightWhenCFExperiment",!1)&&(Pa&&!La?u.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):ia.push(this.AMa(ca.wii,this.WQh(ca.Fff,La)))));cb&&(Pa&&null==W?u.ULS.shipAssertTag(537154451,
0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):ia.push(this.AMa(ca.OOi,this.vRh(ca.Bzf,W,this.T2h(W)))));return ia}jld(pa,ya,za,cb){3===ya&&(ya=this.I6e(pa));return this.DD&&0===za&&ya===za?this.i6f.toLowerCase():ya===za?cb?pa.toLowerCase():pa:"-1"}I6e(pa){if(!pa)return 3;const ya=pa.toLowerCase();if(this.DD){if(this.VCa&&this.jBi(ya,this.VCa))return 0}else if(this.VCa&&this.Urd(ya,this.VCa))return 0;return this.XPb&&this.Urd(pa,this.XPb)?1:this.Cvc&&
this.Urd(ya,this.Cvc)?2:3}AMa(pa,ya,za=null){pa=Object(h.a)(new x.a,{Id:pa,Title:null!=za?l.a.instance.ha(za):"",ControlList:[],ControlsId:pa+".Controls"});pa.ControlList.push(ya);return pa}tQh(pa,ya,za,cb=null,Pa=null){return this.b2e(pa,ya,za,y.a.NVe,"transparent",cb,Pa)}WQh(pa,ya){return Object(h.a)(new w.a,{Command:null!=ya?ya.toString():null,LabelText:l.a.instance.ha(1433),Id:pa,ExternalId:this.W5a(pa,ya),ExternalImageId:"JotNotebookColor2_20"})}qQh(pa,ya,za=null,cb=null){return this.b2e(pa,
ya,542,y.a.MVe,"000000",za,cb)}b2e(pa,ya,za,cb,Pa,nb=null,Ma=null){return Object(h.a)(new w.a,{Command:null!=ya?ya.toString():null,CommandPreviewId:null!=nb?nb.toString():null,CommandRevertId:null!=Ma?Ma.toString():null,MenuItemsStatefulData:this.F2h(pa,ya,Pa),LabelText:l.a.instance.ha(za),Id:pa,ExternalId:this.W5a(pa,ya),Image16by16:A.a.mf(1),Image16by16Class:cb})}F2h(pa,ya,za){const cb={};pa=this.W5a(pa,ya);cb[pa]={};cb[pa].iconColor=za;return cb}Urd(pa,ya){for(let za=0;za<ya.length;za++)if(pa===
ya[za].Color)return!0;return!1}vzi(pa,ya){pa=D.a.pp(pa);ya=D.a.pp(ya);return 1>=Math.abs(pa.r-ya.r)&&1>=Math.abs(pa.g-ya.g)&&1>=Math.abs(pa.b-ya.b)?!0:!1}jBi(pa,ya){for(let za=0;za<ya.length;za++){const cb=ya[za].Color;if(this.vzi(pa,cb))return this.i6f=cb.toLowerCase(),!0}return!1}Pgd(pa,ya,za,cb,Pa=null,nb=null){return Object(h.a)(new m.a,{McuLayout:!0,Command:null!=cb?cb.toString():null,CommandPreviewId:null!=Pa?Pa.toString():null,CommandRevertId:null!=nb?nb.toString():null,Width:10,Id:`${pa}.ColorPicker`,
SelectedColorId:ya,Colors:za,Stateful:!0,ExternalId:this.W5a(pa,cb),McuExternalId:`${this.W5a(pa,cb)}.MCU`})}W5a(pa,ya){return`${pa}.${null!=ya?ya.toString():""}`}ldc(...pa){const ya=[];for(let za=0,cb=pa.length;za<cb;za+=2)ya.push(Object(h.a)(new n,{Color:pa[za],DisplayColor:D.a.jJ(F.a.wF(parseInt(String("0x"+pa[za]),16))),Alt:Object(z.a)(String,pa[za+1])&&this.$?pa[za+1]:l.a.instance.ha(pa[za+1])}));return ya}vRh(pa,ya,za){const cb=y.a.dWe;pa=Object(h.a)(new w.a,{Command:null!=ya?ya.toString():
null,LabelText:l.a.instance.ha(za),Id:pa,ExternalId:this.W5a(pa,ya),Image16by16:A.a.mf(1),Image16by16Class:cb});pa.ShouldTakeFocus=!1;return pa}Dxh(){this.VCa||(this.VCa=this.ldc("ffffff",1360,"000000",1361,"e6e6e7",1362,"6a5444",1363,"c47244",1364,"317ded",1365,"a5a5a5",1366,"00c0ff",1367,"d59b5b",1368,"47ad70",1369,"f2f2f2",1370,"808080",1371,"ceced0",1372,"e4dcd6",1373,"f2e1d9",1374,"d6e4fc",1375,"ededed",1376,"ccf2ff",1377,"f7ebdd",1378,"daefe2",1379,"d9d9d9",1380,"595959",1381,"aaaaae",1382,
"cab9ac",1383,"e7c6b4",1384,"adcbf8",1385,"dbdbdb",1386,"99e6ff",1387,"eed7bd",1388,"b4e0c6",1389,"bfbfbf",1390,"404040",1391,"717175",1392,"b09784",1393,"dba98e",1394,"84b0f4",1395,"c9c9c9",1396,"66d9ff",1397,"e6c29b",1398,"8ed0a9",1399,"a6a6a6",1400,"262626",1401,"38383a",1402,"4f3f33",1403,"965430",1404,"1159c6",1405,"7b7b7b",1406,"008fbf",1407,"b5752f",1408,"358254",1409,"808080",1410,"0d0d0d",1411,"161616",1412,"352b22",1413,"643720",1414,"0c3c83",1415,"525252",1416,"006080",1417,"784e1f",1418,
"235637",1419));this.XPb||(this.XPb=this.ldc("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}Abj(){this.moreColorsHelper.Fed();if(this.moreColorsHelper.iFb){var pa=this.moreColorsHelper.iFb;const ya=[];for(let za of pa)pa=D.a.Uea(za.substr(1)),ya.push(pa,za);this.Cvc=this.ldc(...ya)}}Cbj(pa){this.themesManager.Vbc(pa);if(this.themesManager.Vgb&&this.themesManager.eig&&!this.themesManager.Mvd){pa=this.themesManager.Vgb;
const ya=this.themesManager.eig,za=[];for(let cb=0;cb<pa.count;cb++)za.push(pa.ma(cb),ya.ma(cb));this.VCa=this.ldc(...za);return!0}return!1}T2h(pa){switch(pa){case -458147525:pa=1344;break;case 1610379174:pa=1345;break;default:pa=1343}return pa}eWh(pa){switch(pa){case 1549407384:pa=541;break;case -1744769642:pa=539;break;default:pa=540}return pa}pmf(){return d.EwaSettings.ya(580)}}ca.PQi="NoColor";ca.mZg="Automatic";ca.mYj="ThemeColors";ca.ETj="StandardColors";ca.yjj="RecentColors";ca.hFe="ClearColor";
ca.wii="HighlightWhen";ca.Fff="HighlightWhen";ca.oze="AutomaticColor";ca.dig="ThemeColorPicker";ca.DTj="StandardColorPicker";ca.OOi="MoreColors";ca.Bzf="MoreColors";ca.xjj="RecentColorPicker";Object(t.a)(ca,"ColorPickerBuilder",null,[]);var Q=a(356);class Y{constructor(){this.sections=null}}Object(t.a)(Y,"ColorPickerButtonMenuProps",null,[]);class la{constructor(){this.title=null;this.type=0;this.buttonProps=this.colorSwatchProps=null}}Object(t.a)(la,"ColorPickerButtonMenuSection",null,[]);class ea{constructor(){this.id=
this.label=this.color=null;this.index=0}}Object(t.a)(ea,"ColorPickerColorProps",null,[]);class ha{constructor(){this.type=0;this.label=null}}Object(t.a)(ha,"ColorPickerSectionButtonProps",null,[]);class X{constructor(){this.colors=null;this.isThemeColorSection=this.notifyOnColorUsed=!1}}Object(t.a)(X,"ColorPickerSectionColorSwatchProps",null,[]);class T{constructor(){this.row=this.index=0}}Object(t.a)(T,"ThemeColorInfo",null,[]);class ua{constructor(pa,ya,za,cb){this.$=pa;this.PB=ya;this.moreColorsHelper=
za;this.themesManager=cb;this.iBi=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}getColorPickerButtonMenuProps(pa){pa=this.PB.P$e(pa.automaticColor,pa.clearColor,pa.highlightWhen,pa.moreColors);const ya=new Y;ya.sections=this.j6h(pa);return ya}showMoreColorsDialog(pa,ya){this.moreColorsHelper.HEi(pa,void 0,ya)}onColorUsed(pa){pa=F.a.wF(D.a.HH(D.a.Uea(pa),!1));this.moreColorsHelper.xRd(pa.r,pa.g,pa.b,Q.a.wIc)}getThemeColor(pa){pa=D.a.Uea(pa);let ya;if(!({themeIndex:pa,
WCa:ya}=this.themesManager.getThemeColor(pa)).returnValue)return u.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null;const za=new T;za.index=pa;za.row=ya;return za}j6h(pa){const ya=[];for(let cb=0;cb<pa.length;cb++){var za=Object(R.a)(x.a,pa[cb]);const Pa=new la;Pa.title=za.Title;const nb=Object(R.a)(m.a,za.ControlList[0]);nb?(Pa.type=1,Pa.colorSwatchProps=this.sWh(nb),ya.push(Pa)):(za=Object(R.a)(w.a,za.ControlList[0]))&&null!=this.r4e(za.Id)?
(Pa.type=2,Pa.buttonProps=new ha,Pa.buttonProps.type=this.r4e(za.Id),Pa.buttonProps.label=za.LabelText,ya.push(Pa)):u.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return ya}sWh(pa){const ya=new X,za=pa.Colors;ya.colors=Array(za.length);ya.notifyOnColorUsed=this.moreColorsHelper.ybg(pa.ExternalId);ya.isThemeColorSection=this.iBi&&!!pa.ExternalId&&pa.ExternalId.includes(ca.dig);for(pa=0;pa<za.length;pa++)ya.colors[pa]=new ea,ya.colors[pa].id=za[pa].DisplayColor,
ya.colors[pa].color=za[pa].DisplayColor,ya.colors[pa].label=za[pa].Alt,ya.colors[pa].index=pa;return ya}r4e(pa){switch(pa){case ca.Bzf:return 1;case ca.hFe:return 2;case ca.oze:return 3;case ca.Fff:return 4}return null}}Object(t.a)(ua,"ColorPickerButtonController",null,[680]);class Ha{constructor(pa,ya,za){this.mq=this.kk=null;this.$=pa;this.moreColorsHelper=ya;this.e3g();this.d3g();this.themesManager=za;this.u6b=new ca(pa,ya,za)}e3g(){this.kk={};this.kk.style0=1535;this.kk.style1=1536;this.kk.style2=
1537;this.kk.style3=1538;this.kk.style4=1539;this.kk.style5=1540;this.kk.style6=1541;this.kk.style7=1542;this.kk.style8=1543;this.kk.style9=1544;this.kk.style10=1545;this.kk.style11=1546;this.kk.style12=1547;this.kk.style13=1548;this.kk.style14=1549;this.kk.style15=1550;this.kk.style16=1551;this.kk.style17=1552;this.kk.style18=1553;this.kk.style19=1554;this.kk.style20=1555;this.kk.style21=1556;this.kk.style22=1557;this.kk.style23=1558;this.kk.style24=1559;this.kk.style25=1560;this.kk.style26=1561;
this.kk.style27=1562;this.kk.style28=1563;this.kk.style29=1564;this.kk.style30=1565;this.kk.style31=1566;this.kk.style32=1567;this.kk.style33=1568;this.kk.style34=1569;this.kk.style35=1570;this.kk.style36=1571;this.kk.style37=1572;this.kk.style38=1573;this.kk.style39=1574;this.kk.style40=1575;this.kk.style41=1576}d3g(){this.mq={};this.mq.style0=1507;this.mq.style1=1508;this.mq.style2=1509;this.mq.style3=1510;this.mq.style4=1511;this.mq.style5=1512;this.mq.style6=1513;this.mq.style7=1514;this.mq.style8=
1515;this.mq.style9=1516;this.mq.style10=1517;this.mq.style11=1518;this.mq.style12=1519;this.mq.style13=1520;this.mq.style14=1521;this.mq.style15=1522;this.mq.style16=1523;this.mq.style17=1524;this.mq.style18=1525;this.mq.style19=1526;this.mq.style20=1527;this.mq.style21=1528;this.mq.style22=1529;this.mq.style23=1530;this.mq.style24=1531;this.mq.style25=1532;this.mq.style26=1533;this.mq.style27=1534}s4e(pa){return U.i(this.u6b.E7e(pa,null,null,null,null,null))}Vdc(pa,ya=null,za=null,cb=null,Pa=null,
nb=null,Ma=null,Oa=null,La=null){return Object(h.a)(new r.a,{MenuSectionList:this.u6b.D7e(pa,ya,za,cb,Pa,nb,Ma,Oa,La),UpdateDynamically:!0})}P$e(pa,ya,za,cb){return this.u6b.Z8h(pa,ya,za,cb)}tWh(pa,ya=null,za=null,cb=null,Pa=null,nb=null){return this.u6b.E7e(pa,ya,za,cb,Pa,nb)}Efc(pa,ya=!1){return ya?this.mq[pa]:this.kk[pa]}qgh(){return new ua(this.$,this,this.moreColorsHelper,this.themesManager)}}Object(t.a)(Ha,"PopulateDynamicHelper",null,[658]);var Ca=a(70),Ga=a(157),sa=a(41),bb=a(109);class Ba extends b.a{constructor(pa,
ya){super();this.PB=null;this.$=ya;pa.Ha(111,this);this.Mb()}create(){if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)||d.EwaSettings.cm()){const pa=f.GetServiceTaskFactory.Sa(this.$.da,398,397,this.Na),ya=Object(Ca.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")?Object(bb.d)(Ga.a.resolve(sa.eb,{rb:this.Na})):f.GetServiceTaskFactory.Sa(this.$.da,422,421,this.Na);e.TaskExtensions.za(e.TaskExtensions.Pd([pa,ya],this.ka),()=>{this.vb(this.PB||(this.PB=new Ha(this.$,
pa.result,ya.result)))},this.ka,3)}else e.TaskExtensions.za(f.GetServiceTaskFactory.Sa(this.$.da,398,397,this.Na),pa=>{this.vb(this.PB||(this.PB=new Ha(this.$,pa.result,null)))},this.ka,3)}}Object(t.a)(Ba,"PopulateDynamicHelperFactory",b.a,[]);a.d(C,"a",function(){return qa});const qa=()=>{c.a.Fa(pa=>{new Ba(pa.da,pa)})}},1223:function(t,C,a){var c=a(10);t=a(0);var b=a(228),f=a(53),e=a(39),d=a(2),h=a(14),r=a(19),l=a(7),u=a(37),v=a(907);class x{constructor(T,ua,Ha=null,Ca,Ga=null,sa=null,bb,Ba=null,
qa=null){this.rxe=ua;this.nze=Ha;this.gFe=Ga;this.Eff=sa;this.Azf=Ba;this.PB=T;this.menuId=qa}tU(){let T="";const ua=this.PB.tWh(this.rxe,this.nze,this.gFe,this.Eff,this.Azf,this.menuId);for(const Ha of ua)T+=Ha;return T}VE(){return this.PB.Vdc(this.rxe,this.nze,this.gFe,this.Eff,void 0,void 0,void 0,this.Azf,this.menuId)}}Object(t.a)(x,"RibbonColorPicker",null,[702]);var w=a(577);class m{constructor(T,ua=""){this._id=T;this.AC=ua}get id(){return this._id}get text(){return this.AC}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");
}set label(T){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");}tU(){return`<Label id="${this._id}" LabelText="${this.AC}" />`}AS(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}jOb(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");
}yS(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");}X5b(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}Cia(){return Object(d.a)(new w.a,{Id:this.id,LabelText:this.text})}}Object(t.a)(m,"RibbonLabel",null,[793,701,702]);var n=a(573),z=a(425),y=a(89),A=a(324);class F{constructor(T){this.GEg=[];this.id=T}get Cc(){return this.GEg}tU(){return A.q(this.VE())}VE(){const T=Object(d.a)(new n.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});
for(const ua of this.Cc)Object(z.a)(x,ua)?T.MenuSectionList.push(...Object(y.a)(x,ua).VE().MenuSectionList):T.MenuSectionList.push(ua.p4b());return T}}Object(t.a)(F,"RibbonMenu",null,[790,702]);var D=a(569);class B{constructor(){this.title=null;this.eY=[];this.Tp="Menu16";this.Jig=this.Cdg=this.Ddg=!0}get buttons(){return this.eY}tU(){return A.r(this.p4b())}p4b(){const T=Object(d.a)(new D.a,{ControlList:[]});if(1===this.buttons.length&&Object(z.a)(791,this.buttons[0]))T.ControlList.push(this.buttons[0].m4b());
else{let Ha="";for(let Ca=0;Ca<this.buttons.length;Ca++){var ua=Object(y.a)(701,this.buttons[Ca]);ua&&(ua=ua.Cia(),T.ControlList.push(ua),Ha+=ua.Id)}T.ControlsId=Ha+".Controls"}T.Title=this.title;T.DisplayMode=this.Tp;T.ShowMenuSectionTitleIcon=this.Ddg;T.ShowMenuSectionTitleBackground=this.Cdg;T.MenuSectionTitleFocusable=this.Jig;return T}}Object(t.a)(B,"RibbonMenuSection",null,[355,702]);class M{constructor(T,ua,Ha,Ca,Ga,sa,bb,Ba,qa,pa,ya,za,cb=null){this.id=T;this.command=Ha;this.KQf=Ca;this.populateOnlyOnce=
Ga;this.JRa=sa;this.xbj=bb;this.alt=Ba;this.z2b=qa;this.width=pa;this.SUg=ya;this.mz=za;this.ksa=new F(ua);this.arb=cb;Ca&&bb&&(T=new B,T.Tp="MenuLoading",ua=new m(ua+"LoadingLabel"),T.buttons.push(ua),this.menu.Cc.push(T))}tU(){return this.i1g()}get menu(){return this.ksa}i1g(){let T=A.d(this.id,this.command,this.KQf,this.populateOnlyOnce,this.JRa,this.xbj,this.alt,this.z2b,this.width);const ua=T.indexOf(" />");T=T.substring(0,ua);T+=` ${"AllowDefaultContent"}="${this.SUg.toString()}"`;T+=` ${"AutoComplete"}="${this.mz?
"true":"false"}"`;this.arb&&(T+=` ${"ArrowImgId"}="${this.arb}"`);T=T+">"+this.menu.tU();return T+"</ComboBox>"}}Object(t.a)(M,"RibbonComboBox",null,[794,702]);var R=a(1032),P=a(908),E=a(15);class H extends P.a{constructor(T,ua,Ha,Ca,Ga,sa,bb,Ba,qa,pa,ya,za=null,cb=null){super(T,ua,Ha,Ga,sa,bb,Ba,ya,0);this.Zkb=null;this.N9=0===qa?null:E.a.instance.ha(qa);this.dSc=pa;this.WTc=Ca;this.PIg=za;this.wn=cb}get description(){return this.N9}get Hxb(){return this.Zkb}get menuItemId(){return this.dSc}get JRa(){return this.WTc}get styles(){return this.PIg}get data(){return this.wn}tU(){return A.n(this.Cia())}iAc(T){this.N9=
T}toString(){this.Hxb||(this.Zkb=this.tU());return this.Hxb}Cia(){const T=new R.a;this.ccc(T);T.MenuItemId=this.menuItemId;T.QueryCommand=this.JRa;T.Description=this.description;T.Styles=this.styles;T.Data=this.data;return T}}Object(t.a)(H,"RibbonComboBoxItem",P.a,[356,701,702]);var G=a(576);class N extends P.a{constructor(T,ua,Ha,Ca,Ga,sa,bb,Ba){super(T,Ha,Ca,Ga,sa,bb,Ba,!1,0);this.populateOnlyOnce=!1;this.nEb=this.menuCloseCommand=this.menuOpenCommand=this.nx=null;this.ksa=new F(ua);this.Ogf=!0}get menu(){return this.ksa}tU(){return A.o(this.Cia())}Cia(){const T=
new G.a;this.ccc(T);T.PopulateOnlyOnce=this.populateOnlyOnce;T.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();T.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();T.PopulateQueryCommand=this.nx;T.KeyTip=this.nEb;T.Menu=this.menu.VE();T.ImageIsVisible=this.Ogf;return T}}Object(t.a)(N,"RibbonFlyoutAnchor",P.a,[357,701,702]);var I=a(1355),O=a(593),U=a(54);class ca{constructor(){this.q5a=[];this.id=null;this.width=0;this.title=this.Nja=
null}tU(){return A.p(this.m4b())}tu(T,ua,Ha,Ca=0,Ga=null,sa=null,bb=null,Ba=null,qa=null,pa=null){this.kif(this.q5a.length,T,ua,Ha,0===Ca?qa:E.a.instance.ha(Ca),Ga,sa,bb,Ba,pa)}kif(T,ua,Ha,Ca,Ga,sa=null,bb=null,Ba=null,qa=null,pa=null){(T>this.q5a.length||0>T)&&Error.argumentOutOfRange("Invalid Index");this.q5a.splice(T,0,Object(d.a)(new I.a,{Id:ua,Command:Ha.toString(),QueryCommand:null!==Ca&&void 0!==Ca?Ca:null,Alt:Ga,MenuItemId:sa,Icon:bb,Image:Ba?U.a.mf(Ba):null,ImageClass:qa,LabelText:pa}))}m4b(T=
!1){let ua=null,Ha=null;switch(this.Nja){case "Size120by20":ua=this.o4b(120,20,T);Ha=this.n4b(130,30,T);break;case "Size90by21":ua=this.o4b(90,21,T);Ha=this.n4b(100,33,T);break;case "Size24by24":ua=this.o4b(28,28,T);Ha=this.n4b(38,38,T);break;case "Size112by64":ua=this.o4b(24,24,T),Ha=this.n4b(112,64,T)}for(T=0;T<this.q5a.length;T++)this.q5a[T].FullIconStyle=ua;return Object(d.a)(new O.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.Nja,GalleryItems:this.q5a,
GalleryStyle:Ha})}o4b(T,ua,Ha){const Ca={},Ga={};Ga.width=T;Ga.height=ua;Ha&&(Ga.alignSelf="center",Ga.marginBottom="4px");Ca.root=Ga;return Ca}n4b(T,ua,Ha){const Ca={},Ga={},sa={};sa.width=T;sa.height=ua;Ga.root=sa;Ha&&(Ga.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});Ca.galleryButtonInExpanded=Ga;return Ca}}Object(t.a)(ca,"RibbonGallery",null,[791,702]);var Q=a(1023),Y=a(736),la=a(33);class ea{constructor(T=null){this.PB=T}Nq(T=null){return new F(T)}Nc(){return new B}tb(T){var ua=
u.a.Mc(ea.m1a,T.toString());if(ua)return ua;switch(T){case 236:return this.an(T,"ContextMenu.Show.IdeasNLPane",-1336341324,743);case 237:return this.an(T,"ContextMenu.Show.IdeasNLPane",-1336341324,744);case 238:return this.an(T,"ContextMenu.Show.IdeasNLPane",-1336341324,745);case 249:return this.Wc(T,"ContextMenu.Show.ChartTaskPane",1221897806,r.a.hXe,4,983);case 287:return this.Wc(T,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.wi(T,
"DataLabels.None.BoxWhisker",374300079,r.a.QWe,929,930,1600);case 0:return this.wi(T,"DataLabels.None.Column",374300079,r.a.PWe,929,930,1600);case 1:return this.wi(T,"DataLabels.None.Line",374300079,r.a.RWe,929,930,1600);case 2:return this.wi(T,"DataLabels.None.Pie",374300079,r.a.SWe,929,930,1600);case 3:return this.wi(T,"DataLabels.Show.Column",-1809877936,r.a.ebc,931,932,1601);case 143:return this.wi(T,"DataLabels.Show.Funnel",-1809877936,r.a.ebc,931,934,1601);case 144:return this.wi(T,"DataLabels.Show.Treemap",
-1809877936,r.a.ndd,931,938,1601);case 145:return this.wi(T,"DataLabels.Show.Sunburst",-1809877936,r.a.mdd,931,934,1601);case 4:return this.wi(T,"DataLabels.Center.Column",-1996266048,r.a.ebc,933,934,1602);case 5:return this.wi(T,"DataLabels.Center.Line",-1996266048,r.a.KWe,933,934,1602);case 6:return this.wi(T,"DataLabels.Center.Pie",-1996266048,r.a.mdd,933,934,1602);case 7:return this.wi(T,"DataLabels.InsideEnd.Column",493396546,r.a.LWe,935,936,1603);case 8:return this.wi(T,"DataLabels.InsideEnd.Pie",
493396546,r.a.MWe,935,936,1603);case 9:return this.wi(T,"DataLabels.InsideBase.Column",1599247052,r.a.ndd,937,938,1604);case 10:return this.wi(T,"DataLabels.OutsideEnd.Column",342855531,r.a.TWe,939,940,1605);case 11:return this.wi(T,"DataLabels.OutsideEnd.Pie",342855531,r.a.UWe,939,940,1605);case 140:return this.wi(T,"DataLabels.Left.BoxWhisker",-472675112,r.a.OWe,941,942,1606);case 12:return this.wi(T,"DataLabels.Left.Line",-472675112,r.a.NWe,941,942,1606);case 142:return this.wi(T,"DataLabels.Right.BoxWhisker",
-1774499423,r.a.WWe,943,944,1607);case 13:return this.wi(T,"DataLabels.Right.Line",-1774499423,r.a.VWe,943,944,1607);case 138:return this.wi(T,"DataLabels.Above.BoxWhisker",-204160914,r.a.GWe,945,946,1608);case 14:return this.wi(T,"DataLabels.Above.Line",-204160914,r.a.XWe,945,946,1608);case 139:return this.wi(T,"DataLabels.Below.BoxWhisker",-87783054,r.a.HWe,947,948,1609);case 15:return this.wi(T,"DataLabels.Below.Line",-87783054,r.a.JWe,947,948,1609);case 16:return this.wi(T,"DataLabels.BestFit.Pie",
1650379138,r.a.IWe,949,950,1610);case 17:return this.wi(T,"Axes.Horizontal.None",895828731,r.a.vWe,929,951,1613);case 18:return this.wi(T,"Axes.Horizontal.ShowLTR",683614408,r.a.kdd,952,953,1614);case 19:return this.wi(T,"Axes.Horizontal.NoLabels",-1612014670,r.a.uWe,956,957,1615);case 20:return this.wi(T,"Axes.Horizontal.ShowRTL",1259259728,r.a.wWe,958,959,1616);case 21:return this.wi(T,"Axes.Horizontal.Default",683614408,r.a.kdd,954,955,1617);case 22:return this.wi(T,"Axes.Horizontal.Thousands",
-220179662,r.a.xWe,960,961,1618);case 23:return this.wi(T,"Axes.Horizontal.Millions",1534680966,r.a.tWe,962,963,1619);case 24:return this.wi(T,"Axes.Horizontal.Billions",-238895611,r.a.rWe,964,965,1620);case 25:return this.wi(T,"Axes.Horizontal.LogScale",-892714755,r.a.sWe,966,967,1621);case 26:return this.wi(T,"Axes.Vertical.None",2006508979,r.a.CWe,929,951,1613);case 27:return this.wi(T,"Axes.Vertical.Default",252405382,r.a.EWe,954,955,1617);case 28:return this.wi(T,"Axes.Vertical.Thousands",670842692,
r.a.FWe,960,961,1618);case 29:return this.wi(T,"Axes.Vertical.Millions",-572426128,r.a.AWe,962,963,1619);case 30:return this.wi(T,"Axes.Vertical.Billions",-806496391,r.a.yWe,964,965,1620);case 31:return this.wi(T,"Axes.Vertical.LogScale",-1700998151,r.a.zWe,966,967,1621);case 32:return this.wi(T,"Axes.Vertical.NoLabels",2104548628,r.a.BWe,956,957,1615);case 33:return this.wi(T,"Axes.Vertical.ShowRTL",1717508862,r.a.DWe,958,959,1616);case 34:return this.wi(T,"Gridlines.Horizontal.None",80515665,r.a.bXe,
929,970,1624);case 35:return this.wi(T,"Gridlines.Horizontal.Major",-306129902,r.a.ZWe,972,973,1625);case 36:return this.wi(T,"Gridlines.Horizontal.Minor",2147076534,r.a.$We,975,976,1626);case 37:return this.wi(T,"Gridlines.Horizontal.MajorMinor",-1253752845,r.a.aXe,978,979,1627);case 38:return this.wi(T,"Gridlines.Vertical.None",1711257557,r.a.gXe,929,971,1624);case 39:return this.wi(T,"Gridlines.Vertical.Major",-1772953364,r.a.dXe,972,974,1625);case 40:return this.wi(T,"Gridlines.Vertical.Minor",
680253336,r.a.eXe,975,977,1626);case 41:return this.wi(T,"Gridlines.Vertical.MajorMinor",-215161981,r.a.fXe,978,980,1627);case 135:return this.Wc(T,"ContextMenu.NumberFormating",2105621672,r.a.cdd,1,476,135!==T);case 300:return this.Wc(T,"ContextMenu.FormatCells",2055979337,null,1,477,300!==T,void 0,"PaintBrushandBucket_20");case 136:return this.Wc(T,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,r.a.cdd,1,476,136!==T);case 42:return this.Wc(T,"ContextMenu.Cut",-1985798686,r.a.RVe,1,12);
case 43:return this.Wc(T,"ContextMenu.Copy",-911352779,r.a.QVe,1,11);case 212:return this.Wc(T,"ContextMenu.InsertCopiedCells",-160032004,r.a.Ddd,3,15);case 213:return this.Wc(T,"ContextMenu.InsertCutCells",-1065525230,r.a.Ddd,3,21);case 44:case 57:return this.Wc(T,"ContextMenu.Paste",237279923,r.a.fdd,1,13,44!==T,"Paste");case 248:return this.Wc(T,"PasteAdvancedOptionsGallery",237279923,r.a.fdd,1,13,44!==T,"Paste");case 45:case 120:return this.Wc(T,"ContextMenu.EditHyperlink",-1583422759,r.a.sdd,
8,1140,45!==T,"EditHyperlink");case 46:case 121:return this.Wc(T,"ContextMenu.InsertHyperlink",-1583422759,r.a.sdd,8,1141,46!==T,"InsertHyperlink");case 47:case 122:return this.Wc(T,"ContextMenu.RemoveHyperlink",-1253126584,r.a.vdd,8,1142,47!==T,"RemoveHyperlink");case 48:case 123:return this.Wc(T,"ContextMenu.RemoveHyperlinks",-1253126584,r.a.vdd,8,1143,48!==T,"RemoveHyperlinks");case 250:return this.an(T,"ContextMenu.ContextMenuSmartLookup",-983891024,1810);case 187:case 188:case 165:case 173:return this.Wc(T,
"ContextMenu.InsertCellsShiftRight",1035996630,r.a.$Ve,1,165===T||173===T?341:342,173===T||188===T,"InsertCellsShiftRight");case 166:case 174:return this.Wc(T,"ContextMenu.InsertCellsShiftDown",1035996630,r.a.ZVe,1,344,166!==T,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.Wc(T,"ContextMenu.DeleteCellsShiftLeft",1035996630,r.a.UVe,1,167===T||175===T?342:341,175===T||190===T,"DeleteCellsShiftLeft");case 168:case 176:return this.Wc(T,"ContextMenu.DeleteCellsShiftUp",1035996630,
r.a.VVe,1,343,168!==T,"DeleteCellsShiftUp");case 177:case 181:return this.Wc(T,"ContextMenu.InsertRowsSheet",-1113896058,r.a.pwb,1,la.a.rtd()?430:429,177!==T,"InsertRows");case 49:case 116:return this.Wc(T,"ContextMenu.InsertRows",-1113896058,r.a.pwb,1,la.a.rtd()?347:346,49!==T,"InsertRows");case 297:case 298:return this.Wc(T,"ContextMenu.InsertRowsBelowSheet",-1113896058,r.a.pwb,1,431,297!==T,"InsertRowsBelow");case 295:case 296:return this.Wc(T,"ContextMenu.InsertRowsBelow",-1113896058,r.a.pwb,
1,348,295!==T,"InsertRowsBelow");case 161:case 169:return this.Wc(T,"ContextMenu.InsertRowsTable",942362098,r.a.bWe,1,421,161!==T,"InsertRowsTable");case 50:case 117:return this.Wc(T,"ContextMenu.InsertColumns",1415868706,r.a.owb,1,406,50!==T,"InsertColumns");case 288:case 289:return this.Wc(T,"ContextMenu.InsertColumns",1415868706,r.a.owb,1,408,288!==T,"InsertColumns");case 178:case 182:return this.Wc(T,"ContextMenu.InsertColumnsSheet",1415868706,r.a.owb,1,426,178!==T,"InsertColumns");case 290:case 291:return this.Wc(T,
"ContextMenu.InsertColumnsSheet",1415868706,r.a.owb,1,428,290!==T,"InsertColumns");case 191:case 192:case 162:case 170:return this.Wc(T,"ContextMenu.InsertColumnsTable",622604322,r.a.aWe,1,162===T||170===T?419:420,170===T||192===T,"InsertColumnsTable");case 179:case 183:return this.Wc(T,"ContextMenu.DeleteRowsSheet",1554436520,r.a.abc,1,429,179!==T,"DeleteRows");case 51:case 118:return this.Wc(T,"ContextMenu.DeleteRows",1554436520,r.a.abc,1,410,51!==T,"DeleteRows");case 163:case 171:return this.Wc(T,
"ContextMenu.DeleteRowsTable",1405456548,r.a.abc,1,418,163!==T,"DeleteRowsTable");case 180:case 184:return this.Wc(T,"ContextMenu.DeleteColumnsSheet",674605324,r.a.$ac,1,426,180!==T,"DeleteColumns");case 52:case 119:return this.Wc(T,"ContextMenu.DeleteColumns",674605324,r.a.$ac,1,411,52!==T,"DeleteColumns");case 164:case 172:return this.Wc(T,"ContextMenu.DeleteColumnsTable",284490184,r.a.$ac,1,417,164!==T,"DeleteColumnsTable");case 53:case 124:return this.an(T,"ContextMenu.OpenHyperlink",-1396319072,
1144,53!==T,"OpenHyperlink");case 263:return this.Wc(T,"SheetOpsContextMenu.ShowChanges",1834994092,r.a.wdd,8,443,void 0,l.a.yOj);case 264:return this.Wc(T,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.Wc(T,"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.Wc(T,"GridContextMenu.ShowChanges",1834994092,r.a.wdd,8,443,void 0,l.a.gcg);case 54:return this.Wc(T,"ContextMenu.InsertSheet",
-1935155518,r.a.cWe,1,514);case 56:case 127:return this.Wc(T,"ContextMenu.DeleteSheet",1880294140,r.a.XVe,1,515,56!==T,"DeleteSheet");case 55:return this.an(T,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.an(T,"ContextMenu.ReorderSheet",-383100692,517,125!==T,"ReorderSheet");case 158:return this.an(T,"ContextMenu.DuplicateSheet",-1254662242,441);case 112:case 114:return this.an(T,"ContextMenu.HideSheet",1458540255,519,112!==T,"HideSheet");case 113:case 115:return this.an(T,
"ContextMenu.UnhideSheet",1129633328,520,113!==T,"UnhideSheet");case 277:return this.Wc(T,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.Wc(T,"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.Wc(T,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.an(T,"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.Wc(T,
"ContextMenu.PivotExpand",-1687560254,r.a.hdd,9,1168);case 244:return this.Wc(T,"ContextMenu.PivotCollapse",1176256599,r.a.gdd,9,1169);case 245:return this.Wc(T,"ContextMenu.PivotExpandEntireField",-1751201991,r.a.hdd,9,1170);case 246:return this.Wc(T,"ContextMenu.PivotCollapseEntireField",-232434744,r.a.gdd,9,1171);case 247:return this.Wc(T,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");case 59:return this.Wc(T,"ContextMenu.PivotFieldListShow",2140436015,
r.a.idd,9,1173);case 58:return this.Wc(T,"ContextMenu.PivotFieldListHide",-1006032470,r.a.idd,9,1174);case 258:return this.Wc(T,"ContextMenu.PivotSettingsPaneShow",1529441790,r.a.rwb,17,636);case 257:return this.Wc(T,"ContextMenu.PivotSettingsPaneHide",1529441790,r.a.rwb,17,637);case 259:return this.an(T,"ContextMenu.PivotTableNoSubtotal",-2016405815,638);case 260:return this.an(T,"ContextMenu.PivotTableSubtotalOnTop",671485366,639);case 261:return this.an(T,"ContextMenu.PivotTableSubtotalOnBottom",
772221736,640);case 60:case 64:return ua=60!==T,this.an(T,ua?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,ua,null);case 61:case 65:return ua=61!==T,this.an(T,ua?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,ua,null);case 62:case 66:return ua=62!==T,this.an(T,ua?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",389774337,1091,ua,null);case 63:case 67:return ua=63!==T,this.an(T,ua?"ContextMenu.FieldWellMoveToEndDisabled":
"ContextMenu.FieldWellMoveToEnd",2033235475,1092,ua,null);case 68:case 72:return ua=68!==T,this.Wc(T,ua?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,r.a.Vac,9,1093,ua,null);case 69:case 73:return ua=69!==T,this.Wc(T,ua?"ContextMenu.FieldWellMoveToRowLabelsDisabled":"ContextMenu.FieldWellMoveToRowLabels",74086617,r.a.C4a,9,1094,ua,null);case 70:case 74:return ua=70!==T,this.Wc(T,ua?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",
1529312473,r.a.B4a,9,1095,ua,null);case 71:case 75:return ua=71!==T,this.Wc(T,ua?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,r.a.Xac,9,1098,ua,null);case 76:return this.Wc(T,"ContextMenu.FieldWellRemoveField",-1092351914,r.a.SVe,9,1099);case 77:return this.Wc(T,"ContextMenu.FieldWellValueFieldSettings",-2141589616,r.a.qWe,9,1100);case 79:case 83:return this.Wc(T,"ContextMenu.FieldListMoveToReportFilter",359279088,r.a.Vac,9,1082,79!==T,null);case 80:case 84:return this.Wc(T,
"ContextMenu.FieldListMoveToRowLabels",-67292059,r.a.C4a,9,1083,80!==T,null);case 81:case 85:return this.Wc(T,"ContextMenu.FieldListMoveToColumnsLabels",745182485,r.a.B4a,9,1084,81!==T,null);case 82:case 86:return this.Wc(T,"ContextMenu.FieldListMoveToValues",926905850,r.a.Xac,9,1087,82!==T,null);case 95:case 97:return ua=95!==T,this.Wc(T,ua?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,r.a.C4a,9,1096,ua,null);case 96:case 98:return ua=96!==
T,this.Wc(T,ua?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,r.a.B4a,9,1097,ua,null);case 78:return this.Wc(T,"ContextMenu.FieldListAddAsSlicer",547535945,r.a.$cd,9,1088);case 91:case 93:return this.Wc(T,"ContextMenu.FieldListMoveToRowChartLabels",-67292059,r.a.C4a,9,1085,91!==T,null);case 92:case 94:return this.Wc(T,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,r.a.B4a,9,1086,92!==T,null);case 99:return this.Wc(T,"ContextMenu.BIExploreShowCallout",
1529658657,r.a.Yac,9,1193);case 100:return this.Wc(T,"ContextMenu.ContextMenuRefresh",2054778433,r.a.jWe,9,1181);case 102:return this.Wc(T,"ContextMenu.EditCell",324156914,r.a.udd,8,579);case 101:return this.Wc(T,"Contextenu.DeleteChart",2045211913,r.a.rdd,8,578);case 146:return this.Wc(T,"Contextenu.AltText",1804967129,r.a.rXe,8,817);case 147:return this.Wc(T,"ContextMenu.EditShapeText",-445658892,r.a.sXe,8,818);case 186:return this.Wc(T,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.Wc(T,
"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",Y.a.bringForward);case 282:return this.Wc(T,"ContextMenu.BringToFront",-1480025782,null,8,822,!1,"ContextMenu.BringToFront",Y.a.bringToFront);case 283:return this.Wc(T,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",Y.a.sendBackward);case 284:return this.Wc(T,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",Y.a.sendToBack);case 273:return this.Wc(T,"ContextMenu.OfficeScriptsViewScript",
-585097204,r.a.LVe,8,2151);case 160:return this.Wc(T,"ContextMenu.InsertComment",-1667294294,r.a.uXe,8,1146);case 221:return this.Wc(T,"ContextMenu.DeleteComment",467845448,r.a.qXe,8,1162);case 159:return this.Wc(T,"ContextMenu.InsertReply",-1667294294,r.a.vXe,8,1145);case 226:return this.Wc(T,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20");case 227:return this.Wc(T,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.Wc(T,
"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.Wc(T,"ContextMenu.ShowOrHideNote",1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.an(T,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.rQ(T,"Form.InsertForm",1305810481,r.a.edd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.rQ(T,"Form.ViewForm",330035228,r.a.edd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.rQ(T,"Form.EditForm",1305810481,
r.a.YVe,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.rQ(T,"Form.DeleteForm",-509039657,r.a.TVe,1,"Image16by16",1270,0,null,!1,1598);case 106:return this.rQ(T,"Form.ShareForm",1334518759,r.a.lWe,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return this.an(T,"ContextMenu.ClearContent",-848953656,445,148!==T);case 150:case 151:return this.Wc(T,"ContextMenu.RowHeight",2040891415,r.a.wXe,8,434,151===T);case 152:case 153:return this.Wc(T,"ContextMenu.ColumnWidth",957527587,r.a.pXe,
8,433,153===T);case 108:case 154:return this.an(T,"ContextMenu.HideRows",1051390410,432,154===T);case 110:case 156:return this.an(T,"ContextMenu.UnhideRows",1542466017,439,156===T);case 109:case 155:return this.an(T,"ContextMenu.HideColumns",-706918724,438,155===T);case 111:case 157:return this.an(T,"ContextMenu.UnhideColumns",369708605,440,157===T);case 216:return this.an(T,"ContextMenu.ShowCard",-843616717,1786,216!==T);case 217:return this.an(T,"ContextMenu.ShowImageDetails",-843616717,1787);case 215:case 268:return this.an(T,
"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===T);case 218:case 269:return this.an(T,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===T);case 220:case 271:return this.an(T,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===T);case 219:case 270:return this.an(T,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===T);case 234:return this.Wc(T,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.Wc(T,"ContextMenu.FilterReapply",
1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.Wc(T,"ContextMenu.FilterByValue",1803952894,null,1,222);case 223:return this.Wc(T,"ContextMenu.SortAscending",-1010737776,r.a.nWe,1,228);case 292:return this.an(T,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,230);case 293:return this.an(T,"ContextMenu.PutSelectedFontColorOnTop",-764711886,231);case 294:return this.an(T,"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,232);case 224:return this.Wc(T,"ContextMenu.SortDescending",
2123420468,r.a.oWe,1,229);case 225:return this.Wc(T,"ContextMenu.SortCustom",-207540907,r.a.dbc,1,233);case 232:return this.Wc(T,"ContextMenu.ConvertToRange",323142015,r.a.PVe,1,740);case 272:return this.Wc(T,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,r.a.udd,8,661);case 239:return this.Wc(T,"ContextMenu.IgnoreError",886009118,r.a.tdd,8,2112,239!==T);case 240:return this.Wc(T,"ContextMenu.IgnoreErrors",886009118,r.a.tdd,8,2113,240!==T);case 241:return this.an(T,"ContextMenu.ShowError",-1779556985,
2114,241!==T);case 251:return this.Wc(T,"ContextMenu.SlicerRefresh",-231711729,r.a.iWe,0,2177,251!==T);case 252:return this.Wc(T,"ContextMenu.SlicerClearFilter",-1909381757,r.a.WVe,0,2178,252!==T);case 254:return this.an(T,"ContextMenu.SlicerDelete",2045211913,2181,254!==T);case 253:return this.Wc(T,"ContextMenu.SlicerMultiSelect",2108047455,r.a.ddd,0,2180,253!==T);case 255:return this.Wc(T,"ContextMenu.SlicerSortAscending",-923375148,r.a.gbc,8,2183,255!==T);case 256:return this.Wc(T,"ContextMenu.SlicerSortDescending",
1164937340,r.a.hbc,8,2182,256!==T);case 267:return this.Wc(T,"ContextMenu.SlicerSettingsPaneShow",522377926,r.a.rwb,17,636);case 266:return this.Wc(T,"ContextMenu.SlicerSettingsPaneHide",522377926,r.a.rwb,17,637);case 185:return this.Wc(T,"ContextMenu.OpenImmersiveReader",-425234874,null,1,1160,void 0,void 0,"AudioReader_20");case 128:return this.Lua(T,-619033944,1,1438);case 129:return this.Lua(T,-619033944,2,1440);case 130:return this.Lua(T,-619033944,3,1442);case 131:return this.Lua(T,-619033944,
4,1443);case 132:return this.l4(T,-1736601456,7,1447);case 133:return this.l4(T,-1736601456,8,1449);case 134:return this.l4(T,-1736601456,0,1450);case 196:return this.Lua(T,-2136556471,1,1438);case 198:return this.Lua(T,-2136556471,2,1440);case 200:return this.Lua(T,-2136556471,3,1442);case 201:return this.Lua(T,-2136556471,4,1443);case 204:return this.l4(T,1201641489,0,1447);case 205:return this.l4(T,1201641489,1,1448);case 206:return this.l4(T,1201641489,7,1449);case 207:return this.l4(T,1201641489,
2,1450);case 208:return this.l4(T,1201641489,4,1451);case 209:return this.l4(T,1201641489,3,1452);case 210:return this.l4(T,1201641489,5,1453);case 211:return this.l4(T,1201641489,6,1454);case 274:return this.Wc(T,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,"ShareSectionEntry_20");case 275:return this.Wc(T,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,"ShareSectionEntry_20");case 276:return this.Wc(T,"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,"ShareSectionEntry_20");
case 299:return this.Wc(T,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,"ShareSectionEntry_20");case 285:return this.Wc(T,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.Wc(T,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20")}return null}rQ(T,ua,Ha,Ca,Ga,sa,bb,Ba,qa,pa,ya,za=null){ua=new v.a(ua,bb,Ha,null,Ga,Ca,sa,bb,Ba,qa,pa,ya,!0,za);return ea.m1a[T.toString()]=ua}Wc(T,ua,Ha,Ca,Ga,sa,
bb=!1,Ba=null,qa=null){return this.rQ(T,ua,Ha,qa?null:Ca,Ga,"Image16by16",sa,0,Ba,bb,0,qa)}S8c(T,ua,Ha,Ca,Ga,sa=null){return new H(T,0,-1006427574,null,Ha,ua,Ca,0,0,Ga,!1,null,sa)}A8c(T,ua=""){return new m(T,ua)}ufh(T,ua,Ha,Ca){return new Q.a(T,0,ua,null,8,null,"None",0,0,null,!1,0,Ha,Ca)}GJa(T,ua,Ha,Ca,Ga,sa,bb,Ba=null,qa=!1){let pa=u.a.Mc(ea.m1a,T);if(pa)return pa;pa=new v.a(T,0,Ha,null,3,null,"None",0,0,sa,bb,0);pa.yS(ua);pa.label=ua;pa.iAc(qa?null:ua);pa.jOb(Ga,Ca,Ba);return ea.m1a[T]=pa}rNd(T){this.Grd(T)&&
delete ea.m1a[T]}Grd(T){return T in ea.m1a}Gw(T,ua,Ha,Ca){T=new N(T,ua,0,Ca,3,null,"None",0);T.yS(Ha);T.label=Ha;return T}Y7c(T,ua,Ha,Ca,Ga,sa){T=new N(T,ua,0,Ca,Ga,sa,"Image16by16",0);T.yS(Ha);T.label=Ha;return T}Okh(T,ua,Ha,Ca,Ga=null){return new M(T,ua,"1726517890",!0,!1,null,"PopulateNameBoxMenu",Ha,!0,Ca,!0,!1,Ga)}ibf(T){h.ULS.sendTraceTag(537153991,0,50,"RibbonControlsManager.GetXmlForControl: Generating control xml from control props");if(T)return T.tU();h.ULS.sendTraceTag(537153989,0,10,"RibbonControlsManager.GetXmlForControl: control is null");
return null}V7c(T,ua=null,Ha=null,Ca=null,Ga=null){return new x(this.PB,T,null,null,ua,null,Ha,Ca,Ga)}dD(T,ua,Ha=null,Ca=null){return Object(d.a)(new ca,{id:T,width:ua,Nja:Ha,title:Ca})}wi(T,ua,Ha,Ca,Ga,sa,bb){return this.rQ(T,ua,Ha,Ca,4,"Image32by32",Ga,sa,null,!1,bb)}an(T,ua,Ha,Ca,Ga=!1,sa=null){return this.rQ(T,ua,Ha,null,1,"None",Ca,0,sa,Ga,0)}JJe(T,ua,Ha,Ca,Ga,sa){return this.rQ(T,ua,Ha,Ca,4,"Image16by16",Ga,0,sa.toString(),!1,0)}l4(T,ua,Ha,Ca){return this.JJe(T,"OutlineDashStylePresent,"+Ha,
ua,r.a.Zac,Ca,Ha)}Lua(T,ua,Ha,Ca){return this.JJe(T,"OutlineWidthPresent,"+Ha,ua,r.a.cbc,Ca,Ha)}}ea.m1a={};Object(t.a)(ea,"RibbonControlsManager",null,[640]);class ha extends b.a{constructor(T){super();this.Xa=null;this.$=T;this.Mb()}create(){var T=this.$;const ua=f.GetServiceTaskFactory.create(T.da,111,this.ka,this.Na);T=f.GetServiceTaskFactory.create(T.da,155,this.ka,this.Na);e.TaskExtensions.za(e.TaskExtensions.Pd([ua,T],this.ka),()=>{this.vb(this.Xa||(this.Xa=new ea(ua.result)))},this.ka,3)}static la(T){T.da.Ha(102,
new ha(T))}}Object(t.a)(ha,"RibbonControlsFactory",b.a,[]);a.d(C,"a",function(){return X});const X=()=>{c.a.Fa(ha.la)}},1227:function(t,C,a){var c=a(10);t=a(0);var b=a(170),f=a(228),e=a(39),d=a(14),h=a(34),r=a(364),l=a(361),u=a(198),v=a(356),x=a(134),w=a(380),m=a(199),n=a(216),z=a(207),y=a(32),A=a(258),F=a(293),D=a(135);class B{constructor(T,ua,Ha,Ca){this.red=T;this.green=ua;this.blue=Ha;this.alpha=Ca}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}
Object(t.a)(B,"ColorObject",null,[]);class M{constructor(T){this.RA=this.Aq=null;this.O3c=T}get head(){return this.Aq}get f_d(){return this.RA}cOe(T){this.head&&(T.pre?T.next?(T.pre.next=T.next,T.next.pre=T.pre):(this.RA=T.pre,this.f_d.next=null):T.next?(this.Aq=T.next,this.head.pre=null):this.RA=this.Aq=null,T.next=null,T.pre=null)}hPg(T){this.head?(T.next=this.head,this.Aq=T,T.next.pre=this.head):this.RA=this.Aq=T}Vjd(){if(!this.head)return null;const T=new u.a;let ua=this.head;for(;ua;)if(T.add(ua.value),
ua=ua.next,T.count>this.O3c){d.ULS.sendTraceTag(537155399,0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return T}}Object(t.a)(M,"CustomLinkedList",null,[]);class R{constructor(T){this.pre=this.next=null;this.value=T}}Object(t.a)(R,"CustomLinkedListNode",null,[]);class P{constructor(T){this.O3c=T;this.Jpc={};this.y$a=new M(T);this.count=0}add(T,ua){T&&ua?(ua=new R(ua),this.contains(T)?this.y$a.cOe(this.Jpc[T]):this.count<this.O3c?this.count++:(delete this.Jpc[this.y$a.f_d.value.toString()],
this.y$a.cOe(this.y$a.f_d)),this.y$a.hPg(ua),this.Jpc[T]=ua):d.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${T} or Value ${ua} is null.`)}Vjd(){return this.y$a.Vjd()}contains(T){return T?T in this.Jpc:!1}}Object(t.a)(P,"MRUCache",null,[]);var E=a(160),H=a(15);class G extends E.a{constructor(T,ua,Ha,Ca=null){super(!1,!1,!0);this.moreColorsHelper=null;this.Z$g=(Ga,sa)=>{this.UGe(Ga,sa)};this.$=T;this.Fki=ua;this.Ypd=Ha;this.VGe=Ca}Cg(){const T=H.a.instance.ha(1346),ua={};ua[G.Ptg]=this.Fki;ua[G.hsg]=
G.fTb;ua[G.Itg]=G.fTb;ua[G.Zug]=G.fTb;ua[G.Nug]=G.fTb;ua[G.sug]=H.a.instance.ha(2105);ua[G.Ctg]=H.a.instance.ha(2089);ua[G.osg]=H.a.instance.ha(2076);ua[G.Gtg]=H.a.instance.ha(1347);ua[G.isg]=H.a.instance.ha(1348);this.Ypd!==G.jsg&&(ua[G.ksg]=G.ALPHA,ua[G.ALPHA]=this.Ypd,d.ULS.sendTraceTag(537155398,0,50,`More Colors:: Initial Alpha Value : ${this.Ypd}`));this.initializeAndShow(T,this.Z$g,{[G.otg]:G.Psg,[G.psg]:ua})}UGe(T,ua){ua=ua[G.HIc];1===T&&this.pBf(z.a.Uea(ua));this.VGe&&this.VGe(1===T,1===
T?ua:null)}pBf(T){this.moreColorsHelper||(this.moreColorsHelper=this.$.da.Aa(398));T=n.a.wF(z.a.HH(T,!1));this.moreColorsHelper.xRd(T.r,T.g,T.b,v.a.wIc)}}G.Ptg="initColor";G.otg="id";G.Psg="ColorPickerDialog";G.psg="bodyControls";G.HIc="selectedColorText";G.Itg="hueAriaLabel";G.Zug="transparencyAriaLabel";G.Nug="svAriaLabel";G.fTb="Use left & right arrows keys to change values in color picker & hue slider";G.ALPHA="alpha";G.vIc="alphaValue";G.hsg="alphaAriaLabel";G.ksg="alphaSliderType";G.jsg=-1;
G.eug=100;G.sug="redLabel";G.osg="blueLabel";G.Ctg="greenLabel";G.Gtg="hexLabel";G.isg="alphaLabel";Object(t.a)(G,"MoreColorsDialog",E.a,[]);var N=a(7),I=a(98),O=a(528),U=a(55);class ca extends G{constructor(T,ua,Ha,Ca,Ga){super(T,Ca,Ga);this.commandName=null;this.Ajf=!1;this.command=ua;this.Ld=Ha;this.wki=Ga}Cg(){super.Cg();this.commandName=U.b().Sj(this.Ld.command);d.ULS.sendTraceTag(545051016,0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.Ld.af}`)}UGe(T,
ua){if(1===T)if(T=this.$.Rb.Dg("UserAction",this.commandName),T.start(),O.a(T),ua)if(G.HIc in ua){var Ha=ua[G.HIc];if(T=z.a.Uea(Ha)){Ha=new I.a(this.command,this.Ld.method,this.Ld.mode,this.Ld.af,this.Ld.tabName?this.Ld.tabName:1378078823===this.command||-400966242===this.command?N.a.bBa:N.a.$W);var Ca={};Ca.Color=T;Ca.UILocation=this.Ld.af;G.vIc in ua&&(this.wki!==ua[G.vIc]&&(this.Ajf=!0),Ca.Alpha=(ua[G.vIc]/G.eug).toString(),d.ULS.sendTraceTag(537155359,0,50,`Alpha Value selected from the MoreColors Dialog: ${Ca.Alpha}`));
this.$.Ia.Nb(Ha,Ca);this.$.zf();this.pBf(T);ua={["Command"]:this.commandName,["Location"]:this.Ld.af};ua.AlphaApplied=this.Ajf.toString();D.b(this.$).rd(x.a.NOi,ua,null,!0)}else this.hide(),d.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${Ha}, Command: ${this.commandName}`)}else this.hide(),d.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),d.ULS.sendTraceTag(537155362,
0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(t.a)(ca,"MoreColorsRibbonDialog",G,[]);var Q=a(65);const Y=(T,ua,Ha,Ca,Ga,sa,bb,Ba,qa,pa=null)=>{pa=T.Oa(9,pa);pa.bRed=ua;pa.bGreen=Ha;pa.bBlue=Ca;pa.bAlpha=Ga;return Q.g(T,"SaveMRUColor",pa,sa,bb,Ba,qa,0)},la=(T,ua,Ha,Ca,Ga,sa=null)=>{sa=T.Oa(1,sa);return Q.g(T,"GetMRUColors",sa,ua,Ha,Ca,Ga,4)};class ea{constructor(T,ua){this.tke="00FFFF";this.uke="0000FF";this.zWf="00FFFF";this.AWf="BF7000";this.URa=null;this.x7e=!1;this.age=null;this.xZi=
Ha=>{if(!A.a(Ha)){Ha=Ha.Result;this.URa=new P(10);for(let Ga=Ha.length-1;0<=Ga;Ga--){var Ca=Ha[Ga];Ca=new B(Ca.Red,Ca.Green,Ca.Blue,Ca.Alpha);this.URa.add(Ca.toString(),Ca)}this.HQf();d.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.wZi=()=>{d.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.xW=()=>{this.Fed()};this.$=T;this.mFb=ua;this.$.da.Ha(398,this);
this.$.ea.Bf?this.Fed():this.$.ea.mk(this.xW)}get iFb(){return this.age}get VRa(){return this.tke}set VRa(T){this.tke=T}get tdb(){return this.uke}set tdb(T){this.uke=T}get Dvc(){return this.zWf}set Dvc(T){this.zWf=T}get Evc(){return this.AWf}set Evc(T){this.AWf=T}XEb(T,ua,Ha,Ca=-1){return this.mFb?e.TaskExtensions.za(this.mFb,()=>{(new ca(this.$,T,ua,Ha,Ca)).Cg()},this.$.ka):null}HEi(T,ua=-1,Ha=null){this.mFb&&e.TaskExtensions.za(this.mFb,()=>{(new G(this.$,T,ua,Ha)).Cg()},this.$.ka)}q6h(T){let ua=
null;switch(T){case "QueryRecentFillColor":ua=this.VRa;break;case "QueryRecentFontColor":ua=this.tdb;break;case "QueryRecentShapesFillColor":ua=this.Dvc;break;case "QueryRecentShapesOutlineColor":ua=this.Evc}return ua?h.a.n6a(ua):null}dispose(){this.mFb=null;this.$&&this.$.ea.rn(this.xW)}Fed(){if(this.$.isEditMode)if(this.URa)this.HQf();else{this.x7e&&d.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");
var T=this.$.pa.va;this.$.userOperationManager.Tc(new m.a(1009,0,(ua,Ha,Ca)=>la(T,F.b.call(null,ua,this.xZi),F.a.call(null,Ha,this.wZi),Ca,null),80),null);this.x7e=!0}}HQf(){var T=this.URa.Vjd();if(T){this.age=new u.a;for(let ua of T)T=ua,T=new n.a(T.red,T.green,T.blue),this.iFb.add(z.a.jJ(T))}}xRd(T,ua,Ha,Ca){this.URa||(this.URa=new P(10));const Ga=new B(T,ua,Ha,Ca);this.URa.add(Ga.toString(),Ga);this.saveMRUColor(null,T,ua,Ha,Ca)}xea(T,ua,Ha){(T||this.$.isEditMode)&&this.ybg(T.SqmControlId)&&(T=
n.a.wF(z.a.HH(ua,!1)))&&(this.xRd(T.r,T.g,T.b,v.a.wIc),Ha={["Command"]:U.b().Sj(Ha.command),["Location"]:r.a[Ha.af],["InputMethod"]:l.a[Ha.method]},D.b(this.$).rd(x.a.xea,Ha,null,!0))}ybg(T){return!!T&&T.startsWith("RecentColorPicker")}saveMRUColor(T,ua,Ha,Ca,Ga){return w.a(this.$.userOperationManager,(sa,bb,Ba)=>Y(this.$.pa.va,ua,Ha,Ca,Ga,F.b(sa,ea.T3i()),F.a(bb,ea.S3i()),Ba,null),sa=>new m.a(1008,0,sa),T)}static T3i(){return T=>{y.a.lg(T.Errors)?d.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):
d.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static S3i(){return()=>{d.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}Object(t.a)(ea,"MoreColorsHelper",null,[641,2]);class ha extends f.a{constructor(T){super();this.$=T;this.Mb()}create(){const T=new b.a;this.$.Fz(Ha=>{Ha=Ha.Otf();e.TaskExtensions.za(Ha,()=>{T.setResult(!0)},this.$.ka)});const ua=T.task;this.vb(this.$.da.Aa(398)||
new ea(this.$,ua))}static la(T){T.da.Ha(397,new ha(T))}}Object(t.a)(ha,"MoreColorsHelperFactory",f.a,[]);a.d(C,"a",function(){return X});const X=()=>{c.a.Fa(T=>{ha.la(T)})}},1265:function(t,C,a){t={};a.r(t);a.d(t,"ThemesManager",function(){return D});var c=a(10),b=a(0),f=a(228),e=a(159),d=a(14),h=a(775),r=a(216),l=a(207),u=a(32),v=a(258),x=a(198);class w{constructor(){this.vJg=new x.a;this.wJg=new x.a}get dVa(){return this.vJg}get fig(){return this.wJg}get uG(){return this.nYj}aPg(P,E){this.dVa.add(P);
this.fig.add(E)}bPg(P,E){this.nYj={PBd:P,EAd:E}}}Object(b.a)(w,"ThemeInfoCache",null,[]);var m=a(65);const n=(P,E,H,G,N,I=null)=>{I=P.Oa(1,I);return m.g(P,"GetThemeInfoOld",I,E,H,G,N,4)},z=(P,E,H,G,N,I=null)=>{I=P.Oa(1,I);return m.g(P,"GetThemeInfo",I,E,H,G,N,4)};var y=a(1),A=a(157),F=a(41);let D=class{constructor(P){this.dVa=this.IL=null;this.nkc=!1;this.F_d=null;this.lpc=new Set;this.Ugb=this.wQc=!1;this.Fwb=0;this.kHf=E=>{this.nkc=!1;if(!E||v.a(E))d.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${E?
u.a.xc(E.Errors):"(no result)"}]`),this.Pud&&this.Q2f();else if(this.Pud&&(this.Fwb=0),E=E.Result){this.cm&&null!==this.IL&&this.vbh(E);this.IL=new w;if(this.DD){this.dVa=E.ThemeColors;this.F_d=[];for(var H=0;10>H;H++)this.F_d.push(h.a.qMa(r.a.wF(this.dVa[H])));for(H=0;6>H;H++)for(let G=0;10>G;G++){const N=l.a.Uea(l.a.wG(this.dVa[10*H+G])),I=h.a.P2h(H,G,this.F_d[G],this.dVa[G]);this.IL.aPg(N,I)}}this.cm&&(this.IL.bPg(E.MinorFont,E.MajorFont),this.Ugb=!1);this.wQc=!1;this.Cea()}else d.ULS.sendTraceTag(556656003,
0,10,"ThemesManager: The obtained ThemeInfo is null")};this.jHf=()=>{this.nkc=!1;this.Pud&&this.Q2f()};this.Q2f=()=>{3>this.Fwb?(this.Fwb++,d.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.Fwb}`),this.Vbc(null,!0)):(this.Fwb=0,d.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.xsc=()=>{this.IL&&(d.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),
this.cm?this.Ugb=!0:this.IL=null,this.Vbc(null,!0))};this.dd=(E,H)=>{this.IL&&(d.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),H.XH&&(this.wQc=!0))};this.Fy=()=>{this.lpc.clear()};this.$=P;this.$.ea.pM(this.xsc);this.$.ea.Zj(this.dd);this.$.Ia.G_a(this.Fy);this.DD=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.cm=y.EwaSettings.cm();this.Pud=y.EwaSettings.isChangeGateEnabled("OfficeVSO:7396333_RetryFetchThemeInfoApi")}get Vgb(){return!this.IL||
this.Ugb?null:this.IL.dVa}get eig(){return!this.IL||this.Ugb?null:this.IL.fig}get uG(){return!this.IL||this.Ugb?null:this.IL.uG}get Mvd(){return this.wQc}Vbc(P,E=!1){if(this.$.isEditMode||E)if(!this.IL||this.Mvd||this.Ugb)P&&""!==P&&this.lpc.add(P),this.nkc||(this.nkc=!0,y.EwaSettings.isChangeGateEnabled("OfficeVSO:7629234_ChangeGetThemeInfoOperationBehavior")?z(this.$.pa.va,this.kHf,this.jHf,null,null):n(this.$.pa.va,this.kHf,this.jHf,null,null))}getThemeColor(P){let E,H=-1;E=-1;if(!this.Vgb)return d.ULS.sendTraceTag(537150475,
0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,themeIndex:-1,WCa:E};for(let G=0;G<this.Vgb.count;G++)if(P===this.Vgb.ma(G)){H=G;break}if(-1!==H)return E=Math.floor(H/10),{returnValue:!0,themeIndex:H%10,WCa:E};d.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,WCa:E}}Cea(){for(let P of this.lpc)this.$.frame.Dx(P);this.lpc.clear()}vbh(P){const E=this.IL.uG.EAd;this.IL.uG.PBd===P.MinorFont&&E===P.MajorFont||d.ULS.sendTraceTag(512230155,
0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};D=Object(e.b)([Object(A.d)(F.eb),Object(e.c)(0,Object(F.u)())],D);Object(b.a)(D,"ThemesManager",null,[637]);class B extends f.a{constructor(P){super();this.$=P;this.Mb()}create(){let P=this.$.da.Aa(422);P||(P=new D(this.$),this.$.da.Ha(422,P));this.vb(P)}static la(P){P.da.Ha(421,new B(P))}}Object(b.a)(B,"ThemesManagerFactory",f.a,[]);var M=a(70);a.d(C,"a",function(){return R});const R=()=>{c.a.Fa(P=>{Object(M.b)("OfficeVSO:7628240_migrateThemesManagerToNewServiceInfra")||
B.la(P)})};String(t);window.___1680633025459_closurehack=t},1279:function(t,C,a){t={};a.r(t);a.d(t,"IndexedDB",function(){return y});var c=a(10),b=a(1),f=a(0),e=a(228),d=a(159),h=a(14),r=a(29),l=a(170),u=a(191),v=a(39),x=a(31);class w{constructor(D){this.keyPath=D}}Object(f.a)(w,"KeyPathClass",null,[]);var m=a(60),n=a(157),z=a(41);let y=class extends u.a{constructor(D){super();this.Dgb=this.Z9c=null;this.aNe=1;this.YXa=null;this.$=D}get indexedDBFactory(){this.YXa||(window.indexedDB?this.YXa=window.indexedDB:
window.webkitIndexedDB?this.YXa=window.webkitIndexedDB:window.mozIndexedDB?this.YXa=window.mozIndexedDB:window.msIndexedDB&&(this.YXa=window.msIndexedDB));return this.YXa}get initialized(){return!!this.Z9c&&!!this.Dgb}initialize(D,B,M){this.Z9c=D;this.Dgb=B;this.aNe=M}Pe(){try{return b.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&r.a.FOa||r.a.Nf&&91===r.a.Rwb?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(D){return h.ULS.sendTraceTag(537157640,
0,15,`IndexedDB.IsSupported() failed. Exception: ${D.message}`),!1}}Leb(D){return this.Pe()&&this.initialized?v.TaskExtensions.k4(this.kHd(),B=>{if(void 0===B.result&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;B=B.result;this.P7b(B);const M=x.a.Ya.Ce.m;this.Cld(B,!1).put(D);h.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${x.a.Ya.Ce.m-M} Millisecond.`);return!0},this.ka):(h.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),
m.Task.Ua(!1))}I$c(D){return this.Pe()&&this.initialized?v.TaskExtensions.k4(this.kHd(),B=>{if(void 0===B.result&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;B=B.result;this.P7b(B);const M=x.a.Ya.Ce.m;this.Cld(B,!1)["delete"](D);h.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${x.a.Ya.Ce.m-M} Millisecond.`);return!0},this.ka):(h.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),
m.Task.Ua(!1))}gMa(D){return this.Pe()&&this.initialized?v.TaskExtensions.Cdh(this.kHd(),B=>void 0===B.result&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash")?m.Task.Ua(""):this.O_h(B.result,D),this.ka):(h.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),m.Task.Ua(""))}P7b(D){D.objectStoreNames.contains(this.Dgb)||D.createObjectStore(this.Dgb,new w("key"))}kHd(){const D=new l.a;let B;B=this.indexedDBFactory.open(this.Z9c,
this.aNe);B.onsuccess=()=>{const M=B.result;h.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${M.name} success`);D.setResult(M)};B.onupgradeneeded=()=>{const M=B.result;h.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${M.name} upgrade needed`);try{this.P7b(M),h.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${M.name} upgrade done`)}catch(R){h.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${R}`),b.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?D.setResult(void 0):
D.setException(Error.create("Failed to upgrade IndexedDB"))}};B.onerror=M=>{h.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${M} failed`);D.setResult(void 0)};return D.task}Cld(D,B){return D.transaction([this.Dgb],B?"readonly":"readwrite").objectStore(this.Dgb)}O_h(D,B){const M=new l.a;this.P7b(D);const R=x.a.Ya.Ce.m,P=this.Cld(D,!0).get(B);P.onsuccess=E=>{(E=E.target.result)?(M.setResult(E.value),h.ULS.sendTraceTag(537157633,0,50,`IndexedDB.GetFromIndexedDB takes ${x.a.Ya.Ce.m-R} Millisecond.`)):
M.setResult("")};P.onerror=()=>{M.setException(Error.create(P.error?P.error.message:"DB error"))};return M.task}};y=Object(d.b)([Object(n.d)(z.G,{oI:"transient"}),Object(d.c)(0,Object(z.u)())],y);Object(f.a)(y,"IndexedDB",u.a,[309]);class A extends e.a{constructor(D){super();this.$=D;this.Mb()}create(){this.vb(new y(this.$))}static la(D){D.da.Ha(396,new A(D))}}Object(f.a)(A,"IndexedDBFactory",e.a,[]);a.d(C,"a",function(){return F});const F=()=>{c.a.Fa(D=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:7476522_IDBNewService2")||
A.la(D)})};String(t);window.___1680633015703_closurehack=t},1280:function(t,C,a){t={};a.r(t);a.d(t,"OAuthManagerWrapper",function(){return w});var c={};a.r(c);var b=a(10),f=a(0),e=a(84),d=a(228),h=a(159),r=a(2),l=a(14),u=a(871),v=a(157),x=a(41);let w=class{constructor(A){this.oAuthManager=A}JL(A,F){return this.oAuthManager?this.oAuthManager.JL(A,F).then(D=>{D.IsSuccess||l.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+D.ErrorMessage+" Error code: "+D.ErrorCode+" App name: "+
A);return Object(r.a)(new u.a,{IsSuccess:D.IsSuccess,Token:D.Token,ErrorCode:D.ErrorCode,ErrorMessage:D.ErrorMessage})}):(l.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(r.a)(new u.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}V7a(){return this.oAuthManager?this.oAuthManager.V7a():null}};w=Object(h.b)([Object(v.d)(x.O),Object(h.c)(0,Object(x.N)())],w);Object(f.a)(w,"OAuthManagerWrapper",
null,[806]);var m=a(721);class n extends d.a{constructor(A){super();this.$=A;this.Mb()}create(){this.vb(Object(m.a)(this.$.da,349,()=>new w(e.a.instance.resolve("Common.App.OAuth.IOAuthManager"))))}static la(A){A.da.Ha(350,new n(A))}}Object(f.a)(n,"OAuthManagerWrapperFactory",d.a,[]);var z=a(70);Object(v.b)(x.N)(()=>e.a.instance.resolve("Common.App.OAuth.IOAuthManager"));a.d(C,"a",function(){return y});const y=()=>{b.a.Fa(A=>{Object(z.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")||n.la(A)})};
String(t);String(c);window.___1680633018427_closurehack=t;window.___1680633018427_closurehack=c},1281:function(t,C,a){var c=a(10),b=a(159);t=a(0);var f=a(14),e=a(228),d=a(39),h=a(54),r=a(1),l=a(299),u=a(221);class v{}v.IVe="ewa-svg-icon";Object(t.a)(v,"CssClassNames",null,[]);var x=a(53),w=a(13),m=a(325),n=a(109),z=a(157),y=a(41);class A{constructor(B,M){this.Sb=null;this.gg=()=>{this.Ktf();this.$.ea.rn(this.gg)};this.$=B;this.Xgg={};this.OZd={};this.Sb=M;(M=this.O6e("excelInitialAppSprite"))?(this.vse(M),
this.$.ea.Bf?this.Ktf():B.ea.mk(this.gg),this.$.da.Ha(388,this)):f.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.OZd=null;this.$.ea.rn(this.gg)}ila(B,M,R=null,P=null){let E;(E=this.OZd[B])||(this.OZd[B]=E=this.T9i(this.Xgg[B]));if(!E)return f.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${B} was not found in loaded SVG sprites.`),null;const H=E.cloneNode(!0);if(!H.style){const G=m.b(E),N=m.b(H),I={};I.iconId=B;I.isOriginalNodeStyleNull=
void 0===E.style||null===E.style;I.isOriginalNodeCurrentStyleNull=void 0===E.currentStyle||null===E.currentStyle;I.isClonedNodeCurrentStyleNull=void 0===H.currentStyle||null===H.currentStyle;I.originalNode=G.substring(0,G.indexOf(">")+1);I.clonedNode=N.substring(0,N.indexOf(">")+1);f.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(I)}`)}H.setAttribute("style",`height: ${M}px; width: ${M}px;`);P&&(B=document.createElement("title"),
this.Sb.uh(B,P),H.insertBefore(B,H.childNodes[0]));if(R)for(const G of R)Sys.UI.DomElement.addCssClass(H,G);return H}Fca(B,M,R,P,E=0,H=0,G=null,N=null){E&&H||(H=w.DOMElementExtensions.getBoundingClientRect(P),E=H.height,H=H.width);if(G=this.ila(B,M,G,N))P.appendChild(G),(P=w.DOMElementExtensions.$Z(G,"style",null))?G.setAttribute("style",P+` margin: ${(E-M)/2}px ${(H-R)/2}px;`):f.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${B}`);
return G}Ktf(){r.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?void z.a.resolve(y.r,{rb:0}).then(B=>B("excel-uiSlice20-sprite")).then(()=>this.tse()):d.TaskExtensions.za(x.GetServiceTaskFactory.Sa(this.$.da,283,284,0),B=>{B=n.d(B.result.ol.loadScript("excel-uiSlice20-sprite"));d.TaskExtensions.za(B,()=>{this.tse()},this.$.ka,3)},this.$.da.ka,3)}tse(){const B=this.O6e("excelUiSlice20Sprite");B?this.vse(B):f.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}vse(B){for(const M of B)M.type===
u.a.MZd&&(this.Xgg[M.id]=M)}T9i(B){if(!B)return null;const M=B.viewBox;B=B.children;const R=document.createElementNS(l.a.PZd,u.a.MZd);Sys.UI.DomElement.addCssClass(R,v.IVe);R.setAttribute("focusable","false");R.setAttribute("viewBox",M);this.VOg(R,B);return R}VOg(B,M){for(const P of M){const E=document.createElementNS(l.a.PZd,P.type);for(let H in P){M=H;var R=P[H];"className"===M?E.setAttribute("class",R):E.setAttribute(M,R)}B.appendChild(E)}}O6e(B){return(B=window[B])?B.icons:null}}Object(t.a)(A,
"SvgIconProvider",null,[446,2]);class F extends e.a{constructor(B){super();this.$=B;this.Mb()}create(){const B=this.YFi(),M=Object(n.d)(z.a.resolve(y.F,{rb:0}));d.TaskExtensions.za(d.TaskExtensions.Pd([B,M],this.$.ka),()=>{window.excelInitialAppSprite?this.vb(this.$.da.Aa(388)||new A(this.$,M.result)):f.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}YFi(){if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:7521802_OnboardWdAppChromeVersion")){let B;B=r.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?
z.a.resolve(y.r,{rb:this.Na}).then(M=>Object(b.a)(this,void 0,void 0,function*(){return M("excel-app-intl")})):r.EwaSettings.isChangeGateEnabled("OfficeVSO:7690411_FixJsCrashInSvgIconProvider")?x.GetServiceTaskFactory.bR(this.$.da,283,284,this.Na).then(M=>M.ol.loadScript("excel-app-intl")):x.GetServiceTaskFactory.Sa(this.$.da,283,284,this.Na).result.ol.loadScript("excel-app-intl");return Object(n.d)(B)}return h.a.HR([130],4,this.Na,void 0,void 0,void 0,387)}static la(B){B.da.Ha(387,new F(B))}}Object(t.a)(F,
"SvgIconProviderFactory",e.a,[]);a.d(C,"a",function(){return D});const D=()=>{c.a.Fa(F.la)}},1327:function(t,C,a){t=a(0);var c=a(14),b=a(874),f=a(966),e=a(6),d=a(104),h=a(566),r=a(260),l=a(42),u=a(43),v=a(29),x=a(117),w=a(84),m=a(200);class n{get name(){return"Common.App.OAuth.OAuthPackage"}ki(y){y.register(635,"Common.App.OAuth.IOAuthManager").zc().Gc(()=>new b.OAuthManager)}init(){const y=w.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.U2j(y)}U2j(y){const A=e.AFrameworkApplication.fa.Wa("FileSource");
if(e.AFrameworkApplication.fa.ra("IsO365ConsumerHost")||e.AFrameworkApplication.fa.ra("IsO365CommercialHost")||"WopiTest"===A){var F=h.OAuthManagerSettings.x7c;if(F&&F.IsEnabled){var D=F.Application,B=h.OAuthManagerSettings.authority;if(void 0!==D&&null!==D&&D.length&&void 0!==B&&null!==B&&B.length){var M=f.a[y.dT],R=v.a.Zta,P=y.Lv();try{var E=new Map;void 0!==E&&null!==E?(E.set("SupportStatus",M),E.set("Browser",R),E.set("AuthStrategy",P)):E=null}catch(G){E=null}d.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT",
"WacOAuthFC",E);var H=u.a.ee();y.JL("Core",D).then(G=>{const N=Math.floor(u.a.ee()-H);M=f.a[y.dT];R=v.a.Zta;P=y.Lv();c.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',N,G.IsSuccess,M,G.ErrorCode,A,R,P);E&&(E.set("SupportStatus",M),E.set("Browser",R),E.set("AuthStrategy",P));var I=Object.assign(new m.a,{durationMs:N,extendedProperties:E});
if(G.IsSuccess){if(d.Health.instance.recordKpiSuccess("WacCorePFT",I),G="Bearer "+G.Token,e.AFrameworkApplication.Od.C4d=G,I=F.Endpoint){var O=u.a.ee();e.AFrameworkApplication.Od.Jpb(I,1,null,{["Authorization"]:G},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(U=>{var ca=Math.floor(u.a.ee()-O),Q=null;U.Ah?U="Canceled":U.Tf?U="Faulted":(Q=U.result,U=Q.succeeded?"Completed":"Failed");ca={["TaskResult"]:U,["BrowserTokenDurationMS"]:N,["BrowserValidationDurationMS"]:ca};Q&&(ca.HttpStatus=
Q.Ug.data.httpStatus,Q.succeeded&&(Q=l.a(Q.Ug.data.te),ca.ServerValidationDurationMS=Q.ElapsedMilliseconds,ca.ServerValidationResult=Q.ValidatedToken,ca.KMSI=Q.KMSI,ca.Scopes=Q.Scopes,ca.TokenExpirationS=Math.floor(parseInt(Q.Expiration)-(new Date).getTime()/1E3)));c.ULS.sendTraceTag(520632322,3E3,"Completed"===U?50:15,x.a.toJSON(ca))})}}else d.Health.instance.recordKpiFailure("WacCorePFT",G.ErrorCode,!1,!1,I)}).catch(G=>{var N=Math.floor(u.a.ee()-H);N=Object.assign(new m.a,{durationMs:N,extendedProperties:E});
d.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+G.toString(),!1,!1,N)})}}}}dispose(){}static main(){r.a.instance.dj(new n)}static jmj(){r.a.instance.dj(new n,0,!0)}}Object(t.a)(n,"OAuthPackage",null,[4,5]);a.d(C,"a",function(){return z});const z=y=>{Type.registerNamespace("Common.App.OAuth");y?n.jmj():n.main()}},1489:function(t,C,a){a.r(C);t=a(1279);C=a(1327);var c=a(1280),b=a(1177),f=a(1281),e=a(1178),d=a(1195),h=a(1227),r=a(1265),l=a(1218);a=a(1223);Object(t.a)();Object(C.a)();
Object(c.a)();Object(b.a)();Object(f.a)();Object(e.a)();Object(d.a)();Object(h.a)();Object(r.a)();Object(l.a)();Object(a.a)()},874:function(t,C,a){a.r(C);t=a(0);var c=a(14),b=a(1479),f=a(966),e;(function(ha){ha[ha.external=0]="external";ha[ha.msa=1]="msa";ha[ha.aad=2]="aad"})(e||(e={}));Object(t.b)("AuthorityType",e);var d=a(790);class h{constructor(ha){this.JEg=ha}initialize(){return Promise.resolve(0)}Nnc(){return Promise.resolve(0)}JL(){c.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");
return Promise.resolve(Object.assign(new d.a,{IsSuccess:!0,Token:this.JEg}))}rFc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}LDc(){return!1}rzb(){return"MockAuthTokenStrategy"}}Object(t.a)(h,"MockAuthTokenStrategy",null,[805]);var r=a(983);class l{static get(ha,X,T){if(!T)return ha;let ua=0;return Promise.race([ha,new Promise(Ha=>{ua=window.setTimeout(()=>
{Ha(X)},T)})]).then(Ha=>{window.clearTimeout(ua);return Promise.resolve(Ha)}).catch(()=>{window.clearTimeout(ua);return Promise.resolve(X)})}}Object(t.a)(l,"PromiseWithTimeout",null,[]);var u=a(6),v=a(566);class x{constructor(ha,X,T,ua,Ha){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=ha;this.scope=X;this.silentLogin=T;this.options=ua;this.correlationId=Ha}}Object(t.a)(x,"TokenRequestParameters",null,[782]);var w=a(29),m=a(84);class n{constructor(){this.tpe=
null;let ha=u.AFrameworkApplication.fa.Wa(u.AFrameworkApplication.h9),X=u.AFrameworkApplication.fa.Wa(u.AFrameworkApplication.mlg);this.EZa=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ha&&""!==ha?ha:"Unspecified",X&&""!==X?X:"Unspecified")}initialize(){return new Promise(ha=>{m.a.instance.$b("Common.App.WopiIdentity.IWopiIdentity").execute(X=>{this.tpe=X;ha(0)})})}Gi(ha){const X=["HTTPS:","API:"];let T=!1;const ua=ha.toLocaleUpperCase();for(const Ha of X)if(ua.startsWith(Ha)){T=
!0;break}return T||this.ivi(ha)?ha+"/.default":ha}ivi(ha){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ha)}Nnc(){return Promise.resolve(0)}JL(ha,X,T,ua,Ha,Ca,Ga){if(w.a.Gya){Ha=v.OAuthManagerSettings.Ibk;if(!Ha)return X=Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(X);if(!Array.contains(Ha,ha))return X=Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",
ErrorMessage:"Disallowed appName: "+ha}),Promise.resolve(X)}ha=this.Gi(T);T=new x(T,ha,!ua,null,u.AFrameworkApplication.userSessionId);return this.tpe.getAccessToken(T,X,Ga).then(sa=>Object.assign(new d.a,{IsSuccess:!0,Token:sa.accessToken}),sa=>Object.assign(new d.a,{IsSuccess:!1,ErrorCode:sa}))}rFc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}LDc(){return!1}rzb(){return this.EZa}}
Object(t.a)(n,"ParentFrameTokenStrategy",null,[805]);var z=a(88),y=a(881),A=a(198);class F{constructor(){this.reject=this.resolve=null;this.startTime=0;this.zTf=this.yze=null}}Object(t.a)(F,"PromiseWrapper",null,[]);class D{constructor(ha=0){this.oC=0;this.enb=!1;this.Ym=new A.a;this._timeout=ha}enqueue(ha){return new Promise((X,T)=>{this.Ym.add(Object.assign(new F,{zTf:ha,resolve:X,reject:T}));this.process()})}process(){if(this.enb||this.oC===this.Ym.count)return!1;const ha=this.Ym.ma(this.oC++);
try{this.enb=!0,ha.zTf().then(X=>{this.enb=!1;this.x6c(ha,X,null,!0)}).catch(X=>{this.enb=!1;this.x6c(ha,null,X,!1)})}catch(X){this.enb=!1,this.x6c(ha,null,X,!1)}return!0}x6c(ha,X,T,ua){if(ua){const Ha=()=>{ha.resolve(X);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}else{const Ha=()=>{ha.reject(T);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}}}Object(t.a)(D,"PromiseQueue",null,[]);class B{constructor(){this.correlationId=this.resolve=
null}}Object(t.a)(B,"ResolveWithCorrelation",null,[]);var M=a(89),R=a(160),P=a(764),E=a(175);class H extends R.a{constructor(ha,X,T,ua,Ha,Ca){super(!1,!1,!0);this.C$d=this.o2=null;this.FY=ha;this.oGg=T;this.lw=ua;this.XJg=Ha;this.CFa=Ca;this.kt=document.createElement("iframe");this.kt.id="SharedAuthInteractiveFrame";this.kt.setAttribute("name","SharedAuthInteractiveFrame");this.kt.setAttribute("title","SharedAuthInteractiveFrame");this.kt.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.kt.style.border="0";this.kt.style.height="48px";this.kt.style.width="190px";$addHandler(this.kt,"error",Object(z.a)(this,this.M4i,"onSharedAuthFrameError"));ha=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.FY,X,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",u.AFrameworkApplication.userType);this.kt.src=ha;this.Izg=new Promise(Ga=>{this.C$d=Ga});this.D$d=!1}PBc(){this.o2={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.oGg,
["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:u.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(z.a)(this,this.Mhh,"createFrame"),["resolveDialogStyles"]:this.C$d}};this.Xb=5;this.initializeAndShow(CommonUIStrings.l_SignIn,Object(z.a)(this,this.YJj,"sharedAuthConsentDialogHandler"),this.o2)}NGc(ha=!1,X=!1,T=5){this.o2&&this.o2.bodyControls&&(ha!==Object(M.a)(Object,this.o2.bodyControls).frameLoaded&&(Object(M.a)(Object,this.o2.bodyControls).frameLoaded=ha),X!==Object(M.a)(Object,
this.o2.bodyControls).frameLoadSuccess&&(Object(M.a)(Object,this.o2.bodyControls).frameLoadSuccess=X),T!==this.o2.dialogButtonsOption&&(this.o2.dialogButtonsOption=null,this.Xb=T),this.update(this.o2))}CQj(ha,X){const T=new P.a(E.a.bKj);T.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:u.AFrameworkApplication.isRtl,["messageCorrelationId"]:ha,["dialogStyles"]:X};this.lw.w8(T,this.kt.contentWindow,this.FY)}e1e(){this.NGc(!0,!1,6)}get bag(){return this.kt}get Xqh(){return this.Izg.then(ha=>
{this.D$d=!0;return ha})}get Yqh(){return this.D$d}M4i(){this.e1e()}Mhh(){return this.kt}YJj(ha){0===ha&&(this.XJg.reject(Object.assign(new d.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.CFa(null))}}Object(t.a)(H,"SharedAuthConsentDialog",R.a,[824]);var G=a(879),N=a(104),I=a(145),O=a(43),U=a(181),ca=a(200);class Q{constructor(){this.kt=null;this.hWb=0;this.rmb=this.UZa=this.VJc=this.CFa=this.hM=this.poe=null;this.lw=new G.a(null,null);this.EZa=
"SharedAuthTokenStrategy Unloaded";this.FY=v.OAuthManagerSettings.$Jj;this.rme=v.OAuthManagerSettings.ZJj;this.oae=v.OAuthManagerSettings.enableConsoleLogging;this.gAg=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.tIg=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.Csa={};this.ECg=new D(1500)}rzb(){return this.EZa}initialize(){var {OAuthManager:ha}=a(874);if("loadFrame"in
this.Csa)return this.Csa.loadFrame.yze;if(!this.FY)return N.Health.instance.recordKpiFailure(ha.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),c.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);ha=this.pDc("loadFrame");this.hWb=O.a.ee();var X=this.FY+this.rme+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+u.AFrameworkApplication.userSessionId+"&WacUserType="+u.AFrameworkApplication.userType;this.kt=
document.createElement("iframe");this.pmi(this.kt);this.kt.style.cssText="height:0;width:0;display:none;";this.kt.id="SharedAuthFrame";this.kt.setAttribute("name","SharedAuthFrame");this.kt.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.kt.setAttribute("title","SharedAuthFrame");this.kt.src=X;document.body.appendChild(this.kt);X=O.a.ee()-this.hWb;c.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
X,this.kt.src);return ha}Nnc(ha){this.VJc=ha;const X=new P.a(E.a.eag);X.Values=this.Yye(ha);ha=this.pDc("initFrame");this.lw.w8(X,this.kt.contentWindow,this.FY);c.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ha}JL(ha,X,T,ua,Ha,Ca){const Ga=new P.a(E.a.cKj),sa=this.G9e();Ga.Values=this.Ekg(ha,X,T,ua,Ha,Ca,sa);ha=this.pDc(sa);ua&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?
this.ECg.enqueue(()=>new Promise(bb=>{this.l2j(Ca,Ga,bb,sa)})):(this.lw.w8(Ga,this.kt.contentWindow,this.FY),c.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",X));return ha}l2j(ha,X,T,ua){const Ha=this.Csa[ua];Ha&&(this.UZa=X,this.CFa=Object.assign(new B,{resolve:T,correlationId:ua}),this.hM=new H(this.FY,this.rme,ha,this.lw,Ha,T),this.hM.PBc())}G9e(){return U.a.create().toString()}Ekg(ha,X,T,ua,Ha,Ca,Ga){const sa={};sa.appName=ha;sa.appId=X;
sa.target=T;sa.withPopup=ua;sa.claims=Ha;sa.promptMessage=Ca;sa.messageCorrelationId=Ga;return sa}pmi(ha){$addHandler(ha,"load",Object(z.a)(this,this.H_i,"onIFrameLoaded"));$addHandler(ha,"error",Object(z.a)(this,this.Grc,"onIFrameError"));this.lw.QP(this.FY);this.lw.Am(E.a.hag);this.lw.Lk(E.a.hag,Object(z.a)(this,this.d4i,"onScriptLoaded"));this.lw.Am(E.a.gag);this.lw.Lk(E.a.gag,Object(z.a)(this,this.c4i,"onScriptInitialized"));this.lw.Am(E.a.cag);this.lw.Lk(E.a.cag,Object(z.a)(this,this.i_i,"onGetTokenResponse"));
this.lw.Am(E.a.iag);this.lw.Lk(E.a.iag,Object(z.a)(this,this.a1i,"onLoginResponse"));this.lw.Am(E.a.fag);this.lw.Lk(E.a.fag,Object(z.a)(this,this.d0i,"onInteractiveFlowReady"));this.lw.Am(E.a.dag);this.lw.Lk(E.a.dag,Object(z.a)(this,this.A_i,"onHideDialog"));this.lw.Am(E.a.aag);this.lw.Lk(E.a.aag,Object(z.a)(this,this.AVi,"onCloseDialog"))}pDc(ha){const X=new F;X.startTime=O.a.ee();const T=new Promise((ua,Ha)=>{X.resolve=ua;X.reject=Ha});X.yze=T;this.Csa[ha]=X;return T}H_i(){const ha=O.a.ee()-this.hWb;
c.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ha)}Grc(ha){const {OAuthManager:X}=a(874),T=O.a.ee()-this.hWb,ua=Object.assign(new ca.a,{durationMs:T});N.Health.instance.recordKpiFailure(X.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ua);c.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",T,this.oae?JSON.stringify(ha):"")}d4i(ha){const {OAuthManager:X}=a(874),T=this.Csa.loadFrame;var ua=O.a.ee()-T.startTime,Ha=ha.Values.AuthLibrary.toString();
ha=ha.Values.Success.toString();c.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ha,Ha,ua);Ha&&(this.EZa="SharedAuthTokenStrategy "+Ha);Ha=Boolean.parse(ha);Ha||(ha=I.a.gs(),void 0!==ha&&null!==ha&&(ha.set("AuthLibrary",this.rzb()),ua=Object.assign(new ca.a,{durationMs:ua,extendedProperties:ha}),N.Health.instance.recordKpiFailure(X.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ua)));T.resolve(Ha?0:1)}c4i(ha){if(ha.Values.interactive&&
this.UZa&&this.UZa.Values.messageCorrelationId){const T=this.UZa.Values.messageCorrelationId.toString();if(ha.Values.interactive&&this.hM){this.hM.Xqh.then(ua=>{this.lw.w8(this.UZa,this.hM.bag.contentWindow,this.FY);this.hM.CQj(T,ua);this.hM.NGc(!0,!0);this.UZa=null});return}}ha=this.Csa.initFrame;const X=O.a.ee()-ha.startTime;c.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",X);ha.resolve(0)}i_i(ha){if(ha.Values.messageCorrelationId&&ha.Values.messageCorrelationId.toString()){var X=
ha.Values.messageCorrelationId.toString(),T=this.Csa[X];if(T){var ua=O.a.ee()-T.startTime;c.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ua);ha.Values.isSuccess&&ha.Values.isSuccess?T.resolve(ha.Values.response):T.reject(ha.Values.response);this.Ukg(X)}else c.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else c.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}d0i(){if(this.hM.Yqh)this.hM.e1e();
else if(this.VJc&&this.hM){const ha=new P.a(E.a.eag);ha.Values=this.Yye(this.VJc,!0);this.lw.w8(ha,this.hM.bag.contentWindow,this.FY)}}A_i(){this.hM&&this.hM.yAb()}AVi(ha){ha.Values.cancelled&&ha.Values.cancelled&&ha.Values.messageCorrelationId&&this.Ukg(ha.Values.messageCorrelationId.toString());this.hM&&this.hM.hide()}Yye(ha,X=!1){const T={};T.appIds=this.ITh();T.upn=ha.loginHint;T.authority=ha.authority;T.authorityType=Object(b.a)(e,ha.authorityType);T.tenantId=ha.tenantId;T.correlationId=u.AFrameworkApplication.userSessionId;
T.enableConsoleLogging=this.oae;T.enablePopupFlash=this.gAg;T.skipUpnCheck=this.tIg;T.interactive=X;return T}ITh(){const ha=[],X=v.OAuthManagerSettings.q0c;for(let T in X)Array.add(ha,X[T]);return ha}rFc(ha,X,T,ua,Ha,Ca){const Ga=new P.a(E.a.aKj),sa=this.G9e();Ga.Values=this.Ekg(ha,X,T,ua,Ha,Ca,sa);this.poe=Ga;ha=this.pDc(sa);c.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",X);this.oOj();return ha}LDc(){return!0}oOj(){this.rmb||(this.rmb=new y.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.rmb.id=16,this.rmb.Ltd=!1,this.rmb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{c.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.lw.w8(this.poe,this.kt.contentWindow,this.FY)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),c.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}a1i(ha){if(ha.Values.messageCorrelationId&&
ha.Values.messageCorrelationId.toString()){var X=this.Csa[ha.Values.messageCorrelationId.toString()];if(X){var T=O.a.ee()-X.startTime;c.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",T);ha.Values.isSuccess&&ha.Values.isSuccess?X.resolve(ha.Values.response):X.reject(ha.Values.response)}else c.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else c.ULS.sendTraceTag(555049439,3E3,10,
"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}Ukg(ha){this.CFa&&this.CFa.correlationId===ha&&(this.CFa.resolve(null),this.CFa=null)}}Object(t.a)(Q,"SharedAuthTokenStrategy",null,[805]);class Y{constructor(ha){this.iUc=ha;this.EZa="UnsupportedAuthTokenStrategy Reason="+f.a[this.iUc]}initialize(){return Promise.resolve(0)}Nnc(){return Promise.resolve(0)}JL(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:f.a[this.iUc],ErrorMessage:"Unable to get a token. Reason: ["+
f.a[this.iUc]+"]"}))}rFc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}LDc(){return!1}rzb(){return this.EZa}}Object(t.a)(Y,"UnsupportedAuthTokenStrategy",null,[805]);var la=a(740);a.d(C,"OAuthManager",function(){return ea});class ea{constructor(ha=null){this.dT=0;this.tP=null;this.UGg=0;const X=O.a.ee();this.tCg=this.nqh(ha).then(T=>T?this.Bki():
(c.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.Lv(),Math.floor(O.a.ee()-X)),T=I.a.gs(),void 0!==T&&null!==T&&(T.set("AuthLibrary",this.Lv()),T=Object.assign(new ca.a,{durationMs:Math.floor(O.a.ee()-X),extendedProperties:T}),N.Health.instance.recordKpiFailure(ea.kpiName,"StrategyPickFailed",!1,!0,T)),Promise.resolve(1))).then(T=>0!==T?Promise.resolve(T):this.TFi())}oqh(){var ha=v.OAuthManagerSettings.zOi;ha&&
0<ha.length?(this.dT=1,this.tP=new h(ha)):u.AFrameworkApplication.fa.ra("IsO365ConsumerHost")||u.AFrameworkApplication.fa.ra("IsO365CommercialHost")?u.AFrameworkApplication.fa.ra("IsAnonymousUser")?(this.dT=2,this.tP=new Y(this.dT)):(ha=r.a.getAuthContext().loginHint)&&ha.length?v.OAuthManagerSettings.CAb?(this.dT=1,this.tP=new n):(this.dT=1,this.tP=new Q):(this.dT=3,this.tP=new Y(this.dT)):(this.dT=4,this.tP=new Y(this.dT))}Lv(){return this.tP?this.tP.rzb()||"Unknown":"None"}nqh(ha=null){c.ULS.sendTraceTag(562128578,
3E3,50,"Creating OAuthManager.");const X=O.a.ee();return u.AFrameworkApplication.fa.rjd().then(T=>{T?(this.oqh(),ha&&(this.tP=ha),c.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.hth,this.Lv(),Math.floor(O.a.ee()-X))):c.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(O.a.ee()-X));return Promise.resolve(T)},()=>{c.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(O.a.ee()-X));return Promise.resolve(!1)})}Bki(){c.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.Lv());const ha=O.a.ee();return l.get(this.tP.initialize(),2,v.OAuthManagerSettings.IKd).then(X=>{if(0===X)c.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.Lv(),Math.floor(O.a.ee()-ha));else if(1===X){c.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.Lv(),Math.floor(O.a.ee()-ha));var T=I.a.gs();void 0!==T&&null!==T&&(T.set("AuthLibrary",this.Lv()),T=Object.assign(new ca.a,{durationMs:Math.floor(O.a.ee()-ha),extendedProperties:T}),N.Health.instance.recordKpiFailure(ea.kpiName,"StrategyInitFailed",!1,!0,T))}else 2===X&&(c.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.Lv(),Math.floor(O.a.ee()-ha)),T=I.a.gs(),void 0!==T&&null!==T&&(T.set("AuthLibrary",this.Lv()),T=Object.assign(new ca.a,{durationMs:Math.floor(O.a.ee()-ha),extendedProperties:T}),N.Health.instance.recordKpiFailure(ea.kpiName,"StrategyInitTimedOut",!1,!0,T)));return Promise.resolve(X)},()=>{c.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Lv(),Math.floor(O.a.ee()-ha));return Promise.resolve(1)})}TFi(){c.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.Lv());const ha=O.a.ee();return l.get(this.tP.Nnc(r.a.getAuthContext()),2,v.OAuthManagerSettings.IKd).then(X=>{if(0===X)c.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.Lv(),Math.floor(O.a.ee()-ha));else if(1===X){c.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Lv(),Math.floor(O.a.ee()-ha));var T=I.a.gs();void 0!==T&&null!==T&&(T.set("AuthLibrary",this.Lv()),T=Object.assign(new ca.a,
{durationMs:Math.floor(O.a.ee()-ha),extendedProperties:T}),N.Health.instance.recordKpiFailure(ea.kpiName,"StrategyLoadFailed",!1,!0,T))}else 2===X&&(c.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.Lv(),Math.floor(O.a.ee()-ha)),T=I.a.gs(),void 0!==T&&null!==T&&(T.set("AuthLibrary",this.Lv()),T=Object.assign(new ca.a,{durationMs:Math.floor(O.a.ee()-ha),extendedProperties:T}),N.Health.instance.recordKpiFailure(ea.kpiName,"StrategyLoadTimedOut",
!1,!0,T)));return Promise.resolve(X)},()=>{c.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.Lv(),Math.floor(O.a.ee()-ha));return Promise.resolve(1)})}JL(ha,X,T=null){return this.pFc(ha,X,!1,null,"",T)}Fkg(ha,X,T,ua,Ha=null){return this.pFc(ha,X,!0,T,ua,Ha)}pFc(ha,X,T,ua,Ha,Ca,Ga=0){Ga+=1;c.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ha,this.WSa(ha,
X),this.Lv(),Ga);var sa=I.a.gs();void 0!==sa&&null!==sa&&(sa.set("AuthLibrary",this.Lv()),sa.set("AppName",ha),sa.set("Target",this.WSa(ha,X)),N.Health.instance.recordKpiUsage(ea.kpiName,0,"WacOAuthFC",sa));if(!v.OAuthManagerSettings.isEnabled){var bb;return this.Uyd((bb=new d.a,bb.IsSuccess=!1,bb.Token=null,bb.ErrorCode="NotEnabled",bb.ErrorMessage="OAuthManager is disabled.",bb),ha)}const Ba=v.OAuthManagerSettings.q0c[ha];if(void 0===Ba||null===Ba){c.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
ha);var qa;return this.Uyd((qa=new d.a,qa.IsSuccess=!1,qa.Token=null,qa.ErrorCode="DisallowedApp",qa.ErrorMessage="Disallowed appName: "+ha,qa),ha)}const pa=O.a.ee(),ya=this;sa=this.tCg.then(nb=>ya.uqi(ha,Ba,X,T,ua,Ha,Ca,nb));bb=T?0:v.OAuthManagerSettings.IKd;let za;qa=(za=new d.a,za.IsSuccess=!1,za.Token=null,za.ErrorCode="authTokenStrategy_timeout",za.ErrorMessage="Auth Strategy timed out after ["+bb+"] ms when fetching token",za);let cb=this,Pa=this;return l.get(sa,qa,bb).then(nb=>Ga<=ea.kNi&&
(nb.ErrorCode===ea.Gig||nb.ErrorCode===ea.rVj)?(c.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Ga,Math.floor(O.a.ee()-pa)),cb.pFc(ha,X,T,ua,Ha,Ca,Ga)):nb.ErrorCode===ea.brf&&!T&&(c.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Ga,ea.mSe),ea.lwh&&cb.tP.LDc()&&cb.tP.rFc(ha,Ba,X,T,ua,Ha).then(Ma=>Promise.resolve(cb.ioc(Ma,ha,X,Ba,pa))).catch(()=>{let Ma;const Oa=(Ma=new d.a,Ma.IsSuccess=
!1,Ma.Token=null,Ma.ErrorCode="authTokenStrategy_failure",Ma.ErrorMessage="LoginPopup failed, GetToken could not be called",Ma);return Promise.resolve(cb.ioc(Oa,ha,X,Ba,pa))}),ea.mSe)?cb.pFc(ha,X,!0,ua,Ha,Ca,Ga):Promise.resolve(cb.ioc(nb,ha,X,Ba,pa))).catch(()=>{let nb;const Ma=(nb=new d.a,nb.IsSuccess=!1,nb.Token=null,nb.ErrorCode="authTokenStrategy_failure",nb.ErrorMessage="Auth Strategy failed with an unknown error",nb);return Promise.resolve(Pa.ioc(Ma,ha,X,Ba,pa))})}uqi(ha,X,T,ua,Ha,Ca,Ga,sa){return 1===
sa||2===sa?this.Uyd(Object.assign(new d.a,{IsSuccess:!1,Token:null,ErrorCode:1===sa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ha):this.tP.JL(ha,X,T,ua,Ha,Ca,Ga).then(bb=>Promise.resolve(this.aBf(bb,!0,ha))).catch(bb=>Promise.resolve(this.aBf(bb,!1,ha)))}ioc(ha,X,T,ua,Ha){const Ca={};Ha=O.a.ee()-Ha;Ca.IsSuccess=ha.IsSuccess;Ca.ErrorCode=ha.IsSuccess?"Success":ha.ErrorCode||"";Ca.ErrorMessage=ha.IsSuccess?"Success":this.WSa(X,ha.ErrorMessage||"");Ca.Target=this.WSa(X,
T||"");Ca.TimeInMS=Math.floor(Ha);Ca.AuthLibrary=this.Lv();Ca.AppName=X;Ca.AuthorityType=Object(b.a)(e,r.a.Ddc());Ca.UserType=this.wai(r.a.getAuthContext());Ca.IsAuthSupportedInSession=f.a[this.dT];Ca.RequestCount=++this.UGg;Ca.AppId=ua;c.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Ca));ha.IsSuccess||(T=I.a.gs(),void 0!==T&&null!==T&&(T.set("AppName",X),T.set("AuthLibrary",this.Lv()),T.set("ErrorCode",ha.ErrorCode),T.set("ErrorMessage",this.WSa(X,ha.ErrorMessage)),X=Object.assign(new ca.a,{durationMs:Ha,
extendedProperties:T}),N.Health.instance.recordKpiFailure(ea.kpiName,"TryGetTokenFailure",!1,!0,X)));return ha}Uyd(ha,X){c.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",X,this.WSa(X,ha.ErrorMessage));const T=I.a.gs();void 0!==T&&null!==T&&(T.set("AppName",X),T.set("AuthLibrary",this.Lv()),T.set("ErrorCode",ha.ErrorCode),T.set("ErrorMessage",this.WSa(X,ha.ErrorMessage)),X=Object.assign(new ca.a,{extendedProperties:T}),N.Health.instance.recordKpiFailure(ea.kpiName,
"FailureBeforeGetToken",!1,!0,X));return Promise.resolve(ha)}Ulf(ha){return ha===la.a.BEc}WSa(ha,X){return this.Ulf(ha)&&X?"REDACTED":X}wai(ha){return u.AFrameworkApplication.fa.ra("IsAnonymousUser")?"anonymous":!ha.loginHint||1>ha.loginHint.length?"empty":-1<ha.loginHint.indexOf("guest#")?"guest":-1<ha.loginHint.indexOf("ext#")?"external":0>ha.upn.indexOf("@")?"no-at":"supported"}V7a(){return 1===this.dT}aBf(ha,X,T){let ua=null,Ha=null,Ca=null,Ga=null;ha?ha.ErrorCode||ha.ErrorMessage?(Ha=ha.ErrorCode?
ha.ErrorCode:ea.rYe,Ca=ha.ErrorMessage?ha.ErrorMessage:"No message"):ha.Token?X?ua=ha.Token:(Ha=ea.cnj,Ca="A rejected promise returned a token."):(Ha=ea.rYe,Ca=JSON.stringify(ha)):(Ha=ea.SQi,Ca="No result came from Auth Token Strategy");ha&&ha.Telemetry&&!this.Ulf(T)&&(Ga=ha.Telemetry,c.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Ga)));if(Ha===ea.JOi||Ha===ea.l_j)Ha=ea.Gig,Ca="Auth Library Timed Out";Ha===ea.PYg&&-1<Ca.indexOf(ea.QKg)&&(Ha=ea.brf);if(Ha||Ca)ua=null;return Object.assign(new d.a,
{IsSuccess:!!ua,Token:ua,ErrorCode:Ha,ErrorMessage:Ca,Telemetry:Ga})}static get mSe(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get lwh(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}ea.l_j="token_renewal_error";ea.rYe="Exception";ea.SQi="NoResult";ea.cnj="RejectToken";ea.JOi="monitor_window_timeout";ea.Gig="Timeout";ea.rVj="authTokenStrategy_timeout";
ea.PYg="login_required";ea.QKg="AADSTS50058";ea.brf="Cookies Disabled";ea.kpiName="OAuthManager";ea.kNi=2;Object(t.a)(ea,"OAuthManager",null,[635])},966:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);var c;(function(b){b[b.unknown=0]="unknown";b[b.supported=1]="supported";b[b.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";b[b.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";b[b.hostUnsupported=4]="hostUnsupported"})(c||(c={}));Object(t.b)("SupportStatus",c)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.vrs.js.map/e8ca329a9b5764560bb474ee6841a2db/EwaDSOpt.vrs.js.map
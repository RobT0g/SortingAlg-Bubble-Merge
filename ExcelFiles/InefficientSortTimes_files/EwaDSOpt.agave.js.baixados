'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1E3:function(t,C,a){a.d(C,"a",function(){return c});const c=(b,f)=>{let e=!1;b&&(b=f.osfControl,(f=b.getManifest())&&f.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(e=!0));return e}},1001:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.oia=this.mVa=this.Hjd=this.Wld=this.tzb=this.t_d=null}}Object(t.a)(c,
"AppsForOfficeOauthResult",null,[])},1002:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}Object(t.a)(c,"GetEntitlementDetailsParameters",null,[])},1008:function(t,C,a){a.d(C,"a",function(){return c});const c=(b,f)=>OfficeExtension.WacRuntime.Utility.createPromise((e,d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,f))})},1239:function(t,C,a){a.r(C);t=a(0);var c=a(2),b=a(14),f=a(6),e=a(170),d=a(198),h=a(89),r=a(199),l=a(65),u=a(53),v=a(39),x=a(233),w=a(120),m=a(537);
class n{constructor(bb){bb=bb.split("|");this.Mx=bb[1];this.dWc=bb[2];this.hZd=bb[3]}get solutionId(){return this.Mx}get solutionVersion(){return this.dWc}get needToRestoreManifest(){return this.hZd===OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(n,"AddinStoreInfo",null,[]);class z{}Object(t.a)(z,"CustomFunctionRegistrationInfos",null,[]);var y=a(205),A=a(75);const F=(bb,Ba,qa)=>D(bb,Ba,y.a.none,A.a.current,qa),D=(bb,Ba,qa,pa,ya)=>{qa=bb.continueWith(()=>{Ba(bb)},3,qa,pa);qa.continueWith(()=>
{b.ULS.sendTraceTag(537163463,0,10,ya)},4);return qa},B=(bb,Ba,qa)=>M(bb,Ba,y.a.none,A.a.current,qa),M=(bb,Ba,qa,pa,ya)=>{qa=bb.Fo(()=>Ba(bb),3,qa,pa);qa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,ya)},4);return v.TaskExtensions.SFc(qa)},R=(bb,Ba,qa)=>P(bb,Ba,y.a.none,A.a.current,qa),P=(bb,Ba,qa,pa,ya)=>{qa=bb.Fo(()=>Ba(bb),3,qa,pa);qa.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,ya)},4);return qa},E=(bb,Ba,qa)=>H(bb,Ba,y.a.none,A.a.current,qa),H=(bb,Ba,qa,pa,ya)=>{qa=bb.Fo(()=>Ba(bb),
3,qa,pa);qa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ya)},4);return v.TaskExtensions.SFc(qa)},G=(bb,Ba,qa)=>N(bb,Ba,y.a.none,A.a.current,qa),N=(bb,Ba,qa,pa,ya)=>{qa=bb.continueWith(()=>{Ba(bb)},3,qa,pa);qa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,ya)},4);return qa},I=(bb,Ba)=>{R(a(1239).CustomFunctionsInstaller.s7e("CustomFunctionsRuntimeLogging"),qa=>{if(qa.result&&window.console)switch(qa=O(bb.severity)+" "+bb.message+Ba,bb.severity){case 2:window.console.log&&window.console.log(qa);
break;case 0:window.console.info&&window.console.info(qa);break;case 1:window.console.error&&window.console.error(qa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},O=bb=>{switch(bb){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var U=a(1E3);class ca{}Object(t.a)(ca,"InstallationInfo",null,[]);class Q{}Object(t.a)(Q,"UninstallationInfo",null,[]);var Y=a(31),la=a(98),ea=a(37),ha=a(32),X=a(1),T=
a(23),ua=a(293),Ha=a(813),Ca=a(60);class Ga{constructor(bb,Ba){this.CVc=bb;this._message=Ba}get severity(){return this.CVc}get message(){return this._message}}Object(t.a)(Ga,"CustomFunctionLog",null,[]);a.d(C,"CustomFunctionsInstaller",function(){return sa});class sa{constructor(bb,Ba,qa){this.mya=!1;this.GF={};this.$=bb;this.Jj=Ba;this.Oqd().Moa();this.indexedDB=qa;this.indexedDB.Pe()&&(this.mya=!0,this.indexedDB.initialize(sa.bBb,sa.cBb))}get UV(){return this.Jj.UV}tif(bb,Ba,qa,pa){if(pa.invariantNamespace)for(let ya=
0;ya<pa.invariantNamespace.length;++ya){const za=pa.invariantNamespace.charAt(ya);if("."!==za&&"_"!==za&&"a">za&&"z"<za&&"A">za&&"Z"<za&&"0">za&&"9"<za)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${za}', Position=${ya}.`),Error.create("InvariantNamespace validation failed");}return B(this.f4g(qa,pa.manifest),()=>B(this.SLd(bb),ya=>{let za=ya.result;return(null===za||void 0===za?0:za.isDynamicMetadata)?this.RMd(bb,
Ba,za,!1,!1,!1):B(this.ddk(bb,Ba,pa),cb=>{za=new ca;za.addinId=qa;za.locale=pa.locale;za.addinInvariantNamespace=pa.invariantNamespace;za.addinNamespace=pa.namespace;za.addinTitle=pa.title;za.isXllCompatible=pa.isXllCompatible;za.metadataContent=JSON.stringify(JSON.parse(cb.result));return this.RMd(bb,Ba,za,!1,sa.RJh(pa.osfControl.getStoreType()),U.a(this.$,pa))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),
"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}vif(bb,Ba,qa,pa){if(!sa.ewd(qa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return B(this.SLd(bb),ya=>{ya=ya.result;if(!ya&&(ya=ea.a.Mc(this.UV,bb),!ya))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(bb,
Ba,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ya.metadataContent=JSON.stringify(JSON.parse(qa));ya.isDynamicMetadata=!0;return this.RMd(bb,Ba,ya,!0,!0,pa)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Clg(bb,Ba){this.Jj.Rja();const qa=Object(c.a)(new Q,{solutionId:bb}),pa=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(bb,
Ba,null)}.`;return B(this.yNd(bb),()=>B(this.GNd(bb),()=>this.R1d(this.Jj,bb,Ba,qa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),pa)}ddk(bb,Ba,qa){const pa=new e.a;OSF.OUtil.xhrGet(qa.metadataUrl,ya=>{ya?pa.setResult(ya):pa.setException(Error.create("Invalid manifest"))},ya=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(bb,
Ba,null)}. ErrorCode: ${ya}.`);pa.Ps()});return pa.task}Oqd(){return B(this.xvc(),bb=>{const Ba=bb.result;if(!Ba.length)return Ca.Task.Ua(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");bb=new d.a;const qa=[];for(let pa=0;pa<Ba.length;pa++){const ya=Object(h.a)(String,Ba[pa]);bb.add(R(this.SLd(ya),za=>{if(za=za.result){const cb=ea.a.Mc(this.GF,za.addinId);cb&&cb===za.metadataContent||(this.GF[za.addinId]=
za.metadataContent,this.UV[ya]=za,qa.push(za))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return E(Ca.Task.WhenAllEnumerable(bb),()=>{if(qa.length){let pa=new z;pa.registrationInfos=qa;return this.J3b(this.Jj,Ba,pa)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return Ca.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},
"CustomFunctionsInstaller::InstallFromCacheAsync failed")}wif(){var bb=new e.a;new d.a;const Ba=[],qa=[];Object.keys(this.UV).forEach(pa=>{pa=Object(h.a)(String,pa);const ya=ea.a.Mc(this.UV,pa);Ba.push(ya);qa.push(pa)});if(!qa.length)return bb.setResult(!0),bb.task;bb=Object(c.a)(new z,{registrationInfos:Ba});return this.J3b(this.Jj,qa,bb)}xvc(){return R(this.Zjd(m.a.S_a),bb=>{bb=bb.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(bb||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(bb||
"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Hrg(bb){return this.aUd(m.a.S_a,Sys.Serialization.JavaScriptSerializer.serialize(bb))}SLd(bb){return B(this.Zjd(m.a.e6a(bb)),Ba=>{Ba=Ba.result||"";return 0<Ba.length?Ca.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(Ba,!0)):Ca.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}Wck(bb,Ba){return B(this.RSe(bb),
()=>B(this.aUd(m.a.e6a(bb),Sys.Serialization.JavaScriptSerializer.serialize(Ba)),()=>sa.bUd(m.a.Nnd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}yNd(bb){return B(this.HYf(bb),()=>B(this.XYf(m.a.e6a(bb)),()=>B(this.xvc(),Ba=>Ba.result.length?Ca.Task.Ua(!0):sa.bUd(m.a.Nnd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),
"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}SVf(bb){return this.Zjd(m.a.d6a(bb))}Erg(bb,Ba){return B(this.RSe(bb),()=>this.aUd(m.a.d6a(bb),Ba),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}GNd(bb){return B(this.HYf(bb),()=>this.XYf(m.a.d6a(bb)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}RSe(bb){return B(this.xvc(),
Ba=>{Ba=Ba.result;const qa=bb.toLowerCase();if(Ba.includes(qa))return Ca.Task.Ua(!0);Ba.push(qa);return this.Hrg(Ba)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}HYf(bb){return B(this.xvc(),Ba=>{Ba=Ba.result;const qa=bb.toLowerCase();return Ba.includes(qa)?(Ba.splice(Array.indexOf(Ba,qa),1),this.Hrg(Ba)):Ca.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}f4g(bb,
Ba){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return bb=new OSF.AddinIdInfo(bb),bb.needToRestoreManifest()?this.Erg(bb.getSolutionId(),Ba):Ca.Task.Ua(!0);bb=new n(bb);return bb.needToRestoreManifest?this.Erg(bb.solutionId,Ba):Ca.Task.Ua(!0)}Mvj(bb){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const qa=new OSF.AddinIdInfo(bb);return qa.needToRestoreManifest()?R(this.SVf(qa.getSolutionId()),pa=>{(pa=pa.result)&&
OSF.OsfManifestManager.cacheManifestFromXml(qa.getSolutionId(),qa.getSolutionVersion(),pa,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Ca.Task.Ua(!0)}const Ba=new n(bb);return Ba.needToRestoreManifest?R(this.SVf(Ba.solutionId),qa=>{(qa=qa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ba.solutionId,Ba.solutionVersion,qa,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):
Ca.Task.Ua(!0)}XYf(bb){return this.mya?this.indexedDB.I$c(bb):sa.ioj(bb)}aUd(bb,Ba){return this.mya?this.indexedDB.Leb(new Ha.a(bb,Ba)):sa.bUd(bb,Ba)}Zjd(bb){return this.mya?this.indexedDB.gMa(bb):sa.s7e(bb)}RMd(bb,Ba,qa,pa,ya,za){const cb=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(bb,Ba,null)}.`;return v.TaskExtensions.SFc(R(this.SMd(this.Jj,bb,Ba,qa,!1,pa,za),()=>ya?this.Wck(bb,qa):Ca.Task.Ua(!0),
cb))}SMd(bb,Ba,qa,pa,ya,za,cb){if(!za&&(za=ea.a.Mc(this.GF,pa.addinId))&&za===pa.metadataContent)return Ca.Task.Ua(!0);this.GF[pa.addinId]=pa.metadataContent;this.UV[Ba]=pa;cb||bb.nLb(Ba);bb.Rja();return B(this.zlj(Ba,qa,pa),()=>this.AKd(pa.addinId,ya),"Failed to register functions for customfunction addin")}zlj(bb,Ba,qa){const pa=new e.a,ya=this.DIa(qa);return this.W4(za=>{I(sa.Lub,bb);(za=za.Result)&&204===za.ResponseStatusCode?pa.setResult(!0):(delete this.GF[qa.addinId],delete this.UV[bb],F(this.yNd(bb),
()=>{F(this.GNd(bb),()=>{this.ncg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${bb}. Received status code ${za?za.ResponseStatusCode.toString():"Unknown"}.`),pa.setResult(!1))},za=>{za=w.a.Ye(za.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(bb,Ba,null)}. Errors: ${ha.a.xc(za)}.`);
I(sa.Kub,bb);delete this.GF[qa.addinId];delete this.UV[bb];pa.setResult(!1)},ya,pa,!0)}J3b(bb,Ba,qa){const pa=new e.a,ya=Y.a.Ya.Ce.m;Ba.forEach(cb=>{cb=Object(h.a)(String,cb);bb.pEe(cb)});bb.Rja();const za=this.G2c(qa);return this.W4(cb=>{I(sa.Lub,Sys.Serialization.JavaScriptSerializer.serialize(Ba));cb=cb.Result;let Pa=!0;var nb=[];X.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),nb=Sys.Serialization.JavaScriptSerializer.deserialize(cb.ResponseBody.toString()),nb=Array.isArray(nb.value)?
nb.value:null;const Ma=new d.a;for(let Oa=0;Oa<nb.length;Oa++)if(!nb[Oa]){Pa=!1;const La=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${cb.ResponseStatusCode}.`;Ma.add(B(this.yNd(Ba[Oa]),()=>{delete this.GF[qa.registrationInfos[Oa].addinId];delete this.UV[Ba[Oa]];return this.GNd(Ba[Oa])},La))}G(Ca.Task.WhenAllEnumerable(Ma),()=>{F(this.AKd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${Y.a.Ya.Ce.m-
ya} Millisecond.`);Pa?pa.setResult(Pa):G(this.ncg(),()=>{pa.setResult(Pa)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},cb=>{cb=w.a.Ye(cb.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${ha.a.xc(cb)}.`);
I(sa.Kub,Sys.Serialization.JavaScriptSerializer.serialize(Ba));for(cb=0;cb<qa.registrationInfos.length;cb++)delete this.GF[qa.registrationInfos[cb].addinId],delete this.UV[Ba[cb]];pa.setResult(!1)},za,pa,!0)}R1d(bb,Ba,qa,pa){return B(this.g4j(bb,Ba,qa,pa),()=>this.AKd(pa.solutionId,!1),"Failed to unregister functions for customfunction addin")}g4j(bb,Ba,qa,pa){const ya=new e.a;bb.nLb(Ba);(bb=ea.a.Mc(this.UV,Ba))&&delete this.GF[bb.addinId];delete this.UV[Ba];pa=this.R2c(pa);return this.W4(()=>{I(sa.I9c,
Ba);ya.setResult(!0)},za=>{za=w.a.Ye(za.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,qa,null)}. Errors: ${ha.a.xc(za)}.`);I(sa.H9c,Ba);ya.setResult(!1)},pa,ya,!1)}W4(bb,Ba,qa,pa,ya){const za=this.$.userOperationManager,cb=this.$.pa;let Pa=null,nb=null,Ma=null;const Oa=()=>{if(za.wJa()||0<cb.va.X4||0<cb.dl.X4)return!1;Pa&&za.ro(Pa);nb&&cb.Ms(nb);
Ma&&cb.Ny(Ma);const La=qa.request;let ra=0;X.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?La.RequestFlags&1&&256!==(La.RequestFlags&256)||(ra=16):ra=La.RequestFlags&1?0:16;za.pF(new r.a(507,0,(V,ma,W)=>{I(ya?sa.G9c:sa.J9c,La.RequestBody);return l.g(cb.va,"ExecuteRichApiRequest",qa,ua.b(V,bb),ua.a(ma,Ba),W,null,0)},ra|64));return!0};Oa()||(Pa=()=>{Oa()},nb=()=>{Oa()},Ma=()=>{Oa()},za.tr(Pa),cb.ur(nb),cb.Tx(Ma));return pa.task}DIa(bb){const Ba={HttpMethod:"POST",
PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ba.RequestBody=JSON.stringify(bb);Ba.RequestFlags=1;X.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ba.RequestFlags|=256);bb=this.$.pa.va.Oa(1);bb.request=Ba;return bb}G2c(bb){const Ba={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Ba.RequestBody=JSON.stringify(bb);Ba.RequestFlags=1;X.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(Ba.RequestFlags|=256);bb=this.$.pa.va.Oa(1);bb.request=Ba;return bb}R2c(bb){const Ba={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ba.RequestBody=JSON.stringify(bb);Ba.RequestFlags=1;X.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ba.RequestFlags|=256);bb=this.$.pa.va.Oa(1);bb.request=Ba;return bb}AKd(bb,Ba){const qa=u.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);return M(qa,()=>{qa.result.VPd();return bb&&Ba?
this.Mvj(bb):Ca.Task.Ua(!0)},this.$.ka,x.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}ncg(){const bb=new la.a(1949669462,0,this.$.Bc,0,null);return this.$.Ia.Nb(bb)}static s7e(bb){try{return Ca.Task.Ua(localStorage.getItem(bb))}catch(Ba){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${Ba.message||"Unknown"}`),Ca.Task.Ua(null)}}static bUd(bb,
Ba){try{return localStorage.setItem(bb,Ba),Ca.Task.Ua(!0)}catch(qa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${qa.message||"Unknown"}`),Ca.Task.Ua(!1)}}static ioj(bb){try{return localStorage.removeItem(bb),Ca.Task.Ua(!0)}catch(Ba){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${Ba.message||"Unknown"}`),
Ca.Task.Ua(!1)}}static RJh(bb){return T.a.equals(bb,"registry",!0)||T.a.equals(bb,"uploadfiledevcatalog",!0)||f.AFrameworkApplication.userNameUnknown||f.AFrameworkApplication.limitedEdit}static ewd(bb){if(!bb)return!1;try{JSON.parse(bb)}catch(Ba){return!1}return!0}}sa.bBb="CustomFunctionCache";sa.cBb="CustomFunction";sa.G9c=new Ga(2,"CustomFunctions [Registration] [Begin] SolutionId=");sa.Lub=new Ga(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");sa.Kub=new Ga(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
sa.J9c=new Ga(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");sa.I9c=new Ga(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");sa.H9c=new Ga(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(sa,"CustomFunctionsInstaller",null,[700])},1243:function(t,C,a){a.r(C);t=a(0);var c=a(2),b=a(14),f=a(971),e=a(170),d=a(89),h=a(199),r=a(65),l=a(53),u=a(39),v=a(120),x=a(537),w=a(1E3);class m{constructor(O){O=O.split("|");this.Mx=O[1];this.dWc=O[2];this.hZd=
O[3]}get solutionId(){return this.Mx}get solutionVersion(){return this.dWc}get needToRestoreManifest(){return this.hZd===OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(m,"AddinStoreInfo",null,[]);class n{}Object(t.a)(n,"CustomFunctionRegistrationInfos",null,[]);const z=(O,U)=>{if(a(1243).CustomFunctionsLegacyInstaller.Iyb("CustomFunctionsRuntimeLogging")&&window.console)switch(U=y(O.severity)+" "+O.message+U,O.severity){case 2:window.console.log&&window.console.log(U);break;case 0:window.console.info&&
window.console.info(U);break;case 1:window.console.error&&window.console.error(U)}},y=O=>{switch(O){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class A{}Object(t.a)(A,"InstallationInfo",null,[]);class F{}Object(t.a)(F,"UninstallationInfo",null,[]);var D=a(168),B=a(37),M=a(32),R=a(1),P=a(15),E=a(293),H=a(895),G=a(60);class N{constructor(O,U){this.CVc=O;this._message=U}get severity(){return this.CVc}get message(){return this._message}}Object(t.a)(N,"CustomFunctionLog",
null,[]);a.d(C,"CustomFunctionsLegacyInstaller",function(){return I});class I{constructor(O){this.GF={};this.$=O;this.Oqd().Moa()}tif(O,U,ca,Q){const Y=new e.a;if(Q.invariantNamespace)for(U=0;U<Q.invariantNamespace.length;++U){const ea=Q.invariantNamespace.charAt(U);if("."!==ea&&"_"!==ea&&"a">ea&&"z"<ea&&"A">ea&&"Z"<ea&&"0">ea&&"9"<ea)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${ea}', Position=${U}.`),Y.setResult(!1),
Y.task}I.cacheManifest(ca,Q.manifest);let la=I.TLd(O);(null===la||void 0===la?0:la.isDynamicMetadata)?this.QMd(O,la,Y,!1,!1):OSF.OUtil.xhrGet(Q.metadataUrl,ea=>{la=Object(c.a)(new A,{addinId:ca,locale:Q.locale,addinInvariantNamespace:Q.invariantNamespace,addinNamespace:Q.namespace,addinTitle:Q.title,isXllCompatible:Q.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(ea))});this.QMd(O,la,Y,!1,w.a(this.$,Q))},ea=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${O}. ErrorCode: ${ea}.`);
Y.setResult(!1)});return Y.task}vif(O,U,ca,Q){U=new e.a;if(!I.ewd(ca))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),U.setResult(!1),U.task;const Y=I.TLd(O);if(!Y)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),U.setResult(!1),U.task;Y.metadataContent=JSON.stringify(JSON.parse(ca));Y.isDynamicMetadata=
!0;this.QMd(O,Y,U,!0,Q);return U.task}Clg(O){const U=new e.a,ca=l.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);u.TaskExtensions.za(ca,()=>{const Q=ca.result;Q.Rja();const Y=Object(c.a)(new F,{solutionId:O});I.zNd(O);I.HNd(O);u.TaskExtensions.za(this.R1d(Q,O,Y),la=>{D.b(la)?U.setResult(la.result):(la.Tf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${O}.`):la.Ah&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${O}.`),
U.setResult(!1))},this.$.ka,0)},this.$.ka,3);return U.task}Oqd(){const O=new e.a,U=I.YLd();0<U.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const ca=[];U.forEach(Y=>{Y=Object(d.a)(String,Y);if(Y=I.TLd(Y)){const la=B.a.Mc(this.GF,Y.addinId);la&&la===Y.metadataContent||(this.GF[Y.addinId]=Y.metadataContent,ca.push(Y))}});if(!ca.length)return O.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
O.task;const Q=l.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);u.TaskExtensions.za(Q,()=>{const Y=Q.result,la=Object(c.a)(new n,{registrationInfos:ca});u.TaskExtensions.za(this.J3b(Y,U,la),ea=>{D.b(ea)?O.setResult(ea.result):(ea.Tf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):ea.Ah&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
O.setResult(!1))},this.$.ka,0)},this.$.ka,3);return O.task}Lvj(O){O=new m(O);if(O.needToRestoreManifest){const U=I.$ij(O.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(O.solutionId,O.solutionVersion,U,this.$.xa.UICultureTag)}}QMd(O,U,ca,Q,Y){const la=l.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);u.TaskExtensions.za(la,()=>{u.TaskExtensions.za(this.SMd(la.result,O,U,!1,Q,Y),ea=>{D.b(ea)?((ea=ea.result)&&I.Xck(O,U),ca.setResult(ea)):(ea.Tf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${O}.`):
ea.Ah&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${O}.`),ca.setResult(!1))},this.$.ka,0)},this.$.ka,3)}SMd(O,U,ca,Q,Y,la){if(!Y&&(Y=B.a.Mc(this.GF,ca.addinId))&&Y===ca.metadataContent)return G.Task.Ua(!0);this.GF[ca.addinId]=ca.metadataContent;const ea=new e.a;la||O.nLb(U);O.Rja();O=this.DIa(ca);return this.W4(ha=>{z(I.Lub,U);const X=ha.Result;204===X.ResponseStatusCode?u.TaskExtensions.za(this.zKd(ea,ca.addinId,
Q),T=>{T.Tf?U?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${U}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${ca.addinId}.`):T.Ah&&(U?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${U}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${ca.addinId}.`));ea.setResult(!1)},this.$.ka,4):(ha=()=>{delete this.GF[ca.addinId];I.zNd(U);I.HNd(U);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${U}. Received status code ${X.ResponseStatusCode}.`);ea.setResult(!1)},ha=Object(c.a)(new H.a,{vNa:OSF.InfoType.Error,title:ca.addinTitle,
description:String.format(P.a.instance.qb(153),P.a.instance.ha(1892)),buttonText:P.a.instance.ha(4),Dia:ha,whc:!1,Fja:ha,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),f.a.EWd(ha))},ha=>{ha=v.a.Ye(ha.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${U}. Errors: ${M.a.xc(ha)}.`);z(I.Kub,U);delete this.GF[ca.addinId];ea.setResult(!1)},O,ea,!0)}J3b(O,U,ca){const Q=new e.a;U.forEach(la=>
{la=Object(d.a)(String,la);O.pEe(la)});O.Rja();const Y=this.G2c(ca);return this.W4(la=>{z(I.Lub,Sys.Serialization.JavaScriptSerializer.serialize(U));la=la.Result;let ea=!0;var ha=[];R.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),ha=Sys.Serialization.JavaScriptSerializer.deserialize(la.ResponseBody.toString()),ha=Array.isArray(ha.value)?ha.value:null;for(let X=0;X<ha.length;X++)ha[X]||(ea=!1,delete this.GF[ca.registrationInfos[X].addinId],I.zNd(U[X]),I.HNd(U[X]),b.ULS.sendTraceTag(537163478,
0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${U[X]}. Received status code ${la.ResponseStatusCode}.`));u.TaskExtensions.za(this.zKd(Q,"",!1),X=>{X.Tf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):X.Ah&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");Q.setResult(!1)},
this.$.ka,4);Q.setResult(ea)},la=>{la=v.a.Ye(la.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(U)}. Errors: ${M.a.xc(la)}.`);z(I.Kub,Sys.Serialization.JavaScriptSerializer.serialize(U));for(const ea of ca.registrationInfos)delete this.GF[ea.addinId];Q.setResult(!1)},Y,Q,!0)}R1d(O,U,ca){const Q=new e.a;O.nLb(U);O=this.R2c(ca);return this.W4(()=>
{z(I.I9c,U);u.TaskExtensions.za(this.zKd(Q,ca.solutionId,!1),Y=>{Y.Tf?U&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${U}.`):Y.Ah&&U&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${U}.`);Q.setResult(!1)},this.$.ka,4)},Y=>{Y=v.a.Ye(Y.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${U}. Errors: ${M.a.xc(Y)}.`);
z(I.H9c,U);Q.setResult(!1)},O,Q,!1)}W4(O,U,ca,Q,Y){const la=this.$.userOperationManager,ea=this.$.pa;let ha=null,X=null,T=null;const ua=()=>{if(la.wJa()||0<ea.va.X4||0<ea.dl.X4)return!1;ha&&la.ro(ha);X&&ea.Ms(X);T&&ea.Ny(T);const Ha=ca.request;la.pF(new h.a(507,0,(Ca,Ga,sa)=>{z(Y?I.G9c:I.J9c,Ha.RequestBody);return r.g(ea.va,"ExecuteRichApiRequest",ca,E.b(Ca,O),E.a(Ga,U),sa,null,0)},(Ha.RequestFlags&1?0:16)|64));return!0};ua()||(ha=()=>{ua()},X=()=>{ua()},T=()=>{ua()},la.tr(ha),ea.ur(X),ea.Tx(T));
return Q.task}DIa(O){const U={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};U.RequestBody=JSON.stringify(O);U.RequestFlags=1;O=this.$.pa.va.Oa(1);O.request=U;return O}G2c(O){const U={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};U.RequestBody=JSON.stringify(O);U.RequestFlags=1;O=this.$.pa.va.Oa(1);O.request=U;return O}R2c(O){const U={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};U.RequestBody=JSON.stringify(O);
U.RequestFlags=1;O=this.$.pa.va.Oa(1);O.request=U;return O}zKd(O,U,ca){const Q=l.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);u.TaskExtensions.za(Q,()=>{Q.result.VPd();U&&ca&&this.Lvj(U);O.setResult(!0)},this.$.ka,3);return Q}wif(){return G.Task.Ua(!0)}static YLd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(I.Iyb(x.a.S_a)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(I.Iyb(x.a.S_a)||"[]"):null)||[]}static Irg(O){I.cUd(x.a.S_a,Sys.Serialization.JavaScriptSerializer.serialize(O))}static TLd(O){O=
I.Iyb(x.a.e6a(O))||"";return 0<O.length?Sys.Serialization.JavaScriptSerializer.deserialize(O,!0):null}static Xck(O,U){I.QSe(O);I.cUd(x.a.e6a(O),Sys.Serialization.JavaScriptSerializer.serialize(U))}static zNd(O){I.GYf(O);I.YYf(x.a.e6a(O))}static $ij(O){return I.Iyb(x.a.d6a(O))}static Yck(O,U){I.QSe(O);I.cUd(x.a.d6a(O),U)}static HNd(O){I.GYf(O);I.YYf(x.a.d6a(O))}static QSe(O){const U=I.YLd();O=O.toLowerCase();U.includes(O)||(U.push(O),I.Irg(U))}static GYf(O){const U=I.YLd();O=O.toLowerCase();U.includes(O)&&
(U.splice(Array.indexOf(U,O),1),I.Irg(U))}static cacheManifest(O,U){O=new m(O);O.needToRestoreManifest&&I.Yck(O.solutionId,U)}static Iyb(O){try{return localStorage.getItem(O)}catch(U){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${U.message||"Unknown"}`),null}}static cUd(O,U){try{localStorage.setItem(O,U)}catch(ca){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${ca.message||
"Unknown"}`)}}static YYf(O){try{localStorage.removeItem(O)}catch(U){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${U.message||"Unknown"}`)}}static ewd(O){if(!O)return!1;try{JSON.parse(O)}catch(U){return!1}return!0}}I.G9c=new N(2,"CustomFunctions [Registration] [Begin] SolutionId=");I.Lub=new N(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");I.Kub=new N(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
I.J9c=new N(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");I.I9c=new N(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");I.H9c=new N(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(I,"CustomFunctionsLegacyInstaller",null,[700])},1285:function(t,C,a){t=a(0);var c=a(205),b=a(14);class f{}Object(t.a)(f,"AddinCommandsHost",null,[]);var e=a(1356),d=a(1460),h=a(893),r=a(65);const l=(B,M,R,P,E,H)=>{const G=B.Oa(9);G.sharedInfo=M;return r.g(B,"InsertAgaveTaskpane",
G,R,P,E,H,0)},u=(B,M,R,P,E,H,G=null)=>{G=B.Oa(9,G);G.sharedInfo=M;return r.g(B,"ShowAgaveTaskpane",G,R,P,E,H,0)};var v=a(380),x=a(199),w=a(39),m=a(1),n=a(293),z=a(160);class y extends z.a{constructor(B){super();this.ye=this.REa="AddInCommandsDialog";this.Xb=5;this.dialogWidth=695;this.dialogHeight=438;this.Tch="100%";this.Qch="408px";this.Rch="15px";this.Sch="0";this.kFg=B}get containerDiv(){return this.Xh}ox(){super.ox();this.Xh.style.width=this.Tch;this.Xh.style.height=this.Qch;this.Xh.style.marginTop=
this.Rch;this.Xh.style.padding=this.Sch}dE(){super.dE();this.mb.style.width=String.format("{0}px",this.dialogWidth);this.mb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.kFg()}}Object(t.a)(y,"AddInCommandsDialog",z.a,[]);var A=a(60),F=a(75);z=a(105);a.d(C,"a",function(){return D});class D extends f{constructor(B,M,R,P=null,E=null){super();this.$=B;this.Gd=M;this.ownerAddinInfo=R;this.Ld=E;this.Aeb=P||A.Task.Ua(!0)}Lch(){const B=this.Aeb;this.Aeb=A.Task.Ua(!0);
return B}disposeHost(B){this.Gd.kSa(B)}setOwnerAddinEToken(B){this.ownerAddinInfo.eToken=B}showTaskpane(B,M,R){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let P=null,E=!1,H=(new e.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,!0)).OMe(B.solutionId.substr(this.ownerAddinInfo.solutionId.length));P=M.getSharedRuntimeForTaskpane("Workbook",H);E=!!P&&1===P.LifeTime;this.Gd.sEe(E?this.ownerAddinInfo.solutionId:B.solutionId,E?P:null,null)||(this.Bvf(E,!0),this.Aeb=
this.Mqd(B,P,(G,N)=>{G?(E&&(G.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,G.SharedRuntime=P),G.WebExtensionOsfControlType=3,this.Gd.LJa(G),R(G.InstanceId,N),this.Bvf(E,!1),m.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),R(null,N))}))}getSettings(B,M){let R=this.Gd.Sba(B.solutionId);
R?M(this.Gd.oV(R).OsfPropertyBag):this.Aeb=this.Mqd(B,null,P=>{P?M(P.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(B,M,R){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const P=this.$.pa.va,E=G=>{const N=G.Result,I=N?N.AgaveData:null;I?(this.Gd.HLe(I,()=>{const O=new y(()=>{this.disposeHost(I.InstanceId)});O.initializeAndShow("",null,null);return O.containerDiv}),R(I.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),
R(null,G.Errors?G.Errors[0].ErrorCause:5001))},H=D.NJa(B,this.ownerAddinInfo);this.Aeb=v.a(this.$.userOperationManager,(G,N,I)=>l(P,H,n.b(G,E),N,I,null),G=>new x.a(500,0,G,64),this.Ld)}createUILessSandbox(B,M,R){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const P=M.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),E=!!P&&1===P.LifeTime;(M=this.Gd.xMh(E?this.ownerAddinInfo.solutionId:B.solutionId,E?P:null))?R(M,0):this.Aeb=this.Mqd(B,P,(H,G)=>{H?(E?(H.PrimaryMarketplace.SolutionId=
this.ownerAddinInfo.solutionId,H.SharedRuntime=P,H.TaskpaneVisible=!1,H.WebExtensionOsfControlType=3,this.Gd.LJa(H)):(H.WebExtensionOsfControlType=4,this.Gd.HLe(H,()=>{D.Fhb.ia(H.InstanceId,new d.a);return D.Fhb.ma(H.InstanceId).sba})),R(H.InstanceId,G)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),R(null,G))})}Mqd(B,M,R){let P=null;const E=this.$.pa.va,H=U=>{const ca=U.Result;(P=ca?ca.AgaveData:null)||R(null,U.Errors?U.Errors[0].ErrorCause:5001)},G=D.NJa(B,this.ownerAddinInfo);
M&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),G.SharedRuntimeId=M.Resid);let N=500;var I=(U,ca,Q)=>l(E,G,n.b(U,H),ca,Q,null);let O=0;void 0===G.IsToBePersisted||null===G.IsToBePersisted||G.IsToBePersisted||(N=538,I=(U,ca,Q)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,
null,null,this.ownerAddinInfo.storeId));return u(E,G,n.b(U,H),ca,Q,null)},O=16);O|=64;I=v.a(this.$.userOperationManager,I,U=>new x.a(N,0,U,O),this.Ld);return w.TaskExtensions.ts(I,()=>P?this.xyd(E,P.InstanceId,(U,ca)=>{if(U){M||(P.PrimaryMarketplace.MarketplaceType=B.storeType);B.assetId?B.assetId.toLowerCase().startsWith("wa")?P.AssetMarketplace={SolutionId:B.assetId,SolutionVersion:B.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:B.assetStoreId}:(P.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,
344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):P.AssetMarketplace=null;P.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;P.OwnerAddinStoreType=this.ownerAddinInfo.storeType;P.OsfPropertyBag=[];for(ca=0;ca<U.Settings.length;ca++){const Q=[];Q[0]=U.Settings[ca].Name;Q[1]=U.Settings[ca].Value;P.OsfPropertyBag[ca]=Q}R(P,0)}else R(null,ca.Errors?ca.Errors[0].ErrorCause:5001)}):A.Task.Ua(!1),c.a.none,3,F.a.current)}xyd(B,M,R){const P=E=>{R(E.Result,E)};return v.a(this.$.userOperationManager,
(E,H,G)=>{E=n.b(E,P);const N=B.Oa(1);N.controlId=M;return r.g(B,"DdaLoadSettings",N,E,H,G,null,0)},E=>new x.a(501,0,E,80),this.Ld)}Bvf(B,M){var R;B&&(null===(R=window.performance)||void 0===R?0:R.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${M}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(B){D.Fhb.nb(B)&&
D.Fhb.ma(B).initializeAndShowWithTitle()}static hideUILessDialog(B){D.Fhb.nb(B)&&D.Fhb.ma(B).hide()}static NJa(B,M){const R={};R.SolutionId=B.solutionId;R.Version=B.version;R.StoreType=M.storeType;R.StoreId=B.storeId;R.AssetId=B.solutionId;R.AssetStoreId="omex";R.TargetType=1;R.Width=350;R.OwnerAddinSolutionId=M.solutionId;R.OwnerAddinStoreType=M.storeType;R.SharedRuntimeId=null;R.Preload=!1;return R}}D.Fhb=new z.a;Object(t.a)(D,"WACExcelAddinCommandsHost",f,[])},1356:function(t,C,a){a.d(C,"a",function(){return b});
t=a(0);a(14);var c=a(6);class b{constructor(f,e,d,h){this.Hmb=f;c.AFrameworkApplication.fa.ra("AddInCommandsMissingTabIsEnabled")&&d.H2h();this.Mx=e;this.SHg=h}get KGb(){return this.Hmb}get solutionId(){return this.Mx}get eWd(){return this.SHg}ZLa(f){f=this.KGb+this.solutionId+f;return this.eWd?(f in b.d2b||(b.d2b[f]="AddinControl"+b.ATg++),b.d2b[f]):f}OMe(f){if(this.eWd){const d=b.d2b;for(let h in d){var e=h;if(f===d[h])return e.substr(this.KGb.length+this.solutionId.length)}}return f}eaf(f){f=this.KGb+
this.solutionId+f;return this.eWd?(f in b.M_c||(b.M_c[f]="AddinTab"+b.KTg++),b.M_c[f]):f}}b.d2b={};b.M_c={};b.KTg=0;b.ATg=0;Object(t.a)(b,"DefaultRibbonNamingProvider",null,[740])},1420:function(t,C,a){a.r(C);t=a(0);var c=a(14),b=a(89),f;(function(w){w[w.none=0]="none";w[w.testEvent=1]="testEvent";w[w.test1Event=2]="test1Event";w[w.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";w[w.worksheetActivatedEvent=11]="worksheetActivatedEvent";w[w.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";
w[w.worksheetAddedEvent=13]="worksheetAddedEvent";w[w.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";w[w.worksheetDeletedEvent=15]="worksheetDeletedEvent";w[w.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";w[w.worksheetFilteredEvent=17]="worksheetFilteredEvent";w[w.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";w[w.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";w[w.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";w[w.worksheetSingleClickedEvent=
21]="worksheetSingleClickedEvent";w[w.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";w[w.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";w[w.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";w[w.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";w[w.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";w[w.worksheetMovedEvent=27]="worksheetMovedEvent";w[w.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";
w[w.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";w[w.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";w[w.chartAddedEvent=50]="chartAddedEvent";w[w.chartActivatedEvent=51]="chartActivatedEvent";w[w.chartDeactivatedEvent=52]="chartDeactivatedEvent";w[w.chartDeletedEvent=53]="chartDeletedEvent";w[w.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";w[w.tableDataChangedEvent=101]="tableDataChangedEvent";w[w.tableAddedEvent=102]=
"tableAddedEvent";w[w.tableDeletedEvent=103]="tableDeletedEvent";w[w.tableFilteredEvent=104]="tableFilteredEvent";w[w.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";w[w.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";w[w.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";w[w.commentAddedEvent=250]="commentAddedEvent";w[w.commentDeletedEvent=251]="commentDeletedEvent";w[w.commentChangedEvent=252]="commentChangedEvent";w[w.invocationMessage=1E3]=
"invocationMessage";w[w.cancellationMessage=1001]="cancellationMessage";w[w.metadataMessage=1002]="metadataMessage";w[w.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";w[w.visualChangeEvent=2001]="visualChangeEvent";w[w.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";w[w.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";w[w.shapeActivatedEvent=2101]="shapeActivatedEvent";w[w.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";w[w.shapeAddedEvent=2103]=
"shapeAddedEvent";w[w.shapeDeletedEvent=2104]="shapeDeletedEvent";w[w.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";w[w.wacOperationEvent=2201]="wacOperationEvent";w[w.recordingStateChangedEvent=2202]="recordingStateChangedEvent";w[w.workbookActivatedEvent=2203]="workbookActivatedEvent";w[w.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";w[w.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";w[w.linkedDataTypeRefreshRequestCompletedEvent=
2500]="linkedDataTypeRefreshRequestCompletedEvent";w[w.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";w[w.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";w[w.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";w[w.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";w[w.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";w[w.rangePickerDeactivatedEvent=
2701]="rangePickerDeactivatedEvent";w[w.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";w[w.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";w[w.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";w[w.pivotTableAddedEvent=2900]="pivotTableAddedEvent";w[w.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";w[w.namedItemAddedEvent=3E3]="namedItemAddedEvent";w[w.namedItemDeletedEvent=3001]="namedItemDeletedEvent";w[w.guidedReapplyManagerUpdateAvailableEvent=
3100]="guidedReapplyManagerUpdateAvailableEvent";w[w.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";w[w.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";w[w.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";w[w.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";w[w.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";w[w.beforeCloseNotifiactionCancelledEvent=
65540]="beforeCloseNotifiactionCancelledEvent";w[w.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent"})(f||(f={}));Object(t.b)("MessageType",f);var e=a(789),d=a(261),h=a(760),r=a(59),l=a(39),u=a(168),v=a(1);a.d(C,"DdaEventDispatch",function(){return x});class x{constructor(w){this.bB=null;this.wjg={};this.yjg={};this.ifd={};this.nDd={};this.tnd=(m,n)=>{m=this.$.Rb.Qc("Task","DdaEventDispatch.HandleServerEvent");n=n.X6f;for(let F=0;F<n.length;F++)switch(n[F].EventType){case 2:var z=
n[F],y={};y.Name=z.Name;y.BindingType=z.BindingType;y.ColCount=z.ColCount;y.RowCount=z.RowCount;this.lxa(z.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,y,null);break;case 4:this.lxa(n[F].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(z=n[F],z.InstanceId){y=Array(z.Entries.length);for(var A=0;A<z.Entries.length;A++)y[A]=x.rfc(z.Entries[A],z.IsRemoteOverride);0<z.Entries.length&&1===z.Entries[0].Category?this.gej(z.InstanceId,y):z.InstanceId&&this.lxa(z.InstanceId,
OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,y)}else{this.ifd={};this.nDd={};for(y=0;y<z.Entries.length;y++)this.GPe(z.Entries[y],z.IsRemoteOverride);z=JSON.stringify(this.ifd);y=JSON.stringify(this.nDd);A=JSON.stringify(this.wjg);const D=JSON.stringify(this.yjg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${z}, Number of Not Fired event: ${y}, Total Number of Fired event: ${A}, Total Number of Not Fired event: ${D}`)}}m.stop()};this.ENb=(m,n)=>{this.lxa(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,n)};this.$=w;this.Mzc=this.tnd}J1b(w){w&&(this.Rja(),this.bB.push(w))}Twc(w){this.bB&&(Array.remove(this.bB,w),this.bB.length||(this.$.wantServerEvents=!1,this.$.qrj(this.Mzc),this.bB=null))}gej(w,m){const n=Object(b.a)(h.DdaFacade,d.a(this.$));l.TaskExtensions.za(n.g4h(w),z=>{if(u.b(z)){var y=z.result;z=n.Kn(y);if(y)if(z.dlc)this.lxa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m);else if(z.R8b)for(y=0;y<m.length;y++)z.R8b.push(m[y]);else z.R8b=m}else z.Tf?c.ULS.sendTraceTag(537170591,
0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):z.Ah&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ka,0)}Dej(w,m){const n=Object(b.a)(h.DdaFacade,d.a(this.$)),z=n.ZSh(w);z?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(z,m,this.ENb):n.jfh(w,m)}GPe(w,m){let n=!1;const z=parseInt(w.Type,10);var y=w.Target;const A=Object(b.a)(h.DdaFacade,d.a(this.$));
if((y=A.Mh.m4h(z,y))&&0<Object.keys(y).length){n=!0;for(let D in y)if(y=D,A.Mh.Z2b(y)){const B=Array(1);B[0]=x.rfc(w,m);if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var F=B[0][3];if(void 0!==F&&null!==F&&(F=Object(b.a)(Object,r.a.ri(F)))&&void 0!==F.triggerControlId&&null!==F.triggerControlId&&void 0!==F.triggerSource&&null!==F.triggerSource){let M=!1;m?(F.triggerSource="Unknown",M=!0):A.Nsh(F.triggerControlId,y)&&(F.triggerSource="ThisLocalAddin",M=!0);M&&
(B[0][3]=r.a.Fc(F))}}this.lxa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}}n?(this.cic(f[z],this.ifd),this.cic(f[z],this.wjg)):(this.cic(f[z],this.nDd),this.cic(f[z],this.yjg))}Rja(){this.bB||(this.bB=[],this.$.pue(this.Mzc),this.$.wantServerEvents=!0)}cic(w,m){w in m||(m[w]=0);m[w]+=1}DH(w,m,n){const z={};z.Target=m;z.Category=65536;z.Type=w;z.Message=n;z.Id=-1;this.GPe(z,!1)}NMh(w,m){const n={Target:"",Category:2,Type:1E3};n.Message=m;n.Id=0;m=Array(1);m[0]=x.rfc(n,!1);this.Dej(w,m)}vcc(w,
m,n,z){const y={};y.Target=n;y.Category=65536;y.Type=m;y.Message=z;y.Id=-1;m=Array(1);m[0]=x.rfc(y,!1);this.lxa(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m)}MMh(w,m){this.lxa(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m)}lxa(w,m,n,z){if(this.bB){var y=Object(b.a)(h.DdaFacade,d.a(this.$));if(!y||m!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&m!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||y.Mh.Z2b(w)){w=new e.a(m,w,n,z);for(let A=0,F=this.bB.length;A<F;A++)(m=this.bB[A])&&
m(w)}}}static rfc(w,m){const n=Array(6);n[0]=w.Category;n[1]=w.Type;n[2]=w.Target;n[3]=w.Message;n[4]=w.Id;n[5]=m;return n}}Object(t.a)(x,"DdaEventDispatch",null,[])},1460:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);C=a(160);var c=a(93);class b extends C.a{constructor(){super(void 0,void 0,void 0,!0);this.REa="AddinCommandsUILessDialog";this.bXc="WACDialogTitleText";this.hY="0";this.MG=380;this.t2=190;this.ye=this.REa;this.Xb=5;this.Qyg=String.format("{0}px",this.MG);this.gY=String.format("{0}px",
this.t2);this.Idf=this.Ot=!1;this.ox()}ox(){super.ox();this.Xh.style.width=this.Qyg;this.Xh.style.height=this.gY;this.Xh.style.padding=this.hY}Py(f){this.dE();document.getElementById(this.Sh(this.bXc)).innerText=f}dE(){super.dE();this.mb.style.width=String.format("{0}px",this.MG);this.mb.style.height=String.format("{0}px",this.t2);this.mb.removeAttribute(c.a.Kd);this.mb.removeAttribute(c.a.vM)}hide(){this.yAb()}get sba(){return this.Xh}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(t.a)(b,"AddinCommandsUILessDialog",C.a,[750])},1493:function(t,C,a){a.r(C);var c={};a.r(c);a.d(c,"CopilotSDX",function(){return dj});var b=a(520),f=a(10),e=a(0),d=a(228),h=a(198),r=a(601);class l{constructor(){this.Yib=null}get KZg(){this.Yib||(this.Yib=new h.a,this.Yib.add(12),this.Yib.add(11));return this.Yib}wri(J){return this.KZg.contains(J.operation)}s3j(J){const Na=[],Eb=J.payload;for(const gc of Eb.batchedOperations)Na.push(new r.a(J.operation,gc));return Na}}Object(e.a)(l,
"MacroRecorderBatchedEventList",null,[]);var u=a(14),v=a(59),x=a(128),w=a(659);class m{equals(J,Na){return J===Na}getHashCode(J){return J}Vka(J){return J}}Object(e.a)(m,"UserOperationNameComparer",null,[110,111]);class n{static Cbi(){n.Kc||(n.Kc=new w.a(new m),n.Kc.add(507),n.Kc.add(10),n.Kc.add(576),n.Kc.add(563),n.Kc.add(564),n.Kc.add(565),n.Kc.add(566),n.Kc.add(567),n.Kc.add(568),n.Kc.add(569),n.Kc.add(570),n.Kc.add(571),n.Kc.add(572),n.Kc.add(573),n.Kc.add(574),n.Kc.add(575),n.Kc.add(501),n.Kc.add(520),
n.Kc.add(1),n.Kc.add(1002),n.Kc.add(129),n.Kc.add(198),n.Kc.add(500),n.Kc.add(519),n.Kc.add(538),n.Kc.add(1E3),n.Kc.add(1003),n.Kc.add(144),n.Kc.add(502),n.Kc.add(505),n.Kc.add(179),n.Kc.add(205),n.Kc.add(134),n.Kc.add(230),n.Kc.add(103),n.Kc.add(110),n.Kc.add(112),n.Kc.add(113),n.Kc.add(124),n.Kc.add(133),n.Kc.add(154),n.Kc.add(162),n.Kc.add(168),n.Kc.add(172),n.Kc.add(201),n.Kc.add(222),n.Kc.add(227),n.Kc.add(513),n.Kc.add(534),n.Kc.add(539),n.Kc.add(545),n.Kc.add(600),n.Kc.add(547),n.Kc.add(555),
n.Kc.add(558),n.Kc.add(562),n.Kc.add(585),n.Kc.add(1001),n.Kc.add(1005),n.Kc.add(1008),n.Kc.add(1010),n.Kc.add(1011),n.Kc.add(1012),n.Kc.add(1018),n.Kc.add(1029),n.Kc.add(252),n.Kc.add(253),n.Kc.add(258),n.Kc.add(101),n.Kc.add(102),n.Kc.add(108),n.Kc.add(257),n.Kc.add(119),n.Kc.add(120),n.Kc.add(123),n.Kc.add(126),n.Kc.add(127),n.Kc.add(130),n.Kc.add(140),n.Kc.add(159),n.Kc.add(160),n.Kc.add(165),n.Kc.add(166),n.Kc.add(167),n.Kc.add(169),n.Kc.add(189),n.Kc.add(223),n.Kc.add(214),n.Kc.add(228),n.Kc.add(233),
n.Kc.add(247),n.Kc.add(504),n.Kc.add(511),n.Kc.add(512),n.Kc.add(525),n.Kc.add(533),n.Kc.add(537),n.Kc.add(542),n.Kc.add(544),n.Kc.add(548),n.Kc.add(550),n.Kc.add(551),n.Kc.add(552),n.Kc.add(554),n.Kc.add(577),n.Kc.add(584),n.Kc.add(586),n.Kc.add(587),n.Kc.add(588),n.Kc.add(592),n.Kc.add(1009),n.Kc.add(1016),n.Kc.add(1017),n.Kc.add(1024),n.Kc.add(260),n.Kc.add(597),n.Kc.add(264),n.Kc.add(596),n.Kc.add(254),n.Kc.add(262));return n.Kc}}n.Kc=null;Object(e.a)(n,"MacroRecorderUnrecognizedEventList",null,
[]);class z{constructor(J,Na,Eb){this.Qwb=null;this.oLi=(gc,vc)=>{this.jbg()&&this.ffd(vc)};this.Jxf=Na;this.Ixf=Eb;this.$=J;this.$.uR&&this.$.aSg(this.oLi);J.da.Ha(297,this)}init(J){this.$.uR&&(J?this.Qwb=J:u.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}ffd(J){if(this.jbg())try{if(this.Ixf.wri(J)){var Na=this.Ixf.s3j(J);for(const Eb of Na)this.P_e(Eb)}else this.P_e(J)}catch(Eb){Na=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${x.a(J.operation)}, Exception: ${Eb.stack}`;
u.ULS.sendTraceTag(537155423,0,10,Na);try{this.KMh(J)}catch(gc){}}}P_e(J){var Na=this.Jxf.y7e(J,!0);Na?(this.Qwb(Na.eventId,v.a.Fc(J.payload)),u.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Na.eventId}`)):(Na=this.Jxf.y7e(J,!1))?u.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Na.eventId}, but failed to match filters`):n.Cbi().contains(J.operation)||(this.Qwb(0,v.a.Fc(J.operation)),J=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${x.a(J.operation)}`,
u.ULS.sendTraceTag(537155420,0,50,J))}KMh(J){this.Qwb(222,v.a.Fc(J.operation))}jbg(){return this.$.sma&&this.Qwb&&this.$.Qca?!0:!1}}Object(e.a)(z,"MacroRecorderEventHandler",null,[839]);var y=a(1);class A{constructor(){this.$Mc=this.aNc=this.$Sc=this.yXc=null}get operations(){this.$Sc||(this.$Sc=new h.a,this.mc());return this.$Sc}get rHc(){this.yXc||(this.yXc=new h.a,this.ng());return this.yXc}get vZe(){this.$Mc||(this.$Mc=new h.a);return this.$Mc}get featureGates(){this.aNc||(this.aNc=new h.a,this.Jxa());
return this.aNc}ng(){}Jxa(){}Ad(J){this.rHc.add(J)}Zb(J){this.operations.contains(J)||this.operations.add(J)}Bpb(){this.featureGates.add(585)}tre(J){this.vZe.add(J)}}Object(e.a)(A,"MacroRecorderEventBase",null,[]);class F extends A{constructor(){super()}get eventId(){return 130}mc(){this.Zb(100)}}Object(e.a)(F,"AccessibilityCheckRunEvent",A,[]);class D extends A{constructor(){super()}get eventId(){return 160}mc(){this.Zb(241)}ng(){this.Ad(J=>J.addToPrintArea)}}Object(e.a)(D,"AddedToPrintAreaEvent",
A,[]);class B extends A{constructor(){super()}get eventId(){return 65}mc(){this.Zb(516)}}Object(e.a)(B,"AutoFilterToggledEvent",A,[]);class M extends A{constructor(){super()}get eventId(){return 118}mc(){this.Zb(502)}ng(){this.Ad(J=>!(J.w6a().FirstColumn===J.w6a().LastColumn&&J.w6a().FirstRow===J.w6a().LastRow))}}Object(e.a)(M,"AutoSumEvent",A,[]);class R extends A{constructor(J,Na){super();this.yga=J;this.aak=Na}get eventId(){return this.yga}mc(){this.Zb(529);this.Zb(594)}ng(){this.Ad(J=>this.aak.includes(J.vkd()))}}
Object(e.a)(R,"ChartPropertyAppliedEventBase",A,[]);class P extends R{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(e.a)(P,"ChartAxisChangedEvent",R,[]);class E extends R{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(e.a)(E,"ChartAxisTitleChangedEvent",R,[]);class H extends R{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(e.a)(H,"ChartDataLabelsChangedEvent",R,[]);class G extends R{constructor(){super(76,
[-100])}}Object(e.a)(G,"ChartDataSelectedEvent",R,[]);class N extends R{constructor(){super(83,[500,501,502])}}Object(e.a)(N,"ChartDataTableChangedEvent",R,[]);var I=a(562),O=a(425),U=a(89);class ca extends A{constructor(){super()}}Object(e.a)(ca,"RichApiRequestExecutedEventBase",A,[]);class Q{constructor(J,Na,Eb){this.response=this.request=this.eventId=this.source=null;J&&(this.source=J.source,this.eventId=J.eventId,this.request=Na,this.response=Eb)}get isValid(){return!(void 0===this.source||null===
this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(e.a)(Q,"MacroRecorderRichApiRequestExecutedPayload",null,[145]);class Y extends ca{constructor(){super()}get eventId(){return 117}Yw(J){Y.c8||(Y.c8=new w.a(I.a.$h()),Y.c8.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Y.c8.add("fa000000014"));return!!J&&Y.c8.contains(J.toLowerCase())}mc(){this.Zb(507);this.Zb(10);this.Zb(576)}ng(){this.Ad(J=>Object(O.a)(Q,J)&&(J=Object(U.a)(Q,J),J.isValid&&this.Yw(J.source))?(u.ULS.sendTraceTag(537155427,
0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${J.eventId}`),!0):!1)}}Y.c8=null;Object(e.a)(Y,"ChartFormatRichApiRequestExecutedEvent",ca,[]);class la extends R{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(e.a)(la,"ChartGridlinesChangedEvent",R,[]);class ea extends A{constructor(){super()}get eventId(){return 66}mc(){this.Zb(528)}}Object(e.a)(ea,"ChartInsertedEvent",A,[]);class ha extends R{constructor(){super(81,[100,101,102,103,104,105,
106])}}Object(e.a)(ha,"ChartLegendChangedEvent",R,[]);class X extends R{constructor(){super(75,[-101])}}Object(e.a)(X,"ChartRowColumnSwitchedEvent",R,[]);class T extends R{constructor(){super(79,[0,1,2,-102])}}Object(e.a)(T,"ChartTitleChangedEvent",R,[]);class ua extends R{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(e.a)(ua,"ChartTypeChangedEvent",R,
[]);class Ha extends A{constructor(){super()}get eventId(){return 131}mc(){this.Zb(521)}}Object(e.a)(Ha,"ConnectorFloatingObjectResizedEvent",A,[]);class Ca extends A{constructor(){super()}get eventId(){return 129}mc(){this.Zb(109)}}Object(e.a)(Ca,"EntitySelectedEvent",A,[]);class Ga extends A{constructor(){super()}get eventId(){return 49}mc(){this.Zb(149);this.Zb(147)}}Object(e.a)(Ga,"FindCellEvent",A,[]);class sa extends A{constructor(){super()}get eventId(){return 96}mc(){this.Zb(122)}}Object(e.a)(sa,
"FloatingObjectAltTextAppliedEvent",A,[]);class bb extends A{constructor(){super()}get eventId(){return 93}mc(){this.Zb(522)}}Object(e.a)(bb,"FloatingObjectDeletedEvent",A,[]);class Ba extends A{constructor(){super()}get eventId(){return 94}mc(){this.Zb(524)}}Object(e.a)(Ba,"FloatingObjectMovedAndResizedEvent",A,[]);class qa extends A{constructor(){super()}get eventId(){return 95}mc(){this.Zb(523)}}Object(e.a)(qa,"FloatingObjectRotatedEvent",A,[]);class pa extends A{constructor(){super()}get eventId(){return 100}mc(){this.Zb(543)}}
Object(e.a)(pa,"GroupDetailsShownOrHiddenEvent",A,[]);class ya extends A{constructor(){super()}get eventId(){return 154}mc(){this.Zb(125)}}Object(e.a)(ya,"HyperlinksRemovedFromRangeEvent",A,[]);class za extends ca{constructor(){super()}get eventId(){return 125}Yw(J){za.c8||(za.c8=new w.a(I.a.$h()),za.c8.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),za.c8.add("fa000000005"));return!!J&&za.c8.contains(J.toLowerCase())}mc(){this.Zb(507);this.Zb(10);this.Zb(576)}ng(){this.Ad(J=>Object(O.a)(Q,J)?(J=Object(U.a)(Q,
J),J.isValid&&this.Yw(J.source)):!1)}}za.c8=null;Object(e.a)(za,"IdeasRichApiRequestExecutedEvent",ca,[]);class cb extends A{constructor(){super()}get eventId(){return 136}mc(){this.Zb(115)}}Object(e.a)(cb,"LinkedEntityConvertedEvent",A,[]);class Pa extends A{constructor(){super()}get eventId(){return 148}mc(){this.Zb(114)}}Object(e.a)(Pa,"LinkedEntityDisambiguationPaneToggledEvent",A,[]);class nb extends A{constructor(){super()}get eventId(){return 127}mc(){this.Zb(119)}}Object(e.a)(nb,"MovedToEdgeEvent",
A,[]);class Ma extends A{constructor(){super()}get eventId(){return 135}mc(){this.Zb(191)}Jxa(){this.Bpb()}}Object(e.a)(Ma,"NamedSheetViewCreatedEvent",A,[]);class Oa extends A{constructor(){super()}get eventId(){return 166}mc(){this.Zb(200)}Jxa(){this.Bpb()}}Object(e.a)(Oa,"NamedSheetViewDeletedEvent",A,[]);class La extends A{constructor(){super()}get eventId(){return 133}mc(){this.Zb(192)}Jxa(){this.Bpb()}}Object(e.a)(La,"NamedSheetViewExitedEvent",A,[]);class ra extends A{constructor(){super()}get eventId(){return 162}mc(){this.Zb(199)}Jxa(){this.Bpb()}}
Object(e.a)(ra,"NamedSheetViewRenamedEvent",A,[]);class V extends A{constructor(){super()}get eventId(){return 167}mc(){this.Zb(195)}Jxa(){this.Bpb()}}Object(e.a)(V,"NamedSheetViewSwitchedEvent",A,[]);class ma extends A{constructor(){super()}get eventId(){return 99}mc(){this.Zb(174)}}Object(e.a)(ma,"OutlineLevelSetEvent",A,[]);class W extends A{constructor(){super()}get eventId(){return 156}mc(){this.Zb(244)}}Object(e.a)(W,"PageBreakInsertedEvent",A,[]);class aa extends A{constructor(){super()}get eventId(){return 157}mc(){this.Zb(245)}}
Object(e.a)(aa,"PageBreakRemovedEvent",A,[]);class ia extends A{constructor(){super()}get eventId(){return 158}mc(){this.Zb(246)}}Object(e.a)(ia,"PageBreaksAllResetEvent",A,[]);class ka extends A{constructor(){super()}get eventId(){return 112}mc(){this.Zb(503)}ng(){this.Ad(J=>!!J.pasteParameters.ClientEstimationFloatingObjectId&&2===J.pasteParameters.CopyPasteTargetType&&!J.isFromCurrentSession)}}Object(e.a)(ka,"PasteArtOtherWorkbookEvent",A,[]);class Xa extends A{constructor(){super()}get eventId(){return 52}mc(){this.Zb(503)}ng(){this.Ad(J=>
!!J.pasteParameters.ClientEstimationFloatingObjectId&&2===J.pasteParameters.CopyPasteTargetType&&J.isFromCurrentSession)}}Object(e.a)(Xa,"PasteArtSameWorkbookEvent",A,[]);class sb extends A{constructor(){super()}get eventId(){return 110}mc(){this.Zb(204)}}Object(e.a)(sb,"PasteHtmlEvent",A,[]);class ib extends A{constructor(){super()}get eventId(){return 35}mc(){this.Zb(506)}}Object(e.a)(ib,"PasteRangeEvent",A,[]);class Ub extends A{constructor(){super()}get eventId(){return 111}mc(){this.Zb(503)}ng(){this.Ad(J=>
1===J.pasteParameters.CopyPasteTargetType)}}Object(e.a)(Ub,"PasteShadowWorkbookRangeEvent",A,[]);class hc extends A{constructor(){super()}get eventId(){return 42}mc(){this.Zb(180)}}Object(e.a)(hc,"PasteStringEvent",A,[]);class yb extends A{constructor(){super()}get eventId(){return 134}mc(){this.Zb(220)}}Object(e.a)(yb,"PendingMergeEvent",A,[]);class Gb extends A{constructor(){super()}get eventId(){return 122}mc(){this.Zb(510)}}Object(e.a)(Gb,"PictureInsertedEvent",A,[]);class Sa extends A{constructor(){super()}get eventId(){return 153}mc(){this.Zb(161)}}
Object(e.a)(Sa,"PivotDrillToggledEvent",A,[]);class db extends A{constructor(J,Na){super();this.yga=J;this.opType=Na}get eventId(){return this.yga}mc(){this.Zb(225)}ng(){this.Ad(J=>J.opType===this.opType)}}Object(e.a)(db,"PivotTableSettingsChangedEventBase",A,[]);class fb extends db{constructor(){super(171,4)}}Object(e.a)(fb,"PivotTableAllItemLabelsRepeatedEvent",db,[]);class ab extends db{constructor(){super(184,17)}}Object(e.a)(ab,"PivotTableAltTextDescriptionChangedEvent",db,[]);class wb extends db{constructor(){super(183,
16)}}Object(e.a)(wb,"PivotTableAltTextTitleChangedEvent",db,[]);class kb extends db{constructor(){super(173,6)}}Object(e.a)(kb,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",db,[]);class tb extends db{constructor(){super(172,5)}}Object(e.a)(tb,"PivotTableBlankLineAfterEachItemToggledEvent",db,[]);class hb extends db{constructor(){super(170,3)}}Object(e.a)(hb,"PivotTableColumnGrandTotalShownEvent",db,[]);class Fb extends A{constructor(){super()}get eventId(){return 98}mc(){this.Zb(132)}}Object(e.a)(Fb,
"PivotTableCreatedEvent",A,[]);class va extends db{constructor(){super(177,10)}}Object(e.a)(va,"PivotTableDisplayErrorStringToggledEvent",db,[]);class jb extends db{constructor(){super(178,11)}}Object(e.a)(jb,"PivotTableDisplayNullStringToggledEvent",db,[]);class Ab extends db{constructor(){super(179,12)}}Object(e.a)(Ab,"PivotTableErrorStringChangedEvent",db,[]);class Qa extends db{constructor(){super(174,7)}}Object(e.a)(Qa,"PivotTableExpandCollapseButtonsShownEvent",db,[]);class Z extends db{constructor(){super(187,
20)}}Object(e.a)(Z,"PivotTableIndentChangedEvent",db,[]);class wa extends db{constructor(){super(176,9)}}Object(e.a)(wa,"PivotTableItemsWithNoDataOnColumnsShownEvent",db,[]);class Ea extends db{constructor(){super(175,8)}}Object(e.a)(Ea,"PivotTableItemsWithNoDataOnRowsShownEvent",db,[]);class fa extends db{constructor(){super(186,19)}}Object(e.a)(fa,"PivotTableLayoutTypeSetEvent",db,[]);class Ua extends db{constructor(){super(180,13)}}Object(e.a)(Ua,"PivotTableNullStringChangedEvent",db,[]);class Aa extends A{constructor(){super()}get eventId(){return 149}mc(){this.Zb(219)}}
Object(e.a)(Aa,"PivotTablePivotLocationChangedEvent",A,[]);class Ib extends A{constructor(){super()}get eventId(){return 102}mc(){this.Zb(145)}}Object(e.a)(Ib,"PivotTablePivotedEvent",A,[]);class Pb extends db{constructor(){super(182,15)}}Object(e.a)(Pb,"PivotTableRefreshDataOnLoadToggledEvent",db,[]);class Fa extends A{constructor(){super()}get eventId(){return 104}mc(){this.Zb(50)}ng(){this.Ad(J=>!!J.pivotTableId&&!!J.pivotTableName)}}Object(e.a)(Fa,"PivotTableRefreshedEvent",A,[]);class da extends db{constructor(){super(168,
1)}}Object(e.a)(da,"PivotTableRenamedEvent",db,[]);class K extends db{constructor(){super(169,2)}}Object(e.a)(K,"PivotTableRowGrandTotalShownEvent",db,[]);class xa extends db{constructor(){super(181,14)}}Object(e.a)(xa,"PivotTableSaveSourceDataWithFileToggledEvent",db,[]);var rb=a(622);class Qb extends A{constructor(){super()}get eventId(){return 155}mc(){this.Zb(131)}ng(){this.Ad(J=>{J=Object(U.a)(rb.a,J);return!!J&&!!J.bMa()&&!!J.hierarchyName})}}Object(e.a)(Qb,"PivotTableSortedEvent",A,[]);class pc extends db{constructor(){super(185,
18)}}Object(e.a)(pc,"PivotTableSubTotalsVisibilitySettingSetEvent",db,[]);class Lb extends A{constructor(){super()}get eventId(){return 206}mc(){this.Zb(560)}}Object(e.a)(Lb,"PivotValueFieldSettingAppliedEvent",A,[]);class qb extends A{constructor(){super()}get eventId(){return 161}mc(){this.Zb(243)}}Object(e.a)(qb,"PrintAreaClearedEvent",A,[]);class bc extends A{constructor(){super()}get eventId(){return 159}mc(){this.Zb(241)}ng(){this.Ad(J=>!J.addToPrintArea)}}Object(e.a)(bc,"PrintAreaSetEvent",
A,[]);class sc extends A{constructor(){super()}get eventId(){return 57}mc(){this.Zb(517)}}Object(e.a)(sc,"RangeAutoFilterClearedEvent",A,[]);class Tb extends A{constructor(J,Na){super();this.yga=J;this.J3d=Na}get eventId(){return this.yga}mc(){this.Zb(11)}ng(){this.Ad(J=>16===J.b_().ValidMembers);this.Ad(J=>J.b_().Font.ValidMembers===this.J3d)}}Object(e.a)(Tb,"RangeFontFormattedEventBase",A,[]);class $a extends Tb{constructor(){super(3,4)}}Object(e.a)($a,"RangeBoldedEvent",Tb,[]);class Nb extends A{constructor(){super()}get eventId(){return 2}mc(){this.Zb(11)}ng(){this.Ad(J=>
128===J.b_().ValidMembers)}}Object(e.a)(Nb,"RangeBorderedEvent",A,[]);class Ra{}Ra.Hbb="Table";Ra.gtc="Sheet";Object(e.a)(Ra,"MacroRecorderEventConstants",null,[]);class ob extends A{constructor(){super()}get eventId(){return 113}mc(){this.Zb(208)}ng(){this.Ad(J=>J.getParameters().FilterType===Ra.gtc)}}Object(e.a)(ob,"RangeCheckedItemsFilteredEvent",A,[]);class mb extends A{constructor(){super()}get eventId(){return 109}mc(){this.Zb(105)}}Object(e.a)(mb,"RangeConditionalFormattingCreatedEvent",A,
[]);class gb extends A{constructor(){super()}get eventId(){return 124}mc(){this.Zb(221)}}Object(e.a)(gb,"RangeConditionalFormattingRuleDeletedEvent",A,[]);class lb extends A{constructor(){super()}get eventId(){return 29}mc(){this.Zb(508)}ng(){this.Ad(J=>3===J.Kt()||1===J.Kt()||4===J.Kt())}}Object(e.a)(lb,"RangeContentClearedEvent",A,[]);class Xb extends A{constructor(){super()}get eventId(){return 40}mc(){this.Zb(104)}}Object(e.a)(Xb,"RangeCopiedCutCellsInsertedEvent",A,[]);class Xd extends A{constructor(){super()}get eventId(){return 114}mc(){this.Zb(209)}ng(){this.Ad(J=>
J.getParameters().FilterType===Ra.gtc)}}Object(e.a)(Xd,"RangeCustomFilteredEvent",A,[]);class Qd extends A{constructor(){super()}get eventId(){return 106}mc(){this.Zb(121)}}Object(e.a)(Qd,"RangeDataValidationChangedEvent",A,[]);class te extends Tb{constructor(){super(4,64)}}Object(e.a)(te,"RangeDoubleUnderlinedEvent",Tb,[]);class Pc extends A{constructor(){super()}get eventId(){return 69}mc(){this.Zb(190)}}Object(e.a)(Pc,"RangeDuplicatesRemovedEvent",A,[]);class Ne extends A{constructor(){super()}get eventId(){return 1}mc(){this.Zb(527);
this.Zb(12)}}Object(e.a)(Ne,"RangeEditedEvent",A,[]);class Hb extends A{constructor(){super()}get eventId(){return 164}mc(){this.Zb(255)}ng(){this.Ad(J=>4===J.actionType)}}Object(e.a)(Hb,"RangeExternalLinksBrokeAllLinksEvent",A,[]);class pb extends A{constructor(){super()}get eventId(){return 119}mc(){this.Zb(255)}ng(){this.Ad(J=>3===J.actionType)}}Object(e.a)(pb,"RangeExternalLinksBrokeLinkEvent",A,[]);class mc extends A{constructor(){super()}get eventId(){return 205}mc(){this.Zb(256)}Jxa(){this.tre("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}
Object(e.a)(mc,"RangeExternalLinksChangeSourceEvent",A,[]);class Kc extends A{constructor(){super()}get eventId(){return 163}mc(){this.Zb(553)}ng(){this.Ad(J=>1===J.actionType)}}Object(e.a)(Kc,"RangeExternalLinksRefreshedAllEvent",A,[]);class Nc extends A{constructor(){super()}get eventId(){return 77}mc(){this.Zb(553)}ng(){this.Ad(J=>0===J.actionType)}}Object(e.a)(Nc,"RangeExternalLinksRefreshedEvent",A,[]);class pd extends A{constructor(){super()}get eventId(){return 165}mc(){this.Zb(224)}}Object(e.a)(pd,
"RangeExternalLinksSetAutoRefreshEvent",A,[]);class Vd extends A{constructor(){super()}get eventId(){return 5}mc(){this.Zb(11)}ng(){this.Ad(J=>64===J.b_().ValidMembers)}}Object(e.a)(Vd,"RangeFillColoredEvent",A,[]);class $d extends A{constructor(){super()}get eventId(){return 59}mc(){this.Zb(155)}}Object(e.a)($d,"RangeFilledEvent",A,[]);class ue extends A{constructor(){super()}get eventId(){return 115}mc(){this.Zb(176)}ng(){this.Ad(J=>J.wV().AutoFilterType===Ra.gtc&&!!J.wV().CriteriaType)}}Object(e.a)(ue,
"RangeFilterAppliedEvent",A,[]);class he extends A{constructor(){super()}get eventId(){return 58}mc(){this.Zb(176)}ng(){this.Ad(J=>J.wV().AutoFilterType===Ra.gtc&&!J.wV().CriteriaType)}}Object(e.a)(he,"RangeFilterClearedEvent",A,[]);class Ge extends A{constructor(){super()}get eventId(){return 41}mc(){this.Zb(518)}}Object(e.a)(Ge,"RangeFilterReappliedEvent",A,[]);class Ad extends A{constructor(){super()}get eventId(){return 86}mc(){this.Zb(150)}}Object(e.a)(Ad,"RangeFlashFilledEvent",A,[]);class Ie extends Tb{constructor(){super(6,
32)}}Object(e.a)(Ie,"RangeFontColoredEvent",Tb,[]);class me extends Tb{constructor(){super(7,8)}}Object(e.a)(me,"RangeFontItalicizedEvent",Tb,[]);class cc extends Tb{constructor(){super(8,1)}}Object(e.a)(cc,"RangeFontNamedEvent",Tb,[]);class $c extends Tb{constructor(){super(9,2)}}Object(e.a)($c,"RangeFontSizedEvent",Tb,[]);class rd extends A{constructor(){super()}get eventId(){return 74}mc(){this.Zb(215)}}Object(e.a)(rd,"RangeFormattedAsTableEvent",A,[]);class Nd extends A{constructor(){super()}get eventId(){return 97}mc(){this.Zb(188)}}
Object(e.a)(Nd,"RangeGroupedOrUngroupedEvent",A,[]);class ed extends A{constructor(){super()}get eventId(){return 60}mc(){this.Zb(11)}ng(){this.Ad(J=>2===J.b_().ValidMembers)}}Object(e.a)(ed,"RangeHorizontallyAlignedEvent",A,[]);class yd extends A{constructor(){super()}get eventId(){return 43}mc(){this.Zb(526)}}Object(e.a)(yd,"RangeHyperlinkAppliedEvent",A,[]);class Ed extends A{constructor(){super()}get eventId(){return 63}mc(){this.Zb(11)}ng(){this.Ad(J=>256===J.b_().ValidMembers)}}Object(e.a)(Ed,
"RangeIndentChangedEvent",A,[]);class Ud extends A{constructor(){super()}get eventId(){return 53}mc(){this.Zb(156)}ng(){this.Ad(J=>2===J.Kt()||5===J.Kt()||6===J.Kt()||7===J.Kt())}}Object(e.a)(Ud,"RangeMergedEvent",A,[]);class fe extends A{constructor(){super()}get eventId(){return 107}mc(){this.Zb(216)}}Object(e.a)(fe,"RangeNamedCellStyleAppliedEvent",A,[]);class We extends A{constructor(){super()}get eventId(){return 12}mc(){this.Zb(11)}ng(){this.Ad(J=>32===J.b_().ValidMembers)}}Object(e.a)(We,"RangeNumberFormattedEvent",
A,[]);var lf=a(993);class Se extends A{constructor(){super()}get eventId(){return 108}mc(){this.Zb(141)}ng(){this.Ad(J=>Object(O.a)(lf.a,J))}}Object(e.a)(Se,"RangeSortedEvent",A,[]);class Ae extends Tb{constructor(){super(10,128)}}Object(e.a)(Ae,"RangeStrikedThroughEvent",Tb,[]);class Qe extends Tb{constructor(){super(11,16)}}Object(e.a)(Qe,"RangeUnderlinedEvent",Tb,[]);class $e extends A{constructor(){super()}get eventId(){return 61}mc(){this.Zb(11)}ng(){this.Ad(J=>1===J.b_().ValidMembers)}}Object(e.a)($e,
"RangeVerticallyAlignedEvent",A,[]);class of extends A{constructor(){super()}get eventId(){return 62}mc(){this.Zb(11)}ng(){this.Ad(J=>8===J.b_().ValidMembers)}}Object(e.a)(of,"RangeWrapTextToggledEvent",A,[]);class re extends A{constructor(){super()}get eventId(){return 103}mc(){this.Zb(51)}}Object(e.a)(re,"RefreshedAllEvent",A,[]);class zf extends A{constructor(){super()}get eventId(){return 47}mc(){this.Zb(148)}}Object(e.a)(zf,"ReplaceAllEvent",A,[]);class Lf extends A{constructor(){super()}get eventId(){return 91}mc(){this.Zb(532)}ng(){this.Ad(J=>
95!==J.getShapeType()&&96!==J.getShapeType()&&97!==J.getShapeType()&&98!==J.getShapeType()&&100!==J.getShapeType()&&102!==J.getShapeType()&&103!==J.getShapeType())}}Object(e.a)(Lf,"ShapeInsertedEvent",A,[]);class Ze extends A{constructor(){super()}get eventId(){return 92}mc(){this.Zb(531)}}Object(e.a)(Ze,"ShapeStyleSetEvent",A,[]);var ec=a(845);class Lc extends A{constructor(J,Na){super();this.yga=J;this.J3d=Na}get eventId(){return this.yga}mc(){this.Zb(581)}ng(){this.Ad(J=>Object(O.a)(ec.a,J)&&4===
J.getShapeTextFormat().ValidMembers);this.Ad(J=>Object(O.a)(ec.a,J)&&J.getShapeTextFormat().Font.ValidMembers===this.J3d)}}Object(e.a)(Lc,"ShapeTextFontFormattedEventBase",A,[]);class Da extends Lc{constructor(){super(193,4)}}Object(e.a)(Da,"ShapeTextBoldedEvent",Lc,[]);var Cb=a(995);class Zb extends A{constructor(){super()}get eventId(){return 191}mc(){this.Zb(581)}ng(){this.Ad(J=>Object(O.a)(Cb.a,J))}}Object(e.a)(Zb,"ShapeTextChangedEvent",A,[]);class yc extends Lc{constructor(){super(196,32)}}
Object(e.a)(yc,"ShapeTextFontColorChangedEvent",Lc,[]);class Vc extends Lc{constructor(){super(197,1)}}Object(e.a)(Vc,"ShapeTextFontNameChangedEvent",Lc,[]);class jd extends Lc{constructor(){super(198,2)}}Object(e.a)(jd,"ShapeTextFontSizeChangedEvent",Lc,[]);class ld extends A{constructor(){super()}get eventId(){return 199}mc(){this.Zb(581)}ng(){this.Ad(J=>Object(O.a)(ec.a,J)&&2===J.getShapeTextFormat().ValidMembers)}}Object(e.a)(ld,"ShapeTextHorizontallyAlignedEvent",A,[]);class Bd extends Lc{constructor(){super(194,
8)}}Object(e.a)(Bd,"ShapeTextItalicizedEvent",Lc,[]);class Td extends Lc{constructor(){super(195,16)}}Object(e.a)(Td,"ShapeTextUnderlinedEvent",Lc,[]);class Jd extends A{constructor(){super()}get eventId(){return 200}mc(){this.Zb(581)}ng(){this.Ad(J=>Object(O.a)(ec.a,J)&&1===J.getShapeTextFormat().ValidMembers)}}Object(e.a)(Jd,"ShapeTextVerticallyAlignedEvent",A,[]);class ce extends A{constructor(){super()}get eventId(){return 13}mc(){this.Zb(138)}}Object(e.a)(ce,"SheetAddedEvent",A,[]);var ie=a(9);
class we extends A{constructor(){super()}get eventId(){return 142}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);this.Ad(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>{J=J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>J.DeltaColumn&&!J.DeltaRow&&(!!J.InsertDeleteRange.FirstRow||J.InsertDeleteRange.LastRow!==ie.a.CB)||!J.DeltaColumn&&0>J.DeltaRow&&(!!J.InsertDeleteRange.FirstColumn||J.InsertDeleteRange.LastColumn!==ie.a.Cy)})}}Object(e.a)(we,
"SheetCellsDeletedEvent",A,[]);class zc extends A{constructor(){super()}get eventId(){return 143}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);this.Ad(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>{J=J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<J.DeltaColumn&&!J.DeltaRow&&(!!J.InsertDeleteRange.FirstRow||J.InsertDeleteRange.LastRow!==ie.a.CB)||!J.DeltaColumn&&0<J.DeltaRow&&(!!J.InsertDeleteRange.FirstColumn||J.InsertDeleteRange.LastColumn!==
ie.a.Cy)})}}Object(e.a)(zc,"SheetCellsInsertedEvent",A,[]);class Sc extends A{constructor(){super()}get eventId(){return 139}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);this.Ad(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>0>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);
this.Ad(J=>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===ie.a.CB)}}Object(e.a)(Sc,"SheetColumnDeletedEvent",A,[]);class td extends A{constructor(){super()}get eventId(){return 138}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);this.Ad(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>0<J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Ad(J=>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===ie.a.CB)}}Object(e.a)(td,"SheetColumnInsertedEvent",A,[]);class Md extends A{constructor(){super()}get eventId(){return 14}mc(){this.Zb(137)}}Object(e.a)(Md,"SheetDeletedEvent",A,[]);class wd extends A{constructor(){super()}get eventId(){return 137}mc(){this.Zb(185)}}Object(e.a)(wd,"SheetDirectionChangedEvent",
A,[]);class Ta extends A{constructor(){super()}get eventId(){return 54}mc(){this.Zb(139)}}Object(e.a)(Ta,"SheetDuplicatedEvent",A,[]);class Vb extends A{constructor(){super()}get eventId(){return 15}mc(){this.Zb(207)}}Object(e.a)(Vb,"SheetNameEditedEvent",A,[]);class qc extends A{constructor(){super()}get eventId(){return 90}mc(){this.Zb(151)}}Object(e.a)(qc,"SheetPaneFrozenEvent",A,[]);class Ic extends A{constructor(){super()}get eventId(){return 120}mc(){this.Zb(226)}}Object(e.a)(Ic,"SheetPrintSettingsSavedEvent",
A,[]);var gd=a(889);class Kd extends A{constructor(){super()}get eventId(){return 215}mc(){this.Zb(507)}Jxa(){this.tre("Microsoft.Office.Excel.SheetProtectionMacroRecording")}ng(){this.Ad(J=>Object.getType(J)===gd.a)}}Object(e.a)(Kd,"SheetProtectionPausedResumedEvent",A,[]);class oe extends A{constructor(){super()}get eventId(){return 64}mc(){this.Zb(557)}}Object(e.a)(oe,"SheetReorderedEvent",A,[]);class Ce extends A{constructor(){super()}get eventId(){return 141}mc(){this.Zb(237)}ng(){this.Ad(J=>
!!J.insertDeleteMultiRangeParameters);this.Ad(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Ad(J=>0>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Ad(J=>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===ie.a.Cy)}}Object(e.a)(Ce,
"SheetRowDeletedEvent",A,[]);class ze extends A{constructor(){super()}get eventId(){return 140}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);this.Ad(J=>!J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Ad(J=>0<J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);
this.Ad(J=>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===ie.a.Cy)}}Object(e.a)(ze,"SheetRowInsertedEvent",A,[]);class af extends A{constructor(){super()}get eventId(){return 39}mc(){this.Zb(135)}}Object(e.a)(af,"SheetRowsColumnsAutoFitEvent",A,[]);class Za extends A{constructor(){super()}get eventId(){return 36}mc(){this.Zb(136)}}Object(e.a)(Za,"SheetRowsColumnsResizedEvent",A,[]);class Rb extends A{constructor(){super()}get eventId(){return 68}mc(){this.Zb(183)}}
Object(e.a)(Rb,"SheetShowGridlinesToggledEvent",A,[]);class rc extends A{constructor(){super()}get eventId(){return 67}mc(){this.Zb(184)}}Object(e.a)(rc,"SheetShowHeadingsToggledEvent",A,[]);class Jc extends A{constructor(){super()}get eventId(){return 89}mc(){this.Zb(213)}}Object(e.a)(Jc,"SheetSpellCheckedEvent",A,[]);class Sb extends A{constructor(){super()}get eventId(){return 70}mc(){this.Zb(515)}}Object(e.a)(Sb,"SheetTabColoredEvent",A,[]);class Cc extends A{constructor(){super()}get eventId(){return 71}mc(){this.Zb(157)}}
Object(e.a)(Cc,"SheetVisibilityChangedEvent",A,[]);class cd extends A{constructor(){super()}get eventId(){return 126}mc(){this.Zb(239)}}Object(e.a)(cd,"SheetsVisibilityChangedEvent",A,[]);class Wd extends A{constructor(){super()}get eventId(){return 188}mc(){this.Zb(203)}}Object(e.a)(Wd,"SlicerInsertedEvent",A,[]);class je extends A{constructor(){super()}get eventId(){return 189}mc(){this.Zb(173)}ng(){this.Ad(J=>!J.clearFilter)}}Object(e.a)(je,"SlicerSelectionAppliedEvent",A,[]);class Ee extends A{constructor(){super()}get eventId(){return 190}mc(){this.Zb(173)}ng(){this.Ad(J=>
J.clearFilter)}}Object(e.a)(Ee,"SlicerSelectionClearedEvent",A,[]);class Ue extends A{constructor(){super()}get eventId(){return 27}mc(){this.Zb(208)}ng(){this.Ad(J=>J.getParameters().FilterType===Ra.Hbb)}}Object(e.a)(Ue,"TableCheckedItemsFilteredEvent",A,[]);class gf extends A{constructor(){super()}get eventId(){return 144}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);this.Ad(J=>J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>0>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(gf,"TableColumnDeletedEvent",A,[]);class rf extends A{constructor(){super()}get eventId(){return 145}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);this.Ad(J=>J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>0<J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(e.a)(rf,"TableColumnInsertedEvent",A,[]);var xf=a(994);class Vf extends A{constructor(){super()}get eventId(){return 121}mc(){this.Zb(141)}ng(){this.Ad(J=>Object(O.a)(xf.a,J))}}Object(e.a)(Vf,"TableColumnSortedEvent",A,[]);class Bb extends A{constructor(){super()}get eventId(){return 105}mc(){this.Zb(193)}}Object(e.a)(Bb,"TableConvertedToRangeEvent",A,[]);class ac extends A{constructor(){super()}get eventId(){return 16}mc(){this.Zb(206)}}Object(e.a)(ac,"TableCreatedEvent",A,[]);class tc extends A{constructor(){super()}get eventId(){return 30}mc(){this.Zb(209)}ng(){this.Ad(J=>
J.getParameters().FilterType===Ra.Hbb)}}Object(e.a)(tc,"TableCustomFilteredEvent",A,[]);class ub extends A{constructor(){super()}get eventId(){return 25}mc(){this.Zb(187)}ng(){this.Ad(J=>1===J.options.OperationType)}}Object(e.a)(ub,"TableCustomSortedEvent",A,[]);class jc extends A{constructor(){super()}get eventId(){return 28}mc(){this.Zb(176)}ng(){this.Ad(J=>J.wV().AutoFilterType===Ra.Hbb);this.Ad(J=>0===J.wV().CriteriaType)}}Object(e.a)(jc,"TableFilterClearedEvent",A,[]);class Ka extends A{constructor(){super()}get eventId(){return 32}mc(){this.Zb(176)}ng(){this.Ad(J=>
J.wV().AutoFilterType===Ra.Hbb);this.Ad(J=>{const Na=new h.a;Na.add(1);Na.add(2);Na.add(8);Na.add(9);Na.add(10);Na.add(11);Na.add(12);Na.add(13);Na.add(14);Na.add(15);Na.add(16);Na.add(17);Na.add(18);Na.add(19);Na.add(20);Na.add(21);Na.add(22);Na.add(23);Na.add(24);Na.add(25);Na.add(26);Na.add(27);Na.add(28);Na.add(29);Na.add(30);Na.add(31);Na.add(32);Na.add(33);Na.add(34);Na.add(35);Na.add(36);Na.add(37);Na.add(38);Na.add(39);return Na.contains(J.wV().CriteriaType)})}}Object(e.a)(Ka,"TableItemFilteredEvent",
A,[]);class zb extends A{constructor(){super()}get eventId(){return 101}mc(){this.Zb(217)}}Object(e.a)(zb,"TableRenamedEvent",A,[]);class Yb extends A{constructor(){super()}get eventId(){return 73}mc(){this.Zb(211)}}Object(e.a)(Yb,"TableResizedEvent",A,[]);class oc extends A{constructor(){super()}get eventId(){return 44}mc(){this.Zb(514)}}Object(e.a)(oc,"TableRowColumnRearrangedEvent",A,[]);class Wc extends A{constructor(){super()}get eventId(){return 146}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);
this.Ad(J=>J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Ad(J=>0>J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Wc,"TableRowDeletedEvent",A,[]);class vd extends A{constructor(){super()}get eventId(){return 147}mc(){this.Zb(237)}ng(){this.Ad(J=>!!J.insertDeleteMultiRangeParameters);this.Ad(J=>J.insertDeleteMultiRangeParameters.IsTableCommand);this.Ad(J=>!J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Ad(J=>0<J.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(vd,"TableRowInsertedEvent",A,[]);class Dd extends A{constructor(){super()}get eventId(){return 26}mc(){this.Zb(177)}ng(){this.Ad(J=>J.wV().AutoFilterType===Ra.Hbb)}}Object(e.a)(Dd,"TableSortedEvent",A,[]);class be extends A{constructor(){super()}get eventId(){return 87}mc(){this.Zb(212)}}Object(e.a)(be,"TableStyleAppliedEvent",A,[]);class se extends A{constructor(){super()}get eventId(){return 88}mc(){this.Zb(196)}}
Object(e.a)(se,"TableStyleOptionToggledEvent",A,[]);class Oe extends A{constructor(){super()}get eventId(){return 31}mc(){this.Zb(210)}ng(){this.Ad(J=>J.getParameters().FilterType===Ra.Hbb)}}Object(e.a)(Oe,"TableTop10FilteredEvent",A,[]);class Me extends A{constructor(){super()}get eventId(){return 207}mc(){this.Zb(238)}}Object(e.a)(Me,"TextToColumnsEvent",A,[]);class Ia extends A{constructor(){super()}get eventId(){return 128}mc(){this.Zb(559)}}Object(e.a)(Ia,"ValuesSortedEvent",A,[]);class Jb extends A{constructor(){super()}get eventId(){return 55}mc(){this.Zb(197)}}
Object(e.a)(Jb,"WorkbookCalculationModeSetEvent",A,[]);class xc extends A{constructor(){super()}get eventId(){return 34}mc(){this.Zb(181)}ng(){this.Ad(J=>!!J.parentCommentId)}}Object(e.a)(xc,"WorkbookCommentRepliedEvent",A,[]);class Zc extends A{constructor(){super()}get eventId(){return 33}mc(){this.Zb(181)}ng(){this.Ad(J=>!J.parentCommentId)}}Object(e.a)(Zc,"WorkbookCommentedEvent",A,[]);class qd extends A{constructor(){super()}get eventId(){return 56}mc(){this.Zb(128)}}Object(e.a)(qd,"WorkbookRecalculatedEvent",
A,[]);class Pd extends A{constructor(){super()}get eventId(){return 46}mc(){this.Zb(171)}}Object(e.a)(Pd,"WorkbookRedoEvent",A,[]);class le extends A{constructor(){super()}get eventId(){return 45}mc(){this.Zb(170)}}Object(e.a)(le,"WorkbookUndoEvent",A,[]);class ke extends A{constructor(){super()}get eventId(){return 116}mc(){this.Zb(507);this.Zb(576);this.Zb(10)}ng(){this.Ad(J=>{if(Object(O.a)(Q,J)&&(J=Object(U.a)(Q,J),void 0!==J.source&&null!==J.source&&void 0!==J.eventId&&null!==J.eventId))return u.ULS.sendTraceTag(537155426,
0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${J.source}; eventId: ${J.eventId}.`),!0;u.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(e.a)(ke,"DefaultRichApiRequestExecutedEvent",A,[]);class jf extends A{constructor(){super()}get eventId(){return 216}mc(){this.Zb(1022)}}Object(e.a)(jf,"TablelAltTextEditedEvent",A,[]);class nf extends A{constructor(){super()}get eventId(){return 217}mc(){this.Zb(263)}}Object(e.a)(nf,
"FloatingObjectZOrderChangedEvent",A,[]);var pe=a(996);class Re extends A{constructor(){super()}get eventId(){return 192}mc(){this.Zb(507)}ng(){this.Ad(J=>Object(O.a)(pe.a,J)?!0:!1)}}Object(e.a)(Re,"VisualPropertySetEvent",A,[]);class bf extends R{constructor(){super(219,[510])}}Object(e.a)(bf,"ChartSeriesDeletedEvent",R,[]);class Pf extends A{get eventId(){return 220}mc(){this.Zb(1027)}}Object(e.a)(Pf,"ChartDataChangedEvent",A,[]);class pg extends R{constructor(){super(221,[512])}}Object(e.a)(pg,
"ChartSeriesDataChangedEvent",R,[]);class $f{constructor(J){this.Bb=null;this.$=J}get macroRecorderEvents(){this.Bb||(this.Bb=new h.a,this.Bb.add(new Ne),this.Bb.add(new Nb),this.Bb.add(new $a),this.Bb.add(new te),this.Bb.add(new Vd),this.Bb.add(new Ie),this.Bb.add(new me),this.Bb.add(new cc),this.Bb.add(new $c),this.Bb.add(new Ae),this.Bb.add(new Qe),this.Bb.add(new We),this.Bb.add(new ce),this.Bb.add(new Md),this.Bb.add(new Vb),this.Bb.add(new ac),this.Bb.add(new gf),this.Bb.add(new rf),this.Bb.add(new Wc),
this.Bb.add(new vd),this.Bb.add(new td),this.Bb.add(new Sc),this.Bb.add(new ze),this.Bb.add(new Ce),this.Bb.add(new ub),this.Bb.add(new Dd),this.Bb.add(new Ue),this.Bb.add(new jc),this.Bb.add(new lb),this.Bb.add(new tc),this.Bb.add(new Oe),this.Bb.add(new Ka),this.Bb.add(new Zc),this.Bb.add(new xc),this.Bb.add(new ib),this.Bb.add(new Za),this.Bb.add(new we),this.Bb.add(new zc),this.Bb.add(new af),this.Bb.add(new Xb),this.Bb.add(new Ge),this.Bb.add(new yd),this.Bb.add(new hc),this.Bb.add(new oc),this.Bb.add(new Pd),
this.Bb.add(new le),this.Bb.add(new zf),this.Bb.add(new Ga),this.Bb.add(new Xa),this.Bb.add(new Ud),this.Bb.add(new Ta),this.Bb.add(new Jb),this.Bb.add(new qd),this.Bb.add(new sc),this.Bb.add(new he),this.Bb.add(new $d),this.Bb.add(new ed),this.Bb.add(new $e),this.Bb.add(new of),this.Bb.add(new Ed),this.Bb.add(new oe),this.Bb.add(new B),this.Bb.add(new ea),this.Bb.add(new rc),this.Bb.add(new Rb),this.Bb.add(new Pc),this.Bb.add(new Cc),this.Bb.add(new Sb),this.Bb.add(new Yb),this.Bb.add(new rd),this.Bb.add(new X),
this.Bb.add(new G),this.Bb.add(new Nc),this.Bb.add(new ua),this.Bb.add(new T),this.Bb.add(new E),this.Bb.add(new ha),this.Bb.add(new H),this.Bb.add(new N),this.Bb.add(new P),this.Bb.add(new la),this.Bb.add(new Ad),this.Bb.add(new be),this.Bb.add(new se),this.Bb.add(new Jc),this.Bb.add(new qc),this.Bb.add(new Lf),this.Bb.add(new Ze),this.Bb.add(new bb),this.Bb.add(new Ba),this.Bb.add(new qa),this.Bb.add(new sa),this.Bb.add(new Nd),this.Bb.add(new Fb),this.Bb.add(new ma),this.Bb.add(new pa),this.Bb.add(new zb),
this.Bb.add(new Ib),this.Bb.add(new re),this.Bb.add(new Fa),this.Bb.add(new Bb),this.Bb.add(new Qd),this.Bb.add(new fe),this.Bb.add(new Se),this.Bb.add(new mb),this.Bb.add(new sb),this.Bb.add(new Ub),this.Bb.add(new ka),this.Bb.add(new ob),this.Bb.add(new Xd),this.Bb.add(new ue),this.Bb.add(new M),this.Bb.add(new Gb),this.Bb.add(new pb),this.Bb.add(new Ic),this.Bb.add(new Vf),this.Bb.add(new gb),this.Bb.add(new cd),this.Bb.add(new nb),this.Bb.add(new Ia),this.Bb.add(new Ca),this.Bb.add(new F),this.Bb.add(new Ha),
this.Bb.add(new La),this.Bb.add(new yb),this.Bb.add(new Ma),this.Bb.add(new cb),this.Bb.add(new wd),this.Bb.add(new Pa),this.Bb.add(new Aa),this.Bb.add(new Sa),this.Bb.add(new ya),this.Bb.add(new Qb),this.Bb.add(new W),this.Bb.add(new aa),this.Bb.add(new ia),this.Bb.add(new bc),this.Bb.add(new D),this.Bb.add(new qb),this.Bb.add(new ra),this.Bb.add(new Kc),this.Bb.add(new Hb),this.Bb.add(new pd),this.Bb.add(new Oa),this.Bb.add(new V),this.Bb.add(new da),this.Bb.add(new K),this.Bb.add(new hb),this.Bb.add(new fb),
this.Bb.add(new tb),this.Bb.add(new kb),this.Bb.add(new Qa),this.Bb.add(new Ea),this.Bb.add(new wa),this.Bb.add(new va),this.Bb.add(new jb),this.Bb.add(new Ab),this.Bb.add(new Ua),this.Bb.add(new xa),this.Bb.add(new Pb),this.Bb.add(new wb),this.Bb.add(new ab),this.Bb.add(new pc),this.Bb.add(new fa),this.Bb.add(new Z),this.Bb.add(new Wd),this.Bb.add(new je),this.Bb.add(new Ee),this.Bb.add(new Zb),this.Bb.add(new Da),this.Bb.add(new Bd),this.Bb.add(new Td),this.Bb.add(new yc),this.Bb.add(new Vc),this.Bb.add(new jd),
this.Bb.add(new ld),this.Bb.add(new Jd),this.Bb.add(new mc),this.Bb.add(new Lb),this.Bb.add(new Me),this.Bb.add(new Kd),this.Bb.add(new jf),this.Bb.add(new nf),this.Bb.add(new Re),this.Bb.add(new bf),this.Bb.add(new pg),this.Bb.add(new Pf),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Lnj());return this.Bb}y7e(J,Na){let Eb=this.z7e(J,this.macroRecorderEvents,Na);Eb||(Eb=this.z7e(J,$f.wbi(),Na),!Eb&&this.knf(J,$f.HNe,Na)&&(Eb=$f.HNe));return Eb}z7e(J,Na,Eb){const gc=
new h.a;for(let vc of Na)this.knf(J,vc,Eb)&&gc.add(vc);return 1===gc.count?gc.ma(0):1<gc.count?$f.rUh(gc):null}knf(J,Na,Eb){const gc=$f.c8i(J,Na);return Eb?gc&&$f.Iak(J,Na):gc}Lnj(){const J=new h.a;for(let Na of this.Bb){let Eb=!1;for(let gc of Na.featureGates)if(!y.EwaSettings.ya(gc)){J.add(Na);Eb=!0;break}if(!Eb)for(let gc of Na.vZe)if(!y.EwaSettings.getBooleanFeatureGate(gc,!1)){J.add(Na);break}}for(let Na of J)this.Bb.remove(Na)}static wbi(){$f.YFb||($f.YFb=new h.a,$f.YFb.add(new Y),$f.YFb.add(new za));
return $f.YFb}static c8i(J,Na){return Na.operations.contains(J.operation)}static Iak(J,Na){Na=Na.rHc;if(!Na.count)return!0;let Eb=!0;for(let gc of Na)if(!gc(J.payload)){Eb=!1;break}return Eb}static rUh(J){let Na=J.ma(0);for(let Eb of J)Eb.rHc.count>Na.rHc.count&&(Na=Eb);return Na}}$f.YFb=null;$f.HNe=new ke;Object(e.a)($f,"MacroRecorderEventList",null,[]);class Ya extends d.a{constructor(J){super();this.$=J;this.Mb()}create(){this.vb(this.$.da.Aa(297)||new z(this.$,new $f(this.$),new l))}static la(J){J.da.Ha(298,
new Ya(J))}}Object(e.a)(Ya,"MacroRecorderEventHandlerFactory",d.a,[]);var Db=a(2),Wb=a(569);class Bc{constructor(){this.Xxg=new h.a}get F4b(){return this.Xxg}W3h(J){u.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",J);const Na=new h.a;for(let Eb of this.F4b)for(let gc of Eb.nHb)gc.id===J&&Na.add(gc);return Na}fre(J){this.F4b.add(J)}Fnj(J){for(let Na of this.F4b)if(Na.kve===J.kve){this.F4b.remove(Na);break}}static nrh(J,Na,Eb=null){J=Bc.ZWh(J);0<J.length&&(Bc.oAc(J,!1),Eb&&Eb(Na,J))}static ZWh(J){const Na=
[];if(J&&J.nHb&&0<J.nHb.count)for(let Eb of J.nHb)if(Eb.controls&&0<Eb.controls.count)for(let gc of Eb.controls)if(gc.menuItems&&0<gc.menuItems.count)for(let vc of gc.menuItems)Array.add(Na,vc.id);return Na}static oAc(J,Na){if(J.length){var Eb=[];for(const gc of J)Eb.push(appChrome.actions.updateControlEnabledDisabledState(gc,Na));appChrome.api.dispatch(Eb)}}}Object(e.a)(Bc,"ContextMenuExtensibilityCache",null,[746,747]);var Tc=a(1533),id=a(88),k=a(6),Ob=a(895),kc=a(842);class wc{x_a(J,Na=null){if(J=
kc.a.r5a(J)){appChrome.addInApi.dispatchActionsToInstallAddIn(J,Na);for(const Eb of J.tabs)if(Eb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(J,()=>{});break}}}RNd(J){(J=kc.a.r5a(J))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(J)}static vrh(J,Na,Eb=null){J=wc.c7h(J);0<J.length&&(wc.oAc(J,!1),Eb&&Eb(Na,J))}static c7h(J){const Na=[];if(J&&(J=J.EW,J.ot&&0<J.ot.count))for(let Eb of J.ot)if(Eb.groups&&0<Eb.groups.length)for(const gc of Eb.groups)if(gc.controls&&0<gc.controls.length)for(const vc of gc.controls)Array.add(Na,
vc.id);return Na}static oAc(J){if(J.length){var Na=[];for(const Eb of J)Na.push(appChrome.actions.updateControlEnabledDisabledState(Eb,!0));appChrome.api.dispatch(Na)}}}Object(e.a)(wc,"OneLineRibbonExtensibilityManager",null,[763]);var ad=a(971);class sd{constructor(){this.E7d=this.VIc=null}get hYc(){return this.VIc||(this.VIc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set hYc(J){this.VIc=J}get iZg(){return this.E7d||(this.E7d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(J,
Na){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(J,Na)}Pmd(J,Na,Eb,gc,vc,Qc=null,hd=null){u.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",J);if((J=Na.ika(vc.ownerAddinInfo.storeType,vc.ownerAddinInfo.solutionId))&&J.LB&&!J.LB.getIsUpgrading())if(Na=null,0<J.LB.getNotificationParams().length&&(Na=this.XAe(J.LB.getNotificationParams()[0]))&&2147758681===Na.errorCode&&(J.isUpgraded=!0),2!==J.LB.getStatus()&&(1!==J.LB.getStatus()||Na&&2147758681===Na.errorCode))Na&&
this.$bg(J,Na,hd);else try{Eb.setOwnerAddinEToken(J.LB.getEToken()),vc.action(Eb,gc.cea),Qc&&Qc()}catch(nd){u.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",k.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?nd.stack:nd.message)),ad.a.DWd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}$bg(J,Na,Eb=null){const gc=J.LB;if(1===gc.getNotificationParams().length||Na.whc){const vc=
Na.Dia,Qc=Na.Fja;Na.Dia=()=>{gc.removeFirstNotification();if(0<gc.getNotificationParams().length){const hd=this.XAe(gc.getNotificationParams()[0]);this.$bg(J,hd)}2147758681===Na.errorCode&&(wc.vrh(J.Vo,gc,Object(id.a)(this,this.zhf,"initUpgradeStateDetectTask")),Bc.nrh(J.Htb,gc,Object(id.a)(this,this.zhf,"initUpgradeStateDetectTask")));vc&&vc()};Na.Fja=()=>{Qc&&Qc();Eb&&Eb()};ad.a.EWd(Na)}}zhf(J,Na){let Eb=null;Eb=()=>{J.getIsUpgrading()?window.setTimeout(Eb,1E3):J.getUpgradingFailed()?wc.oAc(Na,
!0):k.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Eb,1E3)}XAe(J){const Na=new Ob.a;Na.vNa=J.infoType;Na.id=J.id;Na.title=J.title;Na.description=J.description;Na.buttonText=J.buttonTxt;Na.Dia=J.buttonCallback;Na.whc=J.highPriority;Na.Fja=J.dismissCallback;Na.errorCode=J.errorCode;Na.Fgf=J.iframeNotificationUrl;return Na}}Object(e.a)(sd,"AddinCommandsActionHandler",null,[736]);var Gd=a(84),Yd=a(170),ve=a(718),De=a(7),Pe=a(762),Xe=a(719);class yf{constructor(J,Na){this.Xa=J;this.idh=
Na}sRh(J){if(void 0!==J&&null!==J&&J===De.a.FIe)J="ContextMenuCell";else return null;const Na=this.Xa.Nc();this.JQh(Na,J);return Na}JQh(J,Na){Na=this.idh.W3h(Na);for(let Eb of Na){Na=Eb.controls;for(let gc of Na)this.vQh(J,gc)}}vQh(J,Na){var Eb=Na.GU[Pe.a.id];const gc=Na.GU[Pe.a.nWa],vc=Na.GU[Pe.a.rWa];let Qc="Image16by16",hd=Na.GU[Pe.a.oWa];Xe.c(vc)&&(Qc="None");0<Na.menuItems.count?(Eb=this.Xa.Gw(Eb,Eb,gc,798637440),Eb.jOb(Qc,vc,null),this.qRh(Eb.menu,Na),J.buttons.push(Eb)):J.buttons.push(this.Xa.GJa(Eb,
gc,hd,vc,Qc,null,!1))}qRh(J,Na){const Eb=this.Xa.Nc();for(let gc of Na.menuItems){Na=gc.fna[Pe.a.id];const vc=gc.fna[Pe.a.nWa],Qc=gc.fna[Pe.a.rWa];let hd="Image16by16";const nd=gc.fna[Pe.a.oWa];Xe.c(Qc)&&(hd="None");Na=this.Xa.GJa(Na,vc,nd,Qc,hd,null,!1);Eb.buttons.push(Na)}J.Cc.push(Eb)}}Object(e.a)(yf,"AddInCommandsContextMenuExtensibilityHandler",null,[893]);var ug=a(890);class ag{constructor(){this.ei=null;this.visible=!1}}Object(e.a)(ag,"AddinStatusCommandValues",null,[]);class wg{static vfj(J){const Na=
new ag;Na.ei=J.R_a;Na.visible=Na.ei?!0:!1;return Na}static dCc(J,Na,Eb,gc,vc){const Qc=document.getElementById(Eb);Qc?wg.EPj(J,Na,Qc,gc,vc):u.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Eb))}static EPj(J,Na,Eb,gc,vc){Eb?J.R_a===CommonUIStrings.l_ErrorLoadingAddInsTitle?ad.a.qOj(Na,Eb,gc,vc):J.R_a===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&ad.a.KPj(Na,Eb):u.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(e.a)(wg,"AddinCommandsStatusHandler",null,[]);var Bg=a(40),qg=a(231),Gf=a(15),Rg=a(33);class lh extends Bg.a{constructor(J,Na){super();this.agaveCommandManager=this.statusBarManager=null;this.tFe=()=>{this.kG&&this.kG.WEe()};this.acf=()=>{this.raiseEvent("LAC")};this.dd=(Eb,gc)=>{!Eb.jc&&qg.b(gc)&&this.statusBarManager&&(this.statusBarManager.fG(this),this.statusBarManager=null)};this.kG=Na;this.$=J;this.OUj=Rg.a.Pn()?document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]').getElementsByClassName("ms-Button-label")[0].id:
J.Ib+"OfficeAddinLabel-Medium14";this.$.da.kb(29,Eb=>{this.statusBarManager=Eb;Eb.OJ(this)});this.$.ea.Zj(this.dd);this.kG.JPg(this.acf);this.$.da.kb(206,Eb=>{this.agaveCommandManager=Eb;Eb.kRg(this.tFe)})}Iq(J){this.addHandler("LAC",J)}gr(J){this.removeHandler("LAC",J)}ns(J,Na){if("QueryAddinLabel"!==J)return!1;Na[ug.a.LabelText]!==this.kG.R_a&&(J=wg.vfj(this.kG),Na[ug.a.LabelText]=J.ei,Na[ug.a.Visible]=J.visible,window.setTimeout(()=>{this.dCc()},0));return!0}Qn(){return!0}dCc(){this.$&&wg.dCc(this.kG,
this.$.domElement,this.OUj,Gf.a.instance.ha(333),Gf.a.instance.ha(334))}dispose(){this.$.ea.xk(this.dd);this.kG.Poj(this.acf);this.agaveCommandManager&&(this.agaveCommandManager.bqj(this.tFe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.fG(this),this.statusBarManager=null);this.kG=this.$=null;super.dispose()}}Object(e.a)(lh,"AddinCommandsStatusBarManager",Bg.a,[229,230]);var qe=a(740),Ja=a(148),Kb=a(116),lc=a(997),Dc=a(1354),Oc=a(113),oa=a(582),na=a(144);class dc{constructor(){this.Q_a=
null}setErrorMessageForAddin(J,Na){this.Q_a||(this.Q_a={});this.Q_a[J]=Na}oZh(J){return this.Q_a&&J in this.Q_a?this.Q_a[J]:null}}Object(e.a)(dc,"AddinCommandsErrorManager",null,[]);var Rc=a(341),Fd=a(103);class de{constructor(){this.lq=this.mO=0;this.H_c=null;this.Vuc=this.YEc=0;this.ira=this.ENc=this.mJc=this.e7b=this.Eka=this.Y$=null}get G_c(){this.mJc||(this.mJc=new h.a);return this.mJc}get ygd(){this.ENc||(this.ENc=new h.a);return this.ENc}get xJa(){this.ira||(this.ira=new h.a);return this.ira}}
Object(e.a)(de,"AddinCommandsListLoaderContext",null,[]);var ne=a(848);class cf{}Object(e.a)(cf,"AppsForOfficeEntitlementQueryInfo",null,[]);var Bf=a(42);const Af=J=>{const Na={};Na.solutionId=J.solutionId;Na.version=J.version;Na.storeType=J.storeType;Na.storeId=J.storeId;Na.assetId=J.assetId;Na.assetStoreId=J.assetStoreId;Na.targetType=J.targetType;Na.requireConsent=J.requireConsent||!1;Na.isAddinCommands=!0;Na.addinCommandsActionType=0;return Na};class mg{constructor(J,Na){this.entitlement=J;this.metadata=
Na}Nig(){const J=Af(this.entitlement);J.targetType=this.targetType;return J}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}
Object(e.a)(mg,"AddinEntitlementEx",null,[]);var Kf=a(268),Zf=a(34);class Ug{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(e.a)(Ug,"AddinAbstract",null,[]);class eg extends Sys.EventArgs{constructor(){super();this.Vo=this.uk=null}}Object(e.a)(eg,"InsertionParamEventArgs",Sys.EventArgs,[]);class Tg{constructor(J,Na,Eb,gc=null){this.QMb=k.AFrameworkApplication.fa.Wa("RoamingServiceHandlerWebServiceBase");this.appName=J;this.vFa=Na;this.alb=Eb;this.lnb=gc}sbc(J){this.BYe(J,
"getAddinTeachingCalloutSettings",Object(id.a)(this,this.s5,"getRequestSuccessCallback"),Object(id.a)(this,this.dN,"getRequestFailureCallback"))}LIh(){const J=new h.a;J.add(this.appName);this.BYe(J,"getTeachingCalloutSettingsForAddinBetterEntryPoint",Object(id.a)(this,this.Q6h,"getRequestSuccessCallbackForBEP"),Object(id.a)(this,this.dN,"getRequestFailureCallback"))}BYe(J,Na,Eb,gc){const vc=new Sys.StringBuilder(this.QMb);vc.append("RoamingServiceHandler.ashx?action=");vc.append(Na);vc.append("&");
vc.append(this.Pkd(J));vc.append("&");vc.append(k.AFrameworkApplication.Di);k.AFrameworkApplication.Od.Zm(vc.toString(),1,null,null,!0,2,Eb,gc,null)}J4a(J){this.GYe(J,"saveAddinTeachingCalloutSettings")}QIh(J){this.GYe(J,"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}GYe(J,Na){const Eb=new Sys.StringBuilder(this.QMb);Eb.append("RoamingServiceHandler.ashx?action=");Eb.append(Na);Eb.append("&");Eb.append(k.AFrameworkApplication.Di);Na=Eb.toString();J=Bf.c(J);k.AFrameworkApplication.Od.Zm(Na,
2,J,null,!0,4,null,Object(id.a)(this,this.hO,"postRequestFailureCallback"),null)}s5(J){let Na=!1,Eb=null;try{if(0<J.data.te.length){const gc=Object(U.a)(Object,Bf.a(J.data.te)),vc=gc?gc[this.appName]:null;vc&&(Eb=Object(U.a)(Object,Bf.a(vc.toString())))}Na=!0}catch(gc){this.dN(null)}Na&&this.vFa&&this.vFa(Eb)}Q6h(J){let Na=!1,Eb=null;try{if(0<J.data.te.length){const gc=Object(U.a)(Object,Bf.a(J.data.te));Eb=Object(U.a)(String,gc[this.appName])||null}Na=!0}catch(gc){this.dN(null)}Na&&this.vFa&&(J=
{},J.Platforms=Eb,this.vFa(J))}dN(J){this.alb&&this.alb(J?J.data:null)}hO(J){this.lnb&&this.lnb(J?J.data:null)}Pkd(J){const Na=new Sys.StringBuilder("requestedsettings=");for(let Eb=0;Eb<J.count;Eb++)Na.append(J.ma(Eb)),Eb<J.count-1&&Na.append(";");return Na.toString()}}Object(e.a)(Tg,"AddinTeachingUIRoamingRequestHandler",null,[]);class Cg extends Sys.EventArgs{constructor(J){super();this.solutionId=J.solutionId;this.assetId=J.assetId;this.storeType=J.storeType;this.storeId=J.storeId;this.assetStoreId=
J.assetStoreId;this.targetType=J.targetType;this.width=J.width;this.height=J.height;this.displayName=J.displayName;this.version=J.version}}Object(e.a)(Cg,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Rf=a(354);class Mg{constructor(J){this.T_a=this.uk=null;this.Wea=!1;this.ira=this.xTb=this.loa=this.Jg=this.bY=this.wO=null;this.Qa=J}get appName(){return k.AFrameworkApplication.fa.Wa("WebAppShortName")}get pqb(){this.bY||(this.bY=new Tg(this.appName,Object(id.a)(this,this.s5,"getRequestSuccessCallback"),
Object(id.a)(this,this.dN,"getRequestFailureCallback"),Object(id.a)(this,this.hO,"postRequestFailureCallback")));return this.bY}get Bta(){this.xTb||(this.xTb=new h.a);return this.xTb}set Bta(J){this.xTb=J}get xJa(){this.ira||(this.ira=new h.a);return this.ira}set xJa(J){this.ira=J}dZc(J,Na){window.addEventListener?(this.uk=J,this.T_a=Na,window.addEventListener("LaunchAddinTaskpane",Object(id.a)(this,this.PFd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(id.a)(this,
this.JHb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(id.a)(this,this.FHb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(id.a)(this,this.zHb,"onCampaignLaunchedHandler"),!0)):u.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}b1d(J,Na,Eb,gc){this.Jg=J;this.Bta=Na;this.xJa=Eb;this.loa=gc;u.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",
Na?Na.count.toString():"null",Eb?Eb.count.toString():"null");0<this.Bta.count||0<this.xJa.count?(J=new h.a,J.add(this.appName),this.pqb.sbc(J)):this.loa(new h.a,null)}PFd(){const J=new Kf.ScriptSharpLegacyMap;this.T_a&&this.T_a.tabs&&!this.T_a.tabs[0].isOfficeTab&&J.ia("SDX.FeatureFlags","NonOfficeTab");this.Sma(Mg.DV(this.uk),"ClickOnLaunch",J);this.cna();this.T_a?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.T_a,()=>{const Na=new eg;Na.uk=this.uk;this.Qa.raiseEvent(qe.a.Jxd,Na)}):
u.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}FHb(){this.Sma(Mg.DV(this.uk),"ClickOnClose");this.cna()}JHb(){this.Sma(Mg.DV(this.uk),"ClickOnDismiss");this.cna()}zHb(J){if(J&&(J=J.detail)&&J.id&&this.Ird(J.id)){const Na=(J.action||"").toLowerCase();if(J.success&&"opened"===Na)this.Sma(Mg.DV(this.uk),"CampaignLaunched"),u.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.cna(),window.removeEventListener&&
window.removeEventListener("FGWebSurfaceEvent",Object(id.a)(this,this.zHb,"onCampaignLaunchedHandler"),!0);else{let Eb;try{Eb=JSON.stringify(J),u.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Eb)}catch(gc){Eb="id : "+J.id+" telemetryEventName: "+J.telemetryEventName,u.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Eb+" Error: "+(gc?gc.toString():""))}}}}Ird(J){J=Zf.a.Ok(J);return-1!==J.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==J.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||
-1!==J.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==J.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==J.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==J.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}NBa(J){if(this.appName){const Na={},Eb={};Eb.LastTeachingUIShowTime=(new Date).toUTCString();Eb.AddinHasShown=J;Na[this.appName]=Bf.c(Eb);this.pqb.J4a(Na);u.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else u.ULS.sendTraceTag(539530528,
220,10,"Fail to save roaming service since AppName is null")}cna(){if(!this.Wea){const J=window.g_roamingAddinList;J&&(this.NBa(J),this.Wea=!0)}}s5(J){J?this.iPb(J)?(u.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.wO="AddinHasShown"in J&&J.AddinHasShown?J.AddinHasShown.toString():null,this.ttb()):(u.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.loa(this.Bta,null)):(u.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.wO=null,this.ttb())}dN(J){u.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",J?J.httpStatus:-1);this.loa(this.Bta,null)}hO(J){u.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",J?J.httpStatus:-1)}ttb(){const J=this.P$c();0===J.targetType?(J.solutionId?this.XKd(J):this.Sma(null,"NoSolutionId"),this.fog(J),this.loa(this.Bta,null)):this.loa(this.Bta,J);u.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",J.addinId)}XKd(J){const Na=new cf;
Na.callbackFunc=Eb=>{if(Eb.errorCode){this.Sma(J.solutionId,"FailToGetAppDetails");var gc=window.g_roamingAddinList;gc&&this.NBa(gc)}else if(Eb.value)for(gc of Eb.value)if(Eb=gc[1],Eb===J.solutionId){const vc={};vc.solutionId=Eb;vc.assetId=gc[5];vc.storeType=gc[12];vc.storeId=gc[11];vc.assetStoreId=gc[6];vc.targetType=gc[3];vc.width=gc[7];vc.height=gc[8];vc.displayName=gc[0];vc.version=gc[4];u.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",J.solutionId);gc=new Cg(vc);
this.Qa.raiseEvent(qe.a.HWd,gc);break}};Na.storeType=OSF.StoreTypeEnum.PrivateCatalog;Na.fromInsertDialog=!1;Na.refresh=!1;this.Jg.queryEntitlementDetails(Na)}iPb(J){if("LastTeachingUIShowTime"in J){if(J=+new Date-+new Date(J.LastTeachingUIShowTime.toString()),J<k.AFrameworkApplication.fa.$M("AddinShowTeachingUIIntervalInMS",864E5))return u.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",J),!1}else u.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");
return!0}P$c(){let J=new Rc.a(new Ug,0),Na=new Rc.a(new Ug,0),Eb=0,gc=0,vc=0;var Qc=new h.a;for(var hd of this.Bta)Qc.add(hd);for(let nd of this.xJa)Qc.add(nd);for(let nd of Qc)if(!("excatalog"!==nd.storeType||Xe.c(nd.installTimeInMS)||!nd.installTimeInMS||nd.installTimeInMS<=k.AFrameworkApplication.fa.$M("DateTimeInMSForNewAddin",16409952E5))){Qc=Mg.Ixb(nd);if(this.wO&&(hd=this.wO.split(","),0<hd.length&&Array.contains(hd,Qc))){vc++;u.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");
continue}Qc.startsWith("private_")?(J=Mg.j7e(nd,J),gc++):(Na=Mg.j7e(nd,Na),Eb++)}u.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",gc,Eb,vc);return 0<Na.value?Na.key:0<J.value?J.key:Object.assign(new Ug,{addinId:null,targetType:-1,solutionId:null})}Sma(J,Na,Eb=null){J={["AppTeachingUICalloutAction"]:Na,["SDX.Id"]:J,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Eb)for(let gc of Eb.keys)J[gc]=
Eb.ma(gc);Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}))}fog(J){J&&(window.g_roamingAddinList=this.wO?this.wO+","+J.addinId:J.addinId)}static DV(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static j7e(J,Na){return Na.value<J.installTimeInMS?new Rc.a(Object.assign(new Ug,{addinId:Mg.Ixb(J),targetType:J.targetType,solutionId:J.solutionId}),J.installTimeInMS):
Na}static Ixb(J){return Telemetry.PrivacyRules.IsPrivateAddin(J.storeType,J.assetId,null,null,J.storeId)?"private_"+J.installTimeInMS:J.solutionId}}Object(e.a)(Mg,"PrivateCatalogTeachingCalloutHandler2",null,[]);var eh=a(83);const fh=()=>{const J=eh.a.j_(window.location.href.toLowerCase(),"wdomexsrctype");return!!J&&"4"===J},Gg=()=>eh.a.j_(window.location.href.toLowerCase(),"wdtpl"),Ng=()=>{const J=eh.a.j_(window.location.href.toLowerCase(),"wdomexsrctype");return!!J&&"1"===J};var mh=a(847),sh=a(707);
class th{constructor(J){this.Zr=null;this.qu=J}get_current(){if(!this.Zr)throw Error.argumentOutOfRange();return this.Zr.data}moveNext(){if(!this.Zr)return this.Zr=this.qu,!!this.qu;if(!this.Zr.next)return!1;this.Zr=this.Zr.next;return!0}Hpc(){if(!this.Zr)return this.Zr=this.qu,!!this.qu;if(!this.Zr.previous)return!1;this.Zr=this.Zr.previous;return!0}reset(){this.Zr=this.qu}}Object(e.a)(th,"ListEnumerator",null,[0]);class oh{constructor(J,Na,Eb){this.next=Eb;this.previous=Na;this.data=J}}Object(e.a)(oh,
"ListNode",null,[]);class ih{constructor(){this.RA=this.Aq=null;this._count=0}add(J){this.Aq?this.RA=this.RA.next=new oh(J,this.RA,null):this.Aq=this.RA=new oh(J,null,null);this._count=this.count+1}insert(J,Na){if(J>this.count||0>J)throw Error.argumentOutOfRange("pos");if(J===this.count)this.add(Na);else{for(var Eb=this.Aq;0!==J--;)Eb=Eb.next;J=new oh(Na,Eb.previous,Eb);J.previous?J.previous.next=J:this.Aq=J;J.next?J.next.previous=J:this.RA=J;this._count=this.count+1}}remove(J){let Na=this.Aq;for(;Na&&
Na.data!==J;)Na=Na.next;if(!Na)return!1;Na.previous?Na.previous.next=Na.next:this.Aq=Na.next;Na.next?Na.next.previous=Na.previous:this.RA=Na.previous;this._count=this.count-1;return!0}clear(){let J=this.Aq,Na;for(this.RA=this.Aq=null;J;)Na=J.next,J.previous=null,J.next=null,J=Na;this._count=0}indexOf(J){let Na=this.Aq,Eb=0;for(;Na&&Na.data!==J;)Na=Na.next,Eb++;return Na?Eb:-1}ma(J){return this.at(J).data}get count(){return this._count}getEnumerator(){return new th(this.Aq)}[Symbol.iterator](){return Object(sh.a)(this.getEnumerator())}pec(J){J=
this.at(J);return new th(J)}toArray(){const J=Array(this.count);let Na=0;for(let Eb of this)J[Na]=Eb,Na++;return J}at(J){let Na=this.Aq,Eb=0;for(;Eb!==J;){if(!Na)throw Error.argumentOutOfRange("pos");Na=Na.next;Eb++}return Na}}Object(e.a)(ih,"List",null,[1]);class Yg extends Sys.EventArgs{constructor(J){super();this.properties=J}}Object(e.a)(Yg,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class Jg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(e.a)(Jg,
"MiniAddinInfo",null,[]);class sf{constructor(J,Na,Eb){this.Qa=new Fd.a;this.context=new de;this.IWc=this.iYd=this.MHa=this.wO=this.bY=null;this.contextActivationMgr=J;this.BTg=Na;this.NHa=Eb;this.appName=k.AFrameworkApplication.fa.Wa("WebAppShortName")}get GQb(){this.IWc||(this.IWc=new Mg(this.Qa));return this.IWc}HPg(J){this.Qa.addHandler(qe.a.kqb,J)}$Sg(J){this.Qa.addHandler(qe.a.HWd,J)}M2j(J){null!==J&&(this.context.mO=J[qe.a.SP],this.context.lq=J[qe.a.rM],this.context.YEc=this.context.Vuc=0,
J=qe.a.OHa in J?J[qe.a.OHa]:0,-1!==this.context.mO&&0!==this.context.lq&&(this.context.Y$=new ih,this.context.Eka=new ih,this.context.e7b=new ih,this.context.H_c=this.BTg.createAddinDataProvider(mh.a(this.context.mO),this.contextActivationMgr),this.context.H_c?this.context.H_c.getEntitlementsAsync(this.contextActivationMgr.cea,!0,J,Na=>{this.U0i(Na)}):u.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.mO)))}U0i(J){if(J&&0<J.length){this.context.YEc=J.length;const Eb=
k.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Gg():null;for(let gc=0;gc<J.length;gc++){const vc=J[gc];if(k.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&Ng()&&vc&&vc.storeType&&"omex"===vc.storeType.toLowerCase()&&vc.assetId&&Eb&&vc.assetId.toLowerCase()===Eb.toLowerCase()){var Na={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:sf.DV(vc)};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Kb.a.mi(Na)}))}!vc||1!==vc.targetType&&-1!==vc.targetType?this.Fqc():(Na={},k.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Na.solutionId=vc.solutionId,Na.version=vc.version):(Na.marketplaceId=vc.solutionId,Na.marketplaceVersion=vc.version),Na.storeType=vc.storeType,Na.storeId=vc.storeId,Na.targetData=vc,sf.HQb?this.contextActivationMgr.isAddinCommandsExAsync(Na,Object(id.a)(this,this.p0i,"onIsAddinCommandsExCompleted")):
this.contextActivationMgr.isAddinCommandsAsync(Na,(Qc,hd,nd)=>{Qc?(hd&&this.context.Y$.add(nd.targetData),10===this.context.mO&&(Qc=nd.targetData,hd=Qc.targetType,Xe.c(nd.targetTypeForExp)||(hd=nd.targetTypeForExp,Qc.targetType=hd),this.context.Eka.add(Qc),0===hd&&this.context.e7b.add(Qc))):(nd=nd.targetData,u.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(nd.solutionId,nd.storeType,nd.assetId,null,null,nd.storeId),nd.storeType));
this.Fqc()}))}}else this.Fqc()}Fqc(){var J;(J=this.context).Vuc=J.Vuc+1;this.context.Vuc>=this.context.YEc&&(this.NHa.m7f(this.context.mO,!1),0<this.context.YEc&&10===this.context.mO&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(J=!1,k.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&fh()&&(J=this.PHi()),this.cHi(),k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&!J?sf.HQb?this.GQb.b1d(this.contextActivationMgr,this.context.G_c,this.context.xJa,(Na,Eb)=>{const gc=new h.a;for(let vc of Na)Na=vc.Nig(),Eb&&Eb.solutionId===vc.solutionId&&(Na.showCallout=!0,this.GQb.fog(Eb)),gc.add(Na);this.loa(gc)}):this.fTh(this.context.Y$):this.f1b(this.context.Y$)):this.f1b(this.context.Y$))}f1b(J){if(sf.HQb)this.loa(this.Hbh(this.context.G_c));else{var Na=new h.a;if(J)for(let Eb of this.context.Y$)Na.add(Af(Eb));this.context.Y$&&1>this.context.Y$.count&&ne.a.Dhb(qe.a.lqb,
"false",this.context.mO);J={["ack2"]:Na};J[qe.a.SP]=this.context.mO;J[qe.a.rM]=this.context.lq;this.Qa.raiseEvent(qe.a.kqb,new Yg(J),this)}}Hbh(J){const Na=new h.a;if(J)for(let Eb of J)Na.add(Eb.Nig());return Na}loa(J){J&&J.count||ne.a.Dhb(qe.a.lqb,"false",this.context.mO);J={["ack2"]:J};J[qe.a.SP]=this.context.mO;J[qe.a.rM]=this.context.lq;this.Qa.raiseEvent(qe.a.kqb,new Yg(J),this)}NBa(J){if(this.appName){const Na={},Eb={};Eb.LastTeachingUIShowTime=(new Date).toUTCString();Eb.AddinHasShown=J;Na[this.appName]=
Bf.c(Eb);this.bY&&(this.bY.J4a(Na),u.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else u.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}fTh(J){(this.MHa=J)?(J=new h.a,J.add(this.appName),this.bY=new Tg(this.appName,Object(id.a)(this,this.s5,"getRequestSuccessCallback"),Object(id.a)(this,this.dN,"getRequestFailureCallback"),Object(id.a)(this,this.hO,"postRequestFailureCallback")),
this.bY.sbc(J)):(J={["ack2"]:new h.a},J[qe.a.SP]=this.context.mO,J[qe.a.rM]=this.context.lq,this.Qa.raiseEvent(qe.a.kqb,new Yg(J),this))}s5(J){J?this.iPb(J)?(u.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.wO="AddinHasShown"in J&&J.AddinHasShown?J.AddinHasShown.toString():null,this.ttb()):(u.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.f1b(this.MHa)):(u.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.wO=null,this.ttb())}dN(J){u.ULS.sendTraceTag(539530529,
306,10,"GET data from Roaming Settings Service with status: {0}, fallback",J?J.httpStatus:-1);this.f1b(this.MHa)}hO(J){u.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",J?J.httpStatus:-1)}ttb(){const J=this.P$c();0===J.targetType?(J.solutionId?(this.iYd=J.solutionId,this.XKd()):this.Sma("NoSolutionId"),J.addinId&&(window.g_roamingAddinList=this.wO?this.wO+","+J.addinId:J.addinId),this.Ere(null)):this.Ere(J.addinId);u.ULS.sendTraceTag(528023563,
306,50,"Show teaching callout for: {0}",J.addinId)}XKd(){const J=new cf;J.callbackFunc=Na=>{if(Na.errorCode){this.Sma("FailToGetAppDetails");var Eb=window.g_roamingAddinList;Eb&&this.NBa(Eb)}else if(Na.value)for(Eb of Na.value)if(Na=Eb[1],Na===this.iYd){const gc={};gc.solutionId=Na;gc.assetId=Eb[5];gc.storeType=Eb[12];gc.storeId=Eb[11];gc.assetStoreId=Eb[6];gc.targetType=Eb[3];gc.width=Eb[7];gc.height=Eb[8];gc.displayName=Eb[0];gc.version=Eb[4];Eb=new Cg(gc);this.Qa.raiseEvent(qe.a.HWd,Eb);break}};
J.storeType=OSF.StoreTypeEnum.PrivateCatalog;J.fromInsertDialog=!1;J.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(J)}iPb(J){if("LastTeachingUIShowTime"in J){if(J=+new Date-+new Date(J.LastTeachingUIShowTime.toString()),J<k.AFrameworkApplication.fa.$M("AddinShowTeachingUIIntervalInMS",864E5))return u.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",J),!1}else u.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}P$c(){let J=
new Rc.a(new Jg,0),Na=new Rc.a(new Jg,0),Eb=0,gc=0,vc=0;var Qc=new ih;if(0<this.context.Y$.count)for(var hd of this.context.Y$)Qc.add(hd);if(0<this.context.e7b.count)for(let nd of this.context.e7b)Qc.add(nd);for(let nd of Qc)if(!("excatalog"!==nd.storeType||Xe.c(nd.installTimeInMS)||!nd.installTimeInMS||nd.installTimeInMS<=k.AFrameworkApplication.fa.$M("DateTimeInMSForNewAddin",16409952E5))){Qc=sf.Ixb(nd);if(this.wO&&(hd=this.wO.split(","),0<hd.length&&Array.contains(hd,Qc))){vc++;u.ULS.sendTraceTag(528345032,
306,50,"This addin has shown teaching UI before");continue}Qc.startsWith("private_")?(J.value<nd.installTimeInMS&&(J=new Rc.a(Object.assign(new Jg,{addinId:Qc,targetType:nd.targetType,solutionId:nd.solutionId}),nd.installTimeInMS)),gc++):(Na.value<nd.installTimeInMS&&(Na=new Rc.a(Object.assign(new Jg,{addinId:Qc,targetType:nd.targetType,solutionId:nd.solutionId}),nd.installTimeInMS)),Eb++)}u.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
gc,Eb,vc);return 0<Na.value?Na.key:0<J.value?J.key:Object.assign(new Jg,{addinId:null,targetType:-1,solutionId:null})}Ere(J){const Na=new h.a;for(let Eb of this.MHa){const gc=Af(Eb);if(J){const vc=sf.Ixb(Eb);J===vc&&(gc.showCallout=!0,window.g_roamingAddinList=this.wO?this.wO+","+J:J)}Na.add(gc)}this.MHa&&1>this.MHa.count&&ne.a.Dhb(qe.a.lqb,"false",this.context.mO);J={["ack2"]:Na};J[qe.a.SP]=this.context.mO;J[qe.a.rM]=this.context.lq;this.Qa.raiseEvent(qe.a.kqb,new Yg(J),this)}PHi(){if(sf.HQb)return this.QHi(this.context.ygd);
var J=!1;if(this.context.Eka&&1>this.context.Eka.count)return J;const Na=Gg();if(!Na)return J;for(let Eb of this.context.Eka)if(Eb.storeId&&Eb.storeId.toLowerCase()===Na.toLowerCase()||Eb.assetId&&Eb.assetId.toLowerCase()===Na.toLowerCase())J={["SDX_Id"]:sf.DV(Eb),["SDX_TargetType"]:Xe.c(Eb.targetType)?"":Eb.targetType.toString()},Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Kb.a.mi(J)})),J=!0;return J}cHi(){if(sf.HQb)this.dHi(this.context.ygd);
else if(!(this.context.Eka&&1>this.context.Eka.count))if(this.NHa.enf()){var J=this.NHa.e9e();J?(J=this.O4e(this.context.Eka,J),u.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(J=this.O4e(this.context.Eka,null),u.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.NHa.K9f(J)}else u.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}O4e(J,Na){const Eb={};let gc=!1;for(let vc of J)if(J=sf.DV(vc))!Na||J in Na||(this.PK(vc,J),u.ULS.sendTraceTag(527523849,
306,50,"New addin detected,log to AppInstall")),"private"===J.toLowerCase()?gc||(gc=!0,Eb[J]=null):Eb[J]=null;return Eb}PK(J,Na){var Eb=J.installTimeInMS?(new Date(J.installTimeInMS)).toISOString():"";Eb={["SDX.Id"]:Na,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Xe.c(J.targetType)?"":J.targetType.toString(),["SDX.AdminDeploymentTime"]:Eb};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kb.a.mi(Eb)}));1===J.targetType&&(J={["SDX.Id"]:Na,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kb.a.mi(J)})))}QHi(J){let Na=!1;if(J&&1>J.count)return Na;const Eb=Gg();if(!Eb)return Na;for(let gc of J)if(gc.storeId&&gc.storeId.toLowerCase()===Eb.toLowerCase()||gc.assetId&&gc.assetId.toLowerCase()===Eb.toLowerCase())J={["SDX_Id"]:sf.g9e(gc),["SDX_TargetType"]:Xe.c(gc.targetType)?"":gc.targetType.toString()},Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Kb.a.mi(J)})),Na=!0;return Na}dHi(J){if(!(J&&1>J.count))if(this.NHa.enf()){var Na=this.NHa.e9e();Na?(J=this.P4e(J,Na),u.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(J=this.P4e(J,null),u.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.NHa.K9f(J)}else u.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}P4e(J,Na){const Eb={};let gc=!1;for(let vc of J)if(J=sf.g9e(vc))!Na||J in
Na||(this.$Ji(vc,J),u.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===J.toLowerCase()?gc||(gc=!0,Eb[J]=null):Eb[J]=null;return Eb}$Ji(J,Na){var Eb=J.installTimeInMS?(new Date(J.installTimeInMS)).toISOString():"";Eb={["SDX.Id"]:Na,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Xe.c(J.targetType)?"":J.targetType.toString(),["SDX.AdminDeploymentTime"]:Eb};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kb.a.mi(Eb)}));
1===J.targetType&&(J={["SDX.Id"]:Na,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kb.a.mi(J)})))}p0i(J,Na,Eb,gc){J?(-1===gc.targetType&&(gc.targetType=Eb.targetTypeForExp),J=new mg(Eb.targetData,gc),Na&&this.context.G_c.add(J),10===this.context.mO&&(this.context.ygd.add(J),0===J.targetType&&this.context.xJa.add(J))):(Na=Eb.targetData,u.ULS.sendTraceTag(542978528,220,
15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Na.solutionId,Na.storeType,Na.assetId,null,null,Na.storeId),Na.storeType));this.Fqc()}Sma(J){J={["AppTeachingUICalloutAction"]:J,["SDX.Id"]:this.iYd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}))}static get HQb(){return k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static DV(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static g9e(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static Ixb(J){return Telemetry.PrivacyRules.IsPrivateAddin(J.storeType,J.assetId,null,null,J.storeId)?"private_"+J.installTimeInMS:J.solutionId}}Object(e.a)(sf,"AddInCommandsListLoader",null,[]);class ja{constructor(J){this.wFg=J}get cea(){return this.wFg}insertOsfControl(J){return this.cea.insertOsfControl(J)}getManifestInvaildErrorString(){return this.cea.getManifestInvaildErrorString()}isAddinCommandsAsync(J,
Na){this.cea.isAddinCommandsAsync(J,Na)}isAddinCommandsExAsync(J,Na){this.cea.isAddinCommandsExAsync(J,Na)}ownerAddinControlRecreated(J,Na){this.cea.ownerAddinControlRecreated(J,Na)}queryEntitlementDetails(J){this.cea.queryEntitlementDetails(J)}}Object(e.a)(ja,"ContextActivationMgrWrapper",null,[737]);class vb{createAddinDataProvider(J,Na){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(J,Na.cea)}static get instance(){vb.Ma||(vb.Ma=new vb);return vb.Ma}}vb.Ma=null;Object(e.a)(vb,
"OSFAddinDataProviderFactory",null,[738]);class nc{constructor(){this.Ver=1}}Object(e.a)(nc,"CacheItem",null,[]);class Ec{constructor(J){this.SFa=J}Ol(J){const Na=this.SFa.getItem(J);if(Na){let Eb=new nc;try{Eb=Sys.Serialization.JavaScriptSerializer.deserialize(Na,!0)}catch(gc){return this.SFa.removeItem(J),null}return Eb.Data?Eb.Data:Eb.data}return null}iSa(J){this.SFa.removeItem(J)}}Object(e.a)(Ec,"AppsDataCacheManager",null,[767]);var ud=a(812);class Od{constructor(){new Ec(ud.a.instance)}m7f(J,
Na){J=qe.a.T5e()+J;ud.a.instance.setItem(J,Na.toString())}e9e(){var J=qe.a.h9e();u.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",J);J=ud.a.instance.getItem(J);return Bf.a(J)}K9f(J){const Na=qe.a.h9e();u.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Na);ud.a.instance.setItem(Na,Bf.c(J))}enf(){return!!ud.a.instance.localStorage}static get instance(){Od.Ma||(Od.Ma=new Od);return Od.Ma}}Od.Ma=null;Object(e.a)(Od,"AddInCommandsCacheManager",null,[741]);class ge{constructor(J){this.mEc=
null;this.Wea=!1;this.Qa=new Fd.a;this.RMb=this.Tqa=null;this.contextActivationMgr=J;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(id.a)(this,this.H2i,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",Object(id.a)(this,this.JHb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",Object(id.a)(this,this.FHb,"onCloseButtonClickedEventHandler"),!0))}get appName(){Xe.b(this.Tqa)&&(this.Tqa=k.AFrameworkApplication.fa.Wa("WebAppShortName"));
return this.Tqa}ARg(J){this.Qa.addHandler(qe.a.Xsf,J)}b1d(){this.contextActivationMgr.queryStoreDisabled("omex",J=>{J?u.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.p1j()})}p1j(){this.mEc=new Tg(this.appName,Object(id.a)(this,this.s5,"getRequestSuccessCallback"),Object(id.a)(this,this.dN,"getRequestFailureCallback"),Object(id.a)(this,this.hO,"postRequestFailureCallback"));this.mEc.LIh()}s5(J){this.iPb(J)&&(u.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),
this.vXd())}dN(J){u.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",J?J.httpStatus:-1)}hO(J){u.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",J?J.httpStatus:-1)}iPb(J){if(!J)u.ULS.sendTraceTag(509690974,344,50,"userSettings is null");else if("Platforms"in J&&(this.RMb=Object(U.a)(String,J.Platforms),!Xe.b(this.RMb)&&(J=this.RMb.split(","),0<J.length&&Array.contains(J,"Web"))))return u.ULS.sendTraceTag(509690973,
344,50,"callout has shown for this platform"),!1;return!0}vXd(){const J=Gd.a.instance.$b("Common.ISystemInitiatedFeedback");if(J){var Na=this.WSh();Xe.b(Na)?u.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):J.execute(Eb=>{Eb.logActivity(Na,null)})}else u.ULS.sendTraceTag(509690972,344,50,"Error resolving ISystemInitiatedFeedback Future")}H2i(){this.PK("ClickOnLaunch");this.ARd();this.Qa.raiseEvent(qe.a.Xsf)}FHb(){this.PK("ClickOnClose");this.ARd()}JHb(){this.PK("ClickOnDismiss");this.ARd()}WSh(){let J;
switch(this.appName){case "Word":J="WordShowCalloutForBEPHomeTab";break;case "Excel":J="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":J="PPTShowCalloutForBEPHomeTab";break;default:J=""}return J}PK(J){J={["AppTeachingUICalloutAction"]:J,["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}))}ARd(){if(!this.Wea)if(Xe.b(this.appName))u.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");
else{const J={};J[this.appName]=this.RMb?this.RMb+",Web":"Web";this.mEc&&(this.mEc.QIh(J),u.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.Wea=!0}}}Object(e.a)(ge,"BetterEntryTeachingCalloutLauncher",null,[]);class ba{constructor(J,Na,Eb,gc,vc,Qc){this.lq=J;this.uk=Na;this.oX=Eb;this.displayName=vc;this.Urf=Qc}}Object(e.a)(ba,"PostLaunchAddinCommandsParameters",null,[]);class eb{constructor(J,Na,Eb){this.Wea=!1;this.bY=null;this.Za=J;this.ulb=
Na;this.Qib=Eb}dZc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(id.a)(this,this.PFd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(id.a)(this,this.JHb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(id.a)(this,this.FHb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(id.a)(this,this.zHb,"onCampaignLaunchedHandler"),!0)):u.ULS.sendTraceTag(525112601,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}PFd(){const J={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:eb.DV(this.ulb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.Qib&&this.Qib.tabs&&!this.Qib.tabs[0].isOfficeTab&&(J["SDX.FeatureFlags"]="NonOfficeTab");Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}));this.cna();this.Qib?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Qib,
()=>{const Na=new eg;Na.uk=this.ulb;this.Za.raiseEvent(qe.a.Jxd,Na)}):u.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}FHb(){const J={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:eb.DV(this.ulb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}));this.cna()}JHb(){const J=
{["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:eb.DV(this.ulb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}));this.cna()}zHb(J){if(J&&(J=J.detail)&&J.id&&this.Ird(J.id)){const Eb=(J.action||"").toLowerCase();if(J.success&&"opened"===Eb){var Na={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:eb.DV(this.ulb),
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(Na)}));u.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.cna();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(id.a)(this,this.zHb,"onCampaignLaunchedHandler"),!0)}else try{Na=JSON.stringify(J),u.ULS.sendTraceTag(523321995,
220,15,"Campaign launch failure. Event:"+Na)}catch(gc){Na="id : "+J.id+" telemetryEventName: "+J.telemetryEventName,u.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Na+" Error: "+(gc?gc.toString():""))}}}Ird(J){J=Zf.a.Ok(J);return-1!==J.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==J.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==J.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==J.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==J.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||
-1!==J.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}NBa(J){const Na=k.AFrameworkApplication.fa.Wa("WebAppShortName");if(Na){const Eb={},gc={};gc.LastTeachingUIShowTime=(new Date).toUTCString();gc.AddinHasShown=J;Eb[Na]=Bf.c(gc);this.bY=new Tg(Na,null,null,Object(id.a)(this,this.hO,"postRequestFailureCallback")),this.bY.J4a(Eb),u.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else u.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}cna(){if(!this.Wea){const J=window.g_roamingAddinList;J&&(this.NBa(J),this.Wea=!0)}}hO(J){u.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",J?J.httpStatus:-1)}static DV(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}}Object(e.a)(eb,"PrivateCatalogTeachingCalloutHandler",null,[]);class $b{constructor(J){this.dfe=null;this.Tce=
J}get Pya(){return this.dfe}x_a(J,Na=null){this.Tce.x_a(J,Na);this.dfe=J}RNd(J){this.Tce.RNd(J)}}Object(e.a)($b,"RibbonExtensibilityManagerWithChangeDetection",null,[763]);var uc=a(894),md=a(105);class Rd{static K6e(J){const Na=new h.a;if(Rd.DHe)for(var Eb of Rd.DHe)Na.add(Eb);Eb=null;switch(J){case "Workbook":Eb=Rd.Eck;break;case "Document":Eb=Rd.ith;break;case "Presentation":Eb=Rd.mdj}if(Eb)for(const gc of Eb)Na.add(gc);return Na}}Rd.DHe=["PrimaryCommandSurface","ContextMenu"];Rd.Eck=null;Rd.ith=
null;Rd.mdj=null;Object(e.a)(Rd,"ExtensionPointType",null,[]);class xe{constructor(J){this.gie=null;if(Xe.c(J))throw u.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Dwg=J}get nHb(){return this.gie||(this.gie=new h.a)}get kve(){return this.Dwg}}Object(e.a)(xe,"ContextMenuExtensibility",null,[744]);class Ke{constructor(J,Na=null,Eb=0){if(Xe.c(J))throw u.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),
Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.pFg=J;this.AIg=Na;this.iBg=Eb}get EW(){return this.pFg}get startedNode(){return this.AIg}get tSh(){return this.iBg}}Object(e.a)(Ke,"RibbonExtensibility",null,[792]);class Ye{constructor(J){this.kAg=J.entitlement}get entitlement(){return this.kAg}createActionContext(J,Na){J={};J.ownerAddinInfo=this.entitlement;J.action=Na;return J}}Object(e.a)(Ye,"AddInCommandsContextProvider",null,[]);class qf{constructor(J,Na,
Eb){this.S6d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=J;this.eventBuilder=Na;this.contextMenuBuilder=Eb}get addinInfo(){return this.S6d}Kgh(J){return new Ye(J)}createActionBuilder(J,Na){return OfficeExt.DefaultControlActionBinder.createActionBuilder(J,Na.entitlement,Na.manifest)}startApplyAddin(J){this.S6d=J;const Na=this.Kgh(J);this.actionBuilder=this.createActionBuilder(Na,J)}endApplyAddin(){}Zgd(J,Na,Eb=0){return this.ribbonBuilder.ot&&
0<this.ribbonBuilder.ot.count?new Ke(this.FRh(J,Na),this.addinInfo.startedNode,Eb):null}e2e(){var J=null;if(this.contextMenuBuilder.mpc&&0<this.contextMenuBuilder.mpc.count){J||(J=this.addinInfo.entitlement.solutionId);J=new xe(J);for(let Na of this.contextMenuBuilder.mpc)J.nHb.add(Na);return J}return null}FRh(J,Na){return this.ribbonBuilder.ot&&0<this.ribbonBuilder.ot.count?new kc.a(this.ribbonBuilder.ot,J,Na):null}}Object(e.a)(qf,"AddinCommandsBuilder",null,[]);class Sf{constructor(J,Na,Eb,gc,vc,
Qc,hd){this.KUa=new md.a;this.lq=J;this.Jg=Na;this.fp=Eb;this.ribbonManager=gc;this.contextMenuManager=vc;this.kG=Qc;this.aia=hd;this.PO=k.AFrameworkApplication.sa.jE}UEb(J,Na,Eb,gc,vc,Qc,hd){const nd=(Cd,Sd,Je,Te)=>{vc(Cd,Sd,Je,Te);Cd=uc.a[this.lq]+Sd.assetId;({value:Sd}=this.KUa.Mc(Cd)).returnValue&&(Sd.stop(),this.KUa.remove(Cd))};if(0!==this.lq&&J){u.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",J.count);4===this.lq&&(u.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
gc)),this.V8g(J,gc),Qc());for(let Cd of J)if(J=Cd,u.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.fp.iN,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId))),this.gqg(J))if(hd&&J.requireConsent)hd(J,Sd=>{try{if(this.PO){const Te=uc.a[this.lq]+Sd.solutionId,wf=this.PO.Qc("ComponentAttach",Te);this.KUa.ia(Te,wf)}const Je=this.kG.ika(Sd.storeType,Sd.solutionId);6!==this.lq&&(Je&&(this.U5b(Je),Je.LB.purge(!1)),
this.Jg.insertOsfControl(this.VJb(Sd,Na,Eb,nd)),Je&&this.Jg.ownerAddinControlRecreated(Sd.solutionId,Sd.storeType))}catch(Je){u.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.fp.iN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Sd.solutionId,Sd.ownerAddinStoreType||Sd.storeType,Sd.assetId,null,null,Sd.storeId),Sd.version,Sd.storeType,Sd.storeId,Je.message)),nd(!1,Sd,null,null)}});
else try{if(this.PO){const Je=uc.a[this.lq]+J.solutionId,Te=this.PO.Qc("ComponentAttach",Je);this.KUa.ia(Je,Te)}const Sd=this.kG.ika(J.storeType,J.solutionId);6!==this.lq&&(Sd&&(this.U5b(Sd),Sd.LB.purge(!1)),this.Jg.insertOsfControl(this.VJb(J,Na,Eb,nd)),Sd&&this.Jg.ownerAddinControlRecreated(J.solutionId,J.storeType))}catch(Sd){u.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.fp.iN,
Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId,Sd.message)),nd(!1,J,null,null)}else nd(!1,J,null,null)}}sEi(J,Na,Eb,gc,vc,Qc){const hd=(nd,Cd,Sd,Je)=>{Qc(nd,Cd,Sd,Je);nd=uc.a[this.lq]+Cd.solutionId;({value:Cd}=this.KUa.Mc(nd)).returnValue&&(Cd.stop(),this.KUa.remove(nd))};if(6===this.lq&&J)if(u.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.fp.iN,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,
J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId))),this.gqg(J))try{if(this.PO){const Cd=uc.a[this.lq]+J.solutionId,Sd=this.PO.Qc("ComponentAttach",Cd);this.KUa.ia(Cd,Sd)}const nd=this.kG.ika(J.storeType,J.solutionId);nd||hd(!1,J,null,null);k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.C2e(J,Na,gc,vc,Eb,Cd=>{hd(Cd,J,Eb,nd.displayName)}):(this.C2e(J,Na,gc,vc,Eb),hd(!0,J,Eb,nd.displayName))}catch(nd){u.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.fp.iN,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId,nd.message)),hd(!1,J,null,null)}else hd(!1,J,null,null)}wTi(J,Na,Eb,gc,vc,Qc){if(Qc)if(Qc._isAddinCommandsManifest(this.fp.iN))try{k.AFrameworkApplication.sa&&k.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.B2e(J,Na,Eb,vc,Qc,hd=>{gc(hd,J,Qc,Qc.getDefaultDisplayName())}):(this.B2e(J,Na,Eb,vc,Qc),gc(!0,J,Qc,Qc.getDefaultDisplayName()))}catch(hd){u.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.fp.iN,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId,hd.message)),gc(!1,J,Qc,Qc.getDefaultDisplayName())}else u.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.fp.iN,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId)),gc(!1,J,null,null);else u.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.fp.iN,Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.ownerAddinStoreType||J.storeType,J.assetId,null,null,J.storeId),J.version,J.storeType,J.storeId)),
gc(!1,J,null,null)}VJb(J,Na,Eb,gc){const vc={},Qc=document.createElement("div");Qc.setAttribute("visible","false");vc.div=Qc;vc.id=J.solutionId;vc.solutionId=J.solutionId;vc.version=J.version;vc.storeType=J.storeType;vc.storeId=J.storeId;vc.assetId=J.assetId;vc.assetStoreId=J.assetStoreId;vc.isvirtualOsfControl=!0;vc.virtualOsfControlActivationCallback=(hd,nd)=>{const Cd=this.kG.ika(J.storeType,J.solutionId);Cd&&(Cd.isUpgraded&&(J.isUpgraded=!0),this.U5b(Cd));this.wTi(J,Na,Eb,gc,hd,nd)};vc.reason=
3===this.lq?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return vc}B2e(J,Na,Eb,gc,vc,Qc=null){const hd={};hd.solutionId=gc.getSolutionId();hd.version=gc.getVersion();hd.storeType=gc.getStoreType();hd.storeId=gc.getStoreId();hd.assetId=gc.getAssetId();hd.assetStoreId=gc.getAssetStoreId();hd.targetType=gc.getOsfControlType();let nd=null,Cd=null;if(k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))nd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.fp.iN,this.fp.formFactor)).parseExtensions(hd,vc,this.aia),Cd=Rd.K6e(this.fp.iN);else try{nd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.fp.iN,this.fp.formFactor)).parseExtensions(hd,vc,this.aia),Cd=Rd.K6e(this.fp.iN)}catch(Je){throw u.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Je.message),Je;}if(Cd&&0<Cd.count){if(k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Sd=Na(J);Na=Eb(J);Eb=!!k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");Sd=new qf(Sd,null,Na);for(let Je of Cd)Sd.commandSurface=Je,nd.apply(Sd,this.aia,Eb)}else try{let Je=Na(J),Te=Eb(J),wf=!!k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");Sd=new qf(Je,null,Te);for(let Lg of Cd)Sd.commandSurface=Lg,nd.apply(Sd,this.aia,wf)}catch(Je){throw u.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Je.message),Je;}if(OSF.OUtil.checkFlight(14))try{let Je=Sd.Zgd(J.solutionId,vc.getDefaultDisplayName()),Te=Sd.e2e();Je&&this.ribbonManager.x_a(Je,Qc);Te&&this.contextMenuManager.fre(Te);this.kG.Lre(gc,Je,Te,vc.getDefaultDisplayName());u.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",vc.getDefaultDisplayName())}catch(Je){throw OfficeExt.DevConsole.log(Je),u.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Je.message),Je;}else try{let Je=Sd.Zgd(J.solutionId,
vc.getDefaultDisplayName()),Te=Sd.e2e();Je&&this.ribbonManager.x_a(Je);Te&&this.contextMenuManager.fre(Te);this.kG.Lre(gc,Je,Te,vc.getDefaultDisplayName());u.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",vc.getDefaultDisplayName())}catch(Je){throw u.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Je.message),Je;}}}C2e(J,Na,Eb,gc,vc,Qc=null){const hd={};hd.solutionId=J.solutionId;hd.version=J.version;hd.storeType=J.storeType;hd.storeId=J.storeId;hd.assetId=
J.assetId;hd.assetStoreId=J.assetStoreId;hd.targetType=J.targetType;const nd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.fp.iN,this.fp.formFactor);try{const Cd=Na.getManifest(),Sd=nd.parse(hd,Cd,vc,this.aia,Na.getSharedRuntimeId(),Na),Je=Eb(J),Te=gc(J),wf=new qf(Je,null,Te);wf.commandSurface="PrimaryCommandSurface";Sd.apply(wf,this.aia,!0);if(wf.ribbonBuilder.ot&&0<wf.ribbonBuilder.ot.count){const Lg=wf.Zgd(J.solutionId,Na.getManifest().getDefaultDisplayName(),1);k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.x_a(Lg,Qc):Lg&&this.ribbonManager.x_a(Lg,Qc);this.kG.LNg(Na,Lg,vc,Na.getManifest().getDefaultDisplayName());u.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Na.getManifest().getDefaultDisplayName())}}catch(Cd){u.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Na.getManifest().getDefaultDisplayName(),Cd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Cd)}}U5b(J){J.Vo&&this.ribbonManager.RNd(J.Vo);
J.Htb&&this.contextMenuManager.Fnj(J.Htb);this.kG.mnj(J.LB.getStoreType(),J.LB.getSolutionId())}V8g(J,Na){Na=mh.a(Na);for(let Eb of this.kG.K7a){if(Eb.LB.getStoreType()!==Na)continue;let gc=!0;for(let vc of J){const Qc=vc;if(Qc&&Eb.Zof(Qc.storeType,Qc.solutionId)){gc=!1;break}}gc&&(this.U5b(Eb),Eb.LB.purge(!1))}}gqg(J){return!!J&&!!J.solutionId&&!!J.version&&!!J.storeType&&!!J.storeId}}Object(e.a)(Sf,"AddInCommandsIntegration",null,[]);class If{constructor(J,Na,Eb,gc,vc,Qc,hd,nd=null){this.Za=new Fd.a;
this.oJc=J;this.Vyg=Na;this.Jl=Eb;this.toe=gc;this.hZa=vc;this.swg=Qc;this.yTb=hd;this.gFg=nd;this.WCg=k.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}IPg(J){this.Za.addHandler(qe.a.Eue,J)}zRg(J){this.Za.addHandler(qe.a.Jxd,J)}ZSg(J){this.Za.addHandler(qe.a.fcg,J)}PPg(J){this.Za.addHandler(qe.a.J1c,J)}LEi(J,Na,Eb){const gc=Eb[qe.a.jqb],vc=void 0===Eb[qe.a.rM]?0:Eb[qe.a.rM];if(gc&&0!==vc)if(0>=gc.count&&4!==vc)this.hRf(new ba(vc,null,null,Na,null,
!0));else{var Qc=gc.count,hd=new $b(new wc),nd=void 0===Eb[qe.a.SP]?-1:Eb[qe.a.SP],Cd=new Sf(vc,this.Jl,this.oJc,hd,this.Vyg,this.hZa,this.yTb),Sd=sg=>this.toe.c2g(sg.solutionId,this.yTb,this.oJc,J),Je=sg=>this.toe.m1g(sg.solutionId),Te=(sg,dg,gg)=>{Qc--;gg=new ba(vc,dg,hd,Na,gg,0>=Qc);if(sg&&dg)this.hRf(gg);else{if(3===vc||dg&&dg.isUpgraded)sg="",dg&&(sg=Telemetry.PrivacyRules.GetPrivacyCompliantId(dg.solutionId,dg.ownerAddinStoreType||dg.storeType,dg.assetId,null,null,dg.storeId)),dg={["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:sg},Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kb.a.mi(dg)}));this.gRf(gg)}Qc||k.AFrameworkApplication.sa.updateCommandUI()},wf=(sg,dg,gg,Fg)=>{Te(sg,dg,Fg)},Lg=()=>{this.ADd();0>=gc.count&&4===vc&&this.hZa.DTd()};6===vc?(nd=Eb[qe.a.DKa],Eb=Eb[qe.a.EKa],Cd.sEi(gc.ma(0),nd,Eb,Sd,Je,(sg,dg,gg,Fg)=>{Te(sg,dg,Fg)})):Cd.UEb(gc,Sd,Je,nd,wf,Lg,this.gFg)}else Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:Kb.a.mi({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),u.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.oJc.iN)),this.gRf(new ba(vc,null,null,Na,null,!0))}gRf(J){this.ADd(J);this.Vcg(!1,J)}hRf(J){const Na=J.uk;let Eb=null;null!==Na&&(Eb=Na.storeType,Eb=Eb.toLowerCase());if(J&&"omex"===Eb&&(3===J.lq||Na.isUpgraded)){var gc=
{["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Na.solutionId,Na.ownerAddinStoreType||Na.storeType,Na.assetId,null,null,Na.storeId)};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kb.a.mi(gc)}))}this.ADd(J);gc=Ng()&&"omex"===Eb&&!!J.oX&&!!Na.solutionId&&2===J.lq&&Na.solutionId.toLowerCase()===Gg().toLowerCase();var vc="excatalog"===Eb&&3===J.lq;if("omex"===Eb&&J.oX&&(3===
J.lq&&"hardcodedpreinstall"!==Eb||Na.isUpgraded)||gc||vc)gc=new eg,gc.uk=Na,gc.Vo=J.oX.Pya,this.Za.raiseEvent(qe.a.J1c,gc);this.WCg&&(gc=fh(),vc=Gg(),gc&&Na&&"excatalog"===Na.storeType&&J.oX&&5===J.lq&&vc&&(Na.storeId&&Na.storeId.toLowerCase()===vc.toLowerCase()||Na.assetId&&Na.assetId.toLowerCase()===vc.toLowerCase())&&(gc=new eg,gc.uk=Na,gc.Vo=J.oX.Pya,this.Za.raiseEvent(qe.a.J1c,gc),u.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));Na&&(Od.instance.m7f(mh.b(Eb),
!0),"uploadfiledevcatalog"===Eb&&(gc=this.swg.createAddinDataProvider(Eb,this.Jl))&&gc.localCacheAddinCommands(this.Jl.cea,Na.solutionId,Na.version,Na.storeId),ne.a.Dhb(qe.a.lqb,"true",mh.b(Eb)));this.Vcg(!0,J)}Vcg(J,Na){J?k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Na.oX&&5===Na.lq&&Na.oX.Pya&&void 0!==Na.uk.showCallout&&null!==Na.uk.showCallout&&Na.uk.showCallout?(k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)?(new Mg(this.Za)).dZc(Na.uk,kc.a.r5a(Na.oX.Pya)):(new eb(this.Za,Na.uk,kc.a.r5a(Na.oX.Pya))).dZc(),J=new eg,J.Vo=Na.oX.Pya,J.uk=Na.uk,this.Za.raiseEvent(qe.a.fcg,J)):3!==Na.lq?Na.Urf&&this.hZa.DTd():Na.oX&&Na.oX.Pya&&"hardcodedpreinstall"!==Na.uk.storeType&&ad.a.sOj(Na.displayName,Na.oX.Pya,Na.uk.isAutoLaunched):3===Na.lq?Na.uk&&"uploadfiledevcatalog"===Na.uk.storeType.toLowerCase()?(Na=this.yTb.oZh(Na.uk.solutionId),ad.a.DWd(Na?Na:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.hZa.t8f():Na.Urf&&this.hZa.DTd()}ADd(J=null){var Na=J?J.uk:null;const Eb=new eg;if(Eb.uk=Na){var gc=this.hZa.ika(Na.storeType,Na.solutionId,6===J.lq?1:0);if(gc&&gc.Vo){Eb.Vo=gc.Vo;var vc=Gg();vc=Ng()&&!!Na.solutionId&&!!vc&&Na.solutionId.toLowerCase()===vc.toLowerCase()&&2===J.lq;if(3===J.lq&&"hardcodedpreinstall"!==Na.storeType||vc)J="",gc.Vo.EW&&gc.Vo.EW.ot&&(gc=gc.Vo.EW.ot.ma(0))&&(J=gc.id),Na={["SDX_CommandPlacement"]:J,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Na.solutionId,
Na.ownerAddinStoreType||Na.storeType,Na.assetId,null,null,Na.storeId)},Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kb.a.mi(Na)}))}}this.Za.raiseEvent(qe.a.Eue,Eb)}}Object(e.a)(If,"LaunchAddinCommandsHandler",null,[749]);class hf{}hf.nWa="Alt";hf.oWa="Command";hf.id="Id";hf.rWa="Image16by16";hf.hTb="LabelText";hf.sWa="Title";hf.GROUP="Group";hf.N5d="Groups";hf.Iib="Controls";hf.button="Button";hf.Wba="FlyoutAnchor";hf.LARGE="Large";hf.SMALL=
"Small";Object(e.a)(hf,"AddinDataNodeConstants",null,[]);var ng=a(383);a(576);var xg=a(573);a(131);class rg{constructor(J,Na){this.YFa=this.B9d=null;if(Xe.c(J)||Xe.c(Na))throw u.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.azg=Na;this._id=J;this.GU[hf.id]=this._id}get id(){return this._id||""}get GU(){return this.B9d||(this.B9d={})}get controlType(){return this.azg||
""}get menuItems(){return this.YFa||(this.YFa=new h.a)}}Object(e.a)(rg,"ControlDefinition",null,[748]);class tg{constructor(J){this.Pge=null;if(Xe.c(J))throw u.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=J;this.fna[hf.id]=this._id}get fna(){return this.Pge||(this.Pge={})}get id(){return this._id||""}}Object(e.a)(tg,"MenuItemDefinition",null,[783]);class gh{constructor(J){this.kra=
null;if(Xe.c(J))throw u.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=J}get id(){return this._id}get controls(){return this.kra||(this.kra=new h.a)}}Object(e.a)(gh,"OfficeMenuDefinition",null,[745]);var Nf=a(26);class uh{constructor(J,Na,Eb){this.vJ=this.fXa=null;this.ySc=J;this.WWa=Na;this.uWa=Eb;this.EEg=new h.a}get Upc(){return this.ySc}get htb(){return this.WWa}get gYc(){return this.uWa}addButton(J){u.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",J.actionType);this.vJ=new rg(this.bua(J.id),hf.button);this.vJ.GU[hf.hTb]=J.label;this.vJ.GU[hf.nWa]=J.label;this.vJ.GU[hf.rWa]=J.icon["16"];this.Arb(this.vJ.GU[hf.id],J.action);this.xHa(this.vJ.GU);this.fXa.controls.add(this.vJ);this.vJ=null}startBuildMenu(J){if(Xe.c(this.fXa))this.fXa=new gh(J.id);else{const Na=this.bua(J.id);this.vJ=new rg(Na,hf.Wba);this.f1a(this.vJ.GU,J);this.vJ.GU[hf.rWa]=J.icon["16"];this.vJ.GU[hf.oWa]=Nf.a.alwaysEnabled}}addMenuItem(J){u.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",J.actionType);const Na=new tg(this.bua(J.id));this.f1a(Na.fna,J);J.icon&&(Na.fna[hf.rWa]=J.icon["16"]);this.Arb(Na.fna[hf.id],J.action);this.xHa(Na.fna);this.vJ.menuItems.add(Na)}endBuildMenu(){Xe.c(this.vJ)?(this.mpc.add(this.fXa),this.fXa=null):(this.fXa.controls.add(this.vJ),this.vJ=null)}get mpc(){return this.EEg}Arb(J,Na){this.gYc.bindAction(J,Na)}xHa(J){this.htb.xHa(J)}bua(J){return this.Upc.ZLa(J)}f1a(J,Na){J[hf.hTb]=Na.label;J[hf.nWa]=Na.label}}
Object(e.a)(uh,"ContextMenuExtensibilityCreator",null,[770,765]);class vh{constructor(J){this.Hmb=J}get KGb(){return this.Hmb}ZLa(J){return this.KGb+J}}Object(e.a)(vh,"DefaultContextMenuNamingProvider",null,[769]);var wh=a(1356);class xh{bindAction(J,Na){OfficeExt.DefaultControlActionBinder.bindAction(J,Na)}}Object(e.a)(xh,"DefaultUIControlActionBinder",null,[768]);class ji{constructor(J){this.EEa=J}get command(){return this.EEa}xHa(J){J[hf.oWa]=this.command}}Object(e.a)(ji,"DefaultUIControlCommandBinder",
null,[766]);var Mf=a(30);class zh{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(e.a)(zh,"AddInControl",null,[]);class Fh{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(e.a)(Fh,"AddInGroup",null,[]);class ki{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(e.a)(ki,"AddInMenuItem",null,[]);class Uh{constructor(){this.groups=
this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(e.a)(Uh,"AddInTab",null,[]);class ai{constructor(J,Na,Eb,gc,vc,Qc){this.vTb=new h.a;this.Wjb=this.mga=this.gXa=null;this.ySc=J;this.uWa=Na;this.WWa=Eb;this.Mx=gc;this.yTb=vc;this.Bae=Qc}get Upc(){return this.ySc}get ot(){return this.vTb}get gYc(){return this.uWa}get htb(){return this.WWa}startBuildTab(J){const Na=J.isOfficeTab?J.id:this.Upc.eaf(J.id),
Eb=J.isOfficeTab?null:J.label;this.gXa=Object.assign(new Uh,{id:Na,title:Eb,isOfficeTab:J.isOfficeTab,visible:J.visible,groups:[],tabType:J.tabType,insertBefore:J.insertBefore,insertAfter:J.insertAfter,autoFocus:J.autoFocus})}startBuildGroup(J){const Na=this.bua(J.id);this.mga=Object.assign(new Fh,{id:Na,mlrId:J.mlrId,title:J.label,controls:[],groupType:0})}addNativeGroup(J){this.mga=Object.assign(new Fh,{id:J.id,mlrId:J.mlrId,title:J.label,controls:[],groupType:1});this.gXa.groups.push(this.mga)}addButton(J){const Na=
this.bua(J.id);Na&&(this.Arb(Na,J.action),u.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",J.actionType),J=Object.assign(new zh,{id:Na,title:J.label,iconLocation:this.Ijd(J),enabled:J.enabled,controlType:0,attributes:this.f1a()}),this.Bae.Qqe(new Mf.a(Na,this.htb.command.toString())),this.mga.controls.push(J))}addNativeControl(J){J.id&&(u.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",J.actionType),J=Object.assign(new zh,{id:J.id,
title:"",iconLocation:"",enabled:J.enabled,controlType:2,attributes:this.f1a()}),this.mga.controls.push(J))}startBuildMenu(J){const Na=this.bua(J.id);Na&&(this.Wjb=Object.assign(new zh,{id:Na,title:J.label,iconLocation:this.Ijd(J),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(J){const Na=this.bua(J.id);Na&&(this.Arb(Na,J.action),u.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",J.actionType),J=Object.assign(new ki,{id:Na,title:J.label,iconLocation:this.Ijd(J),
enabled:J.enabled,attributes:this.f1a()}),this.Bae.Qqe(new Mf.a(Na,this.htb.command.toString())),this.Wjb.menuItems.push(J))}endBuildMenu(){Xe.c(this.Wjb.id)||this.mga.controls.push(this.Wjb);this.Wjb=null}endBuildGroup(){Xe.c(this.mga.id)||this.gXa.groups.push(this.mga);this.mga=null}endBuildTab(){Xe.c(this.gXa.id)||this.vTb.add(this.gXa);this.gXa=null}f1a(){const J={};this.xHa(J);return J}Ijd(J){return J.icon["80"]?J.icon["80"]:J.icon["32"]}xHa(J){this.htb.xHa(J)}bua(J){return this.Upc.ZLa(J)}Arb(J,
Na){this.gYc.bindAction(J,Na)}}Object(e.a)(ai,"OneLineRibbonExtensibilityCreator",null,[764,765]);class ye{constructor(J,Na){this.Hmb=J;this.uWa=new xh;this.WWa=new ji(Na)}m1g(J){J=new vh(J);return new uh(J,this.WWa,this.uWa)}c2g(J,Na,Eb,gc){Eb=new wh.a(this.Hmb,J,Eb,!0);return new ai(Eb,this.uWa,this.WWa,J,Na,gc)}}Object(e.a)(ye,"UIExtensibilityFactory",null,[739]);var L=a(98),ta=a(893),Va=a(23),Mb=a(39),ic=a(80),Gc=a(53);class Hc{constructor(J){this.LHa=this.QHa=this.uk=this.Vo=null;this.QYf=0;
this.I0i=()=>{if(this.uk&&this.LHa){const Na=new L.a(Nf.a.r3,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Na,{["SourceControlId"]:this.LHa},null);u.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.tOj=(Na,Eb)=>{Na=null;if(Eb)if(Na=Eb,this.uk=Na.uk,(this.Vo=Na.Vo)&&this.Vo.EW&&this.Vo.EW.ot&&(this.QHa=this.Vo.EW.ot.ma(0)),this.QHa&&this.QHa.id)if(this.QHa.isOfficeTab)if(Eb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Na=this.uk.solutionId,
Na in Eb?this.LHa=Eb[Na]:(Eb=Hc.GetPrivacyCompliantId(this.uk),u.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Eb}`),this.LHa=this.eTh(this.Vo)),this.LHa)if(Va.a.contains(this.QHa.id,De.a.$W,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(kc.a.r5a(this.Vo),()=>{this.ydg(this.Qkd(this.LHa))});else{if(Eb=this.$.Ia)Eb.wue(this.IMf),u.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else u.ULS.sendTraceTag(537170694,
220,10,"Failed to get button id for addin"),Eb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Hc.GetPrivacyCompliantId(this.uk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(Eb)})),this.U6();else this.Adg(this.Qkd(this.QHa.id),0);else u.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
Eb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Hc.GetPrivacyCompliantId(this.uk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(Eb)})),this.U6();else this.U6()};this.IMf=()=>{if(Va.a.contains(this.QHa.id,appChrome.selectors.getSelectedTabId(),!0)){var Na=this.$.Ia;Na&&Na.M_f(this.IMf);this.ydg(this.Qkd(this.LHa))}};this.K0i=
()=>{var Na={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Hc.pWa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(Na)}));this.U6();let Eb={};Eb[ic.a.$f]=this.$C;Na={};Na.solutionId=this.$C.solutionId;Na.assetId=this.$C.assetId;Na.assetStoreId=this.$C.assetStoreId;Na.height=0!=this.$C.height?this.$C.height:600;Na.storeId=
this.$C.storeId;Na.storeType=this.$C.storeType;Na.targetType=this.$C.targetType;Na.width=0!=this.$C.width?this.$C.width:600;Na.displayName=this.$C.displayName;Na.version=this.$C.version;Na.isAddinCommands=!1;Eb[qe.a.Z$]=Na;let gc=new L.a(-741808261,0,0,2,null);Mb.TaskExtensions.za(Gc.GetServiceTaskFactory.Sa(this.$.da,374,375,1),vc=>{vc=vc.result;null!=vc&&vc.insertAgave(Eb,gc)},this.$.ka,3)};this.vVi=()=>{let Na={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Hc.pWa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(Na)}));this.U6()};this.QWi=()=>{let Na={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Hc.pWa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(Na)}));this.U6()};
this.hO=Na=>{u.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Na?Na.httpStatus:-1}`)};this.$=J.$;this.addinUICommandHandler=J;this.appName=k.AFrameworkApplication.fa.Wa("WebAppShortName")||"Excel";this.FTg=k.AFrameworkApplication.fa.Dd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,J.storeType,J.assetId,null,null,J.storeId)}static pWa(J){return Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,
J.storeType,J.assetId,null,null,J.storeId)}Fmj(J){this.$C=J;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.K0i,!0),window.addEventListener("DismissCallout",this.QWi,!0),window.addEventListener("CloseCallout",this.vVi,!0))}Qkd(J){return"[id="+J+"]"}Adg(J,Na){Na>this.FTg?(window.clearTimeout(this.QYf),this.zdg("[data-unique-id='pivotOverflowButton']"),u.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+
J)?this.zdg(J):this.QYf=window.setTimeout(()=>{this.Adg(J,Na+1)},1E3)}ydg(J){var Na=document.querySelector("button[data-unique-id='RightPaddle']");if(Na)J={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Hc.GetPrivacyCompliantId(this.uk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}));else if(Na=document.querySelector("button"+
J),!Na||"none"===window.getComputedStyle(Na).display)if(Na=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Na){Na={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Hc.GetPrivacyCompliantId(this.uk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(Na)}));u.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");
this.U6();return}this.Vjg(Na,"ShowTeachingUIForAddinButton")}zdg(J){J=document.querySelector("button"+J);if(!J&&(J=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!J)){J={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Hc.GetPrivacyCompliantId(this.uk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}));u.ULS.sendTraceTag(537170690,
220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.U6();return}this.Vjg(J,"ShowTeachingUIForAddinTab")}Vjg(J,Na){J.setAttribute("lpp-id","latestAddin");const Eb=Gd.a.instance.$b("Common.ISystemInitiatedFeedback");Eb&&J?(Eb.execute(gc=>{gc.logActivity(Na,null)}),J={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Hc.GetPrivacyCompliantId(this.uk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)})),u.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(u.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),J={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Hc.GetPrivacyCompliantId(this.uk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)})),this.U6())}eTh(J){if(!J)return null;J=J.EW;if((null===J||void 0===J?0:J.ot)&&0<J.ot.count)for(let Na of J.ot)if(Na.groups&&0<Na.groups.length)for(const Eb of Na.groups)if(Eb.controls&&0<Eb.controls.length)for(const gc of Eb.controls){if(gc.attributes&&0===gc.controlType&&gc.enabled)return gc.id;if(gc.menuItems)for(const vc of gc.menuItems)if(vc.attributes&&vc.enabled)return gc.id}return null}MQj(){var J=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");
if(J&&"none"!==window.getComputedStyle(J).display)u.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{J=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==J){J={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Hc.pWa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)}));
u.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.U6();return}u.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Na=Gd.a.instance.$b("Common.ISystemInitiatedFeedback");null==Na||null==J?(J={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Hc.pWa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kb.a.mi(J)})),u.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.U6()):(Na.execute(Eb=>{Eb.logActivity("ShowTeachingUIForContentAddin",null)}),J={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Hc.pWa(this.$C),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi(J)})),u.ULS.sendTraceTag(527286664,
220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}NBa(J){const Na={},Eb={};Eb.LastTeachingUIShowTime=(new Date).toUTCString();Eb.AddinHasShown=J;Na[this.appName]=Bf.c(Eb);this.pqb=new Tg(this.appName,null,null,this.hO),this.pqb.J4a(Na),u.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}U6(){if(!this.Wea){const J=window.g_roamingAddinList;J&&(this.NBa(J),this.Wea=!0)}}}Object(e.a)(Hc,"AddinTeachingCalloutHandler",
null,[]);var kd=a(1285),Yc=a(429),bd=a(12),xd=a(197),Zd=a(44),ee=a(21),Ve=a(60),He=a(160),Be=a(194);class Cf extends He.a{constructor(J,Na,Eb,gc){super();this.gY="calc(100% - 46px)";this.I9="15px";this.hY="0";this.nkb="WACDialogPanel";this.MG=695;this.okb=462;this.t2="80%";this.cjb=350;this.$qa="100%";this.qT=null;this.Xb=5;this.ye="AddinInstallDialog";this.gxg=J;this.sY=Na;this.$Jg=Eb;this.mFg=gc}ox(){super.ox();this.Xh.style.width=this.$qa;this.Xh.style.height=this.gY;this.Xh.style.marginTop=this.I9;
this.Xh.style.padding=this.hY;document.getElementById(this.Sh("WACDialogButtonPanel")).style.display="none";this.Pia.setAttribute("tabindex","0");$addHandler(this.Pia,"keyup",Object(id.a)(this,this.onKeyUp,"onKeyUp"));const J=document.createElement("iframe");J.setAttribute("id","InstallAddinDialog");J.setAttribute("src","about:blank");J.setAttribute("width","100%");J.setAttribute("height","100%");J.setAttribute("marginHeight","0");J.setAttribute("marginWidth","0");J.setAttribute("frameBorder","0");
J.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const Na=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.gxg,this.sY,this.$Jg);J.setAttribute("src",Na);this.qT=J;$addHandler(J,"load",Object(id.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(id.a)(this,this.onMessage,"onMessage"));this.Xh.appendChild(J);this.Xh.appendChild(this.Ihh())}Ihh(){const J=document.createElement("div");
J.setAttribute("tabindex","0");$addHandler(J,"focus",Object(id.a)(this,this.d1i,"onLoopPivotFocus"));return J}onKeyUp(J){13!==J.keyCode&&32!==J.keyCode||this.hide()}d1i(){this.Pia.focus()}onLoad(){this.qT.focus()}onMessage(J){J=J.rawEvent;if(J.source===this.qT.contentWindow&&(J=(J=J.data)?J.split("|"):null)&&0<J.length&&("REFRESH_REQUIRED"===J[0]||"PRELOAD_MANIFEST"===J[0])){ud.a.instance.setItem("refreshRequired","true");const Na={};Na.solutionId=J[1];Na.version=Cf.aRi(J[3]);Na.storeType=J[4];Na.storeId=
J[5];Na.assetId=J[6];Na.targetType=Cf.U9i(J[2]);Na.assetStoreId=J[7];Na.width=parseInt(J[8]);Na.height=parseInt(J[9]);this.mFg(Na)}}ooa(){this.Xh.style.width=this.$qa;this.Xh.style.height=this.gY;this.Xh.style.marginTop=this.I9;this.Xh.style.padding=this.hY;this.MG>Be.a.C0?(this.mb.style.width=String.format("{0}px",Be.a.C0),this.mb.style.overflowX="scroll",k.AFrameworkApplication.isRtl?this.mb.style.right="0":this.mb.style.left="0"):(this.mb.style.width=String.format("{0}px",this.MG),this.mb.style.overflowX=
"hidden");this.mb.offsetHeight>Be.a.B0||this.okb+50>Be.a.B0?(this.mb.style.height=String.format("{0}px",Be.a.B0),this.mb.style.overflowY="scroll",this.mb.style.top="0",k.AFrameworkApplication.isRtl?this.mb.style.right="0":this.mb.style.left="0",this.Xh.style.minHeight=String.format("{0}px",this.cjb)):(this.mb.style.overflowY="hidden",this.mb.style.top="10%",this.mb.style.height=this.t2);this.Haa()}Haa(){if(this.mb){var J=this.mb.style.zIndex;this.mb.style.zIndex="-9999";if(this.MG>Be.a.C0)k.AFrameworkApplication.isRtl?
this.mb.style.marginRight="0":this.mb.style.marginLeft="0";else{const Na=String.format("{0}px",Math.floor(-this.mb.offsetWidth/2));k.AFrameworkApplication.isRtl?this.mb.style.marginRight=Na:this.mb.style.marginLeft=Na;k.AFrameworkApplication.isRtl?this.mb.style.right="50%":this.mb.style.left="50%"}this.mb.style.zIndex=String(J)}else u.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}dE(){super.dE();const J=document.getElementById(this.Sh(this.nkb));J.style.width=String.format("{0}px",
this.MG);J.style.height=this.t2}get sba(){return this.Xh}dispose(){super.dispose();$removeHandler(window,"message",Object(id.a)(this,this.onMessage,"onMessage"))}static U9i(J){switch(J){case "1":return 0;case "2":return 1;default:return 0}}static aRi(J){const Na=J.split(".");for(let Eb=0;Eb<4-Na.length;Eb++)J+=".0";return J}}Object(e.a)(Cf,"AddinInstallDialog",He.a,[]);var df;(function(J){J[J.OK=0]="OK";J[J.notReady=1]="notReady";J[J.storeDisabled=2]="storeDisabled";J[J.invokeFailure=3]="invokeFailure"})(df||
(df={}));Object(e.b)("AddinDetailsQueryError",df);class uf{constructor(J){this.kVc=J}next(J){this.kVc=(9301*this.kVc+49297)%233280;return Math.floor(this.kVc/233280*J)}}Object(e.a)(uf,"Random",null,[]);class Hf extends ng.a{constructor(){super();this.DismissHostingSurfaceOnExecute=!0}}Object(e.a)(Hf,"CuiButtonPropsExtended",ng.a,[]);var ef=a(999),mf=a(593);class Ff{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(e.a)(Ff,"GallerySectionProps",null,[]);var lg=
a(1355),vg=a(577);class Xc{constructor(){this.text=this.href=null}}Object(e.a)(Xc,"LinkProps",null,[]);var Hd=a(998),Kg=a(182);class li{constructor(J,Na,Eb,gc,vc,Qc=null){this.qFa={};this.fEg={};this.NXa={};this.OXa=0;this.Dje=!1;this.Pib=0;this.Rbe=!1;this.AMc=0;this.ATb=Na;this.FJ=null;this.VDg=Eb;this.XDg=gc;this.zHg=vc;this.$a=Qc||k.AFrameworkApplication.fa;J=this.Fyi?Object(id.a)(this,this.gEd,"onAddinDetailsRefreshed"):Object(id.a)(this,this.TXf,"registerIcons");this.ATb.Uvc(J);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",
!1));appChrome.addInApi.loadOfficeAddInIcons()}get MIe(){return this.NXa}TXf(J,Na){if(Na.fU)for(J=0;J<Na.fU.length;J++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+Na.fU[J].solutionId,Na.fU[J].iconUrl);else u.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get Fyi(){return!!this.$a&&this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.FlyoutGeneratorRefactorEnabled")}get Gkc(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",
!1)}CLj(J){0===J.Ata&&(this.Pib|=1);1===J.Ata&&(this.Pib|=2);return!!this.Pib}gEd(J,Na){this.TXf(J,Na);this.CLj(Na)&&(appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1)),this.$a.isChangeGateEnabled("OfficeVSO:7611216_UnderstandDataProvider")&&u.ULS.sendTraceTag(509224609,220,50,"UnderstandDataProvider, Flyout button enabled, collectionType: {0}",lc.a[Na.Ata]),this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutOverflowTelemetryEnabled",
!1)&&this.SIi())}caj(J){const Na=[];var Eb=new uf((new Date).getDate());for(var gc=0;8>gc;gc++)Array.add(Na,Eb.next(J.count));Eb=0;for(let vc of J){gc=!1;for(const Qc of Na)if(Eb===Qc){gc=!0;break}Eb++;if(gc){let Qc;(Qc=vc.addinInfo).AUP=20*Qc.AUP}else if(1===vc.addinInfo.priority){let Qc;(Qc=vc.addinInfo).AUP=4*Qc.AUP}else if(2===vc.addinInfo.priority){let Qc;(Qc=vc.addinInfo).AUP=2*Qc.AUP}}J.Sc((vc,Qc)=>vc.addinInfo.AUP<Qc.addinInfo.AUP?1:-1);return J}daj(J){for(let Na of J)if(1===Na.addinInfo.priority){let Eb;
(Eb=Na.addinInfo).AUP=4*Eb.AUP}else if(2===Na.addinInfo.priority){let Eb;(Eb=Na.addinInfo).AUP=2*Eb.AUP}J.Sc((Na,Eb)=>Na.addinInfo.AUP<Eb.addinInfo.AUP?1:-1);return J}iba(J,Na){const Eb={};Eb.width=J;Eb.height=Na;Eb.backgroundColor="transparent";return Eb}g8c(){return{flexDirection:"column"}}B8c(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word",
"text-overflow":"ellipsis"}}X_h(){const J={},Na={},Eb={};Na.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};Na.inner={margin:"-4px"};Eb.root=this.iba(100,100);Eb.flexContainer=this.g8c();Eb.label=this.Gkc?{"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"}:this.B8c();J.galleryButtonInExpanded=Eb;J.galleryStack=Na;return J}WRh(){return Object.assign(new lg.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",
Icon:"QuickSearchNoCategories_16",Command:this.zHg,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}QQh(J,Na,Eb){J=Object.assign(new lg.a,{Id:Eb,ExternalId:Eb,Icon:"AddinFlyoutControl"+Na.solutionId,Command:J===CommonUIStrings.l_PopularAddins?
this.VDg:this.XDg,LabelText:Na.displayName,FullIconStyle:{root:{width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid #E0E0E0"}},Alt:Na.displayName});this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)&&(J.Alt=Na.description);return J}ibj(J,Na,Eb){const gc=Object.assign(new Ff,{SectionId:J,Title:J,GalleryButtons:[]});for(let vc=0;vc<Eb;vc++)Array.add(gc.GalleryButtons,this.QQh(J,Na[vc],this.qFa[Na[vc].solutionId]));
return gc}m6h(){var J=[];const Na=this.ATb.nhd(0);Array.addRange(J,Na.fU);const Eb=this.ATb.nhd(1);Array.addRange(J,Eb.fU);let gc=J.length;this.AMc=0<gc?5:6;k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&u.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",gc,df[Na.errorCode],Na.fU.length,df[Eb.errorCode],Eb.fU.length);J.sort((Je,Te)=>{Je=Kg.d(Je.displayName);Te=Kg.d(Te.displayName);
return Zf.a.localeCompare(Je,Te)});const vc=6<gc;vc&&(gc=5);if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))for(var Qc=0;Qc<gc;Qc++)this.PAe(J[Qc]);else for(Qc=0;Qc<gc;Qc++)if(!(J[Qc].solutionId in this.qFa)){var hd="AddinGalleryButton"+this.OXa.toString();this.qFa[J[Qc].solutionId]=hd;this.NXa[hd]=J[Qc].solutionId;this.OXa++}let nd=[];Qc=null;if(this.FJ)nd=this.FJ;else if(Qc=this.ATb.nhd(2),0===Qc.errorCode)if(this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled"))Qc.fU.forEach(Je=>
{-1!==Je.addinInfo.priority&&(this.PAe(Je),nd.push(Je))});else for(nd=Qc.fU,Qc=0;Qc<nd.length;Qc++)nd[Qc].solutionId in this.qFa||(hd="AddinGalleryButton"+this.OXa.toString(),this.qFa[nd[Qc].solutionId]=hd,this.NXa[hd]=nd[Qc].solutionId,this.NXa[hd+"Add"]=nd[Qc].solutionId,this.OXa++);Qc=!0;nd.length||(Qc=!1);hd=0;if(Qc&&(hd=J.length?3>=J.length?9:6:12,nd=this.Gkc?this.MWg(nd,J):this.LWg(nd,J),hd>nd.length&&(hd=nd.length),k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",
!0)&&!this.Dje&&!this.Gkc)){var Cd="",Sd="";for(let Je=0;Je<nd.length&&Je<hd;Je++)Cd+=nd[Je].displayName,Cd+=",",Sd+=nd[Je].solutionId,Sd+=",";u.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",hd,Cd,Sd);this.Dje=!0}Cd=Object.assign(new Wb.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Sd=Object.assign(new ng.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});
Array.add(Cd.ControlList,Sd);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));Cd=Object.assign(new xg.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Cd,UpdateDynamically:!0});2!==Na.errorCode||J.length?3===Na.errorCode||3===Eb.errorCode?(u.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),J=this.h2e("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Cd.MenuSectionList,J)):(0<
gc?this.CJe(Cd,J,gc,"MRUAddins",CommonUIStrings.l_MyAddinSection,vc):this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(J=this.rQh(),Array.add(Cd.MenuSectionList,J),u.ULS.sendTraceTag(509216389,220,50,"Show flyout banner")),Qc&&(this.Gkc?(Array.add(Cd.MenuSectionList,this.LRh(nd,this.AMc)),J=[],this.p7j(J),appChrome.api.dispatch(J)):this.CJe(Cd,nd,hd,"PopularAddins",CommonUIStrings.l_PopularAddins))):(u.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),
J=this.h2e("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Cd.MenuSectionList,J));return Cd}p7j(J){6>this.AMc?J.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!0)):J.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!1))}LRh(J,Na){const Eb=Object.assign(new Wb.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let gc=0;gc<0+Na&&gc<J.length;gc++)this.fEg.PopularAddInsListItem0=
J[gc].solutionId,this.mQh(Eb.ControlList,gc.toString(),J[gc]);J=Object.assign(new Hf,{Id:"SwitchPopularAddIns",ExternalId:"SwitchPopularAddIns",ExternalImageId:"Refresh",Command:"152023954",LabelText:CommonUIStrings.l_AddinSwitchText,ShouldTakeFocus:!1,DismissHostingSurfaceOnExecute:!1});Array.add(Eb.ControlList,J);return Eb}mQh(J,Na,Eb){Na=this.Fih(Na,Eb);Array.add(J,Na)}Fih(J,Na){const Eb=[];var gc=Object.assign(new Xc,{text:CommonUIStrings.l_AddinListPrivacy,href:Na.privacyUrl});Array.add(Eb,gc);
gc=Object.assign(new Xc,{text:CommonUIStrings.l_AddinListLicense,href:Na.licenseUrl});Array.add(Eb,gc);gc=Object.assign(new Xc,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+Na.solutionId});Array.add(Eb,gc);gc={};gc["default"]="AddinFlyoutControl"+Na.solutionId;return Object.assign(new Hd.a,{Id:"PopularAddInsListItem"+J,ExternalId:"PopularAddInsListItem"+J,CommandId:"PopularAddInsListItem"+J,iconSet:gc,Label:Na.displayName,ActionText:CommonUIStrings.l_AddinListAdd,
Description:Na.description,Links:Eb,ActionId:"PopularAddInsListItemAdd"+J,ActionCommandValueId:Na.solutionId,CommandValueId:Na.solutionId})}PAe(J){if(!(J.solutionId in this.qFa)){const Na="AddinGalleryButton"+this.OXa.toString();this.qFa[J.solutionId]=Na;this.NXa[Na]=J.solutionId;this.NXa[Na+"Add"]=J.solutionId;this.OXa++}}rQh(){const J=Object.assign(new Wb.a,{Id:"BannerSection",ControlsId:"BannerSection.Controls",ControlList:[]}),Na=Object.assign(new vg.a,{Id:"AddInFlyoutBanner",ExternalId:"AddInFlyoutBanner",
LabelText:this.$a.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableConfigBannerUIString",CommonUIStrings.l_AddinBannerText),IconName:"FlyoutBannerCommon",IsBanner:!0});Array.add(J.ControlList,Na);return J}h2e(J,Na){const Eb=Object.assign(new Wb.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});J=Object.assign(new ef.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:J,Label:Na});Array.add(Eb.ControlList,J);return Eb}LWg(J,Na){var Eb=new h.a;for(let gc=0;gc<J.length;gc++)Eb.add(J[gc]);
this.FJ||(8<Eb.count&&(Eb=this.caj(Eb)),this.FJ=Eb.toArray());for(J=0;J<this.FJ.length;J++)for(Eb=0;Eb<Na.length;Eb++)if(this.FJ[J].solutionId.toLowerCase()===Na[Eb].solutionId.toLowerCase()){Array.remove(this.FJ,this.FJ[J--]);break}return this.FJ}MWg(J,Na){var Eb=new h.a;for(let gc=0;gc<J.length;gc++)Eb.add(J[gc]);this.FJ||(8<Eb.count&&(Eb=this.daj(Eb)),this.FJ=Eb.toArray());for(J=0;J<this.FJ.length;J++)for(Eb=0;Eb<Na.length;Eb++)if(this.FJ[J].solutionId.toLowerCase()===Na[Eb].solutionId.toLowerCase()){Array.remove(this.FJ,
this.FJ[J--]);break}return this.FJ}CJe(J,Na,Eb,gc,vc,Qc=!1){const hd=Object.assign(new Wb.a,{Id:gc+"Section",ControlsId:gc+"Section.Controls",ControlList:[]});gc=Object.assign(new mf.a,{Id:gc+"GalleryControl",ExternalId:gc+"GalleryControl",GalleryStyle:this.X_h(),Width:3,Type:4,GallerySections:[]});Array.add(J.MenuSectionList,hd);Array.add(hd.ControlList,gc);J=this.ibj(vc,Na,Eb);Qc&&Array.add(J.GalleryButtons,this.WRh());gc.GallerySections.push(J)}nbj(J){if(J)try{J.MenuItems=this.m6h()}catch(Na){u.ULS.sendTraceTag(509687425,
220,10,"GetReactGalleryMenu hit exception "+(Na?Na.toString():""))}else u.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}SIi(){if(!this.Rbe&&this.Azc){var J=appChrome.selectors.getSelectedTabId();J&&Kg.a(J,"Home")&&((J=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(J,"").display||u.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.Rbe=!0)}}get Azc(){return!!window.appChrome&&!!appChrome.selectors}}Object(e.a)(li,
"AppsFlyoutGenerator",null,[2]);var Vh=a(70),Wh=a(109),Xh=a(157),Gh=a(41);class Ni{constructor(J,Na,Eb,gc,vc,Qc,hd=null){this.disposed=!1;this.e2b=null;this.iqb=0;this.cei=nd=>{if(nd)if(nd=this.H0c.MIe[nd]){var Cd=this.Gd.Jg;Cd=Cd?Cd.getAppUILocale()||"en-US":"en-US";this.e2b=new Cf(nd,"wac_excel",Cd,Sd=>{this.Gd.osc("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Sd);const Je=new L.a(-741808261,0,this.$.Bc,0,null);this.$.Ia.Nb(Je,{[qe.a.Z$]:Sd,[ic.a.$f]:this.Gd.NJa(Sd)});this.e2b&&this.e2b.hide();
y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(Sd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Sd.solutionId,Sd.storeType,Sd.assetId,null,null,Sd.storeId),Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:Kb.a.mi({SolutionId:Sd})})))});this.e2b.initializeAndShow("",null,null)}else u.ULS.sendTraceTag(509362328,220,10,"Solution id is null.");else u.ULS.sendTraceTag(509362329,
220,10,"Control id is null.")};this.eei=nd=>{if(nd)if(nd=this.H0c.MIe[nd])if(nd=this.c1h(nd)){var Cd={[qe.a.Z$]:nd,[ic.a.$f]:this.Gd.NJa(nd)},Sd=new L.a(-741808261,0,this.$.Bc,0,"");this.$.Ia.Nb(Sd,Cd);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(nd=Telemetry.PrivacyRules.GetPrivacyCompliantId(nd.solutionId,nd.storeType,nd.assetId,null,null,nd.storeId),Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",
dataFields:Kb.a.mi({SolutionId:nd})})))}else u.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.");else u.ULS.sendTraceTag(509362326,220,10,"SolutionId is null.");else u.ULS.sendTraceTag(509362327,220,10,"Control id is null.")};this.bUi=(nd,Cd)=>{if(Cd)if(Cd)if(nd=Cd.uk){if(Ng()||fh()){const Je=this.$.ea.workbookContext.WebExtensions;if(Je){let Te=!1;for(var Sd of Je)if(Sd.PrimaryMarketplace.SolutionId.toLowerCase()===nd.solutionId.toLowerCase()){Te=!0;break}if(!Te){u.ULS.sendTraceTag(512258444,
220,15,"Not find add-in persisted in the template file.");return}}else{u.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}Cd=Cd.Vo;Sd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(nd.solutionId in Sd)Cd=Sd[nd.solutionId];else if(Cd=this.$Wh(Cd),void 0===Cd||null===Cd){u.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Sd=new L.a(Nf.a.r3,0,0,2,null);this.executeCommand(0,Sd,{["SourceControlId"]:Cd},
null);nd.isAutoLaunched=!0}else u.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else u.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else u.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.pif=(nd,Cd)=>{"Insert"==Cd.tabName&&(nd=this.$.Ia,null!=nd&&(nd.M_f(this.pif),u.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.GQb.MQj())};this.J0i=(nd,Cd)=>{nd=null;Cd&&(nd=Cd);(null===nd||void 0===nd?0:nd.Vo)&&this.jHj(nd.Vo);
this.$.zf();nd&&nd.uk&&this.hZg(nd.uk)};this.e5j=(nd,Cd)=>{Cd.Ata===lc.a.myAddins&&(this.iqb|=1);Cd.Ata===lc.a.adminManaged&&(this.iqb|=2);this.Nag()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.$=J;u.ULS.shipAssertTag(537170659,0,!(void 0===Na||null===Na),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Zd.a.uZ()}`);this.Gd=Na;this.EIe=Eb;this.c2b=gc;this.aaa=vc;this.mqb=Qc;this.fp=new ta.a;this.aia=
new dc;this.led=hd;Dc.a.BAb=Dc.a.qYe;this.t$c=new h.a;this.G3a=new h.a;this.J_c&&(this.bia=this.Gd.bia,null!==this.bia?(this.H0c=new li(k.AFrameworkApplication.xb,this.bia,Nf.a.tnc.toString(),Nf.a.ync.toString(),"1296389134",k.AFrameworkApplication.fa),this.bia.Uvc(this.e5j)):u.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get J_c(){return k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}dispose(){void 0!==this.mqb&&null!==this.mqb&&(this.mqb.dispose(),this.mqb=null);this.Gd=this.$=null;this.disposed=!0}yLj(J,Na){switch(J){case Nf.a.r3:J=this.hLj(Na);break;default:J=!1}return J}Oc(J,Na){return 619219938===Na?!this.Nag():!1}executeCommand(J,Na,Eb){J=Mb.TaskExtensions.lk();Na=Na.command;switch(Na){case 843847158:break;case Nf.a.tnc:this.cei(Eb.SourceControlId);break;case Nf.a.ync:this.eei(Eb.SourceControlId);break;case -2025863019:ad.a.DWd(Eb[qe.a.I_c].toString(),()=>{ee.h(this.$).focus()});
break;case -1777565636:kd.a.showUILessDialog(Eb[qe.a.oqb].toString());this.Gd.FOj(Eb[qe.a.oqb].toString());break;case 1592314317:kd.a.hideUILessDialog(Eb[qe.a.oqb].toString());this.Gd.Mhi(Eb[qe.a.oqb].toString());break;case Nf.a.r3:J=this.Pmd(Eb);break;case Nf.a.TEb:this.UEb(Eb);break;case Nf.a.dS:this.pfj(Eb);break;case Nf.a.Hoa:this.Hoa(Eb);break;case Nf.a.LBc:this.mqb.dCc();break;case Nf.a.refreshAddinCommands:this.wkj();break;case 1949669462:this.aaa.t8f(!0);break;case -1014260128:J=this.executeDynamicAddInCommandsAPI(Eb);
break;case Nf.a.whb:this.whb();break;default:J=xd.a(Na)}return J}Ac(J,Na,Eb){J=!1;switch(Na.command){case Nf.a.tnc:case Nf.a.ync:J=!!Eb;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case Nf.a.dS:case Nf.a.Hoa:case Nf.a.LBc:case Nf.a.refreshAddinCommands:case 1949669462:case Nf.a.TEb:case -1014260128:case Nf.a.whb:J=!0;break;case Nf.a.r3:J=!k.AFrameworkApplication.protectedFile}return J}Nag(){return 0!==this.iqb&&this.$.WP&&!y.EwaSettings.ya(174)}Vc(J,Na,Eb){switch(Na){case "PopulateAddInGallery":return y.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&
Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.PopulateAddinGallery",dataFields:Kb.a.mi({})})),this.H0c.nbj(Eb),!0;default:return!1}}$Wh(J){if(!J)return u.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((J=J.EW)&&J.ot&&0<J.ot.count)for(let Na of J.ot){if(Na.groups&&1===Na.groups.length){J=Na.groups[0];if(J.controls&&1===J.controls.length){const Eb=J.controls[0];if(Eb.attributes&&!Eb.controlType&&Eb.enabled)return Eb.id}J.controls&&u.ULS.sendTraceTag(528098403,
220,15,"It has multiple buttons")}Na.groups&&u.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}pfj(J){J&&qe.a.SP in J?this.dS(J[qe.a.SP],!0):u.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}dS(J,Na=!1){this.Gd?(u.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",J,Na),this.Gd.dS(J,Na)):u.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..")}wkj(){if(this.aaa.Rnc()){this.aaa.WEe();
var J=this.xhd();if(J&&0<J.count)for(let Na of J)J={[qe.a.SP]:Na,[qe.a.rM]:4,[qe.a.OHa]:(new Date).getTime()},this.Hoa(J)}else k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(u.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.aaa.Rnc()),this.dS(10,!0),this.dS(0,!0))}Hoa(J){u.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${J[qe.a.rM]}, DataProvider ${J[qe.a.SP]}.`);
this.aaa.lDj();window.setTimeout(()=>{if(void 0===this.Gd||null===this.Gd)u.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Zd.a.uZ()}`);else{const Na=new sf(new ja(this.Gd.Jg),vb.instance,Od.instance);Na.HPg((Eb,gc)=>{k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.dS(J[qe.a.SP]);this.UEb(gc.properties)});k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Na.$Sg((Eb,gc)=>{null==gc?Ja.a.sendTelemetryEvent(Object(Db.a)(new Rf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kb.a.mi({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):(this.GQb=new Hc(this),this.GQb.Fmj(gc),Eb=this.$.Ia,null!=Eb&&(Eb.wue(this.pif),u.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Na.M2j(J)}},0)}whb(){if(this.tri)if(void 0===this.Gd||
null===this.Gd)u.ULS.sendTraceTag(509686154,220,10,"DdaFacadeService should not be null");else{const J=new ge(this.Gd.Jg);J.ARg(()=>{this.Mxd()});J.b1d()}}get tri(){return!y.EwaSettings.ya(174)&&this.$.ea.Lg.get(27)&&this.$.WP}Mxd(){const J=document.getElementById("InsertAddInFlyout");if(null===J||void 0===J||"none"===window.getComputedStyle(J).display){const Na=document.getElementById("RibbonOverflowMenu-overflow");null!=Na?(Na.onclick=function(){const Eb=new Oc.a(0,1,500,()=>{const gc=document.getElementsByName("Add-ins")[0];
null!=gc&&(gc.click(),u.ULS.sendTraceTag(509445257,341,50,"Launch flyout in overflow"))});k.AFrameworkApplication.ji.Kf(Eb);Na.onclick=function(){}},Na.click()):u.ULS.sendTraceTag(509677591,220,10,"Cannot find flyout button on ribbon or overflow button")}else J.click(),u.ULS.sendTraceTag(509677590,220,50,"Launch flyout")}UEb(J){if(!this.disposed){u.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${J[qe.a.rM]}.`);try{if(y.EwaSettings.ya(174)){const Eb=J[qe.a.jqb];if(Eb&&0<Eb.count){const gc=
Eb.count;for(let vc=gc-1;0<=vc;vc--){const Qc=Eb.ma(vc);OSF.OsfControl.isFirstPartyStoreString(Qc.storeType)||Eb.remove(Eb.ma(vc))}if(Eb.count<gc){const vc=Object(Vh.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(Wh.d)(Xh.a.resolve(Gh.f,{rb:0})):Gc.GetServiceTaskFactory.Sa(this.$.da,5,4,0);Mb.TaskExtensions.za(vc,()=>{vc.result.eh(36,null)},this.$.ka,3)}if(!Eb.count)return}}if(void 0===this.Gd||null===this.Gd)u.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Zd.a.uZ()}`);
else{var Na=null;Na=k.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled")?new If(this.fp,this.EIe,new ja(this.Gd.Jg),new ye(this.$.Ib,Nf.a.r3),this.aaa,vb.instance,this.aia,(Eb,gc)=>{const vc={};vc.InstanceId=oa.a.create().toString();vc.PrimaryMarketplace={};vc.PrimaryMarketplace.SolutionId=Eb.solutionId;vc.PrimaryMarketplace.SolutionVersion=Eb.version;vc.PrimaryMarketplace.MarketplaceType=Eb.storeType;vc.PrimaryMarketplace.MarketplaceRef=Eb.storeId;vc.WebExtensionType=1;this.Gd.SQj(vc,()=>
{gc(Eb)})}):new If(this.fp,this.EIe,new ja(this.Gd.Jg),new ye(this.$.Ib,Nf.a.r3),this.aaa,vb.instance,this.aia);Na.PPg(this.bUi);Na.IPg(this.J0i);if(k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){const Eb=new Hc(this);Na.zRg(Eb.I0i);Na.ZSg(Eb.tOj)}this.$.da.Aa(53).Fp&&na.a.get_instance().ek(5,null).continueWith(()=>{this.disposed||Na.LEi(this.led,this.$.domElement,J)})}}catch(Eb){u.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Eb.message}.`)}}}Pmd(J){const Na=
Mb.TaskExtensions.lk();J=J[this.fp.gja];const Eb=this.c2b.hYc(J),gc=new kd.a(this.$,this.Gd,Eb.ownerAddinInfo,Na);return this.$bf(Na,J,Eb,gc)}$bf(J,Na,Eb,gc){this.c2b.Pmd(Na,this.aaa,gc,new ja(this.Gd.Jg),Eb,()=>{J=gc.Lch()},()=>{ee.h(this.$).focus()});return J}hZg(J){const Na=Mb.TaskExtensions.lk();var Eb=this.Gd.Sba(J.solutionId);if(Eb){var gc=this.Gd.oV(Eb);if(bd.HelperMethods.Tw(gc)&&0!==gc.SharedRuntime.State)return}gc=this.c2b.iZg;const vc=J.solutionId in gc?gc[J.solutionId]:null;if(vc){const Qc=
this.c2b.hYc(vc),hd=new kd.a(this.$,this.Gd,Qc.ownerAddinInfo,Na),nd=Telemetry.PrivacyRules.GetPrivacyCompliantId(J.solutionId,null!==Qc.ownerAddinInfo?Qc.ownerAddinInfo.storeType:J.storeType,J.assetId,null,null,J.storeId);gc=Cd=>{if(Cd){const Sd={};for(const Je of Cd)Sd[Je[0]]=Je[1];(Cd=qe.a.Due in Sd?Sd[qe.a.Due]:null)&&"true"===Cd.toLowerCase()&&(u.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${J.storeType}, StoreId ${J.storeId}, SolutionId ${nd}.`),this.$bf(Na,
vc,Qc,hd))}};u.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${J.storeType}, StoreId ${J.storeId}, SolutionId ${nd}.`);if(Eb)gc(this.Gd.oV(Eb).OsfPropertyBag);else if(Eb=this.$.ea.workbookContext.WebExtensions)for(const Cd of Eb)if((1===Cd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===J.targetType&&Cd.PrimaryMarketplace.MarketplaceType.toLowerCase()===J.storeType.toLowerCase()&&Cd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===
J.storeId.toLowerCase()&&Cd.PrimaryMarketplace.SolutionId.toLowerCase()===J.solutionId.toLowerCase()){gc(Cd.OsfPropertyBag);break}}}WZd(J,Na,Eb=!1){J&&(!Eb||Na||this.t$c.contains(J)||this.t$c.add(J),(Eb=this.G3a.contains(J))&&Na&&this.G3a.remove(J),Eb||Na||this.G3a.add(J))}jHj(J){if((J=J.EW)&&J.ot)for(let Na of J.ot)if(Na.groups)for(const Eb of Na.groups)if(Eb.controls)for(const gc of Eb.controls)if(this.WZd(gc.id,gc.enabled,!0),1===gc.controlType&&gc.menuItems)for(const vc of gc.menuItems)this.WZd(vc.id,
vc.enabled,!0)}xhd(){const J=new h.a;y.EwaSettings.ya(52)&&(this.$.ea.Lg.get(27)&&(J.add(0),J.add(16)),this.$.ea.Lg.get(33)&&J.add(1),J.add(8));return J}executeDynamicAddInCommandsAPI(J){let Na=!0;if(void 0===J||null===J||void 0===J[qe.a.Kvb]||null===J[qe.a.Kvb])return Ve.Task.Ua(!1);switch(J[qe.a.Kvb]){case 1:Na=this.Z5j(J);break;case 2:Na=this.nHj(J);break;case 4:this.G3a.clear();this.G3a.addRange(this.t$c);break;case 3:Na=this.installContextualTab(J);break;default:Na=!1}return Ve.Task.Ua(Na)}hLj(J){return J&&
this.fp.gja in J?(J=J[this.fp.gja])?this.G3a.contains(J):!1:!1}Z5j(J){var Na=null;let Eb=null,gc=null,vc=!0;void 0!==J[qe.a.I4]&&null!==J[qe.a.I4]&&void 0!==J[this.fp.gja]&&null!==J[this.fp.gja]&&void 0!==J[qe.a.H4]&&null!==J[qe.a.H4]&&(Na=J[qe.a.I4],Eb=J[qe.a.P$b],gc=J[this.fp.gja],vc=J[qe.a.H4]);if(!Na||!gc)return u.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;J=(new wh.a(this.$.Ib,Na,this.fp,!0)).ZLa(gc);Na={DynamicAddinCommandsApiName:"UpdateControlEnableState"};
Na.AssetId=Eb;Na.MaskedTabId=J;Na.IsToEnable=vc;u.ULS.sendTraceTag(537170648,220,50,v.a.Fc(Na));this.WZd(J,vc);Yc.a.LJ.updateCommandUI();return!0}nHj(J){var Na,Eb,gc=null,vc=null;let Qc=null;var hd=null;let nd=!0;void 0!==J[qe.a.Yad]&&null!==J[qe.a.Yad]&&void 0!==J[qe.a.I4]&&null!==J[qe.a.I4]&&void 0!==J[this.fp.gja]&&null!==J[this.fp.gja]&&void 0!==J[qe.a.H4]&&null!==J[qe.a.H4]&&(gc=J[qe.a.Yad],vc=J[qe.a.I4],Qc=J[qe.a.P$b],hd=J[this.fp.gja],nd=J[qe.a.H4]);if(!gc||!vc||!hd)return u.ULS.sendTraceTag(537170647,
220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;J=(new wh.a(this.$.Ib,vc,this.fp,!0)).eaf(hd);hd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};hd.StoreType=gc;hd.AssetId=Qc;hd.MaskedTabId=J;hd.IsToShow=nd;u.ULS.sendTraceTag(537170646,220,15,v.a.Fc(hd));gc=this.aaa.ika(gc,vc,1);vc=!1;if(null===(Eb=null===(Na=null===gc||void 0===gc?void 0:gc.Vo)||void 0===Na?void 0:Na.EW)||void 0===Eb?0:Eb.ot)for(let Cd of gc.Vo.EW.ot)if(Cd.id===J){vc=!0;break}if(!vc)return u.ULS.sendTraceTag(537170645,
220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Na=[];nd?appChrome.selectors.getSelectedTabId()!==J&&Na.push(appChrome.actions.activateRibbonTab(J)):(appChrome.selectors.getSelectedTabId()===J&&Na.push(appChrome.actions.setCurrentTab(De.a.$W)),Na.push(appChrome.actions.deactivateRibbonTab(J)));appChrome.api.dispatch(Na);return!0}c1h(J){if(this.bia){if(J=this.bia.$Sh(J)){const Na={};Na.solutionId=J.solutionId;Na.version=J.version;Na.storeType=J.storeType;Na.storeId=J.storeId;Na.assetId=
J.assetId;Na.assetStoreId=J.assetStoreId;Na.targetType=J.targetType;Na.displayName=J.displayName;Na.width=J.width;Na.height=J.height;return Na}u.ULS.sendTraceTag(509362324,0,10,"Get addinDetail fail.");return null}u.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(J){let Na=null,Eb=null,gc=null;var vc=null;if(void 0!==J[qe.a.I4]&&null!==J[qe.a.I4]&&void 0!==J[qe.a.H4]&&null!==J[qe.a.H4]){const Qc=J[qe.a.H4];Na=J[qe.a.I4];void 0!==Qc[qe.a.DKa]&&null!==
Qc[qe.a.DKa]&&void 0!==Qc[qe.a.EKa]&&null!==Qc[qe.a.EKa]&&(Eb=Qc[qe.a.DKa],gc=Qc[qe.a.EKa],vc=Qc[qe.a.Zad])}if(!(Na&&gc&&Eb&&vc))return u.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;J=this.aaa.ika(vc.PrimaryMarketplace.MarketplaceType,vc.PrimaryMarketplace.SolutionId,1);if(null===J||void 0===J?0:J.Vo)return u.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;J={};J.solutionId=vc.PrimaryMarketplace.SolutionId;J.version=
vc.PrimaryMarketplace.SolutionVersion;J.storeType=vc.PrimaryMarketplace.MarketplaceType;J.storeId=vc.PrimaryMarketplace.MarketplaceRef;vc.AssetMarketplace?(J.assetId=vc.AssetMarketplace.SolutionId,J.assetStoreId=vc.AssetMarketplace.MarketplaceRef):(J.assetId=null,J.assetStoreId=null);J.targetType=vc.WebExtensionOsfControlType;J.width=vc.TaskpaneWidth;J.height=0;J.isAddinCommands=!0;vc=new h.a;vc.add(J);J={};J[qe.a.jqb]=vc;J[qe.a.rM]=6;J[qe.a.DKa]=Eb;J[qe.a.EKa]=gc;this.UEb(J);return!0}}Object(e.a)(Ni,
"AddinUICommandHandler",null,[234,233,2]);var Oi=a(64),Nh=a(615),Pi=a(20),ej=a(18);class zi extends ve.a{constructor(J){super(J);this.handler=null;this.vLg=()=>{u.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.Nd&16384)}]`);const Na=new Yd.a;this.$.da.kb(53,Sd=>{u.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Na.setResult(Sd)});const Eb=
Na.task,gc=new Bc,vc=Tc.a.getInstance(),Qc=new lh(this.$,vc),hd=Gc.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Na),nd=this.elj(gc),Cd=Object(Vh.b)("OfficeVSO:7624847_MigrateOAuthToNewServiceInfra")?Object(Wh.d)(Xh.a.resolve(Gh.O,{rb:this.Na})):Gc.GetServiceTaskFactory.Sa(this.$.da,349,350,this.Na);return Mb.TaskExtensions.za(Mb.TaskExtensions.Pd([Eb,hd,nd,Cd],this.ka),()=>{u.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
Mb.TaskExtensions.za(Gc.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.Na),Sd=>{this.handler=new Ni(this.$,Sd.result,gc,new sd,vc,Qc,Gd.a.instance.yg("Common.IExternalUICommandDefinitionMapping"));u.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.qd([this.handler]);this.$.da.Ha(198,this.handler)},this.ka,3)},this.ka,3)};this.Qnh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ia.Jdb(this.handler),this.$.da.TU(198),this.handler=
null):u.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.TU(204);ej.a(Pi.a,20,this.$.da,198)}}Fd(){u.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Oi.a(this.$).add(Object(Db.a)(new Nh.a,{jBc:()=>{const J=this.$.ea.hI&&this.$.ea.jc&&!!(this.$.Nd&16384)&&this.$.isEditMode;this.$.ea.jc&&u.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${J}] IsSessionFullyLoaded [${this.$.ea.hI}] IsSessionActive [${this.$.ea.jc}] ShowCommandUI [${!!(this.$.Nd&
16384)}] IsEditMode [${this.$.isEditMode}]`);return J},s0b:this.vLg,a9b:this.Qnh,P4a:2}))}elj(J){const Na=Gc.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Na);return Mb.TaskExtensions.za(Na,()=>{u.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ha(204,new yf(Na.result,J))},this.ka,3)}static la(J){ve.a.Yd(199,new zi(J))}}Object(e.a)(zi,"AddinUICommandHandlerFactory",ve.a,[]);var ci=a(1239),
Ai=a(1243),Oh=a(721);class Dg extends d.a{constructor(J){super();this.$=J;this.Mb()}create(){let J;if(y.EwaSettings.ya(355)){const Na=Gc.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,this.Na);let Eb;Eb=y.EwaSettings.isChangeGateEnabled("OfficeVSO:7476522_IDBNewService2")?Object(Wh.d)(Xh.a.resolve(Gh.G)):Gc.GetServiceTaskFactory.create(this.$.da,396,this.$.ka,this.Na);Mb.TaskExtensions.za(Ve.Task.FG(Na,Eb),()=>{this.vb(Object(Oh.a)(this.$.da,278,()=>new ci.CustomFunctionsInstaller(this.$,Na.result,
Eb.result)))},this.$.ka,3)}else J=Object(Oh.a)(this.$.da,278,()=>new Ai.CustomFunctionsLegacyInstaller(this.$)),this.vb(J)}static la(J){J.da.Ha(279,new Dg(J))}}Object(e.a)(Dg,"CustomFunctionsInstallerFactory",d.a,[]);var Hh=a(92),Qi=a(51),Ih=a(47);class Ri{constructor(J,Na){this.RRa=this.SRa=null;this.Yjg=(Eb,gc)=>{let vc=null,Qc=null,hd=null;gc?(Object(O.a)(320,gc)?(vc=gc.WHa,hd=gc.instanceId):Object(O.a)(470,gc)&&(vc=gc.get_element(),hd=gc.instanceId),vc)?(Qc=Object(U.a)(683,Eb),Qc)?this.qWf(hd,
vc,Qc)||hd in this.RRa||(this.SRa[hd]=0,this.RRa[hd]=Qi.a.instance.cD(()=>{10<=this.SRa[hd]||this.qWf(hd,vc,Qc)?(delete this.SRa[hd],this.RRa[hd].dispose(),delete this.RRa[hd]):this.SRa[hd]+=1},500,Ih.a.pUg,!0,!1)):u.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):u.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):u.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=
J;this.$=Na;this.t1c=!1;this.$.da.Ha(224,this)}la(J){this.t1c?u.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.t1c=!0,this.RRa={},this.SRa={},J?J.sQg(this.Yjg):u.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(J){if(J){J.spj(this.Yjg);J=this.RRa;for(let Na in J)Hh.a.Ja(J[Na]);this.SRa=this.RRa=null;this.t1c=!1}else u.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}qWf(J,
Na,Eb){if(this.Wqi(Eb,J))return!1;J=Na.querySelector("iframe");if(!J)return u.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;J=J.title;if(!J||!J.length)return u.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(J);return!0}Wqi(J,Na){return(J=J.Jg.getOsfControl(Na))?J.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(e.a)(Ri,"AgaveOnSelectedReadoutHandler",
null,[684]);class di extends d.a{constructor(J){super();this.$=J;this.Mb()}create(){const J=this.$.da;Mb.TaskExtensions.za(Gc.GetServiceTaskFactory.Sa(J,211,212,this.Na),Na=>{Na=J.Aa(224)||new Ri(Na.result,this.$);this.vb(Na)},this.ka,3)}static la(J){J.da.Ha(225,new di(J))}}Object(e.a)(di,"AgaveOnSelectedReadoutHandlerFactory",d.a,[]);var Pg=a(760),ei=a(54);const tf=(J,Na)=>ei.a.wyd(66,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,k.AFrameworkApplication.fa.Dd("MaxRetriesForLoadingScript",
0),J,Na);var Ph=a(247);class kh{constructor(J,Na,Eb){this.iframe=J;this.onSuccess=Na;this.onError=Eb;$addHandler(window,"message",Object(id.a)(this,this.jdf,"handleResponse"))}jdf(J){try{if(J&&J.rawEvent&&J.rawEvent.origin&&this.iframe&&this.iframe.id){var Na=this.uPf(J.rawEvent.origin);const Eb=this.uPf(document.domain);if(I.a.$h().equals(Eb,Na))if(J.rawEvent.source&&J.rawEvent.source.frameElement&&J.rawEvent.source.frameElement.id&&I.a.$h().equals(J.rawEvent.source.frameElement.id,this.iframe.id)){Na=
null;try{Na=JSON.parse(J.rawEvent.data)}catch(gc){u.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",gc.message)}Na?(Na.statusCode!==Ph.a.oP||void 0!==Na.error&&Na.error?(u.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Na.statusCode,Na.error),this.onError()):(u.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.onSuccess(Na.authorizationCode?Na.authorizationCode:Na.signInUrl)),$removeHandler(window,"message",Object(id.a)(this,this.jdf,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):u.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):u.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):u.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else u.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else u.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else u.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Eb){u.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Eb.message)}}uPf(J){let Na=
"";try{J&&(Na=-1<J.indexOf("//")?J.split("/")[2]:J.split("/")[0])&&(Na=Na.split(":")[0],Na=Na.split("?")[0])}catch(Eb){u.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Eb.message)}return Na}static la(J,Na,Eb){new kh(J,Na,Eb)}}Object(e.a)(kh,"ResponseHandler",null,[]);var $g=a(264);class Qg{constructor(J){this.jHa=J}tryAuthenticate(J,Na){this.icb(Qg.jCg,()=>{J()},Na)}tryAuthorize(J,Na){this.icb(Qg.nxg,J,Na)}getSignInUrl(J,Na){this.icb(Qg.Rme,J,Na)}signOut(J,Na){this.icb(Qg.lIg,
J,Na)}icb(J,Na,Eb){var gc=new $g.QueryStringBuilder("AuthenticationProxyHandler.aspx");gc.vj("responseType",J);k.AFrameworkApplication.r_a(gc);gc=String.format("{0}{1}&{2}",this.jHa,gc.toString(),k.AFrameworkApplication.Di);const vc=document.createElement("iframe");vc.setAttribute("id","privateCatalogIframe");vc.setAttribute("name","privateCatalogIframe");vc.setAttribute("style","display: none");I.a.$h().equals(J,Qg.Rme)||vc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");
kh.la(vc,Na,Eb);vc.setAttribute("src",gc);document.body.appendChild(vc)}}Qg.nxg="authcode";Qg.jCg="identitytoken";Qg.Rme="signinurl";Qg.lIg="signout";Object(e.a)(Qg,"AuthenticationProxy",null,[]);class Eg{}Eg.getUserId="getUserId";Eg.getLastStoreUpdate="laststoreupdate";Eg.getEntitlement="getEntitlements";Eg.getEToken="getEToken";Eg.getManifest="getManifest";Eg.getAppState="getAppState";Eg.getKilledApps="getRemovedAddins";Eg.getAppDetails="getAppDetails";Eg.removeApps="removeAddin";Eg.getLastPrivateCatalogUpdate=
"getLastPrivateCatalogUpdate";Eg.getPrivateCatalogAddIns="getAddIns";Eg.getPrivateCatalogManifests="getAppManifests";Eg.isStoreDisabled="isStoreDisabled";Object(e.a)(Eg,"S2SWebRequestActions",null,[]);var mi=a(587);class Yh{getUserId(J,Na){const Eb=new h.a;Eb.add(new Rc.a("corr",J));this.uX(Eg.getUserId,Eb,1,Na)}getLastStoreUpdate(J,Na,Eb){const gc=new h.a;gc.add(new Rc.a("lc",J));gc.add(new Rc.a("corr",Na));this.uX(Eg.getLastStoreUpdate,gc,1,Eb)}getEntitlement(J,Na,Eb,gc){J=new h.a;J.add(new Rc.a("av",
Na));J.add(new Rc.a("corr",Eb));this.uX(Eg.getEntitlement,J,1,gc)}getEToken(J,Na,Eb,gc,vc,Qc){const hd=new h.a;hd.add(new Rc.a("cmu",J));hd.add(new Rc.a("cmf",Na));hd.add(new Rc.a("assetid",Eb));hd.add(new Rc.a("expver",gc));hd.add(new Rc.a("corr",vc));this.uX(Eg.getEToken,hd,1,Qc)}getManifest(J,Na,Eb,gc){const vc=new h.a;vc.add(new Rc.a("cmu",J));vc.add(new Rc.a("assetid",Na));vc.add(new Rc.a("corr",Eb));this.uX(Eg.getManifest,vc,1,gc)}getAppState(J,Na,Eb){const gc=new h.a;gc.add(new Rc.a("ma",J));
gc.add(new Rc.a("corr",Na));this.uX(Eg.getAppState,gc,1,Eb)}getKilledApps(J,Na){const Eb=new h.a;Eb.add(new Rc.a("corr",J));this.uX(Eg.getKilledApps,Eb,1,Na)}getAppDetails(J,Na,Eb,gc){const vc=new h.a;vc.add(new Rc.a("cmo",J));vc.add(new Rc.a("corr",Eb));this.sendWithBody(Eg.getAppDetails,vc,Na,2,gc,!1)}removeApps(J,Na,Eb){const gc=new h.a;gc.add(new Rc.a("corr",Na));this.sendWithBody(Eg.removeApps,gc,J,2,Eb,!1)}getLastPrivateCatalogUpdate(J,Na,Eb,gc,vc,Qc){const hd=new h.a;hd.add(new Rc.a("catalog",
"privatecatalog"));hd.add(new Rc.a("clientCode",J));hd.add(new Rc.a("clientVersion",Na));hd.add(new Rc.a("corr",vc));J=String.format("authorizationCode={0}&refreshToken={1}",Eb?Zf.a.wf(Eb):"",gc?Zf.a.wf(gc):"");this.sendWithBody(Eg.getLastPrivateCatalogUpdate,hd,J,2,Qc,!0)}getPrivateCatalogAddIns(J,Na,Eb,gc,vc,Qc){const hd=new h.a;hd.add(new Rc.a("catalog","privatecatalog"));hd.add(new Rc.a("clientCode",J));hd.add(new Rc.a("clientVersion",Na));hd.add(new Rc.a("corr",vc));J=String.format("authorizationCode={0}&refreshToken={1}",
Eb?Zf.a.wf(Eb):"",gc?Zf.a.wf(gc):"");this.sendWithBody(Eg.getPrivateCatalogAddIns,hd,J,2,Qc,!0)}getPrivateCatalogManifests(J,Na,Eb,gc,vc){const Qc=new h.a;Qc.add(new Rc.a("catalog","privatecatalog"));Qc.add(new Rc.a("corr",gc));J=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Zf.a.wf(J),Na?Zf.a.wf(Na):"",Eb?Zf.a.wf(Eb):"");this.sendWithBody(Eg.getPrivateCatalogManifests,Qc,J,2,vc,!0)}isStoreDisabled(J,Na){const Eb=new h.a;Eb.add(new Rc.a("corr",J));this.uX(Eg.isStoreDisabled,
Eb,2,Na)}uX(J,Na,Eb,gc){this.sendWithBody(J,Na,null,Eb,gc,!1)}sendWithBody(J,Na,Eb,gc,vc,Qc){const hd=new $g.QueryStringBuilder("AddinServiceHandler.ashx");hd.vj("action",J);hd.vj("app",mi.a[k.AFrameworkApplication.sa.Pa.$i]);for(let nd of Na)hd.vj(nd.key,nd.value);Na=String.format("{0}{1}&{2}",k.AFrameworkApplication.sa.Pa.n0,hd.toString(),k.AFrameworkApplication.Di);k.AFrameworkApplication.Od.Zm(Na,gc,Eb,null,!1,2,nd=>{let Cd=null,Sd=null;nd&&nd.data&&(nd.data.responseHeaders["X-BlockedForMinor"]&&
"1"===nd.data.responseHeaders["X-BlockedForMinor"].toString()&&(nd.data.httpStatus=451),Cd=nd.data.te,Sd=nd.data.responseHeaders);vc(nd.data.httpStatus,Cd,Sd)},nd=>{var Cd=null;let Sd=null;Qc&&nd&&nd.data&&nd.data.te&&(Cd=nd.data.te,Sd=nd.data.responseHeaders);vc(nd.data.httpStatus,Cd,Sd);if(k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Cd={message:"AddinServiceHandler request failed"};Cd.code=nd.data.httpStatus;Cd.action=J;
if(nd.data.request||nd.data.request.get_headers())Cd["X-UserSessionId"]=nd.data.request.get_headers()["X-UserSessionId"];408===nd.data.httpStatus||503===nd.data.httpStatus?u.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Cd)):u.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Cd))}else u.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",nd.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+J,void 0,void 0,void 0,["X-UserKey"])}}Object(e.a)(Yh,"S2SWebRequestManager",
null,[]);class fi extends d.a{constructor(J){super();this.pWf=this.ddaFacade=null;this.$=J;J.da.Ha(106,this);this.Mb()}get Gd(){return this.ddaFacade||(this.ddaFacade=new Pg.DdaFacade(this.$,this.pWf,this.eg))}create(){u.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");k.AFrameworkApplication.disableWholeAppsForOfficeFeature?u.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${k.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
y.EwaSettings.ya(359)?Gd.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(J=>{J.isFeatureEnabled("mso_officeStore",!0).then(Na=>{Pg.DdaFacade.q7b=Na;this.OKe();return null})}):this.OKe()}OKe(){const J=Gc.GetServiceTaskFactory.Sa(this.$.da,224,225,this.Na),Na=ei.a.wyd(65,()=>!(void 0===window.OSF||null===window.OSF),this.$.xa.MaxRetriesForLoadingScript,this.$.ka,this.Na,106),Eb=tf(this.ka,this.Na);let gc,vc=[J,Na,Eb];const Qc=y.EwaSettings.isChangeGateEnabled("OfficeVSO:7637843_CreateRichApiRangeValuesPreview");
Qc&&(gc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(Wh.d)(Xh.a.resolve(Gh.x,{rb:this.Na})):Gc.GetServiceTaskFactory.create(this.$.da,18,this.$.ka,this.Na),vc=[J,Na,Eb,gc]);Mb.TaskExtensions.za(Mb.TaskExtensions.Pd(vc,this.$.ka),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?u.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Zd.a.uZ()}`):
this.rli();u.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.pWf=J.result;Qc&&(this.eg=gc.result);this.vb(this.Gd);u.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ka,3)}rli(){y.EwaSettings.ya(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Yh);this.$.se.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Yh,new Qg(k.AFrameworkApplication.fa.appSettings.WebServiceBase),y.EwaSettings.ya(70),
y.EwaSettings.ya(378));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Yh);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Yh)}dispose(){Hh.a.Ja(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static la(J){new fi(J)}}Object(e.a)(fi,"DdaFacadeServiceFactory",d.a,[]);var Qh=a(466);class ni{constructor(J,Na,Eb,gc,vc,Qc){this.$=J;this.agaveCommandManager=Qc}Vc(){return!1}Oc(){return!1}Ac(J,Na,Eb,gc){let vc=
!1;switch(Na.command){case -684355545:vc=!0;break;case -741808261:vc=!!Eb;break;case -859308420:vc=!!gc&&1===gc.Ew;break;case 418618014:vc=1===J&&!!gc&&1===gc.Ew;break;case -167264441:vc=Rg.a.mCb(this.$)&&1===J&&!!gc&&1===gc.Ew;break;case -515602470:Na=y.EwaSettings.ya(217)&&2===J;vc=(1===J||Na)&&!!gc&&1===gc.Ew;break;case 2086613372:vc=y.EwaSettings.ya(217)&&2===J&&!!gc&&1===gc.Ew;break;case -1336341324:vc=y.EwaSettings.ya(417)&&1===J&&!!gc&&1===gc.Ew;break;case 451940422:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",
!1)&&1===J&&!!gc&&1===gc.Ew;break;case -1444574190:case -336193495:vc=1===J&&!!gc&&1===gc.Ew;break;case 1296389134:vc=1===J&&!!gc&&1===gc.Ew;break;case Nf.a.I7a:vc=1===J&&!!gc&&1===gc.Ew;break;case -1473679467:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===J&&!!gc&&1===gc.Ew;break;case 1221897806:vc=y.EwaSettings.ya(155)&&2===J;break;case 1172793074:case 1930653487:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&2===J;break;case -1753056834:vc=!0;break;case 932597253:vc=!0;break;case 301511274:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:vc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:vc=this.$.isEditMode&&this.$.ea.POb}return vc}executeCommand(J,Na,Eb){let gc=Mb.TaskExtensions.lk();const vc=Na.command;switch(Na.command){case -1473679467:Qh.a(this.$,488,
489,1,Qc=>{gc=Qc.qoi(Eb.SourceControlId,Na)});break;case Nf.a.I7a:this.agaveCommandManager.agh(Eb.SourceControlId);break;case 1296389134:this.agaveCommandManager.YTj(Eb.SourceControlId,Eb.LabelText);break;case -684355545:this.agaveCommandManager.F3c();break;case -741808261:gc=this.agaveCommandManager.insertAgave(Eb,Na);Qh.a(this.$,488,489,1,Qc=>{Qc.WLg(Eb)});break;case -1336341324:y.EwaSettings.ya(417)&&(gc=this.agaveCommandManager.fnd(Eb,J,Na));break;case 1172793074:y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(gc=this.agaveCommandManager.fnd(Eb,J,Na));break;case -859308420:case -515602470:case -167264441:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:gc=this.agaveCommandManager.fnd(Eb,J,Na);break;default:gc=xd.a(vc)}return gc}}Object(e.a)(ni,"AgaveCommandHandler",null,[233]);class Bi{}Object(e.a)(Bi,"Selection",null,[]);var oi=a(1362),Si=a(1361),Ti=a(1363),
dh=a(1359),Ci=a(1357);class Ui{}Object(e.a)(Ui,"SmartLookupApplicationInterface",null,[]);class Vi{}Object(e.a)(Vi,"ApplicationProperties",null,[]);class Wi{}Object(e.a)(Wi,"EnterpriseUserInfo",null,[]);class Bh{}Object(e.a)(Bh,"FeatureGates",null,[]);class Di{constructor(J,Na,Eb=!0){this.j_j=9E5;this.m_j=3E5;this.eAd=null;this.ywf="";this.bAd=0;this.Rub=Date.now;this.oza=J;this.S$a=Na;Eb&&this.shd()}F8h(){const J=this.Rub();if(J<this.bAd+this.j_j)return J>this.bAd+this.m_j&&this.shd(),this.ywf;this.shd();
return""}shd(){this.eAd=this.eAd||new Promise(J=>{this.G8h().then(Na=>{this.ywf=Na;this.bAd=this.Rub();this.eAd=null;J(Na)})})}G8h(){return this.S$a&&this.S$a.length?new Promise(J=>{this.oza.JL("SmartLookup",this.S$a).then(Na=>{Na.IsSuccess?Na.Token||(J(""),u.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(u.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Na.ErrorCode+": "+Na.ErrorMessage),J(""));J(Na.Token)}).catch(Na=>
{Na=Bf.c(Na);u.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Na);J("")})}):(u.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(e.a)(Di,"SmartLookupAuthenticationManager",null,[209]);class Ei{static hZh(){switch(Object(U.a)(String,k.AFrameworkApplication.Yb.AudienceGroup)||""){case "Dogfood":if(k.AFrameworkApplication.fa){let J=k.AFrameworkApplication.fa.Wa("UserPrincipalName");J=Zf.a.Ok(J);
const Na=k.AFrameworkApplication.fa.Sp("SmartLookupINTEnabledForSKITeam")?k.AFrameworkApplication.fa.Ow("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Na,J)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static d8h(){switch(k.AFrameworkApplication.fa.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":k.AFrameworkApplication.fa.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":k.AFrameworkApplication.fa.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":Ei.hZh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";
case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(e.a)(Ei,"Utils",null,[]);var Xi=a(568),Rh=a(181);class Sh{constructor(J){u.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.exf=k.AFrameworkApplication.fa.ra("IsTellMeUpSellEnterpriseEnabled");this.EKi=k.AFrameworkApplication.fa.Wa("SmartLookupApprovedOriginPattern");this.S$a=k.AFrameworkApplication.fa.Wa("SmartLookupShredderServiceEndpoint");
this.iLi=eh.a.AK(k.AFrameworkApplication.fa.Wa("AppCatalogUrl")||"");this.R$a=new Bh;this.R$a.EnableAllTabV2=!0;this.R$a.EnableIntentService=!0;this.R$a.EnableInDocumentSearch=k.AFrameworkApplication.fa.ra("SmartLookupEnableInDocumentSearch");this.R$a.EnableLocalSearch=k.AFrameworkApplication.fa.ra("SmartLookupEnableLocalSearch");this.R$a.IntentServiceEndpoint=Ei.d8h();this.dLi=new Di(J,this.S$a)}get approvedOriginPattern(){return this.EKi}LTh(){return Promise.resolve(this.MTh())}MTh(){const J=new Vi;
J.anid="";J.applicationVersion=k.AFrameworkApplication.buildVersion;J.appCorrelationId=Rh.a.create().toString();J.themePlatform=Sh.Kbk;J.lcid=k.AFrameworkApplication.lcid;J.launchUtcTime=(new Date).toUTCString();J.featureGates=this.R$a;var Na=Xi.a.KH(k.AFrameworkApplication.lcid);Na=Na?Na.name:null;J.market=this.eec(Na);J.uiLanguage=Na;J.sessionId=k.AFrameworkApplication.userSessionId;J.themeId=0;J.parentalControl=Sh.r9i;const Eb=new Wi;Eb.CountryCode=this.eec(Na);Eb.ServiceEndpoint=this.S$a;Eb.IsGoLocal=
!1;Eb.IsEnabled=this.exf;Eb.IsEnterpriseEnabled=this.exf;Eb.TenantRoot=this.iLi;J.enterpriseUserInfo=Eb;J.accessToken=this.dLi.F8h();return J}eec(J){J=J.split("-");return J[J.length-1]}}Sh.Kbk="web";Sh.r9i="yes";Object(e.a)(Sh,"SmartLookupManager",null,[173]);class Lh extends Bg.a{constructor(J){super();this.$=J;this.isFirstLaunch=!1}Vc(){return!1}Oc(){return!1}Ac(J,Na){J=y.EwaSettings.ya(127);return-983891024===Na.command&&J}executeCommand(J,Na){J=Mb.TaskExtensions.lk();-983891024===Na.command&&
this.tEi();return J}tEi(){var J=new Sh(null);const Na={};var Eb=ee.h(this.$).Ob(null).originalText;Eb=Object(Db.a)(new Bi,{neighborhood:Eb,mentionStart:0,mentionLength:Eb?Eb.length:0});const gc=Object(Db.a)(new Ui,{selection:Eb,entryPoint:0});J.LTh().then(Qc=>{Qc.applicationName=Lh.appName;Qc.isFirstLaunch=this.isFirstLaunch;Qc.themeId=5;Na[Lh.smartLookupApplicationInterface]=JSON.stringify(gc);Na[Lh.LVg]=JSON.stringify(Qc);this.isFirstLaunch=!1});J=new oi.a("ExcelOnline","Web","en-Us");Eb=new Si.a("FA000000006",
OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const vc=new Ti.a;vc.optionalProperties[dh.a.Nk]=Gf.a.instance.ha(1810);vc.optionalProperties[dh.a.taskPaneWidth]=350;vc.optionalProperties[dh.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";vc.Fr=Na;Ci.a.instance.Oma(Eb,"Taskpane","SmartLookupSDXTaskpane",J,vc)}}Lh.LVg="AppProperties";Lh.appName="Excel";Lh.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(e.a)(Lh,"SmartLookupCommandHandler",Bg.a,[233]);class pi extends ve.a{constructor(J){super(J)}Fd(){Qh.a(this.$,
374,375,this.Na,J=>{this.qd([new ni(this.$,null,null,null,null,J),new Lh(this.$)])})}static la(J){ve.a.Yd(76,new pi(J))}}Object(e.a)(pi,"AgaveCommandHandlerFactory",ve.a,[]);var Yi=a(1364),kg=a(112);class Ch{constructor(){this.Gd=null;this.Scb=(J,Na,Eb,gc,vc)=>{if(2===Eb){J=vc?vc:{};Na=J.callback;Eb=J.refresh?J.refresh:!1;if(!Na)return 16;k.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=J.storeType?this.Gd.OTf(Na,Eb,J.storeType):this.Gd.uea(Na,
Eb)}return 32};this.Svc=(J,Na,Eb,gc,vc)=>{if(2===Eb){J=vc?vc:{};Na=J.Observer;if(!Na)return u.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(J)),16;if(!this.Gd||!this.Gd.bia)return u.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(J)),16;this.Gd.bia.Uvc(Na)}return 32};this.gmj=(J,Na,Eb,gc,vc)=>{2===Eb&&(J=vc?vc.callback:
null)&&this.Gd.rQg(J);return 32};this.poi=(J,Na,Eb,gc,vc)=>{2===Eb&&this.Gd.osc(null,OSF.AgaveHostAction.InsertAgave,vc);return 32}}initialize(J){Ch.initialized||(this.Gd=J,this.Pg(),Ch.initialized=!0)}Pg(){k.AFrameworkApplication.xb.Ne(Nf.a.Scb,kg.a.frame,this.Scb,96);k.AFrameworkApplication.xb.Ne(Nf.a.Svc,kg.a.frame,this.Svc,96);k.AFrameworkApplication.xb.Wb(Nf.a.Vkj,kg.a.frame,this.gmj);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",!1)&&k.AFrameworkApplication.xb.Ne(Nf.a.mif,
kg.a.frame,this.poi,96)}static get instance(){Ch.Ma||(Ch.Ma=new Ch);return Ch.Ma}}Ch.Ma=null;Ch.initialized=!1;Object(e.a)(Ch,"AgaveCommandActor",null,[]);var qh=a(1416),Fi=a(1360),gi=a(117),Dh=a(364),fj=a(361),qi=a(1290),Ag=a(19),ri=a(356);class Gi{constructor(){this.o_d=this.jEc=null;this.gw=0;this.hEc=null}}Object(e.a)(Gi,"FirstPartyAddinTaskpaneOverrides",null,[]);class si{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=
this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(e.a)(si,"IdeasSelectionContext",null,[]);class ti extends si{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(e.a)(ti,"IdeasTableSelectionContext",si,[]);class Hi{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(e.a)(Hi,"AutoFilterRange",null,[]);class Ii{constructor(){this.autoFilterType=
this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(e.a)(Ii,"IdeasAutoFilterSource",null,[]);class Ji{constructor(J,Na){this.selection=J;this.tables=Na}}Object(e.a)(Ji,"IdeasXLIMTableBoundaries",null,[]);var Vg=a(65);const Ki=(J,Na,Eb,gc,vc,Qc,hd=null)=>{hd=J.Oa(9,hd);hd.sharedInfo=Na;return Vg.g(J,"ShowAgaveTaskpane",hd,Eb,gc,vc,Qc,0)};var nh=a(1003),Zh=a(73),Zi=a(134),Jh=a(45),Li=a(380),Mh=a(199),$i=a(184),gj=a(579),cg=a(293),hi=a(110),aj=a(135),ui=a(55);class $h extends He.a{constructor(){super();
this.gY="calc(100% - 46px)";this.I9="15px";this.hY="0";this.nkb="WACDialogPanel";this.MG=695;this.okb=462;this.t2="80%";this.cjb=350;this.$qa="100%";this.Xb=5;this.ye="AppsForOfficeInsertionDialog";this.GMc=!!k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix")}ox(){super.ox();this.Xh.style.width=this.$qa;this.Xh.style.height=this.gY;this.Xh.style.marginTop=this.I9;this.Xh.style.padding=this.hY}ooa(){this.Xh.style.width=this.$qa;this.Xh.style.height=
this.gY;this.Xh.style.marginTop=this.I9;this.Xh.style.padding=this.hY;this.MG>Be.a.C0?(this.mb.style.width=String.format("{0}px",Be.a.C0),this.mb.style.overflowX="scroll",k.AFrameworkApplication.isRtl?this.mb.style.right="0":this.mb.style.left="0"):(this.mb.style.width=String.format("{0}px",this.MG),this.mb.style.overflowX="hidden");this.mb.offsetHeight>Be.a.B0||this.okb+50>Be.a.B0?(this.mb.style.height=String.format("{0}px",Be.a.B0),this.mb.style.overflowY="scroll",this.mb.style.top="0",k.AFrameworkApplication.isRtl?
this.mb.style.right="0":this.mb.style.left="0",this.GMc||(this.mb.style.marginTop="-48px"),this.Xh.style.minHeight=String.format("{0}px",this.cjb)):(this.mb.style.overflowY="hidden",this.mb.style.top="10%",this.mb.style.height=this.t2);this.Haa()}Haa(){if(this.mb){var J=this.mb.style.zIndex;this.mb.style.zIndex="-9999";if(this.MG>Be.a.C0)k.AFrameworkApplication.isRtl?this.mb.style.marginRight="0":this.mb.style.marginLeft="0";else{const Na=String.format("{0}px",Math.floor(-this.mb.offsetWidth/2));
k.AFrameworkApplication.isRtl?this.mb.style.marginRight=Na:this.mb.style.marginLeft=Na;k.AFrameworkApplication.isRtl?this.mb.style.right="50%":this.mb.style.left="50%"}this.mb.style.zIndex=String(J)}else u.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}dE(){super.dE();const J=document.getElementById(this.Sh(this.nkb));J.style.width=String.format("{0}px",this.MG);J.style.height=this.t2}get sba(){return this.Xh}}Object(e.a)($h,"AppsForOfficeInsertionDialog",He.a,[477]);
class S extends He.a{constructor(J=!0,Na=!0){super();this.gY="calc(100% - 46px)";this.I9="15px";this.hY="0";this.nkb="WACDialogPanel";this.MG=695;this.okb=462;this.t2="80%";this.cjb=350;this.$qa="100%";this.Pzg="auto";this.Qzg="5px";this.Rzg="auto";this.Nzg="40px";this.Ozg="100px";this.Szg="200px";this.Xb=5;this.ye="SDXDialog";this.JWb=J;this.cAb=Na}ox(){super.ox();this.Xh.style.width=this.$qa;this.Xh.style.height=this.gY;this.Xh.style.marginTop=this.I9;this.Xh.style.padding=this.hY}ooa(){this.Xh.style.width=
this.$qa;this.Xh.style.height=this.JWb?this.gY:"100%";this.Xh.style.marginTop=this.JWb?this.I9:"0px";this.Xh.style.padding=this.hY;this.JWb?(this.MG>Be.a.C0?(this.mb.style.width=String.format("{0}px",Be.a.C0),this.mb.style.overflowX="scroll",k.AFrameworkApplication.isRtl?this.mb.style.right="0":this.mb.style.left="0"):(this.mb.style.width=String.format("{0}px",this.MG),this.mb.style.overflowX="hidden"),this.mb.offsetHeight>Be.a.B0||this.okb+50>Be.a.B0?(this.mb.style.height=String.format("{0}px",Be.a.B0),
this.mb.style.overflowY="scroll",this.mb.style.top="0",k.AFrameworkApplication.isRtl?this.mb.style.right="0":this.mb.style.left="0",this.Xh.style.minHeight=String.format("{0}px",this.cjb)):(this.mb.style.overflowY="hidden",this.mb.style.top="10%",this.mb.style.height=this.t2),this.Haa()):(this.mb.style.left=this.Pzg,this.mb.style.right=this.Qzg,this.mb.style.top=this.Rzg,this.mb.style.bottom=this.Nzg,this.mb.style.width=this.Szg,this.mb.style.height=this.Ozg,this.mb.style.overflowX="hidden",this.mb.style.overflowY=
"hidden")}Haa(){if(this.mb){var J=this.mb.style.zIndex;this.mb.style.zIndex="-9999";if(this.MG>Be.a.C0)k.AFrameworkApplication.isRtl?this.mb.style.marginRight="0":this.mb.style.marginLeft="0";else{const Na=String.format("{0}px",Math.floor(-this.mb.offsetWidth/2));k.AFrameworkApplication.isRtl?this.mb.style.marginRight=Na:this.mb.style.marginLeft=Na;k.AFrameworkApplication.isRtl?this.mb.style.right="50%":this.mb.style.left="50%"}this.mb.style.zIndex=String(J)}else u.ULS.sendTraceTag(524892188,306,
10,"_divMessageBox is null in CenterDialog()")}dE(){super.dE();const J=document.getElementById(this.Sh(this.nkb));J.style.width=String.format("{0}px",this.MG);J.style.height=this.t2}get j6(){return this.JWb}get sba(){return this.Xh}}Object(e.a)(S,"SDXDialog",He.a,[]);var Wa=a(896),xb=a(154),fc=a(432),Ac;(function(J){J[J.Valid=2]="Valid";J[J.Invalid=4]="Invalid";J[J.All=6]="All"})(Ac||(Ac={}));Object(e.b)("MetadataState",Ac);var Uc=a(353),fd=a(1002);class dd extends Bg.a{constructor(J,Na,Eb,gc,vc){super();
this.kpa={};this.ofd={};this.JAa=this.sdxDialog=this.w_=null;this.Cdb=!1;this.QSj=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"]]);this.agh=Qc=>{Qc?(Qc=new L.a(-847286761,ic.a.Eb,this.$.Bc,0,Qc),this.$.Ia.Nb(Qc,{["CalloutName"]:19})):u.ULS.sendTraceTag(509220127,220,10,"Control id is null.")};
this.dei=(Qc,hd,nd,Cd,Sd)=>{if(2!==nd)return 32;Qc=Sd[Wa.a.Awb];hd=Sd[Wa.a.dja];nd=Sd[Wa.a.bea];Sd=new qh.a;Sd.Gic=nd.optionalProperties.InstanceToken;Sd.sourceLocationOverrideResourceId=nd.optionalProperties[dh.a.sourceLocationOverrideResourceId];Sd.ex=nd.Fr;Sd.dja=hd;hd=null!=Sd.Gic?Sd.Gic:(new oa.a(Rh.a.create(),1)).toString();nd=null!=Sd.ex?Sd.ex:{};Cd={};Cd.id=hd;Cd.solutionId=Qc.getId();Cd.version=Qc.lEa;Cd.storeType=Qc.getStoreType();Cd.storeId=Qc.getStoreId();Cd.assetId=null;Cd.assetStoreId=
null;Cd.settings=nd;Cd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Cd.osfControlType=OSF.OsfControlType.ContainerLevel;Cd.sourceLocationOverrideResourceId=Sd.sourceLocationOverrideResourceId;Cd.featureGates=k.AFrameworkApplication.fa.U5e(Qc.getId());this.xnc(Sd,Cd);return 32};this.VEb=(Qc,hd,nd,Cd,Sd)=>{2===nd&&(this.w_=new $h,this.w_.initializeAndShow("",null,null),Qc=Sd.CommandValueId,hd=[],hd.push(Sd.SourceControlId),hd.push(Qc),hd.push(null),this.Gd.btf(this.w_.sba,hd));
return 32};this.xnc=(Qc,hd)=>{this.sdxDialog=new S;this.sdxDialog.initializeAndShow("",null,null);hd.div=this.sdxDialog.sba;Qc={};Qc.InstanceId=hd.id;Qc.WebExtensionType=2;Qc.PrimaryMarketplace={};Qc.PrimaryMarketplace.SolutionId=hd.solutionId;Qc.PrimaryMarketplace.MarketplaceType=hd.storeType;Qc.PrimaryMarketplace.MarketplaceRef=hd.storeId;Qc.PrimaryMarketplace.SolutionVersion=hd.version;Qc.SrcLocationOverrideResourceId=hd.sourceLocationOverrideResourceId;Qc.WebExtensionOsfControlType=6;this.kpa[hd.solutionId]=
hd.settings;const {Xuc:nd,Uwb:Cd}=this.ppc([],hd.solutionId);Qc.OsfPropertyBag=nd;Qc.HostPropertyBag=Cd;this.Gd.LJa(Qc);this.Gd.Jg.insertOsfControl(hd)};this.zfi=(Qc,hd,nd,Cd,Sd)=>{if(2!==nd)return 32;Qc=Sd[Wa.a.Awb];nd=Sd[Wa.a.dja];Sd=Sd[Wa.a.bea];hd=new qh.a;hd.Gic=Sd.optionalProperties.InstanceToken;hd.Nk=Sd.optionalProperties[dh.a.Nk];hd.XO=Sd.optionalProperties[dh.a.XO];dh.a.taskPaneWidth in Sd.optionalProperties&&(hd.taskPaneWidth=Sd.optionalProperties[dh.a.taskPaneWidth]);hd.sourceLocationOverrideResourceId=
Sd.optionalProperties[dh.a.sourceLocationOverrideResourceId];hd.ex=Sd.Fr;hd.onTaskPaneClose=Sd.optionalProperties[dh.a.onTaskPaneClose];hd.dja=nd;nd=new L.a(-859308420,0,2,0,"");Cd=Qc.getStoreType()===OSF.StoreType.Sdx;const Je=new nh.a;Je.E5=Sd.optionalProperties.HeaderCssClass||Ag.a.A4a;Je.chb=Sd.optionalProperties.TitleCssClass;this.L8(nd,Qc.getId(),hd,Cd,Je);return 32};this.dfi=(Qc,hd,nd,Cd,Sd)=>{if(2!==nd)return 32;Qc=Sd[Wa.a.Awb].getId();Sd=Sd[Wa.a.bea].optionalProperties[dh.a.sourceLocationOverrideResourceId];
return Qc?(this.Gd.Jg.refreshOsfControl(Qc,Sd),32):8};this.$bj=Qc=>{Qc=Qc.Result;if(Qc=null===Qc?null:Qc.SolutionId)this.Gd.ire(Qc),hi.a(this.$).Roa(3,Qc)};this.fRf=(Qc,hd)=>{var nd;const Cd=(Qc=Qc.Result)?Qc.AgaveData:null;if(Cd){var Sd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Cd.PrimaryMarketplace.SolutionId,Cd.PrimaryMarketplace.MarketplaceType,null===(nd=null===Cd||void 0===Cd?void 0:Cd.AssetMarketplace)||void 0===nd?void 0:nd.SolutionId,null,null,Cd.PrimaryMarketplace.MarketplaceRef);u.ULS.shipAssertTag(537170434,
0,Cd.TaskpaneWidth===dd.Joh,`Taskpane width is ${Cd.TaskpaneWidth}, assetId is ${Sd}.`);if(nd=this.ofd[Cd.PrimaryMarketplace.SolutionId])nd.jEc&&(Cd.TaskpaneTitle=nd.jEc),nd.hEc&&(Cd.TaskpaneIconId=nd.hEc),nd.o_d&&(Cd.TaskpaneButtonTooltip=nd.o_d),0<nd.gw&&(Cd.TaskpaneWidth=nd.gw);hd&&(Cd.FocusOnIframeWhenLoaded=hd.focusOnIframeWhenLoaded,hd.width&&(Cd.TaskpaneWidth=hd.width),Cd.TaskpaneIconCssClass=hd.tk,Cd.TaskpaneHeaderCssClass=hd.E5,Cd.TaskpaneTitleCssClass=hd.chb,Cd.IsFirstPartyOptOutAppContextOptmization=
hd.isFirstPartyOptOutAppContextOptmization);if(this.kpa[Cd.PrimaryMarketplace.SolutionId]){const {Xuc:Je,Uwb:Te}=this.ppc(Cd.OsfPropertyBag,Cd.PrimaryMarketplace.SolutionId);Cd.OsfPropertyBag=Je;Cd.HostPropertyBag=Te}gj.a(Cd)||(Cd.WebExtensionOsfControlType=1);Cd&&(this.Gd.ire(Qc.SolutionId),this.Gd.LJa(Cd))}else u.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.dKh=Qc=>{Qc&&(this.zed.Arf(Qc),this.vDe())};this.jRf=Qc=>
{Qc=Qc.toDataURL("image/jpeg");const hd=this.Gd.Sba(dd.Yef+"."+dd.dgc),nd={};nd.screenshot=Qc;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(hd,"onScreenshot",nd,()=>{})};this.vdi=(Qc,hd,nd,Cd,Sd)=>{if(2!==nd)return 32;if(gi.a.Yg(Sd)||Sd[Wa.a.PHe]!==Fi.a.action)return 8;hd=Sd[Wa.a.bea];return hd?(Qc=(Qc=this.l4h(Sd))?this.Gd.Sba(Qc):null)?(Sd=this.Gd.gfh(Sd[Wa.a.dja],hd.optionalProperties[dh.a.fYc]),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(nd=this.Gd.oV(Qc),
nd.TaskpaneTitle!==hd.optionalProperties[dh.a.Nk]&&(nd.TaskpaneTitle=hd.optionalProperties[dh.a.Nk],nd.TaskpaneIconCssClass=hd.optionalProperties.IconCssClass,nd.TaskpaneIconUrl=hd.optionalProperties.TaskPaneIconUrl,nd.TaskpaneIconId=hd.optionalProperties.TaskPaneIconId,y.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(hd=this.Gd.Jg,hd.changeIframeTitle(Qc,nd.TaskpaneTitle),nd=hd.getOsfControl(Qc),hd.raiseOsfControlStatusChange(nd)):(hd=this.Gd.Jg.getOsfControl(Qc),this.Gd.Jg.raiseOsfControlStatusChange(hd)))),
OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Qc,Sd,this.ENb),32):8:8};this.ENb=(Qc,hd)=>{this.Gd.GMh(Qc,hd)};this.$Md=()=>{Mb.TaskExtensions.k4(Gc.GetServiceTaskFactory.Sa(this.$.da,20,404,1),Qc=>{Qc.result.cxa()},this.$.ka)};this.$=J;this.viewBlockContainerHelpers=Eb;this.Gd=Na;this.zed=gc;this.Yh=vc;this.Yh.Wb(Nf.a.xcg,kg.a.frame,this.zfi);this.Yh.Wb(Nf.a.B2f,kg.a.frame,this.dfi);this.Yh.Wb(Nf.a.tYe,kg.a.frame,this.vdi);this.Yh.Wb(Nf.a.xnc,kg.a.frame,this.dei);this.Yh.Wb(Nf.a.VEb,
kg.a.frame,this.VEb)}kRg(J){this.addHandler(dd.lHd,J)}bqj(J){this.removeHandler(dd.lHd,J)}dispose(){Hh.a.Ja(this.w_);this.w_=null;this.Cdb&&(this.$.ea.rn(this.$Md),this.Cdb=!1);super.dispose()}F3c(){this.w_&&this.w_.hide()}YTj(J,Na){var Eb;if(J){y.EwaSettings.isChangeGateEnabled("OfficeVSO:7671629_LogUserInstalledOMEXAddinListSizeEnabled")&&this.Gd.Jg.getEntitlementDetails(Object.assign(new fd.a,{storeType:OSF.StoreTypeEnum.MarketPlace,refresh:!1}),vc=>{vc={["AddinListSize"]:null==vc.value?0:vc.value.length,
["Origin"]:"OMEX"};Ja.a.sendTelemetryEvent(Object.assign(new Rf.a,{name:"Office.Extensibility.Host.AddinListInfoWhenUserOpenDialog",dataFields:Kb.a.mi(vc)}))});this.raiseEvent(dd.lHd);const gc=J.split("|");this.DIi(J,Na,gc);this.w_=new $h;this.w_.initializeAndShow("",null,null);this.Gd.btf(this.w_.sba,gc);window[dd.CTg]=null!==(Eb=this.QSj.get(J))&&void 0!==Eb?Eb:"Unknown"}}fnd(J,Na,Eb){var gc=Mb.TaskExtensions.lk();if(-515602470===Eb.command||-167264441===Eb.command||-336193495===Eb.command||2086613372===
Eb.command||-1444574190===Eb.command||-1336341324===Eb.command||451940422===Eb.command)gc=this.Sdi(J,Na,Eb);418618014===Eb.command&&(Na=new qh.a,Na.Nk=Gf.a.instance.ha(1823),gc=this.L8(Eb,dd.yhi,Na,!0));if((Eb.tabName===this.$.Ib+De.a.f3f||Eb.tabName===De.a.L0)&&2===Eb.af||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),J[ic.a.Uc])||J[ic.a.Uc]===De.a.OV)return this.Pcf(J,Eb);if(7===Eb.af&&J.SourceControlId===this.$.Ib+De.a.hxa)return J.MenuItemId=De.a.$Ld,this.Pcf(J,
Eb);1221897806===Eb.command&&(gc=this.hcg(Eb,"Format"));if(1930653487===Eb.command||1172793074===Eb.command)gc=this.hcg(Eb,"Data");-1753056834===Eb.command&&(gc=this.CPj(Eb));932597253===Eb.command&&(u.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),xb.c(932597253,!0),Na=new qh.a,Na.Nk=Gf.a.instance.ha(2163),Na.sourceLocationOverrideResourceId=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?dd.icj:dd.kcj,Na.focusOnIframeWhenLoaded=
!0,Na.taskPaneWidth=dd.Bgf,gc={},gc.LaunchSource=Object(U.a)(String,J.SourceControlId),gc.LaunchMode="Default",Na.ex=gc,gc=this.L8(Eb,dd.jcj,Na,!0));301511274===Eb.command&&(gc=this.NPj(Eb));if(515196233===Eb.command){Na=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);gc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1);var vc=this.$.da.Aa(465);vc&&(vc.fff(),Na||gc)&&
(vc.Sni(),gc&&vc.JFj(10===Eb.af));vc=new qh.a;vc.Nk=Gf.a.instance.ha(2237);const Qc={};Qc.SourceUILocation=Dh.a[Eb.af];if(Na||gc)Qc.SessionID=this.$.ea.sessionId,Na&&this.ETd(Qc);vc.ex=Qc;Na=new nh.a;Na.E5=Ag.a.A4a;gc=this.L8(Eb,dd.d8i,vc,!0,Na,void 0,vc.Nk)}1723441034===Eb.command&&(Na=new qh.a,Na.Nk=Gf.a.instance.ha(2249),Na.focusOnIframeWhenLoaded=!0,Na.taskPaneWidth=dd.$ej,gc=new nh.a,gc.E5=Ag.a.bBh,gc=this.L8(Eb,fc.b,Na,!0,gc));y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&J.LoadDataFromPictureTaskpane&&(Na={},gc=new qh.a,gc.Nk=Gf.a.instance.ha(2276),Na.SessionID=J.SessionID,gc.ex=Na,gc.focusOnIframeWhenLoaded=!0,gc=this.L8(Eb,J.DataFromPictureAssetId,gc,!0));return gc}insertAgave(J,Na){var Eb=Mb.TaskExtensions.lk();const gc=this.$;let vc;var Qc=J[qe.a.Z$];vc=J[ic.a.$f];let hd=null;nh.a.key in J&&(hd=J[nh.a.key]);this.w_&&this.w_.hide();if(!vc||!Qc)return u.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Eb;this.$.q6&&De.a.Upa in
J&&(vc.EnabledInViewMode=J[De.a.Upa]);J=this.AWh(Na.command);if(!vc.EnabledInViewMode&&!gc.wt(null,!1,J))return Eb;let nd=void 0===vc.IsToBePersisted||null===vc.IsToBePersisted||vc.IsToBePersisted?0:16;if(1===vc.TargetType)Eb=this.Koi(vc,Qc,Na,hd,nd);else{Qc=ee.h(gc);Eb=this.viewBlockContainerHelpers.uib(Qc);const Cd=gc.ea.isNamedObjectViewMode?gc.na.sheetName:gc.na.name;let Sd,Je,Te,wf;Eb?(Qc=Eb.re,Sd=Qc.Ge.top,Je=Qc.Ge.left,Te=Eb.rJ.x,wf=Eb.rJ.y):(Sd=Je=1,Eb=this.viewBlockContainerHelpers.GMa(Qc),
Te=Eb.x,wf=Eb.y);const Lg=this.$.pa.va.ic();nd|=64;Eb=Li.a(this.$.userOperationManager,(sg,dg,gg)=>{var Fg=gc.pa.va,ah=Sd,Xg=Je,bh=Te,Th=wf;sg=cg.b(sg,this.$bj);const ii=Fg.Oa(9,Lg);ii.sharedInfo=vc;ii.sheetName=Cd;ii.positionRow=ah;ii.positionCol=Xg;ii.positionOffsetX=bh;ii.positionOffsetY=Th;return Vg.g(Fg,"InsertWebExtension",ii,sg,dg,gg,null,0)},sg=>new Mh.a(534,0,sg,nd),Na)}return Eb}Gch(){var J=Gd.a.instance.$b("Common.App.ICustomerFeedbackUiWrapper");if(!y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",
!1)){var Na=Gd.a.instance.$b("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.zed?this.zed.Rlb?this.vDe():Na.instance.Jad(this.dKh):u.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Na={};k.AFrameworkApplication.fa.Dre(Na);J=J.instance.getContext(Na);Na={};"telemetryGroup"in J&&(Na=J.telemetryGroup);Na.processSessionId=J.sessionId;Na.officeBuild=J.build;J.telemetryGroup=Na;J.feedbackType=-1;J.userVoiceEnabled=!1;"disableIncludeScreenshot"in J||(J.disableIncludeScreenshot=
!1);"screenshot"in J||(J.screenshot=!1);J.disableScreenshotPreview=!1;J.includeScreenshotSelectedDefault=!0;return J}CRf(J){if(!this.JAa&&y.EwaSettings.getBooleanFeatureGate(dd.qji,!1)){var Na=this.Qjd();Na=this.QAe(Na);const Eb=new nh.a;Eb.tk=Ag.a.qwb;Eb.E5=Ag.a.nVe;Eb.chb=Ag.a.Xcd;this.JAa=this.Xyc(Na,null,!1,null,Eb);aj.b(this.$).rd(Zi.a.ycj,{["Location"]:J?Dh.a[J.af]:0,["InputMethod"]:J?fj.a[J.method]:0},void 0,!0);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",
!1)&&this.Z0d()}}ETd(J){const Na=this.$.ea.Lg.get(17);Gd.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Eb=>{Eb.isFeatureEnabled("mso_sendASmile",Na).then(gc=>{J.FeedbackEnabled=Na&&gc;return null})})}zvi(){return this.Gd.VAi(this.Gd.NLa(dd.pNa,this.Qjd()))}hcg(J,Na){const Eb=ee.h(this.$),gc=new qh.a;var vc={};vc.ActiveTab=Na;vc.DatapaneFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);vc.MergeIvyBiDataSources=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeIvyBiDataSources",
!1);vc.ComboChartUIInXLO=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",!1);vc.AceFlighting=!0;vc.ThemeColorsFlighting=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");vc.UOMirror=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);vc.FormatTaskPaneAceButtonDark=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);vc.FormatTaskPaneBetterFeedbackButton=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);vc.FormatTaskPaneBetterScrollbar=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);vc.FormatTaskPaneUXImprovePhase2=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);vc.ChartTPNewFontAndColorTheme=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",
!1);this.ETd(vc);vc.startTimeMs=Date.now();vc.UserSessionId=this.$.xa.UserSessionId;(Na=Eb.ga.Ra.uo)&&(vc.SubSelection=Na);u.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${vc.UserSessionId}, UILocation: ${void 0===J.af||null===J.af?"Null":Dh.a[J.af]}, SubSelection: ${Na||"ChartRoot"}`);gc.ex=vc;gc.Nk=Gf.a.instance.ha(984);vc=new nh.a;vc.E5=Ag.a.A4a;return this.L8(J,dd.B7g,gc,!0,vc)}CPj(J){const Na=new qh.a;Na.ex={};Na.Nk=Gf.a.instance.ha(1809);Na.XO=dd.Ctf;const Eb=new nh.a;
Eb.E5=Ag.a.A4a;return this.L8(J,dd.Ctf,Na,!0,Eb,void 0,Na.Nk)}NPj(J){const Na=new qh.a;Na.ex={};Na.Nk=Gf.a.instance.ha(2187);const Eb=new nh.a;Eb.E5=Ag.a.ECh;Eb.chb=Ag.a.rVe;return this.L8(J,dd.jQi,Na,!0,Eb)}Pcf(J,Na){const Eb=dd.Yef;var gc=J[ic.a.Uc].toString();const vc={},Qc=new qh.a;Qc.Nk=Gf.a.instance.ha(9);switch(gc){case "A0":vc.query=(J[ic.a.$f]||"").split("|").slice(2,ri.a.a2).join("|");break;case "A1":vc.query=J.CommandValueId;break;case "Help":vc.gwdropdownflightinfo=y.EwaSettings.ya(222);
vc.query="";break;case De.a.$Ld:y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Qc.Nk=Gf.a.instance.ha(1775),Qc.sourceLocationOverrideResourceId=dd.dgc,vc.feedback=this.Gch()):vc.query=gc;break;case "HelpArticle":vc.query=J[ic.a.$f];break;case "ContactSupport":vc.query=gc;Qc.sourceLocationOverrideResourceId=dd.Och;break;case "ShowTraining":case "WhatsNew":vc.query=gc;break;default:return Ve.Task.Ua(!0)}Qc.ex=vc;gc=new nh.a;gc.E5=Ag.a.A4a;return this.L8(Na,
Eb,Qc,!1,gc,J[De.a.Upa]||!1)}QAe(J){const Na={};Na.SolutionId=dd.pNa;Na.Version="0.0.0.0";Na.StoreType=OSF.StoreType.Sdx;Na.StoreId=OSF.StoreType.Sdx;Na.AssetId=null;Na.AssetStoreId=null;Na.Height=0;Na.Width=0;Na.TargetType=OSF.OsfControlTarget.TaskPane;Na.IsToBePersisted=!1;Na.SourceLocationOverrideResourceId=J;Na.SharedRuntimeId=J;return Na}Sdi(J,Na,Eb){function gc(){hd.LaunchMode="Default";vc.Nk=Gf.a.instance.ha(1822);vc.XO=dd.D2b;vc.tk=Ag.a.qwb;Qc.tk=Ag.a.qwb}const vc=new qh.a,Qc=new nh.a,hd=
{};this.JAa&&this.ETd(hd);hd.LaunchSource="";hd.StartTimeMs=Date.now();hd.CorrelationId=Rh.a.create().toString();vc.ex=hd;vc.focusOnIframeWhenLoaded=!0;vc.taskPaneWidth=dd.Bgf;Qc.E5=Ag.a.nVe;Qc.chb=Ag.a.Xcd;switch(Eb.command){case -1444574190:let Sd;hd.LaunchMode="RecommendedPivotTables";hd.SelectionContext="";hd.LaunchSource="PivotTableHandRaise"===Object(U.a)(String,J.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&y.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
J.SourceSelection){var nd=J.SourceSelection.split(",")[0];Na=y.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:nd,iVf:Sd,range:Cd}=Jh.ab(nd,this.$.ua)).returnValue&&!ee.h(this.$).wb.o6(Cd))J=this.$.ua.getItemByName(nd),hd.SelectionContext=JSON.stringify(Object(Db.a)(new si,{address:Sd,addressWithSheet:nd+"!"+Cd.Rw(!1),sheetId:Zh.d(J),sheetName:nd,isSheetEmpty:!1,columnCount:Cd.width,rowCount:Cd.height,columnIndex:Cd.left+Na,rowIndex:Cd.top+Na,selectionType:"Continuous"}));
else if((J=this.$.Hb.getItemByName(Object(U.a)(String,J.SourceSelection)))&&Zh.n(J)){var Cd=$i.a(J,!0);nd=this.$.ua.getItemByName(J.sheetName);hd.SelectionContext=JSON.stringify(Object(Db.a)(new ti,{tableName:J.name,hasTableHeaders:$i.d(J),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Cd.Rw(!1),addressWithSheet:nd.name+"!"+Cd.Rw(!1),sheetId:Zh.d(nd),sheetName:nd.name,isSheetEmpty:!1,columnCount:Cd.width,rowCount:Cd.height,columnIndex:Cd.left+Na,rowIndex:Cd.top+Na,selectionType:"Continuous"}))}}vc.Nk=
Gf.a.instance.ha(1821);vc.XO=dd.raj;vc.tk=Ag.a.BXe;Qc.tk=Ag.a.BXe;break;case -336193495:hd.LaunchMode="RecommendedCharts";vc.Nk=Gf.a.instance.ha(1820);vc.XO=dd.Bjj;vc.tk=Ag.a.CXe;Qc.tk=Ag.a.CXe;break;case -1336341324:if(!y.EwaSettings.ya(417))return Ve.Task.Ua(!1);hd.LaunchMode="NL";vc.XO=dd.D2b;switch(y.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:vc.Nk=Gf.a.instance.ha(1825);hd.NLLaunchModeBrandingCandidatesIndex=1;break;
case 2:vc.Nk=Gf.a.instance.ha(1826);hd.NLLaunchModeBrandingCandidatesIndex=2;break;default:vc.Nk=Gf.a.instance.ha(1824),hd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!y.EwaSettings.ya(217))return Ve.Task.Ua(!1);hd.LaunchMode="ChartDesigner";hd.LaunchSelectionMode=Na.toString();vc.Nk=Gf.a.instance.ha(1827);vc.XO=dd.D2b;break;case 451940422:hd.LaunchSource="AutoFilter";Cd=JSON.parse(J.CommandValueId);hd.AutoFilterSource=JSON.stringify(Object.assign(new Ii,{autoFilterRange:{sheetName:Cd.AutoFilterRange.SheetName,
firstColumn:Cd.AutoFilterRange.FirstColumn,lastColumn:Cd.AutoFilterRange.LastColumn,firstRow:Cd.AutoFilterRange.FirstRow,lastRow:Cd.AutoFilterRange.LastRow},autoFilterType:Cd.AutoFilterType,itemIndex:Cd.ItemIndex,id:Cd.Id}));gc();break;case -167264441:hd.LaunchMode="ExcelIntelligence";hd.TableName=J.tableName;vc.Nk=Gf.a.instance.ha(2287);vc.XO=dd.D2b;vc.tk=Ag.a.qwb;Qc.tk=Ag.a.qwb;break;default:y.EwaSettings.ya(217)&&(hd.LaunchSelectionMode=Na.toString()),y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",
!1)&&(hd.XlimTableBoundaries=this.G9h()),gc()}vc.sourceLocationOverrideResourceId=this.Qjd();return this.JAa?this.JAa.Fo(()=>this.p6f(hd,vc)):this.Tmi(Eb,vc,Qc,hd)}Tmi(J,Na,Eb,gc){this.JAa=this.Xyc(this.QAe(Na.sourceLocationOverrideResourceId),Na,!1,J,Eb,!1);return y.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(gc.NoActionMsgOnFirstInstance=!0,this.kpa[dd.pNa]=gc,this.JAa):this.JAa.Fo(()=>this.p6f(gc,Na))}p6f(J,Na){const Eb=this.Gd.Sba(this.Gd.NLa(dd.pNa,Na.sourceLocationOverrideResourceId));
if(Eb){this.kpa[dd.pNa]=J;const {Xuc:gc,Uwb:vc}=this.ppc(this.Gd.oV(Eb).OsfPropertyBag,dd.pNa);this.Gd.oV(Eb).OsfPropertyBag=gc;this.Gd.oV(Eb).HostPropertyBag=vc}this.Oma(dd.pNa,Fi.a.action,"LaunchIdeasAction",J,"1.0.0.0",Na);return Ve.Task.Ua(!0)}Qjd(){const J=k.AFrameworkApplication.Yb.AudienceGroup;if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(J){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(J){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}L8(J,
Na,Eb=null,gc=!1,vc=null,Qc=!1,hd=null){Mb.TaskExtensions.lk();Eb||(Eb=new qh.a);const nd={};nd.SolutionId=Na;nd.Version="0.0.0.0";nd.StoreType=gc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;nd.StoreId=gc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;nd.AssetId=null;nd.AssetStoreId=null;nd.Height=0;nd.Width=0;nd.TargetType=OSF.OsfControlTarget.TaskPane;nd.IsToBePersisted=!1;nd.SourceLocationOverrideResourceId=Eb.sourceLocationOverrideResourceId;if(Eb.Nk||hd)this.ofd[Na]=Object(Db.a)(new Gi,{jEc:Eb.Nk,
o_d:hd,hEc:Eb.XO});y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Eb.ex||(Eb.ex={}),Eb.ex.ShowFeedback=this.$.isFeedbackEnabled,this.kpa[Na]=Eb.ex):Eb.ex&&(this.kpa[Na]=Eb.ex);Na={};Na[ic.a.$f]=nd;hd={};hd.solutionId=nd.SolutionId;hd.version=nd.Version;hd.storeType=nd.StoreType;hd.storeId=nd.StoreId;hd.assetId=nd.AssetId;hd.assetStoreId=nd.AssetStoreId;hd.height=nd.Height;hd.targetType=nd.TargetType;hd.width=nd.Width;hd.isAddinCommands=
!gc;Na[qe.a.Z$]=hd;vc||(vc=new nh.a);vc.focusOnIframeWhenLoaded=Eb.focusOnIframeWhenLoaded;vc.width=Eb.taskPaneWidth;Na[nh.a.key]=vc;Na[De.a.Upa]=Qc;return this.insertAgave(Na,J)}Koi(J,Na,Eb,gc,vc){const Qc=(Sd,Je)=>{var Te=Sd.SolutionId;const wf=OSF.OsfControl.isFirstPartyStoreString(Sd.StoreType);wf&&Sd.SourceLocationOverrideResourceId&&(Te=this.Gd.NLa(Te,Sd.SourceLocationOverrideResourceId));var Lg=this.Gd.sEe(Te,null,Sd.SharedRuntimeId);if(wf){if(y.EwaSettings.ya(263)&&Lg&&(Te=this.Gd.Sba(Te))){const {Xuc:sg,
Uwb:dg}=this.ppc(this.Gd.oV(Te).OsfPropertyBag,Sd.SolutionId);if(Te=this.Gd.Jg.getOsfControl(Te))Te.setSettings(sg),Te.setHostSettings(dg)}Sd.SharedRuntimeId&&Lg||this.Gd.Jg.refreshOsfControl(Sd.SolutionId,Sd.SourceLocationOverrideResourceId)}if(!Lg){const sg=this.$.pa.va.ic();let dg=519;Lg=(gg,Fg,ah)=>{var Xg=this.$.pa.va;gg=cg.b(gg,this.fRf);const bh=Xg.Oa(9,sg);bh.sharedInfo=Sd;return Vg.g(Xg,"InsertAgaveTaskpane",bh,gg,Fg,ah,gc,0)};void 0===Sd.IsToBePersisted||null===Sd.IsToBePersisted||Sd.IsToBePersisted||
(dg=538,Lg=(gg,Fg,ah)=>{const Xg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Sd.SolutionId,Sd.StoreType,Sd.AssetId,null,null,Sd.StoreId);u.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Sd.StoreType}, StoreId ${Sd.StoreId}, SolutionId ${Xg}.`);return Ki(this.$.pa.va,Sd,cg.b(gg,this.fRf),Fg,ah,gc,sg)});vc|=64;return Li.a(this.$.userOperationManager,Lg,gg=>new Mh.a(dg,0,gg,vc),Je)}return Mb.TaskExtensions.mca()},hd=Sd=>{var Je=Telemetry.PrivacyRules.GetPrivacyCompliantId(Sd.solutionId,
Sd.storeType,Sd.assetId,null,null,Sd.storeId);u.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Je} from ${Sd.storeType}.`);Je={};const Te=new h.a;Te.add(Sd);Je[qe.a.jqb]=Te;Je[qe.a.rM]=3;Sd=new L.a(Nf.a.TEb,0,this.$.Bc,0,null);return this.$.Ia.Nb(Sd,Je)};if(!y.EwaSettings.ya(52)||J.StoreId===OSF.StoreType.FirstParty)return Qc(J,Eb,gc);if(Na.isAddinCommands)return hd(Na);const nd=new Yd.a,Cd={};Cd.solutionId=J.SolutionId;Cd.version=J.Version;Cd.storeType=J.StoreType;Cd.storeId=J.StoreId;
Cd.targetData=J;this.Gd.Jg.isAddinCommandsAsync(Cd,(Sd,Je,Te)=>{nd.setResult(Je);Sd||(Sd=Te.targetData,Je=Telemetry.PrivacyRules.GetPrivacyCompliantId(Sd.SolutionId,Sd.StoreType,Sd.AssetId,null,null,Sd.StoreId),u.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Je} from ${Sd.StoreType} during addin inserting`))});return Mb.TaskExtensions.ts(nd.task,Sd=>Sd.result?hd(Na):Qc(J,Eb,gc),this.$.ka)}ppc(J,Na){if(!this.kpa[Na])return{yfk:J,Uwb:null};const Eb={},gc={};if(J)for(const [Qc,
hd]of J)Eb[Qc]=hd;J=this.kpa[Na];for(var vc of Object.keys(J))Na=J[vc],vc===dd.fKh&&y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Eb[vc]=gc[vc]=Sys.Serialization.JavaScriptSerializer.serialize(Na):Eb[vc]=gc[vc]=Sys.Serialization.JavaScriptSerializer.serialize(Na.toString());vc=Object.keys(Eb).map(Qc=>[Qc,Eb[Qc].toString()]);J=Object.keys(gc).map(Qc=>[Qc,gc[Qc].toString()]);return{Xuc:vc,Uwb:J}}DIi(J,Na,Eb){const gc=this.$.xa.UserSessionId,vc=this.$.xa.UICultureTag,
Qc=this.$.xa.UICultureTagLcid,hd=this.$.xa.WacHostId;let nd="",Cd="";5<=Eb.length&&(nd=Eb[3],Cd=Eb[4]);this.EIi(nd,Cd,J,Na,vc,Qc,gc,hd)}EIi(J,Na,Eb,gc,vc,Qc,hd,nd){const Cd={};Cd.a=hd;Cd.b=Eb;Cd.c=gc;Cd.d=J;Cd.e=Na;Cd.f=vc;Cd.g=Qc;Cd.h=nd;ui.b().gf(36,Cd)}vDe(){if(qi.a.$Bf())u.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.jRf);return}catch(J){u.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(J?
J.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.jRf)}catch(J){u.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(J?J.toString():null))}}}Xyc(J,Na=null,Eb=!1,gc=null,vc=null,Qc=!0){var hd=J.SolutionId;let nd=Ve.Task.Ua(!1);J&&hd&&J.SharedRuntimeId&&(gc=gc||new L.a(-859308420,0,2,0,""),hd={},hd.solutionId=J.SolutionId,hd.version=J.Version,hd.storeType=J.StoreType,hd.storeId=J.StoreId,hd.assetId=J.AssetId,hd.assetStoreId=J.AssetStoreId,hd.height=
J.Height,hd.targetType=J.TargetType,hd.width=0,hd.isAddinCommands=!1,hd.sharedRuntimeId=J.SharedRuntimeId,J.Preload=Qc,vc=vc?vc:new nh.a,vc.width=0,Na&&(vc.focusOnIframeWhenLoaded=Na.focusOnIframeWhenLoaded,Qc=new Gi,Na.Nk&&(Qc.jEc=Na.Nk),0<Na.taskPaneWidth&&(Qc.gw=Na.taskPaneWidth),Na.XO&&(Qc.hEc=Na.XO),y.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&Na.ex&&(this.kpa[J.SolutionId]=Na.ex),this.ofd[J.SolutionId]=Qc),Na={},Na[ic.a.$f]=J,Na[qe.a.Z$]=hd,Na[nh.a.key]=vc,Na[De.a.Upa]=
Eb,nd=this.insertAgave(Na,gc));return nd}Oma(J,Na,Eb,gc,vc,Qc=null){if(J&&Eb){J=new Si.a(J,OSF.StoreType.Sdx,OSF.StoreType.Sdx,vc);vc=new oi.a("ExcelOnline","Web",this.$.xa.UICultureTag);const hd=new Ti.a;hd.optionalProperties[dh.a.fYc]=gc;Qc&&(Qc.sourceLocationOverrideResourceId&&(hd.optionalProperties[dh.a.sourceLocationOverrideResourceId]=Qc.sourceLocationOverrideResourceId),Qc.Nk&&(hd.optionalProperties[dh.a.Nk]=Qc.Nk),Qc.tk&&(hd.optionalProperties.IconCssClass=Qc.tk),Qc.l_d&&(hd.optionalProperties.TaskPaneIconUrl=
Qc.l_d),Qc.XO&&(hd.optionalProperties.TaskPaneIconId=Qc.XO));Ci.a.instance.Oma(J,Na,Eb,vc,hd)}}l4h(J){if(!gi.a.Yg(J)){var Na=J[Wa.a.Awb];if(Na&&(Na=Na.getId(),J=J[Wa.a.bea],Na&&J))return this.NLa(Na,J.optionalProperties[dh.a.sourceLocationOverrideResourceId])}return null}NLa(J,Na=null){return J&&Na?`${J}.${Na}`:J}AWh(J){switch(J){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return y.EwaSettings.ya(217)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;
case 515196233:return 1023;default:return 1}}Z0d(){this.$.ea.Bf?this.$Md():(this.$.ea.mk(this.$Md),this.Cdb=!0)}G9h(){var J=this.$.da.Aa(20);if(!J)return this.Z0d(),"";J=J.cxa();if(!J)return this.Z0d(),"";var Na=this.$.ua.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.na.name);Na=Zh.d(Na);var Eb=ee.h(this.$).ga.qa.selectedRanges;const gc=[];for(const Qc of Eb){Eb=new Uc.a(Qc,Na);var vc=J.s6a(Eb,Ac.Valid);Eb=[];if(vc)for(const hd of vc)(vc=hd.table.kz)&&(vc=vc.range.toString())&&
Eb.push(vc);Eb=new Ji(Qc.toString(),Eb);gc.push(Eb)}return JSON.stringify(gc)}}dd.qji="Microsoft.Office.Excel.IdeasXLOPreload";dd.lHd="IDS";dd.Yef="FA000000012";dd.pNa="FA000000005";dd.yhi="HelloWorld";dd.B7g="FA000000014";dd.dgc="Help.GiveFeedback.Url";dd.Och="Help.ContactSupport.Url";dd.fKh="feedback";dd.Ctf="FA000000066";dd.kcj="PowerBi.Url";dd.icj="PowerBi.DevUrl";dd.jcj="FA000000054";dd.jQi="FA000000064";dd.d8i="FA000000075";dd.D2b="AnalyzeDataTaskPane";dd.Bjj="RecommendedChartsTaskPane";dd.raj=
"PivotTableTaskPane";dd.Joh=350;dd.Bgf=320;dd.$ej=320;dd.CTg="g_InstallOrigin";Object(e.a)(dd,"AgaveCommandManager",Bg.a,[696,697]);class Fc extends d.a{constructor(J){super();this.$=J;this.Mb()}create(){const J=this.$.da,Na=Gc.GetServiceTaskFactory.create(J,106,this.ka,this.Na),Eb=Gc.GetServiceTaskFactory.create(J,104,this.ka,this.Na),gc=ei.a.loadScript(35,0,this.Na,void 0,void 0,375);Mb.TaskExtensions.za(Mb.TaskExtensions.Pd([Eb,Na,gc],this.ka),()=>{let vc=null;y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)&&(vc=Gd.a.instance.$b("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);Ch.instance.initialize(Na.result);const Qc=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Oh.a)(this.$.da,374,()=>new dd(this.$,Na.result,Eb.result,vc,k.AFrameworkApplication.xb)):new dd(this.$,Na.result,Eb.result,vc,k.AFrameworkApplication.xb);J.Ha(206,Qc);this.vb(J.Aa(374)||J.Ha(374,Qc))},this.ka,3);Gd.a.instance.register(Yi.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").zc().Gc(()=>
new Yi.a(this.$.Cv))}static la(J){J.da.Ha(375,new Fc(J))}}Object(e.a)(Fc,"AgaveCommandManagerFactory",d.a,[]);var od=a(571);class zd{constructor(){this.initialized=!1;this.agaveCommandManager=this.Gd=this.m2a=null;this.EU={}}initialize(J){y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.Hxj(J)}qoi(J,Na){let Eb=Mb.TaskExtensions.lk();if(this.initialized&&J&&0<J.length){let gc=this.nTh(J);J in this.EU&&(Eb=this.agaveCommandManager.insertAgave(gc,
Na))}return Eb}WLg(J){this.initialized&&(J=J[ic.a.$f]||{},!J.SolutionId||J.SolutionId in this.EU||this.Gd.uea(Na=>{this.uea(Na)},!0))}Zei(J){this.initialized&&(J=J||"")&&0<J.length&&J in this.EU&&(delete this.EU[J],this.Gd.uea(Na=>{this.uea(Na)},!0))}nTh(J){return J in this.EU?this.EU[J]:{}}uea(J){var Na=!1;if(J&&!J.errorCode){if(J.value)for(const Eb of J.value)J=Eb[1],Eb[3]==OSF.OsfControlTarget.InContent&&J&&0<J.length&&!(J in this.EU)&&(Na={NoReporting:!1,IsSystemInitiated:!1},Na.description=Eb[2],
Na.iconUrl=Eb[9],Na[qe.a.Z$]={solutionId:Eb[1],version:Eb[4],storeType:Eb[12],storeId:Eb[11],assetId:Eb[5],assetStoreId:Eb[6],targetType:Eb[3],width:Eb[7],height:Eb[8],displayName:Eb[0],id:Eb[1]},Na[ic.a.$f]={SolutionId:Eb[1],Version:Eb[4],StoreType:Eb[12],StoreId:Eb[11],AssetId:Eb[5],AssetStoreId:Eb[6],TargetType:Eb[3],Width:Eb[7],Height:Eb[8],Id:Eb[1]},this.EU[J]=Na,Na=!0);Na&&this.Egh()}}Egh(){let J=[];for(const Na in this.EU)J.push({id:Na,controlType:0,title:this.EU[Na][qe.a.Z$].displayName});
if(0<J.length){for(const Na in this.EU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Na,this.EU[Na].iconUrl);this.N8g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:zd.gCf,isOfficeTab:!0,groups:[{id:zd.xif,title:zd.yif,controls:J}]}]});for(const Na in this.EU)this.m2a.addCommandToMaps(Object(Db.a)(new Mf.a(Na,"-1473679467"),{legacyControlId:Na}))}}N8g(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:zd.gCf,isOfficeTab:!0,groups:[{id:zd.xif,title:zd.yif,controls:[]}]}]})}Hxj(J){const Na=
Gc.GetServiceTaskFactory.Sa(J.da,374,375,1),Eb=Gc.GetServiceTaskFactory.create(J.da,106,J.ka,1);Mb.TaskExtensions.za(Mb.TaskExtensions.Pd([Na,Eb],J.ka),()=>{this.agaveCommandManager=Na.result;this.m2a=Gd.a.instance.yg("Common.IExternalUICommandDefinitionMapping")||new od.a(J.Ib,J);k.AFrameworkApplication.xb.Wb(Nf.a.CYf,kg.a.frame,(gc,vc,Qc,hd,nd)=>{this.Zei(nd)});this.Gd=Eb.result;this.Gd.uea(gc=>{this.uea(gc)},!0);this.initialized=!0},J.ka,3)}}zd.gCf="tabinsert";zd.xif="installedContentAddins";zd.yif=
Gf.a.instance.ha(2285);Object(e.a)(zd,"AgaveCommandRibbon",null,[694]);class Id extends d.a{constructor(J){super();this.$=J;this.Mb()}create(){if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){const J=this.$.da,Na=new zd;Na.initialize(this.$);this.vb(J.Aa(488)||J.Ha(488,Na))}}static la(J){J.da.Ha(489,new Id(J))}}Object(e.a)(Id,"AgaveCommandRibbonFactory",d.a,[]);var Ld=a(1366),ae=a(757);class Fe{constructor(){this.Nae=this.hae=this.rga=
null;this.plb=0}get displayName(){return this.rga}set displayName(J){this.rga=J}get email(){return this.hae}set email(J){this.hae=J}get federationProvider(){return this.Nae}set federationProvider(J){this.Nae=J}get identityType(){return this.plb}set identityType(J){this.plb=J}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(J){switch(J){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,Na){switch(J){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}static Phh(J){const Na=new Fe;Na.displayName=J.displayName;Na.email=J.email;
switch(J.authority){case Ld.a.VNf:Na.identityType=1;break;default:Na.identityType=0}Na.federationProvider="";return Na}}Object(e.a)(Fe,"OfficeIdentityInfo",null,[]);class Le{static get vTe(){return Le.oAg}static qec(J){return J in Le.vTe?Le.vTe[J].toString():J}}Le.map=null;Le.oAg={["GeneralException"]:ae.a.generalException,["AccessDenied"]:ae.a.$Xc,["ApiNotAvailable"]:ae.a.apiNotAvailable,["UserNotSignedIn"]:ae.a.userNotSignedIn,["UserAborted"]:ae.a.userAborted,["UnsupportedUserIdentity"]:ae.a.Y4j,
["InvalidResourceUrl"]:ae.a.invalidResourceUrl,["InvalidGrant"]:ae.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:ae.a.ETg,["ResourceNotAllowed"]:ae.a.wvj,["ClientError"]:ae.a.clientError,["ServerError"]:ae.a.serverError};Object(e.a)(Le,"SingleSignOnErrorCodeMap",null,[]);class Ef{constructor(J,Na){this.mTb=J;this.plb=Na}get accessToken(){return this.mTb}set accessToken(J){this.mTb=J}get tokenIdenityType(){return this.plb}set tokenIdenityType(J){this.plb=J}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(J){switch(J){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,Na){switch(J){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(e.a)(Ef,"SingleSignOnToken",null,[]);class Xf{constructor(){this.B7d=null;this.Fle=this.$Yb=this.rE="";this.Tme=!0;this.options=null}get authChallenge(){return this.B7d}set authChallenge(J){this.B7d=
J}get correlationId(){return this.rE}set correlationId(J){this.rE=J}get policy(){return null}set policy(J){}get resource(){return this.$Yb}set resource(J){this.$Yb=J}get scope(){return this.Fle}set scope(J){this.Fle=J}get silentLogin(){return this.Tme}set silentLogin(J){this.Tme=J}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(J){switch(J){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,Na){switch(J){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,Na){J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(e.a)(Xf,"TokenParameters",null,[782]);class og{constructor(J,Na){this.Ojb=Na;this.hz=J}get roamingSettings(){return null}getAccessToken(J){const Na=this.Ojb.getOsfControl(this.hz),Eb=Na.getManifest(),gc=Eb.getMarketplaceID();this.DPa(J,gc);return OfficeExtension.WacRuntime.Utility.createPromise((vc,Qc)=>{Na.isFirstParty()&&this.Ojb._enableFirstPartySSO?this.ori(Eb,J)?Gd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(J,
gc).then(hd=>{vc(hd)},hd=>{Qc(hd)}):Qc(ae.a.$Xc):Qc(ae.a.apiNotAvailable)}).then(vc=>{let Qc;switch(vc.authority){case Ld.a.VNf:Qc=1;break;default:Qc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Ef(vc.accessToken,Qc))},vc=>{this.logErrorResponse(J,gc,vc);return vc?OfficeExtension.WacRuntime.Utility.createPromise((Qc,hd)=>{hd(OfficeExtension.WacRuntime.Utility.createRichApiException(vc,Le.qec(vc)))}):OfficeExtension.WacRuntime.Utility.createPromise((Qc,hd)=>{hd(OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.generalException,
Le.qec(ae.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const J=this.Ojb.getOsfControl(this.hz);J.getManifest();const Na=J.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((Eb,gc)=>{Gd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Na).then(vc=>{Eb(vc)},vc=>{gc(vc.toString())})}).then(Eb=>{Eb=Fe.Phh(Eb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Eb)},Eb=>Eb?OfficeExtension.WacRuntime.Utility.createPromise((gc,
vc)=>{vc(OfficeExtension.WacRuntime.Utility.createRichApiException(Eb,Le.qec(Eb)))}):OfficeExtension.WacRuntime.Utility.createPromise((gc,vc)=>{vc(OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.generalException,Le.qec(ae.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(J){switch(J){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){switch(J){case 1:return this.GSh(Na);case 3:return this.ZTh();case 2:return this.r5h()}J=this.invokeMethod(J,
Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}GSh(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,Xf);return this.getAccessToken(J)}ZTh(){return this.getAuthContext()}r5h(){return this.getPrimaryIdentityInfo()}ori(J,Na){let Eb=!1;const gc=J.getWebApplicationAuthorizations();J=null;for(const vc of gc)if(vc.getResource().toLowerCase()===Na.resource.toLowerCase()){J=vc;Eb=!0;break}if(!Eb)return!1;Na=Na.scope.split(" ,+");for(const vc of Na)if(vc&&vc.length){Na=
!1;for(const Qc of J.getScopes())vc.toLowerCase()===Qc.toLowerCase()&&(Na=!0);if(!Na)return!1}return!0}DPa(J,Na){J=this.QBf(J.resource);u.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Na,["resource"]:J})}logErrorResponse(J,Na,Eb){J=this.QBf(J.resource);u.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Na,["resource"]:J,["error"]:Eb})}QBf(J){return J.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(e.a)(og,"AuthenticationService",null,[]);class pf{create(J,
Na){return new og(J,Na)}}Object(e.a)(pf,"AuthenticationServiceFactory",null,[]);var jg=a(159),bg=a(876),zg=a(1001),Zg=a(983);class fg{}fg.generalException="generalException";fg.invalidArgument="invalidArgument";fg.notAllowed="notAllowed";fg.apiNotAvailable="apiNotAvailable";fg.unresolvedPendingRequest="unresolvedPendingRequest";fg.timeout="timeout";fg.adalTimeout="adalTimeout";fg.userNotSignedIn="userNotSignedIn";fg.userAborted="userAborted";fg.silentSignInFailed="silentSignInFailed";fg.invalidResourceUrl=
"invalidResourceUrl";fg.invalidGrant="invalidGrant";fg.connectionLost="connectionLost";fg.clientError="clientError";fg.serverError="serverError";Object(e.a)(fg,"WopiHostErrorCodes",null,[]);var Sg=a(566);class rh{}Object(e.a)(rh,"OAuthCallerMetadata",null,[]);var hh=a(29);class vf{constructor(J){this.oza=J;this.fAg=k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}jLg(J,Na,Eb,gc,vc,Qc){if(!this.oza)return gc=new zg.a,gc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,
Promise.resolve(gc);const hd=new rh;hd.AddinName=vc;hd.AddinTrustId=Qc;let nd=-1;Qc=null;if(gc&&this.Jmf())Qc=this.oza.Fkg(qe.a.BEc,J,gc,vf.i9e(vc),hd);else{const Cd=Date.now();Qc=this.oza.JL(qe.a.BEc,J,hd).then(Sd=>{nd=Date.now()-Cd;const Je=(Na||Eb)&&"login_required"===Sd.ErrorCode;return(Na&&("interaction_required"===Sd.ErrorCode||"consent_required"===Sd.ErrorCode||"invalid_grant"===Sd.ErrorCode)||Je)&&this.Jmf()?this.oza.Fkg(qe.a.BEc,J,null,vf.i9e(vc),hd):Promise.resolve(Sd)})}return Qc.then(Cd=>
{const Sd=new zg.a;Cd.IsSuccess?(Sd.token=Cd.Token,Cd.Telemetry&&(Sd.mVa=Cd.Telemetry.fromCache,Sd.expiresOn=Cd.Telemetry.expiresOn)):(Sd.errorCode=this.cMi(Cd),Sd.t_d=this.t9i(Cd));return Sd}).catch(()=>{const Cd=new zg.a;Cd.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Cd)}).then(Cd=>{Cd.oia="OauthManager";0<=nd&&(Cd.tzb=nd);return Cd})}Qti(J){const Na=(k.AFrameworkApplication.fa.Wa(k.AFrameworkApplication.h9)||"").toLowerCase();return(hh.a.Gya||"teams"===
Na&&Sg.OAuthManagerSettings.CAb)&&!vf.vti(J)||!this.oza||!this.oza.V7a()?!1:!0}Jmf(){return this.fAg||1!==Zg.a.Ddc()}cMi(J){switch(J.ErrorCode){case "UserCancelled":case "interaction_required":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":J=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":J=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:J=J.ErrorCode===fg.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:J.ErrorCode===fg.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:J.ErrorCode===fg.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:
J.ErrorCode===fg.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:J.ErrorCode===fg.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return J}t9i(J){let Na="";(J=RegExp("AADSTS(\\d+)").exec(J.ErrorMessage))&&1<J.length&&(Na=J[1]);return Na}static i9e(J){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,J)}static vti(J){if(!J)return!1;J=J.toLowerCase();for(const Na of bg.AppsForOfficeSingleSignOnManager.X_e)if(Na===
J)return!0;return!1}}Object(e.a)(vf,"AppsforOfficeTokenFromOauthManager",null,[188]);class Uf{constructor(J){this.kLi=J}static kqa(){if(k.AFrameworkApplication.fa.ra("AppForOfficeSSOV2IsEnabled")){var J=null;try{J=Gd.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Na){u.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Na)}J=new vf(J);Uf.Ma=new Uf(J)}}static getInstance(){Uf.Kce||(Uf.kqa(),Uf.Kce=!0);return Uf.Ma}}Uf.Ma=null;Uf.Kce=!1;Object(e.a)(Uf,"AppsForOfficeOauthManagerFactory",
null,[163]);var ff=a(1365),Of=a(143);class Wf{constructor(J,Na,Eb,gc){this.menuItemId=J;this.eE=Na;this.sVj=Eb;this.QKh=gc}}Object(e.a)(Wf,"NewDocumentParameters",null,[]);const hg=J=>{var Na=J.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Eb=Na.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Eb.addParameter("shortcuts","String[]",1,null,0);Na.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",
0);Eb=Na.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Eb.addParameter("shortcuts","Object",1,null,0);Na=J.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Eb=Na.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Eb.addParameter("pickerCustomizationJsonString","String",1,null,0);Na=J.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",
3,2);Eb=Na.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Eb.addParameter("appName","String",1,null,0);Eb.addParameter("target","String",1,null,0);Na=J.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Eb=Na.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Eb.addParameter("base64File","String",1,null,0);Na=J.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);Na.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Eb=Na.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Eb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Na=J.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Na.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Eb=Na.addMethod("Register",1,"Void",0,0,"Register",0);Eb.addParameter("metadata","String",1,null,0);Eb.addParameter("javascript","String",1,null,0);Na=J.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Na.addProperty("Enabled",1,"Boolean",1,!1,null,0);Na.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Na.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Na=J.addEnumType("Microsoft.Authentication.IdentityType");Na.addEnumField("OrganizationAccount",
0);Na.addEnumField("MicrosoftAccount",1);Na=J.addEnumType("Microsoft.Authentication.AuthorityType");Na.addEnumField("External",0);Na.addEnumField("Msa",1);Na.addEnumField("Aad",2);Na=J.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Na.addProperty("DisplayName",4,"String",1,!1,null,0);Na.addProperty("Email",3,"String",1,!1,null,0);Na.addProperty("FederationProvider",2,"String",1,!1,null,0);Na.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Na=J.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Na.addProperty("AppId",4,"String",1,!1,null,0);Na.addProperty("Authority",2,"String",1,!1,null,0);Na.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Na.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Na.addProperty("TenantId",6,"String",1,!1,null,0);Na.addProperty("Upn",
1,"String",1,!1,null,0);Na=J.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Na.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Eb=Na.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Eb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Na.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Na.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Na=J.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Na.addProperty("AuthChallenge",3,"String",1,!1,null,0);Na.addProperty("CorrelationId",7,"String",1,!1,null,0);Na.addProperty("Policy",4,"String",1,!1,null,0);Na.addProperty("Resource",2,"String",1,!1,null,0);Na.addProperty("Scope",
5,"String",1,!1,null,0);Na.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Na=J.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Na.addProperty("AccessToken",2,"String",1,!1,null,0);Na.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Na=J.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Na.addProperty("Id",1,"String",1,
!0,null,0);Na.addProperty("Value",2,"Object",1,!1,null,0);Na=J.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Eb=Na.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Eb.addParameter("id","String",1,null,0);Eb=Na.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Eb.addParameter("id","String",1,null,0);Na=J.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Na.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Eb=Na.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Eb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Na=J.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Na.addEnumField("Inactive",0);Na.addEnumField("Background",1);Na.addEnumField("Visible",2);Na=J.addEnumType("Microsoft.AppRuntime.Visibility");
Na.addEnumField("Hidden",1);Na.addEnumField("Visible",2);Na=J.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Na.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Eb=Na.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Eb.addParameter("jsonCreate","String",1,null,0);Eb=Na.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Eb.addParameter("jsonUpdate",
"String",1,null,0);Eb=Na.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Eb.addParameter("id","String",1,null,0);Eb=Na.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Eb.addParameter("id","String",1,null,0);Na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Na=J.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Na.addProperty("Id",2,"String",1,!0,null,0);Eb=Na.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Eb.addParameter("visibility","Boolean",1,null,0);Na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Na=J.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Na.addProperty("Enabled",3,"Boolean",1,!1,null,0);Na.addProperty("Id",2,"String",1,!0,null,0);Na.addProperty("Label",4,"String",1,!0,null,0);Eb=Na.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Eb.addParameter("enabled","Boolean",1,null,0);Na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Na=J.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Na.addMethod("GetCount",3,"Int32",1,1,"Count",0);Eb=Na.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Eb.addParameter("key","String",1,null,0);Na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Na.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Na=J.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Na.addEnumField("Unknown",0);Na.addEnumField("Basic",
1);Na.addEnumField("Premium",2);Na=J.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Eb=Na.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Eb.addParameter("feature","String",1,null,0);Eb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Eb=Na.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Eb.addParameter("feature","String",1,null,0);Eb=Na.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Eb.addParameter("feature","String",1,null,0);Eb.addParameter("fallbackValue","Boolean",1,null,0);Na.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Eb=Na.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Eb.addParameter("experienceId","String",1,null,0);Eb=Na.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Eb.addParameter("feature","String",1,null,0);Na=J.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Na.addProperty("Id",5,"String",1,!0,null,0);Na.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Na.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Na=J.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Na.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Na=J.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Na.addMethod("Disable",3,"Void",0,1,"Disable",0);Na.addMethod("Enable",2,"Void",0,1,"Enable",0);Na.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var Qf=a(187);class Tf{constructor(J,Na){this.yEg=J;this.UEg=Na}createAndOpenWorkbook(J){if(J&&
J.length>this.yEg)throw u.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",J.length),OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.invalidArgument,Qf.a.ha(1769));const Na=new Wf("blank","agave",J?"streamBase64":"streamEmpty",J);let Eb=null;return OfficeExtension.WacRuntime.Utility.createPromise((gc,vc)=>{const Qc=new Of.StandardDialog;Qc.Xb=4;Qc.Tl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,hd=>{2===hd||0===hd?vc("Cancelled"):
(Eb=window.open(""),this.UEg.create(gc,vc,Na).P2a())})}).then(gc=>{if(!gc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.generalException,Qf.a.ha(1765));try{Eb.top.location.href=gc}catch(vc){u.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",hh.a.Lo,vc),u.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Eb.location.replace(gc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},gc=>{if("Cancelled"===gc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.oHd,Qf.a.ha(1768));Eb.close();this.BYj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){switch(J){case 1:return this.zfh(Na)}J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}zfh(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.createAndOpenWorkbook(J)}BYj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.generalException,
Qf.a.ha(1765));}}Object(e.a)(Tf,"WacWorkbook",null,[]);const Yf=(J,Na)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof J+", objectId="+J+", value="+Na);return null},yg=J=>{J.add("InternalTest","PreviewExecutionMethod",Yf)};var Ig=a(261),kf=a(755),wi=a(756);class xi{constructor(J){this.pb=J}get $(){return this.pb}}Object(e.a)(xi,"RichApiPreviewExecutionContext",null,[]);var Mi=a(25),yi=a(1007),Og=a(215),ch=a(219),jh=a(115),ig=a(13);class Wg extends ch.a{constructor(J,
Na,Eb,gc,vc){super(J,"Select Data");this.Brb=null;this.fNe=Na;this.j$c=Eb;this.Sb=vc;this.callback=gc}get uc(){return"DdaBindingPrompt"}start(J,Na){let Eb="<div class='"+jh.a.Izh+" "+Ag.a.ms+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+jh.a.yH+"' /></div>";Eb=String.format(Eb,Zf.a.Jh(this.j$c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Sb.uh(this.dc,Eb);this.Brb=ig.DOMElementExtensions.getElementById(this.dc,"bindingText");
J=Na?J.U4a(Na,this.j$c.DdaBindingsMethod.BindingId):null;(null===J||void 0===J?0:J.IsValidRef)?(Na=new Mi.Range(J.Reference.FirstRow+1,J.Reference.FirstColumn+1,J.Reference.LastRow+1,J.Reference.LastColumn+1,!1,!1),this.Brb.value=J.Reference.SheetName+"!"+Na):(J=ee.h(this.$).ga,this.Brb.value=Zh.f(this.$.na)||!J.qa.ph?"":J.xja);this.initialize();this.qg()}vq(){this.S4c();this.addButton(0);this.addButton(1);super.vq()}setFocus(){ig.DOMElementExtensions.setFocus(this.Brb)}validate(){return!0}commit(){let J=
this.Brb.value.trim();const Na=J.indexOf("!");-1!==Na&&(J=this.x8h(J.substring(0,Na))+J.substr(Na));this.fNe.addBinding(this.j$c,J,0,this.callback);return!0}hua(){this.fNe.IQ.Lf(kf.a.internalError,this.callback);super.hua()}x8h(J){J=Va.a.trimStart(J.trim(),"=");return J.length?J.startsWith("'")&&J.endsWith("'")?J:bd.HelperMethods.Fac(J):""}}Object(e.a)(Wg,"DdaBindingPrompt",ch.a,[]);class ph{constructor(J){this.ea=J}Lf(J,Na){if(Na){const Eb={};Eb.Error=J;Eb.Version=this.ea.Ee;Na(Eb)}}MLa(J,Na){this.Lf(J,
Na)}IH(J,Na){this.Lf(kf.a.E1e(J.Errors[0].MessageId),Na)}Jv(J){J&&J(this.sQ())}sQ(){const J={Error:0};J.Version=this.ea.Ee;return J}}Object(e.a)(ph,"DdaErrorGenerator",null,[]);var Hg=a(258);class Ah{constructor(J,Na,Eb){this.$=J;this.IQ=Na;this.yA=Eb}rCd(J,Na){const Eb=J.DdaGoToByIdMethod.GoToType,gc=J.DdaGoToByIdMethod.SelectionMode,vc=J.DdaGoToByIdMethod.Id.toString().trim(),Qc=hd=>{const nd=this.$.ua.getItemByName(hd.SheetName);(null===nd||void 0===nd?0:nd.visible)?(ee.h(this.$).Bg(hd,null,null,
null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.IQ.Jv(Na)):this.IQ.Lf(kf.a.c6g,Na)};0===Eb?this.ZPi(vc,gc,J.DdaMethod.ControlId,Qc,Na):1===Eb?this.cQi(vc,gc,Qc,Na):this.IQ.Lf(kf.a.V4j,Na)}ZPi(J,Na,Eb,gc,vc){this.yA.ddaGetBinding(Eb,J,Qc=>{if(!Hg.a(Qc)&&Qc.Result&&Qc.Result.Reference){Qc=Qc.Result;var hd={};hd.SheetName=Qc.Reference.SheetName;hd.FirstRow=Qc.Reference.FirstRow;hd.FirstColumn=Qc.Reference.FirstColumn;hd.LastRow=Qc.Reference.LastRow;hd.LastColumn=Qc.Reference.LastColumn;
Ah.V_c(hd,Na);1!==Qc.BindingType?gc(hd):this.yA.ddaGetBindingData(Eb,J,1,0,2,0,0,-1,-1,nd=>{Hg.a(nd)||!nd.Result?this.IQ.IH(nd,vc):(nd=nd.Result,2!==Na&&(hd.FirstRow-=nd.Headers.length,0>hd.FirstRow&&(hd.FirstRow=0)),gc(hd))},vc)}else this.IQ.MLa(kf.a.Beg,vc)},vc)}cQi(J,Na,Eb,gc){var vc=Jh.A(J);vc?(vc=Jh.v(vc,this.$),Ah.V_c(vc,Na),Eb(vc)):this.$.ea.isNamedObjectViewMode&&this.$.Hb.Ik(J)?this.$.Hb.na=this.$.Hb.getItemByName(J):(vc=Qc=>{Hg.a(Qc)||!Qc.Result?this.$.ua.contains(J)?(Qc={},Qc.SheetName=
J,Qc.FirstRow=0,Qc.FirstColumn=0,Qc.LastRow=0,Qc.LastColumn=0,Eb(Qc)):this.IQ.MLa(kf.a.Beg,gc):(Qc=Qc.Result,Ah.V_c(Qc,Na),Eb(Qc))},this.$.ua.na?this.yA.parseRangeForGoto(J,this.$.ua.na.name,vc,gc):this.yA.parseRange(J,vc,gc))}static V_c(J,Na){J.LastRow=2===Na?J.FirstRow:J.LastRow;J.LastColumn=2===Na?J.FirstColumn:J.LastColumn}}Object(e.a)(Ah,"DdaNavigator",null,[]);const bi=(J,Na,Eb,gc,vc,Qc)=>{const hd=J.Oa(1);hd.request=Na;return Vg.g(J,"ExecuteRichApiRequest",hd,Eb,gc,vc,Qc,0)};var lj=a(306),
bj;(function(J){J[J.unsupported=0]="unsupported";J[J.surface=1]="surface";J[J.combo=2]="combo";J[J.column=3]="column";J[J.column3D=4]="column3D";J[J.bar=5]="bar";J[J.bar3D=6]="bar3D";J[J.line=7]="line";J[J.line3D=8]="line3D";J[J.pie=9]="pie";J[J.pie3D=10]="pie3D";J[J.scatter=11]="scatter";J[J.bubble=12]="bubble";J[J.area=13]="area";J[J.area3D=14]="area3D";J[J.doughnut=15]="doughnut";J[J.radar=16]="radar";J[J.stock=17]="stock";J[J.waterfall=18]="waterfall";J[J.funnel=19]="funnel";J[J.treemap=20]="treemap";
J[J.sunburst=21]="sunburst";J[J.boxWhisker=22]="boxWhisker";J[J.histogram=23]="histogram";J[J.pareto=24]="pareto";J[J.regionMap=25]="regionMap";J[J.noVisibleSeries=26]="noVisibleSeries";J[J.complexDataSource=27]="complexDataSource";J[J.pivotChart=28]="pivotChart"})(bj||(bj={}));Object(e.b)("ChartCategory",bj);class mj{constructor(J,Na){this.source=J;this.eventId=Na}}Object(e.a)(mj,"MacroRecorderEventData",null,[]);class yh{constructor(J,Na,Eb){this.parentName=J;this.$=Na;this.request=Eb}O6h(J){var Na;
if(void 0===J||null===J||void 0===J.RequestBody||null===J.RequestBody)return null;const Eb=JSON.parse(J.RequestBody);if(void 0!==J.ActiveChartId&&null!==J.ActiveChartId){Eb.ActiveChartId=J.ActiveChartId;const gc=ee.h(this.$).ga.Ra.oc;if(null===(Na=null===gc||void 0===gc?void 0:gc.floatingObject)||void 0===Na?0:Na.jd)Eb.ActiveChartType=bj[gc.floatingObject.jd.ChartCategory]}void 0!==J.SheetMultiRange&&null!==J.SheetMultiRange&&(Eb.SheetName=J.SheetMultiRange.SheetName);return Eb}$6h(J){if(void 0===
J||null===J||void 0===J.Result||null===J.Result)return null;J=J.Result;return void 0===J.ResponseBody||null===J.ResponseBody||J.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(J.ResponseBody.join(""))}Cyi(J){return!!J&&!(void 0===J.eventId||null===J.eventId)&&0<J.eventId.length}nk(J){return()=>{if(this.$.Qca){const Na=this.n2g(this.request);if(this.Cyi(Na)){const Eb=this.O6h(this.request),gc=this.$6h(J);if(Eb&&!gi.a.isEmpty(Eb)&&gc&&!gi.a.isEmpty(gc))return u.ULS.sendTraceTag(537163164,0,
50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Q(Na,Eb,gc);u.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Eb?"(not null)":"(null)"}; responseInfo: ${gc?"(not null)":"(null)"}`}`)}}return new Q(null,null,null)}}n2g(J){const Na=this.Dyi(J.SolutionId),Eb=yh.u6h(J);if(Eb&&Na)return u.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Eb,["request.SolutionId"]:J.SolutionId})}`),
new mj(J.SolutionId,Eb);J=JSON.stringify({["recorderEventId"]:Eb,["isRecorderAwareAddin"]:Na,["request.SolutionId"]:J.SolutionId});u.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${J}`);return null}Dyi(J){if(!J)return!1;J=J.toLowerCase();return yh.zbi().contains(J)}static zbi(){yh.gBa||(yh.gBa=new w.a(I.a.$h()),yh.gBa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),yh.gBa.add("fa000000005"),yh.gBa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),yh.gBa.add("fa000000014"),yh.gBa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return yh.gBa}static u6h(J){let Na=null;var Eb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Eb.test(J.RequestBody))Na=Eb.exec(J.RequestBody)[1];else{J=J.RequestHeaders;if(!J)return Na;Eb=ie.a.PSi.toLowerCase();for(let gc=0;gc<J.length;gc++)if(J[gc].Name.toLowerCase()===Eb){Na=J[gc].Value;break}}return Na}}yh.gBa=null;Object(e.a)(yh,"DdaRichApiRequestRecorder",null,[]);class nj extends lj.a{constructor(J,Na,Eb,gc,vc,Qc,hd,nd){super(10,0,Na,nd);this.pob=Eb;this.Hkb=
gc;this.v4=vc;this.eHa=Qc;this.request=hd;this.ZQd=new yh("10",J,hd)}get fHc(){return this.eHa}get gu(){return this.pob}get Oba(){return this.Hkb}O3(J){return super.O3(J)||this.Z4g(J)}nk(){return this.ZQd.nk(this.Cd)}ehb(){const J={OperationType:3};J.RichApiRequest=this.request;return J}Z4g(J){return(Na,Eb,gc)=>bi(J,this.request,cg.b(Na,this.pob),cg.a(Eb,this.Hkb),gc,this.v4)}}Object(e.a)(nj,"DdaRichApiRequestBatchOperation",lj.a,[]);class oj extends Mh.a{constructor(J,Na,Eb,gc){super(576,0,Eb,gc);
this.ZQd=new yh("576",J,Na)}nk(){return this.ZQd.nk(this.Cd)}}Object(e.a)(oj,"DdaRichApiRequestOperation",Mh.a,[]);class pj{constructor(J,Na){this.EI=(Eb,gc)=>{this.IQ.MLa(kf.a.internalError,gc)};this.$=J;this.IQ=Na}ddaAddBinding(J,Na,Eb,gc,vc,Qc,hd){this.pK((nd,Cd,Sd)=>{var Je=this.$.pa.va,Te=this.Rka();nd=cg.b(nd,Qc);Cd=cg.a(Cd,this.EI);const wf=Je.Oa(9);wf.controlId=J;wf.bindingId=Na;wf.bindingType=Eb;wf.currentSheetName=Te;wf.formula=gc;wf.options=vc;return Vg.g(Je,"DdaAddBinding",wf,nd,Cd,Sd,
hd,0)},hd,563)}ddaReleaseBinding(J,Na,Eb,gc){this.pK((vc,Qc,hd)=>{var nd=this.$.pa.va;vc=cg.b(vc,Eb);Qc=cg.a(Qc,this.EI);const Cd=nd.Oa(9);Cd.controlId=J;Cd.bindingId=Na;return Vg.g(nd,"DdaReleaseBinding",Cd,vc,Qc,hd,gc,0)},gc,564)}ddaGetBinding(J,Na,Eb,gc){this.pK((vc,Qc,hd)=>{var nd=this.$.pa.va;vc=cg.b(vc,Eb);Qc=cg.a(Qc,this.EI);const Cd=nd.Oa(1);Cd.controlId=J;Cd.bindingId=Na;return Vg.g(nd,"DdaGetBinding",Cd,vc,Qc,hd,gc,0)},gc,565,16)}ddaGetAllBindings(J,Na,Eb){this.pK((gc,vc,Qc)=>{var hd=this.$.pa.va;
gc=cg.b(gc,Na);vc=cg.a(vc,this.EI);const nd=hd.Oa(1);nd.controlId=J;return Vg.g(hd,"DdaGetAllBindings",nd,gc,vc,Qc,Eb,0)},Eb,566,16)}ddaGetBindingData(J,Na,Eb,gc,vc,Qc,hd,nd,Cd,Sd,Je){this.pK((Te,wf,Lg)=>{var sg=this.$.pa.va,dg=this.Rka();Te=cg.b(Te,Sd);wf=cg.a(wf,this.EI);const gg=sg.Oa(1);gg.controlId=J;gg.bindingId=Na;gg.coerceType=Eb;gg.valueFormat=gc;gg.filterType=vc;gg.startRow=Qc;gg.startCol=hd;gg.rowCount=nd;gg.colCount=Cd;gg.currentSheetName=dg;return Vg.g(sg,"DdaGetBindingData",gg,Te,wf,
Lg,Je,0)},Je,567,16)}ddaSetBindingData(J,Na,Eb,gc,vc,Qc,hd){this.pK((nd,Cd,Sd)=>{var Je=this.$.pa.va,Te=this.Rka();nd=cg.b(nd,Qc);Cd=cg.a(Cd,this.EI);const wf=Je.Oa(9);wf.controlId=J;wf.bindingId=Na;wf.startRow=Eb;wf.startCol=gc;wf.currentSheetName=Te;wf.bindingData=vc;return Vg.g(Je,"DdaSetBindingData",wf,nd,Cd,Sd,hd,0)},hd,568)}ddaGetSelectedData(J,Na,Eb,gc,vc,Qc,hd){this.pK((nd,Cd,Sd)=>{var Je=this.$.pa.va,Te=this.Rka();nd=cg.b(nd,Qc);Cd=cg.a(Cd,this.EI);const wf=Je.Oa(1);wf.controlId=J;wf.coerceType=
Na;wf.valueFormat=Eb;wf.filterType=gc;wf.currentSheetName=Te;wf.formula=vc;return Vg.g(Je,"DdaGetSelectedData",wf,nd,Cd,Sd,hd,0)},hd,569,16)}ddaSetSelectedData(J,Na,Eb,gc,vc){this.pK((Qc,hd,nd)=>{var Cd=this.$.pa.va,Sd=this.Rka();Qc=cg.b(Qc,gc);hd=cg.a(hd,this.EI);const Je=Cd.Oa(9);Je.controlId=J;Je.currentSheetName=Sd;Je.formula=Na;Je.bindingData=Eb;return Vg.g(Cd,"DdaSetSelectedData",Je,Qc,hd,nd,vc,0)},vc,570)}ddaLoadSettings(J,Na,Eb){this.pK((gc,vc,Qc)=>{var hd=this.$.pa.va;gc=cg.b(gc,Na);vc=cg.a(vc,
this.EI);const nd=hd.Oa(1);nd.controlId=J;return Vg.g(hd,"DdaLoadSettings",nd,gc,vc,Qc,Eb,0)},Eb,501,16)}ddaSaveSettings(J,Na,Eb,gc,vc){this.pK((Qc,hd,nd)=>{var Cd=this.$.pa.va;Qc=cg.b(Qc,gc);hd=cg.a(hd,this.EI);const Sd=Cd.Oa(9);Sd.controlId=J;Sd.settings=Na;Sd.overwriteIfStale=Eb;return Vg.g(Cd,"DdaSaveSettings",Sd,Qc,hd,nd,vc,0)},vc,571)}ddaAddRowsColumns(J,Na,Eb,gc,vc,Qc){this.pK((hd,nd,Cd)=>{var Sd=this.$.pa.va,Je=this.Rka();hd=cg.b(hd,vc);nd=cg.a(nd,this.EI);const Te=Sd.Oa(9);Te.controlId=J;
Te.bindingId=Na;Te.isRow=Eb;Te.currentSheetName=Je;Te.bindingData=gc;return Vg.g(Sd,"DdaAddRowsColumns",Te,hd,nd,Cd,Qc,0)},Qc,572)}ddaDeleteAllDataValues(J,Na,Eb,gc){this.pK((vc,Qc,hd)=>{var nd=this.$.pa.va,Cd=this.Rka();vc=cg.b(vc,Eb);Qc=cg.a(Qc,this.EI);const Sd=nd.Oa(9);Sd.controlId=J;Sd.bindingId=Na;Sd.currentSheetName=Cd;return Vg.g(nd,"DdaDeleteAllDataValues",Sd,vc,Qc,hd,gc,0)},gc,573)}ddaClearBindingFormats(J,Na,Eb,gc){this.pK((vc,Qc,hd)=>{var nd=this.$.pa.va,Cd=this.Rka();vc=cg.b(vc,Eb);Qc=
cg.a(Qc,this.EI);const Sd=nd.Oa(9);Sd.controlId=J;Sd.bindingId=Na;Sd.currentSheetName=Cd;return Vg.g(nd,"DdaClearBindingFormats",Sd,vc,Qc,hd,gc,0)},gc,574)}ddaSetBindingFormats(J,Na,Eb,gc,vc,Qc){this.pK((hd,nd,Cd)=>{var Sd=this.$.pa.va,Je=this.Rka();hd=cg.b(hd,vc);nd=cg.a(nd,this.EI);const Te=Sd.Oa(9);Te.controlId=J;Te.bindingId=Na;Te.currentSheetName=Je;Te.bindingData=Eb;Te.isSetFormats=gc;return Vg.g(Sd,"DdaSetBindingFormats",Te,hd,nd,Cd,Qc,0)},Qc,575)}parseRange(J,Na,Eb){this.pK((gc,vc,Qc)=>{const hd=
this.$.pa.va.ic();return Vg.v(this.$.pa.va,J,-1,cg.b(gc,Na),cg.a(vc,this.EI),Qc,Eb,hd)},Eb,162,16)}parseRangeForGoto(J,Na,Eb,gc){this.pK((vc,Qc,hd)=>{const nd=this.$.pa.va.ic();return Vg.w(this.$.pa.va,J,Na,cg.b(vc,Eb),cg.a(Qc,this.EI),hd,gc,nd)},gc,562,16)}executeRichApiRequest(J,Na,Eb){y.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(J.RequestFlags&=8191);if(y.EwaSettings.ya(233))this.WIh(this.$.pa.va.ic(),Na,()=>{this.IQ.MLa(kf.a.internalError,Eb)},Eb,J);
else{let gc=Pg.DdaFacade.ukd(J);!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.ub.$w||gc&16?(gc|=64,this.$.userOperationManager.pF(new oj(this.$,J,(vc,Qc,hd)=>bi(this.$.pa.va,J,cg.b(vc,Na),cg.a(Qc,this.EI),hd,Eb),gc))):(this.IQ.MLa(kf.a.kIc,Eb),u.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}Rka(){return this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.activeItemName}pK(J,Na,Eb,gc=0){!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.ub.$w||gc&16?this.$.userOperationManager.pF(new Mh.a(Eb,0,J,gc|64)):(this.IQ.MLa(kf.a.kIc,Na),u.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}WIh(J,Na,Eb,gc,vc){let Qc=Pg.DdaFacade.ukd(vc);if(!y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.ub.$w||Qc&16){var hd=this.$.Rb.Qc("UserAction","Rich Api request");this.$.userOperationManager.Tc(new nj(this.$,J,Na,Eb,gc,hd,vc,Qc|64),null)}else this.IQ.MLa(kf.a.kIc,gc),u.ULS.sendTraceTag(537163158,
0,50,"Write operation is not allowed")}}Object(e.a)(pj,"DdaWebServiceHelper",null,[]);class qj{constructor(J,Na,Eb,gc){this.EKh=J;this.fileSize=Na;this.MRj=gc}}Object(e.a)(qj,"DocumentFile",null,[]);class Kh{}Kh.generalException="GeneralException";Kh.zVg="ApiNotFound";Kh.oHd="OperationCancelled";Kh.invalidArgument="InvalidArgument";Object(e.a)(Kh,"ErrorCodes",null,[]);class hj{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(e.a)(hj,"WacApiDelegates",null,[]);var Ej=a(630);class cj extends hj{constructor(J,Na){super();this.Dpf=(Eb,gc)=>{Eb=cj.Tdh(Eb,gc);if(!Ej.a(this.$,Eb))return!0;Eb=this.$.shortcutKeyManager.E$e(Eb);return!!Eb&&0<Eb.length};this.addinId=J;this.$=Na}replaceShortcuts(J){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,J,this.Dpf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(J){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(J,
this.Dpf)}static uih(J,Na){const Eb=document.createEvent("KeyboardEvent");if(hh.a.NF)Eb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(J&8),!!(J&32),!!(J&4),!!(J&256));else{const gc=[];J&4&&gc.push("Shift");J&8&&gc.push("Control");J&32&&gc.push("Alt");Eb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,gc.join(" "),!1,"en-US")}J=new Sys.UI.DomEvent(Eb);J.keyCode=Na;return J}static Tdh(J,Na){if(hh.a.Nf)switch(Na){case 189:Na=173;break;case 187:Na=61;break;case 186:Na=59}return cj.uih(J,
Na)}}Object(e.a)(cj,"ExcelWacApiDelegates",hj,[]);class Eh{constructor(J){this.zKa={};this.XMi=J}QMg(J,Na){this.Ogc(J)||(this.zKa[J]={});if(this.uti(J))return u.ULS.sendTraceTag(537163157,344,50,`App ${J} has reach the limit of number of cached files.`),kf.a.ENi;this.zKa[J][Na.EKh.toString()]=Na;return kf.a.success}JYh(J,Na){let Eb=null;this.Ogc(J)&&(Eb=this.zKa[J][Na.toString()]);Eb||u.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${J}, fileHandler:${Na}] doesn't exist`);return Eb}Ogc(J){return J in
this.zKa}enj(J,Na){if(this.Ogc(J)){const Eb=this.zKa[J];delete Eb[Na.toString()];1>Object.keys(Eb).length&&delete this.zKa[J];return Na.toString()in Eb?kf.a.internalError:kf.a.success}return kf.a.internalError}uti(J){return this.Ogc(J)?Object.keys(this.zKa[J]).length>=this.XMi:!1}static getInstance(J){return J.da.Aa(200)||J.da.Ha(200,new Eh(Eh.YMi))}static JQi(){return++Eh.j4g}}Eh.xMi=4194304;Eh.YMi=1;Eh.j4g=0;Object(e.a)(Eh,"GetFileApiHelper",null,[]);class rj{constructor(J){this.hz=J}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.hz)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){switch(J){case 1:return this.pRi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){J=this.invokeMethod(J,
Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}pRi(){this.notifyActionHandlerReady();return null}}Object(e.a)(rj,"AddinInternalService",null,[]);class sj{constructor(J,Na){this.LG=Na;this.hz=J}getAppRuntimeState(){return this.LG.getAppRuntimeState(this.hz)?2:1}setAppRuntimeState(J){switch(J){case 2:J=!0;break;case 1:J=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.invalidArgument,Qf.a.ha(1769));}this.LG.setAppRuntimeState(this.hz,J)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,Na){switch(J){case 2:return this.NTh();case 1:return this.bDj(Na)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,
Na){J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}NTh(){return this.getAppRuntimeState()}bDj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"int");this.setAppRuntimeState(J);return null}}Object(e.a)(sj,"AppRuntimeService",null,[]);var ij=a(1008);class tj{constructor(J,Na,Eb,gc){this.Mx=J;this.s2=Eb;this.dz=gc.Jg.getOsfControl(Na)}disable(){try{if(!Qf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.PJe();
if(!this.Yof())return this.QJe();this.s2.Y3j(this.Mx)}catch(J){return u.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",J.message||"Unknown"),this.NJe()}return null}enable(){try{if(!Qf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.PJe();if(!this.Yof())return this.QJe();this.s2.$kj(this.Mx)}catch(J){return u.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
J.message||"Unknown"),this.NJe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,
Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){switch(J){case 1:return this.eEa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){switch(J){case 3:return this.rrh();case 2:return this.jwh()}J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}rrh(){return this.disable()}jwh(){return this.enable()}eEa(){this._OnAccess();return null}PJe(){return ij.a(ae.a.notImplemented,
Qf.a.ha(1770))}QJe(){return ij.a(ae.a.sharedRuntimeNotAvailable,Qf.a.ha(1774))}NJe(){return ij.a(ae.a.generalException,Qf.a.ha(1765))}Yof(){const J=this.dz.getSharedRuntimeId();return!!J&&0<J.length}}Object(e.a)(tj,"BeforeDocumentCloseNotification",null,[]);class uj{constructor(){this.une=this.zhe=this.vo=!1}get enabled(){return this.vo}set enabled(J){this.vo=J}get nativeRuntime(){return this.zhe}set nativeRuntime(J){this.zhe=J}get streamingEnabled(){return this.une}set streamingEnabled(J){this.une=
J}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(J){switch(J){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J,Na){switch(J){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Na,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,Na){J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}}Object(e.a)(uj,"CustomFunctionEngineStatus",null,[]);class vj{constructor(J,Na,Eb){this.ICg=J;this.JCg=Na;this.GGg=Eb}get status(){const J=new uj;J.enabled=this.ICg;J.streamingEnabled=this.JCg;J.nativeRuntime=!1;return J}register(J){return OfficeExtension.WacRuntime.Utility.createPromise(this.GGg(J))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(J){switch(J){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){switch(J){case 1:return this.Rlj(Na)}J=this.invokeMethod(J,
Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}Rlj(J){const Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"string");return this.register(Na,J)}}Object(e.a)(vj,"CustomFunctionManager",null,[]);var Fj=a(982);class wj{constructor(J,Na,Eb,gc){this.o8d="";this.CVb=0;this.sP=J;this._id=Na;this.hz=Eb;this.LG=gc}get id(){return this._id}_RegisterStateChange(){this.CVb||this.sP.execute(J=>
{this.o8d=J.kBa(this._id,Na=>{this.LG.LMh(this.hz,this._id,JSON.stringify(Na))})});this.CVb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.CVb--;this.CVb||this.sP.execute(J=>{J.uNd(this._id,this.o8d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(J){switch(J){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){switch(J){case 6:return this.fwg();case 7:return this.hwg()}J=
this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}fwg(){return this._RegisterStateChange()}hwg(){return this._UnregisterStateChange()}}Object(e.a)(wj,"LicenseFeature",null,[]);class xj{constructor(J,Na){this.sP=Gd.a.instance.$b("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.hz=J;this.LG=Na;this.xFg=this.LG.Jg.getOsfControl(this.hz)}getFeatureTier(J,Na){return OfficeExtension.WacRuntime.Utility.createPromise(Eb=>{const gc=1===Na?1:2===
Na?2:0;this.sP.execute(vc=>{vc.getFeatureTier(J,gc).then(Qc=>{Eb(this.d2h(Qc))},()=>{Eb(Na)})})})}getLicenseFeature(J){J=new wj(this.sP,J,this.hz,this.LG);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}isFeatureEnabled(J,Na){return OfficeExtension.WacRuntime.Utility.createPromise(Eb=>{this.sP.execute(gc=>{gc.isFeatureEnabled(J,Na).then(vc=>{Eb(vc)},()=>{Eb(Na)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(J=>{this.sP.execute(Na=>{Na=
Na.isFreemiumUpsellEnabled();J(Na)})})}launchUpsellExperience(J){if(this.xFg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.sP.execute(Na=>{Na.launchUpsellExperience(J)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.$Xc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J,Na){switch(J){case 6:return this.gwg(Na)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){switch(J){case 2:return this.DZh(Na);case 5:return this.c2h(Na);
case 1:return this.gui(Na);case 3:return this.Sui();case 4:return this.TEi(Na)}J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}DZh(J){const Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"int");return this.getFeatureTier(Na,J)}c2h(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getLicenseFeature(J)}gui(J){const Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,
0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"boolean");return this.isFeatureEnabled(Na,J)}Sui(){return this.isFreemiumUpsellEnabled()}TEi(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.launchUpsellExperience(J)}gwg(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");this._TestFireStateChangedEvent(J);return null}d2h(J){switch(J){case 1:return 1;case 2:return 2;default:return 0}}}Object(e.a)(xj,"License",
null,[]);var Gj=a(168);const Hj=(J,Na,Eb)=>gc=>(vc,Qc)=>{Mb.TaskExtensions.za(Gc.GetServiceTaskFactory.create(Na.da,279,Na.ka,1),hd=>{hd=hd.result;let nd=!1;var Cd=Eb.Jg.getOsfControl(J);let Sd=null;Cd&&(Sd=Cd.getStoreType(),(Cd=Cd.getManifest())&&Cd.getSharedRuntimeForCustomFunctions("Workbook")&&(nd=!0));Mb.TaskExtensions.za(hd.vif(J,Sd,gc,nd),Je=>{Gj.b(Je)?Je.result?vc(null):Qc(OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.invalidArgument,Gf.a.instance.ha(1769))):Qc(OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.generalException,
Gf.a.instance.ha(1765)))},Na.ka,3)},Na.ka,3)};class yj{constructor(J){if(!J)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.CAd=J}areShortcutsInUse(J){return OfficeExtension.WacRuntime.Utility.createPromise((Na,Eb)=>{this.CAd.checkShortcutsInUse(J).then(gc=>{Na(gc)}).catch(gc=>{Eb(gc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((J,Na)=>{this.CAd.getShortcuts().then(Eb=>{J(Eb)}).catch(Eb=>{Na(Eb)})})}replaceShortcuts(J){return OfficeExtension.WacRuntime.Utility.createPromise((Na,
Eb)=>{this.CAd.replaceShortcuts(J).then(()=>{Na(null)}).catch(gc=>{Eb(gc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,Na){switch(J){case 3:return this.rXg(Na);case 1:return this.C8h();case 2:return this.zsj(Na)}J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}rXg(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"Array<string>");return this.areShortcutsInUse(J)}C8h(){return this.getShortcuts()}zsj(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"any");return this.replaceShortcuts(J)}}Object(e.a)(yj,"ActionService",
null,[]);var Ij=a(790),zj=a(527);class vi{constructor(J,Na,Eb){this.MSc=this.Ebe=null;this.zUb=J;this.Nie=Na;if(this.$a=Eb)this.Ebe=this.$a.Wa("GetAccessTokenOAuthFirstPartyAllowList")}S3h(){this.MSc||(this.MSc=zj.a.wq(Gd.a.instance.$b("Common.App.OAuth.IOAuthManager")));return this.MSc}avi(J,Na){if(!this.Nie||""===this.zUb||!this.$a)return!1;const Eb=this.Nie.getOsfControl(this.zUb);if(!Eb)return!1;let gc=!1;this.Ebe.split(";").forEach(vc=>{Na===vc&&(gc=!0)});return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",
!1)&&1===k.AFrameworkApplication.sa.Pa.$i&&Eb.isFirstParty()&&J===vi.ZUg&&gc&&Kg.d(Eb.getSolutionId())===vi.aVg}getAccessTokenFirstPartyOAuth(J,Na){let Eb;Eb=this.avi(J,Na)?gc=>{const vc=this.S3h();vc.continueWith(()=>{vc.result.JL(J,Na).then(Qc=>{gc(Qc);return Qc})})}:gc=>{gc(Object.assign(new Ij.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(Eb)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokeMethodAsync(J,Na){switch(J){case 1:return this.FSh(Na)}J=this.invokeMethod(J,
Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}FSh(J){const Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,1,"string");return this.getAccessTokenFirstPartyOAuth(Na,J)}}vi.ZUg="Maker";vi.aVg="fa000000043";Object(e.a)(vi,"Auth",null,[]);class Aj{constructor(){this.Rsa=null}o8h(){this.Rsa||(this.Rsa=zj.a.wq(Gd.a.instance.$b("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Rsa}getSharedFilePickerResponse(J){return OfficeExtension.WacRuntime.Utility.createPromise((Na,
Eb)=>{try{const gc=this.o8h();Ve.Task.WAA.call(null,gc).continueWith(()=>{const vc=gc.result;if(vc){let Qc={};({Ft:Qc}=Bf.d(J)).returnValue?vc.ajd(Qc).then(hd=>{hd&&0<hd.length?Na(hd):Eb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(hd=>{Eb(hd)}):Eb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Eb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(gc){Eb(gc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertyGetAsync(J){J=this.invokePropertyGet(J);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}invokePropertySet(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);}invokePropertySetAsync(J,Na){this.invokePropertySet(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(J){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(J);
}invokeMethodAsync(J,Na){switch(J){case 1:return this.n8h(Na)}J=this.invokeMethod(J,Na);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(J)}n8h(J){J=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(J,0,"string");return this.getSharedFilePickerResponse(J)}}Object(e.a)(Aj,"SharedFilePicker",null,[]);class Bj{createInstance(J,Na,Eb="",gc=null,vc=null){switch(J){case "Microsoft.Office.ActionService":return new yj(Na);case "Microsoft.Office.SharedFilePicker":return new Aj;case "Microsoft.Office.Auth":return new vi(Eb,
gc,vc)}return null}}Object(e.a)(Bj,"WacApiHost",null,[]);class Cj{constructor(J,Na,Eb,gc,vc){this.$_b=null;this.KTb=J;this.hz=Na;this.LG=Eb;this.pb=gc;this.npe=vc}hostName(){return"ExcelOnline"}appId(){return this.KTb}createInstance(J){switch(J){case "Microsoft.Authentication.AuthenticationService":return Gd.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.hz,this.LG.Jg);case "Microsoft.Authentication.TokenParameters":return new Xf;case "Microsoft.ExcelServices.CustomFunctionManager":J=
y.EwaSettings.ya(114);var Na=y.EwaSettings.ya(115);return new vj(J,Na,Hj(this.KTb,this.pb,this.LG));case "Microsoft.AppRuntime.AppRuntimeService":return new sj(this.hz,this.LG);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return J=Ig.a(this.pb),new tj(this.KTb,this.hz,J,this.LG);case "Microsoft.DynamicRibbon.DynamicRibbon":return J=Ig.a(this.pb),new Fj.DynamicRibbon(this.KTb,this.hz,this.LG,J,J.Kn(this.hz).Hl);case "Microsoft.Office.Licensing.License":return new xj(this.hz,
this.LG);case "Microsoft.InternalService.AddinInternalService":return new rj(this.hz);default:if(this.$_b||(this.$_b=new Bj),k.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)){if(Na=this.$_b.createInstance(J,this.npe,this.hz,this.LG.Jg,k.AFrameworkApplication.fa))return Na}else if(Na=this.$_b.createInstance(J,this.npe))return Na}u.ULS.sendTraceTag(537163155,0,10,`Typename: ${J} is an invalid parameter for the RichApiHost.CreateInstance method.`);
throw OfficeExtension.WacRuntime.Utility.createRichApiException(ae.a.generalException,ae.a.generalException);}}Object(e.a)(Cj,"RichApiHost",null,[]);var Jj=a(390),Dj=a(31),Kj=a(126),jj=a(37),Lj=a(106),Mj=a(296),Nj=a(49),Oj=a(262),Pj=a(8),Qj=a(74);class Df{constructor(J,Na,Eb,gc){this.Sb=this.rangePicker=null;this.$=J;this.Gd=Na;this.Sb=gc;this.Me=new ph(J.ea);this.yA=new pj(J,this.Me);this.GAf=Eb;this.Lbc=new Map}get IQ(){return this.Me}dispose(){this.$=this.Lbc=null}Oc(){return!1}Vc(){return!1}executeCommand(J,
Na,Eb){J=Na.command;switch(J){case 451041795:this.Me.Lf(Eb[ic.a.$f],Eb[ic.a.v4]);break;case 974713501:this.kei(Eb[ic.a.$f],Eb[ic.a.v4]);break;case 1237877382:this.Me.Jv(Eb[ic.a.v4]);break;default:return xd.a(J)}return Ve.Task.Ua(!0)}Ac(J,Na,Eb){if(J=!!Eb)switch(Na.command){case 974713501:case 1237877382:case 451041795:break;default:J=!1}return J}kei(J,Na){var Eb;const gc=J.DdaMethod;"undefined"===typeof gc.DispatchId?this.Me.Lf(kf.a.internalError,Na):Df.lti(J)||this.$.Nd&1?(gc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?
(new Wg(this.$,this,J,Na,this.Sb)).start(this.Gd,J.DdaMethod.ControlId):gc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.O7h(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.KHj(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(J,this.kid(J.DdaMethod.ControlId),0,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.tUh(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?
this.mDj(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.sUh(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.dnj(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.rTh(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.xyd(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(J.DdaAddRowsColumns.IsRow=!0,this.fse(J,
Na)):gc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(J.DdaAddRowsColumns.IsRow=!1,this.fse(J,Na)):gc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.cph(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.Z8g(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(J.DdaSetBindingFormats.IsSetFormats=!0,this.C7f(J,Na)):gc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(J.DdaSetBindingFormats.IsSetFormats=!1,this.C7f(J,Na)):
gc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(J,J.DdaBindingsMethod.ItemName,J.DdaBindingsMethod.FailOnCollision?2:1,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.HZh(Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.rCd(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.GYh(J,Na):
gc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.HYh(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.fnj(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(J.DdaMethod.ControlId,J),this.Me.Jv(Na)):gc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?y.EwaSettings.ya(23)?this.Me.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Na):this.$Ni(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?y.EwaSettings.ya(23)?this.Me.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Na):this.XNi(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(J,Na):gc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(J,Na):this.Me.Lf(kf.a.sHd,Na),y.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&gc.DispatchId!==
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(J=this.Gd.oV(J.DdaMethod.ControlId),Na="",J&&(Na=Pg.DdaFacade.getSolutionId(J,this.$),Na=Telemetry.PrivacyRules.GetPrivacyCompliantId(Na,J.OwnerAddinStoreType||J.PrimaryMarketplace.MarketplaceType,null===(Eb=J.AssetMarketplace)||void 0===Eb?void 0:Eb.SolutionId,null,null,J.PrimaryMarketplace.MarketplaceRef)),u.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${gc.DispatchId}, AppID: ${Na}`))):this.Me.Lf(kf.a.kQe,Na)}tUh(J,Na){J.DdaGetBindingData.CoerceType=
Df.q6b(J.DdaGetBindingData.CoerceType);J.DdaGetBindingData.FilterType=Df.f_e(J.DdaGetBindingData.FilterType);J.DdaGetBindingData.ValueFormat=Df.$pg(J.DdaGetBindingData.ValueFormat);if(this.pmc(J.DdaGetBindingData.CoerceType,Na)){if(J.DdaGetBindingData){const Eb=J.DdaGetBindingData;0===Eb.FilterType&&(Eb.FilterType=2);Eb.StartCol|=0;Eb.StartRow|=0;Eb.ColCount=void 0===Eb.ColCount?-1:Eb.ColCount;Eb.RowCount=void 0===Eb.RowCount?-1:Eb.RowCount}this.yA.ddaGetBindingData(J.DdaMethod.ControlId,J.DdaGetBindingData.BindingId,
J.DdaGetBindingData.CoerceType,J.DdaGetBindingData.ValueFormat,J.DdaGetBindingData.FilterType,J.DdaGetBindingData.StartRow,J.DdaGetBindingData.StartCol,J.DdaGetBindingData.RowCount,J.DdaGetBindingData.ColCount,Eb=>{if(Hg.a(Eb)||!Eb.Result)this.Me.IH(Eb,Na);else{const gc=this.Me.sQ();gc.Data=Df.NAe(Eb.Result);Na(gc)}},Na)}}mDj(J,Na){J.DdaSetBindingData.CoerceType=Df.q6b(J.DdaSetBindingData.CoerceType);if(this.pmc(J.DdaSetBindingData.CoerceType,Na)){var Eb=Df.H2c(J.DdaSetBindingData.CoerceType,J.DdaSetBindingData.Data);
Df.ljc(Eb)?this.Me.Lf(kf.a.PFc,Na):(1===Eb.CoerceType&&(Eb.CellFormat||(Eb.CellFormat=J.DdaSetBindingData.CellFormat),Eb.TableOptions||(Eb.TableOptions=J.DdaSetBindingData.TableOptions)),J.DdaSetBindingData&&(J.DdaSetBindingData.StartCol|=0,J.DdaSetBindingData.StartRow|=0),this.yA.ddaSetBindingData(J.DdaMethod.ControlId,J.DdaSetBindingData.BindingId,J.DdaSetBindingData.StartRow,J.DdaSetBindingData.StartCol,Eb,gc=>{Hg.a(gc)?this.Me.IH(gc,Na):this.Me.Jv(Na)},Na))}}O7h(J,Na){J.DdaGetBindingData.CoerceType=
Df.q6b(J.DdaGetBindingData.CoerceType);J.DdaGetBindingData.ValueFormat=Df.$pg(J.DdaGetBindingData.ValueFormat);J.DdaGetBindingData.FilterType=Df.f_e(J.DdaGetBindingData.FilterType);if(this.pmc(J.DdaGetBindingData.CoerceType,Na)){var Eb=this.kid(J.DdaMethod.ControlId);Eb?this.yA.ddaGetSelectedData(J.DdaMethod.ControlId,J.DdaGetBindingData.CoerceType,J.DdaGetBindingData.ValueFormat,J.DdaGetBindingData.FilterType,Eb,gc=>{if(Hg.a(gc))this.Me.IH(gc,Na);else{const vc=this.Me.sQ();vc.Data=Df.NAe(gc.Result);
Na(vc)}},Na):this.Me.Lf(kf.a.m$e,Na)}}GYh(J,Na){const Eb=J[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],gc=J[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],vc=J.DdaMethod.ControlId,Qc=Eh.getInstance(this.$);if(0>=gc)u.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Me.Lf(kf.a.Lpi,Na);else if(gc>Eh.xMi)u.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Me.Lf(kf.a.a5e,Na);else{var hd=
null;switch(Eb){case 1:hd="Compressed";break;case 0:hd="Text";break;case 2:hd="Pdf";break;default:u.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Eb} is not supported.`);this.Me.Lf(kf.a.SZe,Na);return}if("Text"===hd)u.ULS.sendTraceTag(537163218,344,15,`Requested file type ${hd} is not supported.`),this.Me.Lf(kf.a.SZe,Na);else{y.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(J=new Sys.StringBuilder,J.append(yi.a(this.$,hd)),"Pdf"===hd&&Og.a.cl(J,
ie.a.XTf,"WholeWorkbook"),J=J.toString()):J=yi.a(this.$,hd);var nd=null,Cd=new XMLHttpRequest;Cd.onreadystatechange=()=>{if(4===Cd.readyState)if(200===Cd.status){var Sd=Cd.response;if(Sd){nd=new Uint8Array(Sd);Sd=this.Me.sQ();var Je=nd.length,Te=Eh.JQi(),wf={},Lg=0;for(let sg=0;sg<Je;sg+=gc){const dg=[],gg=sg+gc<Je?sg+gc:Je;for(let Fg=0,ah=sg;ah<gg;Fg++,ah++)dg[Fg]=nd[ah];wf[(Lg++).toString()]=dg}wf=new qj(Te,Je,gc,wf);wf=Qc.QMg(vc,wf);wf!==kf.a.success?this.Me.Lf(wf,Na):(Sd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=
Te,Sd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Je,u.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${hd}, the file size is ${Je}`),Na(Sd))}else u.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${hd}.`),this.Me.Lf(kf.a.internalError,Na)}else 500===Cd.status?this.Me.Lf(kf.a.E1e(parseInt(Cd.statusText,10)),Na):(u.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${hd}.`),
this.Me.Lf(kf.a.sQi,Na))};Cd.open("GET",J,!0);Cd.responseType="arraybuffer";Cd.setRequestHeader("If-Modified-Since","0");Cd.send(null)}}}HYh(J,Na){var Eb=J[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],gc=J[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];J=J.DdaMethod.ControlId;(Eb=Eh.getInstance(this.$).JYh(J,Eb))?(Eb=Eb.MRj,0>gc||gc>=Object.keys(Eb).length?this.Me.Lf(kf.a.nki,Na):(gc=Eb[gc.toString()],Eb=this.Me.sQ(),Eb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=
gc,Eb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=gc.length,Na(Eb))):this.Me.Lf(kf.a.internalError,Na)}fnj(J,Na){var Eb=J[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];J=J.DdaMethod.ControlId;Eb=Eh.getInstance(this.$).enj(J,Eb);Eb===kf.a.success?this.Me.Jv(Na):this.Me.Lf(Eb,Na)}KHj(J,Na){J.DdaSetBindingData.CoerceType=Df.q6b(J.DdaSetBindingData.CoerceType);if(this.pmc(J.DdaSetBindingData.CoerceType,Na)){var Eb=this.kid(J.DdaMethod.ControlId);if(Eb){var gc=Df.H2c(J.DdaSetBindingData.CoerceType,
J.DdaSetBindingData.Data),vc=ee.h(this.$).ga;1===gc.CoerceType&&(!gc.Data&&vc.qa.Q_&&(gc.Headers||(gc.Headers=[]),gc.Headers.length||gc.Headers.push([]),gc.Headers[0].length||gc.Headers[0].push("")),Df.ljc(gc)||(gc.CellFormat||(gc.CellFormat=J.DdaSetBindingData.CellFormat),gc.TableOptions||(gc.TableOptions=J.DdaSetBindingData.TableOptions)));if(Df.ljc(gc))this.Me.Lf(kf.a.PFc,Na);else{var Qc=vc.qa.gd.clone(),hd=vc.qa.activeCell.clone();this.yA.ddaSetSelectedData(J.DdaMethod.ControlId,Eb,gc,nd=>{var Cd;
if(Hg.a(nd))this.Me.IH(nd,Na);else{nd=Qc.clone();const Sd=gc.Headers?gc.Headers[0].length:gc.Data[0].length;1!==gc.CoerceType||gc.Data?1===gc.CoerceType&&(null===(Cd=gc.TableOptions)||void 0===Cd?0:Cd.length)&&0==gc.TableOptions[0]?(nd.top+=1,nd.bottom=nd.top+gc.Data.length-1):nd.bottom=nd.top+gc.Data.length-(1===gc.CoerceType?0:1):nd.bottom=nd.top+1;nd.right=nd.left+Sd-1;Cd=nd.contains(hd)?hd:nd.topLeft;vc.updateSelection(nd,Cd,0);this.Me.Jv(Na)}},Na)}}else this.Me.Lf(kf.a.rDe,Na)}}addBinding(J,
Na,Eb,gc){Na?this.yA.ddaAddBinding(J.DdaMethod.ControlId,J.DdaBindingsMethod.BindingId,J.DdaBindingsMethod.BindingType,Na,Eb,vc=>{if(Hg.a(vc))this.Me.IH(vc,gc);else{const Qc=this.Me.sQ();Qc.Bindings=Array(1);Qc.Bindings[0]=this.Gd.O3b(vc.Result);gc(Qc)}},gc):this.Me.Lf(kf.a.HAj,gc)}sUh(J,Na){this.yA.ddaGetBinding(J.DdaMethod.ControlId,J.DdaBindingsMethod.BindingId,Eb=>{if(Hg.a(Eb)||!Eb.Result)this.Me.IH(Eb,Na);else{const gc=this.Me.sQ();gc.Bindings=Array(1);gc.Bindings[0]=this.Gd.O3b(Eb.Result);Na(gc)}},
Na)}HZh(J){const Na=this.Me.sQ(),Eb={};Eb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Na[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Eb;J(Na)}dnj(J,Na){this.yA.ddaReleaseBinding(J.DdaMethod.ControlId,J.DdaBindingsMethod.BindingId,Eb=>{Hg.a(Eb)?this.Me.IH(Eb,Na):this.Me.Jv(Na)},Na)}rTh(J,Na){this.yA.ddaGetAllBindings(J.DdaMethod.ControlId,Eb=>{if(Hg.a(Eb))this.Me.IH(Eb,Na);else{const gc=this.Me.sQ();if(Eb.Result){Eb=Eb.Result;gc.Bindings=
Array(Eb.length);for(let vc=0;vc<Eb.length;vc++)gc.Bindings[vc]=this.Gd.O3b(Eb[vc])}else gc.Bindings=null;Na(gc)}},Na)}xyd(J,Na){this.yA.ddaLoadSettings(J.DdaMethod.ControlId,Eb=>{if(Hg.a(Eb))this.Me.IH(Eb,Na);else{const gc=this.Me.sQ();gc.Properties=Eb.Result;Na(gc)}},Na)}saveSettings(J,Na){const Eb={Settings:[]};for(let gc=0;gc<J.DdaSettingsMethod.Properties.length;gc++){const vc={};vc.Name=J.DdaSettingsMethod.Properties[gc][0];vc.Value=J.DdaSettingsMethod.Properties[gc][1];Eb.Settings[gc]=vc}this.yA.ddaSaveSettings(J.DdaMethod.ControlId,
Eb,J.DdaSettingsMethod.OverwriteIfStale,gc=>{Hg.a(gc)?this.Me.IH(gc,Na):this.Me.Jv(Na)},Na)}fse(J,Na){const Eb=Df.H2c(1,J.DdaAddRowsColumns.Data);Df.ljc(Eb)?this.Me.Lf(kf.a.PFc,Na):this.yA.ddaAddRowsColumns(J.DdaMethod.ControlId,J.DdaAddRowsColumns.BindingId,J.DdaAddRowsColumns.IsRow,Eb,gc=>{Hg.a(gc)?this.Me.IH(gc,Na):this.Me.Jv(Na)},Na)}cph(J,Na){this.yA.ddaDeleteAllDataValues(J.DdaMethod.ControlId,J.DdaBindingsMethod.BindingId,Eb=>{Hg.a(Eb)?this.Me.IH(Eb,Na):this.Me.Jv(Na)},Na)}Z8g(J,Na){this.yA.ddaClearBindingFormats(J.DdaMethod.ControlId,
J.DdaClearBindingFormats.BindingId,Eb=>{Hg.a(Eb)?this.Me.IH(Eb,Na):this.Me.Jv(Na)},Na)}C7f(J,Na){const Eb={},gc=J.DdaSetBindingFormats.IsSetFormats;gc?Eb.CellFormat=J.DdaSetBindingFormats.CellFormat:Eb.TableOptions=J.DdaSetBindingFormats.TableOptions;this.yA.ddaSetBindingFormats(J.DdaMethod.ControlId,J.DdaSetBindingFormats.BindingId,Eb,gc,vc=>{Hg.a(vc)?this.Me.IH(vc,Na):this.Me.Jv(Na)},Na)}executeRichApiRequest(J,Na){var Eb;const gc=J.ArrayData,vc={},Qc=ee.h(this.$).ga;if(gc){if("WacPartition"===
gc[0]){this.AIh(J,Na);return}const Te=Object(U.a)(Pg.DdaFacade,Ig.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===gc[0]){var hd=Te.Kn(J.DdaMethod.ControlId);hd&&(hd.dlc=!0,hd.iTf())}vc.HttpMethod=gc[1];vc.PathAndQuery=gc[2];vc.RequestHeaders=Df.A6e(gc[3]);vc.RequestBody=gc[4];vc.AppPermission=gc[5];hd=gc[6];vc.RequestFlags=hd;var nd=0;if(Zh.i(this.$.na))switch(Qc.Se){case 1:nd=2;break;case 2:nd=3;break;case 128:nd=4;break;default:nd=1}var Cd=null;Qc.Ra.aB&&(Cd=Qc.Ra.aB.sj);vc.SheetMultiRange=
Jh.r(Qc.qa.selectedRanges,this.$);vc.ActiveCell=Jh.v(Qc.qa.activeCell,this.$);vc.ActiveChartId=Cd;vc.SelectionState=nd;nd=this.Gd.oV(J.DdaMethod.ControlId);vc.InstanceId=nd?nd.InstanceId:"";if(nd&&nd.PrimaryMarketplace){let wf;if(nd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)wf=nd.PrimaryMarketplace.SolutionId,Cd=nd.PrimaryMarketplace.MarketplaceType;else{if(!nd.OwnerAddinSolutionId){u.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");
this.Me.Lf(kf.a.xBb,Na);return}if(!nd.OwnerAddinStoreType){u.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Me.Lf(kf.a.xBb,Na);return}wf=nd.OwnerAddinSolutionId;Cd=nd.OwnerAddinStoreType}let Lg=Telemetry.PrivacyRules.GetPrivacyCompliantId(wf,Cd,null===(Eb=nd.AssetMarketplace)||void 0===Eb?void 0:Eb.SolutionId,null,null,nd.PrimaryMarketplace.MarketplaceRef);vc.CompliantSolutionId=Lg;vc.SolutionId=wf;vc.MarketplaceType=Cd;vc.SolutionVersion=nd.PrimaryMarketplace.SolutionVersion;
vc.StoreLocation=nd.PrimaryMarketplace.MarketplaceRef}else vc.SolutionId=vc.MarketplaceType="",vc.CompliantSolutionId="";vc.IsEventsEnabled=void 0===Te||null===Te||Te.Mh.Z2b(vc.InstanceId);vc.RequestGuid=Rh.a.create().toString();Eb=vc.RequestBody.length;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Eb>this.$.xa.ExcelRichApiMaxAllowedRequestPayloadSize){this.Me.Lf(kf.a.Wtj,Na);u.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Eb} exceeded the limit`);return}y.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&
hd&4096&&(Eb=new xi(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Eb,yg,gc),vc.RequestBody=gc[4])}const Sd=Df.N9e(vc.RequestHeaders);Df.nId++;const Je=Dj.a.Ya.kc;y.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&vc&&vc.RequestBody&&u.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${vc.RequestBody.length}`);this.yA.executeRichApiRequest(vc,Te=>{var wf;this.J6f(Je,!0,Te.ServerCorrelationId);let Lg=null,sg=null;var dg=Te.ServerCorrelationId;
if(null===(wf=null===Te||void 0===Te?void 0:Te.Errors)||void 0===wf?0:wf[0])Lg=Te.Errors[0].MessageIdName,sg=Te.Errors[0].Description,y.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&Qj.a(this.$).ud.mM(Te.Errors[0].MessageId);if(Hg.a(Te)||!Te.Result)this.G$a(dg,Sd,"Server error",Lg,sg),this.Me.IH(Te,Na);else{let Fg=null;if(y.EwaSettings.ya(233))if((wf=Te.Result)&&wf.length){for(let bh=0;bh<wf.length;bh++)if(wf[bh].RequestGuid===vc.RequestGuid){Fg=wf[bh];break}Fg||this.Me.IH(Te,
Na)}else Fg=Te.Result;else Fg=Te.Result;if(!Lg&&Fg&&Fg.ResponseBody&&Fg.ResponseBody[0])if(Te=Fg.ResponseBody[0],Te.startsWith('{"Error":')){1<Fg.ResponseBody.length&&(Te=Te.substring(0,Te.indexOf("}")+1),Te+="}");try{var gg=v.a.ri(Te);gg.Error&&this.G$a(dg,Sd,"Pipeline error",gg.Error.Code,gg.Error.Message)}catch(bh){this.G$a(dg,Sd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.G$a(dg,Sd);else this.G$a(dg,Sd,"Server error",Lg,sg);const ah=(dg=Fg.SheetMultiRange)?dg.SheetName:
null;gg=Fg.ActiveChartId;const Xg=Fg.SelectionState;Te=5===Xg&&!!dg||6===Xg||7===Xg||8===Xg;if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.ub.$w&&Te)this.Me.Lf(kf.a.kIc,Na),u.ULS.sendTraceTag(537163211,0,50,`${Xg.toString()} is not allowed`);else if(5===Xg&&dg){if(this.$.ua&&ah)if(this.$.ua.Ik(ah))this.CYc(ah);else{let bh=null;bh=()=>{this.$.ua.Ik(ah)&&(u.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.CYc(ah),this.$.ua.JLb(bh))};
this.$.ua.Wpb(bh);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Th=null;Th=()=>{this.$.ua.Ik(ah)&&(this.CYc(ah),this.$.ua.Aoa(Th))};this.$.ua.Yha(Th)}}}else if(6===Xg||7===Xg||8===Xg||9===Xg){if(dg){const bh=Jh.g(dg.Ranges);if(ah&&Jh.db(bh,!0))if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.ua.Ik(ah)){let Th=null;Th=()=>{this.kog(Qc,bh,ah,Xg);this.$.ua.Aoa(Th)};this.$.ua.Yha(Th)}else this.kog(Qc,
bh,ah,Xg)}7===Xg?(gg="38.{"+Kg.e(gg)+"}",hi.a(this.$).Roa(0,gg,!0)):8===Xg&&hi.a(this.$).Roa(2,gg,!0);9===Xg&&(this.$.xa.ApiCallToSetPageLayout=!0)}Fg.PostProcessActions?(dg=v.a.ri(Fg.PostProcessActions),this.dcj(dg).then(()=>{this.Ueb(Fg,Na);this.gfd(J.DdaMethod.ControlId,vc);return Promise.resolve(null)},bh=>{this.Ueb(Fg,Na,bh);return Promise.reject(bh)})):this.Ueb(Fg,Na)}},Te=>{this.J6f(Je,!1,null);this.G$a(null,Sd,"Web service error");Na(Te)})}gfd(J,Na){const Eb=Object(U.a)(Pg.DdaFacade,Ig.a(this.$));
(null===Eb||void 0===Eb?0:Eb.YQd)&&Eb.Kn(J)&&Df.JLj(Na.RequestHeaders)&&(u.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${J}; SolutionId: ${Na.SolutionId}.`),Eb.YQd.wxh(J))}AIh(J,Na){var Eb=this.Gd.oV(J.DdaMethod.ControlId);const gc=Pg.DdaFacade.getSolutionId(Eb,this.$);var vc=null;vc=Pg.DdaFacade.owa(Eb,this.$);vc=new cj(vc,this.$);vc=new Cj(gc,J.DdaMethod.ControlId,this.Gd,this.$,vc);const Qc={ResponseHeaders:[]};Qc.ResponseBody=
Array(1);Eb=Df.A6e(J.ArrayData[3]);const hd=Df.N9e(Eb);Eb=new Tf(this.$.xa.CreateWorkbookMaxAllowedBase64Size,this.GAf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(vc,hg,Eb,J.ArrayData).then(nd=>{if(!nd)return this.pzd(!1,"The rich api executor call failed",hd),u.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Qc.ResponseStatusCode=500,this.Ueb(Qc,Na),null;this.pzd(!0,"The rich api executor call succeeded",hd);Qc.ResponseStatusCode=nd[0];Qc.ResponseBody[0]=nd[2];
this.Ueb(Qc,Na);return null},nd=>{Qc.ResponseStatusCode=400;Qc.ResponseBody[0]=nd.toString();this.pzd(!1,"The rich api executor call failed",hd);u.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${gc}`);this.Ueb(Qc,Na);return null})}J6f(J,Na,Eb){Df.nId--;J=Kj.a(Dj.a.Ya,J);u.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${J}, requests pending:${Df.nId}, request result:${Na?"success":"false"}, server correlationid: ${Eb}.`)}Ueb(J,Na,
Eb=null){const gc=Array(3);gc[0]=J.ResponseStatusCode;gc[1]=Df.l9h(J.ResponseHeaders);const vc=[];var Qc=!1;if(Eb&&J.ResponseBody){const hd=v.a.ri(J.ResponseBody.join(""));hd.Error||(Qc={},Qc.Error=Eb,Qc.TraceIds=hd.TraceIds,Qc.ProcessedResults={},Qc.ProcessedResults.Results=hd.Results,vc[0]=v.a.Fc(Qc),Qc=!0)}gc[2]=Qc?vc:J.ResponseBody;J=this.Me.sQ();J.Data=gc;Na(J)}rCd(J,Na){(new Ah(this.$,this.Me,this.yA)).rCd(J,Na)}$Ni(J,Na){u.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Eb=
J[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],gc=J[qe.a.K_c],vc=J[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];J=this.$.da.Aa(232).C3a.aOi(J.DdaMethod.ControlId,Eb,gc,vc);J===kf.a.success?this.Me.Jv(Na):(u.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.Me.Lf(J,Na))}XNi(J,Na){u.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Eb=J[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],gc=J[qe.a.K_c],vc=J[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];
this.$.da.Aa(232).C3a.CBj(J.DdaMethod.ControlId,Eb,gc,vc);this.Me.Jv(Na)}getAccessToken(J,Na){u.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Eb=(vc,Qc)=>{var hd;if(vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)vc=this.Me.sQ(),vc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Qc.accessToken,Na(vc);else{Qc=this.Gd.oV(J.DdaMethod.ControlId);let nd=null!==Qc.OwnerAddinStoreType?Qc.OwnerAddinStoreType:Qc.PrimaryMarketplace.MarketplaceType;u.ULS.sendTraceTag(537163202,
0,10,`${({["errorCode"]:vc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Pg.DdaFacade.getSolutionId(Qc,this.$),nd,null===(hd=Qc.AssetMarketplace)||void 0===hd?void 0:hd.SolutionId,null,null,Qc.PrimaryMarketplace.MarketplaceRef),["storeType"]:nd})}.`);this.Me.Lf(vc,Na)}},gc=!y.EwaSettings.ya(23);Mb.TaskExtensions.za(Gc.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),vc=>{const Qc=this.Gd.Jg,hd=Uf.getInstance();bg.AppsForOfficeSingleSignOnManager.getInstance(Qc,vc.result,
hd).getAccessToken(J.DdaMethod.ControlId,gc,J,Eb)},this.$.ka)}getAuthContext(J,Na){Mb.TaskExtensions.za(Gc.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),()=>{var Eb=this.Gd.Jg.getOsfControl(J.DdaMethod.ControlId);if(Eb.isFirstParty()){Eb=Eb.getManifest();var gc=Eb.getMarketplaceID(),vc=Eb.getWebApplicationId(),Qc=Eb.getWebApplicationMsaId();Gd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(gc).then(hd=>{const nd=this.Me.sQ(),Cd={};Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
vc;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Qc||vc;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=hd.upn;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=hd.userId;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=hd.authority;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=ff.a.aUh(hd.authorityType);Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=hd.isAnonymous;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
hd.tenantId;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=hd.supportsAuthToken;nd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Cd;Na(nd)},hd=>{const nd=this.Me.sQ(),Cd={},Sd=new ff.a;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=vc;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Qc||vc;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Sd.upn;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Sd.userId;
Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Sd.authority;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Sd.authorityType;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Sd.isAnonymous;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Sd.tenantId;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=hd;Cd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Sd.supportsAuthToken;nd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Cd;nd.Error=1;Na(nd)})}},this.$.ka)}Ysi(J){const Na=ee.h(this.$).ga;return 16===Na.Se&&!!Na.Ra.oc&&!!Na.Ra.oc.floatingObject&&Va.a.equals(Na.Ra.oc.floatingObject.id,J,!0)}kid(J){const Na=ee.h(this.$).ga;return Na.qa.ph?1===Na.Se||this.Ysi(J)?Na.xja:null:null}pmc(J,Na){return 1!==J&&2!==J&&3!==J?(this.Me.Lf(kf.a.HGe,Na),!1):!0}pzd(J,Na,Eb){const gc={};gc.a=this.$.xa.UserSessionId;gc.b=J;gc.c=Na;gc.d=null;gc.e=Eb;ui.b().gf(37,gc)}G$a(J,Na,Eb=null,gc=null,vc=null){const Qc={};J&&(Qc.ServerCorrelationId=
J);void 0!==Na&&null!==Na&&(Qc.Source=Na);Eb&&(Qc.ErrorType=Eb);gc&&(Qc.MessageId=gc);vc&&(Qc.StatusDescription=vc);y.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&gc&&"ExternalDataRefreshFailed"===gc&&(Qc.StatusDescription="");u.ULS.sendTraceTag(50688452,0,50,v.a.Fc(Qc))}dcj(J){let Na=new Promise(Eb=>{Eb(null)});for(let Eb=0;Eb<J.length;Eb++)Na=this.ccj(Na,J[Eb]);return Na}ccj(J,Na){return Object(jg.a)(this,void 0,void 0,function*(){if(!Na)return u.ULS.sendTraceTag(537163201,
0,10,"Null PostProcessAction."),J.then(()=>Promise.reject(Df.v5a(Kh.generalException,Gf.a.instance.ha(1765),null)));switch(Na.actionType){case 1:case 2:J=J.then(()=>{const vc=Object(U.a)(Pg.DdaFacade,Ig.a(this.$));if(vc.Kn(Na.controlId))switch(vc.Mh.tdi(Na),Na.messageType){case 14:case 100:vc.XQd.v3b(Na);break;case 11:case 12:vc.Kwj.mrb(Na);break;case 51:case 52:vc.Iwj.mrb(Na);break;case 2101:case 2102:vc.Jwj.mrb(Na);break;case 2E3:vc.Lwj.v3b(Na);break;case 2201:this.$.sma&&vc.YQd.kYg(Na);break;case 2203:vc.Mwj.lYg(Na);
break;case 2700:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&vc.WQd.v3b(Na);break;case 65541:vc.VQd.jYg(Na)}else u.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Na.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:J=J.then(()=>{this.ddi(Na);return Promise.resolve(null)});break;case 15:y.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(J=J.then(()=>{this.Tei(Na);return Promise.resolve(null)}));break;case 4:J=J.then(()=>
{if(y.EwaSettings.ya(102)){var vc=ee.h(this.$).ga.qa.activeCell;vc.top!==Na.row+1&&vc.left!==Na.column+1&&(vc=Jh.v(Mi.Range.Lc(Na.row+1,Na.column+1),this.$),ee.h(this.$).Bg(vc,null,null,null,3,"DdaMethodHandler.ShowCard"));Qh.a(this.$,243,242,0,Qc=>{Qc.agb(Na.row+1,Na.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:J=J.then(()=>{Object(U.a)(Pg.DdaFacade,Ig.a(this.$)).Mh.nSe(Na.controlId,Na.isEnableEvents);return Promise.resolve(null)});break;case 5:J=J.then(()=>this.smh(Na));break;
case 6:J=J.then(()=>this.Y7i(Na));break;case 8:J=J.then(()=>{y.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(U.a)(Pg.DdaFacade,Ig.a(this.$)).Y8g();const vc=new Oj.a(Pj.a.$j,5,null);Nj.a(this.$).Nr(vc);return Promise.resolve(null)});break;case 9:J=J.then(()=>this.qDj(Na));break;case 10:J=J.then(()=>this.Lck(Na));break;case 11:J=J.then(()=>this.Kck());break;case 12:J=J.then(()=>this.Hck());break;case 13:J=J.then(()=>this.Ick(Na));break;
case 14:J=J.then(()=>this.Jck(Na));break;case 16:J=J.then(()=>Promise.resolve(Na));break;case 17:J=J.then(()=>this.Gzj(Na,Object(U.a)(Pg.DdaFacade,Ig.a(this.$))));break;case 18:ee.h(this.$).focus();break;case 19:this.ecf(Na.entryType,!1,Na.options);break;case 20:this.ecf(Na.entryType,!0,Na.options);break;case 21:const Eb=Ig.a(this.$);J=J.then(()=>Eb.VQd.Lci(Na));break;case 22:const gc=Ig.a(this.$);J=J.then(()=>gc.VQd.Mci(Na));break;case 23:y.EwaSettings.isChangeGateEnabled("OfficeVSO:7637843_CreateRichApiRangeValuesPreview")&&
Rg.a.mCb(this.$)&&this.Gd.m3f.Bfi(Na.worksheetId,Na.anchorCell,Na.values,Na.options);break;case 24:y.EwaSettings.isChangeGateEnabled("OfficeVSO:7637843_CreateRichApiRangeValuesPreview")&&Rg.a.mCb(this.$)&&this.Gd.m3f.Odi(Na.worksheetId);break;default:J=J.then(()=>Promise.reject(Df.v5a(Kh.zVg,Gf.a.instance.ha(1766),null)))}return J})}Tei(J){var Na=Object(U.a)(Pg.DdaFacade,Ig.a(this.$)).Kn(J.controlId);if(Na&&!(0===J.operationType^!Na.Vea)){ee.h(this.$).XAb=!0;switch(J.operationType){case 0:var Eb=
new Mj.a(document.createElement("input"));Eb.text=J.range;Na.Bni(ee.h(this.$).Wg.Qkh(Eb,new Jj.a(this.$)));Na.Vea.startEdit(!0);break;case 1:Na.mZf();this.rangePicker=null;break;case 2:Na.Vea.Cog(J.range);break;case 3:Na.Vea.Cog(J.startingRange);Na=J.expandSelection;Eb=J.getNextDataRegionCell;let gc=0;switch(J.keyboardDirectionValue){case 2:gc=38;J=Na&&Eb?105288353:Na?-31900117:Eb?542791952:137938150;break;case 3:gc=40;J=Na&&Eb?-1297307319:Na?-1603798598:Eb?1713663844:-798660877;break;case 0:gc=37;
J=Na&&Eb?-403586027:Na?2039316657:Eb?-2012742350:-1470715894;break;case 1:gc=39;J=Na&&Eb?784916030:Na?589730764:Eb?1324884057:-1231471547;break;default:J=1461300262}Na=this.$7b("keydown",gc,Na,Eb);ee.h(this.$).TMb(Na,new L.a(J,1,0,8,null))}ee.h(this.$).XAb=!1}}$7b(J,Na,Eb,gc){const vc=document.createEvent("KeyboardEvent");if(hh.a.NF)vc.initKeyboardEvent(J,!1,!1,window.self,"A",0,gc,!1,Eb,!1);else{let Qc="";Eb&&(Qc+="Shift");gc&&(Qc+=0<Qc.length?" Control":"Control");vc.initKeyboardEvent(J,!1,!1,window.self,
"A",0,Qc,!1,"en-US")}J=new Sys.UI.DomEvent(vc);J.keyCode=Na;return J}ddi(J){switch(J.operationType){case 1:Mb.TaskExtensions.za(Gc.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1),Na=>{Na.result.VPd()},this.$.ka,3);break;case 2:if(J=Object(U.a)(Pg.DdaFacade,Ig.a(this.$)).Kn(J.controlId))J.dlc=!0,J.iTf()}}smh(J){const Na=J.fileBase64;return Na&&Na.length>this.$.xa.CreateWorkbookMaxAllowedBase64Size?Promise.reject(Df.v5a(Kh.invalidArgument,Gf.a.instance.ha(1769),"Application.CreateWorkbook")):
(new Promise((Eb,gc)=>{const vc=new Of.StandardDialog;vc.Xb=4;vc.Tl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Qc=>{2!==Qc&&0!==Qc||gc(Df.v5a(Kh.oHd,Gf.a.instance.ha(1768),"Application.CreateWorkbook"));Qc=new Wf("blank","agave",Na?"streamBase64":"streamEmpty",Na);this.GAf.create(Eb,gc,Qc).P2a()})})).then(Eb=>{this.Lbc.set(J.fakeFileId,Eb);return Promise.resolve(null)},Eb=>Eb?Promise.reject(Eb):Promise.reject(Df.v5a(Kh.generalException,Gf.a.instance.ha(1765),
"Application.CreateWorkbook")))}Y7i(J){return new Promise((Na,Eb)=>{if(this.Lbc.has(J.fakeFileId)){const gc=this.Lbc.get(J.fakeFileId);Eb=new Of.StandardDialog;Eb.Xb=4;Eb.Tl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,vc=>{1===vc&&bd.HelperMethods.vf(gc,void 0,void 0,"DdaMethodHandler.fileUrl");Na(null)})}else Eb(Df.v5a(Kh.generalException,Gf.a.instance.ha(1765),"Document.Open"))})}qDj(J){return new Promise(Na=>{Object(U.a)(Pg.DdaFacade,Ig.a(this.$)).n3f=
J.runtimeCalculationMode;const Eb=this.$.da.Aa(268);Eb&&Eb.tDd(3===J.runtimeCalculationMode);Na(null)})}Lck(J){Rg.a.aEb(this.$)&&this.$.da.Aa(331).Veb(0,J.urlStr,!0,!0,null);return Promise.resolve(null)}Kck(){Rg.a.aEb(this.$)&&this.$.da.Aa(331).Veb(1,null,!0,!0,null);return Promise.resolve(null)}Hck(){Rg.a.aEb(this.$)&&this.$.da.Aa(331).kSe();return Promise.resolve(null)}Ick(J){Rg.a.aEb(this.$)&&this.$.da.Aa(331).Veb(5,J.urlStr,!0,!0,null);return Promise.resolve(null)}Jck(J){if(Rg.a.aEb(this.$)){const Na=
this.$.da.Aa(331);for(const Eb of Na.Nba)Eb.IsActive&&Eb.HostEditUrl&&Eb.UrlStr===J.hostEditUrlStr&&bd.HelperMethods.vf(Eb.HostEditUrl,"_blank")}return Promise.resolve(null)}Gzj(J,Na){const Eb=wi.a.sL;J=v.a.ri(J.payload);const gc={};"eventId"in J&&"payload"in J&&(gc.eventId=J.eventId,gc.payload=J.payload);Na.DH(2201,Eb,v.a.Fc(gc));return Promise.resolve(null)}ecf(J,Na,Eb){const gc=this.$.da.Aa(5);gc&&(J=this.YUh(J))&&(Na?gc.removeEntry(J):gc.Rre(J,Eb))}YUh(J){switch(J){case 0:return 64;case 1:if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}CYc(J){J=
Object(U.a)(Lj.a,this.$.ua.getItemByName(J));(null===J||void 0===J?0:J.visible)&&J.activate(!0)}kog(J,Na,Eb,gc){var vc=J.qa.Xq;const Qc=vc<Na.length&&Na[vc].contains(J.qa.activeCell);J=Qc?J.qa.activeCell:Na[0].topLeft;vc=Qc?vc:0;ee.h(this.$).o_(Na,vc,Eb,null,J,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===gc)}static get Jnh(){Df.tra||(Df.tra={},Df.tra[Microsoft.Office.WebExtension.CoercionType.Table]=1,Df.tra[Microsoft.Office.WebExtension.CoercionType.Text]=2,Df.tra[Microsoft.Office.WebExtension.CoercionType.Matrix]=
3,Df.tra[Microsoft.Office.WebExtension.CoercionType.Html]=4,Df.tra[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return Df.tra}static get Mnh(){Df.$jb||(Df.$jb={},Df.$jb[Microsoft.Office.WebExtension.FilterType.All]=1,Df.$jb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return Df.$jb}static get Nnh(){Df.akb||(Df.akb={},Df.akb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,Df.akb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return Df.akb}static A6e(J){if(!J||
!J.length)return null;const Na=Array(J.length/2);for(let Eb=0;Eb<J.length/2;Eb++)Na[Eb]={},Na[Eb].Name=J[2*Eb],Na[Eb].Value=J[2*Eb+1];return Na}static l9h(J){if(!J||!J.length)return null;const Na=Array(2*J.length);for(let Eb=0;Eb<J.length;Eb++)Na[2*Eb]=J[Eb].Name,Na[2*Eb+1]=J[Eb].Value;return Na}static wfd(J){if(!J||!J.length)return null;const Na=Array(J.length);for(let Eb=0,gc=J.length;Eb<gc;Eb++){const vc=J[Eb].length;if(vc){Na[Eb]=Array(vc);for(let Qc=0;Qc<vc;Qc++)Na[Eb][Qc]=null==J[Eb][Qc]?null:
J[Eb][Qc].toString()}else return null}return Na}static q6b(J){return"string"===typeof J?jj.a.xq(Df.Jnh,J,0):J}static f_e(J){return"string"===typeof J?jj.a.xq(Df.Mnh,J,0):J}static $pg(J){return"string"===typeof J?jj.a.xq(Df.Nnh,J,0):J}static lti(J){switch(J.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static H2c(J,Na){const Eb={};Eb.CoerceType=J;1===Eb.CoerceType?(Eb.Data=Df.wfd(Na.Rows),Eb.Headers=Df.wfd(Na.Headers)):Eb.Data=Df.wfd(Na);return Eb}static NAe(J){return 1===
J.CoerceType?{["Headers"]:J.Headers,["Rows"]:J.Data}:J.Data}static ljc(J){return 1===J.CoerceType?!J.Data&&!J.Headers:!J.Data}static N9e(J){let Na="Unknown";if(!J)return Na;for(let Eb=0;Eb<J.length;Eb++)if(J[Eb].Name.toLowerCase()===ie.a.Nwj){Na=J[Eb].Value;break}return Na}static JLj(J){if(!J)return!1;const Na=ie.a.QSi.toLowerCase();for(let Eb=0;Eb<J.length;Eb++)if(J[Eb].Name.toLowerCase()===Na)return!0;return!1}static v5a(J,Na,Eb){const gc={};gc.Code=J;gc.Message=Na;gc.Location=Eb;gc.ActionIndex=
0;return gc}}Df.tra=null;Df.$jb=null;Df.akb=null;Df.nId=0;Object(e.a)(Df,"DdaMethodHandler",null,[233,2]);class kj extends ve.a{constructor(J){super(J)}Fd(){const J=Gc.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.Na),Na=Gc.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.Na),Eb=tf(this.ka,this.Na),gc=Object(Wh.d)(Xh.a.resolve(Gh.F,{rb:this.Na}));Mb.TaskExtensions.za(Mb.TaskExtensions.Pd([J,Na,Eb,gc],this.ka),()=>{const Qc=J.result,hd=Gd.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
this.qd([new Df(this.$,Qc,hd,gc.result)])},this.ka,3);const vc=Gd.a.instance;Mb.TaskExtensions.za(Gc.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,this.Na),()=>{vc.register(pf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").zc().Gc(()=>new pf)},this.$.ka)}static la(J){ve.a.Yd(82,new kj(J))}}Object(e.a)(kj,"DdaCommandHandlerFactory",ve.a,[]);var Rj=a(472);let dj=class{constructor(J){this.agaveCommandManager=J;this.g1j=()=>{this.agaveCommandManager.Oma("FA000000124",
Fi.a.taskpane,"CopilotSDXTaskpane",void 0,"1.1.0.0",{Nk:"Copilot (Preview)"})};window.setTimeout(this.g1j,5E3)}};dj=Object(jg.b)([Object(Xh.d)(Gh.l),Object(jg.c)(0,Object(Rj.AgaveCommandManagerService)())],dj);Object(e.a)(dj,"CopilotSDX",null,[]);b.a.Hi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");(()=>{f.a.Fa(J=>{Ya.la(J)})})();(()=>{f.a.Fa(J=>{y.EwaSettings.ya(52)&&zi.la(J)})})();(()=>{f.a.Fa(J=>
{y.EwaSettings.ya(114)&&Dg.la(J)})})();f.a.Fa(di.la);f.a.Fa(fi.la);(()=>{f.a.Fa(J=>{pi.la(J);Fc.la(J);Id.la(J)})})();f.a.Fa(kj.la);String(c);window.___1680633106457_closurehack=c},1533:function(t,C,a){t=a(0);var c=a(198),b=a(103);class f{constructor(){this.hRe=this.displayName=this.Htb=this.Vo=this.LB=null;this.isUpgraded=!1}Zof(d,h){return this.LB.getStoreType().toLowerCase()===d.toLowerCase()&&this.LB.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(t.a)(f,"AddinCommandsResourceItem",null,
[]);a.d(C,"a",function(){return e});class e{constructor(){this.nJc=null;this.aOc=0;this.GPc=!1;this.Za=new b.a;this.BCg=new c.a}JPg(d){this.Za.addHandler("AddinCommandsLoadingMessageChanged",d)}Poj(d){this.Za.removeHandler("AddinCommandsLoadingMessageChanged",d)}get R_a(){return this.nJc}ufb(d){d!==this.nJc&&(this.nJc=d,this.Za.raiseEvent("AddinCommandsLoadingMessageChanged"))}lDj(){this.aOc++;this.R_a||this.ufb(CommonUIStrings.l_LoadingAddInsTitle)}DTd(){this.aOc--;this.Rnc()&&(this.GPc?this.R_a!==
CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.ufb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.ufb(null))}t8f(d=!1){this.GPc=!0;this.ufb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}WEe(){this.GPc=!1;this.Rnc()?this.ufb(null):this.ufb(CommonUIStrings.l_LoadingAddInsTitle)}Rnc(){return 0>=this.aOc}get K7a(){return this.BCg}ika(d,h,r=0){for(let l of this.K7a)if(l.Zof(d,h)&&(!l.Vo||l.Vo.tSh===r))return l;return null}Lre(d,h,r,l){const u=
new f;u.LB=d;u.Vo=h;u.Htb=r;u.displayName=l;this.K7a.add(u)}LNg(d,h,r,l){const u=new f;u.LB=d;u.Vo=h;u.Htb=null;u.hRe=r;u.displayName=l;this.K7a.add(u)}mnj(d,h){let r=0;for(let l of this.K7a)l.LB.getStoreType()===d&&l.LB.getSolutionId()===h?this.K7a.removeAt(r):r++}static getInstance(){e.Ma||(e.Ma=new e);return e.Ma}}e.Ma=null;Object(t.a)(e,"AddinCommandsResourceManager",null,[])},755:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(37);class b{static get ZNi(){return b.Xge||(b.Xge=
{["-2002156328"]:b.HGe,["-1954750170"]:b.m$e,["317650254"]:b.K$g,["-1005263101"]:b.Dpi,["1353664579"]:b.UAj,["159671765"]:b.Epi,["1446690022"]:b.a5e,["1150069548"]:b.PFc,["-1409306331"]:b.rDe,["338507772"]:b.VMe,["-457159301"]:b.O8i,["-1037701970"]:b.jnh,["-1893322318"]:b.Jpi,["965579896"]:b.lnh,["93287890"]:b.knh,["358088857"]:b.dEj,["-1223650923"]:b.VMe,["2007306190"]:b.J6g,["1549955423"]:b.Qze,["-1275974171"]:b.Ipi,["382101082"]:b.a8i,["-898776235"]:b.CPi,["335464256"]:b.tPi,["1677378049"]:b.Hpi,
["-261992848"]:b.Q3j,["-980820954"]:b.Qze,["-931375837"]:b.$7i,["929186550"]:b.Ouh,["-982144310"]:b.Zej,["-785741187"]:b.Bpi,["2125217573"]:b.Mpi,["299124955"]:b.Cpi,["1669853884"]:b.axj,["-1515932330"]:b.L$g,["314621024"]:b.IOh,["-300049690"]:b.N6g,["14766835"]:b.oJj,["-1251992761"]:b.kQe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,
["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.tHa,["49173765"]:b.tHa,["-907155566"]:b.tHa,["-1201603824"]:b.tHa,["1541165282"]:b.tHa,["-1347753427"]:b.tHa,["134912532"]:b.tHa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static E1e(f){return c.a.xq(b.ZNi,f.toString(),b.internalError)}}b.success=0;b.HGe=1E3;b.m$e=1001;b.K$g=1002;b.Dpi=1003;b.UAj=1004;b.Epi=1005;b.a5e=1008;b.SZe=1009;b.invalidSheetName=1014;b.PFc=2E3;b.rDe=2001;b.VMe=2002;b.O8i=2003;b.jnh=2004;b.Jpi=2005;b.lnh=2007;
b.knh=2008;b.dEj=2009;b.J6g=2014;b.HAj=3E3;b.Qze=3002;b.Ipi=3004;b.a8i=3005;b.CPi=3006;b.tPi=3007;b.Hpi=3008;b.Q3j=3009;b.$7i=3010;b.oJj=4002;b.sHd=5E3;b.internalError=5001;b.kQe=5002;b.xBb=5004;b.V4j=5007;b.nki=5008;b.H1f=5011;b.invalidOrTimedOutSession=5012;b.kIc=5016;b.tHa=5102;b.Wtj=5103;b.responsePayloadSizeLimitExceeded=5104;b.c6g=7001;b.Beg=7002;b.Ouh=8E3;b.Zej=8001;b.Bpi=8010;b.Mpi=8011;b.Cpi=8012;b.axj=8020;b.L$g=8021;b.IOh=8022;b.N6g=8023;b.ENi=11E3;b.sQi=11001;b.Lpi=11002;b.Xge=null;Object(t.a)(b,
"DdaErrorIds",null,[])},756:function(t,C,a){a.d(C,"a",function(){return f});t=a(0);var c=a(14),b=a(117);class f{constructor(){this.iNd=0;this.dX={};this.Eua={}}m4h(e,d){return this.dX[f.K2c(e,d)]}nSe(e,d){d||void 0!==this.Eua[e]&&null!==this.Eua[e]?d&&void 0!==this.Eua[e]&&null!==this.Eua[e]&&delete this.Eua[e]:this.Eua[e]=1}Z2b(e){return void 0===this.Eua[e]||null===this.Eua[e]}tdi(e){const d=f.K2c(e.messageType,e.targetId);1===e.actionType?this.Yei(e.controlId,e.messageType,d):2===e.actionType&&
this.Rfi(e.controlId,e.messageType,d)}Tnj(e){if(e){var d=Object.keys(this.dX);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.dX[h],d[e]&&(delete d[e],Object.keys(d).length||delete this.dX[h])}}qN(e,d){e=f.K2c(e,d);e=this.dX[e];return!!e&&0<Object.keys(e).length}Ngi(){return!b.a.isEmpty(this.dX)}$pf(){return 0<this.iNd}tZh(){const e=[],d=this.dX;for(let l in d){var h=l,r=d[l];for(let u in r){r=u;const v={};v.eventType=parseInt(h.split("#")[0],10);v.targetId=h.split("#")[1];v.addinId=
r;e.push(v)}}return e}Yei(e,d,h){if(this.dX[h])h=this.dX[h],h[e]=h[e]?h[e]+1:1;else{let r={};r[e]=1;this.dX[h]=r}100===d&&this.iNd++}Rfi(e,d,h){if(this.dX[h]){const r=this.dX[h];if(e){const l=r[e];1===l?(delete r[e],Object.keys(r).length||delete this.dX[h]):r[e]=l-1;100===d&&this.iNd--}else c.ULS.sendTraceTag(537170459,0,50,`The OsfControl[${e}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static K2c(e,
d){return String.format("{0}#{1}",e,d)}}f.sL="Workbook";Object(t.a)(f,"RichApiEventRegistration",null,[])},757:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.$Xc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.oHd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.Y4j="UnsupportedUserIdentity";
c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.ETg="AddinIsAlreadyRequestingToken";c.wvj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.Edh="ControlIdNotFound";c.iwj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(t.a)(c,"ErrorCodes",null,[])},760:function(t,C,a){a.r(C);var c=a(0),b=a(2),f=a(14),e=a(1357),d=a(88),
h=a(103);class r{constructor(Ta,Vb,qc){this._id=Ta;this.uwg=Vb;this.Ayg=qc;this.gjf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get DTg(){return this.uwg}get pah(){return this.Ayg}execute(Ta,Vb,qc){qc=qc||{};qc.commandMode=this.gjf;Vb.invokeAppCommand(this.DTg,this.pah,qc,()=>{Ta.y1i(this.id)})}}Object(c.a)(r,"AddinNativeActionBase",null,[244]);class l extends r{constructor(Ta,Vb){super(1,Ta,Vb);this.gjf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(l,"AddinTakeSnapshotAction",
r,[]);class u{kfh(Ta){return new r(3,Ta,this.cTh().getNativeActionName(3))}cTh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(u,"AddinNativeActionManager",null,[212]);var v=a(160);class x{invokeAppCommand(Ta,Vb,qc,Ic){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ta,Vb,qc,Ic)}static getInstance(){x.Ma||(x.Ma=new x);return x.Ma}}x.Ma=null;Object(c.a)(x,"OSFAddinCommandsRuntimeManager",null,[213]);var w=a(6),m=a(194),n=a(29);class z extends v.a{constructor(Ta,
Vb,qc){super();this.D$=null;this.bXc="WACDialogTitleText";this.hY="0";this.I9="15px";this.Pyg="0px";this.gY="calc(100% - 30px)";this.Oyg="100%";this.zke=0;this.Za=new h.a;this.wwg=new u;this.Xb=5;this.ye=this.REa=qc;this.qMc=Ta;this.w$d=Vb;this.GMc=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix")}WRg(Ta){this.Za.addHandler("OnDialogClosedEventKey",Ta)}hGj(){this.$Fa=null}ox(){super.ox();this.Xh.style.width="100%";this.Xh.style.height=this.cAb?
this.gY:this.Oyg;this.Xh.style.marginTop=this.cAb?this.I9:this.Pyg;this.Xh.style.padding=this.hY}dE(){super.dE();this.mb.style.width=String.format("{0}px",this.qMc*window.innerWidth/100);this.mb.style.height=String.format("{0}px",this.w$d*window.innerHeight/100);this.mb.style.minWidth="0px";this.GMc&&w.AFrameworkApplication.isRtl&&100===this.qMc&&(this.mb.style.right="0px",this.mb.style.marginRight="0px");this.D$=document.getElementById(this.Sh(this.bXc));this.D$.style.position="absolute";this.D$.style.whiteSpace=
"nowrap";this.D$.style.textOverflow="ellipsis";w.AFrameworkApplication.isRtl?(this.D$.style.right="14px",this.D$.style.left="44px"):(this.D$.style.right="44px",this.D$.style.left="14px")}Py(Ta){super.Py(Ta);this.D$&&this.D$.setAttribute("title",Ta)}get sba(){return this.Xh}aQd(){this.mb.style.width=String.format("{0}px",this.qMc*window.innerWidth/100);this.mb.style.height=String.format("{0}px",this.w$d*window.innerHeight/100);this.mb.style.overflowY="hidden";this.mb.style.overflowX="hidden";this.mb.style.marginTop=
"";this.mb.style.top="";n.a.cW&&w.AFrameworkApplication.isRtl?(this.mb.style.right="",this.mb.style.marginRight=""):(this.mb.style.left="",this.mb.style.marginLeft="")}hide(){this.wwg.kfh(this.REa).execute(this,x.getInstance(),{});this.zke=window.setTimeout(()=>{this.Za.raiseEvent("OnDialogClosedEventKey",this.REa);m.a.prototype.hide.call(this)},500)}y1i(Ta){3===Ta&&(window.clearTimeout(this.zke),this.Za.raiseEvent("OnDialogClosedEventKey",this.REa),super.hide())}}Object(c.a)(z,"AppsForOfficeDialog",
v.a,[200,201]);class y{constructor(){this.dialog=this.ye=null}}Object(c.a)(y,"DialogInfo",null,[]);class A{}A.url="url";A.height="height";A.width="width";A.nad="displayInIframe";A.vhc="hideTitle";Object(c.a)(A,"DialogSettings",null,[]);class F{constructor(){this.height=this.width=0;this.ye=this.controlId=this.pageUrl=null;this.vhc=this.nad=!1}}Object(c.a)(F,"DisplayDialogParams",null,[]);class D extends Sys.EventArgs{constructor(Ta,Vb,qc=null,Ic="",gd=""){super();this.controlId=Ta;this.messageType=
Vb;this.messageContent=qc;this.messageOrigin=Ic;this.targetOrigin=gd}}Object(c.a)(D,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class B extends Sys.EventArgs{constructor(Ta,Vb,qc=null,Ic="",gd=""){super();this.controlId=Ta;this.messageType=Vb;this.messageContent=qc;this.messageOrigin=Ic;this.targetOrigin=gd}}Object(c.a)(B,"OnMessageParentEventArgs",Sys.EventArgs,[]);var M=a(42),R=a(34),P=a(181),E=a(105);class H{constructor(Ta){this.Za=new h.a;this.Jl=Ta}dSg(Ta){this.Za.addHandler("OnMessageParentEventKey",
Ta)}cSg(Ta){this.Za.addHandler("OnMessageDialogEventKey",Ta)}showDialog(Ta,Vb,qc,Ic){if(H.u9.nb(Vb))f.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),qc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Za=M.b(Ta),Rb=Za[A.url];if(this.Jl.getOsfControl(Vb).checkAppDomains(Rb)){var gd=new F;gd.width=Za[A.width];gd.height=Za[A.height];gd.pageUrl=Rb;gd.nad=Za[A.nad];gd.vhc=Za[A.vhc];gd.controlId=Vb;gd.ye=P.a.create().toString();
var Kd=new y;Kd.ye=gd.ye;var oe=this.Jl.getOsfControl(gd.controlId).getManifest().getDefaultDisplayName(),Ce=this.Jl.getOsfControl(gd.controlId).getStoreType().toLowerCase();Ta=null;Ta=(4===w.AFrameworkApplication.sa.Pa.$i&&"hardcodedpreinstall"===Ce||"sdxcatalog"===Ce)&&gd.vhc?this.createAndShowAppsForOfficeDialog(gd.width,gd.height,gd.ye,!0,oe):this.createAndShowAppsForOfficeDialog(gd.width,gd.height,gd.ye,!1,oe);var ze=this.Jl.getOsfControl(gd.controlId),af=ze.getManifest();Vb={};Vb.id=gd.ye;Vb.solutionId=
ze.getSolutionId();Vb.version=ze.getVersion();Vb.storeType=Ce;Vb.storeId=ze.getStoreId();Vb.assetId=ze.getAssetId();Vb.assetStoreId=ze.getAssetStoreId();Vb.ownerAddinSolutionId=ze.getOwnerAddinSolutionId();Vb.ownerAddinStoreType=ze.getOwnerAddinStoreType();Vb.appDomains=af.getAppDomains();Vb.dialogUrl=Rb;Vb.osfControlType=1;Vb.agaveName=oe;Vb.div=Ta.sba;f.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Vb.solutionId,Vb.ownerAddinStoreType||
Vb.storeType,Vb.assetId,null,null,Vb.storeId),R.a.Au(gd.pageUrl));this.Jl.insertDialogControl(Vb);Ta.WRg(Object(d.a)(this,this.LWi,"onDialogClosed"));Kd.dialog=Ta;H.u9.ia(gd.controlId,Kd);Ic&&Ic(Vb);qc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else f.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),qc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Za){f.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Za.message),
qc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}aOi(Ta,Vb,qc,Ic){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Ic&&(Ic=qc);try{const gd=this.ZLa(Ta);gd&&this.Za.raiseEvent("OnMessageParentEventKey",new B(gd,OSF.DialogMessageType.DialogMessageReceived,Vb,qc,Ic))}catch(gd){return f.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",gd.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}ctb(Ta,
Vb){if(H.u9.nb(Ta))try{const qc=H.u9.ma(Ta);qc.dialog&&qc.dialog.hide();this.Jl.purgeDialogControl(qc.ye);H.u9.remove(Ta);Vb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(qc){f.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",qc.message),Vb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else f.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Vb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}CBj(Ta,
Vb,qc,Ic){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Ic&&(Ic=qc);if(H.u9.nb(Ta)&&(Ta=H.u9.ma(Ta),Ta.dialog))try{this.Za.raiseEvent("OnMessageDialogEventKey",new D(Ta.ye,OSF.DialogMessageType.DialogParentMessageReceived,Vb,qc,Ic))}catch(gd){f.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",gd.message)}}ZLa(Ta){let Vb=null;for(let qc of H.u9)if(qc.value.ye===Ta){Vb=qc.key;
break}return Vb}LWi(Ta,Vb){if(Ta=this.ZLa(Vb))this.Jl.purgeDialogControl(Vb),H.u9.remove(Ta),this.Za.raiseEvent("OnMessageParentEventKey",new B(Ta,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(Ta,Vb,qc,Ic,gd){Ta=new z(Ta,Vb,qc);gd=Ic?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,gd);Ic&&(Ta.cAb=!1,Ta.Ot=!1);Ta.initializeAndShow(gd,null,null);Ta.hGj();return Ta}static ibi(){return H.u9}static getInstance(Ta){H.Ma||(H.Ma=new H(Ta));return H.Ma}}
H.Ma=null;H.u9=new E.a;Object(c.a)(H,"AppsForOfficeDialogManager",null,[177]);var G=a(876),N=a(708),I=a(562),O=a(198),U=a(385),ca=a(997);class Q{constructor(){this.AUP=this.priority=0}}Object(c.a)(Q,"AddinDetailInfo",null,[]);class Y{constructor(){this.pgb=null;this.errorCode=0;this.failure=null}}Object(c.a)(Y,"AddinCollection",null,[]);class la extends Sys.EventArgs{constructor(Ta,Vb){super();this.Ata=Ta;this.fU=Vb}}Object(c.a)(la,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class ea{constructor(Ta){this.errorCode=
Ta;this.fU=[];this.failure=null}}Object(c.a)(ea,"GetAddinDetailsResult",null,[]);var ha=a(740),X=a(897),T=a(1002),ua=a(182),Ha=a(189),Ca=a(85);class Ga{constructor(Ta,Vb,qc=null){this.Za=new h.a;this.t9=new N.a(I.a.$h());this.$y=new U.a;this.KTc=null;this.ROc="https://store-images.s-microsoft.com";this.rWc=new Ha.a;this.rWc.add(OSF.StoreTypeEnum.MarketPlace,0);this.rWc.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.$a=Ta;this.Jl=Vb;this.kga=qc;if(this.Iph||this.MMe)this.ROc=Ga.Q0h(Ta,this.ROc);this.Ose(Object(d.a)(this,
this.gEd,"onAddinDetailsRefreshed"))}get Iph(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DescriptionInTooltipEnabled",!1)}get MMe(){return!!this.$a&&this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.CustomizablePopularAddinsEnabled")}get H0e(){return!!this.$a&&this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get sCb(){return this.$a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Jg(){return this.Jl.value}nhd(Ta){if(!this.mrd(Ta))return Ta=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:ca.a[Ta]}),Object.assign(new ea(1),{failure:Ta});if(this.$y.ma(Ta).failure)return Object.assign(new ea(this.$y.ma(Ta).errorCode),{failure:this.$y.ma(Ta).failure});f.ULS.shipAssertTag(509870082,220,!!this.$y.ma(Ta).pgb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ta);const Vb=new ea(0);for(let qc of this.$y.ma(Ta).pgb)this.t9.nb(qc)&&
Array.add(Vb.fU,this.t9.ma(qc));return Vb}$Sh(Ta){return this.t9.nb(Ta)?this.t9.ma(Ta):null}Uvc(Ta){if(Ta){this.Ose(Ta);for(let qc of this.$y.keys)if(this.mrd(qc)&&!this.$y.ma(qc).failure){f.ULS.shipAssertTag(509870081,220,!!this.$y.ma(qc).pgb,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",qc);var Vb=[];for(let Ic of this.$y.ma(qc).pgb)Array.add(Vb,this.t9.ma(Ic));Vb=new la(qc,Vb);Ta(null,Vb)}}}dS(Ta,Vb=!1){0!==Ta&&10!==Ta?f.ULS.sendTraceTag(509870080,220,
50,"QueryAddinDetails: skipping providerType: {0}.",X.a[Ta]):this.ofj(Ta,Object(d.a)(this,this.N2i,"onQueryAddinDetailsCompleted"),Vb)}Ose(Ta){this.Za.addHandler(ha.a.Fue,Ta)}N2i(Ta,Vb,qc){if(qc)if(Ga.oJi(Ta,qc,window.performance.now()-Vb),0===qc.errorCode){let gd;if(qc.value){let Kd=0;gd=Array(qc.value.length);qc.value.forEach(oe=>{gd[Kd++]=oe})}else gd=[];this.hBf(Ta,gd)}else if(-1===qc.errorCode||10===qc.errorCode)this.hBf(Ta,[]);else{var Ic={};Ic.collectionType=ca.a[Ta];Ic.invokeResultCode=qc.errorCode;
Ic["queryResult.Value"]=qc.value?String.format("Length: {0}",qc.value.length):"null";Ic.queryStart=Vb;Ic.queryDuration=window.performance.now()-Vb;this.$y.ia(Ta,Object.assign(new Y(Ta),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Ic)}));f.ULS.sendTraceTag(512231324,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",ca.a[Ta],this.$y.ma(Ta).failure.toString(),JSON.stringify(this.$y.ma(Ta).failure))}else Ic=
{},Ic.collectionType=ca.a[Ta],Ic.queryResult=qc?"not null":"null",Ic.queryStart=Vb,Ic.queryDuration=window.performance.now()-Vb,this.$y.ia(Ta,Object.assign(new Y(Ta),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Ic)})),f.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",ca.a[Ta],this.$y.ma(Ta).failure.toString(),JSON.stringify(this.$y.ma(Ta).failure))}xnd(Ta){const Vb=
{};Vb.collectionType=ca.a[Ta];this.$y.ia(Ta,Object.assign(new Y(Ta),{errorCode:2,failure:Error.create("The store is disabled.",Vb)}));f.ULS.sendTraceTag(510253056,220,10,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",ca.a[Ta],this.$y.ma(Ta).failure.toString(),JSON.stringify(this.$y.ma(Ta).failure))}wMj(){return this.mrd(2)?this.$a.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.$y.ma(2).failure:!1:!0}ofj(Ta,Vb,qc=!1){f.ULS.sendTraceTag(510248470,
220,50,"QueryAddinDetailsInternal: storeType: {0}.",Ta);Ta!==OSF.StoreTypeEnum.MarketPlace&&Ta!==OSF.StoreTypeEnum.PrivateCatalog?f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Ta):(this.wMj()&&this.queryStoreDisabled(0,(Ic,gd)=>{gd?this.xnd(2):(Ic=window.performance.now(),Vb(2,Ic,this.$4h()))}),this.queryStoreDisabled(Ta,(Ic,gd)=>{if(Ic===OSF.StoreTypeEnum.MarketPlace&&gd)this.xnd(0);else if(Ic===OSF.StoreTypeEnum.PrivateCatalog&&gd)this.xnd(1);else{var Kd=window.performance.now();
this.Jg.getEntitlementDetails(Object.assign(new T.a,{storeType:Ic,refresh:qc}),oe=>{Vb(this.rWc.ma(Ic),Kd,oe)})}}))}hBf(Ta,Vb){Ta=new la(Ta,Vb);this.Za.raiseEvent(ha.a.Fue,Ta)}gEd(Ta,Vb){Ta=Object.assign(new Y(Vb.Ata),{pgb:new O.a});var qc=Vb.fU;for(const Ic of qc)qc=Ic.solutionId,this.t9.nb(qc)?this.t9.ia(qc,this.MNi(this.t9.ma(qc),Vb.Ata,Ic)):this.t9.add(qc,Ic),Ta.pgb.add(qc);this.$y.ia(Vb.Ata,Ta)}mrd(Ta){return this.$y.nb(Ta)?!!this.t9:!1}get tXg(){return this.kga?!this.kga.AreThirdPartyAddInsAllowed||
this.kga.AppsForOfficeThirdPartyIsDisabled:!this.$a.ra("AreThirdPartyAddInsAllowed")||this.$a.ra("AppsForOfficeThirdPartyIsDisabled")}get uwi(){return this.kga?!this.kga.AppsForOfficeAllowExternalMarketplace:!this.$a.ra("AppsForOfficeAllowExternalMarketplace")}get KJb(){return this.kga?this.kga.PopularAddinDetailsJsonString:this.$a.Wa("PopularAddinDetailsJsonString")}queryStoreDisabled(Ta,Vb){if(this.tXg)Vb(Ta,!0);else if(Ta===OSF.StoreTypeEnum.MarketPlace&&this.uwi)Vb(Ta,!0);else{const qc=Ga.HZj(Ta);
if(qc){const Ic=window.performance.now();this.Jg.queryStoreDisabled(qc,gd=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Ta,gd,Ic,window.performance.now()-Ic);Vb(Ta,gd)})}else Vb(Ta,!1)}}MNi(Ta,Vb,qc){if(!Ta)return qc;if(!qc)return Ta;if(this.H0e)return 2===Vb?Ga.Uyf(qc,Ta):Ga.Uyf(Ta,qc);if(2===Vb)return Ta.addinInfo=qc.addinInfo,Ta;qc.addinInfo=Ta.addinInfo;return qc}$4h(){if(this.MMe){if(!this.KTc){var Ta=JSON.parse(this.KJb);
this.jNh(Ta);this.KTc=Ta}return Ga.bBe(this.KTc)}Ta=JSON.parse(this.KJb);this.l0e(Ta);return Ga.bBe(Ta)}jNh(Ta){this.H0e&&Ga.xWg(Ta);this.IWg(Ta);this.l0e(Ta)}IWg(Ta){const Vb=this.i2g();for(var qc=0;qc<Ta.length&&0<Vb.count;qc++){const Ic=Ta[qc];if(Vb.nb(Ic.solutionId)){let gd=String.format("Found an override, solutionId: {0}",Ic.solutionId);const Kd=Vb.ma(Ic.solutionId);Kd&&(isNaN(Kd.addinInfo.priority)||(gd=String.format("{0}; AddinInfo.Priority: update {1} to {2}",gd,Ic.addinInfo.priority,Kd.addinInfo.priority),
Ic.addinInfo.priority=Kd.addinInfo.priority),isNaN(Kd.addinInfo.AUP)||(gd=String.format("{0}; AddinInfo.AUP: update {1} to {2}",gd,Ic.addinInfo.AUP,Kd.addinInfo.AUP),Ic.addinInfo.AUP=Kd.addinInfo.AUP),Kd.displayName&&(gd=String.format("{0}; DisplayName: update {1} to {2}",gd,Ic.displayName,Kd.displayName),Ic.displayName=Kd.displayName),Kd.iconUrl&&(gd=String.format("{0}; IconUrl: update {1} to {2}",gd,Ic.iconUrl,Kd.iconUrl),Ic.iconUrl=Kd.iconUrl),Kd.description&&(gd=String.format("{0}; Description: update {1} to {2}",
gd,Ic.description,Kd.description),Ic.description=Kd.description));Vb.remove(Ic.solutionId);this.sCb&&f.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",gd)}}for(let Ic of Vb.keys)qc=Vb.ma(Ic),qc.displayName&&qc.iconUrl&&qc.addinInfo&&(Ta.push(qc),this.sCb&&f.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(qc)))}i2g(){const Ta=new N.a(I.a.$h());let Vb=this.$a.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins",
"");if(!Vb)return Ta;Vb=Vb.trim();if(12>=Vb.length)return 0<Vb.length&&f.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Vb),Ta;this.sCb&&f.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Vb);try{const qc=[],Ic=Vb.split("|");for(let gd=Ic.length-1;0<=gd;gd--){const Kd=Ic[gd],oe=Kd.split("\\");if(2>oe.length){qc.push(Kd);continue}const Ce=Ga.L9i(oe);Ce?Ta.nb(Ce.solutionId)||Ta.add(Ce.solutionId,Ce):qc.push(Kd)}this.sCb&&
0<qc.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",qc.join("|"));this.sCb&&0<Ta.count&&f.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Ta.count,JSON.stringify(Ca.toArray(Ta.values)));return Ta}catch(qc){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Vb,qc.toString())}return Ta}l0e(Ta){for(let Vb=0;Vb<Ta.length;Vb++)ua.c(Ta[Vb].iconUrl.toLowerCase(),
"http",0)||(Ta[Vb].iconUrl=String.format("{0}/image/apps.{1}",this.ROc,Ta[Vb].iconUrl))}static oJi(Ta,Vb,qc){const Ic={};Ic.AddinCollectionType=ca.a[Ta];Ic.ErrorCode=Vb.errorCode;Ic.AddinCount=Vb.value?Vb.value.length:0;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",qc,JSON.stringify(Ic))}static bBe(Ta){const Vb={errorCode:0};Vb.value=Ta;return Vb}static HZj(Ta){return Ta===OSF.StoreTypeEnum.MarketPlace?"omex":Ta===OSF.StoreTypeEnum.PrivateCatalog?
"excatalog":null}static Uyf(Ta,Vb){Vb.solutionId=Vb.solutionId||Ta.solutionId;Vb.version=Vb.version||Ta.version;Vb.storeType=Vb.storeType||Ta.storeType;Vb.storeId=Vb.storeId||Ta.storeId;Vb.assetId=Vb.assetId||Ta.assetId;Vb.assetStoreId=Vb.assetStoreId||Ta.assetStoreId;Vb.displayName=Vb.displayName||Ta.displayName;Vb.provider=Vb.provider||Ta.provider;Vb.description=Vb.description||Ta.description;Vb.iconUrl=Vb.iconUrl||Ta.iconUrl;Vb.webApplicationId=Vb.webApplicationId||Ta.webApplicationId;Vb.highResolutionIconUrl=
Vb.highResolutionIconUrl||Ta.highResolutionIconUrl;Vb.licenseUrl=Vb.licenseUrl||Ta.licenseUrl;Vb.privacyUrl=Vb.privacyUrl||Ta.privacyUrl;Vb.addinInfo=Vb.addinInfo||Ta.addinInfo;isNaN(Vb.targetType)&&(Vb.targetType=Ta.targetType);isNaN(Vb.height)&&(Vb.height=Ta.height);isNaN(Vb.width)&&(Vb.width=Ta.width);return Vb}static xWg(Ta){for(const Vb of Ta)isNaN(Vb.targetType)&&(Vb.targetType=1),Vb.assetId=Vb.assetId||Vb.solutionId,Vb.storeId=Vb.storeId||"en-US",Vb.storeType=Vb.storeType||"omex",Vb.assetStoreId=
Vb.assetStoreId||"omex",isNaN(Vb.width)&&(Vb.width=0),isNaN(Vb.height)&&(Vb.height=0)}static L9i(Ta){const Vb={};let qc=0;qc<Ta.length&&0<Ta[qc].trim().length&&Ta[qc].trim().toLowerCase().startsWith("wa")&&(Vb.solutionId=Ta[qc].trim(),Vb.addinInfo=Object.assign(new Q,{priority:Number.NaN,AUP:Number.NaN}),++qc<Ta.length&&0<Ta[qc].trim().length&&(Vb.addinInfo.priority=parseInt(Ta[qc].trim())),++qc<Ta.length&&0<Ta[qc].trim().length&&(Vb.addinInfo.AUP=parseInt(Ta[qc].trim())),++qc<Ta.length&&0<Ta[qc].trim().length&&
(Vb.displayName=Ta[qc].trim()),++qc<Ta.length&&0<Ta[qc].trim().length&&(Vb.iconUrl=Ta[qc].trim()),++qc<Ta.length&&0<Ta[qc].trim().length&&(Vb.description=Ta[qc].trim()));return Vb.solutionId?Vb:null}static Q0h(Ta,Vb){Ta=Ta.Wa("AddinImageStoreServiceUrl");if(!Ta)return Vb;Ta=Ta.toLowerCase();return Ta.startsWith("http://")||Ta.startsWith("https://")?Ta:Vb}}Object(c.a)(Ga,"AddinDetailsManager",null,[468]);var sa=a(847),bb=a(1356),Ba=a(1460),qa=a(971),pa=a(185),ya=a(1364),za=a(127),cb=a(84),Pa=a(368),
nb=a(92),Ma=a(659),Oa=a(89),La=a(425),ra=a(561),V=a(170),ma=a(40),W=a(7),aa=a(893),ia=a(1285),ka=a(86);class Xa{constructor(){this.command=0;this.properties=null}}Object(c.a)(Xa,"DdaRequestInfo",null,[]);var sb=a(755),ib=a(80);class Ub extends ka.a{constructor(Ta,Vb){super();this.requests=[];this.disposed=this.m5b=!1;this.Wf=()=>{if(!this.disposed){this.grid.hc.km(this.Wf);this.m5b=!1;const qc=this.requests;this.requests=[];for(let Ic of qc)this.ddaFacade.GK(Ic.command,Ic.properties)}};this.ddaFacade=
Ta;this.grid=Vb}Uoh(Ta,Vb){this.disposed||(this.m5b||(this.grid.hc.Bm(this.Wf),this.m5b=!0),this.requests.push(Object(b.a)(new Xa,{command:Ta,properties:Vb})))}dispose(){if(!this.disposed){this.disposed=!0;this.m5b&&this.grid.hc.km(this.Wf);var Ta=this.requests;this.requests=null;for(let Vb of Ta)(Ta=Vb.properties?Vb.properties[ib.a.v4]:null)&&this.ddaFacade.Lf(sb.a.xBb,Ta);this.ddaFacade=this.grid=null;super.dispose()}}static sah(Ta,Vb){var qc=!1;974713501===Ta&&(Vb=(Ta=Vb?Vb[ib.a.$f]:null)?Ta.DdaMethod:
null)&&Vb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(qc=Ta.ArrayData,qc=!!qc&&64===(qc[6]&64));return qc}}Object(c.a)(Ub,"DdaCellEditDelayRequestHandler",ka.a,[]);var hc=a(789);class yb extends hc.a{constructor(Ta,Vb,qc,Ic,gd,Kd,oe){super(Ta,Vb,qc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Ic;this.messageContent=gd;this.messageOrigin=Kd;this.targetOrigin=oe}}Object(c.a)(yb,"DialogMessageReceivedEventArgs",hc.a,[]);
class Gb extends hc.a{constructor(Ta,Vb,qc,Ic,gd,Kd,oe){super(Ta,Vb,qc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Ic;this.messageContent=gd;this.messageOrigin=Kd;this.targetOrigin=oe}}Object(c.a)(Gb,"DialogParentMessageReceivedEventArgs",hc.a,[]);var Sa=a(1),db=a(21);class fb{constructor(Ta){this.Jg=this.I0c=null;this.o1i=(Vb,qc)=>{this.handlers.nb(qc.controlId)&&(Vb=new yb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,qc.controlId,null,
qc.messageType,qc.messageContent,qc.messageOrigin,qc.targetOrigin),this.handlers.ma(qc.controlId)(Vb),qc.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(qc.controlId))};this.n1i=(Vb,qc)=>{this.rpc.nb(qc.controlId)&&(Vb=new Gb(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,qc.controlId,null,qc.messageType,qc.messageContent,qc.messageOrigin,qc.targetOrigin),this.rpc.ma(qc.controlId)(Vb))};this.handlers=new E.a;this.rpc=new E.a;this.gh=Ta;this.C3a.dSg(this.o1i);this.C3a.cSg(this.n1i)}get C3a(){this.I0c||
(this.I0c=H.getInstance(this.contextActivationMgr));return this.I0c}get contextActivationMgr(){!this.Jg&&this.gh&&(this.Jg=this.gh.Jg);return this.Jg}addHandler(Ta,Vb,qc,Ic){if(Sa.EwaSettings.ya(23))this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,qc);else{f.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const gd=Kd=>{Kd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(Ta,Vb),this.gh.Jv(qc)):(f.ULS.sendTraceTag(537170501,
0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.gh.Lf(Kd,qc))};this.handlers.nb(Ta)?gd(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Ta,Ic,gd)}}CNg(Ta,Vb,qc){Sa.EwaSettings.ya(23)?this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,qc):(f.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.rpc.ia(Ta,Vb),this.gh.Jv(qc))}removeHandler(Ta,Vb){Sa.EwaSettings.ya(23)?this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Vb):this.handlers.nb(Ta)?(f.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.C3a.ctb(Ta,qc=>{this.handlers.remove(Ta);qc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.gh.Jv(Vb):(f.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.gh.Lf(qc,Vb))})):this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Vb)}koj(Ta,Vb){Sa.EwaSettings.ya(23)?this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Vb):(f.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.rpc.remove(Ta),this.gh.Jv(Vb))}showDialog(Ta,Vb,qc){try{Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&db.h(this.gh.$).jb&&db.h(this.gh.$).Xo(!0),this.C3a.showDialog(Vb,Ta,qc,Ic=>{this.gh.TNg(this.g3g(Ic))})}catch(Ic){f.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Ic.message}`),qc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}g3g(Ta){const Vb=
{};Vb.InstanceId=Ta.id;Vb.WebExtensionType=Ta.osfControlType===OSF.OsfControlTarget.InContent?0:1;Vb.PrimaryMarketplace={};Vb.PrimaryMarketplace.SolutionId=Ta.solutionId;Vb.PrimaryMarketplace.SolutionVersion=Ta.version;Vb.PrimaryMarketplace.MarketplaceRef=Ta.storeId;Vb.PrimaryMarketplace.MarketplaceType=Ta.storeType;Vb.OwnerAddinSolutionId=Ta.ownerAddinSolutionId;Vb.OwnerAddinStoreType=Ta.ownerAddinStoreType;return Vb}static la(Ta){if(!Ta.$.da.Aa(232)){const Vb=new fb(Ta);Ta.$.da.Ha(232,Vb)}}}Object(c.a)(fb,
"DialogMessageReceivedEventManager",null,[723]);class ab{constructor(Ta,Vb){this.bB=null;this.yga=Ta;this.aJg=Vb}J1b(Ta){Ta&&(this.bB||(this.bB=[]),this.bB.push(Ta))}Twc(Ta){this.bB&&Array.remove(this.bB,Ta)}get eventId(){return this.yga}get targetId(){return this.aJg}get Bgi(){return 0<this.bB.length}vMi(Ta){return this.eventId!==Ta.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Ta.ddaBinding.Name:
!0}R4b(Ta){this.bB&&Array.forEach(this.bB,Vb=>{Vb(Ta)})}uoa(){this.bB=[]}}Object(c.a)(ab,"DdaEventRegistration",null,[]);class wb{constructor(Ta){this.jF=null;this.Exa=!1;this.$c=()=>{this.jF.forEach(Vb=>{Vb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Vb.R4b(new hc.a(Vb.eventId,"",null))})};this.gh=Ta}invokeDdaMethod(Ta,Vb){const qc={};qc[ib.a.$f]=Ta;qc[ib.a.v4]=Vb;this.gh.GK(974713501,qc)}registerDdaEventAsync(Ta,Vb,qc,Ic,gd){wb.lCb(Ta)?(wb.hsd(Ta)&&this.Kod(),this.jF||(this.jF=
[]),Vb=this.Lwb(Ta,qc),Vb||(Vb=new ab(Ta,qc),this.jF.push(Vb)),Vb.J1b(Ic),this.gh.Jv(gd)):this.gh.Lf(-1,gd)}unregisterDdaEventAsync(Ta,Vb,qc,Ic,gd){wb.lCb(Ta)?((Ta=this.Lwb(Ta,qc))&&Ta.Twc(Ic),this.gh.Jv(gd)):this.gh.Lf(-1,gd)}Kod(){this.Exa||(db.h(this.gh.$).ga.qM(this.$c),this.Exa=!0)}Lwb(Ta,Vb){if(!this.jF)return null;for(let qc=0;qc<this.jF.length;qc++){const Ic=this.jF[qc];if(Ic.eventId===Ta&&Ic.targetId===Vb)return Ic}return null}static lCb(Ta){return Ta===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static hsd(Ta){return Ta===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(wb,"EmbeddingPage",null,[692]);var kb=a(191);class tb extends hc.a{constructor(Ta,Vb,qc,Ic,gd,Kd,oe,Ce){super(Ta,Vb,qc);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Kd-Ic.Reference.FirstColumn;this.columnCount=Ce;Ta=Math.max(gd,Ic.Reference.FirstRow);gd=Math.min(gd+oe-1,Ic.Reference.LastRow);Ta>gd?this.startRow=this.rowCount=void 0:(this.startRow=Ta-Ic.Reference.FirstRow,this.rowCount=gd-Ta+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}
Object(c.a)(tb,"DdaBindingSelectionEventArgs",hc.a,[]);var hb=a(208),Fb=a(25),va=a(45),jb=a(53),Ab=a(426),Qa=a(33),Z=a(39),wa=a(579),Ea=a(125),fa=a(54),Ua=a(98),Aa=a(13),Ib=a(12),Pb=a(110);class Fa{}Fa.dEh="ewa-wx-disabled-div";Fa.cEh="ewa-wx-container-div";Fa.oVe="ewa-ptp-nov2-flex";Object(c.a)(Fa,"CssClassNames",null,[]);var da=a(70),K=a(109),xa=a(157),rb=a(41);const Qb=Fa.dEh,pc=Fa.cEh;class Lb extends kb.a{constructor(Ta,Vb,qc,Ic=!1){super();this.Zeb=0;this.jF=null;this.Exa=!1;this.Kuc=null;this.VU=
0;this.S8b=this.iXa=this.$9d=this.A7d=null;this.UPc=this.iee=!1;this.aTc=this.Vea=this.G4d=null;this.$c=()=>{this.enabled&&(this.NBj(),this.Kuc=va.d(db.h(this.$).ga.qa.selectedRanges))};this.ncf=gd=>{gd.controlId===this.Ed.InstanceId&&Array.forEach(this.jF,Kd=>{Kd.vMi(gd)&&Kd.R4b(gd)})};this.PCf=gd=>{if((gd=Object(Oa.a)(320,gd))&&!gd.Tt())if(!this.Ed||OSF.OsfControl.isFirstPartyStoreString(this.Ed.PrimaryMarketplace.MarketplaceType)||this.$.WP){gd.sf=this.Ed;gd.Jj=this.gh;this.G4d=gd;this.CAc(gd.WHa);
const Kd=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Qa.a.Md()&&Ib.HelperMethods.Tw(this.Ed)&&this.Ed.Preload&&!this.Ed.TaskpaneVisible;Kd?gd.HFd():Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(gd.HFd(),(this.Ed.SharedRuntime&&1===this.Ed.SharedRuntime.LifeTime||this.Ed.SharedRuntimeId)&&!this.Ed.TaskpaneVisible&&gd.$g(!1)):((this.Ed.SharedRuntime&&1===this.Ed.SharedRuntime.LifeTime||this.Ed.SharedRuntimeId)&&
!this.Ed.TaskpaneVisible&&gd.$g(!1),gd.HFd());this.T7a||(Qa.a.Md()?Kd||gd.E7():Ab.a(this.$).result.VI(gd,!0));this.$.da.Aa(77).BZf(this.PCf);this.qaa=Object(Oa.a)(340,gd)}else f.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(gd,Kd)=>{3===Kd.control.floatingObject.type&&Kd.control.floatingObject.Hl.InstanceId===this.Y1.WebExtensionId&&(this.qaa=Object(Oa.a)(340,Kd.control),this.CAc(Kd.control.Sd.firstChild),Pb.a(this.$).Nwc(this.onFloatingObjectControlAdded))};
this.pb=Ta.$;this.gh=Ta;this.Ed=qc;this.Ed.InstanceId=qc.SrcLocationOverrideResourceId?Ta.NLa(qc.InstanceId,qc.SrcLocationOverrideResourceId):qc.InstanceId;this.hh=Vb;this.Y1={};this.Y1.WebExtensionId=qc.InstanceId;this.GOf="osfControl_"+qc.InstanceId;this.cad="disabled_"+qc.InstanceId;this.Y1.BindingData=qc.BindingData;this.T7a=this.gh.T7a(qc.InstanceId);this.cjc=this.gh.cjc(qc.InstanceId);this.Mie=qc.WebExtensionOsfControlType;this.fSf=Ic}get controlId(){return this.Ed.InstanceId}get Ovi(){return this.UPc}Bni(Ta){this.Vea||
(this.Vea=Ta)}mZf(){this.Vea&&(this.Vea.dispose(),this.Vea=null)}get controlType(){return this.Ed.WebExtensionType}get ownerAddinSolutionId(){return this.Ed.OwnerAddinSolutionId}get $(){return this.pb}get enabled(){return!this.VU}get visible(){return this.Ed.TaskpaneVisible}get Hy(){return this.aTc}get qQ(){return this.Ed.SrcLocationOverrideResourceId?this.gh.NLa(this.Ed.PrimaryMarketplace.SolutionId,this.Ed.SrcLocationOverrideResourceId):this.Ed.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Ed.SrcLocationOverrideResourceId}get Hl(){return this.Ed}get qaa(){return this.A7d}set qaa(Ta){this.A7d=
Ta}get osfControlType(){return this.Mie}get Zua(){return this.$9d}set Zua(Ta){this.$9d=Ta}get R8b(){return this.iXa}set R8b(Ta){this.iXa=Ta}get focusOnIframeWhenLoaded(){return this.Ed.FocusOnIframeWhenLoaded}get dlc(){return this.iee}set dlc(Ta){this.iee=Ta}bqd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Ed.PrimaryMarketplace.MarketplaceType)&&Sa.EwaSettings.ya(174)){const Vb=Object(da.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(K.d)(xa.a.resolve(rb.f,{rb:0})):jb.GetServiceTaskFactory.Sa(this.$.da,
5,4,0);Z.TaskExtensions.za(Vb,()=>{Vb.result.eh(36,null)},this.ka,3);return this}if(1===this.Ed.WebExtensionType)Z.TaskExtensions.za(Ab.a(this.$),Vb=>{Vb.result.bub(this.$.da,77,5,this.PCf,1)},this.ka,3);else{var Ta=this.m_e();const Vb=Pb.a(this.$);Ta||(Ta={Type:3},Ta.Id=this.Y1.WebExtensionId,Ta.WebExtensionData=this.Ed,Ta.ContentHtml="<div/>",Ta.Version=0,Ta.AbsoluteLeft=0,Ta.AbsoluteTop=0,Ta.AbsoluteRight=0,Ta.AbsoluteBottom=0,Ta.Width=0,Ta.Height=0,Ta.ZOrder=0,Ta.OriginDeltaX=0,Ta.OriginDeltaY=
0,Ta=new hb.a(Ta),Vb.H7b(Ta,null),Ta=Vb.Hr(Ta.lh()));Ta?(this.CAc(Ta.Sd.firstChild),this.qaa=Object(Oa.a)(340,Ta)):Vb.B1b(this.onFloatingObjectControlAdded)}return this}shf(Ta){this.CAc(Ta);return this}crc(){this.fSf||this.gh.Jg.purgeOsfControl(this.controlId,!1);this.zlg(!0);const Ta=this.m_e();Ta&&Pb.a(this.$).deleteFloatingObject(Ta);this.gh.Mh.Tnj(this.controlId);this.gh.Mh.nSe(this.controlId,!0);this.aTc=null}TFd(Ta){this.Y1=Ta}invokeDdaMethod(Ta,Vb){if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled){var qc={};qc[ib.a.$f]=Ta;qc[ib.a.v4]=Vb;this.gh.GK(974713501,qc)}else this.gh.Lf(sb.a.xBb,Vb)}glj(Ta,Vb,qc,Ic){if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Lb.sth(Ta)||void 0!==Vb&&null!==Vb&&void 0!==this.U4a(Vb)&&null!==this.U4a(Vb))if(f.ULS.sendTraceTag(36444195,0,50,`eventId: ${Ta}, targetId: ${Vb}`),Lb.Ukf(Ta)&&this.zii(),Lb.hsd(Ta)&&this.Kod(),Lb.Skf(Ta))Sa.EwaSettings.ya(23)?this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Ic):(this.UPc=!0,this.gh.$.da.Aa(232).addHandler(this.controlId,qc,Ic,Vb));else if(Lb.Tkf(Ta))Sa.EwaSettings.ya(23)?this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ic):(this.UPc=!0,this.gh.$.da.Aa(232).CNg(this.controlId,qc,Ic));else{Lb.Rkf(Ta)&&this.pcf(-1777565636,Ic);this.jF||(this.jF=[]);var gd=this.Lwb(Ta,Vb);gd||(gd=new ab(Ta,Vb),this.jF.push(gd));gd.uoa();gd.J1b(qc);this.gh.Jv(Ic);Ta===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.iXa&&(this.S8b=qc)}else this.gh.Lf(3002,
Ic);else this.gh.Lf(-1,Ic)}a4j(Ta,Vb,qc,Ic){Lb.Skf(Ta)?Sa.EwaSettings.ya(23)?this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ic):this.gh.$.da.Aa(232).removeHandler(this.controlId,Ic):Lb.Tkf(Ta)?Sa.EwaSettings.ya(23)?this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ic):this.gh.$.da.Aa(232).koj(this.controlId,Ic):(Lb.Rkf(Ta)&&this.pcf(1592314317,Ic),Vb=this.Lwb(Ta,Vb),this.enabled?(Vb&&(Vb.Twc(qc),Vb.Bgi||Array.remove(this.jF,Vb),this.jF.length?Lb.Ukf(Ta)&&
this.Alg(!1):this.zlg(!1)),this.gh.Jv(Ic)):this.gh.Lf(-1,Ic))}la(Ta){Aa.DOMElementExtensions.getElementById(Ta,this.GOf)||Ta.appendChild(Aa.DOMElementExtensions.Hf(this.Hy))}showHide(Ta){Aa.DOMElementExtensions.setVisible(this.Hy,Ta)}resize(Ta,Vb){Aa.DOMElementExtensions.iw(this.Hy,Ta);Aa.DOMElementExtensions.pJ(this.Hy,Vb)}dPe(Ta){if(!this.VU&&!Aa.DOMElementExtensions.getElementById(this.Hy,this.cad)&&this.Hy){const Vb=document.createElement("div");Vb.id=this.cad;Vb.className=Qb;Vb.style.backgroundImage=
"url("+fa.a.current.io(103)+")";Vb.style.opacity=Ta?"1":"0";Vb.style.backgroundRepeat="no-repeat";Vb.style.backgroundPosition="center";this.Hy.insertBefore(Vb,this.Hy.firstChild)}this.VU++}gwh(){0<this.VU&&this.VU--;this.VU||(Aa.DOMElementExtensions.Hf(Aa.DOMElementExtensions.getElementById(this.Hy,this.cad)),this.Exa&&!va.R(this.Kuc,db.h(this.$).ga.qa.selectedRanges)&&this.$c(null,null))}U4a(Ta){if(!this.Y1||!this.Y1.BindingData)return null;for(let Vb=0;Vb<this.Y1.BindingData.length;Vb++)if(this.Y1.BindingData[Vb].Name===
Ta)return this.Y1.BindingData[Vb];return null}getDefaultIconUrl(){const Ta=this.F8e();return Ta?Ta.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Ed.TaskpaneTitle)return this.Ed.TaskpaneTitle;const Ta=this.F8e();return Ta?Ta.getDefaultDisplayName():null}iTf(){if(this.iXa&&this.S8b){const Ta=new hc.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.iXa);this.S8b(Ta);this.S8b=this.iXa=null}}$g(Ta){this.G4d&&this.G4d.$g(Ta)}QDj(){this.$.ea.isNamedObjectViewMode&&this.Xxi()&&
(this.$.da.Aa(34).PDj(this.Hy),this.showHide(!1));if(this.gh.Zbk){if(!this.fSf){const Ta={};Ta.div=this.Hy;Ta.id=this.Ed.InstanceId;Ta.solutionId=this.Ed.PrimaryMarketplace.SolutionId;Ta.version=this.Ed.PrimaryMarketplace.SolutionVersion;Ta.storeId=this.Ed.PrimaryMarketplace.MarketplaceRef;Ta.storeType=this.Ed.PrimaryMarketplace.MarketplaceType;Ta.ownerAddinSolutionId=this.Ed.OwnerAddinSolutionId;Ta.ownerAddinStoreType=this.Ed.OwnerAddinStoreType;this.Ed.AssetMarketplace?(Ta.assetId=this.Ed.AssetMarketplace.SolutionId,
Ta.assetStoreId=this.Ed.AssetMarketplace.MarketplaceRef):(Ta.assetId=null,Ta.assetStoreId=null);Ta.settings=this.Ed.OsfPropertyBag;Ta.hostSettings=this.Ed.HostPropertyBag;Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Ta.reason=this.T7a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.cjc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Ta.reason=this.T7a?
Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Ta.osfControlType=0===this.Ed.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Ta.isForUILessAction=4===this.Ed.WebExtensionOsfControlType;Ta.sourceLocationOverrideResourceId=this.Ed.SrcLocationOverrideResourceId;Ta.focusOnIframeWhenLoaded=this.Ed.FocusOnIframeWhenLoaded;wa.a(this.Ed)&&(Ta.featureGates=w.AFrameworkApplication.fa.U5e(Ta.solutionId));
Ta.hostInfoFlags=0;this.Zua&&(Ta.hostInfoFlags|=2);Ib.HelperMethods.Tw(this.Ed)&&(Ta.hostInfoFlags|=1);this.$.WP||(f.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Ta.hostInfoFlags|=4);Sa.EwaSettings.ya(553)&&(Ta.hostInfoFlags|=8);Ta.sharedRuntimeId=this.Ed.SharedRuntime?this.Ed.SharedRuntime.Resid:this.Ed.SharedRuntimeId;!Ib.HelperMethods.Tw(this.Ed)||this.Ed.Preload||wa.a(this.Ed)||this.gh.Jg.getOsfControl(a(760).DdaFacade.getSolutionId(this.Ed,this.$))||(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?
this.$.isEditMode&&this.gh.sNf(this.Ed):this.gh.sNf(this.Ed));Ta.initialDisplayMode=this.Ed.TaskpaneVisible?2:1;Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Ta.titleOverride=this.Hl.TaskpaneTitle);this.gh.Jg.insertOsfControl(Ta)}this.VU=0}else this.dPe(!0)}zlg(Ta){this.Alg(Ta);this.J3j()}zii(){this.Zeb||this.hh.J1b(this.ncf);this.Zeb++}Alg(Ta){0<this.Zeb&&(Ta?this.Zeb=0:this.Zeb--,this.Zeb||this.hh.Twc(this.ncf))}Kod(){if(!this.Exa){const Ta=db.h(this.$).ga;this.Kuc=
va.d(db.h(this.$).ga.qa.selectedRanges);Ta.qM(this.$c);this.Exa=!0}}J3j(){this.Exa&&(db.h(this.$).ga.jS(this.$c),this.Exa=!1)}IAj(Ta){var Vb=new Fb.Range(Ta.Reference.FirstRow+1,Ta.Reference.FirstColumn+1,Ta.Reference.LastRow+1,Ta.Reference.LastColumn+1,!1,!1);1===Ta.BindingType&&(Ta.HasHeaders&&--Vb.top,Ta.HasTotals&&(Vb.bottom+=1));var qc=db.h(this.$).ga.qa.selectedRanges;Ta=Vb.N7a(this.Kuc);qc=Vb.N7a(qc);return(Vb=Vb.ze(db.h(this.$).ga.qa.activeRange))&&(Ea.e(Ta)&&!Ea.e(qc)||!Ea.e(Ta)&&!Ea.e(qc)&&
!va.R(Ta,qc))?Vb:null}NBj(){Array.forEach(this.jF,Ta=>{if(Ta.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Ta.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.gh.Mh.Z2b(this.controlId))if(Ta.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Ta.R4b(new hc.a(Ta.eventId,this.controlId,null));else if(Ta.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Vb=this.U4a(Ta.targetId);if((null===Vb||void 0===Vb?0:Vb.IsValidRef)&&
(this.$.ea.isNamedObjectViewMode?this.$.Hb.na.sheetName:this.$.ua.na.name)===Vb.Reference.SheetName){const qc=this.IAj(Vb);qc&&Ta.R4b(new tb(Ta.eventId,this.controlId,this.gh.O3b(Vb),Vb,qc.top-1,qc.left-1,qc.height,qc.width))}}})}Lwb(Ta,Vb){if(!this.jF)return null;for(let qc=0;qc<this.jF.length;qc++){const Ic=this.jF[qc];if(Ic.eventId===Ta&&Ic.targetId===Vb)return Ic}return null}m_e(){const Ta=Pb.a(this.$).pV;for(let Vb=Ta.length-1;0<=Vb;--Vb){const qc=Ta[Vb];if(3===qc.floatingObject.type&&qc.floatingObject.Hl.InstanceId===
this.Y1.WebExtensionId)return qc}return null}Xxi(){for(let Ta=0;Ta<this.$.Hb.count;Ta++)if(this.$.Hb.getItem(Ta).imageId===this.Y1.WebExtensionId)return!0;return!1}CAc(Ta){this.aTc=Ta;this.Hy.id=this.GOf;this.Hy.className=pc;this.Hy.dir=this.$.isChromeRtl?"rtl":"ltr";this.QDj()}F8e(){if(!this.enabled)return null;const Ta=wa.a(this.Hl)?"":this.Hl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.Hl.PrimaryMarketplace.SolutionId,Ta)}pcf(Ta,Vb){if(Sa.EwaSettings.ya(23))this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Vb);else try{if(f.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Mie)this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Vb);else{const qc={};qc[ha.a.oqb]=this.controlId;const Ic=new Ua.a(Ta,0,this.$.isEditMode?2:1,0,null);this.$.Ia.Nb(Ic,qc);this.gh.Jv(Vb)}}catch(qc){f.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${qc.message}.`),this.gh.Lf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Vb)}}static sth(Ta){return Ta===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ta===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Ukf(Ta){return Ta===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Ta===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Ta===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static hsd(Ta){return Ta===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ta===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Skf(Ta){return Ta===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Tkf(Ta){return Ta===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Rkf(Ta){return Ta===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(Lb,"OsfControl",kb.a,[722]);class qb{constructor(){this.U_a={}}add(Ta){this.U_a[Ta]=!0}remove(Ta){delete this.U_a[Ta]}clear(){for(const Ta of Object.keys(this.U_a))delete this.U_a[Ta]}Edf(){return 0<Object.keys(this.U_a).length}bTh(){return Object.keys(this.U_a)}}Object(c.a)(qb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,
[]);var bc=a(59);class sc{constructor(Ta,Vb,qc){this.gYf=this.fYf=0;this.OOb=this.Gcb=null;this.SUi=()=>{var Ic=db.h(this.$).ga.Ra.aB;if(this.Rrd(Ic)&&(Ic=this.Xxb(Ic))){var gd={};gd.chartId=Ic;gd.worksheetId=this.Ska();gd=bc.a.Fc(gd);this.lka(51,Ic,gd);this.lka(51,this.Ska(),gd)}};this.TUi=()=>{if(this.Gcb){var Ic={};Ic.chartId=this.Gcb;Ic.worksheetId=this.OOb;Ic=bc.a.Fc(Ic);this.lka(52,this.Gcb,Ic);this.lka(52,this.OOb,Ic)}Ic=db.h(this.$).ga.Ra.aB;this.Rrd(Ic)?(this.Gcb=this.Xxb(Ic),this.OOb=this.Ska()):
this.OOb=this.Gcb=null};this.$=Ta;this.Mh=Vb;this.hh=qc}mrb(Ta){51===Ta.messageType?this.fYf=this.kIa(Ta.actionType,this.fYf,this.SUi):52===Ta.messageType&&(this.gYf=this.kIa(Ta.actionType,this.gYf,this.TUi))}kIa(Ta,Vb,qc){if(1===Ta)Vb||db.h(this.$).ga.Ra.TZc(qc),Vb++,this.JHj();else if(2===Ta){if(1>Vb)return Vb;1===Vb&&db.h(this.$).ga.Ra.gOd(qc);Vb--}return Vb}lka(Ta,Vb,qc){Vb&&this.Mh.qN(Ta,Vb)&&this.hh.DH(Ta,Vb,qc)}Xxb(Ta){return Ta&&Ta.floatingObject?(Ta=Ta.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===Ta.length?Ta[0]:null:null}Ska(){const Ta=this.$.ua.na;return Ta&&0===Ta.pG?Ta.sheetId:null}JHj(){const Ta=db.h(this.$).ga.Ra.aB;this.Rrd(Ta)&&(this.Gcb=this.Xxb(Ta),this.OOb=this.Ska())}Rrd(Ta){return!!Ta&&!!Ta.floatingObject&&0===Ta.floatingObject.type}}Object(c.a)(sc,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Tb=a(756),$a=a(195),Nb=a(626),Ra=a(106),ob=a(357),mb=a(60);class gb extends ka.a{constructor(Ta,Vb,qc){super();this.VU=this.oBa=0;this.$c=(Ic,gd)=>{if(this.enabled&&!(this.Omf()||
null!==gd&&void 0!==gd&&gd.lqf)&&(Ic=Object(Oa.a)(Ra.a,this.$.ua.na))&&0===Ic.pG){const Kd=Ic.sheetId,oe=this.T4e();let Ce=null,ze=null;this.Mh.$pf()&&(Ce=this.grid.wb.mh(this.grid.ga.qa.activeCell),ze=Kd in this.Zmc?this.Zmc[Kd]:null);this.Oxe(Kd,oe)&&Z.TaskExtensions.za(mb.Task.Ua(!0),()=>{this.Yfi(Kd,oe);this.Ifi(Kd,oe,Ce,ze)},this.ka);this.fQe(Kd,oe,Ce)}};this.$=Ta;this.Mh=Vb;this.hh=qc;this.grid=db.h(Ta);this.jPa={};this.Zmc={}}get enabled(){return!this.VU&&0<this.oBa}v3b(Ta){Object(Oa.a)(ob.a,
this.$.ua);1===Ta.actionType?(this.oBa||this.grid.ga.qM(this.$c),this.oBa++):2!==Ta.actionType||1>this.oBa||(1===this.oBa&&this.grid.ga.jS(this.$c),this.oBa--)}mAc(Ta){Ta?this.VU++:(0<this.VU&&this.VU--,this.VU||this.$c(null,new Nb.a(!1)))}T4e(){return this.grid.ga.qa.selectedRanges}Oxe(Ta,Vb){return Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!Ta&&$a.e(this.jPa)||Ta in this.jPa)&&!va.R(this.jPa[Ta],Vb):Ta in this.jPa&&!va.R(this.jPa[Ta],
Vb)}fQe(Ta,Vb,qc){this.jPa[Ta]=va.d(Vb);this.Zmc[Ta]=qc}Omf(){return this.grid.jb||this.grid.ni}L_e(Ta,Vb){this.Mh.qN(14,Ta)&&this.hh.DH(14,Ta,Vb);this.Mh.qN(14,Tb.a.sL)&&this.hh.DH(14,Tb.a.sL,Vb)}Yfi(Ta,Vb){const qc={};qc.worksheetId=Ta;qc.address=this.Ukd(Vb);Vb=bc.a.Fc(qc);this.L_e(Ta,Vb)}Ifi(Ta,Vb,qc,Ic){if(this.Mh.$pf()){var gd="";let Kd="";Ic&&(gd=Ic.sj);qc&&(Kd=qc.sj);Ic?qc?(Vb=qc.usedRange.N7a(Vb),gd!==Kd&&this.wcc(gd,"",Ta),this.wcc(Kd,this.Ukd(Vb),Ta)):this.wcc(gd,"",Ta):qc&&(gd=qc.usedRange.N7a(Vb),
this.wcc(Kd,this.Ukd(gd),Ta))}}wcc(Ta,Vb,qc){if(this.Mh.qN(100,Ta)){const Ic={};Ic.address=Vb;Ic.worksheetId=qc;this.hh.DH(100,Ta,bc.a.Fc(Ic))}}Ukd(Ta){return va.i(Ta,",",this.$,!1)}dispose(){0<this.oBa&&this.grid.ga.jS(this.$c);this.Zmc=this.jPa=null;this.oBa=0;this.hh=this.Mh=this.$=this.grid=null}}Object(c.a)(gb,"RichApiEventSelectionChangedHandler",ka.a,[]);var lb=a(353);class Xb extends gb{constructor(Ta,Vb,qc){super(Ta,Vb,qc);this.gsf=this.hsf=null}T4e(){return lb.a.mub(this.grid.ga.rangePicker.fL)}Oxe(Ta,
Vb){return this.hsf!==Ta||!va.R(this.gsf,Vb)}fQe(Ta,Vb){this.hsf=Ta;this.gsf=va.d(Vb)}Omf(){return!this.grid.jb&&!this.grid.ni}L_e(Ta,Vb){this.Mh.qN(2700,Tb.a.sL)&&this.hh.DH(2700,Tb.a.sL,Vb)}}Object(c.a)(Xb,"RichApiEventPickedRangesChangedHandler",gb,[]);class Xd{constructor(Ta,Vb,qc){this.eSa=this.dSa=0;this.KIa=this.Fia=null;this.rGf=()=>{var Ic=db.h(this.$).ga.Ra.aB;if(0<this.eSa&&this.Fia&&this.KIa){var gd={};gd.shapeId=this.Fia;gd.worksheetId=this.KIa;gd=bc.a.Fc(gd);this.fireEvent(2102,this.Fia,
gd)}this.Szi(Ic)?(this.Fia=this.j2j(Ic),this.KIa=this.Ska(),this.Fia&&this.KIa)?0<this.dSa&&(Ic={},Ic.shapeId=this.Fia,Ic.worksheetId=this.KIa,Ic=bc.a.Fc(Ic),this.fireEvent(2101,this.Fia,Ic)):f.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Fia}', or worksheet id: '${this.KIa}' from a Floating object or gridview.`):this.KIa=this.Fia=null};this.$=Ta;this.Mh=Vb;this.hh=qc}mrb(Ta){const Vb=db.h(this.$).ga;1===Ta.actionType?(this.dSa||this.eSa||Vb.Ra.TZc(this.rGf),
2101===Ta.messageType?this.dSa++:2102===Ta.messageType&&this.eSa++):2===Ta.actionType&&(2101===Ta.messageType?this.dSa=0<this.dSa?this.dSa-1:0:2102===Ta.messageType&&(this.eSa=0<this.eSa?this.eSa-1:0),this.dSa||this.eSa||Vb.Ra.gOd(this.rGf))}Szi(Ta){return!!Ta&&!!Ta.floatingObject&&(0===Ta.floatingObject.type||7===Ta.floatingObject.type||1===Ta.floatingObject.type||3===Ta.floatingObject.type||5===Ta.floatingObject.type)}j2j(Ta){if(!Ta||!Ta.floatingObject)return null;Ta=Ta.floatingObject.id;var Vb=
Ta.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Vb=Vb&&1===Vb.length?Vb[0]:null;return Vb?Vb:(f.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${Ta}', but we failed.`),null)}Ska(){const Ta=this.$.ua.na;return Ta&&0===Ta.pG?Ta.sheetId:null}fireEvent(Ta,Vb,qc){Vb&&this.Mh.qN(Ta,Vb)&&this.hh.DH(Ta,Vb,qc)}}Object(c.a)(Xd,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Qd{constructor(Ta,Vb,qc){this.jYf=this.iYf=this.kYf=this.hYf=
0;this.g7i=(Ic,gd)=>{Ic=Object(Oa.a)(Ra.a,gd.na);this.L9a(Ic)&&(gd={},gd.worksheetId=Ic.sheetId,gd=bc.a.Fc(gd),this.lka(11,Ic.sheetId,gd))};this.j7i=(Ic,gd)=>{Ic=Object(Oa.a)(Ra.a,gd.RB);this.L9a(Ic)&&(gd={},gd.worksheetId=Ic.sheetId,gd=bc.a.Fc(gd),this.lka(12,Ic.sheetId,gd))};this.h7i=(Ic,gd)=>{Ic=Object(Oa.a)(Ra.a,gd.na);this.L9a(Ic)&&(gd={},gd.worksheetId=Ic.sheetId,Ic=bc.a.Fc(gd),this.lka(11,null,Ic,!0))};this.i7i=(Ic,gd)=>{Ic=Object(Oa.a)(Ra.a,gd.RB);this.L9a(Ic)&&(gd={},gd.worksheetId=Ic.sheetId,
Ic=bc.a.Fc(gd),this.lka(12,null,Ic,!0))};this.$=Ta;this.Mh=Vb;this.hh=qc}mrb(Ta){11===Ta.messageType?Ta.targetId===Tb.a.sL?this.nYg(Ta.actionType):this.mYg(Ta.actionType):12===Ta.messageType&&(Ta.targetId===Tb.a.sL?this.oYg(Ta.actionType):this.pYg(Ta.actionType))}mYg(Ta){this.hYf=this.kIa(Ta,this.hYf,this.g7i)}pYg(Ta){this.kYf=this.kIa(Ta,this.kYf,this.j7i)}nYg(Ta){this.iYf=this.kIa(Ta,this.iYf,this.h7i)}oYg(Ta){this.jYf=this.kIa(Ta,this.jYf,this.i7i)}kIa(Ta,Vb,qc){1===Ta?Vb=this.jIa(Vb,qc):2===Ta&&
(Vb=this.lKa(Vb,qc));return Vb}jIa(Ta,Vb){Ta||this.$.ua.kg(Vb);Ta++;return Ta}lKa(Ta,Vb){if(1>Ta)return Ta;1===Ta&&this.$.ua.Gg(Vb);Ta--;return Ta}L9a(Ta){return!!Ta&&0===Ta.pG}lka(Ta,Vb,qc,Ic=!1){Vb=Ic?Tb.a.sL:Vb;this.Mh.qN(Ta,Vb)&&this.hh.DH(Ta,Vb,qc)}}Object(c.a)(Qd,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var te=a(246),Pc=a(16),Ne=a(229);class Hb extends Sys.EventArgs{constructor(Ta,Vb,qc,Ic){super();this.sheet=Ta;this.G6g=Vb;this.offsetX=qc;this.offsetY=Ic}}Object(c.a)(Hb,"ClickInActiveCellEventArgs",
Sys.EventArgs,[]);class pb{constructor(Ta,Vb,qc){this.h6b=null;this.Rvd=!1;this.onPointerDown=Ic=>{let gd;3===Ic.Cb?({Z1a:gd}=this.gridView.Kdc(Ic.clientPoint),this.Rvd=!!gd&&this.gridView.ga.qa.lQe(gd)):this.Rvd=!1;this.h6b=Ic.clientPoint;return!1};this.od=Ic=>{if(this.gridView.inRangePicker||this.gridView.ni||this.Rvd||Ic.shiftKey||Ic.ctrlKey||Ic.Da.button!==Sys.UI.MouseButton.leftButton||!this.h6b||!Ic.clientPoint||Ic.clientPoint.x!==this.h6b.x||Ic.clientPoint.y!==this.h6b.y)return!1;const gd=
({Z1a:Ic}=this.gridView.Kdc(Ic.clientPoint)).returnValue,Kd=Object(Oa.a)(Ra.a,this.$.ua.na);if(gd&&Kd&&0===Kd.pG){if(!this.gridView.ga.qa.h5.contains(Ic))return!1;Ic=new Hb(Kd,Ic,Ib.HelperMethods.IId(gd.x),Ib.HelperMethods.IId(gd.y));this.k7i(Ic)}return!1};this.$=Ta;this.gridView=db.h(Ta);this.Mh=Vb;this.hh=qc;this.Imj()}dispose(){this.z4j()}Imj(){for(const Ta of this.gridView.Un){const Vb=Ta.domElement;te.a.instance.ta(Pc.a.pointerDown,Vb,this.onPointerDown);Ne.a.instance.ta(Pc.a.click,Vb,this.od)}}z4j(){for(const Ta of this.gridView.Un){const Vb=
Ta.domElement;te.a.instance.Ba(Pc.a.pointerDown,Vb,this.onPointerDown);Ne.a.instance.Ba(Pc.a.click,Vb,this.od)}}k7i(Ta){var Vb=Ta.sheet;if(this.L9a(Vb)){var qc={};qc.worksheetId=Vb.sheetId;qc.address=Ta.G6g.toString();qc.offsetX=Ta.offsetX;qc.offsetY=Ta.offsetY;Ta=Vb.sheetId;this.Mh.qN(21,Ta)&&(Vb=bc.a.Fc(qc),this.hh.DH(21,Ta,Vb));Ta=Tb.a.sL;this.Mh.qN(21,Ta)&&(qc=bc.a.Fc(qc),this.hh.DH(21,Ta,qc))}}L9a(Ta){return!!Ta&&0===Ta.pG}}Object(c.a)(pb,"RichApiEventSingleClickedHandler",null,[]);class mc{constructor(Ta,
Vb,qc){this.cLb=0;this.tcb=this.Dcb=null;this.FNf=()=>{const Ic=db.h(this.$).ga.Ra.aB;if(Ic)if(this.Mqf(Ic)){const gd=this.Ska();this.hfd(gd);this.Dcb=Ic.floatingObject.id;this.tcb=gd}else this.Dcb&&(this.hfd(this.tcb),this.tcb=this.Dcb=null);else this.Dcb&&(this.hfd(this.tcb),this.tcb=this.Dcb=null)};this.$=Ta;this.Mh=Vb;this.hh=qc}v3b(Ta){2E3===Ta.messageType&&(1===Ta.actionType?(this.cLb||db.h(this.$).ga.Ra.TZc(this.FNf),this.cLb++,this.XDj()):2===Ta.actionType&&this.cLb&&(1===this.cLb&&db.h(this.$).ga.Ra.gOd(this.FNf),
this.cLb--))}hfd(Ta){var Vb;const qc={};qc.worksheetId=Ta;qc.revisionLoad=!1;if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(Sa.EwaSettings.ya(616)||Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Ic=db.h(this.$).ga.Ra.aB;(null===(Vb=null===Ic||void 0===Ic?void 0:Ic.floatingObject)||void 0===Vb?0:Vb.jd)?qc.selectedVisualId=Ic.floatingObject.jd.VisualID:qc.selectedVisualId=null}Vb=
bc.a.Fc(qc);Ta&&this.Mh.qN(2E3,Ta)&&this.hh.DH(2E3,Ta,Vb)}Ska(){const Ta=this.$.ua.na;return Ta&&0===Ta.pG?Ta.sheetId:null}XDj(){const Ta=db.h(this.$).ga.Ra.aB;this.Mqf(Ta)&&(this.Dcb=Ta.floatingObject.id,this.tcb=this.Ska())}Mqf(Ta){return!!Ta&&Ta.pwd()}}Object(c.a)(mc,"RichApiEventVisualSelectionChangedHandler",null,[]);class Kc{constructor(Ta,Vb,qc){this.dLb=0;this.Crg=!0;this.Kcc=0;this.Mud=!0;this.AEe=()=>{const Ic=document.hasFocus();if(this.Crg!==Ic){if(Ic){const gd=bc.a.Fc({});this.hh.DH(2203,
Tb.a.sL,gd)}this.Crg=Ic}};this.BEe=Ic=>{(0<Ic.timeRemaining()||Ic.didTimeout)&&this.AEe();window.requestIdleCallback(this.BEe)};this.$=Ta;this.Mh=Vb;this.hh=qc;window.requestIdleCallback||(this.Mud=!1)}lYg(Ta){1===Ta.actionType?(this.dLb||this.DYg(),this.dLb++):2!==Ta.actionType||1>this.dLb||(1===this.dLb&&this.eqh(),this.dLb--)}DYg(){if(this.Mh.qN(2203,Tb.a.sL))if(this.Mud){const Ta={};Ta.timeout=this.$.xa.CheckFocusTimeout;this.Kcc=window.requestIdleCallback(this.BEe,Ta)}else this.Kcc=window.setInterval(this.AEe,
this.$.xa.CheckFocusTimeInterval)}eqh(){this.Mud?window.cancelIdleCallback(this.Kcc):window.clearInterval(this.Kcc)}}Object(c.a)(Kc,"RichApiEventWorkbookActivatedHandler",null,[]);var Nc;(function(Ta){Ta[Ta.none=0]="none";Ta[Ta.registerEvent=1]="registerEvent";Ta[Ta.unregisterEvent=2]="unregisterEvent";Ta[Ta.customFunction=3]="customFunction";Ta[Ta.showCard=4]="showCard";Ta[Ta.createWorkbook=5]="createWorkbook";Ta[Ta.openWorkbook=6]="openWorkbook";Ta[Ta.enableEvents=7]="enableEvents";Ta[Ta.closeWorkbook=
8]="closeWorkbook";Ta[Ta.setCalculationMode=9]="setCalculationMode";Ta[Ta.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Ta[Ta.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Ta[Ta.workbookLinksEnableContent=12]="workbookLinksEnableContent";Ta[Ta.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Ta[Ta.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Ta[Ta.rangePicker=15]="rangePicker";Ta[Ta.enableRichApiRecording=16]="enableRichApiRecording";Ta[Ta.recordAction=
17]="recordAction";Ta[Ta.focus=18]="focus";Ta[Ta.businessBarShow=19]="businessBarShow";Ta[Ta.businessBarHide=20]="businessBarHide";Ta[Ta.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";Ta[Ta.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";Ta[Ta.showRangeValuesPreview=23]="showRangeValuesPreview";Ta[Ta.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(Nc||(Nc={}));Object(c.b)("PostProcessActionType",Nc);var pd=a(261);class Vd{constructor(Ta,Vb,qc){this.HOf=
null;this.ffd=(Ic,gd)=>{const Kd=Tb.a.sL,oe={};oe.eventId=Ic;oe.payload=gd;this.Mh.qN(2201,Kd)&&this.hh.DH(2201,Kd,bc.a.Fc(oe))};this.$=Ta;this.Mh=Vb;this.hh=qc;this.bni()}kYg(Ta){1===Ta.actionType?(this.$.Qca=!0,Object(Oa.a)(a(760).DdaFacade,pd.a(this.$)).gfd(!0)):2===Ta.actionType&&(this.$.Qca=!1);this.HOf=Ta.controlId;f.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${Nc[Ta.actionType]}; controlId: ${this.HOf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Qca}.`)}wxh(Ta){Object(Oa.a)(a(760).DdaFacade,
pd.a(this.$)).O_e(Ta,this.$.Qca)}bni(){this.$.uR&&Z.TaskExtensions.za(jb.GetServiceTaskFactory.Sa(this.$.da,297,298,1),Ta=>{(Ta=Ta.result)&&Ta.init(this.ffd)},this.$.ka,3)}}Object(c.a)(Vd,"RichApiMacroRecorderEventHandler",null,[]);class $d{}Object(c.a)($d,"StyleCacheItem",null,[]);class ue{constructor(Ta,Vb,qc){this.$=Ta;this.gridView=Vb;this.eg=qc}tia(Ta){this.range=Ta;this.y6b=Array(Ta.width);this.rDc=Array.from({length:Ta.height},()=>Array(Ta.width))}GDj(Ta,Vb,qc,Ic){this.Wof(Ta,Vb)&&(this.rDc[Ta-
this.range.top][Vb-this.range.left]||(this.rDc[Ta-this.range.top][Vb-this.range.left]={backgroundColor:qc.backgroundColor}),qc.backgroundColor=Ic)}IDj(Ta,Vb,qc){if(this.Wof(Ta,Vb)){Ta=Fb.Range.Lc(Ta,Vb);var Ic=this.gridView.Ob(Ta);Ic&&(this.y6b[Vb-this.range.left]||(this.y6b[Vb-this.range.left]=Ic.width),Vb=this.eg.aXd(this.gridView,[Ta],qc,!1),"Success"!==Vb.kind&&f.ULS.sendTraceTag(509223560,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${Vb.reason}`))}}restore(){this.range&&
(this.y6b.forEach((Ta,Vb)=>{Ta=this.eg.aXd(this.gridView,[Fb.Range.Lc(this.range.top,this.range.left+Vb)],Ta,!1);"Success"!==Ta.kind&&f.ULS.sendTraceTag(509220497,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${Ta.reason}`)}),this.rDc.forEach((Ta,Vb)=>{Ta.forEach((qc,Ic)=>{Ic=Fb.Range.Lc(this.range.top+Vb,this.range.left+Ic);if(Ic=this.gridView.Ob(Ic))Ic.cell.backgroundColor=qc.backgroundColor})}),this.y6b=this.rDc=this.range=void 0)}Wof(Ta,Vb){if(!this.range)return f.ULS.sendTraceTag(509223559,
0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),!1;(Ta=this.range.contains(Fb.Range.Lc(Ta,Vb)))||f.ULS.sendTraceTag(509223558,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");return Ta}}Object(c.a)(ue,"InstantaneousGridContentRestorer",null,[]);var he=a(218),Ge=a(137);class Ad{constructor(Ta,Vb,qc,Ic){this.Y5h=gd=>{const Kd=gd.hd.block;if(this.Xt.ze(Kd.Ge)){this.VQf([Kd.Ge]);const oe=db.h(this.$).VX(Kd.Ge),
Ce=()=>this.NQf([Kd.Ge]);setTimeout(()=>{oe.skeletonMode?setTimeout(()=>{oe.skeletonMode?f.ULS.sendTraceTag(509220498,0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time"):Ce()},Ad.aug):Ce()},Ad.Oug)}};this.FQa=(gd,Kd)=>{0===Kd.er&&576!==Kd.Of.operation.operationName&&this.zAb(!0)};this.pGd=gd=>{this.iCc&&(this.JMh(gd),this.Y0())};this.$=Ta;this.Mh=Vb;this.hh=qc;this.gridView=db.h(this.$);this.Hic=new ue(this.$,this.gridView,Ic)}Bfi(Ta,Vb,qc,Ic){this.kof(Ta)?
(Vb=this.J4g(Vb,qc))?this.DRa?f.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):(this.worksheetId=Ta,this.Xt=Vb,this.values=qc,this.zpa(Ic)):f.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):f.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}Odi(Ta){this.kof(Ta)?
this.zAb(!1):f.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}zpa(Ta){this.VQf(this.y3e());Ta&&(f.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(Ta)}`),Ta.autoexpandTable&&this.N4g(),Ta.autofitColumns&&this.n4g());this.iCc=this.gridView.jO.zpa(this.Xt,this.Y5h).then(Vb=>{f.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");
this.DRa=Vb;this.Hic.tia(this.Xt);this.NQf(this.y3e());this.$.userOperationManager.tr(this.FQa);Vb.O2f.then(()=>this.pGd(!0),()=>this.pGd(!0));return Promise.resolve()},Vb=>{f.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${Vb}`);this.Y0();return Promise.resolve()})}zAb(Ta){this.iCc&&(f.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),
this.iCc.then(()=>{const Vb=this.DRa;this.pGd(Ta);Vb&&Vb.Hla("RichApiRangeValuesPreview")},()=>{f.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}J4g(Ta,Vb){Ta=va.ab(Ta,this.$.ua);if(Ta.returnValue)return new Fb.Range(Ta.range.top,Ta.range.left,Ta.range.top+Vb.length-1,Ta.range.left+Vb[0].length-1,!0,!0)}kof(Ta){const Vb=this.$.ua.na;return Vb&&Ta===Vb.sheetId}VQf(Ta){this.Vfd(Ta,(Vb,qc,Ic,gd)=>{gd.cell.Ccb=this.values[Vb][qc];
return!0})}NQf(Ta){this.Cpa&&this.Vfd(Ta,(Vb,qc,Ic,gd)=>{this.Hic.GDj(Ic.top,Ic.left,gd,this.KZh(Ic.top));return!0});if(this.N0a){const Vb=this.Xt.N7a(Ta);0<Vb.length&&this.N0a&&this.N0a.forEach((qc,Ic)=>{this.Hic.IDj(Vb[0].top,this.Xt.left+Ic,qc)})}}Vfd(Ta,Vb){for(let Ic=0;Ic<this.values.length;++Ic)for(let gd=0;gd<this.values[Ic].length;++gd){const Kd=Fb.Range.Lc(this.Xt.top+Ic,this.Xt.left+gd);if(!Ta||Ta.some(oe=>oe.contains(Kd))){var qc=this.gridView.Ku(Kd);if((!qc||Kd.equals(qc.topLeft))&&(qc=
this.gridView.Ob(Kd))&&!Vb(Ic,gd,Kd,qc))return}}}y3e(){return this.gridView.Ca.uy().filter(Ta=>Ta.na===this.$.na).map(Ta=>Ta.Ge)}JMh(Ta){this.Mh.qN(3400,this.worksheetId)&&(Ta=bc.a.Fc({type:"RangeValuesPreviewDismissed",source:"Local",ffk:Ta}),this.hh.DH(3400,this.worksheetId,Ta))}Y0(){this.$.userOperationManager.ro(this.FQa);this.Nvj();this.Cpa=this.worksheetId=this.iCc=this.values=this.Xt=this.DRa=void 0}N4g(){if(this.Xt){var Ta=this.J9h(this.Xt);if(Ta){f.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");
var Vb=(Kd,oe)=>{var Ce;return null===(Ce=this.gridView.Ob(Fb.Range.Lc(Kd,oe)))||void 0===Ce?void 0:Ce.backgroundColor},qc=Ta.usedRange.top;if(Ta.attributes&16){var Ic=Vb(Ta.usedRange.top,Ta.usedRange.left);++qc}var gd=Vb(qc,Ta.usedRange.left);Vb=Vb(qc+1,Ta.usedRange.left);this.Cpa={rjg:Ta.usedRange.top,hod:Ic,C_j:gd,U_g:Vb}}else f.ULS.sendTraceTag(509223561,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else f.ULS.sendTraceTag(509227291,
0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}n4g(){this.N0a=Array(this.Xt.width);let Ta=!1;this.Vfd(void 0,(Vb,qc,Ic,gd)=>{var Kd;if(this.gridView.Ku(Ic))return Ta=!0,!1;Vb=gd.cell;Vb=Vb.xIe(Vb.Ccb);Vb>gd.width&&(this.N0a[qc]=Object(Ge.a)(null!==(Kd=this.N0a[qc])&&void 0!==Kd?Kd:0,Vb));return!0});Ta&&(this.N0a=void 0)}Nvj(){this.Hic.restore();va.z(this.Xt,(Ta,Vb)=>{Ta=Fb.Range.Lc(Ta,Vb);if(Ta=this.gridView.Ob(Ta))Ta.cell.Ccb=
void 0})}KZh(Ta){return this.Cpa.hod&&Ta===this.Cpa.rjg?this.Cpa.hod:0===(Ta-this.Cpa.rjg-(this.Cpa.hod?1:0))%2?this.Cpa.C_j:this.Cpa.U_g}J9h(Ta){const Vb=he.b(this.gridView.$,Ta,!0);if(!(1<Vb.length)){var qc=gd=>{var Kd;const oe=null!==(Kd=this.gridView.wb.I9h(gd))&&void 0!==Kd?Kd:this.gridView.wb.K9h(gd);if(oe)return oe},Ic=qc(Ta);if(Ic&&0===Vb.length)return Ic;if(0!==Vb.length&&(Ta=va.Y(Ta,Vb[0].usedRange),1===Ta.length))return qc(Ta[0])}}}Ad.Oug=20;Ad.aug=100;Object(c.a)(Ad,"RichApiRangeValuesPreview",
null,[]);class Ie{}Object(c.a)(Ie,"SessionRecreationInfo",null,[]);class me{constructor(Ta,Vb,qc){this.$=Ta;this.Mh=Vb;this.runtimeCalculationMode=qc}lQi(){return Sa.EwaSettings.ya(234)?this.Mh.Ngi()||0!==this.runtimeCalculationMode:!1}s2g(){var Ta={};Ta.eventRegistrationInfos=this.Mh.tZh();Ta.runtimeCalculationMode=this.runtimeCalculationMode;Ta=Object(b.a)(new Ie,{runtimeState:Ta});const Vb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Vb.RequestBody=JSON.stringify(Ta);
Vb.RequestFlags=1;return Vb}}Object(c.a)(me,"RichApiRuntimeStateHandler",null,[]);class cc{constructor(Ta,Vb,qc,Ic,gd,Kd,oe,Ce,ze){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Ta;this.processUtcTime=Vb;this.dequeueUtcTime=qc;this.inQueueDurationInMS=Ic;this.executionDurationInMS=gd;this.operationCount=Kd;this.ServerCorrelationId=
oe;this.UserOperationName=Ce;this.IsDocumentHidden=ze}}Object(c.a)(cc,"UserOperationQueueItemsStatisticsData",null,[]);var $c=a(337),rd=a(35),Nd=a(19),ed=a(305),yd=a(52),Ed=a(608),Ud=a(73),fe=a(61),We=a(77);class lf extends $c.a{constructor(Ta,Vb,qc){super(qc,Ta);this.gxa=this.hashCode=null;this.h7b=!1;this.qn=(Ic,gd)=>{gd.hd.hash===this.hashCode&&this.gxa&&Object(Oa.a)(a(760).DdaFacade,this.$.da.Aa(35)).mPj(this.gxa.InstanceId)};this.xf=(Ic,gd)=>{switch(gd.hd.block.state){case 1:case 3:case 5:this.ifa(gd)}};
this.Pj=()=>{this.uKb(!0)};this.Qo=(Ic,gd)=>{this.isVisible&&this.BVa(gd.RB);this.clearCache()};this.he=(Ic,gd)=>{this.GUa(gd.na,!!gd.RB)};this.ix=()=>{this.$.ea.Una()};this.hWa=Vb;this.domElement.classList.add(rd.a.ibc);this.domElement.classList.add(Nd.a.ms);qc.tabIndex=0;this.GUa(this.$.na,!1);this.Pc.la("mousedown",this.ix);this.Pc.la("contextmenu",Ic=>{We.g(Ic)});this.$.ua.PJ(this.Qo);this.$.Hb.PJ(this.Qo);this.$.Hb.kg(this.he);this.$.ua.kg(this.he);this.Ca.uu(this.xf);this.Ca.hH(this.qn);this.Ca.vw(this.Pj);
this.vv(this.aAa)}get Ca(){return this.hWa}dispose(){this.$&&(this.$.ua.nL(this.Qo),this.$.Hb.nL(this.Qo),this.$.Hb.Gg(this.he),this.$.ua.Gg(this.he));this.hWa&&(this.hWa.Ls(this.xf),this.hWa.KI(this.qn),this.hWa.sx(this.Pj));this.My(this.aAa);this.clearCache();nb.a.Ja(this.hWa);this.hWa=null;Aa.DOMElementExtensions.Hf(this.domElement);super.dispose()}PDj(Ta){Aa.DOMElementExtensions.Hf(Aa.DOMElementExtensions.getElementById(this.domElement,Ta.id));this.domElement.appendChild(Ta)}pqd(){if(this.gxa&&
!this.h7b){var Ta=Object(Oa.a)(a(760).DdaFacade,pd.a(this.$)).Kn(this.gxa.InstanceId);Ta&&(Ta.resize(this.gxa.Width,this.gxa.Height),Ta.la(this.domElement),Ta.showHide(!0),this.h7b=!0)}}N9a(){return!0}ifa(Ta){this.gxa=Ta.hd.block.me;this.h7b=!1;this.pqd()}BVa(Ta){this.$.ea.V5&&Ta&&(Ta.kv||(Ta.kv=new ed.a),Ta.kv.Ai=new yd.a(this.domElement.scrollLeft,this.domElement.scrollTop),Ta.kv.NJb=20)}clearCache(){this.Ca.iSa(this.hashCode);this.gxa=this.hashCode=null;this.h7b=!1}GUa(Ta,Vb){if(this.isVisible=
!!Ta&&Ud.o(Ta))this.hashCode=this.Ca.sta(Ta,fe.a.f9b,this.hashCode),this.PAc(Vb)}static lIa(Ta){if(!Ta.da.Aa(34)){const Vb=Ta.Df;Ta.da.Ha(34,new lf(Ta,new Ed.a(Ta,Ta.ea,Ta.pa.dl,3,0),Vb.appendChild(Vb.ownerDocument.createElement("div"))))}}}Object(c.a)(lf,"WebExtensionView",$c.a,[720,237,2]);var Se=a(231),Ae=a(380),Qe=a(445),$e=a(199),of=a(65),re=a(120),zf=a(51),Lf=a(47),Ze=a(168),ec=a(118),Lc=a(64),Da=a(31),Cb=a(32),Zb=a(258),yc=a(23),Vc=a(15),jd=a(293),ld=a(754),Bd=a(55),Td=a(148),Jd=a(849);const ce=
Ta=>{Td.a.sendOtelEvent(Object.assign(new Jd.a,{otelEvent:Ta}))},ie=Ta=>{Td.a.sendOtelCustomerContent(Object.assign(new Jd.a,{otelEvent:Ta}))};var we=a(895),zc=a(26),Sc=a(159),td=a(741);class Md{constructor(Ta,Vb,qc){this.Xvc=0;this.dqe=new Set;this.Fof=!1;this.$=Ta;this.Mh=Vb;this.hh=qc}jYg(Ta){1===Ta.actionType?this.Mh.qN(65541,Tb.a.sL)?this.Xvc++:f.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===Ta.actionType&&0<this.Xvc&&this.Xvc--}SCf(Ta,Vb){if(0===
this.Xvc)f.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(Vb){Ta=Vb.jH;var qc=[];qc.push({content:JSON.stringify(Vb.jH),annotationType:td.a.exa(Ta),id:Ta.id});this.hh.DH(65541,Tb.a.sL,JSON.stringify({annotationProperties:qc}))}else f.ULS.sendTraceTag(509649752,0,10,"Event args are null")}Lci(Ta){return Object(Sc.a)(this,void 0,void 0,function*(){if(!this.Mh.qN(65541,Tb.a.sL))f.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!this.dqe.has(Ta.annotationType)){var Vb=
yield jb.GetServiceTaskFactory.bR(this.$.da,328,327,1);Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7694128_RichAPIUseNewALAPI")?(this.Fof||(Vb.register(Vb.l5().B8("RichApi").A8(()=>{}).build()),this.Fof=!0),Vb.Dea("RichApi",{annotationType:Ta.annotationType,Ay:!1,TR:this.SCf.bind(this)})):(Vb.bpb(Ta.annotationType),Vb.qta(Ta.annotationType,this.SCf.bind(this)));this.dqe.add(Ta.annotationType)}})}Mci(Ta){return Object(Sc.a)(this,void 0,void 0,function*(){(yield jb.GetServiceTaskFactory.bR(this.$.da,
328,327,1)).gQb(JSON.parse(Ta.content));f.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${Ta.signalType}`)})}}Object(c.a)(Md,"RichApiAugmentationLoopHandler",null,[]);a.d(C,"DdaFacade",function(){return wd});class wd extends ma.a{constructor(Ta,Vb,qc){super();this.hh=this.Jl=this.ea=null;this.yf=[];this.JKa=null;this.disposed=this.initialized=this.XSb=this.AMe=!1;this.ODa=null;this.ktc=[];this.uMe=[];this.jRa=[];this.p3a=null;this.zId=new Ma.a(I.a.$h());this.b2b=new N.a(I.a.$h());this.vJb=
[];this.dQf=[];this.Zub=350;this.Nya=this.ega=null;this.JXc=!1;this.zTb=this.Xlb=this.ile=this.hle=this.Yke=this.gle=this.fle=this.dle=this.$ke=this.ele=this.ale=this.cle=this.Zke=this.ble=null;this.Gf=()=>{this.ODa=this.ea.jn.WebExtensions;var Ic=Kd=>Sa.EwaSettings.ya(114)?!Kd.Zua:!0,gd=Kd=>Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?!Kd.Ovi:!0;for(let Kd=this.yf.length-1;0<=Kd;--Kd){let oe=this.yf[Kd];!this.CMh(oe.controlId)&&Ic(oe)&&gd(oe)&&
(oe.crc(),this.yf.splice(Kd,1))}if(this.ODa)for(let Kd=0,oe=this.ODa.length;Kd<oe;Kd++)Ic=this.ODa[Kd],(gd=this.Kn(Ic.WebExtensionId))&&gd.TFd(Ic)};this.nsc=Ic=>{this.raiseEvent("csc",Ic.getID())};this.osc=(Ic,gd,Kd)=>{if(gd===OSF.AgaveHostAction.KeyboardShortcuts){var oe=Object(Oa.a)(Object,Kd);gd={};gd.keyCode=oe.keyCode;gd.type="keydown";gd.ctrlKey=oe.ctrlKey;gd.shiftKey=oe.shiftKey;gd.altKey=oe.altKey;gd.metaKey=oe.metaKey;oe=this.Kn(Ic);Ic=oe.qaa;gd.srcElement=Object(La.a)(320,Ic)?Ic.WHa:db.h(this.$).rc;
Ic=new Sys.UI.DomEvent(gd);oe=wd.owa(oe.Hl,this.$);gd={};gd.focusedAddinId=oe;oe=new Ua.a(1461300262,1,this.$.Bc,6,null);db.h(this.$).TMb(Ic,oe,gd)}else if(gd===OSF.AgaveHostAction.Select)this.bcf(!0);else if(gd===OSF.AgaveHostAction.UnSelect)this.bcf(!1);else if(gd===OSF.AgaveHostAction.CancelDialog)this.GK(-684355545,null);else if(gd===OSF.AgaveHostAction.InsertAgave)Ic={},Kd&&(this.Xlb=Kd,Ic[ha.a.Z$]=Kd,Ic[ib.a.$f]=this.NJa(Kd),this.GK(-741808261,Ic));else if(gd===OSF.AgaveHostAction.ClickTrust)this.X_c&&
Kd&&(this.Xlb=Kd);else if(gd===OSF.AgaveHostAction.OsfControlLoad)this.X_c&&this.Xlb&&Kd&&this.oXg(this.Xlb,Kd)&&Kd.storeType&&(this.Xlb=null,this.dS(sa.b(Kd.storeType)));else if(gd===OSF.AgaveHostAction.InsertDevManifest)Ic={},Kd&&(Ic[ha.a.Z$]=Kd,Ic[ib.a.$f]=this.NJa(Kd),this.GK(-741808261,Ic));else if(gd===OSF.AgaveHostAction.InsertDevManifestError)Ic=Object(Oa.a)(Object,Kd),Ic={[ha.a.I_c]:this.Jl.getDevManifestInvalidUrlErrorString(Ic.manifestUrl)},this.GK(-2025863019,Ic);else if(gd===OSF.AgaveHostAction.NotifyHostError)Ic=
{[ha.a.I_c]:this.Jl.getManifestInvaildErrorString()},this.GK(-2025863019,Ic);else if(gd===OSF.AgaveHostAction.RefreshAddinCommands)Sa.EwaSettings.ya(52)&&this.GK(zc.a.refreshAddinCommands,null);else if(gd===OSF.AgaveHostAction.CtrlF6Exit||gd===OSF.AgaveHostAction.CtrlF6ExitShift){if(oe=this.$.da.Aa(15)){(Ic=this.Kn(Ic).qaa)&&Ic.iDc();n.a.Nf&&document.activeElement.blur();var Ce={keyCode:117,type:"keydown",ctrlKey:!0};Ce.shiftKey=gd===OSF.AgaveHostAction.CtrlF6ExitShift;Ce.srcElement=Object(La.a)(320,
Ic)?Ic.WHa:db.h(this.$).rc;Ic=new Sys.UI.DomEvent(Ce);oe.Jna(Ic)}}else if(gd===OSF.AgaveHostAction.PageIsReady){if((Ic=this.Kn(Ic).qaa)&&Ic.a0a===OSF.OsfControlTarget.TaskPane&&(Ic=this.$.da.Aa(183))&&this.yf){gd=Qa.a.Md();for(oe of this.yf)wd.TNa(oe.qQ)&&(gd?Ic.pg(!0,!1):Ic.setFocusOnToolbarFirstElement())}}else if(gd===OSF.AgaveHostAction.TabExit){gd=this.Kn(Ic);const Za=gd.qaa;if(Za)if(Za.a0a===OSF.OsfControlTarget.InContent)Za.Lrf();else{if(Za.a0a===OSF.OsfControlTarget.TaskPane)if(Qa.a.Md())n.a.Nf&&
document.activeElement.blur(),pa.UISurfaces.Aj().then(Rb=>{const rc=Object(La.a)(320,Za)?Za:null;rc?rc.isResizable?Rb.focusResizeHandle():Rb.focusTabbedTaskPaneArea():Rb.focusTabbedTaskPaneArea();return null});else if(gd=this.$.da.Aa(183))n.a.Nf&&document.activeElement.blur(),(Ic=document.getElementById(this.$.Ib+W.a.nqc))&&Aa.DOMElementExtensions.isVisible(Ic)?Aa.DOMElementExtensions.setFocus(Ic):gd.setFocusOnToolbarFirstElement()}else gd&&4===gd.osfControlType&&this.Jl.notifyAgave(Ic,OSF.AgaveHostAction.TabIn)}else if(gd===
OSF.AgaveHostAction.TabExitShift)(gd=this.Kn(Ic),oe=gd.qaa)?oe.a0a===OSF.OsfControlTarget.InContent?oe.Mrf():oe.a0a===OSF.OsfControlTarget.TaskPane&&(Ic=Object(La.a)(320,oe)?oe:null)&&(n.a.Nf&&document.activeElement.blur(),Ic.A8f()):gd&&4===gd.osfControlType&&this.Jl.notifyAgave(Ic,OSF.AgaveHostAction.TabIn);else if(gd===OSF.AgaveHostAction.EscExit||gd===OSF.AgaveHostAction.ExitNoFocusable||gd===OSF.AgaveHostAction.ExitNoFocusableShift)if(oe=this.Kn(Ic).qaa)oe.iDc();else{if(gd===OSF.AgaveHostAction.EscExit){gd=
null;for(Ce of H.ibi())if(Ce.value.ye===Ic){Ce.value.dialog.hide();gd=Ce.key;break}gd&&(Ic=this.Kn(gd))&&4!==Ic.osfControlType&&this.Jg.notifyAgave(gd,OSF.AgaveHostAction.TabIn)}}else if(gd===OSF.AgaveHostAction.InstallCustomFunctions)if(Sa.EwaSettings.ya(114)){Lc.a(this.$).c1e(()=>!1);var ze=this.$.da;Z.TaskExtensions.za(jb.GetServiceTaskFactory.Sa(ze,278,279,1),Za=>{Za=Za.result;ze.Aa(278)||ze.Ha(278,Za);const Rb=Kd.osfControl.getStoreType();Za.tif(Kd.osfControl.getSolutionId(),Rb,wd.IXh(Kd.osfControl),
Kd).Moa()},this.ka,3)}else f.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(gd===OSF.AgaveHostAction.UninstallCustomFunctions)if(Sa.EwaSettings.ya(114)){Lc.a(this.$).c1e(()=>!1);var af=this.$.da;Z.TaskExtensions.za(jb.GetServiceTaskFactory.Sa(af,278,279,1),Za=>{Za=Za.result;af.Aa(278)||af.Ha(278,Za);Za.Clg(Kd.solutionId,Kd.storeType).Moa()},this.ka,3)}else f.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");
else gd===OSF.AgaveHostAction.SendTelemetryEvent?ce(Kd):gd===OSF.AgaveHostAction.SendCustomerContent?ie(Kd):gd===OSF.AgaveHostAction.LaunchExtensionComponent?e.a.instance.vEi(Kd):gd===OSF.AgaveHostAction.RefreshRibbonGallery?(Ic=this.$.da.Aa(519))&&Ic.snd(Kd):gd===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.roj(Kd.solutionId),Qa.a.Md()||(Ic=this.$.da.Aa(183))&&Ic.eC(),Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&w.AFrameworkApplication.xb.ie(zc.a.CYf,
2,Kd.solutionId)):gd===OSF.AgaveHostAction.GetOriginalControlId&&(Ic=new bb.a(this.$.Ib,Kd.ownerAddinSolutionId,new aa.a,!0),Kd.originalControlId=Ic?Ic.OMe(Kd.controlId):Kd.controlId)};this.OBj=(Ic,gd)=>{const Kd=Array(2);Kd[0]=gd;Kd[1]=null;this.hh.NMh(Ic,JSON.stringify(Kd))};this.R6i=()=>{this.$.na&&Ud.o(this.$.na)&&this.$.da.Aa(34).pqd()};this.yd=()=>{this.Qtf()};this.WR=(Ic,gd)=>{var Kd,oe;1===gd.er&&(Ic=gd.Of)&&(gd=new cc(ec.toTimestamp(Ic.enqueueUtcTime),ec.toTimestamp(Ic.processUtcTime),ec.toTimestamp(Ic.dequeueUtcTime),
ec.getElapsedMilliseconds(Ic.enqueueUtcTime,Ic.processUtcTime),ec.getElapsedMilliseconds(Ic.processUtcTime,Ic.dequeueUtcTime),Ic.operationCount,(null===(oe=null===(Kd=Ic.operation)||void 0===Kd?void 0:Kd.Cd)||void 0===oe?0:oe.ServerCorrelationId)?Ic.operation.Cd.ServerCorrelationId:null,Ic.operation?Enum.toString(Qe.a,Ic.operation.operationName):null,ld.a.AD(ec.getElapsedMilliseconds(Ic.enqueueUtcTime,Da.a.Ya.kc))),Kd=Sys.Serialization.JavaScriptSerializer.serialize(gd),f.ULS.sendTraceTag(50872916,
0,50,Kd))};this.dd=(Ic,gd)=>{!this.ea.jc&&Se.a(gd)?(Array.forEach(this.yf,this.cFf),this.yf.length=0,this.XSb=!1):(gd.XH&&(f.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.e2f()),this.qL(),Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.XSb=!1))};this.So=()=>{Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(f.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),
this.e2f());this.qL();Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.XSb=!1)};this.cFf=Ic=>{Ic.crc();this.raiseEvent("cd",Ic.controlId)};this.pb=Ta;this.$_c=Vb;this.initialize(qc);fb.la(this);this.n3f=0;(Ta=(Ta=!(n.a.yp||n.a.Tca))&&!n.a.Nf)&&OfficeExt.ShortcutKeyDispatchManager.init();this.CCg={}}get g3b(){return this.ega||(this.ega=new ya.a(this.$.Cv))}dte(Ta){this.addHandler("cd",Ta)}rpj(Ta){this.removeHandler("cd",Ta)}tQg(Ta){this.addHandler("csc",
Ta)}tpj(Ta){this.removeHandler("csc",Ta)}qQg(Ta){this.addHandler("ca",Ta)}qpj(Ta){this.removeHandler("ca",Ta)}rQg(Ta){this.addHandler("ci",Ta)}sQg(Ta){this.addHandler("ekros",Ta)}spj(Ta){this.removeHandler("ekros",Ta)}bId(Ta,Vb){try{return JSON.parse(Ta)[Vb].toLowerCase()}catch(qc){return""}}EKj(Ta){const Vb=this.bId(Ta,"AudienceGroup"),qc=this.bId(Ta,"SessionOrigin");try{const Ic=parseInt(this.bId(Ta,"Ring"),10);if("automation"!==Vb&&"bluechicken"!==qc&&-2<=Ic)return!0}catch(Ic){if("automation"!==
Vb&&"bluechicken"!==qc)return!0}return!1}get Jg(){if(!this.Jl){const Ta={},Vb=!(this.$.Nd&1),qc=fa.a.current.dA,Ic=this.$.workbookContext,gd=za.a.CL+za.a.D6b;Ta.pageBaseUrl=qc.LayoutsContentUrlPrefix;Ta.appName=OSF.AppName.ExcelWebApp;Ta.appVersion="16";Ta.appSettings=this.H0h();Ta.singleSignOnSettings=G.AppsForOfficeSingleSignOnManager.K8h();Ta.clientMode=Vb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Ta.appUILocale=this.$.xa.UICultureTag;Ta.dataLocale=this.$.xa.DataCultureTag;Ta.docUrl=Ic.ClientUrl;
Ta.hostControl=this;Ta.formFactor=OSF.FormFactor.Default;Ta.lcid=this.$.AG.toString();Ta.localizedScriptsUrl=za.a.CL+za.a.t6c;Ta.localizedImagesUrl=gd;Ta.localizedStylesUrl=za.a.CL+za.a.CHe;Ta.localizedResourcesUrl=gd;Ta.osfOmexBaseUrl=qc.OsfOmexBaseUrl;Ta.firstPartyManifestCDNUrl=qc.FirstPartyAddInManifestCDN;Ta.sdxAssetsToPrefetchMapping=w.AFrameworkApplication.fa.Wa("SdxAssetsToPrefetchMapping");Ta.sdxCdnUrl=qc.SdxCdnUrl;Ta.sdxDmsUrl=qc.SdxDmsUrl;Ta.devCatalogUrl=qc.DevCatalogUrl;Ta.controlStatusChanged=
this.nsc;Ta.notifyHost=this.osc;Ta.allowExternalMarketplace=this.$.ea.Lg.get(27)&&wd.q7b;Ta.enableAddinCommands=Sa.EwaSettings.ya(52);Ta.enableBlackForestRedirect=Sa.EwaSettings.ya(87);Ta.enableMyOrg=this.$.ea.Lg.get(33);Ta.enableMyApps=this.$.ea.Lg.get(34);Ta.enableDevCatalog=Sa.EwaSettings.ya(43);Ta.enablePrivateCatalog=this.ALj();Ta.showSignOutFromPrivateCatalogMessage=this.$.ea.Lg.get(36);Ta.enableUploadFileDevCatalog=Sa.EwaSettings.ya(52)&&!Sa.EwaSettings.ya(254);Ta.userNameHashCode=R.a.Au(w.AFrameworkApplication.userName);
Ta.envCode=this.$.xa.OfficeAddinTelemetryDataSourceCode.toString();Ta.enableSingleSignOnForAddin=!Sa.EwaSettings.ya(23)&&w.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Ta.enableDisplayBlockedMinorError=Sa.EwaSettings.ya(171);Ta.hideAppsExtensionUrl=w.AFrameworkApplication.hideAppsExtensionUrl;Ta.enableAnonymousUseLegacyCatalogService=Sa.EwaSettings.ya(162);Ta.enableInsertDialogAccessibilityFix=Sa.EwaSettings.ya(169);Ta.disableAppsForOfficeThirdParty=Sa.EwaSettings.ya(174);Ta.enableFirstPartySSO=
Sa.EwaSettings.ya(186);Ta.wacSessionId=this.$.xa.UserSessionId;Ta.disableLogging=!this.$.xa.AriaLoggingIsEnabled;Ta.enableFirstPartySDXErrorMessages=Sa.EwaSettings.ya(198);Ta.enableRichApiCellEditDelay=Sa.EwaSettings.ya(178);Ta.isHostDocumentDomain=Sa.EwaSettings.ya(209);Ta.loggableUserId=w.AFrameworkApplication.fa.Wa("LoggableUserId");Ta.sessionStartInfoJson=w.AFrameworkApplication.fa.Wa("SessionStartInfoJson");Ta.wopiHostOriginFromPostMessage=w.AFrameworkApplication.wopiHostOriginFromPostMessage;
Ta.wopiHostOriginFromWacPropBag=w.AFrameworkApplication.fa.Wa("PostMessageOrigin");Ta.wacIsEmbedded=w.AFrameworkApplication.fa.ra("IsEmbedded");Ta.accessibilityAllowFocusAddinTaskpane=w.AFrameworkApplication.fa.ra("AccessibilityAllowFocusAddinTaskpane");Ta.enableRemoveAppCommandsAddin=w.AFrameworkApplication.fa.ra("RemoveAppCommandsAddinIsEnabled");Ta.isHostFrameTrustCheckEnabledForAddIns=w.AFrameworkApplication.fa.ra("HostFrameTrustCheckIsEnabledForAddIns");Ta.isHostFrameTrusted=w.AFrameworkApplication.isHostFrameTrusted;
Ta.agaveAddinUploadEnabled=Sa.EwaSettings.ya(45);Ta.hostAllowedOfficeStore=w.AFrameworkApplication.fa.ra("HostAllowedOfficeStore");Ta.hostAllowedSdxEmbedding=w.AFrameworkApplication.fa.ra("HostAllowedSdxEmbedding");Ta.hostInstallAddIns=w.AFrameworkApplication.fa.Wa("HostInstallAddIns");Ta.hostInstallAddInsIsEnabled=w.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled");Ta.approvedAddIns=w.AFrameworkApplication.fa.Wa("ApprovedAddIns");Ta.addinEnforceHttpsIsEnabled=this.EKj(Ta.sessionStartInfoJson);
Ta.hostFeatureGateFlag=0;Ta.isUpnCheckEnabled=w.AFrameworkApplication.fa.ra("IsUpnCheckEnabled");Ta.wacUpn=w.AFrameworkApplication.fa.Wa("UserPrincipalName");Ta.isReactRibbonEnabled=Qa.a.isReactRibbonEnabled();Ta.enableSetFocusOnTaskpaneOnUserAction=Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Ta.isSafariWithIndexedDBDisabled=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&n.a.FOa;Ta.isIndexedDBDisabled=
Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&n.a.FOa||Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&n.a.Nf;Ta.enableCustomShortcuts=!0;Ta.changeGetModifierKeyStringOutputOrder=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Ta.officeJsUrl=w.AFrameworkApplication.BO("OfficeJs/excel.js",5);Ta.enableOfficeJsUrlParam=Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",
!1);this.Jl=new OSF.ContextActivationManager(Ta);this.Jl.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Jl.setWSA(w.AFrameworkApplication.Zn);this.Jl&&"undefined"!==typeof this.Jl.hostCheckReadyHandler&&w.AFrameworkApplication.pRg(Object(d.a)(this.Jl,this.Jl.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const Kd=cb.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Jl.setOAuthManager(Kd)}catch(Kd){}}return this.Jl}get Zbk(){return this.JXc}get Mh(){return this.ble}get Ioa(){return this.Zke}get XQd(){return this.cle}get WQd(){return this.ale}get Kwj(){return this.ele}get Iwj(){return this.$ke}get Jwj(){return this.dle}get Lwj(){return this.fle}get Mwj(){return this.gle}get YQd(){return this.hle}get m3f(){return this.ile}get UV(){return this.CCg}get $(){return this.pb}get VQd(){return this.Yke}O3b(Ta){const Vb=
{};Vb.Name=Ta.Name;Vb.BindingType=Ta.BindingType;Vb.HasHeaders=Ta.HasHeaders;Ta.IsValidRef&&(Vb.ColCount=Ta.Reference.LastColumn-Ta.Reference.FirstColumn+1,Vb.RowCount=Ta.Reference.LastRow-Ta.Reference.FirstRow+1);return Vb}get J_c(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)}btf(Ta,Vb){const qc=this.t1g(Vb);
let Ic=null;if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==Vb&&"LaunchAddinDialogFromTellMe"===Vb[0])null!==qc.assetId&&"undefined"!==typeof qc.assetId&&(Ic="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.J_c){const gd=this.$.ea.Lg.get(27);gd&&null!==Vb&&"InsertMoreAddInsFromFooter"===Vb[0]?Ic="{98143890-AC66-440E-A448-ED8771A02D52}":
gd&&null!==Vb&&"AddinFlyoutMoreButton"===Vb[0]&&(Ic="0")}this.Jl.launchInsertDialog(Ta,Ic,qc)}get bia(){return this.nqb}get nqb(){this.X_c&&!this.zTb&&(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7611171_AddinDetailsManagerConfigEnabled")?this.zTb=new Ga(w.AFrameworkApplication.fa,new ra.a(()=>this.Jl),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.gig,["AreThirdPartyAddInsAllowed"]:this.$.WP,["PopularAddinDetailsJsonString"]:wd.KJb}):
this.zTb=new Ga(new Pa.a({["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace.toString(),["AppsForOfficeThirdPartyIsDisabled"]:this.gig.toString(),["AreThirdPartyAddInsAllowed"]:this.$.WP.toString(),["PopularAddinDetailsJsonString"]:wd.KJb}),new ra.a(()=>this.Jl)));return this.zTb}get gig(){return Sa.EwaSettings.ya(174)}get allowExternalMarketplace(){return this.$.ea.Lg.get(27)}get X_c(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}static get KJb(){return'[{"displayName":"Bing Maps","solutionId":"wa102957661","version":"1.5.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1770,"downloadNumber":-1}},{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":20064,"downloadNumber":-1}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":40,"downloadNumber":-1}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":359,"downloadNumber":-1}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1369,"downloadNumber":-1}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.4.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674774/Asset_733b35d6-e5e0-4163-b45d-3396185864bd/WIKIPEDIAAPPFOROFFICELICENSETE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":368,"downloadNumber":-1}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":1,"AUP":3146,"downloadNumber":-1}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1364,"downloadNumber":-1}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":68,"downloadNumber":-1}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":6262,"downloadNumber":-1}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710,"downloadNumber":-1}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":673,"downloadNumber":-1}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":2790,"downloadNumber":-1}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":588,"downloadNumber":-1}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":358,"downloadNumber":-1}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"wa104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":597,"downloadNumber":-1}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":1812,"downloadNumber":-1}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"wa104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":1,"AUP":434,"downloadNumber":-1}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":353,"downloadNumber":-1}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":-1,"AUP":1299,"downloadNumber":-1}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":371,"downloadNumber":-1}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":297,"downloadNumber":-1}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":935,"downloadNumber":-1}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1421,"downloadNumber":-1}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":373,"downloadNumber":-1}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":8162,"downloadNumber":-1}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":192,"downloadNumber":-1}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":696,"downloadNumber":-1}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":382,"downloadNumber":-1}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":10559,"downloadNumber":-1}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":-1,"AUP":1674,"downloadNumber":-1}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1315,"downloadNumber":-1}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":640,"downloadNumber":-1}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":441,"downloadNumber":-1}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\u2019s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":2,"AUP":1112,"downloadNumber":-1}},{"displayName":"iServer365 Import Tool","solutionId":"wa200000421","version":"2.1.4.7","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your iServer365 Repository","iconUrl":"31253.df1e5367-d9bc-46a7-8259-9b24225f294e.24914354-af15-4aa0-8ead-1c9d3e44a16d.8c184953-6f7c-4728-add7-e9aa9aa1c7a1.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":471,"downloadNumber":-1}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":2,"AUP":83858,"downloadNumber":-1}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","version":"1.0.0.58","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using Refinitiv\u2019s unique content and analytics","iconUrl":"22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":356,"downloadNumber":-1}},{"displayName":"Money in Excel","solutionId":"wa200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.aspx","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":1382,"downloadNumber":-1}},{"displayName":"McGraw Hill","solutionId":"wa200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":2,"AUP":118855,"downloadNumber":-1}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1991,"downloadNumber":-1}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":272,"downloadNumber":-1}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\u2019s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":768,"downloadNumber":-1}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":129,"downloadNumber":-1}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":185,"downloadNumber":-1}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Create, edit, and reuse formulas.","iconUrl":"42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":382,"downloadNumber":-1}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":404,"downloadNumber":-1}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":403,"downloadNumber":-1}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":2501,"downloadNumber":-1}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":120,"downloadNumber":-1}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.0.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":120,"downloadNumber":-1}},{"displayName":"AI Formula Generator Bot for Excel","solutionId":"wa200004935","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Transform your text instructions into Excel formulas in seconds with the help of AI.","iconUrl":"15321.02bef729-7dee-4518-80a6-f1201acff812.20f898b8-6e94-4547-b2c1-2680aff4db58.e0447c81-0b85-428e-8e98-0c3ecefac08c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://excelformulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":286,"downloadNumber":-1}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":19,"downloadNumber":-1}}]'}dS(Ta,
Vb){this.nqb&&this.nqb.dS(Ta,Vb)}Svc(Ta){this.nqb&&this.nqb.Uvc(Ta)}oXg(Ta,Vb){return I.a.$h().equals(Ta.solutionId,Vb.solutionId)&&I.a.$h().equals(Ta.storeType,Vb.storeType)}uea(Ta,Vb){if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.OTf(Ta,Vb,OSF.StoreTypeEnum.MarketPlace);else{const qc={};qc.callbackFunc=Ta;qc.storeType=OSF.StoreTypeEnum.MarketPlace;qc.fromInsertDialog=!1;qc.refresh=Vb;this.Jl.queryEntitlementDetails(qc)}}OTf(Ta,Vb,qc){const Ic=
{};Ic.callbackFunc=Ta;Ic.storeType=qc;Ic.fromInsertDialog=!1;Ic.refresh=Vb;this.Jl.queryEntitlementDetails(Ic)}invokeDdaMethod(Ta,Vb){const qc=this.Kn(Ta.DdaMethod.ControlId);qc?qc.invokeDdaMethod(Ta,Vb):this.Lf(sb.a.internalError,Vb)}registerDdaEventAsync(Ta,Vb,qc,Ic,gd){(Vb=this.Kn(Vb))?wd.lCb(Ta)?Vb.glj(Ta,qc,Ic,gd):this.Lf(sb.a.sHd,gd):this.Lf(sb.a.internalError,gd)}unregisterDdaEventAsync(Ta,Vb,qc,Ic,gd){(Vb=this.Kn(Vb))?wd.lCb(Ta)?Vb.a4j(Ta,qc,Ic,gd):this.Lf(sb.a.sHd,gd):this.Lf(sb.a.internalError,
gd)}dispose(){this.disposed||(this.$.lm(this.yd),this.ea.xk(this.dd),this.ea.iS(this.So),this.ea.$v(this.Gf),this.$_c.detach(this),this.$.userOperationManager.ro(this.WR),this.ktc=this.yf=this.hh=this.$_c=this.pb=null,this.JKa&&(this.JKa.dispose(),this.JKa=null),nb.a.Ja(this.XQd),nb.a.Ja(this.WQd),this.p3a&&(this.p3a.dispose(),this.p3a=null),super.dispose(),this.disposed=!0,f.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}pid(Ta){return(Ta=this.Kn(Ta))?Ta.getDefaultIconUrl():null}mAc(Ta){if(this.AMe!==
Ta){this.AMe=Ta;for(let Vb=0,qc=this.yf.length;Vb<qc;Vb++){const Ic=this.yf[Vb];Ta?Ic.dPe(!1):Ic.gwh()}this.XQd.mAc(Ta);this.WQd.mAc(Ta)}}cYh(Ta){return(Ta=this.Kn(Ta))?Ta.getDefaultDisplayName():null}Lf(Ta,Vb,qc=!0){const Ic={};Ic[ib.a.$f]=Ta;Ic[ib.a.v4]=Vb;this.GK(451041795,Ic,qc)}Jv(Ta){const Vb={};Vb[ib.a.v4]=Ta;this.GK(1237877382,Vb)}GK(Ta,Vb,qc=!0){const Ic=new Ua.a(Ta,0,this.$.Bc,0,null),gd=Vb?Vb[ib.a.v4]:null;this.p3a&&db.h(this.$).jb&&Ub.sah(Ta,Vb)?this.p3a.Uoh(Ta,Vb):(Ta=this.$.Ia.Nb(Ic,
Vb),qc&&Z.TaskExtensions.za(Ta,Kd=>{Ze.a(Kd)?this.Lf(sb.a.internalError,gd,!1):Kd.result||(db.h(this.$).jb?this.Lf(sb.a.xBb,gd,!1):this.Lf(sb.a.internalError,gd,!1))},this.ka,8))}Uch(Ta){return!!this.kka(Vb=>wd.getSolutionId(Vb.Hl,this.$)===wd.getSolutionId(Ta,this.$)&&Vb.Hl.PrimaryMarketplace.MarketplaceType===Ta.PrimaryMarketplace.MarketplaceType&&Vb.Hl.PrimaryMarketplace.MarketplaceRef===Ta.PrimaryMarketplace.MarketplaceRef&&Vb.Hl.PrimaryMarketplace.SolutionVersion===Ta.PrimaryMarketplace.SolutionVersion)}Kn(Ta){return this.kka(Vb=>
Vb.controlId.startsWith(Ta))}qMh(Ta){return this.kka(Vb=>Vb.Zua===Ta)}n_e(Ta){return this.kka(Vb=>Vb.qQ===Ta&&!!Vb.Zua)}D_e(Ta,Vb,qc,Ic){return this.kka(gd=>gd.qQ===Ta&&gd.Hl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Vb.toLowerCase()&&gd.Hl.PrimaryMarketplace.MarketplaceType.toLowerCase()===qc.toLowerCase()&&!!gd.Hl.SharedRuntime&&!!gd.Hl.SharedRuntime.Resid&&!!Ic&&!!Ic.Resid&&gd.Hl.SharedRuntime.Resid.toLowerCase()===Ic.Resid.toLowerCase())}YXg(Ta,Vb){if(Ta=this.Kn(Ta))Ta.la(Vb),Ta.showHide(!0)}mPj(Ta){(Ta=
this.Kn(Ta))&&Ta.showHide(!1)}LJa(Ta){var Vb;if(1!==Ta.WebExtensionType||this.$.Nd&8388608&&Ta.TaskpaneVisible||this.$.Nd&8388608&&!Ta.TaskpaneVisible&&Ib.HelperMethods.Tw(Ta)){let qc=null;Ib.HelperMethods.Tw(Ta)&&(qc=wd.owa(Ta,this.$),Ta.TaskpaneWidth||(Ta.TaskpaneWidth=this.Zub));const Ic=(new Lb(this,this.hh,Ta)).bqd();f.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.PrimaryMarketplace.SolutionId,Ta.OwnerAddinStoreType||
Ta.PrimaryMarketplace.MarketplaceType,null===(Vb=Ta.AssetMarketplace)||void 0===Vb?void 0:Vb.SolutionId,null,null,Ta.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Ta.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ib.HelperMethods.Tw(Ta)}`);qc&&(Ic.Zua=qc);this.yf.push(Ic);this.Nya=null;this.T7a(Ta.InstanceId)||(Ta=String.format("{0}|{1}|{2}|{3}|{4}",Ta.PrimaryMarketplace.SolutionId,Ta.PrimaryMarketplace.SolutionVersion,Ta.PrimaryMarketplace.MarketplaceRef,Ta.PrimaryMarketplace.MarketplaceType,
Ta.WebExtensionType),this.raiseEvent("ci",Ta))}}SQj(Ta,Vb){Ta.TaskpaneWidth=this.Zub;Ta.TaskpaneVisible=!0;const qc={};qc.SolutionId=Ta.PrimaryMarketplace.SolutionId;qc.TargetType=Ta.WebExtensionType;qc.Version=Ta.PrimaryMarketplace.SolutionVersion;qc.StoreType=Ta.PrimaryMarketplace.MarketplaceType;qc.StoreId=Ta.PrimaryMarketplace.MarketplaceRef;Ta.AssetMarketplace?(qc.AssetId=Ta.AssetMarketplace.SolutionId,qc.AssetStoreId=Ta.AssetMarketplace.MarketplaceRef):(qc.AssetId=null,qc.AssetStoreId=null);
qc.Width=Ta.TaskpaneWidth;const Ic=new Lb(this,this.hh,Ta,!0);Ic.bqd();this.yf.push(Ic);const gd=()=>{this.kSa(Ic.controlId);this.Jg.purgeOsfControl(Ic.controlId,!1);Vb()};let Kd=null;Kd=zf.a.instance.cD(()=>{Ic.Hy&&(nb.a.Ja(Kd),Kd=null,this.Jg.insertBlankControlWithErrorUX(this.VJb(Ic,qc),gd))},100,Lf.a.Lnh)}Rgh(Ta){if(Ta&&Ta.length){var Vb=[];Ta.forEach(qc=>{if(qc.ContainsCustomFunctions){const Ic=wd.owa(qc,this.$);this.zId.contains(Ic)||(this.zId.add(Ic),this.dQf.push(qc));this.Uch(qc)||Vb.push(qc)}});
Vb.length&&this.EJe(Vb)}}HLe(Ta,Vb){this.Kn(Ta.InstanceId)||(Vb=Vb(),Ta=(new Lb(this,this.hh,Ta)).shf(Vb),this.yf.push(Ta),this.Nya=null)}FOj(Ta){wd.i3a.nb(Ta)&&wd.i3a.ma(Ta).initializeAndShowWithTitle()}Mhi(Ta){wd.i3a.nb(Ta)&&wd.i3a.ma(Ta).hide()}g4h(Ta){var Vb=null;let qc,Ic,gd=null;qc=wd.qmd(Ta,!0);if(!qc)return f.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),mb.Task.Ua(null);(Ic=this.Jl.getOsfControl(wd.getSolutionId(qc,this.$)))&&
(Vb=Ic.getManifest())&&(gd=Vb.getSharedRuntimeForCustomFunctions("Workbook"));if(Vb=gd&&1===gd.LifeTime?this.D_e(qc.PrimaryMarketplace.SolutionId,qc.PrimaryMarketplace.MarketplaceRef,qc.PrimaryMarketplace.MarketplaceType,gd):this.qMh(Ta))return mb.Task.Ua(Vb.controlId);const Kd=new V.a;Ib.HelperMethods.smc(gd)&&(qc.SharedRuntime=gd);Ta=Ic?Ic.getNotificationParams():[];if(!Ta.length)return this.iKe(qc);this.bcg(Ta,()=>{Z.TaskExtensions.za(Kd.task,()=>{this.iKe(qc)},this.ka,3)},()=>{});return Kd.task}ZSh(Ta){Ta=
wd.qmd(Ta,!1);if(!Ta)return f.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let Vb=null;var qc=this.Jl.getOsfControl(wd.getSolutionId(Ta,this.$));qc&&(qc=qc.getManifest())&&(Vb=qc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Ib.HelperMethods.smc(Vb)&&(Ta=this.D_e(Ta.PrimaryMarketplace.SolutionId,Ta.PrimaryMarketplace.MarketplaceRef,Ta.PrimaryMarketplace.MarketplaceType,Vb))?Ta.controlId:null}jfh(Ta,Vb){var qc=wd.qmd(Ta,!1);if(qc){var Ic=
null,gd=this.Jl.getOsfControl(wd.getSolutionId(qc,this.$));gd&&(gd=gd.getManifest())&&(Ic=gd.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Ib.HelperMethods.smc(Ic)){qc.SharedRuntime=Ic;var Kd=qc.PrimaryMarketplace.SolutionId;gd=qc.PrimaryMarketplace.SolutionVersion;var oe=OSF.OsfManifestManager.getCachedManifest(Kd,gd);if(oe)if(this.b2b.nb(Ta))Ic=this.b2b.ma(Ta),Z.TaskExtensions.za(Ic,af=>{(af=af.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(af,Vb,this.hh.ENb)},
this.ka,3);else{var Ce={};Ce.solutionId=Kd;Ce.version=gd;Ce.storeType=qc.PrimaryMarketplace.MarketplaceType;Ce.storeId=qc.PrimaryMarketplace.MarketplaceRef;qc.AssetMarketplace?(Ce.assetId=qc.AssetMarketplace.SolutionId,Ce.assetStoreId=qc.AssetMarketplace.MarketplaceRef):(Ce.assetId=null,Ce.assetStoreId=null);Ce.targetType=OSF.OsfControlTarget.TaskPane;var ze=new V.a;qc=Z.TaskExtensions.lk();qc=new ia.a(this.$,this,Ce,qc);Ic=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Kd,Ic.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(oe,
Ic,gd);qc.createUILessSandbox(Ce,oe,(af,Za)=>{af&&!Za?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(af,Vb,this.hh.ENb),ze.setResult(af)):ze.setResult(null);this.b2b.remove(Ta)});this.b2b.ia(Ta,ze.task)}}}else f.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}pEe(Ta){(Ta=this.n_e(Ta))&&(Ta.Hl.SharedRuntime||this.nLb(Ta.controlId))}nLb(Ta){(Ta=this.n_e(Ta))&&this.kSa(Ta.controlId)}Nsh(Ta,Vb){if(!this.yf||!Ta||!Vb)return!1;
if(Ta.toLowerCase()===Vb.toLowerCase())return!0;let qc=null,Ic=null;for(let gd=0,Kd=this.yf.length;gd<Kd;gd++){const oe=this.yf[gd];if(oe.ownerAddinSolutionId&&(oe.controlId===Ta&&(qc=oe.ownerAddinSolutionId.toLowerCase()),oe.controlId===Vb&&(Ic=oe.ownerAddinSolutionId.toLowerCase()),qc&&Ic))break}return qc&&qc===Ic?!0:!1}TNg(Ta){this.Kn(Ta.InstanceId)||(Ta=new Lb(this,this.hh,Ta),this.yf.push(Ta),this.Nya=null)}dZf(Ta){if(this.yf&&0<=Ta&&Ta<this.yf.length){const Vb=this.yf[Ta],qc=Vb.Hy;this.yf.splice(Ta,
1);this.cFf(Vb);Aa.DOMElementExtensions.Hf(qc)}}kSa(Ta){if(this.yf)for(let Vb=0,qc=this.yf.length;Vb<qc;Vb++)if(this.yf[Vb].controlId===Ta){this.dZf(Vb);break}}roj(Ta){if(this.yf){Ta=Ta.toLowerCase();for(let Vb=0,qc=this.yf.length;Vb<qc;Vb++)if(Ta===this.yf[Vb].ownerAddinSolutionId.toLowerCase()){this.dZf(Vb);break}}}CYg(Ta){Ta.Xi&&(this.Kn(Ta.floatingObject.Hl.InstanceId)||(this.cjc(Ta.floatingObject.Hl.InstanceId)||this.ktc.push(Ta.floatingObject.Hl.InstanceId),this.LJa(Ta.floatingObject.Hl)),this.ea.isNamedObjectViewMode&&
this.YXg(Ta.floatingObject.Hl.InstanceId,Ta.Sd))}y_e(Ta){return null==this.yf?null:this.yf.find(Vb=>1===Vb.controlType&&yc.a.equals(Vb.qQ,Ta,!0))}Sba(Ta){if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return Ta=this.y_e(Ta),null===Ta||void 0===Ta?void 0:Ta.controlId;if(this.yf)for(let Vb=0,qc=this.yf.length;Vb<qc;Vb++)if(1===this.yf[Vb].controlType&&yc.a.equals(this.yf[Vb].qQ,Ta,!0))return this.yf[Vb].controlId;return null}VAi(Ta){return(Ta=this.y_e(Ta))?
Ta.visible:!1}SLh(Ta){const Vb=[];if(this.yf)for(let qc=0,Ic=this.yf.length;qc<Ic;qc++)yc.a.equals(this.yf[qc].qQ,Ta,!0)&&Vb.push(this.yf[qc].controlId);return Vb}xMh(Ta,Vb){if(!Vb||!Ta)return null;if(this.yf)for(let qc=0,Ic=this.yf.length;qc<Ic;qc++)if(1===this.yf[qc].controlType&&yc.a.equals(this.yf[qc].qQ,Ta,!0)&&this.yf[qc].Hl.SharedRuntime&&yc.a.equals(this.yf[qc].Hl.SharedRuntime.Resid,Vb.Resid,!0))return this.yf[qc].controlId;return null}NLa(Ta,Vb=null){return Ta?Vb?`${Ta}.${Vb}`:Ta:""}sEe(Ta,
Vb,qc){if(this.Nya===Ta)return!0;this.Nya=Ta;let Ic=null,gd=!1;if(!Ic&&this.yf)for(let Kd=0,oe=this.yf.length;Kd<oe;Kd++)if(1===this.yf[Kd].controlType&&yc.a.equals(this.yf[Kd].qQ,Ta,!0)){let Ce=!1,ze=!1;Vb?(Ce=!0,ze=!!this.yf[Kd].Hl.SharedRuntime&&yc.a.equals(this.yf[Kd].Hl.SharedRuntime.Resid,Vb.Resid,!0)):qc&&(Ce=!0,ze=yc.a.equals(this.yf[Kd].Hl.SharedRuntimeId,qc,!0));if(!Ce||ze){ze&&this.yf[Kd].$g(!0);Ic=this.yf[Kd].controlId;gd=!0;this.Nya=null;break}}Ic&&this.raiseEvent("ca",Ic);return gd}setAppRuntimeState(Ta,
Vb){var qc;if(Ta){const Ic=this.Kn(Ta);if(Ic&&Ib.HelperMethods.Tw(Ic.Hl))Ic.$g(Vb),Vb&&(this.raiseEvent("ca",Ta),(null===(qc=Ic.Hy)||void 0===qc?0:qc.firstChild)&&(Ta=Ic.Hy.firstChild.title)&&0<Ta.length&&this.g3b.EBj(Ta));else throw f.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Vc.a.instance.ha(2250));}else throw f.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Vc.a.instance.ha(2251));
}getAppRuntimeState(Ta){if(Ta)if((Ta=this.Kn(Ta))&&Ib.HelperMethods.Tw(Ta.Hl))Ta=Ta.Hl.TaskpaneVisible;else throw f.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Vc.a.instance.ha(2250));else throw f.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Vc.a.instance.ha(2251));return Ta}U4a(Ta,Vb){return(Ta=this.Kn(Ta))?Ta.U4a(Vb):null}T7a(Ta){return this.uEe(this.ktc,Ta)}cjc(Ta){return this.uEe(this.uMe,
Ta)}ire(Ta){this.uMe.push(Ta)}oV(Ta){return(Ta=this.Kn(Ta))?Ta.Hl:null}vDd(Ta){this.raiseEvent("ekros",Ta,this)}sNf(Ta){if(Ta){var Vb=this.Kn(Ta.InstanceId);Vb&&(Ta.SharedRuntime||Ta.SharedRuntimeId||(this.kSa(Vb.controlId),this.Jg.purgeOsfControl(Vb.controlId,!1)),Vb={},Vb.SolutionId=Ta.PrimaryMarketplace.SolutionId,Vb.TargetType=Ta.WebExtensionType,Vb.Version=Ta.PrimaryMarketplace.SolutionVersion,Vb.StoreType=Ta.PrimaryMarketplace.MarketplaceType,Vb.StoreId=Ta.PrimaryMarketplace.MarketplaceRef,
Ta.AssetMarketplace?(Vb.AssetId=Ta.AssetMarketplace.SolutionId,Vb.AssetStoreId=Ta.AssetMarketplace.MarketplaceRef):(Vb.AssetId=null,Vb.AssetStoreId=null),Vb.Width=Ta.TaskpaneWidth,Vb.SharedRuntimeId=Ta.SharedRuntimeId,this.Wjg(Vb))}}Rja(){this.hh.Rja()}DH(Ta,Vb,qc){this.hh.DH(Ta,Vb,qc)}O_e(Ta,Vb){Vb=wd.ykh(Vb);Ta=this.oV(Ta);this.hh.vcc(Ta.InstanceId,2202,Tb.a.sL,Vb)}gfd(Ta){for(let Vb=0,qc=this.yf.length;Vb<qc;Vb++)this.O_e(this.yf[Vb].controlId,Ta)}HMh(Ta,Vb){Vb=wd.Pfh(Vb);this.hh.vcc(Ta,65539,
"",Vb)}LMh(Ta,Vb,qc){this.hh.vcc(Ta,1,Vb,qc)}GMh(Ta,Vb){this.hh.MMh(Ta,Vb)}gfh(Ta,Vb){return[[2,1E3,"",JSON.stringify([Ta,Vb]),0,!1]]}xri(){return!!this.Ioa&&this.Ioa.Edf()}Y8g(){this.Ioa&&this.Ioa.clear()}IMh(){if(this.Ioa&&this.Ioa.Edf()){var Ta=this.Ioa.bTh();for(const Vb of Ta){Ta=this.SLh(Vb);for(const qc of Ta)this.hh.vcc(qc,65540,"","{}")}}}$kj(Ta){this.Ioa.add(Ta)}Y3j(Ta){this.Ioa.remove(Ta)}kka(Ta){if(!this.yf)return null;for(const Vb of this.yf)if(Ta(Vb))return Vb;return null}iKe(Ta){const Vb=
new V.a,qc=wd.owa(Ta,this.$);if(Ib.HelperMethods.Tw(Ta))f.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.aQf(Ta,Ic=>{Ic?(Ta.InstanceId=Ic.InstanceId,Ta.WebExtensionOsfControlType=3,Ta.TaskpaneVisible=!1,this.LJa(Ta),Vb.setResult(Ta.InstanceId)):(f.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ta.PrimaryMarketplace.SolutionId,Ta.PrimaryMarketplace.MarketplaceType,null,null,null,Ta.PrimaryMarketplace.MarketplaceRef)} failed`),
Vb.setException(Error.create("Null insert data")))});else{wd.i3a.ia(Ta.InstanceId,new Ba.a);const Ic=wd.i3a.ma(Ta.InstanceId).sba;this.Qgh(Ta,Ic,qc);this.aQf(Ta,null);Vb.setResult(Ta.InstanceId)}return Vb.task}Qgh(Ta,Vb,qc){this.Kn(Ta.InstanceId)||(Ta=new Lb(this,this.hh,Ta),Ta.Zua=qc,Ta.shf(Vb),this.yf.push(Ta),this.Nya=null)}aQf(Ta,Vb){const qc=wd.owa(Ta,this.$);if(!this.zId.contains(qc))this.vJb.push(Ta),1<=this.vJb.length&&this.bQf(Ta,Vb);else if(Vb)for(const Ic of this.dQf)if(wd.owa(Ic,this.$)===
qc){Vb(Ic,0);break}}bQf(Ta,Vb){let qc=null;const Ic={};Ic.SolutionId=wd.getSolutionId(Ta,this.$);Ic.TargetType=Ta.WebExtensionType;Ic.Version=Ta.PrimaryMarketplace.SolutionVersion;Ic.StoreType=Ta.PrimaryMarketplace.MarketplaceType;Ic.StoreId=Ta.PrimaryMarketplace.MarketplaceRef;Ta.AssetMarketplace?(Ic.AssetId=Ta.AssetMarketplace.SolutionId,Ic.AssetStoreId=Ta.AssetMarketplace.MarketplaceRef):(Ic.AssetId=null,Ic.AssetStoreId=null);Ic.Width=Ta.TaskpaneWidth;Ic.ContainsCustomFunctions=!0;Ib.HelperMethods.Tw(Ta)&&
(Ic.SharedRuntimeId=Ta.SharedRuntime.Resid);const gd=this.$.pa.va;Ta=this.$.pa.va.ic();const Kd=gd.Oa(9,Ta);Kd.sharedInfo=Ic;const oe=ze=>{ze=re.a.Ye(ze.data);f.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Cb.a.xc(ze)}`)},Ce=ze=>{ze&&!Zb.a(ze)||f.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ic.SolutionId,Ic.StoreType,Ic.AssetId,null,
null,Ic.StoreId)} finish with errors: ${Cb.a.xc(ze.Errors)}`);this.vJb.shift();0<this.vJb.length&&this.bQf(this.vJb[0],Vb)};if(Vb){const ze=af=>{const Za=af.Result;(qc=Za?Za.AgaveData:null)||Vb(null,af.Errors?af.Errors[0].ErrorCause:5001);Vb(qc,0)};Ta=(af,Za,Rb)=>of.g(gd,"InsertAgaveTaskpane",Kd,jd.b(af,Ce,ze),jd.a(Za,oe),Rb,null,0)}else Ta=(ze,af,Za)=>of.g(gd,"InsertAgaveTaskpane",Kd,jd.b(ze,Ce),jd.a(af,oe),Za,null,0);Ae.a(this.$.userOperationManager,Ta,ze=>new $e.a(519,0,ze,64),null)}ALj(){return this.$.se.get(35)}NNd(Ta){Ta=
this.Kn(Ta);(null===Ta||void 0===Ta?0:Ta.Vea)&&Ta.mZf()}uRi(Ta){var Vb=this.kka(qc=>wd.TNa(qc.qQ));Vb&&(Vb=this.Jg.getOsfControl(Vb.controlId))&&Vb.notifyAgave(OSF.AgaveHostAction.SendMessage,Ta)}lsi(){return!!this.kka(Ta=>1===Ta.controlType&&wd.TNa(Ta.qQ))}ksi(){const Ta=this.kka(Vb=>wd.TNa(Vb.qQ));return Ta?Ta.Hy?Aa.DOMElementExtensions.isVisible(Ta.Hy):!1:!1}PEj(){const Ta=this.kka(Vb=>wd.TNa(Vb.qQ));Ta&&(Ta.$g(!0),this.raiseEvent("ca",Ta.controlId))}initialize(Ta){const {DdaEventDispatch:Vb}=
a(1420),qc=void 0===this.$||null===this.$||Sa.EwaSettings.ya(234);void 0!==this.$&&null!==this.$||f.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");qc&&f.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(lf.lIa(this.$),this.ea=this.$.ea,this.hh=new Vb(this.$),this.$.rl(this.yd),this.ea.Zj(this.dd),this.ea.pM(this.So),this.ea.vu(this.Gf),this.$.userOperationManager.tr(this.WR),this.Qtf(),
this.X0i(),this.omi(),this.$.da.Ha(35,this),this.$_c.la(this),qc&&f.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.ble=new Tb.a,qc&&f.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.ele=new Qd(this.$,this.Mh,this.hh),new pb(this.$,this.Mh,this.hh),this.cle=new gb(this.$,this.Mh,this.hh),this.ale=new Xb(this.$,this.Mh,this.hh),this.$ke=new sc(this.$,this.Mh,this.hh),this.dle=new Xd(this.$,this.Mh,this.hh),this.fle=
new mc(this.$,this.Mh,this.hh),this.gle=new Kc(this.$,this.Mh,this.hh),this.$.uR&&(this.hle=new Vd(this.$,this.Mh,this.hh)),Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7637843_CreateRichApiRangeValuesPreview")&&(this.ile=new Ad(this.$,this.Mh,this.hh,Ta)),Sa.EwaSettings.ya(178)&&(this.p3a=new Ub(this,db.h(this.$))),Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.Zke=new qb),this.Yke=new Md(this.$,this.Mh,this.hh),this.initialized=!0,f.ULS.sendTraceTag(537170520,
0,50,"DdaFacade is initialized"))}CMh(Ta){if(!this.ODa)return null;for(let Vb=0,qc=this.ODa.length;Vb<qc;Vb++)if(Ta.startsWith(this.ODa[Vb].WebExtensionId))return this.ODa[Vb];return null}Qtf(){var Ta,Vb=this.ea;if(Vb.jc&&!this.XSb){if(Vb.workbookContext){if(this.JXc=this.$.ea.Lg.get(22),null===(Ta=Vb.workbookContext.WebExtensions)||void 0===Ta?0:Ta.length){Ta=Vb.workbookContext.WebExtensions;Vb=!1;for(let qc=Ta.length-1;0<=qc;qc--){if(!this.ea.isNamedObjectViewMode){this.ktc.push(Ta[qc].InstanceId);
if(1!==Ta[qc].WebExtensionType){Ta.splice(qc,1);continue}if(Ib.HelperMethods.Tw(Ta[qc])&&0!==Ta[qc].SharedRuntime.State)1===Ta[qc].SharedRuntime.State?Ta[qc].TaskpaneVisible=!1:2===Ta[qc].SharedRuntime.State?Ta[qc].TaskpaneVisible=!0:f.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Ta[qc].ContainsCustomFunctions&&!Ta[qc].TaskpaneVisible&&!wa.a(Ta[qc])){Ta.splice(qc,1);continue}}const Ic=OSF.OsfControl.isFirstPartyStoreString(Ta[qc].PrimaryMarketplace.MarketplaceType);
if(Sa.EwaSettings.ya(174)&&!Ic&&(Ta.splice(qc,1),!Vb)){Vb=!0;const gd=Object(da.b)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(K.d)(xa.a.resolve(rb.f,{rb:3})):jb.GetServiceTaskFactory.Sa(this.$.da,5,4,3);Z.TaskExtensions.za(gd,()=>{gd.result.eh(36,null)},this.ka,3)}Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Ta[qc].PrimaryMarketplace&&wd.TNa(Ta[qc].PrimaryMarketplace.SolutionId)&&(f.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),
Ta.splice(qc,1))}this.EJe(Ta)}}else this.JXc=!1;this.XSb=!0}}bcf(Ta){const Vb=db.h(this.$),qc=Vb.ga.Ra.oc;if(qc&&Ta){Ta=!1;if(this.yf)for(const Ic of this.yf)if(wd.TNa(Ic.qQ)||wd.Avi(Ic.qQ)){Ta=!0;break}Ta||Vb.ga.Ra.wH(qc)}}X0i(){this.Jg&&this.ea.isNamedObjectViewMode&&this.$.na&&Ud.o(this.$.na)&&(this.$.da.Aa(34).rR?this.$.da.Aa(34).pqd():this.$.da.Aa(34).vv(this.R6i))}EJe(Ta){let Vb=null;Vb=qc=>{const Ic=qc.WebExtensionData,gd=qc.IsTaskPane,Kd=qc.RecordHandler,oe=()=>{this.jRa.shift();0<this.jRa.length&&
Vb(this.jRa[0])};if(this.Sba(Ic.PrimaryMarketplace.SolutionId))oe();else{gd&&(Ic.WebExtensionOsfControlType=1);var Ce=wa.a(Ic);if(!gd||Ic.TaskpaneVisible||Ce||Ic.SharedRuntime&&0!==Ic.SharedRuntime.State||Ic.ContainsCustomFunctions){var ze=new Lb(this,this.hh,Ic,!gd);f.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ic.PrimaryMarketplace.SolutionId,Ic.PrimaryMarketplace.MarketplaceType,null,null,null,Ic.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Ic.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ib.HelperMethods.Tw(Ic)}`);
ze.bqd();Ib.HelperMethods.Tw(Ic)&&(ze.Zua=wd.owa(Ic,this.$),Ic.TaskpaneWidth=this.Zub);Ce&&(Ic.WebExtensionToolTip="");!Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&gd&&Ic.TaskpaneVisible&&!Ce&&(Ic.TaskpaneWidth=this.Zub);this.yf.push(ze);var af=this.Nya=null;af=zf.a.instance.cD(()=>{ze.Hy&&(nb.a.Ja(af),af=null,Kd&&Kd(qc,ze),oe())},100,Lf.a.Knh)}else oe()}};for(let qc=0;qc<Ta.length;qc++){if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const Ic=
Ta[qc].WebExtensionType===OSF.OsfControlTarget.TaskPane,gd=wa.a(Ta[qc]);Ic&&!gd&&(Ta[qc].TaskpaneWidth=this.Zub)}if(!this.Kn(Ta[qc].InstanceId))if(1!==Ta[qc].WebExtensionType)this.LJa(Ta[qc]);else if(!Sa.EwaSettings.ya(52))this.cpb(Ta[qc],Vb);else if(this.$.Nd&8388608||Ta[qc].TaskpaneVisible){const Ic={};Ic.solutionId=Ta[qc].PrimaryMarketplace.SolutionId;Ic.version=Ta[qc].PrimaryMarketplace.SolutionVersion;Ic.storeType=Ta[qc].PrimaryMarketplace.MarketplaceType;Ic.storeId=Ta[qc].PrimaryMarketplace.MarketplaceRef;
Ic.targetData=Ta[qc];this.Jg.isAddinCommandsAsync(Ic,(gd,Kd,oe)=>{if(gd){var Ce=oe.targetData;if(Kd)if(Ic.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())gd=Ic.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Kd=Ic.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(gd||Kd)&&Ib.HelperMethods.Tw(Ce)&&this.cpb(Ce,Vb);else if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.wei(oe,Vb);else{let ze=
!1;this.uea(af=>{if(!af.errorCode){if(af.value)for(const Za of af.value){if(ze)break;ze=ua.e(Za[1])===ua.e(Ce.PrimaryMarketplace.SolutionId)}ze?Ib.HelperMethods.Tw(Ce)&&this.cpb(Ce,Vb):(af={},af.SolutionId=oe.solutionId,af.Version=oe.version,af.StoreType=Ce.PrimaryMarketplace.MarketplaceType,af.StoreId=oe.storeId,af.AssetId=null,af.AssetStoreId=null,af.Width=Ce.TaskpaneWidth,af.TargetType=Ce.WebExtensionType,Ce.TaskpaneVisible=!0,this.Vpe(af,Ce,Vb))}},!0)}else this.cpb(Ce,Vb)}else gd=oe.targetData,
f.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(gd.PrimaryMarketplace.SolutionId,gd.PrimaryMarketplace.MarketplaceType,null,null,null,gd.PrimaryMarketplace.MarketplaceRef)} from ${gd.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}wei(Ta,Vb){let qc=!1;this.uea(Ic=>{const gd=Ta.targetData;if(!Ic.errorCode){if(Ic.value)for(const Kd of Ic.value){if(qc)break;qc=ua.e(Kd[1])===ua.e(gd.PrimaryMarketplace.SolutionId)}qc?
Ib.HelperMethods.Tw(gd)&&this.cpb(gd,Vb):(Ic={},Ic.SolutionId=Ta.solutionId,Ic.Version=Ta.version,Ic.StoreType=gd.PrimaryMarketplace.MarketplaceType,Ic.StoreId=Ta.storeId,Ic.AssetId=null,Ic.AssetStoreId=null,Ic.TargetType=gd.WebExtensionType,Ic.Width=gd.TaskpaneWidth,gd.TaskpaneVisible=!0,this.Vpe(Ic,gd,Vb))}},!0)}cpb(Ta,Vb){const qc={};qc.WebExtensionData=Ta;qc.IsTaskPane=!0;this.jRa.push(qc);1===this.jRa.length&&Vb(qc)}Vpe(Ta,Vb,qc){const Ic={};Ic.ActivationInfo=Ta;Ic.WebExtensionData=Vb;Ic.IsTaskPane=
!1;Ic.RecordHandler=(gd,Kd)=>{const oe=gd.ActivationInfo;this.Jg.insertBlankControlWithErrorUX(this.VJb(Kd,oe),()=>{this.kSa(Kd.controlId);this.Jg.purgeOsfControl(Kd.controlId,!1);this.Wjg(oe)})};this.jRa.push(Ic);1===this.jRa.length&&qc(Ic)}Wjg(Ta){var Vb={};Vb.solutionId=Ta.SolutionId;Vb.version=Ta.Version;Vb.storeType=Ta.StoreType;Vb.storeId=Ta.StoreId;Vb.assetId=Ta.AssetId;Vb.assetStoreId=Ta.AssetStoreId;Vb.targetType=Ta.TargetType;Vb.sharedRuntimeId=Ta.SharedRuntimeId;Ta=new O.a;Ta.add(Vb);Vb=
{};Vb[ha.a.jqb]=Ta;Vb[ha.a.rM]=3;Ta=new Ua.a(zc.a.TEb,0,this.$.Bc,0,null);this.$.Ia.Nb(Ta,Vb)}VJb(Ta,Vb){const qc={};qc.div=Ta.Hy;qc.id=Ta.controlId;qc.solutionId=Vb.SolutionId;qc.version=Vb.Version;qc.storeId=Vb.StoreId;qc.storeType=Vb.StoreType;qc.osfControlType=OSF.OsfControlTarget.TaskPane;return qc}e2f(){if(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const qc=[];for(var Ta=0;Ta<this.yf.length;Ta++){var Vb=this.yf[Ta];0!==Vb.osfControlType&&3!==Vb.osfControlType&&
4!==Vb.osfControlType||qc.push(Vb)}Ta=!1;for(Vb=0;Vb<qc.length;Vb++){const Ic=qc[Vb];this.kSa(Ic.controlId);!Ta&&Ic&&Ic.Hl&&(Ta=Ib.HelperMethods.Tw(Ic.Hl))}Ta&&this.GK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}Sa.EwaSettings.ya(355)&&Z.TaskExtensions.za(jb.GetServiceTaskFactory.Sa(this.$.da,278,279,3),qc=>{qc&&(qc=qc.result)&&(this.$.da.Aa(278)||this.$.da.Ha(278,qc),qc.wif().Moa())},this.ka,3)}qL(){var Ta=new me(this.$,this.Mh,this.n3f);void 0===this.$||null===this.$?f.ULS.sendTraceTag(537170514,
0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Sa.EwaSettings.ya(234)&&f.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Mh||null===this.Mh));if(Ta.lQi()){const Vb=()=>{},qc=gd=>{gd=re.a.Ye(gd.data);f.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Cb.a.xc(gd)}.`)},Ic=Ta.s2g();Ta=wd.ukd(Ic);Ta|=64;this.$.userOperationManager.pF(new $e.a(507,
0,(gd,Kd,oe)=>of.g(this.$.pa.va,"ExecuteRichApiRequest",this.t2g(Ic),jd.b(gd,Vb),jd.a(Kd,qc),oe,null,0),Ta))}}t2g(Ta){const Vb=this.$.pa.va.Oa(1);Vb.request=Ta;return Vb}uEe(Ta,Vb){if(Ta)for(let qc=0;qc<Ta.length;qc++)if(yc.a.equals(Ta[qc],Vb,!0))return!0;return!1}t1g(Ta){const Vb={};Vb.navigationMode=OSF.OsfNavigationMode.DefaultMode;Vb.assetId=null;Vb.category=null;if(!Ta||3>Ta.length)return Vb;if(Ta[0]){const qc=parseInt(Ta[0],10);isNaN(parseInt(qc,10))||(Vb.navigationMode=qc)}Ta[1]&&(Vb.assetId=
Ta[1]);Ta[2]&&(Vb.category=Ta[2]);return Vb}omi(){if(Sa.EwaSettings.ya(60)){var Ta=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Ta&&"*"!==Ta.trim()){this.JKa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new wb(this),Ta,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.se.get(2));try{this.JKa.init()}catch(Vb){try{this.JKa.dispose()}catch(qc){}this.JKa=null;f.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Vb.message)}Ta=
{};Ta.a=this.$.xa.UserSessionId;Bd.b().gf(39,Ta)}}}bcg(Ta,Vb,qc){const Ic=wd.G0g(Ta[0]),gd=Ic.Dia,Kd=Ic.Fja;Ic.Dia=()=>{gd&&gd();const oe=Ic.vNa!==OSF.InfoType.Error?Vb:null;Ta.shift();Ta.length?this.bcg(Ta,oe,qc):oe&&oe()};Ic.Fja=()=>{Kd&&Kd();qc&&Ic.vNa!==OSF.InfoType.Error&&qc()};qa.a.EWd(Ic)}H0h(){const Ta={};Ta.AddinRibbonControlsOverriddenByApi=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();Ta.AddinActionDefinitionHybridMode=Sa.EwaSettings.ya(556).toString();
Ta.UseActionIdForUILessCommand=Sa.EwaSettings.ya(559).toString();Ta.AllowStorageAccessByUserActivationOnIFrame=Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Ta.RequirementSetRibbonApiOnePointTwo=Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Ta.flightingTreatmentVariables=w.AFrameworkApplication.fa.Dcc;Ta.ShortcutInfoArrayInUserPreferenceData=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();
Ta.DisabledChangeGates=w.AFrameworkApplication.fa.Wa("DisabledChangeGates");Ta.DmsSdxListWorkbook=w.AFrameworkApplication.ZPe;return Ta}static get q7b(){return wd.C9d}static set q7b(Ta){wd.C9d=Ta}static getSolutionId(Ta){let Vb=Ta.PrimaryMarketplace.SolutionId;Sa.EwaSettings.ya(261)&&Ta.OwnerAddinSolutionId&&(Vb=Ta.OwnerAddinSolutionId);return Vb}static ukd(Ta){let Vb=0;Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Ta.RequestFlags&1&&256!==(Ta.RequestFlags&
256)||(Vb=16):Vb=Ta.RequestFlags&1?0:16;return Vb}static owa(Ta,Vb){Vb=wd.getSolutionId(Ta,Vb);return wd.X4e(Vb,Ta.PrimaryMarketplace.SolutionVersion,Ta.PrimaryMarketplace.MarketplaceType,Ta.PrimaryMarketplace.MarketplaceRef)}static ykh(Ta){return JSON.stringify({["recording"]:Ta})}static Pfh(Ta){const Vb={};Vb.visibility=Ta?"Visible":"Hidden";return JSON.stringify(Vb)}static IXh(Ta){let Vb=Ta.getSolutionId(),qc=Ta.getVersion(),Ic=Ta.getStoreType();Ta=Ta.getStoreId();return wd.X4e(Vb,qc,Ic,Ta)}static X4e(Ta,
Vb,qc,Ic){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",Ta,Vb,wd.j9h(qc).toString(),Ic)}static qmd(Ta,Vb){var qc=Ta.split("|");if(7>qc.length)return f.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==qc[0])return f.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${qc[0]}'.`),null;let Ic=qc[1];const gd=qc[2],Kd=wd.k9h(qc[3]),oe=qc[4];qc=qc[5];Ic&&Ic.length||(Ic=
qc);qc={};qc.InstanceId=String.format("{{{0}}}",P.a.create().toString());qc.WebExtensionOsfControlType=4;qc.WebExtensionType=1;qc.PrimaryMarketplace={};qc.PrimaryMarketplace.SolutionId=Ic;qc.PrimaryMarketplace.SolutionVersion=gd;qc.PrimaryMarketplace.MarketplaceRef=oe;qc.PrimaryMarketplace.MarketplaceType=Kd;qc.ContainsCustomFunctions=Vb?!0:!1;Vb&&(qc.OsfPropertyBag=[["customFunctionAddinId",Ta]]);return qc}static k9h(Ta){Ta=parseInt(Ta,10);return Ta===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:
Ta===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Ta===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:Ta===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Ta===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Ta===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Ta===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Ta===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Ta===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Ta===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:Ta===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static j9h(Ta){return Ta===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Ta===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Ta===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Ta===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Ta===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Ta===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Ta===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
Ta===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Ta===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Ta===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Ta===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}NJa(Ta){const Vb={};Vb.Version=Ta.version;Vb.AssetId=Ta.assetId;Vb.AssetStoreId=Ta.assetStoreId;Vb.StoreType=Ta.storeType;Vb.Height=Ta.height;Vb.SolutionId=Ta.solutionId;Vb.StoreId=Ta.storeId;Vb.TargetType=Ta.targetType;Vb.Width=
1===Vb.TargetType?0:Ta.width;Vb.SharedRuntimeId=Ta.sharedRuntimeId;return Vb}static lCb(Ta){return Ta===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Ta===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Ta===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ta===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Ta===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Ta===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Ta===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||
Ta===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static G0g(Ta){return Object(b.a)(new we.a,{vNa:Ta.infoType,id:Ta.id,title:Ta.title,description:Ta.description,buttonText:Ta.buttonTxt,Dia:Ta.buttonCallback,whc:Ta.highPriority,Fja:Ta.dismissCallback,errorCode:Ta.errorCode,Fgf:Ta.iframeNotificationUrl})}static TNa(Ta){let Vb="FA000000014"===Ta;Vb||(Vb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Ta);return Vb}static Avi(Ta){return"FA000000005"===Ta}}wd.i3a=new E.a;wd.C9d=!0;Object(c.a)(wd,
"DdaFacade",ma.a,[300,690,683,691,692,2])},789:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b,f,e,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=f;this.ddaBinding=e;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(t.a)(c,"DdaEventArgs",null,[])},842:function(t,C,a){t=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(t.a)(c,"AddInDataTransferObject",
null,[]);a.d(C,"a",function(){return b});class b{constructor(f,e,d){this.vTb=f;this.qwg=e;this.rwg=d}get ot(){return this.vTb}get oNg(){return this.qwg}get pNg(){return this.rwg}static r5a(f){return(f=f.EW)?Object.assign(new c,{tabs:f.ot.toArray(),id:f.oNg,title:f.pNg}):null}}Object(t.a)(b,"OneLineRibbonExtensibility",null,[])},847:function(t,C,a){a.d(C,"a",function(){return c});a.d(C,"b",function(){return b});const c=f=>{let e=null;switch(f){case 0:e="omex";break;case 1:e="spcatalog";break;case 2:e=
"spapp";break;case 3:e="filesystem";break;case 4:e="exchange";break;case 6:e="registry";break;case 7:e="inmemory";break;case 8:e="uploadfiledevcatalog";break;case 9:e="hardcodedpreinstall";break;case 10:e="excatalog";break;case 16:e="wopicatalog"}return e},b=f=>{let e=-1;switch(f.toLowerCase()){case "omex":e=0;break;case "spcatalog":e=1;break;case "spapp":e=2;break;case "filesystem":e=3;break;case "exchange":e=4;break;case "registry":e=6;break;case "inmemory":e=7;break;case "uploadfiledevcatalog":e=
8;break;case "hardcodedpreinstall":e=9;break;case "excatalog":e=10;break;case "wopicatalog":e=16}return e}},876:function(t,C,a){a.r(C);t=a(0);var c=a(198),b=a(14),f=a(105);class e{constructor(){this.startTime=0;this.callback=null}}Object(t.a)(e,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(t.a)(d,"AccessTokenInformation",null,[214]);var h=a(1001);class r{constructor(){this.token=null;this.expiresOn=0;this.oia=this.authChallenge=null}}Object(t.a)(r,"CachedTokenInfo",
null,[]);class l{constructor(){this.bUb=new c.a;this.iaa=this.haa=!1;this.bqa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Jue=null}get callbacks(){return this.bUb}}Object(t.a)(l,"SSORequestInfo",null,[]);class u extends l{constructor(){super();this.errorCode=0}}Object(t.a)(u,"SSOFailedRequestInfo",l,[]);var v=a(6);class x{constructor(M,R,P,E){this.ET=new c.a;this.QG=new c.a;this.cra=null;this.wnb=new c.a;this.Cfe=Promise.resolve(null);this.Pme=!1;this.$Yb=R;this.zUb=M;this.tne=P;
this.vwg=E}JMj(M){if(this.cra&&this.cra.authChallenge===M.authChallenge){if(Date.now()/1E3+x.OMi>this.cra.expiresOn)return this.cra=null,!1;M=new h.a;M.token=this.cra.token;M.expiresOn=this.cra.expiresOn;M.oia=this.cra.oia;M.mVa=!0;M.tzb=0;this.Kzb(M);return!0}return!1}dLj(M){for(let R=0;R<this.QG.count;R++)if(this.QG.ma(R).authChallenge===M.authChallenge&&this.QG.ma(R).bqa===M.bqa){let P;(P=this.QG.ma(R)).retryCount=P.retryCount+1;M.retryCount=this.QG.ma(R).retryCount;if(this.QG.ma(R).retryCount<
x.lNi||!this.QG.ma(R).haa&&M.haa||!this.QG.ma(R).iaa&&M.iaa){if(!this.QG.ma(R).haa&&M.haa||!this.QG.ma(R).iaa&&M.iaa)M.retryCount=0;this.QG.removeAt(R);break}M=new h.a;M.errorCode=this.QG.ma(R).errorCode;this.Kzb(M);return!0}return!1}gPg(M,R){for(let P=0;P<this.QG.count;P++)if(this.QG.ma(P).bqa===M.bqa&&this.QG.ma(P).authChallenge===M.authChallenge)return;this.QG.add(Object.assign(new u,{haa:M.haa,iaa:M.iaa,authChallenge:M.authChallenge,bqa:M.bqa,errorCode:R,retryCount:M.retryCount}))}get resource(){return this.$Yb}dhd(M,
R,P,E,H,G){const {AppsForOfficeSingleSignOnManager:N}=a(876);""===P&&(P=null);if(this.Pme)N.N6(G,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var I=null;for(let O of this.ET)if(O.haa===M&&O.iaa===R&&O.authChallenge===P&&O.bqa===H){I=O;break}I||(I=Object.assign(new l,{haa:M,iaa:R,authChallenge:P,Jue:E,bqa:H,retryCount:0,startTime:N.Nw()}),this.ET.add(I));I.retryCount=0;I.callbacks.add(G);this.Cfe=this.Cfe.then(()=>{var {AppsForOfficeSingleSignOnManager:O}=a(876);if(0<this.ET.count){var U=
this.ET.ma(0);if(this.JMj(U)||this.dLj(U))return null;for(let Q=0;Q<this.wnb.count;)this.wnb.ma(Q)+x.tYj<O.Nw()?this.wnb.removeAt(Q):Q++;if(this.wnb.count>=x.hNi||this.ET.count>=x.JMi)return U=new h.a,U.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.Kzb(U),null;let ca=null;v.AFrameworkApplication.sa&&(O=v.AFrameworkApplication.sa.jE)&&(ca=O.Qc("ComponentAttach",this.zUb+x.HIg));return U.bqa.jLg(this.resource,U.haa,U.iaa,U.authChallenge,this.vwg,U.Jue).then(Q=>{ca&&ca.stop();
this.Kzb(Q)},()=>{ca&&ca.stop();const Q=new h.a;Q.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.Kzb(Q)})}return null})}}Kzb(M){const {AppsForOfficeSingleSignOnManager:R}=a(876);try{if(this.ET.count){var P=this.ET.ma(0);this.ET.removeAt(0);var E=null;M.errorCode||(E=new d,E.accessToken=M.token);M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&
M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.gPg(P,M.errorCode);var H={};null!=M.tzb&&(H.getTokenSilentTime=M.tzb.toString());null!=M.Wld&&(H.getTokenPopupTime=M.Wld.toString());null!=M.Hjd&&(H.getIDTokenTime=M.Hjd.toString());null!=M.mVa&&(H.tokenCached=M.mVa.toString());M.t_d&&(H.detailedError=M.t_d);M.oia&&(H.authLibrary=M.oia);P.retryCount&&(H.retryCount=P.retryCount);for(var G of P.callbacks)R.N6(G,M.errorCode,E,H);null!=M.mVa&&M.mVa||this.wnb.add(P.startTime);if(!M.errorCode)for(null!=
M.expiresOn&&(this.cra=Object.assign(new r,{token:M.token,expiresOn:M.expiresOn,authChallenge:P.authChallenge,oia:M.oia})),this.QG.clear(),G=0;G<this.ET.count;)if(this.ET.ma(G).authChallenge===P.authChallenge){for(let N of this.ET.ma(G).callbacks)R.N6(N,M.errorCode,E,H);this.ET.removeAt(G)}else G++}}catch(N){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",N.message)}}shutdown(){this.Pme=!0;this.ET.clear()}}x.tYj=6E4;x.hNi=6;x.JMi=6;x.lNi=3;x.OMi=300;x.HIg="GetAccessToken";
Object(t.a)(x,"SSOCallbackManager",null,[]);var w=a(740),m=a(566),n=a(116),z=a(83),y=a(29),A=a(34),F=a(148),D=a(354);a.d(C,"AppsForOfficeSingleSignOnManager",function(){return B});class B{constructor(M,R,P=null){this.lJc=new f.a;const E=new c.a;R&&E.add(R.kLi);P&&E.addRange(P);this.Jl=M;this.MJg=E}ehd(M,R,P,E,H,G,N,I,O,U){U=Object.assign(new e,{startTime:B.Nw(),callback:U});try{const Y=!!P&&""!==P;var ca=U.startTime;const la=this.getOsfControl(M);let ea=la.getStoreType()||"",ha=la.getOwnerAddinStoreType()||
"",X=la.getSolutionId()||"";const T=la.getVersion()||"";ea=ea.toLowerCase();ha=ha.toLowerCase();X=X.toLowerCase();var Q=z.a.Gjd(R)||"";const ua=z.a.Gjd(la.getIframeUrl())||"",Ha=Q.toLowerCase()===ua.toLowerCase();Q=ea;"inmemory"===ea&&(Q=ha);const Ca=Telemetry.PrivacyRules.GetPrivacyCompliantId(X,Q,la.getAssetId(),null,null,la.getStoreId()),Ga={["callInstanceId"]:ca.toString(),["controlSolutionId"]:Ca,["controlVersion"]:T,["storeType"]:ea,["ownerStoreType"]:ha,["allowConsentPrompt"]:E.toString(),
["forMSGraphAccess"]:H.toString(),["allowSignInPrompt"]:G.toString(),["hasAddinAuthChallenge"]:Y.toString(),["securityOriginEqualsSourceLocation"]:Ha.toString(),["singleSignOnEnabled"]:N.toString(),["accountTypeFilter"]:I||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",Ga);F.a.sendTelemetryEvent(Object.assign(new D.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:n.a.mi(Ga)}));ca=!0;const sa=v.AFrameworkApplication.fa.Wa("HostAuthType");switch(I){case "aad":ca="aad"===sa;break;
case "msa":ca="msa"===sa;break;default:ca=!I||"noFilter"===I}if(ca){I=null;if(N)for(let bb of this.MJg)if(bb.Qti(X)){I=bb;break}I?this.isSSOAddin(M)?(N=!0,"omex"===Q&&(N=!1),"spapp"===Q||"spcatalog"===Q?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),B.N6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):H&&!N?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),B.N6(U,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(H&&"exchange"===Q&&(E=!1),this.dhd(M,R,P,Q,E,G,O,I,U))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),B.N6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):B.N6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else B.N6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Y){this.Ync(),b.ULS.sendTraceTag(22402397,
344,10,"GetAccessToken: action failed. Exception message: {0}",Y.message),B.N6(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(M,R,P,E){this.ehd(M,P[w.a.K_c]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,
R,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,P[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,E)}dhd(M,R,P,E,H,G,N,I,O){this.lJc.nb(M)?E=this.lJc.ma(M):(E=new x(M,this.getWebApplicationResource(M).split(",")[0],E,this.getDefaultDisplayName(M)),this.lJc.add(M,E));const U=E.resource;M=B.Z6h(U,this.getWebApplicationId(M));const ca=OfficeExt.WACUtils.getHostSecure(R);M&&ca?M.toLowerCase()===ca.toLowerCase()?E.dhd(H,G,P,N,I,O):(B.EPa('SSO Resource "'+
U+'" cannot be used from "'+R+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),B.N6(O,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(M||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ca||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),B.N6(O,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}Ync(){b.ULS.sendTraceTag(39068820,
344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(M){return this.Jl.getOsfControl(M)}isSSOAddin(M){return this.getOsfControl(M).getManifest().isSSOAddin()}getWebApplicationId(M){return this.getOsfControl(M).getManifest().getWebApplicationId()}getWebApplicationResource(M){return this.getOsfControl(M).getManifest().getWebApplicationResource()}getDefaultDisplayName(M){return this.getOsfControl(M).getManifest().getDefaultDisplayName()}static K8h(){try{const M=
{};y.a.Gya&&m.OAuthManagerSettings.CAb&&(M.UiHostSupportsAuthTokenAddinList=B.X_e);M.UiHostSupportsAuthToken=m.OAuthManagerSettings.CAb;return M}catch(M){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",M.message)}return null}static getInstance(M,R,P=null){B.Ma||(B.Ma=new B(M,P));return B.Ma}static EPa(M){window.console.warn&&window.console.warn(M)}static Z6h(M,R){if(!M)return"";R||(R="");let P=M.toLowerCase();var E=R.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(E)||
(B.EPa('SSO App Id "'+R+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));P.endsWith(E)||(B.EPa('SSO Resource "'+M+'" does not end with App Id "'+R+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!P.startsWith("https://")&&!P.startsWith("api://"))return B.EPa('SSO Resource "'+M+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(R=0;R<M.length;R++){E=M.charAt(R);const H=A.a.charCodeAt(M,R);if(33>H||126<H||"&"===E||"?"===E||"#"===E||"%"===E||"\\"===E)return B.EPa('SSO Resource "'+M+'" contains an invalid character "'+E+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+E+"' in resource URI."),""}if(0<=M.indexOf("::"))return B.EPa('SSO Resource "'+M+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
M.length)return B.EPa('SSO Resource "'+M+'" is '+M.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+M.length+"."),"";P.startsWith("api://")&&(P="https://"+P.substring(6,P.length));return 8===P.length?"":OfficeExt.WACUtils.getHostSecure(P)||""}static N6(M,R,P,E){var H=M.startTime;let G=0;0<H&&(G=B.Nw()-H);H={["callInstanceId"]:H.toString(),["callDuration"]:G.toString(),["errorCode"]:R.toString()};if(E)for(let N in E)H[N]=
E[N];b.ULS.sendTraceTag(51401116,344,50,"{0}",H);F.a.sendTelemetryEvent(Object.assign(new D.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:n.a.mi(H)}));M.callback(R,P)}static Nw(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(M){}return Date.now()}}B.X_e="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");B.Ma=null;Object(t.a)(B,
"AppsForOfficeSingleSignOnManager",null,[169])},893:function(t,C,a){a.d(C,"a",function(){return b});t=a(0);var c=a(15);class b{constructor(){this.oYe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.mYe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ha(1633),c.a.instance.ha(1637)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ha(1634),c.a.instance.ha(1638)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ha(1635),c.a.instance.ha(1639)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ha(1636),c.a.instance.ha(1640)]};this.pbc=null}get gja(){return"SourceControlId"}get iN(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}H2h(){if(!this.pbc){this.pbc={};for(const f of Object.keys(this.oYe))this.pbc[f]=this.oYe[f];for(const f of Object.keys(this.mYe))this.pbc[f]=this.mYe[f][0]}}}Object(t.a)(b,"AddinCommandsStringProvider",null,[726])},895:function(t,C,a){a.d(C,"a",function(){return c});
t=a(0);class c{constructor(){this.vNa=0;this.Dia=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.whc=!1;this.Fgf=this.Fja=null}}Object(t.a)(c,"AddInCommandsNotificationParameters",null,[])},971:function(t,C,a){t=a(0);var c=a(14),b=a(88),f=a(166),e=a(16),d=a(93);class h extends Sys.UI.Control{constructor(E,H,G,N){super(document.createElement("div"));this.iT=this.gT=this.kw=this.JG=this.VG=this.Xqa=this.usa=null;this.glb=this.Lra=!1;this.content=this.Kp=null;this.Z1=0;
this.zze=null;this.qU=0;this.kMf=null;this.Qne=E;this.$ie=H;this.HP=G;this.ZJ=N;this.rg=H.ownerDocument;this.Xgc=this.Ot=this.Alb=!1}get HW(){this.usa||(this.usa=this.rg.createElement("div"),this.usa.id=this.Sh("WACCalloutOuter"),this.usa.className="WACCalloutOuter",this.usa.setAttribute(d.a.Kd,d.a.w0a),this.usa.style.width=this.Z1+"px");return this.usa}get yrb(){if(!this.Xqa){this.Xqa=this.rg.createElement("div");this.Xqa.id=this.Sh("WACCalloutBeakContainer");this.Xqa.className="WACCalloutBeakContainer";
var E="CalloutBeakTopFilled_32x16x32";if(5===this.qU||6===this.qU||4===this.qU)E="CalloutBeakBottomFilled_32x16x32";E=f.createClusteredImage(32,16,E,"WACCalloutBeak",!0,"");this.Xqa.appendChild(E)}return this.Xqa}set yrb(E){this.Xqa=E}get aOa(){return this.Alb}get title(){return this.Kp}set title(E){this.Kp!==E&&(this.Kp=E,this.gT&&(this.gT.innerText=this.Kp))}get Ot(){return this.Lra}set Ot(E){this.Lra!==E&&(this.Lra=E,this.VG&&(this.VG.contains(this.kw)&&!this.Lra?this.VG.removeChild(this.kw):!this.VG.contains(this.kw)&&
this.Lra&&this.bre()))}get Xgc(){return this.glb}set Xgc(E){this.glb!==E&&(this.glb=E,this.VG&&(this.VG.contains(this.gT)&&!this.glb?this.VG.removeChild(this.gT):!this.VG.contains(this.gT)&&this.glb&&this.xse()))}show(){this.Alb||(this.hhh(),this.Cm(),this.$ie.appendChild(this.HW),this.HW.style.display="Block",this.THj(),this.Alb=!0,this.kMf&&this.kMf())}dismiss(){this.Alb&&(this.rba(),this.$ie.removeChild(this.HW),this.Alb=!1,this.ZJ&&this.ZJ())}dispose(){this.dismiss();this.gT=this.kw=this.JG=this.Xqa=
this.VG=this.usa=null;Sys.Component.prototype.dispose.call(this)}Sh(E){return this.get_element().id+E}hhh(){this.VG=this.rg.createElement("div");this.VG.id=this.Sh("WACCalloutHeader");this.VG.className="WACCalloutHeader";this.Ot&&this.bre();this.Xgc&&this.xse();this.JG=this.rg.createElement("div");this.JG.id=this.Sh("WACCalloutContent");this.JG.className="WACCalloutContent";this.JG.style.width=190<this.Z1?this.Z1-26+"px":"164px";this.JG.appendChild(this.content);this.HW.appendChild(this.yrb);this.HW.appendChild(this.VG);
this.HW.appendChild(this.JG)}bre(){this.kw=this.rg.createElement("a");this.kw.className="WACCalloutCloseAnchor";this.kw.id=this.Sh("WACCalloutCloseAnchor");this.kw.href="#";this.VG.appendChild(this.kw);const E=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.kw.appendChild(E)}xse(){this.gT=this.rg.createElement("div");this.gT.className="WACCalloutTitle UIFontBold";this.gT.style.width=190<this.Z1?this.Z1-30+"px":"160px";this.gT.id=
this.Sh("WACCalloutTitle");this.gT.innerText=this.title;this.VG.contains(this.kw)?this.VG.insertBefore(this.gT,this.kw):this.VG.appendChild(this.gT)}THj(){var E=this.Qne;let H;if(1===this.qU){var G=this.zze.y+16;H=-16}else 2===this.qU||3===this.qU||0===this.qU?(G=E.y+E.height+15,H=-15):(G=E.y-this.HW.clientHeight-15-2,H=this.HW.clientHeight-1);this.HW.style.top=G+"px";this.yrb.style.top=H+"px";1===this.qU?(E=this.zze.x-16,this.HW.style.left="50%",this.HW.style.marginLeft=-this.Z1/2+"px",G=Sys.UI.DomElement.getBounds(this.HW),
this.yrb.style.left=E-G.x+"px"):(G=E.x+this.Qne.width/2,2===this.qU||5===this.qU?(E=20,G-=36):0===this.qU||4===this.qU?(E=this.Z1/2-16,G-=this.Z1/2):(E=this.Z1-20-32,G=G-this.Z1+36),this.HW.style.left=G+"px",this.yrb.style.left=E+"px")}Cm(){this.Ot&&!this.iT&&(this.iT=Object(b.a)(this,this.Paa,"closeHandler"),this.HP.ta(e.a.click,this.kw,this.iT,null))}rba(){this.Ot&&this.iT&&(this.HP.Ba(e.a.click,this.kw,this.iT),this.iT=null)}Paa(){this.dismiss();return!0}}Object(t.a)(h,"Callout",Sys.UI.Control,
[413]);class r extends h{constructor(E,H,G,N,I,O=null){super(E,G,I.IX,O);this.fhe=0;this.Z1=this.L2h(N);this.SZa=H;this.pf=I;this.uZj=7;this.Ll=this.SZa.ownerDocument.createElement("div");this.Ll.className="ModalCalloutControlOverlay";this.Ll.tabIndex=0;this.SZa.insertBefore(this.Ll,this.SZa.firstChild)}show(){this.aOa||(this.pf.wuc(),this.pf.bQ(!1),this.Ll.style.zIndex=String(this.pf.j3),super.show(),this.Mi(),this.fhe=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.uZj))}dismiss(){this.aOa&&
(this.pf.QM(!1),this.Oi(),this.SZa&&this.SZa.contains(this.Ll)&&this.SZa.removeChild(this.Ll),super.dismiss(),window.clearTimeout(this.fhe))}Mi(){this.pf.zta(Object(b.a)(this,this.dismiss,"dismiss"));this.pf.Ty.ta(e.a.click,this.Ll,Object(b.a)(this,this.od,"onClick"))}Oi(){this.pf.Vdb(Object(b.a)(this,this.dismiss,"dismiss"));this.pf.Ty.Ba(e.a.click,this.Ll,Object(b.a)(this,this.od,"onClick"))}od(){this.dismiss();return!0}L2h(E){let H=0;switch(E){case 0:H=190;break;case 1:H=250;break;case 2:H=300;
break;case 3:H=360}return H}}Object(t.a)(r,"ModalCallout",h,[]);var l=a(468),u=a(185);class v extends r{constructor(E,H,G,N,I,O=null){super(E,H,G,N,I,O);this.NXb=null}show(){if(!this.aOa){const E=Object.assign(new l.a,{onShow:()=>{r.prototype.show.call(this)}});u.UISurfaces.OH().then(H=>{const G=H.externalNotification();this.NXb=H.addNotification(G,E);return null},H=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null})}}dismiss(){this.aOa&&this.NXb&&(u.UISurfaces.OH().then(E=>
{E.removeNotification(this.NXb);return this.NXb=null},E=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",E);return null}),super.dismiss())}}Object(t.a)(v,"ReactManagedModalCallout",r,[]);var x=a(6);class w{static Tih(E,H,G){return x.AFrameworkApplication.sa.Pa.wR?new v(E,H,G,3,x.AFrameworkApplication.sa,null):new r(E,H,G,3,x.AFrameworkApplication.sa,null)}}Object(t.a)(w,"ModalCalloutControlFactory",null,[]);var m=a(57),n=a(891),z=a(596),y=a(892),A=a(143),F=a(58),D=a(43),
B=a(84),M=a(842),R=a(719);a.d(C,"a",function(){return P});class P{static get g3b(){return P.ega||(P.ega=B.a.instance.yg("Common.Utils.IAriaNotifier"))}static LJe(E,H,G,N){P.BJ&&P.BJ.aOa&&P.BJ.dismiss();P.BJ=w.Tih(H,E,E);P.BJ.content=G;R.b(N)||(P.BJ.title=N,P.BJ.Xgc=!0);E=new Sys.UI.Bounds(0,0,F.a.Sfc(),F.a.Rfc());P.BJ.qU=P.vVh(E,H,P.BJ.Z1);P.BJ.show();P.g3b&&P.g3b.sendNotification(G.innerText,!0)}static O7c(E,H,G,N=null){u.UISurfaces.OH().then(I=>{let O=null;P.tnb&&(I.removeNotification(P.tnb),P.tnb=
null);const U=I.callout(Object.assign(new n.a,{target:E,title:H,content:G,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new y.a,{onDismiss:()=>{I.removeNotification(O)},directionalHint:null!=N?N:null})})),ca=Object.assign(new l.a,{expirationOptions:Object.assign(new z.a,{displayTimeoutSeconds:7,onExpire:()=>{I.removeNotification(P.tnb)}})});O=P.tnb=I.addNotification(U,ca);return null},I=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
I);return null})}static DWd(E,H=null){P.BJ&&P.BJ.aOa&&P.BJ.dismiss();const G=new A.StandardDialog;G.kUa=!1;G.Xb=0;G.rA(m.a.gEi,CommonUIStrings.l_DialogError,R.b(E)?P.f5e():E,H)}static EWd(E){P.BJ&&P.BJ.aOa&&P.BJ.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",E.errorCode));const H=R.b(E.description)?P.f5e():E.description,G=new A.StandardDialog;let N=null;E.Dia?(G.Xb=1,G.yc(1,E.buttonText),G.l1(1)):G.Xb=0;N=I=>{1===I?E.Dia():E.Fja&&E.Fja()};
G.kUa=!1;0===E.vNa?G.rA(E.errorCode,E.title?E.title:CommonUIStrings.l_DialogError,H,N):1===E.vNa?G.FS(E.title?E.title:CommonUIStrings.l_DialogWarning,H,N):G.ypa(E.title?E.title:CommonUIStrings.l_DialogInfo,H,N)}static vVh(E,H,G){let N=4;const I=E.x+E.width-H.x-H.width;H.x-E.x+H.width/2<=G/2?N=5:I+H.width/2<=G/2&&(N=6);return N}static rOj(E,H,G,N=!1){(H=M.a.r5a(H))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(H,I=>{I&&(N||P.O7c(I,
G,E,5))})}static sOj(E,H,G=!1){P.rOj(H.startedNode?H.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,E),H,H.startedNode?H.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,E),G)}static qOj(E,H,G,N){if(P.cpg)E=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,G,N,CommonUIStrings.l_InsertionDialogRefresh)),P.O7c(H,E,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{H=
D.a.qp(H);var I=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),O=document.createElement("span");O.innerText=I[0];var U=document.createElement("span");U.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,G,N,CommonUIStrings.l_InsertionDialogRefresh);U.className="UIFontBold";G=document.createElement("span");G.innerText=I[1];N=document.createElement("div");Sys.UI.DomElement.addCssClass(N,"ModalCalloutControl");N.appendChild(O);N.appendChild(U);N.appendChild(G);
P.LJe(E,H,N,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static KPj(E,H){var G=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,N=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;P.cpg?P.O7c(H,G,N):(H=D.a.qp(H),P.LJe(E,H,P.Z2g(N),G))}static Z2g(E){const H=document.createElement("div");Sys.UI.DomElement.addCssClass(H,"ModalCalloutControl");H.innerText=E;return H}static f5e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get cpg(){return x.AFrameworkApplication.sa.Pa.Yi&&
x.AFrameworkApplication.sa.Pa.wR}}P.BJ=null;P.tnb=null;P.ega=null;Object(t.a)(P,"AddInCommandsNotificationFactory",null,[])},982:function(t,C,a){a.r(C);t=a(0);var c=a(14),b=a(1533),f=a(148),e=a(116),d=a(740),h=a(757),r=a(354);class l{constructor(m,n,z,y){this.vo=!1;this._id=m;this.Mx=n;this.s2=z;this.Ed=y}get enabled(){return this.vo}set enabled(m){const {DynamicRibbon:n}=a(982);var z=this.Ed.OwnerAddinStoreType?this.Ed.OwnerAddinStoreType:this.Ed.PrimaryMarketplace.MarketplaceType;const y=this.Ed.PrimaryMarketplace.MarketplaceRef,
A=this.Ed.AssetMarketplace?this.Ed.AssetMarketplace.SolutionId:null,F=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Mx,z,null,null,null,y);z={["addinSolutionId"]:F,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ed.OwnerAddinSolutionId,z,A,null,null,y),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Button",["toggle"]:m};f.a.sendTelemetryEvent(Object.assign(new r.a,{name:n.nEc+"ControlUpdate",dataFields:e.a.mi(z)}));this.vo=m;this.s2.GK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,
["SolutionId"]:this.Mx,["PrivacyCompliantSolutionId"]:F,["SourceControlId"]:this.id,["MethodData"]:this.vo})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(m){switch(m){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m,
n){switch(m){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertySetAsync(m,n){this.invokePropertySet(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m,n){switch(m){case 5:return this.wEj(n);case 1:return this.eEa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,n){m=this.invokeMethod(m,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}wEj(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");this.setEnabled(m);return null}eEa(){this._OnAccess();return null}}Object(t.a)(l,"RibbonButton",null,[]);class u{constructor(m,n,z,y){this._id=m;this.Mx=n;this.s2=z;this.Ed=y}get id(){return this._id}setVisibility(m){const {DynamicRibbon:n}=a(982),z=this.Ed.OwnerAddinStoreType?this.Ed.OwnerAddinStoreType:this.Ed.PrimaryMarketplace.MarketplaceType;
var y=this.Ed.PrimaryMarketplace.MarketplaceRef;const A=this.Ed.AssetMarketplace?this.Ed.AssetMarketplace.SolutionId:null,F=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Mx,z,A,null,null,y);y={["addinSolutionId"]:F,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ed.OwnerAddinSolutionId,z,A,null,null,y),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Tab",["toggle"]:m};f.a.sendTelemetryEvent(Object.assign(new r.a,{name:n.nEc+"ControlUpdate",dataFields:e.a.mi(y)}));this.s2.GK(-1014260128,
{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.Mx,["PrivacyCompliantSolutionId"]:F,["StoreType"]:z,["SourceControlId"]:this.id,["MethodData"]:m})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(m){switch(m){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);
}invokePropertySetAsync(m,n){this.invokePropertySet(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m,n){switch(m){case 3:return this.zIj(n);case 1:return this.eEa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,n){m=this.invokeMethod(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}zIj(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");this.setVisibility(m);
return null}eEa(){this._OnAccess();return null}}Object(t.a)(u,"RibbonTab",null,[]);var v=a(1008),x=a(187);a.d(C,"DynamicRibbon",function(){return w});class w{constructor(m,n,z,y,A){this.Mx=m;this.LG=z;this.s2=y;this.Ed=A;this.Ojb=this.LG.Jg;this.dz=this.Ojb.getOsfControl(n);this.xEg=this.dz.getManifest()}get buttons(){return null}executeRequestCreate(m){try{var n=this.Ed.OwnerAddinStoreType?this.Ed.OwnerAddinStoreType:this.Ed.PrimaryMarketplace.MarketplaceType;const y=this.Ed.PrimaryMarketplace.MarketplaceRef,
A=this.Ed.AssetMarketplace?this.Ed.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Mx,n,A,null,null,y);const F={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ed.OwnerAddinSolutionId,n,A,null,null,y),["ownerAddinStoreType"]:this.Ed.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};f.a.sendTelemetryEvent(Object.assign(new r.a,{name:w.nEc+"ExecuteRequestCreate",dataFields:e.a.mi(F)}));const D=x.a.ri(m);m={};
n={};n[d.a.DKa]=this.dz;n[d.a.EKa]=D;n[d.a.Zad]=this.Ed;m[d.a.Kvb]=3;m[d.a.I4]=this.Mx;m[d.a.P$b]=z;m[d.a.H4]=n;this.s2.GK(-1014260128,m);let B=w.rdc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,B)}catch(y){z=w.rdc("ExecuteRequestCreate",!1,y.toString()),c.ULS.sendTraceTag(538572825,0,50,z)}return null}executeRequestUpdate(m){try{var n=this.Ed.OwnerAddinStoreType?this.Ed.OwnerAddinStoreType:this.Ed.PrimaryMarketplace.MarketplaceType;const y=this.Ed.PrimaryMarketplace.MarketplaceRef,
A=this.Ed.AssetMarketplace?this.Ed.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Mx,n,A,null,null,y);const F={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ed.OwnerAddinSolutionId,n,A,null,null,y),["ownerAddinStoreType"]:this.Ed.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};f.a.sendTelemetryEvent(Object.assign(new r.a,{name:w.nEc+"ExecuteRequestUpdate",dataFields:e.a.mi(F)}));const D=x.a.ri(m);m={};
n={};n[d.a.DKa]=this.dz;n[d.a.EKa]=D;n[d.a.Zad]=this.Ed;m[d.a.Kvb]=3;m[d.a.I4]=this.Mx;m[d.a.P$b]=z;m[d.a.H4]=n;this.s2.GK(-1014260128,m);let B=w.rdc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,B)}catch(y){z=w.rdc("ExecuteRequestUpdate",!1,y.toString()),c.ULS.sendTraceTag(538572823,0,50,z)}return null}getButton(m){let n=null;if(!this.hlf())return this.OJe();if(m&&0<m.length){if(!this.HEe(m))return this.gKe(m);n=new l(m,this.Mx,this.s2,this.Ed)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}getTab(m){let n=
null;if(!this.hlf())return this.OJe();if(this.dz.getOwnerAddinControlRecreated())return this.fih();if(m&&0<m.length){if(!this.HEe(m))return this.gKe(m);n=new u(m,this.Mx,this.s2,this.Ed)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(m){switch(m){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertySetAsync(m,n){this.invokePropertySet(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m){switch(m){case 1:return this.eEa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,n){switch(m){case 7:return this.RIh(n);case 6:return this.SIh(n);case 3:return this.aVh(n);
case 5:return this.F9h(n)}m=this.invokeMethod(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}RIh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.executeRequestCreate(m)}SIh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.executeRequestUpdate(m)}aVh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.getButton(m)}F9h(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return this.getTab(m)}eEa(){this._OnAccess();return null}gKe(m){return v.a(h.a.Edh,x.a.ha(1771)+m)}OJe(){return v.a(h.a.iwj,x.a.ha(1767))}fih(){return v.a(h.a.hostRestartNeeded,x.a.ha(1772))}hlf(){var m=this.dz.getSharedRuntimeId();m=!!m&&0<m.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",m));return m}HEe(m){const n=this.xEg.getRibbonExtensionControlMap();return m in n||this.T7g(m)}T7g(m){var n=this.tMh();if(n){n=n.hRe;
for(const z of n.tabs){if(z.id===m)return!0;for(const y of z.groups)for(const A of y.controls){if(A.id===m)return!0;if("Menu"===A.type){n=A;for(const F of n.items)if(F.id===m)return!0}}}}return!1}tMh(){return b.a.getInstance().ika(this.Ed.PrimaryMarketplace.MarketplaceType,this.Ed.PrimaryMarketplace.SolutionId,1)}static rdc(m,n,z){const y={};y.methodName="DynamicRibbon."+m;y.result=n?"Succeeded":"Failed";y.message=z;return x.a.Fc(y)}}w.nEc="Office.Online.Extensibility.Ribbon.";Object(t.a)(w,"DynamicRibbon",
null,[])},997:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);var c;(function(b){b[b.myAddins=0]="myAddins";b[b.adminManaged=1]="adminManaged";b[b.popular=2]="popular"})(c||(c={}));Object(t.b)("AddinCollectionType",c)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.agave.js.map/200e18282800257397378acc5e5c471e/EwaDSOpt.agave.js.map
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1333:function(t,C,a){a.r(C);t=a(0);var c=a(14),b=a(104),f=a(86),e=a(12),d=a(228);class h extends d.a{constructor(u){super();this.$=u;this.Mb()}create(){const {RenderingFidelityTracker:u}=a(1333);let v=this.$.da.Aa(462);v||(v=this.$.da.Ha(462,new u));this.vb(v)}}Object(t.a)(h,"RenderingFidelityTrackerFactory",d.a,[]);var r=a(46);a.d(C,"RenderingFidelityTracker",function(){return l});class l extends f.a{constructor(){super();
this.pOi=3E4;this.lhb={};this.k4d={};this.cAe={};b.Health.instance.addQosPillar("Fidelity")}static la(u){u.da.Ha(463,new h(u))}jVg(u,v,x,w){if(!(r.PageLoadTrackingInfo.instance.Ywa(new Date)<this.pOi)){var m=e.HelperMethods.PR(()=>{var n=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(v),z=Object.keys(n),y=this.cAe[u];for(var A=0;A<z.length;A++){var F=z[A];this.k4d[F]||(null===y||void 0===y?0:y[F])&&this.lhb[F]&&(this.lhb[F]-=y[F])}this.cAe[u]=n;for(A=0;A<z.length;A++)if(y=z[A],!this.k4d[y])if(F=
n[y],this.lhb[y]&&(F+=this.lhb[y]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(y,F)){this.k4d[y]=!0;n=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(y);z=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(y);A=!("ThickBorder"===y||"MediumBorder"===y);n&&z&&A&&b.Health.instance.recordQosError(n,[z],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+y+", isHC:"+x+", scaleFactor:"+w+"}");
break}else this.lhb[y]=F});1<m&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${m}`)}}}Object(t.a)(l,"RenderingFidelityTracker",f.a,[409,2])},1494:function(t,C,a){function c(oa){var na=oa.replace(/-.*/g,()=>"");na=Xb.get(na);return null!==na&&void 0!==na?na:oa.startsWith("ooux")?"ooux":"other"}a.r(C);var b={};a.r(b);a.d(b,"InteractivityTrackerService",function(){return pb});var f={};a.r(f);a.d(f,
"JsSelfProfilerManager",function(){return ed});var e={};a.r(e);a.d(e,"PageLoadEngagementInfo",function(){return Ae});var d={};a.r(d);var h=a(0),r=a(14);class l{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=
this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(h.a)(l,"BrowserInfo",null,[]);class u{constructor(){this.Version=this.Name=null}}Object(h.a)(u,"PluginInfo",null,[]);var v=a(6),x=a(29);class w{static sIi(){if(v.AFrameworkApplication.fa.ra("LogBrowserInfoIsEnabled")){var oa=w.jQh();try{const na=JSON.stringify(oa);
r.ULS.sendTraceTag(6903563,102,50,na)}catch(na){r.ULS.sendTraceTag(6903564,102,15,na.message)}}else r.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static V4h(){const oa=window.navigator.plugins;if(!oa||!oa.length)return null;const na=[];for(let dc=0;dc<oa.length;dc++){const Rc=oa[dc].name,Fd=oa[dc].version;Array.add(na,Object.assign(new u,{Name:Rc,Version:Fd}))}return na}static jQh(){const oa=new l,na=new Sys.StringBuilder;w.Mt(dc=>{oa.DocElemClientHeight=dc},()=>
document.documentElement.clientHeight,na);w.Mt(dc=>{oa.DocElemClientWidth=dc},()=>document.documentElement.clientWidth,na);w.Mt(dc=>{oa.DocElemOffsetHeight=dc},()=>document.documentElement.offsetHeight,na);w.Mt(dc=>{oa.DocElemOffsetWidth=dc},()=>document.documentElement.offsetWidth,na);w.Mt(dc=>{oa.ScreenAvailHeight=dc},()=>window.screen.availHeight,na);w.Mt(dc=>{oa.ScreenAvailWidth=dc},()=>window.screen.availWidth,na);w.Mt(dc=>{oa.ScreenWidth=dc},()=>window.screen.width,na);w.Mt(dc=>{oa.ScreenHeight=
dc},()=>window.screen.height,na);w.Mt(dc=>{oa.ScreenLogicalXdpi=dc},()=>window.screen.logicalXDPI,na);w.Mt(dc=>{oa.ScreenLogicalYdpi=dc},()=>window.screen.logicalYDPI,na);w.Mt(dc=>{oa.ScreenDeviceXdpi=dc},()=>window.screen.deviceXDPI,na);w.Mt(dc=>{oa.ScreenDeviceYdpi=dc},()=>window.screen.deviceYDPI,na);w.Mt(dc=>{oa.WinInnerHeight=dc},()=>window.self.innerHeight,na);w.Mt(dc=>{oa.WinInnerWidth=dc},()=>window.self.innerWidth,na);w.Mt(dc=>{oa.WinOuterHeight=dc},()=>window.self.outerHeight,na);w.Mt(dc=>
{oa.WinOuterWidth=dc},()=>window.self.outerWidth,na);w.Mt(dc=>{oa.WinOrientation=dc},()=>window.self.orientation,na);w.Mt(dc=>{oa.WinDevicePixelRatio=dc},()=>window.self.devicePixelRatio,na);w.Mt(dc=>{oa.SupportsTouch=dc},()=>x.a.KDc,na);w.Mt(dc=>{oa.NavAppName=dc},()=>window.navigator.appName,na);w.Mt(dc=>{oa.NavAppVersion=dc},()=>window.navigator.appVersion,na);w.Mt(dc=>{oa.NavLanguage=dc},()=>window.navigator.browserLanguage||window.navigator.language,na);w.Mt(dc=>{oa.NavUserAgent=dc},()=>window.navigator.userAgent,
na);w.Mt(dc=>{oa.NavPlatform=dc},()=>window.navigator.platform,na);w.Mt(dc=>{oa.NavPlugins=dc},w.V4h,na);w.Mt(dc=>{oa.CalculatedDevicePixelRatio=dc},()=>w.devicePixelRatio,na);oa.Error=na.toString();return oa}static get devicePixelRatio(){const oa=window.devicePixelRatio;return isNaN(oa)?window.screen.deviceXDPI/window.screen.logicalXDPI:oa}static Mt(oa,na,dc){try{const Rc=na();oa(Rc)}catch(Rc){dc.isEmpty()||dc.append(" | "),dc.append(Rc.message||"null")}}}Object(h.a)(w,"BrowserInfoLogger",null,[]);
var m=a(260);class n{get name(){return"Common.App.BrowserInfoLogger"}ki(){}init(){w.sIi()}dispose(){}static main(){m.a.instance.dj(new n)}}Object(h.a)(n,"BrowserInfoLoggerPackage",null,[4,5]);var z=a(83);class y{constructor(oa){this.zJc=oa}alf(oa){if(!this.zJc)return!0;oa=z.a.Gjd(oa);if(!oa)return!1;oa=oa.toLowerCase();for(let na=0;na<this.zJc.length;na++)if(oa.endsWith(this.zJc[na]))return!0;return!1}}Object(h.a)(y,"DomainAllowListManager",null,[]);class A{constructor(oa,na){this.oba=null;this.ZWc=
oa;this.url=na}get l3d(){return z.a.Fea(this.url)}get iu(){return this.ZWc}d0d(){const oa={},na=this.iu;oa.a=this.l3d;oa.b=this.round(na.navigationStart);oa.c=this.round(na.unloadEventStart);oa.d=this.round(na.unloadEventEnd);oa.e=this.round(na.redirectStart);oa.f=this.round(na.redirectEnd);oa.g=this.round(na.fetchStart);oa.h=this.round(na.domainLookupStart);oa.i=this.round(na.domainLookupEnd);oa.j=this.round(na.connectStart);oa.k=this.round(na.connectEnd);oa.l=void 0!==na.secureConnectionStart&&
null!==na.secureConnectionStart?this.round(na.secureConnectionStart):0;oa.m=this.round(na.requestStart);oa.n=this.round(na.responseStart);oa.o=this.round(na.responseEnd);oa.q=this.round(na.domInteractive);oa.r=this.round(na.domContentLoadedEventStart);oa.s=this.round(na.domContentLoadedEventEnd);oa.t=this.round(na.domComplete);oa.u=this.round(na.loadEventStart);oa.v=this.round(na.loadEventEnd);oa.w=this.oba;return oa}round(oa){return Math.round(1E3*oa)/1E3}}Object(h.a)(A,"PerformanceTimingEntry",
null,[]);const F=(oa,na)=>{const dc={};let Rc=null;switch(oa){case 0:Rc="ResourceTiming";oa=na.a;null!=oa&&(dc.Url=oa);oa=na.b;null!=oa&&(dc.InitiatorType=oa);oa=null==na.c?null:na.c.toString();null!=oa&&(dc.RedirectStart=oa);oa=null==na.d?null:na.d.toString();null!=oa&&(dc.RedirectEnd=oa);oa=null==na.e?null:na.e.toString();null!=oa&&(dc.FetchStart=oa);oa=null==na.f?null:na.f.toString();null!=oa&&(dc.DomainLookupStart=oa);oa=null==na.g?null:na.g.toString();null!=oa&&(dc.DomainLookupEnd=oa);oa=null==
na.h?null:na.h.toString();null!=oa&&(dc.ConnectStart=oa);oa=null==na.i?null:na.i.toString();null!=oa&&(dc.ConnectEnd=oa);oa=null==na.j?null:na.j.toString();null!=oa&&(dc.SecureConnectionStart=oa);oa=null==na.k?null:na.k.toString();null!=oa&&(dc.RequestStart=oa);oa=null==na.l?null:na.l.toString();null!=oa&&(dc.ResponseStart=oa);oa=null==na.m?null:na.m.toString();null!=oa&&(dc.ResponseEnd=oa);oa=na.n;null!=oa&&(dc.CustomText=oa);oa=null==na.o?null:na.o.toString();null!=oa&&(dc.DecodedBodySize=oa);oa=
null==na.p?null:na.p.toString();null!=oa&&(dc.EncodedBodySize=oa);na=null==na.q?null:na.q.toString();null!=na&&(dc.TransferSize=na);break;case 1:Rc="PerformanceTiming",oa=na.a,null!=oa&&(dc.Url=oa),oa=null==na.b?null:na.b.toString(),null!=oa&&(dc.NavigationStart=oa),oa=null==na.c?null:na.c.toString(),null!=oa&&(dc.UnloadEventStart=oa),oa=null==na.d?null:na.d.toString(),null!=oa&&(dc.UnloadEventEnd=oa),oa=null==na.e?null:na.e.toString(),null!=oa&&(dc.RedirectStart=oa),oa=null==na.f?null:na.f.toString(),
null!=oa&&(dc.RedirectEnd=oa),oa=null==na.g?null:na.g.toString(),null!=oa&&(dc.FetchStart=oa),oa=null==na.h?null:na.h.toString(),null!=oa&&(dc.DomainLookupStart=oa),oa=null==na.i?null:na.i.toString(),null!=oa&&(dc.DomainLookupEnd=oa),oa=null==na.j?null:na.j.toString(),null!=oa&&(dc.ConnectStart=oa),oa=null==na.k?null:na.k.toString(),null!=oa&&(dc.ConnectEnd=oa),oa=null==na.l?null:na.l.toString(),null!=oa&&(dc.SecureConnectionStart=oa),oa=null==na.m?null:na.m.toString(),null!=oa&&(dc.RequestStart=
oa),oa=null==na.n?null:na.n.toString(),null!=oa&&(dc.ResponseStart=oa),oa=null==na.o?null:na.o.toString(),null!=oa&&(dc.ResponseEnd=oa),oa=null==na.p?null:na.p.toString(),null!=oa&&(dc.DomLoading=oa),oa=null==na.q?null:na.q.toString(),null!=oa&&(dc.DomInteractive=oa),oa=null==na.r?null:na.r.toString(),null!=oa&&(dc.DomContentLoadedEventStart=oa),oa=null==na.s?null:na.s.toString(),null!=oa&&(dc.DomContentLoadedEventEnd=oa),oa=null==na.t?null:na.t.toString(),null!=oa&&(dc.DomComplete=oa),oa=null==na.u?
null:na.u.toString(),null!=oa&&(dc.LoadEventStart=oa),oa=null==na.v?null:na.v.toString(),null!=oa&&(dc.LoadEventEnd=oa),na=na.w,null!=na&&(dc.CustomText=na)}dc.Table=Rc;return Sys.Serialization.JavaScriptSerializer.serialize(dc)};var D=a(56),B=a(224),M=a(330);class R{constructor(oa,na=null,dc=null){this.ah=oa;this.k3d=this;this.oBg=na||(()=>window.location.href);this.vMc=new y(dc)}run(){if(R.eQ(window.performance))try{const Fd=this.oBg();if(R.TJg.exec(Fd)&&this.vMc.alf(Fd)){var oa=new A(window.performance.timing,
Fd);M.a.instance.Jjj(oa.iu.fetchStart);M.a.instance.Kjj(oa.iu.navigationStart);M.a.instance.gGb(D.a.fPh,"connectStart","requestStart");M.a.instance.gGb(D.a.nPh,"requestStart","responseStart");M.a.instance.gGb(D.a.qPh,"responseStart","responseEnd");this.k3d.gf(1,oa.d0d());this.ah.zn(D.a.iwa,oa.iu.fetchStart);this.ah.zn(D.a.kPh,oa.iu.domainLookupStart);this.ah.zn(D.a.jPh,oa.iu.domainLookupEnd);this.ah.zn(D.a.hPh,oa.iu.connectStart);this.ah.zn(D.a.rPh,oa.iu.secureConnectionStart);this.ah.zn(D.a.gPh,
oa.iu.connectEnd);this.ah.zn(D.a.oPh,oa.iu.requestStart);this.ah.zn(D.a.rgd,oa.iu.responseStart);this.ah.zn(D.a.lPh,oa.iu.responseEnd-oa.iu.responseStart);this.ah.zn(D.a.pPh,oa.iu.responseStart-oa.iu.requestStart);var na=0,dc=0,Rc=0;({transferSize:na,Hbd:dc,m$c:Rc}=this.x2j(Fd)).returnValue&&(this.ah.zn(D.a.sPh,na),this.ah.zn(D.a.iPh,Rc),this.ah.zn(D.a.mPh,dc));this.ah.zn(D.a.qgd,oa.iu.navigationStart)}}catch(Fd){r.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",
Fd)}}x2j(oa){let na,dc,Rc;Rc=dc=na=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:na,Hbd:dc,m$c:Rc};oa=window.performance.getEntriesByName(oa,"navigation");if(void 0===oa||null===oa||1!==oa.length)return{returnValue:!1,transferSize:na,Hbd:dc,m$c:Rc};oa=oa[0];var Fd=oa.transferSize;void 0!==na&&null!==na&&(na=Fd);Fd=oa.decodedBodySize;void 0!==Fd&&null!==Fd&&(Rc=Fd);oa=oa.encodedBodySize;void 0!==oa&&null!==oa&&(dc=
oa);return{returnValue:!0,transferSize:na,Hbd:dc,m$c:Rc}}gf(oa,na){r.ULS.sendTraceTag(4551815,306,50,F(oa,na))}static get instance(){return R.Ma||(R.Ma=new R(B.a.instance,null,v.AFrameworkApplication.fa.ra("PerfTimingLoggerFilterDomainsIsEnabled")?v.AFrameworkApplication.fa.Ow("ResourceLoggerDomainAllowList"):null))}static eQ(oa){return!(void 0===oa||null===oa)&&!(void 0===oa.timing||null===oa.timing)}}R.Ma=null;R.TJg=RegExp("^https?://.*","i");Object(h.a)(R,"PerformanceTimingLogger",null,[436]);
var P=a(103),E=a(89);class H{constructor(oa,na){this.oba=null;this.ZWc=oa;this.behavior=na;this.url=this.iu.name}get l3d(){return 2===this.behavior?this.url:z.a.Fea(this.url)}get iu(){return this.ZWc}d0d(){const oa={},na=this.iu;oa.a=this.l3d;oa.b=na.initiatorType;oa.c=this.round(na.redirectStart);oa.d=this.round(na.redirectEnd);oa.e=this.round(na.fetchStart);oa.f=this.round(na.domainLookupStart);oa.g=this.round(na.domainLookupEnd);oa.h=this.round(na.connectStart);oa.i=this.round(na.connectEnd);oa.j=
void 0!==na.secureConnectionStart&&null!==na.secureConnectionStart?this.round(na.secureConnectionStart):0;oa.k=this.round(na.requestStart);oa.l=this.round(na.responseStart);oa.m=this.round(na.responseEnd);oa.o=this.round(H.q6a(na,"decodedBodySize"));oa.p=this.round(H.q6a(na,"encodedBodySize"));oa.q=this.round(H.q6a(na,"transferSize"));oa.n=this.oba;return oa}round(oa){return Math.round(1E3*oa)/1E3}static q6a(oa,na){return oa[na]}}Object(h.a)(H,"ResourceTimingEntry",null,[481]);var G=a(104),N=a(145),
I=a(42),O=a(117),U=a(200);class ca{constructor(oa,na=null,dc=100){this.j7d=oa;this.d_b=na;this.BWa={};this.Wxg=dc}L1j(oa){var na=oa.name.toLowerCase();const dc=z.a.dla(na);this.yvj(dc,na)&&(dc in this.BWa?r.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",dc):(na={},na.fetchstart=oa.fetchStart,na.responseend=oa.responseEnd,na.iscached=this.pBi(oa),na.encodedsize=H.q6a(oa,"encodedBodySize"),na.decodedsize=H.q6a(oa,"decodedBodySize"),this.BWa[dc]=na))}yvj(oa,
na){if(this.j7d)return Array.contains(this.j7d,oa);if(this.d_b)for(oa=z.a.AK(na),na=0;na<this.d_b.length;na++)if(this.d_b[na]&&oa.endsWith(this.d_b[na]))return!0;return!1}pBi(oa){try{const na=H.q6a(oa,"transferSize");if(void 0!==na&&null!==na)return!na;r.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return oa.responseEnd-oa.fetchStart<this.Wxg}catch(na){r.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",
na.message)}return!1}hkj(){if(O.a.Yg(this.BWa))r.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var oa=v.AFrameworkApplication.tF?v.AFrameworkApplication.tF.split(";"):[],na=Object.assign(new U.a,{extendedProperties:N.a.gs()});na.extendedProperties.set("Flights",I.c(oa));this.AIi(na,this.BWa,G.Health.instance)}}phd(oa){let na=0,dc=0,Rc=0,Fd=0;const de=this.BWa;for(let cf in de){var ne=de[cf];cf.endsWith(".js")&&(ne=Object(E.a)(Object,ne),ne.responseend<
oa&&(na+=1,dc+=ne.decodedsize,Fd+=ne.encodedsize,Rc+=ne.iscached?0:ne.encodedsize))}oa={};oa.filesLoaded=na;oa.decodedBytes=dc;oa.transferredBytes=Rc;oa.encodedBytes=Fd;return oa}AIi(oa,na,dc){if(na){var Rc=0,Fd=0,de=0,ne=0,cf=0,Bf=0,Af=0,mg=0,Kf=0,Zf=0,Ug=0;for(let Tg in na){var eg=na[Tg];try{const Cg=Object(E.a)(Object,eg);if(!Cg)continue;const Rf=Cg.iscached?Boolean.parse(Cg.iscached.toString()):!1,Mg=Cg.fetchstart?this.parseFloat(Cg.fetchstart.toString()):0,eh=(Cg.responseend?this.parseFloat(Cg.responseend.toString()):
0)-Mg,fh=Cg.encodedsize?this.parseFloat(Cg.encodedsize.toString()):0,Gg=Cg.decodedsize?this.parseFloat(Cg.decodedsize.toString()):0;Rc+=eh;ne+=fh;Af+=Gg;Zf++;Rf?(de+=eh,Bf+=fh,Kf+=Gg,Ug++):(Fd+=eh,cf+=fh,mg+=Gg)}catch(Cg){r.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Cg.message)}}oa.extendedProperties.set("StaticResources",I.c(na));oa.extendedProperties.set("TotalResourceDownloadLatency",Rc.toString());oa.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",
Fd.toString());oa.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",de.toString());oa.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ne.toString());oa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",cf.toString());oa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Bf.toString());oa.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Af.toString());oa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",mg.toString());
oa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Kf.toString());oa.extendedProperties.set("TotalNumberOfResourcesDownloaded",Zf.toString());oa.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Ug.toString());dc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);dc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",oa)}}parseFloat(oa){if(!oa)return 0;oa=parseFloat(oa);return isNaN(oa)?0:oa}}Object(h.a)(ca,"AppStaticResourceManager",
null,[]);class Q extends Sys.EventArgs{constructor(oa){super();this.entries=oa}}Object(h.a)(Q,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var Y=a(113);class la{constructor(oa,na,dc=null,Rc=null,Fd=100){this.vQc=!1;this.jj=null;this.Ujb=0;this.Za=new P.a;this.GWa=null;this.uT=!1;this.ioe=0;this.de=oa;this.i$d=0;this.k3d=this;this.vMc=new y(dc);this.qv=na;Rc&&(this.GWa=new ca(null,Rc,Fd))}get JAe(){try{return!(void 0===this.qv||null===this.qv)&&!(void 0===this.qv.getEntriesByType||null===this.qv.getEntriesByType)}catch(oa){return r.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",oa),!1}}get eoh(){return this.i$d}get isActive(){return this.uT}get S_d(){return this.ioe}FQg(oa){this.Za.addHandler(la.kcd,oa)}Cpj(oa){this.Za.removeHandler(la.kcd,oa)}ki(oa,na){const dc=this.S_d!==oa;this.ioe=oa;this.isActive&&this.de&&dc&&(this.np(),this.Kf());this.i$d=na}activate(){!this.isActive&&this.JAe&&(this.Kf(),this.uT=!0)}deactivate(oa){this.isActive&&(this.np(),oa&&this.flush(),this.uT=!1)}flush(){if(this.isActive&&
this.JAe)try{var oa=window.performance.getEntriesByType("resource");0<oa.length-this.Ujb&&r.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",oa.length-this.Ujb);const na=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);na&&(window.performance.clearResourceTimings(),this.Ujb=0);const dc=[];for(let Rc=this.Ujb;Rc<oa.length;Rc++)this.vMc.alf(oa[Rc].name)&&(this.GWa&&this.GWa.L1j(oa[Rc]),
dc.push(new H(oa[Rc],this.eoh)));na||(this.Ujb=oa.length);this.Za.raiseEvent(la.kcd,new Q(dc));for(oa=0;oa<dc.length;oa++)0!==dc[oa].behavior&&2!==dc[oa].behavior||this.k3d.gf(0,dc[oa].d0d());0<dc.length&&r.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",dc.length)}catch(na){r.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",na)}}gf(oa,na){r.ULS.sendTraceTag(4310804,306,50,F(oa,na))}Ijj(){this.GWa.hkj()}phd(oa){return this.GWa.phd(oa)}Kf(){this.de&&
0<this.S_d&&(this.jj=new Y.a(3,2,1E3*this.S_d,()=>{this.flush()},5),this.de.Kf(this.jj),this.vQc=!0)}np(){this.vQc&&(this.de.np(this.jj),this.jj=null,this.vQc=!1)}}la.kcd="EntriesAvailable";Object(h.a)(la,"ResourceTimingLogger",null,[420,436]);var ea=a(127);class ha{constructor(){this.ib=null}get name(){return"Common.ResourceTiming"}init(){this.ib.resolve("Common.NetworkTiming.IResourceTimingLogger");R.instance.run()}dispose(){}ki(oa){this.ib=oa;let na=null;if(v.AFrameworkApplication.fa.ra("ResourceLoggerFilterDomainsIsEnabled"))try{na=
v.AFrameworkApplication.fa.Ow("ResourceLoggerDomainAllowList")}catch(Fd){r.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const dc=[];dc.push(z.a.AK(ea.a.CL).toLowerCase());dc.push(z.a.AK(ea.a.Bfb).toLowerCase());const Rc=v.AFrameworkApplication.fa.Dd("AppStaticResourceMonitorCacheThresholdInMs",100);oa.register(420,"Common.NetworkTiming.IResourceTimingLogger").zc().Gc(()=>new la(v.AFrameworkApplication.ji,window.performance,na,dc,Rc))}static main(){m.a.instance.dj(new ha)}}
Object(h.a)(ha,"ResourceTimingPackage",null,[4,5]);var X=a(88);class T extends Sys.EventArgs{constructor(oa,na){super();this.sYj=oa;this.actualValue=na}}Object(h.a)(T,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var ua=a(146);class Ha{constructor(){this.$Wa=[];this.G9d=this.MLc=0;this.lga=null;this.Za=new P.a}init(oa,na,dc){this.lga=oa;this.MLc=na;this.G9d=dc;this.lga.Ute(Object(X.a)(this,this.oWi,"onCpuMeterFrameAvailable"));this.VRg(Object(X.a)(this,this.bfh,"cpuPercentThresholdExceeded"))}oWi(oa,
na){na.FAf&&(Array.enqueue(this.$Wa,na.FAf.CP),this.$Wa.length>this.G9d&&(Array.dequeue(this.$Wa),this.R7g()))}R7g(){var oa=this.$Wa.length;let na=0;for(let dc=0;dc<oa;dc++){const Rc=Array.dequeue(this.$Wa);na+=Rc;Array.enqueue(this.$Wa,Rc)}oa=na/oa;oa>this.MLc&&this.Za.raiseEvent("CPTTE",new T(this.MLc,oa))}bfh(oa,na){ua.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.dhh(na.sYj,na.actualValue))}VRg(oa){this.Za.addHandler("CPTTE",oa)}dhh(oa,na){const dc={};dc.ThresholdValue=
oa;dc.ActualValue=na;return dc}}Object(h.a)(Ha,"CpuMeterMonitor",null,[485]);var Ca=a(170);class Ga{constructor(){this.S=this.T=this.M=this.C=0}}Object(h.a)(Ga,"ProfileInformation",null,[]);var sa=a(16),bb=a(50),Ba=a(278);class qa{constructor(oa=0,na=0){this.UOc=!1;this.pFa={};this.qXb=oa;this.zXb=na;this.lXc=0;bb.a.addHandler(window.self,sa.a.tUg,()=>{this.UOc=!0});bb.a.addHandler(window.self,sa.a.uUg,()=>{this.UOc=!1})}ove(oa,na,dc){const Rc=qa.generateKey(na,dc);Rc in this.pFa?na=this.pFa[Rc]:
(na=new Ga,na.S=dc?1:0,this.pFa[Rc]=na,this.lXc++);na.C++;na.M=oa>na.M?oa:na.M;na.T+=oa}caa(oa,na){this.ove(oa,na,!1);this.UOc&&this.ove(oa,na,!0)}getData(){if(0<this.zXb&&this.lXc>this.zXb)return this.tXh();const oa=0<this.qXb,na={},dc=this.pFa;for(let Fd in dc){var Rc=Fd;const de=dc[Fd];this.D3f(de);oa&&de.T>=this.qXb&&(na[Rc]=de)}return oa?O.a.Yg(na)?null:na:this.pFa}tXh(){var oa=0<this.qXb,na=[];const dc=this.pFa;for(let Rc in dc){const Fd={key:Rc,value:dc[Rc]};let de=Fd.value;(!oa||de.T>=this.qXb)&&
Array.add(na,Fd)}if(na.length>this.zXb)na.sort((Rc,Fd)=>Fd.value.T-Rc.value.T),na=na.slice(0,this.zXb);else if(!na.length)return null;oa={};for(const Rc of na)na=Rc.value,this.D3f(na),oa[Rc.key]=na;return oa}D3f(oa){oa.M=Ba.a.q8(oa.M,0);oa.T=Ba.a.q8(oa.T,0)}reset(){this.pFa={};this.lXc=0}static generateKey(oa,na){return na?oa+" [it]":oa}}Object(h.a)(qa,"FunctionCallAggregator",null,[434]);class pa{}pa.JZg="BatchedOperation";pa.replication="Replication";pa.b3j="25";pa.Fsj="9_"+pa.JZg+"_"+pa.replication;
Object(h.a)(pa,"CpuMeterConstants",null,[]);class ya{}Object(h.a)(ya,"CpuMeterFrame",null,[]);class za extends Sys.EventArgs{constructor(oa){super();this.FAf=oa}}Object(h.a)(za,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class cb{}Object(h.a)(cb,"MiniTaskItemInfo",null,[]);class Pa{}Object(h.a)(Pa,"TaskItemInfo",null,[]);var nb=a(561),Ma=a(105);class Oa{static jbi(){if(!Oa.DTb&&(Oa.DTb=new Ma.a,v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.Sp("AggregatorIdDisabledList"))){const oa=
v.AFrameworkApplication.fa.Ow("AggregatorIdDisabledList");for(let na=0;na<oa.length;na++)Oa.DTb.ia(oa[na],!0)}return Oa.DTb}}Oa.DTb=null;Object(h.a)(Oa,"DisabledAggregatorListStore",null,[]);var La=a(280);class ra{constructor(oa,na,dc,Rc,Fd,de=!0,ne=null){this.mY=this.yne=this.Jee=!1;this.de=null;if(!oa)throw La.a.argument("taskManagerLazy");if(!Fd)throw La.a.argument("dataAggregator");this.eJg=oa;this.QSc=na;this._id=dc;this.bde=6E4*Rc;this.QUb=Fd;this.Jke=de;this.Knb=ne;Oa.jbi().nb(this._id.toString())&&
(this.mY=!0)}get taskManager(){return this.de||(this.de=this.eJg.value)}track(oa,na=null){this.mY||(this.Exh(),this.ezj(),this.QUb.caa(oa,na))}ezj(){!this.Jee&&0<this.bde&&(this.Jee=!0,this.q5f())}q5f(){const oa=new Y.a(5,1,this.bde,()=>{this.gBj()},19,this._id.toString());this.taskManager.Kf(oa)}gBj(){!this.Knb||this.Knb.SKj()?this.x6f():this.Jke&&this.QUb.reset();this.q5f()}x6f(){const oa=this.QUb.getData();if(oa){const na=parseInt(String(oa.length));if(isNaN(na)||0<na)this.Hzc(oa),this.Jke&&this.QUb.reset()}}Hzc(oa){r.ULS.sendTraceTag(7079840,
335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:oa})}Exh(){this.yne||(this.QSc(()=>{this.x6f()}),this.yne=!0)}static XM(oa,na,dc,Rc,Fd){return new ra(new nb.a(()=>v.AFrameworkApplication.ji),v.AFrameworkApplication.Fgb,oa,na,dc,Rc,Fd)}static B5a(oa,na,dc){return ra.XM(oa,na,dc,!0,null)}}Object(h.a)(ra,"Aggregator",null,[483]);class V{constructor(oa=null){this.wn=null;this.reset();this.Knb=oa}caa(oa,na){if(!this.Knb||this.Knb.SKj())na in this.wn||(this.wn[na]=[]),this.wn[na].push(oa)}getData(){return O.a.count(this.wn)?
this.wn:null}reset(){this.wn={}}}Object(h.a)(V,"NamedValuesAggregator",null,[434]);var ma=a(232);class W{constructor(oa,na,dc,Rc,Fd){this.QGa=0;this.AE=null;this.nZb=this.hne=0;this.wle=!1;this.AXa=0;this.Glb=!1;this.ssa=null;this.tWb=0;this.rie=new P.a;this.cJg=[];this.UL=oa;this.MRc=na;this.JNc=dc;this.Bge=Rc;v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ra("WrapSetTimeoutForTelemetryIsEnabled")&&this.Qwd();this.xAg=Fd;this.KNc=new qa(100);this.tEg=ra.B5a(1,5,new V)}Ute(oa){this.rie.addHandler("OnCpuMeterFrameAvailable",
oa)}Jcb(oa,na,dc,Rc=null){dc=Rc?Rc.priority:7;const Fd=this.UL();this.start(na,dc);try{oa()}finally{this.stop(na,Rc),oa=this.UL()-Fd,this.Bge.track(oa,na)}}WW(oa,na){const dc=this.UL();try{oa()}finally{oa=this.UL()-dc,this.JNc.caa(oa,na),0<this.QGa&&this.KNc.caa(oa,na),this.Bge.track(oa,na)}}RGd(oa){const na=new Pa;na.TN=oa.poc;na.TP=oa.priority;this.ZUf(1,na)}W$a(oa){this.tWb|=oa}start(oa,na){if(!this.QGa){this.KNc.reset();const dc=this.Dqf(oa);dc&&this.TAd(1);this.AE=new Pa;this.AE.TN=oa;this.AE.TP=
na;this.AE.ST=(new Date).toISOString();this.AE.STS=Ba.a.q8(this.UL(),2);dc?this.AE.UI=1:this.Mwi(oa)?this.AE.UI=2:this.AE.UI=0}this.QGa++}TAd(oa){this.AXa|=oa}V4c(oa=!0,na=0){this.AXa=oa?0:this.AXa&~na}stop(oa,na=null){let dc;this.QGa--;0>=this.QGa&&this.AE&&(dc=this.UL()-this.AE.STS,this.nZb+=dc,this.MRc.caa(dc,oa),this.Dqf(oa)&&this.V4c(!1,1),this.AE.TRT=Ba.a.q8(dc,2),na&&(this.AE.TQT=Ba.a.q8(na.dgj,2),this.AE.TDT=Ba.a.q8(na.Wrf,2)),this.xAg&&(this.ZUf(0,this.AE),this.otj()),this.QGa=0);0<=oa.indexOf(pa.b3j)&&
this.W$a(2);0<=oa.indexOf(pa.Fsj)&&this.W$a(4);1===(this.AXa&1)&&this.W$a(1);2===(this.AXa&2)&&this.W$a(8)}otj(){var oa=this.AE.TRT;if(750<oa){let dc=this.KNc.getData();if(dc){const Rc={};for(let Fd in dc){var na=dc[Fd];const de=Fd;de.startsWith("SiOp_")||de.endsWith("[it]")||(Rc[de]=Math.round(100*na.T/oa))}dc=Rc}oa=Object.assign(new cb,{B:this.AE.STS,T:oa,S:dc});this.tEg.track(oa,this.AE.TN)}}ASj(){var oa=this.UL()-this.hne,na=Ba.a.q8(this.nZb/oa*100,2);oa=new ya;oa.CP=na;oa.II=this.tWb;na=this.MRc.getData();
O.a.count(na)&&(oa.LRT=na);na=this.JNc.getData();O.a.count(na)&&(oa.FP=na);this.rie.raiseEvent("OnCpuMeterFrameAvailable",new za(oa));this.Teg()}Teg(){this.MRc.reset();this.JNc.reset();this.nZb=this.QGa=0;this.hne=this.UL();this.tWb=0;this.AE=null}run(){this.wle?this.ASj():(this.Teg(),this.wle=!0);this.ssa?this.ssa(Object(X.a)(this,this.run,"run"),1E3):window.setTimeout(Object(X.a)(this,this.run,"run"),1E3)}ZUf(oa,na){oa=this.cJg[oa];if(!ma.a.Yg(oa))for(let Rc=0;Rc<oa.length;Rc++){var dc=oa[Rc];const Fd=
dc[0];dc=dc[1];Fd&&!Fd(na)||dc(na)}}Qwd(){if(!this.Glb){const oa=window.setTimeout;this.ssa=(na,dc)=>oa(na,dc);this.Glb=!0}}Dqf(oa){return oa.startsWith("key")||oa.startsWith("input")}Mwi(oa){return oa.startsWith("click")||oa.startsWith("mouse")||oa.startsWith("pointer")}}Object(h.a)(W,"CpuMeter",null,[50]);class aa{constructor(oa){this.Tjb=null;this.Uk=new Ca.a;this.UL=oa}initialize(oa,na,dc,Rc=!1){this.Tjb||(this.Tjb=new W(this.UL,oa,na,dc,Rc),this.Uk.setResult(this.Tjb));return this.Tjb}}Object(h.a)(aa,
"CpuMeterProvider",null,[484]);class ia{constructor(oa=1){this.Qx=[];this.YUb=[];this._count=oa}gMh(){let oa=0;for(let na=0;na<this.Qx.length;na++)this.Qx[na]<this.Qx[oa]&&(oa=na);return oa}caa(oa,na){oa=Ba.a.q8(oa,2);if(this.Qx.length<this._count)Array.add(this.Qx,oa),Array.add(this.YUb,na);else{var dc=this.gMh();oa>this.Qx[dc]&&(this.Qx[dc]=oa,this.YUb[dc]=na)}}getData(){return this.Qx.length?{["Vals"]:this.Qx,["Desc"]:this.YUb}:null}reset(){this.Qx=[];this.YUb=[]}}Object(h.a)(ia,"MaxDataAggregator",
null,[434]);var ka=a(43),Xa=a(84);class sb{get name(){return"Common.App.CpuMeter"}ki(oa){oa.register(aa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").zc().Gc(()=>new aa(ka.a.ee));oa.register(Ha,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").zc().Gc(()=>new Ha)}init(){const oa=v.AFrameworkApplication.fa;if(oa.ra("CpuMeterIsEnabled")){const na=Xa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");M.a.instance.mwe.continueWith(()=>{sb.jmi(oa,
na)})}}dispose(){}static jmi(oa,na){const dc=ra.B5a(10,5,new qa(oa.Dd("TaskManagerLoggingThreshold",0),oa.Dd("CpuMeterMaximumEntriesToLog",0)));na=na.initialize(new ia(5),new qa,dc,oa.ra("CPUMeterExposeTaskDetailsIsEnabled"));oa.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfDisableCpuMeterFrames",!1)||(na.run(),oa.ra("CpuMeterMonitorIsEnabled")&&Xa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(na,oa.Awa("CpuMeterAverageCpuPercentThreshold",80),oa.Dd("CpuMeterRollingAverageFramesCount",
15)));ua.a(16827671,306,50,"Initializing CpuMeter")}static main(){m.a.instance.dj(new sb)}}Object(h.a)(sb,"CpuMeterPackage",null,[4,5]);var ib=a(978);class Ub{get name(){return"Common.App.EventsCachePackage"}ki(){}init(){ib.a.instance.init()}dispose(){}static main(){m.a.instance.dj(new Ub)}}Object(h.a)(Ub,"EventsCachePackage",null,[4,5]);var hc=a(10),yb=a(228),Gb=a(879),Sa=a(175),db=a(382),fb=a(210),ab=a(162),wb=a(61),kb=a(98),tb=a(1),hb=a(23),Fb=a(173),va=a(750);class jb extends Gb.a{constructor(oa,
na,dc){super(na,dc);this.Qa=new P.a;this.Fii=Rc=>{if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Fd=Rc.Values.m_Origin;v.AFrameworkApplication.wopiHostOriginFromPostMessage||(v.AFrameworkApplication.wopiHostOriginFromPostMessage=Fd)}switch(Rc.MessageId){case Sa.a.Vod:Fb.a(this.$).Scf(Rc);break;case Sa.a.zyd:ab.a.ltas(null);break;case Sa.a.Jhc:this.E_i();break;case Sa.a.Zod:this.D_i(Rc)}};this.$=oa;dc!==va.a.SJ&&this.QP(dc);this.xni();this.Gmi();oa=this.Fii;this.Lk(Sa.a.Vod,
oa);this.Lk(Sa.a.zyd,oa);this.Lk(Sa.a.Jhc,oa);this.Lk(Sa.a.Zod,oa)}dispose(){this.$=null;super.dispose()}xni(){this.Am(Sa.a.uCe);this.Am(Sa.a.Vod);this.Am(Sa.a.Jhc);this.Am(Sa.a.Zod);this.p_a(Sa.a.zyd);this.Am(Sa.a.Yod)}Gmi(){this.o3(Sa.a.Uob);this.o3(Sa.a.JZ);this.o3("App_CloseTab");this.o3(Sa.a.dWa);this.o3(Sa.a.eWa);this.o3(Sa.a.Tff);this.o3(Sa.a.Ghc)}E_i(){const oa={};oa.hostMessageReceived=(new Date).getTime();r.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");v.AFrameworkApplication.Zlc=
!0;oa.appUnloadStart=(new Date).getTime();oa.sendBeaconFlight=v.AFrameworkApplication.fa.ra("SendBeaconOnShuttingDownRequestsEnabled");oa.sendBeaconSupported=wb.a.efa();wb.a.vwe();oa.appUnloadEnd=(new Date).getTime();oa.appMessageSent=(new Date).getTime();this.hi(Sa.a.NVg,oa)}D_i(oa){r.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");oa.Values&&db.a.PCd in oa.Values&&hb.a.equals(oa.Values[db.a.PCd],fb.a.edit,!0)&&!this.$.isEditMode&&(r.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${oa.Values[db.a.PCd]}`),
oa=new kb.a(-8805455,0,1,0,null),this.$.Ia.Nb(oa))}}Object(h.a)(jb,"EwaHostMessenger",Gb.a,[431,186,2]);class Ab extends yb.a{constructor(oa){super();this.OHe=!1;this.$=oa;this.Mb()}create(){const oa=this.$.da,na=Xa.a.instance;if(!this.OHe){this.OHe=!0;let dc;dc=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.xa.DocumentHostInfo.PostMessageOrigin||va.a.SJ:v.AFrameworkApplication.gJd||va.a.SJ;na.register(jb,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").zc().Gc(()=>
new jb(this.$,window.parent,dc,v.AFrameworkApplication.fa.ra("HostSendReadyToAcceptPostMessage")))}this.vb(oa.Aa(21)||oa.Ha(21,na.resolve("Postmessage.IHostPostmessenger")))}}Object(h.a)(Ab,"HostMessengerFactory",yb.a,[]);var Qa=a(116),Z=a(148),wa=a(708),Ea=a(562),fa=a(86),Ua=a(134),Aa=a(47),Ib=a(248),Pb=a(361),Fa=a(364),da=a(502),K=a(7),xa=a(55),rb=a(80);class Qb{constructor(oa,na,dc){this.correlations=this.properties=this.operation=null;this.operation=oa;this.properties=na;this.correlations=dc}static CJh(oa,
na,dc){const Rc={},Fd=xa.b();switch(oa.command){case -1537138325:Rc.Action=na.LabelText;break;case -1104934572:Rc.PrevTab=Fd.Sj(parseInt(na.OldContextCommand,10));Rc.NextTab=Fd.Sj(parseInt(na.NewContextCommand,10));break;case 802602464:Rc.Origin=na[K.a.AH];break;case -1027730316:case -1059615499:Rc.MenuType=na.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in na&&(Rc.SqmControlId=na.SqmControlId);break;case 1371713064:case 875133075:rb.a.Uc in
na&&(Rc.SampleTableId=na[rb.a.Uc])}Rc.InputMethod=Pb.a[oa.method];Rc.Location=Fa.a[oa.af];Rc.Mode=da.a[oa.mode];Rc.ParentName=oa.tabName;Rc.IsSystemInitiated="IsSystemInitiated"in na?na.IsSystemInitiated:!1;Rc.NoReporting="NoReporting"in na?na.NoReporting:!1;"ControlIdToLog"in na&&(Rc.ControlId=na.ControlIdToLog);"TerminalParentControlIdToLog"in na&&(Rc.TerminalParentControlId=na.TerminalParentControlIdToLog);for(const de of Object.keys(dc))Rc[de]=dc[de];return Rc}}Object(h.a)(Qb,"InteractivityRecord",
null,[]);class pc extends Qb{constructor(oa,na,dc){super(oa.operation,oa.properties,oa.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=na;this.timeFromNavigationStart=dc}}Object(h.a)(pc,"FirstUserInteractivityRecord",Qb,[]);var Lb=a(659);class qb{constructor(){this.commandSurface=this.triggerMethod=Qa.a.Khb}static ymi(){qb.W4a||(qb.W4a=new Lb.a(Ea.a.$h()),qb.W4a.add("InputMethod"),qb.W4a.add("Location"),qb.W4a.add("Mode"))}}qb.W4a=null;Object(h.a)(qb,
"ExcelUserAction",null,[]);var bc=a(220),sc=a(46),Tb=a(438),$a=a(149),Nb=a(157),Ra=a(41);class ob extends fa.a{constructor(oa){super();this.Fif=0;this.f0e=!1;this.kxd=Array(ob.Z$a);this.D8b=0;this.$=oa;this.eqf=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");Qa.a.n4h();this.Ica={};ob.r0b||(ob.r0b=new wa.a(Ea.a.$h()),ob.Ili(ob.r0b));qb.ymi();if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(oa=0;oa<ob.Z$a;oa++)this.kxd[oa]=
"NA"}dispose(){this.$=this.Ica=null;super.dispose()}E0f(oa,na,dc){const Rc=xa.b().Sj(oa.command),Fd=JSON.stringify(oa);Rc||r.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${Rc}, command: ${oa.command}, commandInfo: ${Fd}`);na=Qb.CJh(oa,na,dc);dc=!!na&&(!("IsSystemInitiated"in na)||!na.IsSystemInitiated);this.$&&this.$.ea.Bf&&dc&&ib.a.instance.EWf("OtelUserAction",new Tb.a(Rc,oa.tabName,Date.now()));this.U0f(Rc,na,null,!0,!0)}rd(oa,
na,dc=null,Rc=!1){this.U0f(oa,na,dc,!1,Rc)}XCc(oa){if(this.Ica){++this.Fif;this.Ica[oa]||(this.Ica[oa]=[]);var na=this.Fif.toString();this.Ica[oa].push(na);r.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${oa}', correlation=${na}`)}else r.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${oa}] == null`)}jDc(oa){if(this.Ica&&this.Ica[oa]){var na=this.Ica[oa],dc=na.pop().toString();na.length||delete this.Ica[oa];
r.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${oa}', correlation=${dc}`)}else r.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${oa}] == null`)}vQ(oa,na,dc=!1){return Ib.b(Rc=>{this.rd(oa,Rc(),void 0,dc)},ob.uYj,this.ka,Aa.a.upi,!1,!na)}qPd(){let oa="";for(let na=0;na<ob.Z$a;na++)oa+=this.kxd[(this.D8b+ob.Z$a-na-1)%ob.Z$a]+",";r.ULS.sendTraceTag(557188890,0,15,`Last operations ${oa}`)}m7j(oa){oa&&
(this.kxd[this.D8b]=oa,this.D8b=(this.D8b+1)%ob.Z$a)}xIi(oa,na,dc){v.AFrameworkApplication.sac();const Rc=oa.operation,Fd=oa.properties;void 0!==dc?void Nb.a.resolve(Ra.Q,{rb:0}).then(de=>{de.jkj(Rc,Fd,dc)}):this.l3j(oa);this.m3j(oa);this.h8i(na,Fd,Rc)}l3j(oa){this.ARj(oa)||(this.f0e=!0,oa=new pc(oa,sc.PageLoadTrackingInfo.instance.Ywa(new Date),sc.PageLoadTrackingInfo.Nt()),oa=Sys.Serialization.JavaScriptSerializer.serialize(oa),r.ULS.sendTraceTag(458261331,0,50,`${oa}`))}ARj(oa){const na=oa.properties;
oa=oa.operation;return this.f0e||void 0===oa||null===oa||oa===Ua.a.yYc||oa===Ua.a.uSd||oa===Ua.a.GJd||wb.a.xud(oa)||!!na&&"IsSystemInitiated"in na&&na.IsSystemInitiated}m3j(oa){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.m7j(oa.operation);oa=Sys.Serialization.JavaScriptSerializer.serialize(oa);r.ULS.sendTraceTag(21542793,0,50,`${oa}`)}h8i(oa,na,dc){Qa.a.Cma()&&(na?"NoReporting"in na&&na.NoReporting||"IsSystemInitiated"in na&&na.IsSystemInitiated||!oa&&
!this.eqf||((oa=Qa.a.mi(na,ob.r0b,qb.W4a))?(na=ob.LJh(na))?Z.a.sendUserActionEvent(Qa.a.k8b(dc,null,na.triggerMethod,na.commandSurface,oa)):r.ULS.sendTraceTag(537155550,0,50,"user action was null"):r.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):r.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${dc}`))}U0f(oa,na,dc,Rc,Fd){const de=bc.a(this.$);if(this.eqf){let cf=null;hb.a.equals(oa,Ua.a.vzc,!0)&&na&&"InputMethod"in
na&&(cf=Ua.a.j1e(oa,na.InputMethod));de.iMb(cf||oa,dc)}else hb.a.equals(oa,Ua.a.vzc,!0)&&na&&"InputMethod"in na&&(oa=Ua.a.j1e(oa,na.InputMethod)),de.iMb(oa,dc);na&&(na.IsCommand=Rc);let ne="ActionRelativeTime"in na?na.ActionRelativeTime:sc.PageLoadTrackingInfo.Nt();Object($a.c)(()=>{const cf=new Qb(oa,na,this.Ica);this.xIi(cf,Fd,ne)},this.$.ka,50)}static LJh(oa){if(!oa)return null;const na=new qb;"InputMethod"in oa&&(na.triggerMethod=oa.InputMethod);"Location"in oa&&(na.commandSurface=oa.Location);
return na}static Ili(oa){oa?(oa.add("Origin",2),oa.add("InputMethod",2),oa.add("ButtonType",2),oa.add("selectedRange",2),oa.add("SelectedRanges",2),oa.add("editRange",2),oa.add("Location",2),oa.add("Mode",2),oa.add("CurrentSelectionMode",2),oa.add("Action",2),oa.add("type",2),oa.add("floatingObjectType",2),oa.add("PrevTab",2),oa.add("NextTab",2),oa.add("DialogName",2),oa.add("dx",3),oa.add("dy",3),oa.add("NumberOfSelectedRanges",3),oa.add("IsCommand",1),oa.add("IsInFormulaBarEdit",1),oa.add("isLink",
1),oa.add("isSheetRef",1),oa.add("isEmptyText",1),oa.add("isFormula",1),oa.add("IsResizingHiddenHeader",1)):r.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}ob.uYj=1E3;ob.Z$a=40;ob.r0b=null;Object(h.a)(ob,"InteractivityLogger",fa.a,[13]);var mb=a(159),gb=a(2);class lb{constructor(){this.appInfoProperties=this.appState=null}}Object(h.a)(lb,"CurrentAppInfo",null,[]);const Xb=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])},{name:"headers",actions:new Set(["header_resize_start","header_resize_autofit"])}].forEach(oa=>{oa.actions.forEach(na=>{Xb.set(na,oa.name)})});class Xd{constructor(){this.value=this.key=null}}Object(h.a)(Xd,"AppInfoProperty",null,[]);class Qd{constructor(oa){this.$=oa}getAppState(){const oa=sc.PageLoadTrackingInfo.instance.Ywa(new Date);
return-1===oa?"boot":3E4>oa?"postboot":"steady"}isChangeGateEnabled(oa){return tb.EwaSettings.isChangeGateEnabled(oa)}getBooleanFeatureGate(oa,na){return tb.EwaSettings.getBooleanFeatureGate(oa,na)}getCurrentAppInfo(){return Object(gb.a)(new lb,{appState:this.getAppState(),appInfoProperties:[Object(gb.a)(new Xd,{key:"coauthCount",value:this.$.ea.No.length.toString()})]})}sendBeaconTraceTag(oa,na,dc,Rc){this.$.sendBeaconTraceTag(oa,na,dc,Rc)}getActionBucket(oa){return c(oa)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.uNi}`}}
Object(h.a)(Qd,"InteractivityTrackerCallbacks",null,[410]);class te{constructor(){this.events=null;this.durationThresholdInMs=0;this.periodicReport=this.patchTaskScheduling=this.callbacks=null}}Object(h.a)(te,"InteractivityTrackerOptions",null,[]);var Pc=a(53),Ne=a(109);const Hb=(oa,na)=>Object(mb.a)(void 0,void 0,void 0,function*(){var dc;return tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")?Nb.a.resolve(Ra.r,na).then(Rc=>Rc("interactivity")):Object(Ne.e)(Pc.GetServiceTaskFactory.Sa(oa.da,
283,284,null!==(dc=null===na||void 0===na?void 0:na.rb)&&void 0!==dc?dc:0)).then(Rc=>Rc.ol.loadScript("interactivity"))});Object(Nb.b)(Ra.H,{oI:"singleton"})(oa=>Object(mb.a)(void 0,void 0,void 0,function*(){const na=yield Nb.a.resolve(Ra.u,oa);yield Hb(na,oa);const dc=interactivity.InteractivityTrackerFactoryGlobal.create();return new pb(na,dc)}));class pb{constructor(oa,na=null){this.y_=na;pb.Kmf?r.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):
(this.initialize(oa),pb.Kmf=!0)}initialize(oa){r.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||(this.y_=interactivity.InteractivityTrackerFactoryGlobal.create());if(this.y_){var na=new te;tb.EwaSettings.Wvd()&&pb.GDc.push(sa.a.waa);tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7457630_addSupportedEventMouseUpAndTouchStart")&&(pb.GDc.push("mouseup"),
pb.GDc.push("touchstart"));na.events=pb.GDc;na.durationThresholdInMs=pb.durationThresholdInMs;na.callbacks=new Qd(oa);na.patchTaskScheduling=tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);oa=tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReport",!1);const dc=tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReportPassiveTest",!1),Rc=tb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PeriodicReportIntervalMs",
6E4);if(oa||dc)na.periodicReport={isPassiveTestEnabled:dc,intervalMs:Rc};na=this.y_.start(na);na.started?r.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):r.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+na.failureReason)}else r.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}jDa(oa,na,dc){if(this.y_)return this.y_.track(oa,na,dc);r.ULS.sendTraceTag(524326924,
0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${na}`)}RLe(){return this.y_?this.y_.createActionsRetriever():(r.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.y_&&(this.y_.stop(),this.y_=null)}addContext(oa,na,dc){this.y_?this.y_.addContext(oa,na,dc):r.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}}
pb.durationThresholdInMs=100;pb.GDc="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");pb.Kmf=!1;Object(h.a)(pb,"InteractivityTrackerService",null,[397]);var mc=a(39),Kc=a(721);class Nc extends yb.a{constructor(oa){super();this.$=oa;this.Mb()}create(){if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker"))if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService"))void Nb.a.resolve(Ra.r,{rb:this.Na}).then(na=>
na("interactivity")).then(()=>{Object(Kc.a)(this.$.da,443,()=>new pb(this.$))});else{var oa=Pc.GetServiceTaskFactory.Sa(this.$.da,283,284,this.Na);mc.TaskExtensions.za(oa,()=>{mc.TaskExtensions.za(Ne.d(oa.result.ol.loadScript("interactivity")),()=>{this.vb(Object(Kc.a)(this.$.da,443,()=>new pb(this.$)))},this.$.ka,3)},this.$.ka,3)}else this.vb(Object(Kc.a)(this.$.da,443,()=>new pb(this.$)))}static la(oa){oa.da.Ha(444,new Nc(oa))}}Object(h.a)(Nc,"InteractivityTrackerServiceFactory",yb.a,[]);var pd=
a(92),Vd=a(392),$d=a(9),ue=a(51),he=a(59);class Ge{constructor(oa){this.gSj=oa}getCustomProperties(oa){const na=new Map;if(oa.hasOwnProperty("startTimeInMs")&&oa.hasOwnProperty("totalExecutionTimeInMs")){const dc=oa.startTimeInMs;oa=this.gSj.retrieveSlowActionsBetweenTimeRange(dc,dc+oa.totalExecutionTimeInMs);na.set("actions",he.a.Fc(oa))}return na}}Object(h.a)(Ge,"CallTreeCustomPropertiesRetriever",null,[418]);class Ad{constructor(){this.customProperties=new Map}addCustomProperty(oa,na){this.customProperties.set(oa,
na)}getCustomProperties(){return this.customProperties}}Object(h.a)(Ad,"CustomPropertiesRetriever",null,[416]);class Ie{isFeatureEnabled(oa,na){return tb.EwaSettings.getBooleanFeatureGate(oa,na)}}Object(h.a)(Ie,"ExcelFeatureChecker",null,[415]);class me{isProfilingEnabled(){return!0}}Object(h.a)(me,"ExcelProfilingFeatureChecker",null,[414]);class cc{constructor(oa,na){this.m5i=oa;this.o5i=na}onProfilerEvent(oa){switch(oa.eventId){case 1:this.m5i(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));
break;case 0:this.o5i();break;default:r.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${oa.eventId}`)}}}Object(h.a)(cc,"JSCPUProfilerObserver",null,[412]);class $c{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}}Object(h.a)($c,"JSCPUProfilerInitOptions",null,[]);class rd{constructor(){this.shouldRecordFrameCounts=this.shouldMakeSerializedCallTreesFullyReconstructible=
this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=
this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}}Object(h.a)(rd,"JSCPUProfilingPackageInitOptions",
null,[]);class Nd{filter(oa){var na,dc;const Rc=!sc.PageLoadTrackingInfo.instance.TTSI||(null===(na=oa.serializedFrames[0])||void 0===na?void 0:na.startTimeInMs)<sc.PageLoadTrackingInfo.instance.Y2j;na=(null===(dc=oa.propertyBag)||void 0===dc?void 0:dc.actions)&&"[]"!==oa.propertyBag.actions;return Rc||na}}Object(h.a)(Nd,"CallTreeCustomFilterer",null,[411]);let ed=class{constructor(oa,na){this.interactivityTrackerService=this.$eg=this.EKd=this.Kcb=this.FKd=this.sTf=this.uTf=null;this.Nej=new Set([1,
0]);r.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=oa;this.interactivityTrackerService=na;this.tni();this.sni();this.fDi=tb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingSampleIntervalInMs",16);this.profilingIntervalInMs=tb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.JIe=tb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.E8i=
tb.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.qUj()}dispose(){r.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");pd.a.Ja(this.$eg);this.EKd=this.$=null;this.FKd.clear();this.Kcb.clear()}GTj(){const oa=Math.random()*this.JIe;r.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${oa}`);this.$eg=ue.a.instance.create(()=>{this.D8e("ExcelOnlineContinuousSessionProfiler",2).start()},oa,Aa.a.fKj,!0)}TTj(){r.ULS.sendTraceTag(537155525,
0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.D8e("ExcelOnlineFullSessionProfiler",3).start()}tTf(oa){return this.Kcb.has(oa)}qUj(){tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.TTj():this.GTj()}createProfiler(oa,na,dc,Rc,Fd,de){r.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");const ne=new $c;ne.samplingIntervalInMs=na;ne.maximumNumberOfSamplesToTake=dc;ne.idleIntervalInMs=
Rc;ne.profilingIntervalInMs=Fd;return this.ekh(oa,de,ne)}sni(){const oa=new me,na=new rd;na.ulsInstance=new Vd.a;na.deObfuscationEndpoint="ProfilerReporting.ashx";na.shouldCompressSerializedCallTrees=!1;na.shouldKeepSamplesOutsideOfProfilingInterval=!1;na.shouldSendAllCallTreesFromProfileInASingleRequest=!tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);na.shouldUseSendBeaconForSendingCallTrees=tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",
!1);na.callTreeFilteringThresholdInMs=tb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);na.frameTotalExecutionTimeFilteringThresholdInMs=tb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerFrameTotalExecutionTimeFilteringThresholdInMs",0);na.deObfuscationRequestQueryParamsRetriever=this.Wgh();na.deObfuscationRequestBodyPropertiesRetriever=this.Vgh();na.featureEnabledChecker=new Ie;na.useMainEventLoopForProfilerTraceProcessing=!1;na.profilerTraceProcessingWebWorkerSourceURL=
this.$.xa.JSProfilerProcessingWebWorkerJsScriptUrl;na.shouldProcessProfileCapturedWhileUserIsIdle=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldRecordProfilerFrameCounts",!1)&&(na.shouldRecordFrameCounts=!0);this.EKd=this.uTf.retrievePackage(oa,na).retrieveProfilerFactory()}Wgh(){const oa=new Ad;oa.addCustomProperty($d.a.aUf,v.AFrameworkApplication.userType);oa.addCustomProperty(v.AFrameworkApplication.TVa,
v.AFrameworkApplication.userSessionId);oa.addCustomProperty($d.a.ZCd,this.$.xa.SkipAuthentication?$d.a.VAf:null);oa.addCustomProperty($d.a.$Kd,this.$.xa.MachineCluster);return oa}Vgh(){const oa=new Ad;oa.addCustomProperty("appName","Excel");oa.addCustomProperty("buildVersion",v.AFrameworkApplication.buildVersion);oa.addCustomProperty("shouldUseSourceMaps","true");oa.addCustomProperty("shouldFilterSensitiveResources","true");oa.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","false");
return oa}ekh(oa,na,dc){const Rc=new Ad;Rc.addCustomProperty("ProfilerName",oa);this.sTf.set(oa,Rc);na=this.EKd.createProfiler(na,dc,Rc);this.Kcb.set(oa,na);oa=this.sih(oa);na.subscribeProfilerObserver(oa,this.Nej);tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ProcessCallStacksWithActionOrBeforeTTSI",!1)&&(oa=new Nd,na.subscribeCallTreeCustomFilterer(oa));return na}H5h(oa){return this.tTf(oa)?this.Kcb.get(oa):(r.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${oa}) does not exist`),
null)}D8e(oa,na){oa=this.E8i||oa;return this.tTf(oa)?this.H5h(oa):this.createProfiler(oa,this.fDi,2E6,2===na?this.JIe:null,0===na?null:this.profilingIntervalInMs,na)}sih(oa){var na=this.interactivityTrackerService;if(na){const dc=na.RLe();if(dc){na=this.Kcb.get(oa);const Rc=new Ge(dc);na.subscribeCallTreeCustomPropertiesRetriever(Rc);na=new cc(Fd=>{dc.startCollectingSlowActions(Fd)},Object(X.a)(dc,dc.stopCollectingSlowActions,"stopCollectingSlowActions"));this.FKd.set(oa,na);return na}r.ULS.sendTraceTag(537155491,
0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}r.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null}tni(){this.uTf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.sTf=new Map;this.FKd=new Map;this.Kcb=new Map}};ed=Object(mb.b)([Object(Nb.d)(Ra.I),Object(mb.c)(0,Object(Ra.u)()),Object(mb.c)(1,Object(Ra.H)()),Object(mb.c)(2,
Object(Ra.P)())],ed);Object(h.a)(ed,"JsSelfProfilerManager",null,[398,2]);class yd extends yb.a{constructor(oa){super();this.$=oa;this.Mb()}create(){r.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");let oa=()=>Pc.GetServiceTaskFactory.Sa(this.$.da,283,284,this.Na);tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")&&(oa=()=>Ne.d(Nb.a.resolve(Ra.s,{rb:this.Na})));mc.TaskExtensions.za(oa(),na=>{tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",
!1)?void Nb.a.Tqg(Ra.H).then(dc=>{this.PKe(na.result,dc)}):this.$.da.kb(443,dc=>{this.PKe(na.result,dc)})},this.$.ka,3)}PKe(oa,na){mc.TaskExtensions.za(Ne.d(oa.ol.loadScript("officeOnlineCpuProfiling")),()=>{const dc=Object(Kc.a)(this.$.da,437,()=>new ed(this.$,na));this.vb(dc)},this.$.ka,3)}static la(oa){oa.da.Ha(438,new yd(oa))}}Object(h.a)(yd,"JsSelfProfilerManagerFactory",yb.a,[]);class Ed{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(h.a)(Ed,
"ActionData",null,[]);class Ud{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(h.a)(Ud,"BlockedEngagementInfo",null,[]);class fe extends Ed{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(h.a)(fe,"SuccessfulActionData",Ed,[]);class We{constructor(){this.successfulActions=[]}}Object(h.a)(We,"SuccessfulEngagementInfo",null,[]);var lf=a(49),Se;let Ae=Se=class{constructor(oa){this.sLa=new Set;this.kQb=null;this.e0e=this.Agg=!1;this.Ebb=(na,dc)=>{this.Grb.hasBlockedActions=
!0;na=this.Grb.blockedActions.length;const Rc=dc.details?dc.actionName+"_"+dc.details:dc.actionName;dc=Object(gb.a)(new Ed,{order:na+1,name:Rc,componentName:dc.componentName,timeFromNavigationStart:dc.timeFromNavigationStart});this.Grb.blockedActions.push(dc)};this.gg=()=>{lf.a(this.$).NLb(this.Ebb);this.pHi();this.kQb=ue.a.instance.create(()=>{this.xFb()},Se.VVj,Aa.a.xFb)};this.Dc=()=>{this.xFb()};this.oLd=()=>{this.$.Xc(2009315810,-1,0,null);this.hWd=!1};this.Grb=new Ud;this.Grb.hasBlockedActions=
!1;this.Hgb=new We;this.eLh();this.$=oa;this.$.ea.mk(this.gg);this.$.wj(this.Dc);this.YVj=0;this.hWd=!1;tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.hJe=new Promise(na=>{this.yeh=na}));lf.a(this.$).N1b(this.Ebb)}dispose(){this.$.ea&&this.$.ea.rn(this.gg);this.$.ll(this.Dc);pd.a.Ja(this.kQb);this.$=this.kQb=null}jkj(oa,na,dc){if(void 0!==oa&&null!==oa&&na){var Rc=this.Hgb.successfulActions.length+1,Fd="InputMethod"in na?na.InputMethod:"",de="IsCommand"in
na&&na.IsCommand;if(this.IBi(oa,na,Fd,de)){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:7472163_PerformanceSurveys")&&++this.YVj===Se.M9j?(this.hWd=!0,this.M$i=ue.a.instance.create(this.oLd,5E3,Aa.a.oLd)):this.hWd&&this.M$i.rq();if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const ne=!de&&oa;this.e0e||ne===Ua.a.Jqg||ne===Ua.a.Kqg||ne===Ua.a.Gqg||ne===Ua.a.Hqg||(this.e0e=!0,this.yeh(void 0))}Rc>Se.kyf||(oa=Object(gb.a)(new fe,{order:Rc,name:oa,componentName:"Location"in
na?na.Location:"",timeFromNavigationStart:dc,inputMethod:Fd,isCommand:de}),this.Hgb.successfulActions.push(oa),1===Rc?this.eIi():Rc===Se.kyf&&this.xFb())}}}pHi(){r.ULS.sendTraceTag(254546634,0,50,`${I.c(this.Grb)}`)}eIi(){sc.PageLoadTrackingInfo.instance.Ywa(new Date)>Se.rLh?r.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${I.c(this.Hgb.successfulActions[0])}`):r.ULS.sendTraceTag(254563592,0,50,`${I.c(this.Hgb.successfulActions[0])}`)}xFb(){!this.Agg&&this.Hgb.successfulActions.length&&
(this.Agg=!0,pd.a.Ja(this.kQb),this.kQb=null,this.$.sendBeaconTraceTag(254559496,50,!1,I.c(this.Hgb)))}eLh(){this.sLa.add(Ua.a.yYc);this.sLa.add(Ua.a.uSd);this.sLa.add(Ua.a.GJd);this.sLa.add(Ua.a.PRf);this.sLa.add(Ua.a.RRf);this.sLa.add(Ua.a.TRf)}IBi(oa,na,dc,Rc){dc=!dc||"unknown"===dc;const Fd="IsSystemInitiated"in na&&na.IsSystemInitiated;na="NoReporting"in na&&na.NoReporting;const de=this.sLa.has(oa);oa=hb.a.equals(oa,Ua.a.vzc,!0)&&dc;return!Fd&&!na&&!de&&!oa&&!(Rc&&dc)}};Ae.kyf=10;Ae.rLh=6E4;
Ae.VVj=12E4;Ae.M9j=25;Ae=Se=Object(mb.b)([Object(Nb.d)(Ra.Q),Object(mb.c)(0,Object(Ra.u)())],Ae);Object(h.a)(Ae,"PageLoadEngagementInfo",null,[]);Object(Nb.b)(Ra.P)(()=>Object(mb.a)(void 0,void 0,void 0,function*(){yield Nb.a.resolve(Ra.r,{rb:0}).then(oa=>oa("officeOnlineCpuProfiling"));return officeOnlineCpuProfiling}));var Qe=a(57),$e=a(144),of=a(524),re=a(40),zf=a(82),Lf=a(429),Ze=a(37),ec=a(243);class Lc extends Sys.EventArgs{constructor(oa){super();this.gV=oa}}Object(h.a)(Lc,"ErrorDataArgs",
Sys.EventArgs,[]);var Da=a(665),Cb=a(118),Zb=a(31);class yc{constructor(oa,na){this.mUb=null;this.Y8b=this.Qod=!1;this.Ile=this.Jle=null;this.j7a=this.i7a=0;this.x5f=oa;this.Wie=na}get SOf(){return this.Wie}get pNb(){return this.Jle}get w5f(){return this.Ile}get dDi(){return this.iCe(this.x5f.getTime())}get Z8i(){return this.iCe(this.w5f.getTime())}get abg(){return!(this.Y8b||void 0===window.bsqmXLSPageLoadStartTime)}get s5c(){try{return this.mUb||(this.mUb=Cb.toUtc(window.bsqmXLSPageLoadStartTime)),
this.mUb}catch(oa){return null}}set s5c(oa){this.mUb=oa}zHj(oa){this.Y8b||(this.Jle=oa,this.Ile=Cb.toUtc(this.pNb))}Lii(oa){if(oa.Values&&(!this.i7a||!this.j7a))try{db.a.Xff in oa.Values&&(this.i7a=parseInt(oa.Values[db.a.Xff].toString(),10));db.a.Yff in oa.Values&&(this.j7a=parseInt(oa.Values[db.a.Yff].toString(),10));const na=M.a.instance;0<this.i7a&&(this.Yuf(this.i7a,"PageLoadFromHostClick"),na.lkj(this.i7a));0<this.j7a&&(this.Yuf(this.j7a,"PageLoadFromHostFrameCreation"),na.mkj(this.j7a));const dc=
oa.Values[db.a.Oii]||0,Rc=oa.Values[db.a.Mii]||oa.Values[db.a.Nii]||0;0<Rc&&na.Tjj(Rc);na.Ujj(dc)}catch(na){}}Ruj(){this.x5f=this.s5c=Zb.a.Ya.kc;this.Wie=0;this.Qod=this.Y8b=!1}iCe(oa){const na=this.s5c.getTime();return na>=oa?0:oa-na+this.SOf}Yuf(oa,na){if(oa){const dc=xa.b();dc.ZCc("UserAction",na,na,Zb.a.FAd(oa),Da.EcmaDateClock.instance.appStart);dc.lac(na,Cb.toTimestamp(this.pNb))}}}Object(h.a)(yc,"PageLoadPerfInfo",null,[]);var Vc=a(77);class jd{constructor(oa,na,dc){this.gWc=oa.keyCode;this.aOb(oa.ctrlKey,
1);this.aOb(oa.shiftKey,2);this.aOb(oa.altKey,4);this.aOb(Vc.b(oa),8);this.aOb(dc,16);this.gWc=this.vgb|na<<24}get vgb(){return this.gWc}get keyCode(){return this.vgb&65535}aOb(oa,na){oa&&(this.gWc=this.vgb|na<<16)}}Object(h.a)(jd,"ShortcutSqmData",null,[]);class ld{constructor(){this.Hzd=null;this.qah={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.c2f()}g6g(oa,na,dc){0===dc&&(dc=this.qah[na.toString()]);return ld.$ag(oa,dc)&&(oa=new jd(oa,dc,x.a.isMac),!Ze.a.xg(this.Hzd,oa.vgb.toString()))?
(this.Hzd[oa.vgb.toString()]=!0,oa):null}c2f(){this.Hzd={}}static Wui(oa){return 112<=oa&&123>=oa||61440<=oa&&61451>=oa}static qwi(oa){return 17!==oa&&18!==oa&&16!==oa&&91!==oa&&93!==oa}static $ag(oa,na){let dc=oa.ctrlKey||oa.altKey||Vc.b(oa);oa=oa.keyCode;dc=ld.Wui(oa)||dc;dc=ld.qwi(oa)&&dc;return 0!==na&&dc}}Object(h.a)(ld,"UnhandledShortcutLogger",null,[]);class Bd{constructor(oa){this.z6b=[];this.MVg=null;this.sqmManager=oa}a1b(oa){this.z6b.push(oa)}L6(oa,na,dc){try{if(na)na.endTime=dc,this.sqmManager.dre(na);
else for(let Rc=0,Fd=this.z6b.length;Rc<Fd;Rc++){const de=this.z6b[Rc];oa?(de.endTime=de.startTime,de.cHe=0):de.endTime=dc;this.sqmManager.dre(de)}}catch(Rc){}finally{this.z6b.length=0}}}Object(h.a)(Bd,"UserInteractionPerfInfo",null,[]);var Td=a(38),Jd=a(74),ce=a(240);class ie extends fa.a{constructor(oa,na){super();this.Hnd=this.mMb=!1;this.dbg=!0;this.Qa=new re.a;this.QLc=!1;this.Dc=()=>{const dc=Jd.a(this.$).ud.activityState,Rc=Ze.a.xg(dc,Td.a.Hqe);Ze.a.xg(dc,Td.a.mpb)||Rc||this.upload()};this.$=
oa;this.oyb=na;this.ea=oa.ea;this.$.wj(this.Dc);this.ylg=new ld;this.eRa=new yc(wb.a.KRd,oa.xa.PageGenerationMetrics.TimeToCompleteFirstFlush);this.jHc=new Bd(this)}SZc(oa){this.Qa.addHandler("EREK",oa)}fOd(oa){this.Qa.removeHandler("EREK",oa)}get Qmh(){return this.QLc}get Zoi(){return this.$.frame.BR?$d.a.bpi:$d.a.$oi}get workbookContext(){return this.$.workbookContext}get sU(){ie.ejb||(ie.ejb=this.PSe());ie.D2c||(ie.D2c=!0,this.Hhf());return ie.ejb}set sU(oa){ie.ejb=oa;ie.ejb||(ie.D2c=!1)}get S3(){return zf.a(this.$.xa,
3)}dispose(){this.Qmh&&v.AFrameworkApplication.Zn&&v.AFrameworkApplication.Zn.disable();this.$&&this.$.ll(this.Dc);this.$=this.jHc=this.eRa=this.sU=null;super.dispose()}Scf(oa){this.eRa.Lii(oa);this.mIi()}fTd(oa){this.setDw(9415,oa)}a1b(oa){this.jHc.a1b(oa)}L6(oa,na,dc){this.jHc.L6(oa,na,dc)}dzd(oa){this.S3&&(oa=this.$.isEditMode||oa&&this.ea.workbookContext.Options&512?2:this.ea.nc.inEmbedView?14:1,this.setDw(8721,oa),this.kNh(oa),this.QLc=!1)}mvf(){const oa=this.eRa;this.S3&&oa.abg&&(this.setDw(9450,
oa.SOf),this.setDw(9085,oa.dDi))}nvf(oa){if(!this.mMb){this.mMb=!0;const na=this.eRa;let dc=0;this.S3&&na.abg?(na.zHj(oa),this.jHc.MVg=na.w5f,this.setDw(9086,na.Z8i),na.Y8b=!0,dc=this.eRa.pNb.getTime()):dc=oa.getTime();mc.TaskExtensions.za(this.oyb.value,Rc=>{Rc.result.hi(Sa.a.FVg,{[db.a.GVg]:dc})},this.ka,3)}}dre(oa){this.S3&&oa&&1!==oa.vfa&&this.Wha(8327,ec.b(oa),ec.l(oa),ec.a(oa),2,oa.cHe,ec.m(oa),ec.d(oa),ec.e(oa))}mPd(oa,na){oa&&oa.MessageIdHash&&this.lPd(oa.MessageIdHash,oa.MessageIdName,oa.MessageId,
oa.ErrorCause?oa.ErrorCause:Qe.a.CFc,!1,na,oa,null)}lPd(oa,na,dc,Rc,Fd,de,ne,cf){ie.appEncounteredFirstError||(ie.appEncounteredFirstError=!0,$e.a.get_instance().isCompleted(13)||($e.a.get_instance().eu(13),r.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));oa=this.cwb(oa);const Bf=!!ne,Af={};Af.ErrorName=na;Af.ErrorHashCode=oa.toString();Af.ErrorId=dc.toString();Af.ErrorCause=Rc.toString();Af.ErrorType=0===de?"ErrorDialog":"BusinessBar";Af.BusinessBarEntryName=
cf||"null";Af.ServerCorrelationId=Bf?ne.CorrelationId:"null";Af.WebMethodName=Bf?ne.WebMethodName:"null";Af.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Af.WfeServerId=Bf?ne.WfeServerId:"null";na=he.a.Fc(Af);this.Qa.raiseEvent("EREK",new Lc(Af));r.ULS.sendTraceTag(1881314,0,15,na);this.S3&&(N.a.HWf(oa.toString()),this.Wha(9134,oa,Rc,Qe.a.K1d),this.ea.Rv||Fd||(this.setDw(10459,oa),this.dzd(!0),this.Hnd=!0,this.upload(),this.Hhf()))}cwb(oa){return 5439488|(oa>>>
16^oa&65535)&65535}zzd(oa,na,dc){oa=this.ylg.g6g(oa,na,dc);this.S3&&oa&&this.Wha(11007,oa.vgb)}upload(){!this.S3||!this.mMb&&!this.Hnd||x.a.Nf&&v.AFrameworkApplication.ug?x.a.Nf&&v.AFrameworkApplication.ug&&r.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.sU.hSb(),this.QLc=!0);v.AFrameworkApplication.Zn=this.sU=null;this.eRa.Ruj();this.mMb=!1;v.AFrameworkApplication.Zn=this.sU=this.PSe();this.ylg.c2f()}mIi(){const oa=this.eRa;if(this.S3&&!oa.Qod){var na=oa.i7a,dc=
oa.j7a,Rc=oa.pNb.getTime();v.AFrameworkApplication.NM=oa.pNb;na&&this.setDw(10324,na>Rc?0:Rc-na);dc&&this.setDw(10325,dc>Rc?0:Rc-dc);oa.Qod=!0}}Wha(oa,...na){this.S3&&this.sU.Wha(oa,...na)}setDw(oa,na){this.S3&&this.sU.setDw(oa,na)}PSe(){Lf.a.lTe(this.$.xa);return v.AFrameworkApplication.Zn}kNh(oa){let na;try{na=Object(E.a)(Object,he.a.ri(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(dc){r.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${dc.message}`);
return}if(na){let dc=Object(E.a)(String,na.ApplicationModeExtended),Rc=Object(E.a)(String,na.ApplicationMode);dc&&Rc&&(dc=dc.toUpperCase(),2!==oa&&16!==oa||"VIEW"!==dc&&"UNIFIED"!==dc?1!==oa||"EDIT"!==dc&&"UNIFIED"!==dc||(dc="VIEW",Rc="View"):(dc="EDIT",Rc="Edit"),na.ApplicationModeExtended=dc,na.ApplicationMode=Rc,v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=he.a.Fc(na))}}Hhf(){const oa=this.$.xa;this.sU.AN=!0;this.sU.KVa(oa.BWsaStartTime);this.setDw(59,83);this.mMb=!1;if(this.S3){const na=
oa.DocumentHostInfo;this.vlh();this.setDw(8491,this.$.AG);this.setDw(9236,oa.RequestedUILcid);this.setDw(8473,oa.WacHostId);this.setDw(9902,ec.c(na.ClusterId));tb.EwaSettings.ya(398)?this.sU.v8f(""):this.sU.v8f(oa.FlightHolder?oa.FlightHolder.FlightId:"");this.fTd(this.ea.nc.inEmbedView?1:0);this.Hnd=!1;this.setDw(9104,ec.c(na.FileSourceId));this.setDw(10309,this.Zoi);this.xJj();v.AFrameworkApplication.xb.YMd(of.a.getInstance(!1))}}xJj(){M.a.instance.Nli(this.sU);if(this.dbg){const oa=M.a.instance;
oa.Pjj();oa.gkj();oa.ekj();oa.dkj();oa.Zjj();this.dbg=!1}}vlh(){this.createStream(8327,1,ce.a.Coh,ce.a.r3a);this.createStream(9134,1,3,ce.a.r3a);this.createStream(11007,1,1,ce.a.r3a)}createStream(oa,na,dc,Rc){this.sU.createStream(oa,na,dc,Rc)}}ie.ejb=null;ie.D2c=!1;ie.appEncounteredFirstError=!1;Object(h.a)(ie,"SqmManager",fa.a,[187,404]);var we=a(754);class zc{constructor(oa,na=!1){this.entryTypes=null;this.buffered=!1;this.entryTypes=oa;this.buffered=na}}Object(h.a)(zc,"PerformanceObserverInit",
null,[]);class Sc extends Sys.EventArgs{constructor(oa){super();this.oTe=oa}}Object(h.a)(Sc,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class td extends Sys.EventArgs{constructor(oa){super();this.xic=oa}}Object(h.a)(td,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class Md{constructor(oa){this.Qa=new re.a;this.fPc=!1;this.gg=()=>{if(x.a.Lo){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.xKi)).observe(new zc([$d.a.Lzd])),
this.fPc=!0)}catch(na){this.fPc=!1,r.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${na}`)}this.Qa.raiseEvent("ltpoiek",new td(this.xic))}};this.xKi=na=>{this.Qa.raiseEvent("ltoek",new Sc(na))};this.$=oa;this.$.ea.Bf?this.gg(this,Sys.EventArgs.Empty):this.$.ea.mk(this.gg)}get xic(){return this.fPc}Kte(oa){this.Qa.addHandler("ltoek",oa)}rqj(oa){this.Qa.removeHandler("ltoek",oa)}GRg(oa){this.Qa.addHandler("ltpoiek",oa)}sqj(oa){this.Qa.removeHandler("ltpoiek",oa)}dispose(){this.$.ea.rn(this.gg);
pd.a.Ja(this.Qa);this.$=this.Qa=null}}Object(h.a)(Md,"LongTaskPerformanceObserver",null,[2]);var wd=a(171);class Ta{constructor(oa=0,na=0){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=oa;this.longTaskDuration=na}get Ozd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}dCi(oa){return 100*this.Ozd>oa}iPg(oa){this.zse(oa.longTaskDuration);this.DZc(oa.activeSessionDuration)}zse(oa){this.longTaskDuration+=oa}DZc(oa){this.activeSessionDuration+=
oa}}Object(h.a)(Ta,"LongTaskPerformanceData",null,[]);class Vb{constructor(oa,na,dc,Rc,Fd){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=oa;this.entireSessionData=na;this.worstWindowData=dc;this.postBootWindowData=Rc;this.maxUsersCount=Fd}get reportName(){return"LongTaskPerformance"}static get $vh(){return new Vb(!1,new Ta,new Ta,new Ta,0)}}Object(h.a)(Vb,"LongTaskPerformanceDataStatistics",null,[286]);class qc extends Sys.EventArgs{constructor(oa){super();
this.Mzd=oa}}Object(h.a)(qc,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Ic=a(386),gd=a(301);class Kd{constructor(oa,na){this.Qa=new re.a;this.dPa=this.R6=this.$S=this.Le=null;this.Orf=this.xWd=this.mmc=!1;this.FPa=null;this.maxUsersCount=0;this.Vrc=(dc,Rc)=>{dc=Rc.oTe.getEntriesByType($d.a.Lzd);for(const Fd of dc)this.Le.AD(Fd.duration)||v.AFrameworkApplication.LOa||(this.$S.zse(Fd.duration),this.Qa.raiseEvent("lttek",new qc(Fd)),dc={},dc.LongTaskDuration=Fd.duration,dc.LongTaskStartTime=Fd.startTime,
r.ULS.sendTraceTag(187982418,0,50,JSON.stringify(dc)))};this.gg=()=>{this.xWd=!0;this.cDc()};this.JB=(dc,Rc)=>{Rc&&(this.maxUsersCount=Math.max(this.maxUsersCount,Rc.h$j));this.R6.maxUsersCount=this.maxUsersCount};this.yd=()=>{this.cDc()};this.Dc=()=>{this.cQb()};this.HIf=(dc,Rc)=>{Rc.xic&&this.cDc()};this.Nvf=()=>{this.$S.DZc(Cb.getElapsedMilliseconds(this.dPa,Zb.a.Ya.kc));this.xYd(!0);var dc=!1;this.R6.postBootWindowData.activeSessionDuration?(!this.Orf&&tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(this.xpg&&xa.b().X0f(2),G.Health.instance.recordKpiUsage(gd.a.longJsTask,0,Ic.a.eDi,null),this.Orf=!0),!this.R6.isVetoSession&&this.$S.dCi(this.tqg)&&(this.R6.isVetoSession=!0,tb.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(this.xpg&&xa.b().Y0f(2,this.vKi),G.Health.instance.recordKpiFailure(gd.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.R6.worstWindowData.Ozd<=this.$S.Ozd&&(this.R6.worstWindowData=this.$S),this.R6.entireSessionData.iPg(this.$S)):
(this.R6.postBootWindowData=new Ta(this.$S.activeSessionDuration,this.$S.longTaskDuration),dc=!0);const Rc={};Rc.LastWindowScore=this.$S;Rc.postBootWindow=dc;Rc.CoauthersNumber=this.$.ea.No.length;dc=JSON.stringify(Rc);r.ULS.sendTraceTag(20779346,0,50,dc);this.$S=new Ta};this.Iqc=()=>{this.Le.oi||v.AFrameworkApplication.LOa||this.xYd(!1)};this.Hqc=()=>{this.$S.DZc(Cb.getElapsedMilliseconds(this.dPa,Zb.a.Ya.kc));this.dPa=null;this.FPa.cancel()};this.$=oa;this.tqg=oa.xa.LongTaskPerformanceVetoThreshold;
this.vKi="PercentageOver_"+this.tqg.toString();this.Nzd=oa.xa.LongTaskPerformanceWindowDurationInMs;this.GN=na;this.xpg=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.kb(291,dc=>{this.Le=dc;this.cDc()});this.$.ea.Bf?this.gg(this,Sys.EventArgs.Empty):this.$.ea.mk(this.gg);this.GN.GRg(this.HIf);this.$.rl(this.yd);this.$.wj(this.Dc)}HRg(oa){this.Qa.addHandler("lttek",oa)}tqj(oa){this.Qa.removeHandler("lttek",oa)}dispose(){this.xWd=!1;this.cQb();this.$.lm(this.yd);
this.$.ll(this.Dc);this.GN.sqj(this.HIf);pd.a.Ja(this.FPa);this.GN=this.$=this.FPa=null;void 0!==this.Le&&null!==this.Le&&pd.a.Ja(this.Le)}cDc(){void 0===this.Le||null===this.Le?r.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.GN.xic?this.mmc?r.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):
this.xWd?(this.mmc=!0,this.R6=Vb.$vh,this.$S=new Ta,this.$.ea.X$(this.JB),this.maxUsersCount=this.$.ea.No.length,this.GN.Kte(this.Vrc),this.Le.DHa(this.Hqc),this.Le.yta(this.Iqc),v.AFrameworkApplication.JZc(this.Hqc),v.AFrameworkApplication.KZc(this.Iqc),this.FPa=ue.a.instance.create(this.Nvf,this.Nzd,Aa.a.bvf,!1),bc.a(this.$).$T(this.R6),this.Le.oi||v.AFrameworkApplication.LOa||this.xYd(!0),r.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):r.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):r.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}cQb(){this.mmc&&(this.mmc=!1,this.$.ea.rn(this.gg),this.GN.rqj(this.Vrc),this.$.ea.i8(this.JB),void 0!==this.Le&&null!==this.Le&&(this.Le.Pdb(this.Hqc),this.Le.sBa(this.Iqc)),v.AFrameworkApplication.zZf(this.Hqc),
v.AFrameworkApplication.AZf(this.Iqc),this.FPa.cancel(),this.dPa=this.$S=this.R6=null,this.maxUsersCount=0)}xYd(oa){oa||void 0===this.dPa||null===this.dPa?(this.dPa=Zb.a.Ya.kc,this.FPa=wd.AsyncMethodContext.d8b(this.Nvf,oa?this.Nzd:this.Nzd-this.$S.activeSessionDuration,Aa.a.bvf,this.FPa)):r.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(h.a)(Kd,
"LongTaskPerformanceTracker",null,[2]);var oe=a(33);class Ce extends re.a{constructor(oa,na){super();this.statusBarManager=this.Le=null;this.IIf=(dc,Rc)=>{Rc.Mzd&&Rc.Mzd.duration>=this.yKi&&(this.cwf++,this.msf=Rc.Mzd.duration)};this.$=oa;this.$.da.kb(29,dc=>{this.statusBarManager=dc;dc.OJ(this)});this.$.da.kb(291,dc=>{this.Le=dc});this.msf=this.cwf=0;this.yKi=oa.xa.LongTaskThresholdMs;this.I$a=na;this.I$a.HRg(this.IIf)}Iq(oa){this.addHandler("LTSCEK",oa)}gr(oa){this.removeHandler("LTSCEK",oa)}Uz(){this.Qn("QueryLongTasksCount")&&
this.raiseEvent("LTSCEK")}ns(oa,na){if("QueryLongTasksCount"!==oa)return!1;this.Pei(na);return!0}Qn(){return tb.EwaSettings.ya(505)}dispose(){this.statusBarManager&&(this.statusBarManager.fG(this),this.statusBarManager=null);this.I$a.tqj(this.IIf);super.dispose()}Pei(oa){const na=`Long Tasks: ${this.cwf} | Last Task Duration: ${Math.round(this.msf)}ms`;oe.a.Pn()?(oa.LabelText=na,oa.Visible=!0):oa.Value=na}}Object(h.a)(Ce,"LongTasksStatusBarManager",re.a,[2,229,230]);var ze=a(12);class af{constructor(){this.rttMs=
this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(h.a)(af,"NetworkInfoData",null,[]);class Za extends re.a{constructor(oa){super();this.statusBarManager=null;this.pZc=!1;this.qBf=()=>{this.raiseEvent("NetworkInformation")};this.$=oa;tb.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.KN=this.n1d("connection")||this.n1d("mozConnection")||this.n1d("webkitConnection"))&&tb.EwaSettings.ya(410)&&oa.da.kb(29,na=>
{this.statusBarManager=na;na.OJ(this);this.KN.addEventListener("change",this.qBf);this.pZc=!0})}Iq(oa){this.addHandler("NetworkInformation",oa)}gr(oa){this.removeHandler("NetworkInformation",oa)}f6a(){return this.KN?Object(gb.a)(new af,{bandwidthMps:this.KN.downlink,rttMs:this.KN.rtt,connectionType:this.KN.type,effectiveConnection:this.KN.effectiveType,downlinkMaxMps:this.KN.downlinkMax}):null}ns(oa,na){if("QueryNetworkInformation"!==oa)return!1;this.Qei(na);return!0}Qn(){return this.pZc}dispose(){this.pZc&&
(this.statusBarManager&&(this.statusBarManager.fG(this),this.statusBarManager=null),this.KN&&this.KN.removeEventListener("change",this.qBf));this.$=null;super.dispose()}n1d(oa){return ze.HelperMethods.Nn(window.navigator,oa)?window.navigator[oa]:null}Qei(oa){const na="Network: "+this.KN.downlink.toString()+" Mbps, "+this.KN.rtt.toString()+" ms";oe.a.Pn()?(oa.LabelText=na,oa.Visible=!0):oa.Value=na}}Object(h.a)(Za,"NetworkInformationManager",re.a,[229,230]);var Rb=a(198),rc=a(21);class Jc{constructor(oa=
"",na=-1,dc=-1,Rc=-1,Fd=!1,de=!0,ne=!0,cf=!1,Bf="",Af=-1){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=oa;this.startTime=na;this.startToNextFrame=dc;this.startToResponseRenderEnd=Rc;this.wasHidden=Fd;this.isUserOperation=de;this.isGroupBreaking=ne;this.operationThatLedToLogging=Bf;this.startToOperationThatLedToLogging=
Af;this.isPartOfGroup=cf}}Object(h.a)(Jc,"OperationStatisticsData",null,[]);var Sb=a(85);class Cc{constructor(){this.operationsGroups=null;this.fli()}isGroup(oa,na,dc){const Rc=new Rb.a;Rc.addRange(oa);Rc.addRange(na);for(let Fd=0;Fd<this.operationsGroups.count;Fd++)if(this.Oxi(this.operationsGroups.ma(Fd),Rc,dc))return r.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${dc}' is part of a group ( operationsList: ${this.yOf(oa)} , frameOperationsList: ${this.yOf(na)})`),!0;r.ULS.sendTraceTag(595194767,
1,50,`OperationsGroupDetector: Operation '${dc}' is NOT part of a group.`);return!1}Oxi(oa,na,dc){let Rc=0;for(let Fd=0;Fd<na.count;Fd++)if(na.ma(Fd).isGroupBreaking){if(oa.count<=Rc||!hb.a.equals(na.ma(Fd).name,oa.ma(Rc),!0))return!1;Rc++}return oa.count>Rc&&hb.a.equals(dc,oa.ma(Rc),!0)}yOf(oa){oa=Sb.select(oa,na=>na.name);return`[${Sb.toArray(oa).join(", ")}]`}fli(){this.operationsGroups=new Rb.a;this.t_a(new Rb.a(["Paste","SelectingRange_unknown"]));this.t_a(new Rb.a(["AutoSum","SelectingRange_unknown"]));
this.t_a(new Rb.a(["ChangeSheetDirection","ActiveItemChanged"]));this.t_a(new Rb.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.t_a(new Rb.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.t_a(new Rb.a(["EditBoxEndEdit","SetCell","SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}t_a(oa){this.operationsGroups.add(oa)}}Object(h.a)(Cc,"OperationsGroupDetector",null,[]);var cd=a(26);class Wd{constructor(oa,na,dc,Rc){this.framePerformanceTracker=
this.aMb=this.z0=this.y1=null;this.btj=()=>{this.l0c=-1;const Fd=ze.HelperMethods.Pb();this.J8j(Fd);tb.EwaSettings.ya(326)&&(this.wNb&&(r.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.YRb(this.gF,Fd),this.wNb=!1),this.Ckc&&(this.YRb(this.QD,Fd),this.wNb||this.YRb(this.gF,Fd)));window.setTimeout(this.kIi,0)};this.kIi=()=>{var Fd=[];const de=this.$.xa.OperationToPrevOperationThreshold;for(var ne=0;ne<
this.gF.count;ne++){var cf=this.gF.ma(ne);ne<de&&Fd.push(cf);this.QD.add(cf)}rc.h(this.$)&&rc.h(this.$).Ca?((ne=this.sessionStatisticsManager.lid(0))?(cf=JSON.stringify(this.EFb),Fd=JSON.stringify(Fd),r.ULS.sendTraceTag(237798547,1,50,`DOM count: (${ne.iOi}, ${ne.sZg}, ${ne.ZMi}), long tasks: ${cf}, operations count: ${this.gF.count}, operations: ${Fd}`)):r.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.gF.count>de&&r.ULS.sendTraceTag(537153875,1,50,`More than ${de} operations are in the operationsList. count: ${this.gF.count}`),
this.gF.clear(),this.EFb.clear()):r.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Vrc=(Fd,de)=>{this.wKi(de.oTe)};this.$=oa;this.ZI=na;this.Hh=this.Hh||Zb.a.Ya;this.QD=new Rb.a;this.gF=new Rb.a;this.l0c=this.a$a=-1;this.EFb=new Rb.a;this.operationsGroupDetector=new Cc;this.wNb=this.Ckc=!1;this.Dli();this.hli();this.gli();this.sessionStatisticsManager=dc;this.GN=Rc;this.GN.Kte(this.Vrc);this.$.da.kb(263,Fd=>{this.framePerformanceTracker=Fd})}iMb(oa,na){var dc=ze.HelperMethods.Pb();
const Rc=tb.EwaSettings.ya(326)?this.operationsGroupDetector.isGroup(this.QD,this.gF,oa):!1;this.Ckc=this.Onf(oa);tb.EwaSettings.ya(326)?this.Ckc&&0<this.QD.count&&!Rc&&(this.N7j(),this.Ung(oa,dc),this.A0e()):0<this.QD.count&&this.Onf(oa)&&(this.Ung(oa,dc),this.A0e());this.a$a=-1;if(rc.h(this.$)&&rc.h(this.$).Ca){var Fd=!this.y1.contains(oa);dc=new Jc(oa,dc,void 0,void 0,void 0,Fd,this.Ckc,Rc);this.gF.add(dc);this.framePerformanceTracker&&this.framePerformanceTracker.hUj(dc.name,na);tb.EwaSettings.ya(326)&&
!this.wNb&&this.aMb.contains(oa)&&(this.wNb=!0);-1===this.l0c&&(this.l0c=window.requestAnimationFrame(this.btj))}else r.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}xxc(){this.a$a=ze.HelperMethods.Pb()}Exc(){this.QD.count||this.gF.count?(this.YRb(this.gF,this.a$a),this.YRb(this.QD,this.a$a)):r.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.a$a}`);this.a$a=-1}Onf(oa){return!this.z0.contains(oa)&&!oa.includes("Menu")&&
!oa.includes("TellMe")}A0e(){for(let oa=0;oa<this.QD.count;oa++){const na=this.QD.ma(oa);this.ZI.hLg(na);this.RIi(na)}this.QD.clear()}J8j(oa){for(let na=0;na<this.gF.count;na++)this.gF.ma(na).startToNextFrame=this.tkd(this.gF.ma(na).startTime,oa),this.gF.ma(na).wasHidden=we.a.AD(this.gF.ma(na).startToNextFrame)}Ung(oa,na){for(let dc=0;dc<this.QD.count;dc++)-1===this.QD.ma(dc).startToResponseRenderEnd&&(this.QD.ma(dc).operationThatLedToLogging=oa,this.QD.ma(dc).startToOperationThatLedToLogging=this.tkd(this.QD.ma(dc).startTime,
na))}N7j(){var oa=!1;for(let na of this.QD)if(na.isPartOfGroup){oa=!0;break}if(oa)for(oa=0;oa<this.QD.count;oa++)this.QD.ma(oa).isPartOfGroup=this.QD.ma(oa).isGroupBreaking}YRb(oa,na){for(let dc=0;dc<oa.count;dc++)oa.ma(dc).startToResponseRenderEnd=this.tkd(oa.ma(dc).startTime,na),oa.ma(dc).wasHidden=we.a.AD(oa.ma(dc).startToResponseRenderEnd)}RIi(oa){oa=JSON.stringify(oa);r.ULS.sendTraceTag(2020372336,1,50,`${oa}`)}tkd(oa,na){return-1===oa?-1:-1===na?-2:na-oa}wKi(oa){oa=oa.getEntriesByType($d.a.Lzd);
for(let na=0;na<oa.length;na++)if(30>this.EFb.count)if(this.gF.count)this.EFb.add(this.K$i(oa[na]));else{const dc=oa[na];if(null===dc||void 0===dc?0:dc.attribution)void 0!==dc.attribution.containerSrc&&null!==dc.attribution.containerSrc&&(dc.attribution.containerSrc=""),void 0!==dc.attribution.containerId&&null!==dc.attribution.containerId&&(dc.attribution.containerId=""),void 0!==dc.attribution.containerName&&null!==dc.attribution.containerName&&(dc.attribution.containerName="");r.ULS.sendTraceTag(40777251,
1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{r.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${oa.length} First long task: ${this.EFb.ma(0)}`);break}}K$i(oa){return`name:${oa.name}, startTime:${oa.startTime}, duration:${oa.duration}`}Dli(){this.y1||(this.y1=new Lb.a(Ea.a.$h()),this.y1.add("ActiveItemChanged"),this.y1.add(xa.b().Sj(-1398645260)),this.y1.add(xa.b().Sj(722290388)),this.y1.add(xa.b().Sj(974713501)),
this.y1.add(cd.a.aR(cd.a.p6b)),this.y1.add(cd.a.aR(cd.a.o6b)),this.y1.add(cd.a.aR(cd.a.dtb)),this.y1.add(cd.a.aR(cd.a.NTf)),this.y1.add(cd.a.aR(cd.a.Hoa)))}hli(){this.z0||(this.z0=new Lb.a(Ea.a.$h()),this.z0.add("PromptEditInBrowser"),this.z0.add(xa.b().Sj(-1398645260)),this.z0.add(xa.b().Sj(722290388)),this.z0.add(xa.b().Sj(974713501)),this.z0.add(cd.a.aR(cd.a.p6b)),this.z0.add(cd.a.aR(cd.a.o6b)),this.z0.add(cd.a.aR(cd.a.dtb)),this.z0.add(cd.a.aR(cd.a.NTf)),this.z0.add(cd.a.aR(cd.a.Hoa)))}gli(){this.aMb||
(this.aMb=new Lb.a(Ea.a.$h()),this.aMb.add("SelectingRange_keyboard"),this.aMb.add("SelectingRange_mouse"))}}Object(h.a)(Wd,"OperationStatistics",null,[]);var je=a(592);class Ee{constructor(oa,na){this.messageIdName=null;this.errorCause=0;this.messageIdName=oa;this.errorCause=na}}Object(h.a)(Ee,"RequestError",null,[]);class Ue{constructor(oa,na,dc,Rc,Fd,de,ne,cf,Bf,Af,mg,Kf,Zf,Ug,eg,Tg,Cg){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;
this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=
oa;this.isUserTriggeredRequest=Ue.t1h(oa);this.isFullyLoggedKPIRequest=Ue.l1h(oa);this.isPromotedUTRRequest=Ue.n1h(oa);this.requestDuration=na;this.totalOperationDuration=dc;this.requestTimeInQueue=Rc;this.requestInvokedTime=Fd;this.ecsOperationDuration=de.EcsOperationDuration;this.EcsRequestDuration=de.EcsRequestDuration;this.WfeRequestDuration=de.WfeRequestDuration;this.TimeFromLastEcsFreeze=de.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=de.DuringLoadOnDemand;this.correlationID=ne;this.errors=
Ue.Kch(cf);this.httpStatus=Bf;this.requestResourceTiming=Af;this.communicationErrorRetryCount=mg;this.successfulCall=Kf;this.isDocumentHidden=Zf;this.coauthorsCount=Ug;this.responseSize=eg;this.networkInfoData=Tg;this.responseToCallbackTime=Cg}static Kch(oa){if(!oa)return[];const na=[];for(const dc of oa)na.push(new Ee(dc.MessageIdName,dc.ErrorCause));return na}static t1h(oa){return!Ue.ZQi.contains(oa)}static E3h(){const oa=new Lb.a(Ea.a.$h());oa.add("CheckPersistedContentUpdate");oa.add("GetContentBundle");
oa.add("GetSessionStatus");oa.add("GetStatusBarAggregates");oa.add("PollSessionStatus");oa.add("UpdatePresenceUsers");oa.add("UploadLatencyTelemetry");return oa}static l1h(oa){return Ue.HPh.contains(oa)}static n1h(oa){return Ue.Rej.contains(oa)}static P_h(){const oa=new Lb.a(Ea.a.$h());oa.add("SetRichTextCell");oa.add("Copy");oa.add("FormatCells");oa.add("PasteRange");oa.add("FindCell");oa.add("ApplyToRangesV2");oa.add("ResizeRowsColumns");oa.add("InsertDeleteCells");oa.add("FillRange");oa.add("PasteHtmlContent");
oa.add("ApplyFilter");oa.add("PasteString");oa.add("Undo");oa.add("LineageUpdateView");oa.add("FindAll");oa.add("ApplyHyperlink");oa.add("AutoFit");oa.add("GetPrintSettings");oa.add("GetEdgeCell");oa.add("Paste");oa.add("MoveAndResizeFloatingObject");oa.add("FindRange");oa.add("SetCustomFilter");oa.add("RenameSheet");oa.add("ApplyThreadedComment");oa.add("SortFilterColumn");oa.add("InsertCopiedCutCells");oa.add("InsertSheet");oa.add("ToggleAutoFilter");oa.add("ReorderSheets");oa.add("SetOutlineLevel");
oa.add("RefreshAll");oa.add("LineageOpenPaneOrChangeFilter");oa.add("ApplySlicerSelection");oa.add("GetCardViewCardByCell");oa.add("AutoSum");oa.add("LineageClosePane");oa.add("Sort");oa.add("ClearAutoFilter");oa.add("DeleteSheet");oa.add("Redo");tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(oa.add("RemovePageBreak"),oa.add("InsertPageBreak"),oa.add("SetPrintArea"),oa.add("ClearPrintArea"));return oa}static o1h(){const oa=new Lb.a(Ea.a.$h());oa.add("DeleteConditionalFormattingRules");
oa.add("GetConditionalFormattingRules");oa.add("AddConditionalFormattingRule");oa.add("QuickEditConditionalFormattingRule");oa.add("GetPrintSettings");oa.add("UpdatePresenceUsers");oa.add("GetThemeInfo");oa.add("InsertCopiedCutCells");oa.add("PasteRange");tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(oa.add("LineageOpenPaneOrChangeFilter"),oa.add("LineageUpdateView"),oa.add("LineageRefreshView"),oa.add("LineageLoadMore"));return oa}}Ue.ZQi=Ue.E3h();Ue.HPh=Ue.P_h();Ue.Rej=
Ue.o1h();Object(h.a)(Ue,"RequestStatisticsData",null,[]);class gf{constructor(oa,na,dc){this.$=oa;this.ZI=na;this.kna=dc}Jxc(oa,na,dc,Rc,Fd,de,ne,cf,Bf,Af,mg,Kf,Zf,Ug){Kf=je.a(Kf);oa=new Ue(oa,na,dc,Rc,Fd,de,ne,cf,Bf,Kf,Af,mg,we.a.AD(na),this.Wjd(null),Zf,this.kna.f6a(),Ug);this.FPd(oa)}xh(oa,na){oa="UnknownMethodName";let dc=-1;void 0!==na.context&&null!==na.context&&(oa=na.context.methodName,dc=na.context.communicationErrorRetryCount);let Rc,Fd={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,
TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};na.Cd?(Rc=na.Cd.Errors||[],this.ZI.Usj(na.Cd.EditSessionIsDirty),void 0!==na.Cd.RequestTelemetryData&&null!==na.Cd.RequestTelemetryData&&(Fd=na.Cd.RequestTelemetryData)):Rc=[];const de=na.duration,ne=je.a(na.url);na=new Ue(oa,de,na.totalOperationDuration,na.J_d,na.HF,Fd,na.PSd,Rc,na.httpStatus,ne,dc,!0,we.a.AD(de),this.Wjd(na.Cd),na.responseSize,this.kna.f6a(),na.responseToCallbackTime);this.FPd(na)}Mm(oa,na){oa="UnknownMethodName";let dc=-1;void 0!==
na.context&&null!==na.context&&(oa=na.context.methodName,dc=na.context.communicationErrorRetryCount);const Rc=na.duration,Fd=je.a(na.url);na=new Ue(oa,Rc,na.totalOperationDuration,na.J_d,na.HF,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},na.PSd,na.errors||[],na.httpStatus,Fd,dc,!1,we.a.AD(Rc),this.Wjd(null),-1,this.kna.f6a(),na.responseToCallbackTime);this.FPd(na)}FPd(oa){this.ZI.yUg(oa);if(tb.EwaSettings.ya(212)){var na=oa.requestName;
if(na!==$d.a.Xwa&&"SetCell"!==na&&"FindRange"!==na&&"FindAll"!==na&&"FindCell"!==na)return}na=tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===oa.requestName||null===oa.requestName)&&oa.isPromotedUTRRequest;gf.guh(oa,na);this.ZI.iLg(oa)}Wjd(oa){var na;if(null===(na=null===oa||void 0===oa?void 0:oa.CollaborationResult)||void 0===na?0:na.Users)return oa.CollaborationResult.Users.length;oa=this.$.ea.No.length;return 0<oa?oa:1}static guh(oa,na){na?xa.b().Izc(388829456,
0,15,oa):(na=Sys.Serialization.JavaScriptSerializer.serialize(oa),r.ULS.sendTraceTag(388829456,0,50,na));if(tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==oa.requestName&&null!==oa.requestName&&oa.isFullyLoggedKPIRequest){na=new Map;na.set("isUserTriggeredRequest",oa.isUserTriggeredRequest.toString());na.set("requestDuration",oa.requestDuration.toString());na.set("totalOperationDuration",oa.totalOperationDuration.toString());na.set("requestTimeInQueue",oa.requestTimeInQueue.toString());
na.set("requestInvokedTime",oa.requestInvokedTime.toString());na.set("ecsOperationDuration",oa.ecsOperationDuration.toString());na.set("ecsRequestDuration",oa.EcsRequestDuration.toString());na.set("wfeRequestDuration",oa.WfeRequestDuration.toString());na.set("timeFromLastEcsFreeze",oa.TimeFromLastEcsFreeze.toString());na.set("duringLoadOnDemand",oa.DuringLoadOnDemand.toString());na.set("correlationID",oa.correlationID);na.set("errors",oa.errors.toString());na.set("httpStatus",oa.httpStatus.toString());
if(oa.networkInfoData){var dc=oa.networkInfoData;na.set("networkInfoData_bandwidthMps",void 0===dc.bandwidthMps||null===dc.bandwidthMps?"NA":dc.bandwidthMps.toString());na.set("networkInfoData_rttMs",void 0===dc.rttMs||null===dc.rttMs?"NA":dc.rttMs.toString());na.set("networkInfoData_effectiveConnection",void 0===dc.effectiveConnection||null===dc.effectiveConnection?"NA":dc.effectiveConnection)}oa.requestResourceTiming&&(dc=oa.requestResourceTiming,na.set("requestResourceTiming_fetchStart",void 0===
dc.downloadDuration||null===dc.downloadDuration?"NA":dc.downloadDuration.toString()));na.set("communicationErrorRetryCount",oa.communicationErrorRetryCount.toString());na.set("successfulCall",oa.successfulCall.toString());na.set("isDocumentHidden",oa.isDocumentHidden.toString());na.set("coauthorsCount",oa.coauthorsCount.toString());na.set("responseSize",oa.responseSize.toString());na.set("responseToCallbackTime",oa.responseToCallbackTime.toString());xa.b().Gxc(oa.requestName,oa.successfulCall,na)}}}
Object(h.a)(gf,"RequestStatistics",null,[]);var rf=a(213),xf=a(65),Vf=a(274);class Bb{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(h.a)(Bb,"OperationTypeStatisticsData",null,[]);class ac{constructor(oa,na){this.data=new Bb;this.data.operationName=oa;this.data.isUserOperation=na;this.data.totalCount=0;this.ifg=[];this.jfg=[];this.data.longestStartToNextFrame=
-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}rd(oa){this.data.totalCount<ac.Wad&&(this.ifg.push(oa.startToNextFrame),this.jfg.push(oa.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<oa.startToNextFrame&&(this.data.longestStartToNextFrame=oa.startToNextFrame);this.data.longestStartToResponse<oa.startToResponseRenderEnd&&(this.data.longestStartToResponse=oa.startToResponseRenderEnd)}Oed(){0<
this.data.totalCount&&(this.data.startToNextFramePercentiles=this.O8e(this.ifg),this.data.startToResponsePercentiles=this.O8e(this.jfg))}O8e(oa){oa.sort(ze.HelperMethods.WF);let na;na="("+we.a.Uka(oa,25).toString();na=na+", "+we.a.Uka(oa,50).toString();na=na+", "+we.a.Uka(oa,75).toString();na=na+", "+we.a.Uka(oa,95).toString();return na+")"}}ac.Wad=1E3;Object(h.a)(ac,"OperationTypeStatistics",null,[]);class tc{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=
this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(h.a)(tc,"RequestTypeStatisticsData",null,[]);class ub{constructor(oa){this.data=new tc;this.data.requestName=oa;this.data.totalCount=0;this.ieb=[];this.F0d=this.x0d=this.y0d=this.C0d=0;this.data.successfulCalls=
0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=-1}Atj(oa){this.data.totalCount<ub.Wad&&this.ieb.push(oa.requestDuration);this.data.totalCount++;this.C0d+=oa.requestDuration;this.y0d+=ub.mhd(oa.ecsOperationDuration);this.x0d+=ub.mhd(oa.EcsRequestDuration);this.F0d+=ub.mhd(oa.WfeRequestDuration);
0<oa.TimeFromLastEcsFreeze&&oa.TimeFromLastEcsFreeze<ub.wPh&&this.data.callsDuringEcsFreeze++;oa.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;oa.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<oa.requestDuration)this.data.longestRequest=oa}Oed(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.C0d/this.data.totalCount),0<this.data.successfulCalls?
(this.data.averageEcsOperationDuration=Math.floor(this.y0d/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.x0d/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.F0d/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.ieb.sort(ze.HelperMethods.WF),this.data.requestDurationPercentile25=we.a.Uka(this.ieb,25),this.data.requestDurationPercentile50=we.a.Uka(this.ieb,50),this.data.requestDurationPercentile75=
we.a.Uka(this.ieb,75),this.data.requestDurationPercentile95=we.a.Uka(this.ieb,95))}static mhd(oa){return 0>oa?0:oa}}ub.wPh=3E3;ub.Wad=1E3;Object(h.a)(ub,"RequestTypeStatistics",null,[]);class jc{constructor(oa,na,dc,Rc,Fd,de,ne,cf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=oa;this.ocsCapable=na;this.endedBySplashScreen=dc;this.dirtySessionOnLastRecordedRequest=
Rc;this.loadOnDemandCount=Fd;this.maxCoauthorsCount=de;this.everConnectedToOcs=ne;oa=[];for(let Bf in cf)na=cf[Bf],na.Oed(),oa.push(na.data);this.requests=oa}}Object(h.a)(jc,"SessionStatisticsData",null,[]);class Ka{constructor(oa){this.dirtySessionOnLastRecordedRequest=this.sYd=!1;this.Vtf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=oa;this.Wob={};this.Vob={};this.N9c={}}Dc(){var oa=this.umh();if(wb.a.efa()){var na={};na.xlendJson=oa;this.$.Toa(rf.a.fdk,na,!1)}else xf.N(this.$.pa.va,
oa,null,null,null,null,null);oa=this.vmh();wb.a.efa()?(na={},na.xlenoJson=oa,this.$.Toa(rf.a.gdk,na,!1)):r.ULS.sendTraceTag(388776782,0,50,oa);oa=this.Sgh();wb.a.efa()?(na={},na.xlencJson=oa,this.$.Toa(rf.a.edk,na,!1)):r.ULS.sendTraceTag(388776770,0,50,oa);this.iuj()}omc(){this.everConnectedToOcs=this.$.ea.J9a||this.everConnectedToOcs;G.Health.instance&&G.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}gg(){const oa=new Vf.a;let na="";const dc=!this.$.isAnonymousUser(),
Rc=oa.Pe();if(Rc){if(dc){oa.vOb("UMI_Linkable","true");return}na=oa.nMa("UMI_Linkable")}dc||r.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${Rc}, UMIIsLinkable:${!!na}`)}geb(){this.sYd=!0}Usj(oa){this.dirtySessionOnLastRecordedRequest=oa}yUg(oa){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,oa.coauthorsCount);G.Health.instance&&G.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}iLg(oa){if(!(oa.requestName in
this.Wob)){const na=new ub(oa.requestName);this.Wob[oa.requestName]=na}this.Wob[oa.requestName].Atj(oa)}hLg(oa){if(!(oa.name in this.Vob)){const na=new ac(oa.name,oa.isUserOperation);this.Vob[oa.name]=na}this.Vob[oa.name].rd(oa)}$T(oa){this.N9c[oa.reportName]=oa}iuj(){this.dirtySessionOnLastRecordedRequest=this.sYd=!1;this.Vtf=this.$.ea.uyd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.Wob={};this.Vob={};this.N9c={}}umh(){const oa=new jc(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,
this.sYd,this.dirtySessionOnLastRecordedRequest,this.$.ea.uyd-this.Vtf,this.maxCoauthorsCount,this.everConnectedToOcs,this.Wob);return Sys.Serialization.JavaScriptSerializer.serialize(oa)}vmh(){var oa=new Rb.a;const na=this.Vob;for(let dc in na){const Rc=na[dc];Rc.Oed();oa.add(Rc.data)}oa=oa.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(oa)}Sgh(){return Sys.Serialization.JavaScriptSerializer.serialize(this.N9c)}}Object(h.a)(Ka,"SessionStatistics",null,[]);class zb extends fa.a{constructor(oa){super();
this.Foa=this.Wna=null;this.LMe=Array(1);this.LRc=this.Pzd=null;this.xh=(na,dc)=>{tb.EwaSettings.ya(39)&&(this.Foa=this.Foa||new gf(this.$,this.ZI,this.kna),this.Foa.xh(na,dc))};this.Mm=(na,dc)=>{tb.EwaSettings.ya(39)&&(this.Foa=this.Foa||new gf(this.$,this.ZI,this.kna),this.Foa.Mm(na,dc))};this.Dc=(na,dc)=>{tb.EwaSettings.ya(39)&&this.ZI.Dc(na,dc)};this.gg=(na,dc)=>{tb.EwaSettings.ya(39)&&this.ZI.gg(na,dc)};this.omc=(na,dc)=>{tb.EwaSettings.ya(39)&&this.ZI.omc(na,dc)};this.$=oa;tb.EwaSettings.ya(39)&&
(we.a.yhf(this.$),this.GN=new Md(this.$),this.Jih(),tb.EwaSettings.ya(505)&&this.I$a&&(this.Pzd=new Ce(this.$,this.I$a)),this.ZI=new Ka(this.$),this.kna=new Za(this.$),this.$.wj(this.Dc),this.$.pa.ur(this.xh),this.$.pa.Tx(this.Mm),this.$.ea.zte(this.omc),tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.mk(this.gg))}get I$a(){return this.LRc}dispose(){this.$&&tb.EwaSettings.ya(39)&&(this.$.ll(this.Dc),this.$.pa.Ms(this.xh),this.$.pa.Ny(this.Mm),this.$.ea.h_f(this.omc),
tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.rn(this.gg));pd.a.Ja(this.kna);pd.a.Ja(this.I$a);this.LRc=null;pd.a.Ja(this.GN);this.GN=null;pd.a.Ja(this.Pzd);this.$=this.Pzd=null;super.dispose()}geb(){tb.EwaSettings.ya(39)&&this.ZI.geb()}Jxc(oa,na,dc,Rc,Fd,de,ne,cf,Bf,Af,mg,Kf,Zf,Ug){tb.EwaSettings.ya(39)&&(this.Foa=this.Foa||new gf(this.$,this.ZI,this.kna),this.Foa.Jxc(oa,na,dc,Rc,Fd,de,ne,cf,Bf,Af,mg,Kf,Zf,Ug))}iMb(oa,na){tb.EwaSettings.ya(39)&&(this.Wna=this.Wna||
new Wd(this.$,this.ZI,this,this.GN),this.Wna.iMb(oa,na))}xxc(){tb.EwaSettings.ya(39)&&(this.Wna=this.Wna||new Wd(this.$,this.ZI,this,this.GN),this.Wna.xxc())}Exc(){tb.EwaSettings.ya(39)&&(this.Wna=this.Wna||new Wd(this.$,this.ZI,this,this.GN),this.Wna.Exc())}$T(oa){tb.EwaSettings.ya(39)&&this.ZI.$T(oa)}lid(oa){return tb.EwaSettings.ya(39)?this.LMe[oa]:null}e8f(oa){oa&&(this.LMe[oa.type]=oa)}f6a(){return this.kna.f6a()}Jih(){x.a.Lo&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&
(this.LRc=new Kd(this.$,this.GN))}}Object(h.a)(zb,"SessionStatisticsManager",fa.a,[11]);var Yb=a(107),oc=a(1081),Wc=a(126),vd=a(138);class Dd{constructor(oa,na){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=
this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=oa;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=na}$_d(){return he.a.Fc(this)}}Object(h.a)(Dd,"AppUnloadInfo",null,[]);var be=a(717),se=a(128),Oe=a(574);class Me{constructor(oa){this.lostOperationsCount=
0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=oa.tGe+oa.qlg;this.dataLossReason=oa.qCe;this.l4g(oa.D3d)}l4g(oa){const na=new be.a(Oe.a.DK());let dc=0,Rc=0;for(const Fd of oa)na.nb(Fd)||na.ia(Fd,0),oa=na.ia(Fd,na.ma(Fd)+1),oa>dc&&(dc=oa,Rc=Fd);dc>this.mostCommonOperationCount&&(this.mostCommonOperationName=se.a(Rc),this.mostCommonOperationCount=dc)}}Object(h.a)(Me,"DataLossInfo",null,[]);var Ia=a(63);class Jb{constructor(oa){this.s0c=
"AppUnloadInfo";this.Tm=this.$=this.workbookHashedId=this.lz=null;this.c7d=this.B$d=!1;this.df=null;this.Ygf=0;this.Zda=(na,dc)=>{this.Ygf=dc.FEc};this.wNf=(na,dc)=>{dc.D3d.length&&this.$.zD&&(this.lz.dataLossInfo=new Me(dc),this.lz.wasDataLostDuringUnload=!0,this.Jeb())};this.gg=()=>{this.D6f();this.$.ea.rn(this.gg)};this.qQa=()=>{this.lz.wasUpdatedOnBeforeUnload=!0;this.lz.inactivityDurationBeforeUnloadSeconds=this.df.Zgb<Jb.oNi?this.Ygf:this.df.Zgb;this.Qng()};this.JIb=()=>{this.lz.wasUpdatedOnUnload=
!0;this.Qng();Sys.Application.remove_unload(this.JIb)};this.$4i=()=>{this.lz.lastSilentReopenStartTime=Zb.a.Ya.kc;this.lz.lastSilentReopenEndTime=null;this.Jeb();this.$.rl(this.tMf)};this.tMf=()=>{this.lz.lastSilentReopenEndTime=Zb.a.Ya.kc;this.Jeb();this.$.lm(this.tMf)};this.localStorage=new Vf.a;this.localStorage.Pe()&&(this.$=oa,this.workbookHashedId=Ia.a(this.$),this.lz=new Dd(this.workbookHashedId,this.$.xa.UserSessionId),this.Tm=vd.a.instance.uH(),this.Tm.la("beforeunload",this.qQa),this.$.userOperationManager.sTg(this.wNf),
oa.ea.Bf?this.D6f():this.$.ea.mk(this.gg),this.df=this.$.ea.df,this.df.Zha(this.Zda),Sys.Application.add_unload(this.JIb),this.$.ea.A_c(this.$4i))}get dialogPromptedOnUnload(){return this.B$d}set dialogPromptedOnUnload(oa){this.B$d=oa;this.lz?(this.lz.dialogPromptedOnUnload=oa,this.Jeb()):this.localStorage.Pe()&&r.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Pe()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.c7d}set apiBeforeCloseNotificationEnabledOnUnload(oa){this.c7d=
oa;this.lz?(this.lz.apiBeforeCloseNotificationEnabledOnUnload=oa,this.Jeb()):this.localStorage.Pe()&&r.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Pe()}`)}dispose(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.Lrj(this.wNf);this.df&&(this.df.uBa(this.Zda),this.df=null);this.Tm.iD();this.$=this.Tm=null}Qng(){this.oIj();this.Jeb()}oIj(){this.lz.wasOfflineDuringUnload=this.$.ef.m6;
this.lz.timeFromLastConnectivity=Wc.a(Zb.a.Ya,this.$.ef.Ksf);this.lz.timeFromLastDisconnectionStart=Wc.a(Zb.a.Ya,this.$.ef.QDi);this.lz.disconnectionSource=Enum.toString(oc.a,this.$.ef.disconnectionSource);this.lz.hadConnectivityIssuesDuringUnload=this.$.ef.fma;this.lz.timeFromLastStatusCode0=Wc.a(Zb.a.Ya,this.$.ef.Jsf)}Jeb(){this.lz.timestamp=Date.now();this.localStorage.vOb(this.s0c,this.lz.$_d())}D6f(){const oa=this.localStorage.nMa(this.s0c);if(oa)try{const na=he.a.ri(oa);this.localStorage.BNd(this.s0c);
const dc=this.DLi(na);r.ULS.sendTraceTag(574677456,0,50,dc)}catch(na){r.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${na.message}`)}else r.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}DLi(oa){const na={};na.WACSessionID=oa.wacSessionId;na.wasRefreshed=this.h8g(oa,this.$.xa.MaxAppReloadDurationIndicatingRefresh);na.closedWithDialogConfirmation=oa.dialogPromptedOnUnload;
na.wasOfflineDuringUnload=oa.wasOfflineDuringUnload;na.TimeFromLastConnectivityMs=oa.timeFromLastConnectivity;na.TimeFromLastDisconnectionStart=oa.timeFromLastDisconnectionStart;na.wasDataLostDuringUnload=oa.wasDataLostDuringUnload;na.DataLossInfo=oa.dataLossInfo;na.flushedOnUnload=oa.wasUpdatedOnUnload;na.flushedOnBeforeUnload=oa.wasUpdatedOnBeforeUnload;na.InactivityDurationBeforeUnload=oa.inactivityDurationBeforeUnloadSeconds;na.DisconnectionSource=oa.disconnectionSource;na.hadConnectivityIssuesDuringUnload=
oa.hadConnectivityIssuesDuringUnload;na.TimeFromLastStatusCode0=oa.timeFromLastStatusCode0;na.LastSilentReopenStartTime=oa.lastSilentReopenStartTime;na.LastSilentReopenEndTime=oa.lastSilentReopenEndTime;tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(na.ApiBeforeCloseNotificationEnabledOnUnload=oa.apiBeforeCloseNotificationEnabledOnUnload);return I.c(na)}h8g(oa,na){const dc=window.performance.timing.navigationStart-oa.timestamp;(oa=this.workbookHashedId===
oa.workbookHashedId&&dc<na)&&r.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return oa}static la(oa){oa.ea.nc.inWebPart||oa.da.Ha(410,new Jb(oa))}}Jb.oNi=10;Object(h.a)(Jb,"AppUnloadTelemetryManager",null,[419,2]);var xc=a(15);class Zc{constructor(oa){this.zNe=!1;this.BNe=null;this.$c=()=>{this.Cxj();rc.h(this.$).ga&&rc.h(this.$).ga.jS(this.$c)};this.Fj=(na,dc)=>{dc.na&&!this.x_d.has(dc.na.name)&&(this.x_d.add(dc.na.name),rc.h(this.$).ga&&(rc.h(this.$).ga.jS(this.$c),
rc.h(this.$).ga.qM(this.$c)))};this.$=oa;this.Thg=new Set;this.x_d=new Set;this.$.ua&&this.$.ua.na&&this.x_d.add(this.$.ua.na.name);rc.h(this.$).ga.qM(this.$c);this.$.ua.kg(this.Fj)}dispose(){this.$=null}Cxj(){this.BNe||this.t4g();const oa=rc.d(rc.h(this.$));if(!this.zNe){const na=xc.a.instance.Va(281).split(",");oa.push(...na);this.zNe=!0}for(const na of oa)na&&!this.Thg.has(na)&&(this.gIi(na),this.Thg.add(na))}gIi(oa){this.y5g(oa)}t4g(){this.BNe=Zc.Hwa("monospace");Zc.Hwa("sans-serif");Zc.Hwa("serif")}y5g(oa){Zc.Hwa(`${oa},${"monospace"}`);
Zc.Hwa(`${oa},${"sans-serif"}`);Zc.Hwa(`${oa},${"serif"}`)}static la(oa){if(tb.EwaSettings.ya(61)){const na=new Zc(oa);oa.da.Ha(210,na)}}static Hwa(oa){const na=document.createElement("div"),dc=document.createElement("div");na.style.cssText="position: absolute; overflow: auto; visibility: hidden;";Zc.$Hj(dc,oa);document.body.appendChild(na);na.appendChild(dc);dc.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";oa=dc.offsetWidth+"x"+dc.offsetHeight;document.body.removeChild(dc.parentNode);
return oa}static $Hj(oa,na){oa.style.cssText="display: inline; visibility: hidden;";oa.style.fontSize="100px";oa.style.fontWeight="normal";oa.style.fontStyle="normal";oa.style.letterSpacing="normal";oa.style.lineHeight="normal";oa.style.whiteSpace="nowrap";oa.style.fontFamily=na}}Object(h.a)(Zc,"FontTelemetryManager",null,[2]);var qd=a(242),Pd=a(174),le;(function(oa){oa[oa.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";oa[oa.reactSingleLineRibbon=1]="reactSingleLineRibbon";oa[oa.reactMultiLineRibbon=
2]="reactMultiLineRibbon";oa[oa.invalid=3]="invalid"})(le||(le={}));Object(h.b)("RibbonMode",le);var ke=a(111);class jf extends re.a{constructor(){super();this.bM=!1;this.jfe=this.ife=null;this.aFd=()=>{this.Dng()};this.j2i=()=>{pd.a.Ja(this.IZ);pd.a.Ja(this.Tm)};this.IZ=vd.a.instance.IJa();this.Tm=vd.a.instance.uH();this.IZ.la("visibilitychange",this.aFd);this.Tm.la("pagehide",this.j2i);this.Dng()}get oi(){return this.bM}get Xrf(){return this.ife}get Vmc(){return this.jfe}DHa(oa){this.addHandler("ekdh",
oa)}Pdb(oa){this.removeHandler("ekdh",oa)}yta(oa){this.addHandler("ekduh",oa)}sBa(oa){this.removeHandler("ekduh",oa)}AD(oa){return this.oi?!0:this.Vmc?Cb.getElapsedMilliseconds(this.Vmc,Zb.a.Ya.kc)<oa:!1}dispose(){pd.a.Ja(this.IZ);pd.a.Ja(this.Tm);super.dispose()}Dng(){this.bM="hidden"===window.document.visibilityState;this.oi?(this.raiseEvent("ekdh"),this.ife=Zb.a.Ya.kc):(this.raiseEvent("ekduh"),this.jfe=Zb.a.Ya.kc)}}Object(h.a)(jf,"DocumentVisibilityObserver",re.a,[430,2]);var nf=a(125);class pe{constructor(){this.longFramesOverThresholdOpsPercentage=
this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(h.a)(pe,"FramePerformanceData",null,[]);class Re{constructor(oa){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new pe;this.l2FramePerformanceData=new pe;this.l3FramePerformanceData=new pe;this.name=oa}}Object(h.a)(Re,"FramePerformanceDataGroup",null,[]);class bf{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName=
"FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(h.a)(bf,"FramePerformanceSessionEndsReport",null,[286]);class Pf{constructor(oa){this.rHd={};this.dia=null;this.Xhb=(na,dc)=>{na.longFramesOverThresholdOps++;na.maxLongFrameDuration=Math.max(na.maxLongFrameDuration,dc)};this.$e=new bf;this.ujh();oa.da.kb(276,()=>{bc.a(oa).$T(this.$e)})}ujh(){this.dia=new Re("AllGridOperationsData");this.$e.operationsGroups.push(this.dia);this.cub("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.cub("DragScroll",["DragScroll"]);this.cub("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.cub("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.cub("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}ttj(oa,na,dc,Rc){const Fd=this.L_h(oa);Fd&&(nf.b(this.$e.operationsGroups,de=>hb.a.equals(de.name,Fd.name,!1))||this.$e.operationsGroups.push(Fd),Fd.count++,this.GGc(na,Fd),this.CGc(dc,Fd),this.dia.count++,
this.GGc(na,this.dia),this.CGc(dc,this.dia),0<Rc&&this.u7j(Rc,Fd),0<=na&&this.L6j(na,Fd))}X7j(){for(const oa of this.$e.operationsGroups)Pf.P6j(oa)}cub(oa,na){oa=new Re(oa);for(const dc of na)this.rHd[dc]=oa}L_h(oa){return oa in this.rHd?this.rHd[oa]:null}L6j(oa,na){30>oa&&this.f2d(dc=>{dc.l1FramePerformanceData.fpsUnderThresholdOps++},na);15>oa&&this.f2d(dc=>{dc.l2FramePerformanceData.fpsUnderThresholdOps++},na);5>oa&&this.f2d(dc=>{dc.l3FramePerformanceData.fpsUnderThresholdOps++},na)}u7j(oa,na){100<=
oa&&(this.Yhb(na.l1FramePerformanceData,oa,this.Xhb),this.Yhb(this.dia.l1FramePerformanceData,oa,this.Xhb));300<=oa&&(this.Yhb(na.l2FramePerformanceData,oa,this.Xhb),this.Yhb(this.dia.l2FramePerformanceData,oa,this.Xhb));600<=oa&&(this.Yhb(na.l3FramePerformanceData,oa,this.Xhb),this.Yhb(this.dia.l3FramePerformanceData,oa,this.Xhb))}f2d(oa,na){na&&(oa(na),oa(this.dia))}Yhb(oa,na,dc){oa&&dc(oa,na)}GGc(oa,na){na.minFPS=-1===na.minFPS?oa:Math.min(na.minFPS,oa)}CGc(oa,na){na.maxFPS=Math.max(na.maxFPS,
oa)}static P6j(oa){Pf.F2d(oa.l1FramePerformanceData,oa.count);Pf.F2d(oa.l2FramePerformanceData,oa.count);Pf.F2d(oa.l3FramePerformanceData,oa.count)}static F2d(oa,na){oa.fpsUnderThresholdOpsPercentage=100*oa.fpsUnderThresholdOps/na;oa.longFramesOverThresholdOpsPercentage=100*oa.longFramesOverThresholdOps/na}}Object(h.a)(Pf,"FramePerformanceSessionEndsReportManager",null,[]);class pg{constructor(){this.f=null}}Object(h.a)(pg,"FpsDataWrapper",null,[]);class $f{constructor(oa=-1,na=-1){this.duration=
this.startSecond=0;this.startSecond=oa;this.duration=na}}Object(h.a)($f,"LongFrameData",null,[]);var Ya=a(356);class Db{constructor(oa=null,na=0,dc=-1,Rc=-1,Fd=0,de=-1,ne=0,cf=-1,Bf=-1,Af=null){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=oa;this.count=na;this.start=dc;this.end=Rc;this.Avg=Fd;this.Max=de;this.Min=Ya.a.rtg;this.longFrameCount=ne;this.coauth=cf||1;this.tfAppInt=Bf;this.Props=
Af;this.LFrame=null}}Object(h.a)(Db,"OperationFPSData",null,[]);var Wb=a(36),Bc=a(792);class Tc extends fa.a{constructor(oa){super();this.zqb=-1;this.jxd=0;this.Wya=new Date(0);this.cZ=null;this.vja={};this.Dva=new Rb.a;this.IQd=this.g$a=!1;this.l5a=null;this.vEc=this.zab=0;this.isSynthetic=!1;this.A1e=()=>{const na=new Date;var dc=na.getMinutes();const Rc=na.getSeconds();this.GEb&&na.getTime()-this.GEb.getTime()>this.rYj?(this.stop(),this.Bfd(na)):(dc!==this.jxd&&(this.Bfd(na),this.jxd=dc),this.g$a&&
(this.Le.oi?this.cZ[Rc]=Tc.U9b:(this.hPe(Rc),this.g$a=!1,this.Dva.clear(),this.vja={})),this.cZ[Rc]!==Tc.U9b&&(this.cZ[Rc]++,dc=na.getTime()-this.Wya.getTime(),dc>this.Zvf&&this.FIi(this.Wya,dc)),this.zqb=window.requestAnimationFrame(this.A1e),this.Wya=na)};this.zW=()=>{this.g$a=!0};this.VCf=()=>{this.pause()};this.XCf=()=>{this.IQd&&this.resume()};this.Pj=()=>{this.Ca.T5()&&this.D7j()};this.GEb=new Date;this.Le=new jf;this.Le.DHa(this.zW);v.AFrameworkApplication.JZc(this.VCf);v.AFrameworkApplication.KZc(this.XCf);
this.$=oa;this.Zvf=oa.xa.LongFrameThresholdMs;this.uKi="MoreThan_"+this.Zvf.toString()+"_Ms";this.qYj=oa.xa.ThresholdToEndOperationTrackingSeconds;this.rYj=oa.xa.ThresholdToStopFPSTrackingMS;this.Ca=rc.h(this.$).Ca;v.AFrameworkApplication.Yb&&v.AFrameworkApplication.Yb.IsSynthetic&&(this.isSynthetic=hb.a.compare(v.AFrameworkApplication.Yb[$d.a.isSynthetic],"True",!0)?!1:!0);this.Ca.vw(this.Pj);this.cQd();this.GIi=this.$.oma&&tb.EwaSettings.ya(504)}start(){this.IQd=!0;this.resume()}stop(){this.IQd=
!1;this.pause()}dispose(){this.stop();this.Le.Pdb(this.zW);v.AFrameworkApplication.zZf(this.VCf);v.AFrameworkApplication.AZf(this.XCf);pd.a.Ja(this.Le);this.Ca.sx(this.Pj);super.dispose()}hUj(oa,na){const dc=oa in this.vja?this.vja[oa]:null;this.GEb=new Date;this.start();const Rc=this.GEb.getSeconds(),Fd=Rc+this.qYj;dc&&Rc<=dc.end?(dc.count++,dc.end=Fd):(dc&&Rc>dc.end&&this.Dva.add(dc),this.vja[oa]=new Db(oa,1,Rc,Fd,void 0,void 0,void 0,this.$.ea.No.length,sc.PageLoadTrackingInfo.instance.Ywa(this.GEb),
na))}Nhh(){this.l5a||(this.Bfd(new Date),this.l5a=new Pf(this.$))}resume(){this.Clf()||!this.Ca.rO||this.isSynthetic||(this.g$a=this.Le.oi,this.Wya=new Date,this.jxd=this.Wya.getMinutes(),this.cQd(),this.hPe(this.Wya.getSeconds()),this.zqb=window.requestAnimationFrame(this.A1e))}Clf(){return 0<=this.zqb}pause(){this.Clf()&&(this.g$a||(this.iPe((new Date).getSeconds()),r.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.cZ.toString()}`)),window.cancelAnimationFrame(this.zqb),this.zqb=-1)}Bfd(oa){if(oa.getTime()-
this.Wya.getTime()<Tc.dOi&&(this.g$a&&this.iPe(this.Wya.getSeconds()),this.wwh(),0<this.Dva.count&&(oa={},oa.NonEmptyCellsCount=this.zab,oa.TextCellsCount=this.vEc,oa.xlfpsJson=Object(gb.a)(new pg,{f:this.Dva.toArray()}),oa.memoryInfo=this.BNi(),oa.zoom=Wb.a(this.$)?Wb.a(this.$).zoom:1,oa.RibbonMode=Pd.a(this.$)?le[Pd.a(this.$).vO]:Tc.invalid,oa.deviceMemory=navigator.deviceMemory||0,oa.hardwareConcurrency=navigator.hardwareConcurrency||0,oa=JSON.stringify(oa),r.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.cZ.toString()}`),
!this.isSynthetic))){if(wb.a.efa()){var na={};na.xlfpsJson=oa;this.$.Toa(rf.a.hdk,na,!1)}else r.ULS.sendTraceTag(388781010,0,50,`${oa}`);if(this.GIi)for(let dc of this.Dva){na=1E3>=this.zab?"0_1000":3E3>=this.zab?"1000_3000":"3000_inf";const Rc=new Map;Rc.set("Operation",dc.Op);Rc.set("BucketOfRenderedCells",na);G.Health.instance.recordKpiUsage(gd.a.longFrame,0,Ic.a.canvas,Rc);0<dc.longFrameCount&&G.Health.instance.recordKpiFailure(gd.a.longFrame,"LongFrame",!1,!0,Object(gb.a)(new U.a,{extendedProperties:Rc}));
3E4<dc.tfAppInt&&(0<dc.longFrameCount?xa.b().V0f(0,this.uKi,Rc):xa.b().W0f(0,Rc))}r.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${oa.length}`)}this.reset()}BNi(){const oa={};if(window.performance){const na=window.performance.memory;na&&(oa.jsHeapSizeLimit=na.jsHeapSizeLimit,oa.usedJSHeapSize=na.usedJSHeapSize,oa.totalJSHeapSize=na.totalJSHeapSize)}return oa}reset(){this.Dva.clear();this.vja={};this.cQd()}wwh(){if(this.cZ){for(const oa of Bc.a(this.vja)){const na=this.vja[oa];na.end=
Math.min(this.cZ.length-1,na.end);this.Dva.add(na)}this.G4g(this.Dva,this.cZ)}}G4g(oa,na){for(let dc of oa){let Rc=oa=0;if(dc.end<na.length){for(let Fd=dc.start;Fd<=dc.end;Fd++){const de=na[Fd];0<=de&&(dc.Max=Math.round(Math.max(dc.Max,de)),dc.Min=Math.round(Math.min(dc.Min,de)),oa+=de,Rc++)}0<Rc&&(dc.Avg=Math.round(oa/Rc));this.l5a&&this.l5a.ttj(dc.Op,dc.Min,dc.Max,dc.LFrame?dc.LFrame.duration:-1);dc.Props&&(this.v2j(dc),dc.Props=null)}}this.l5a&&this.l5a.X7j()}cQd(){this.cZ=Array(60).fill(0)}hPe(oa){oa++;
for(let na=0;na<oa;na++)this.cZ[na]=Tc.U9b}iPe(oa){for(;60>oa;oa++)this.cZ[oa]=Tc.U9b}FIi(oa,na){oa=oa.getSeconds();var dc=Bc.a(this.vja);if(0<dc.length)for(const Rc of dc)if(dc=this.vja[Rc],oa>=dc.start&&oa<dc.end)dc.LFrame?dc.LFrame.duration<na&&(dc.LFrame.startSecond=oa,dc.LFrame.duration=na,dc.longFrameCount++):(dc.LFrame=new $f(oa,na),dc.longFrameCount++)}D7j(){this.vEc=this.zab=0;for(const oa of rc.h(this.$).Un){const na=oa.KDa;for(let dc in na){const Rc=this.Ca.Ol(na[dc].hashCode);if(null===
Rc||void 0===Rc?0:Rc.qk)this.zab+=Rc.me.NonEmptyCellsCount,this.vEc+=Rc.me.TextValueCellsCount}}}v2j(oa){const na=oa.Props;if(K.a.$Ob in na&&na[K.a.$Ob]&&K.a.PQb in na){let dc;(dc=Object(E.a)(qd.a,na[K.a.PQb]))&&dc.continueWith(Rc=>{ke.TextEditorTelemetry.instance.sNg(oa.Op,oa.Min,!!oa.LFrame,oa.LFrame?oa.LFrame.duration:0,Rc.result)})}}}Tc.U9b=-1;Tc.dOi=6E4;Tc.invalid="Invalid";Object(h.a)(Tc,"FramePerformanceTracker",fa.a,[429,2]);class id extends yb.a{constructor(oa){super();this.$=oa;this.Mb()}create(){let oa=
this.$.da.Aa(263);oa||(oa=this.$.da.Ha(263,new Tc(this.$)));this.vb(oa)}static la(oa){oa.da.Ha(264,new id(oa))}}Object(h.a)(id,"FramePerformanceTrackerFactory",yb.a,[]);var k=a(1333),Ob=a(975);class kc{Dg(oa,na){return new Ob.a(oa,na)}Qc(oa,na){oa=this.Dg(oa,na);oa.start();return oa}}Object(h.a)(kc,"DefaultStopwatchBuilder",null,[191]);class wc{constructor(){this.Era=new kc}Dg(oa,na){return this.Era.Dg(oa,na)}Qc(oa,na){return this.Era.Qc(oa,na)}}Object(h.a)(wc,"StopwatchBuilder",null,[191]);var ad=
a(425),sd=a(940),Gd=a(941),Yd;(function(oa){oa[oa.actions=0]="actions";oa[oa.correlationStart=1]="correlationStart";oa[oa.reorderSheetOp=2]="reorderSheetOp";oa[oa.formatCellOp=3]="formatCellOp";oa[oa.copyOp=4]="copyOp";oa[oa.pasteOp=5]="pasteOp";oa[oa.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";oa[oa.instantaneousSetData=7]="instantaneousSetData";oa[oa.immediateSetData=8]="immediateSetData";oa[oa.dependentCellsCalc=9]="dependentCellsCalc";oa[oa.dependentCellsGraphStat=10]="dependentCellsGraphStat";
oa[oa.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";oa[oa.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";oa[oa.gridBlockUpdates=13]="gridBlockUpdates";oa[oa.browserAppStart=14]="browserAppStart";oa[oa.linkedObjects=15]="linkedObjects";oa[oa.longFrames=16]="longFrames";oa[oa.task=17]="task";oa[oa.conflictInEditing=18]="conflictInEditing";oa[oa.incomingPresenceData=19]="incomingPresenceData";oa[oa.editorTableDelay=20]="editorTableDelay";oa[oa.presenceStartup=
21]="presenceStartup";oa[oa.presenceDelete=22]="presenceDelete";oa[oa.editorEvent=23]="editorEvent";oa[oa.editorTime=24]="editorTime";oa[oa.gridScreenReaderOps=25]="gridScreenReaderOps";oa[oa.sendPresenceToService=26]="sendPresenceToService";oa[oa.IME=27]="IME";oa[oa.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";oa[oa.customizeStatusBar=29]="customizeStatusBar";oa[oa.clientWebRequests=30]="clientWebRequests";oa[oa.showCommentTaskPane=31]="showCommentTaskPane";oa[oa.applyThreadedCommentChange=
32]="applyThreadedCommentChange";oa[oa.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";oa[oa.findNextOrPreviousComment=34]="findNextOrPreviousComment";oa[oa.goto=35]="goto";oa[oa.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";oa[oa.richApiInvocation=37]="richApiInvocation";oa[oa.fxLibrary=38]="fxLibrary";oa[oa.embeddedApiSession=39]="embeddedApiSession";oa[oa.numberFormattingCalculator=40]="numberFormattingCalculator";oa[oa.requestDataAfterSend=41]="requestDataAfterSend";oa[oa.floatingObjectsStopwatchData=
42]="floatingObjectsStopwatchData";oa[oa.copy=43]="copy";oa[oa.paste=44]="paste";oa[oa.dragDrop=45]="dragDrop";oa[oa.clearCopyState=46]="clearCopyState";oa[oa.webWorkerRecalcStats=47]="webWorkerRecalcStats";oa[oa.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";oa[oa.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";oa[oa.customSort=50]="customSort";oa[oa.namedSheetViewUserAction=51]="namedSheetViewUserAction";oa[oa.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";
oa[oa.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";oa[oa.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";oa[oa.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";oa[oa.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";oa[oa.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";oa[oa.raiseEventsAndGenerateBlockRequests=58]="raiseEventsAndGenerateBlockRequests";oa[oa.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(Yd||
(Yd={}));Object(h.b)("UsageTable",Yd);var ve=a(430),De=a(481),Pe=a(613),Xe=a(666),yf=a(282);class ug extends Sys.EventArgs{constructor(){super();this.tQi=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(h.a)(ug,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class ag{constructor(oa,na=1){this.qRd=na;this.total=oa}get average(){return this.total/this.qRd}iah(oa){return new ag(this.total+oa.total,this.qRd+oa.qRd)}static L1g(oa,na){return`${oa}_${na}`}}Object(h.a)(ag,"StopwatchAverage",
null,[]);var wg;(function(oa){oa[oa.longFrame=0]="longFrame";oa[oa.longGetRange=1]="longGetRange";oa[oa.longJsTask=2]="longJsTask";oa[oa.viewportCalculationLoops=3]="viewportCalculationLoops"})(wg||(wg={}));Object(h.b)("UtrKpiVeto",wg);class Bg{static D6a(oa){return Enum.toString(wg,oa)}}Bg.VVa="UTR";Object(h.a)(Bg,"KpiConstants",null,[]);class qg{}qg.Epg="UTRVetoName";qg.wpg="UTRErrorName";qg.j$j="UTROperationName";qg.G3d="UTRDuration";qg.k$j="UTREndedInPhase";qg.Bpg="UTRMessage";qg.Dpg="UtrUnavailabilityType";
qg.operationName="OperationName";qg.duration="Duration";qg.message="Message";Object(h.a)(qg,"UtrAdditionalData",null,[]);class Gf{}Gf.ebk="VetoLike";Gf.vuh="E2EOperationPerf";Gf.Ytj="RequestPerf";Gf.q3j="UnavailabilityDurations";Object(h.a)(Gf,"UtrTypes",null,[]);class Rg{gMb(oa,na,dc=null){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(dc=dc?Object(gb.a)(new U.a,{extendedProperties:dc}):null,oa=Bg.D6a(oa),G.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+oa,na,!1,
!0,"",dc))}SNb(oa,na,dc,Rc,Fd,de){de[Bg.VVa]=Gf.ebk;de[qg.Epg]=Bg.D6a(Rc);de[qg.wpg]=Fd;r.ULS.sendTraceTag(oa,na,dc,he.a.Fc(de));delete de[Bg.VVa];delete de[qg.Epg];delete de[qg.wpg]}}Object(h.a)(Rg,"UtrKpiVetoReporter",null,[]);class lh{lMb(oa,na=null){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||G.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Bg.D6a(oa),0,"",na)}gMb(oa,na,dc=null){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(oa=Bg.D6a(oa),
G.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+oa,na,!1,!0,this.L7c(dc)))}htj(oa,na=null){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||G.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Bg.D6a(oa),"",this.L7c(na))}gtj(oa,na,dc=null){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(oa=Bg.D6a(oa),G.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+oa,na,!1,!0,"",this.L7c(dc)))}L7c(oa){return oa?Object(gb.a)(new U.a,{extendedProperties:oa}):
null}}Object(h.a)(lh,"UtrKpiVetoUsageReporter",null,[]);class qe{yxc(oa,na,dc=null){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||G.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+oa,"",Object(gb.a)(new U.a,{extendedProperties:dc,durationMs:na}))}Gxc(oa,na,dc=null){tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(na?G.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+oa,"",Object(gb.a)(new U.a,{extendedProperties:dc})):
G.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+oa,"",!1,!1,"",Object(gb.a)(new U.a,{extendedProperties:dc})))}PNb(oa,na,dc,Rc,Fd,de,ne,...cf){ne=String.format(ne,...cf);cf={};cf[Bg.VVa]=Gf.vuh;cf[qg.j$j]=Rc;cf[qg.k$j]=Fd;cf[qg.G3d]=de;cf[qg.Bpg]=ne;r.ULS.sendTraceTag(oa,na,dc,he.a.Fc(cf))}RNb(oa,na,dc,Rc,Fd,de){this.p$f(de,Rc,Fd);r.ULS.sendTraceTag(oa,na,dc,he.a.Fc(de));this.wph(de)}QNb(oa,na,dc,Rc,Fd,de,...ne){de=String.format(de,...ne);ne={};this.p$f(ne,Rc,Fd,de);r.ULS.sendTraceTag(oa,
na,dc,he.a.Fc(ne))}Izc(oa,na,dc,Rc){Rc[Bg.VVa]=Gf.Ytj;r.ULS.sendTraceTag(oa,na,dc,he.a.Fc(Rc));delete Rc[Bg.VVa]}p$f(oa,na,dc,Rc=null){oa[Bg.VVa]=Gf.q3j;oa[qg.Dpg]=na;oa[qg.G3d]=dc;Rc&&(oa[qg.Bpg]=Rc)}wph(oa){delete oa[Bg.VVa];delete oa[qg.Dpg];delete oa[qg.G3d]}}Object(h.a)(qe,"UtrOperationPerfReporter",null,[]);class Ja extends re.a{constructor(oa,na=null,dc=null,Rc=null,Fd=null,de=!1){super();this.vIh=[K.a.pAe,K.a.TTe,K.a.UTe,K.a.lic,K.a.Qnc,K.a.EGi,K.a.renderCachedContent,K.a.renderServerContent,
K.a.l8b,K.a.Eyj,K.a.W4f,K.a.X4f,K.a.lCj];this.Enb=this.PEa=this.jSb=this.jib=this.qge=this.rze=this.TYa=this.rne=null;this.SPf=this.nAe=!1;this.Apg=this.zpg=this.Cpg=this.QPd=this.Rqg=null;this.LKf=(ne,cf)=>{for(ne=0;ne<cf.entries.length;ne++){const Kf=cf.entries[ne];Kf.url=z.a.removeParameter(Kf.url,v.AFrameworkApplication.PP);var Bf=z.a.Fea(Kf.url);!tb.EwaSettings.ya(426)&&this.Lyi(Kf.url,Bf)&&(Kf.behavior=1);if("img"===Kf.iu.initiatorType&&Bf.endsWith(sd.a.abd)){var Af=z.a.j_(Kf.url,sd.a.$ad),
mg=z.a.j_(Kf.url,sd.a.bbd);Kf.oba=`${Kf.oba}imageID=${Af}, imgStateID=${mg}`}Af=Kf.iu.transferSize;let Zf;mg=Kf.iu.decodedBodySize;void 0!==Af&&null!==Af&&void 0!==mg&&null!==mg?Zf=0===Af&&0<mg:void 0!==Af&&null!==Af&&(Zf=0===Af);sc.PageLoadTrackingInfo.instance.wOg(Bf,Math.round(Kf.iu.fetchStart),Math.round(Kf.iu.responseEnd),Zf,this.sAi);hb.a.contains(Bf,K.a.richTextEditor,!0)&&(Bf=ke.TextEditorTelemetry.instance,Bf.ME(K.a.vvj,Math.round(Kf.iu.fetchStart)),Bf.ME(K.a.xvj,Math.round(Kf.iu.responseEnd)))}};
this.zW=()=>{const ne=this.S8;for(let cf in ne)ne[cf].h=!0};this.userSessionId=oa;this.G2a=na=na||new Pe.a;this.Hh=dc||Zb.a.Ya;this.dVj=Rc||this;this.Le=Fd;this.sAi=de;this.uNe=na.U$a();this.Le&&this.Le.DHa(this.zW)}get S8(){return this.rne||(this.rne={})}get xMe(){return this.jib||this.uNe}get HMe(){return this.PEa||Ja.UAf}get dZd(){return this.rze=this.rze||{}}get Rtc(){return this.TYa||"undefined"===typeof Stw?this.TYa:this.TYa=Stw.swpc}get Vvf(){return this.qge=this.qge||{}}get DSa(){return this.Enb||
(this.Enb=Xa.a.instance.$b("Common.NetworkTiming.IResourceTimingLogger"))}get ypg(){return this.zpg||(this.zpg=new Rg)}get nib(){return this.Cpg||(this.Cpg=new qe)}get mHc(){return this.Apg||(this.Apg=new lh)}ZCc(oa,na,dc,Rc,Fd=null){if(this.S8[dc])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.S8[dc]=this.VLe(oa,na,dc,Rc,Fd)}lac(oa,na){const dc=this.S8[oa];dc&&(this.LHe(dc,na),this.p5j(dc),delete this.S8[oa])}oZf(oa){delete this.S8[oa]}kfg(oa,na){this.jib||this.Zeg(oa,
na)}Ueg(){this.kfg(Ja.Lmd,this.Hh.Ce)}HSe(oa,na=!1){if(this.jib){if(this.PEa===Ja.MHd||this.PEa===Ja.Lmd){const dc=M.a.instance;dc.userSessionId=this.userSessionId;if(this.PEa===Ja.MHd){this.nAe||(this.Tma(oa.m,Object(X.a)(dc,dc.Ojj,"recordContentFetchEnd")),this.nAe=!0);if(na){this.SPf||(this.Tma(oa.m,Object(X.a)(dc,dc.$jj,"recordPerceivedContentDisplayed")),this.SPf=!0);return}this.Tma(oa.m,Object(X.a)(dc,dc.Njj,"recordContentDisplayed"))}else this.PEa===Ja.Lmd&&(na=this.S8[this.jSb])&&this.Tma(yf.a(oa,
na.s),Object(X.a)(dc,dc.Vjj,"recordInteractivityContentDisplayed"),!1)}this.lac(this.jSb,oa);this.jSb=this.PEa=this.jib=null}}Tma(oa,na,dc=!0){M.a.eQ&&Object(ad.a)(Xe.PerformanceClock,Zb.a.Ya)&&dc&&(oa+=window.performance.timing.navigationStart);na(oa)}Sj(oa){return ve.a(oa)}gf(oa,na,dc=!1){try{if(this.Vvf[Yd[oa]]=!0,dc){var Rc=r.ULS,Fd=Rc.sendTraceTag;const Mc={};let Jf=null;switch(oa){case 0:Jf="Actions";var de=na.a;null!=de&&(Mc.Id=de);var ne=null==na.b?null:na.b;null!=ne&&(Mc.Operation=ne);var cf=
na.c;null!=cf&&(Mc.Target=cf);var Bf=null==na.d?null:na.d.toString();null!=Bf&&(Mc.StartTime=Bf);var Af=null==na.e?null:na.e.toString();null!=Af&&(Mc.Duration=Af);var mg=na.f;null!=mg&&(Mc.CorrelationId=mg);var Kf=na.g;null!=Kf&&(Mc.ParentAction=Kf);var Zf=null==na.h?null:na.h.toString();null!=Zf&&(Mc.DocumentHidden=Zf);break;case 1:Jf="CorrelationStart";var Ug=na.a;null!=Ug&&(Mc.CorrelationId=Ug);var eg=na.b;null!=eg&&(Mc.UserSessionId=eg);var Tg=na.c;null!=Tg&&(Mc.UserAction=Tg);break;case 2:Jf=
"ReorderSheetOp";var Cg=na.a;null!=Cg&&(Mc.UserSessionId=Cg);var Rf=null==na.b?null:na.b.toString();null!=Rf&&(Mc.IsDragReorder=Rf);var Mg=null==na.c?null:na.c.toString();null!=Mg&&(Mc.DocumentUp=Mg);var eh=null==na.d?null:na.d.toString();null!=eh&&(Mc.OldIndex=eh);var fh=null==na.e?null:na.e.toString();null!=fh&&(Mc.NewIndex=fh);var Gg=null==na.f?null:na.f.toString();null!=Gg&&(Mc.TotalSheets=Gg);break;case 3:Jf="FormatCellOp";var Ng=na.a;null!=Ng&&(Mc.UserSessionId=Ng);var mh=null==na.b?null:na.b.toString();
null!=mh&&(Mc.TaskId=mh);var sh=null==na.c?null:na.c.toString();null!=sh&&(Mc.NumberOfRanges=sh);var th=na.d;null!=th&&(Mc.Ranges=th);var oh=na.e;null!=oh&&(Mc.ActiveCell=oh);var ih=null==na.f?null:na.f.toString();null!=ih&&(Mc.ActionId=ih);var Yg=na.g;null!=Yg&&(Mc.CommandParameters=Yg);var Jg=na.h;null!=Jg&&(Mc.UserActionStopwatchId=Jg);break;case 4:Jf="CopyOp";var sf=na.a;null!=sf&&(Mc.UserSessionId=sf);var ja=null==na.b?null:na.b.toString();null!=ja&&(Mc.IsChrome=ja);var vb=null==na.c?null:na.c.toString();
null!=vb&&(Mc.IsIE=vb);var nc=null==na.d?null:na.d.toString();null!=nc&&(Mc.IsFromUI=nc);var Ec=null==na.e?null:na.e.toString();null!=Ec&&(Mc.IsCopyInLoadedRange=Ec);var ud=null==na.f?null:na.f.toString();null!=ud&&(Mc.IsRepeatedCopy=ud);var Od=null==na.g?null:na.g.toString();null!=Od&&(Mc.IsClipboarAccessSupported=Od);var ge=null==na.h?null:na.h.toString();null!=ge&&(Mc.IsClipboarAccessInstallationSupported=ge);var ba=null==na.i?null:na.i.toString();null!=ba&&(Mc.RibbonCommand=ba);var eb=null==na.j?
null:na.j.toString();null!=eb&&(Mc.CutCopyPasteFlags=eb);var $b=null==na.k?null:na.k.toString();null!=$b&&(Mc.IsDrag=$b);var uc=null==na.l?null:na.l.toString();null!=uc&&(Mc.IsIeBeforeAlowDenyPopUp=uc);var md=na.m;null!=md&&(Mc.IsPasteMatchCopy=md);var Rd=na.n;null!=Rd&&(Mc.WaitMessageInClipboard=Rd);var xe=null==na.o?null:na.o.toString();null!=xe&&(Mc.CallCount=xe);break;case 5:Jf="PasteOp";var Ke=na.a;null!=Ke&&(Mc.UserSessionId=Ke);var Ye=null==na.b?null:na.b.toString();null!=Ye&&(Mc.IsChrome=
Ye);var qf=null==na.c?null:na.c.toString();null!=qf&&(Mc.IsIE=qf);var Sf=null==na.d?null:na.d.toString();null!=Sf&&(Mc.IsCopyActive=Sf);var If=null==na.e?null:na.e.toString();null!=If&&(Mc.IsFromUI=If);var hf=null==na.f?null:na.f.toString();null!=hf&&(Mc.IsClipboarAccessSupported=hf);var ng=null==na.g?null:na.g.toString();null!=ng&&(Mc.IsClipboarAccessInstallationSupported=ng);var xg=null==na.h?null:na.h.toString();null!=xg&&(Mc.RibbonCommand=xg);var rg=null==na.i?null:na.i.toString();null!=rg&&(Mc.CutCopyPasteFlags=
rg);var tg=na.j;null!=tg&&(Mc.WaitMessageInClipboard=tg);var gh=na.k;null!=gh&&(Mc.PopupDialog=gh);var Nf=na.l;null!=Nf&&(Mc.SimplePopupMessage=Nf);var uh=na.m;null!=uh&&(Mc.DialogCloseButton=uh);var vh=na.n;null!=vh&&(Mc.UserPressedInstallLink=vh);var wh=null==na.o?null:na.o.toString();null!=wh&&(Mc.CallCount=wh);break;case 6:Jf="GetNumberViewModelDataOp";var xh=na.a;null!=xh&&(Mc.UserSessionId=xh);var ji=na.b;null!=ji&&(Mc.NumberFormatOptionsPreviousOutputJson=ji);var Mf=na.c;null!=Mf&&(Mc.NumberFormatOptionsNewInputJson=
Mf);break;case 7:Jf="InstantaneousSetData";var zh=na.a;null!=zh&&(Mc.Id=zh);var Fh=null==na.b?null:na.b.toString();null!=Fh&&(Mc.WasEmpty=Fh);var ki=null==na.c?null:na.c.toString();null!=ki&&(Mc.ValueNotChanged=ki);var Uh=na.d;null!=Uh&&(Mc.Source=Uh);var ai=null==na.e?null:na.e.toString();null!=ai&&(Mc.ProcessingCompleted=ai);break;case 8:Jf="ImmediateSetData";var ye=na.a;null!=ye&&(Mc.ClientStopwatchId=ye);var L=na.b;null!=L&&(Mc.Operation=L);var ta=na.c;null!=ta&&(Mc.Parameters=ta);var Va=null==
na.d?null:na.d.toString();null!=Va&&(Mc.WasUpdatedByImmediate=Va);var Mb=null==na.e?null:na.e.toString();null!=Mb&&(Mc.areHtmlElementsEqualClientComparison=Mb);var ic=null==na.f?null:na.f.toString();null!=ic&&(Mc.WasDecisionMadeByHtmlComparison=ic);var Gc=null==na.g?null:na.g.toString();null!=Gc&&(Mc.IsNumeric=Gc);var Hc=null==na.h?null:na.h.toString();null!=Hc&&(Mc.IsDateTime=Hc);var kd=null==na.i?null:na.i.toString();null!=kd&&(Mc.HasCurrencySymbol=kd);var Yc=null==na.j?null:na.j.toString();null!=
Yc&&(Mc.HasPercentSymbol=Yc);var bd=null==na.k?null:na.k.toString();null!=bd&&(Mc.IsFunc=bd);var xd=null==na.l?null:na.l.toString();null!=xd&&(Mc.DiffInWrappingWhitespace=xd);var Zd=na.m;null!=Zd&&(Mc.ImmediatePattern=Zd);var ee=null==na.n?null:na.n.toString();null!=ee&&(Mc.TextAlignmentMatch=ee);var Ve=null==na.o?null:na.o.toString();null!=Ve&&(Mc.FontColorMatch=Ve);var He=null==na.p?null:na.p.toString();null!=He&&(Mc.FormulaTextMatch=He);var Be=null==na.q?null:na.q.toString();null!=Be&&(Mc.isFormula=
Be);var Cf=na.r;null!=Cf&&(Mc.FormulaText=Cf);var df=na.s;null!=df&&(Mc.InstantaneousPattern=df);var uf=null==na.t?null:na.t.toString();null!=uf&&(Mc.AreHtmlInnerTextElementsEqualClientComparison=uf);var Hf=na.u;null!=Hf&&(Mc.HtmlComparisonDecision=Hf);break;case 9:Jf="DependentCellsCalc";var ef=na.a;null!=ef&&(Mc.CalcStatus=ef);var mf=null==na.b?null:na.b.toString();null!=mf&&(Mc.SuccessfullyCalculatedRanges=mf);var Ff=null==na.c?null:na.c.toString();null!=Ff&&(Mc.RangesSkipped=Ff);var lg=null==
na.d?null:na.d.toString();null!=lg&&(Mc.TotalErrors=lg);var vg=null==na.e?null:na.e.toString();null!=vg&&(Mc.Partial=vg);var Xc=null==na.f?null:na.f.toString();null!=Xc&&(Mc.Canceled=Xc);var Hd=null==na.g?null:na.g.toString();null!=Hd&&(Mc.Aggregate=Hd);var Kg=null==na.h?null:na.h.toString();null!=Kg&&(Mc.Unknown=Kg);var li=null==na.i?null:na.i.toString();null!=li&&(Mc.UnavailableData=li);var Vh=null==na.j?null:na.j.toString();null!=Vh&&(Mc.Cycle=Vh);var Wh=null==na.k?null:na.k.toString();null!=Wh&&
(Mc.NotImplemented=Wh);var Xh=null==na.l?null:na.l.toString();null!=Xh&&(Mc.InvalidInput=Xh);var Gh=null==na.m?null:na.m.toString();null!=Gh&&(Mc.AreDepCells=Gh);break;case 10:Jf="DependentCellsGraphStat";var Ni=null==na.a?null:na.a.toString();null!=Ni&&(Mc.ParsedFormulas=Ni);var Oi=null==na.b?null:na.b.toString();null!=Oi&&(Mc.GraphNodes=Oi);var Nh=null==na.c?null:na.c.toString();null!=Nh&&(Mc.GraphArcs=Nh);var Pi=null==na.d?null:na.d.toString();null!=Pi&&(Mc.AnalyzedBlocks=Pi);var ej=null==na.e?
null:na.e.toString();null!=ej&&(Mc.IterationId=ej);var zi=na.f;null!=zi&&(Mc.UniqueId=zi);var ci=null==na.g?null:na.g.toString();null!=ci&&(Mc.Aborted=ci);break;case 11:Jf="DependentCellsGraphSectionStat";var Ai=null==na.a?null:na.a.toString();null!=Ai&&(Mc.IterationId=Ai);var Oh=na.b;null!=Oh&&(Mc.BlockHash=Oh);var Dg=na.c;null!=Dg&&(Mc.Functions=Dg);var Hh=na.d;null!=Hh&&(Mc.Operators=Hh);var Qi=null==na.e?null:na.e.toString();null!=Qi&&(Mc.CrossDocRefs=Qi);var Ih=null==na.f?null:na.f.toString();
null!=Ih&&(Mc.CrossSheetRefs=Ih);var Ri=null==na.g?null:na.g.toString();null!=Ri&&(Mc.ErrRefs=Ri);var di=null==na.h?null:na.h.toString();null!=di&&(Mc.LargeRanges=di);var Pg=null==na.i?null:na.i.toString();null!=Pg&&(Mc.NameRefs=Pg);var ei=null==na.j?null:na.j.toString();null!=ei&&(Mc.ParserErrors=ei);var tf=null==na.k?null:na.k.toString();null!=tf&&(Mc.RowRefs=tf);var Ph=null==na.l?null:na.l.toString();null!=Ph&&(Mc.ColumnRefs=Ph);var kh=null==na.m?null:na.m.toString();null!=kh&&(Mc.TableRefs=kh);
var $g=na.n;null!=$g&&(Mc.UniqueId=$g);var Qg=null==na.o?null:na.o.toString();null!=Qg&&(Mc.UnreachableReferences=Qg);break;case 12:Jf="GetRangeContentPrefetchFailures";var Eg=na.a;null!=Eg&&(Mc.UserSessionId=Eg);var mi=na.b;null!=mi&&(Mc.ClientStopwatchId=mi);var Yh=null==na.c?null:na.c.toString();null!=Yh&&(Mc.StateId=Yh);break;case 13:Jf="GridBlockUpdates";var fi=na.a;null!=fi&&(Mc.UserSessionId=fi);var Qh=na.b;null!=Qh&&(Mc.CorrelationId=Qh);var ni=na.c;null!=ni&&(Mc.Operation=ni);var Bi=null==
na.d?null:na.d.toString();null!=Bi&&(Mc.PerformanceType=Bi);var oi=na.e;null!=oi&&(Mc.BlockHash=oi);var Si=null==na.f?null:na.f.toString();null!=Si&&(Mc.DurationInMs=Si);break;case 14:Jf="BrowserAppStart";var Ti=null==na.a?null:Gd.a.Jua(na.a.getTime());null!=Ti&&(Mc.ScriptExecutionStart=Ti);var dh=na.b;null!=dh&&(Mc.UserSessionId=dh);var Ci=na.c;null!=Ci&&(Mc.ClockMechanism=Ci);var Ui=null==na.d?null:na.d.toString();null!=Ui&&(Mc.ScreenDPI=Ui);var Vi=null==na.e?null:na.e.toString();null!=Vi&&(Mc.NavigationToScriptExecutionDelta=
Vi);break;case 15:Jf="LinkedObjects";var Wi=na.a;null!=Wi&&(Mc.ChildId=Wi);var Bh=na.b;null!=Bh&&(Mc.ParentId=Bh);var Di=na.c;null!=Di&&(Mc.ChildTable=Di);var Ei=na.d;null!=Ei&&(Mc.ParentTable=Ei);break;case 16:Jf="LongFrames";var Xi=null==na.a?null:Gd.a.Jua(na.a.getTime());null!=Xi&&(Mc.StartTime=Xi);var Rh=null==na.b?null:na.b.toString();null!=Rh&&(Mc.DurationInMs=Rh);break;case 17:Jf="Task";var Sh=na.a;null!=Sh&&(Mc.StopwatchId=Sh);var Lh=null==na.b?null:na.b.toString();null!=Lh&&(Mc.Status=Lh);
var pi=null==na.c?null:na.c.toString();null!=pi&&(Mc.CreateTime=pi);var Yi=null==na.d?null:na.d.toString();null!=Yi&&(Mc.TaskId=Yi);break;case 18:Jf="ConflictInEditing";var kg=na.a;null!=kg&&(Mc.OtherUserState=kg);var Ch=na.b;null!=Ch&&(Mc.UserSessionId=Ch);var qh=null==na.c?null:Gd.a.Jua(na.c.getTime());null!=qh&&(Mc.ConflictTime=qh);break;case 19:Jf="IncomingPresenceData";var Fi=na.a;null!=Fi&&(Mc.UserSessionId=Fi);var gi=na.b;null!=gi&&(Mc.UserId=gi);var Dh=null==na.c?null:na.c.toString();null!=
Dh&&(Mc.Disconnected=Dh);var fj=null==na.d?null:Gd.a.Jua(na.d.getTime());null!=fj&&(Mc.ReceivedTime=fj);break;case 20:Jf="EditorTableDelay";var qi=na.a;null!=qi&&(Mc.UserSessionId=qi);var Ag=na.b;null!=Ag&&(Mc.UserId=Ag);var ri=null==na.c?null:na.c.toString();null!=ri&&(Mc.Received=ri);var Gi=null==na.d?null:na.d.toString();null!=Gi&&(Mc.DurationInMs=Gi);var si=null==na.e?null:na.e.toString();null!=si&&(Mc.NotAloneAtLogTime=si);var ti=null==na.f?null:Gd.a.Jua(na.f.getTime());null!=ti&&(Mc.Time=ti);
break;case 21:Jf="PresenceStartup";var Hi=na.a;null!=Hi&&(Mc.UserSessionId=Hi);var Ii=null==na.b?null:na.b.toString();null!=Ii&&(Mc.EverReceived=Ii);var Ji=null==na.c?null:na.c.toString();null!=Ji&&(Mc.NotAloneOnOpen=Ji);var Vg=null==na.d?null:na.d.toString();null!=Vg&&(Mc.NotAloneAtLogTime=Vg);var Ki=null==na.e?null:na.e.toString();null!=Ki&&(Mc.EditorCount=Ki);var nh=null==na.f?null:na.f.toString();null!=nh&&(Mc.WorkbookOpenToFirstReceivedInMs=nh);break;case 22:Jf="PresenceDelete";var Zh=na.a;null!=
Zh&&(Mc.UserSessionId=Zh);var Zi=na.b;null!=Zi&&(Mc.UserId=Zi);var Jh=na.c;null!=Jh&&(Mc.Context=Jh);var Li=na.d;null!=Li&&(Mc.Reason=Li);var Mh=null==na.e?null:Gd.a.Jua(na.e.getTime());null!=Mh&&(Mc.Time=Mh);break;case 23:Jf="EditorEvent";var $i=na.a;null!=$i&&(Mc.UserSessionId=$i);var gj=na.b;null!=gj&&(Mc.UserId=gj);var cg=na.c;null!=cg&&(Mc.Context=cg);var hi=null==na.d?null:Gd.a.Jua(na.d.getTime());null!=hi&&(Mc.Time=hi);break;case 24:Jf="EditorTime";var aj=na.a;null!=aj&&(Mc.UserSessionId=aj);
var ui=na.b;null!=ui&&(Mc.UserId=ui);var $h=null==na.c?null:na.c.toString();null!=$h&&(Mc.DurationInMs=$h);break;case 25:Jf="GridScreenReaderOps";var S=na.a;null!=S&&(Mc.UserSessionId=S);var Wa=na.b;null!=Wa&&(Mc.CommandTaskId=Wa);var xb=null==na.c?null:na.c.toString();null!=xb&&(Mc.CommandId=xb);var fc=null==na.d?null:na.d.toString();null!=fc&&(Mc.ClientSideOnly=fc);var Ac=null==na.e?null:na.e.toString();null!=Ac&&(Mc.DurationInMS=Ac);var Uc=null==na.f?null:na.f.toString();null!=Uc&&(Mc.ReachedMaxReadoutCells=
Uc);var fd=null==na.g?null:na.g.toString();null!=fd&&(Mc.RequstedCellCount=fd);var dd=null==na.h?null:na.h.toString();null!=dd&&(Mc.NonEmptyCellCount=dd);var Fc=null==na.i?null:na.i.toString();null!=Fc&&(Mc.Succeeded=Fc);var od=null==na.j?null:na.j.toString();null!=od&&(Mc.Canceled=od);var zd=na.k;null!=zd&&(Mc.ErrorType=zd);break;case 26:Jf="SendPresenceToService";var Id=na.a;null!=Id&&(Mc.UserSessionId=Id);var Ld=null==na.b?null:na.b.toString();null!=Ld&&(Mc.TotalCount=Ld);var ae=null==na.c?null:
na.c.toString();null!=ae&&(Mc.SendCount=ae);break;case 27:Jf="IME";var Fe=na.a;null!=Fe&&(Mc.UserSessionId=Fe);break;case 28:Jf="FreezePaneFloatingObjects";var Le=na.a;null!=Le&&(Mc.UserSessionId=Le);var Ef=null==na.b?null:na.b.toString();null!=Ef&&(Mc.ObjectType=Ef);var Xf=na.c;null!=Xf&&(Mc.ObjectID=Xf);var og=null==na.d?null:na.d.toString();null!=og&&(Mc.SpannedPanesCount=og);break;case 29:Jf="CustomizeStatusBar";var pf=na.a;null!=pf&&(Mc.UserSessionId=pf);var jg=na.b;null!=jg&&(Mc.UIControlName=
jg);var bg=null==na.c?null:na.c.toString();null!=bg&&(Mc.IsControlVisible=bg);break;case 30:Jf="ClientWebRequests";var zg=na.a;null!=zg&&(Mc.Path=zg);var Zg=na.b;null!=Zg&&(Mc.ProxyStopwatchId=Zg);var fg=na.c;null!=fg&&(Mc.RequestStatus=fg);var Sg=null==na.d?null:na.d.toString();null!=Sg&&(Mc.ResponseSizeInBytes=Sg);var rh=na.e;null!=rh&&(Mc.ClientRequestId=rh);var hh=null==na.f?null:na.f.toString();null!=hh&&(Mc.StateId=hh);break;case 31:Jf="ShowCommentTaskPane";var vf=na.a;null!=vf&&(Mc.UserSessionId=
vf);var Uf=null==na.b?null:na.b.toString();null!=Uf&&(Mc.IsFromKeyboardShortcut=Uf);var ff=null==na.c?null:na.c.toString();null!=ff&&(Mc.IsShowPane=ff);var Of=null==na.d?null:na.d.toString();null!=Of&&(Mc.ShowForDeepLink=Of);var Wf=null==na.e?null:na.e.toString();null!=Wf&&(Mc.DeepLinkFound=Wf);break;case 32:Jf="ApplyThreadedCommentChange";var hg=na.a;null!=hg&&(Mc.UserSessionId=hg);var Qf=null==na.b?null:na.b.toString();null!=Qf&&(Mc.Operation=Qf);var Tf=na.c;null!=Tf&&(Mc.CommentId=Tf);var Yf=null==
na.d?null:na.d.toString();null!=Yf&&(Mc.CommentsCount=Yf);break;case 33:Jf="UpgradeLegacyCommentsChange";var yg=na.a;null!=yg&&(Mc.UserSessionId=yg);var Ig=null==na.b?null:na.b.toString();null!=Ig&&(Mc.OperationSuccessful=Ig);break;case 34:Jf="FindNextOrPreviousComment";var kf=na.a;null!=kf&&(Mc.UserSessionId=kf);var wi=null==na.b?null:na.b.toString();null!=wi&&(Mc.Succeeded=wi);break;case 35:Jf="Goto";var xi=na.a;null!=xi&&(Mc.UserSessionId=xi);var Mi=null==na.b?null:na.b.toString();null!=Mi&&(Mc.IsSucceeded=
Mi);var yi=null==na.c?null:na.c.toString();null!=yi&&(Mc.IsNOVMode=yi);break;case 36:Jf="LaunchOfficeAddInDialog";var Og=na.a;null!=Og&&(Mc.UserSessionId=Og);var ch=na.b;null!=ch&&(Mc.SourceId=ch);var jh=na.c;null!=jh&&(Mc.SourceLabel=jh);var ig=na.d;null!=ig&&(Mc.Flight=ig);var Wg=na.e;null!=Wg&&(Mc.Experiment=Wg);var ph=na.f;null!=ph&&(Mc.UICultureTag=ph);var Hg=null==na.g?null:na.g.toString();null!=Hg&&(Mc.UICultureTagLcid=Hg);var Ah=null==na.h?null:na.h.toString();null!=Ah&&(Mc.WacHostId=Ah);
break;case 37:Jf="RichApiInvocation";var bi=na.a;null!=bi&&(Mc.UserSessionId=bi);var lj=null==na.b?null:na.b.toString();null!=lj&&(Mc.Succeeded=lj);var bj=na.c;null!=bj&&(Mc.ErrorType=bj);var mj=na.d;null!=mj&&(Mc.ResultInfo=mj);var yh=na.e;null!=yh&&(Mc.Source=yh);break;case 38:Jf="FxLibrary";var nj=na.a;null!=nj&&(Mc.EntityName=nj);var oj=null==na.b?null:na.b.toString();null!=oj&&(Mc.EntryPoint=oj);var pj=null==na.c?null:na.c.toString();null!=pj&&(Mc.Action=pj);var qj=null==na.d?null:na.d.toString();
null!=qj&&(Mc.InsertLocation=qj);break;case 39:Jf="EmbeddedApiSession";var Kh=na.a;null!=Kh&&(Mc.UserSessionId=Kh);break;case 40:Jf="NumberFormattingCalculator";var hj=na.a;null!=hj&&(Mc.Id=hj);var Ej=na.b;null!=Ej&&(Mc.CounterName=Ej);var cj=na.c;null!=cj&&(Mc.Values=cj);break;case 41:Jf="RequestDataAfterSend";var Eh=na.a;null!=Eh&&(Mc.ClientStopwatchId=Eh);var rj=na.b;null!=rj&&(Mc.RequestStatus=rj);var sj=null==na.c?null:na.c.toString();null!=sj&&(Mc.SendDuration=sj);var ij=null==na.d?null:na.d.toString();
null!=ij&&(Mc.RequestId=ij);break;case 42:Jf="FloatingObjectsStopwatchData";var tj=na.a;null!=tj&&(Mc.StopMessage=tj);var uj=null==na.b?null:na.b.toString();null!=uj&&(Mc.Type=uj);var vj=na.c;null!=vj&&(Mc.GUID=vj);var Fj=null==na.d?null:na.d.toString();null!=Fj&&(Mc.Pane=Fj);var wj=null==na.e?null:na.e.toString();null!=wj&&(Mc.IsAboveGrid=wj);var xj=na.f;null!=xj&&(Mc.StartCorrelation=xj);var Gj=na.g;null!=Gj&&(Mc.LoadImageCorrelation=Gj);var Hj=null==na.h?null:na.h.toString();null!=Hj&&(Mc.SkippedGetEffectsExtents=
Hj);var yj=null==na.i?null:na.i.toString();null!=yj&&(Mc.Version=yj);break;case 43:Jf="Copy";var Ij=na.a;null!=Ij&&(Mc.UserSessionId=Ij);var zj=na.b;null!=zj&&(Mc.Trigger=zj);var vi=na.c;null!=vi&&(Mc.RibbonCommandName=vi);var Aj=na.d;null!=Aj&&(Mc.SourceItem=Aj);var Bj=null==na.e?null:na.e.toString();null!=Bj&&(Mc.SourceRangeCellCount=Bj);var Cj=na.f;null!=Cj&&(Mc.ClientSideStopwatchId=Cj);var Jj=na.g;null!=Jj&&(Mc.CopyOperationId=Jj);var Dj=null==na.h?null:na.h.toString();null!=Dj&&(Mc.IsAsync=
Dj);var Kj=null==na.i?null:na.i.toString();null!=Kj&&(Mc.IsFromCache=Kj);var jj=null==na.j?null:na.j.toString();null!=jj&&(Mc.IsSuccessiveCopy=jj);var Lj=null==na.k?null:na.k.toString();null!=Lj&&(Mc.IsSelectionAllowed=Lj);var Mj=null==na.l?null:na.l.toString();null!=Mj&&(Mc.IsSuccess=Mj);var Nj=null==na.m?null:na.m.toString();null!=Nj&&(Mc.IsExpectedError=Nj);var Oj=na.n;null!=Oj&&(Mc.ExpectedErrorReason=Oj);var Pj=na.o;null!=Pj&&(Mc.ErrorMessage=Pj);var Qj=null==na.p?null:na.p.toString();null!=
Qj&&(Mc.ClientSideCopyTimeInMs=Qj);var Df=null==na.q?null:na.q.toString();null!=Df&&(Mc.TotalTimeInMs=Df);var kj=null==na.r?null:na.r.toString();null!=kj&&(Mc.PlainTextPayloadSize=kj);var Rj=na.s;null!=Rj&&(Mc.CopyPasteTargetType=Rj);var dj=null==na.t?null:na.t.toString();null!=dj&&(Mc.ShadowWorkbookPayloadSize=dj);var J=null==na.u?null:na.u.toString();null!=J&&(Mc.HtmlPayloadSize=J);var Na=null==na.v?null:na.v.toString();null!=Na&&(Mc.HtmlSizeExceedsLimit=Na);var Eb=null==na.w?null:na.w.toString();
null!=Eb&&(Mc.CopyTotalSizeExceedsLimit=Eb);var gc=null==na.x?null:na.x.toString();null!=gc&&(Mc.ErrorReason=gc);var vc=na.y;null!=vc&&(Mc.ErrorName=vc);var Qc=null==na.z?null:na.z.toString();null!=Qc&&(Mc.IsSucceededWithAlert=Qc);var hd=null==na.ba?null:na.ba.toString();null!=hd&&(Mc.EncounteredDeploymentErrors=hd);var nd=null==na.bb?null:na.bb.toString();null!=nd&&(Mc.ShadowWorkbookSizeExceedsLimit=nd);var Cd=na.bc;null!=Cd&&(Mc.CopyPasteTargetName=Cd);var Sd=na.bd;null!=Sd&&(Mc.CCPSliceName=Sd);
var Je=na.be;null!=Je&&(Mc.SyncClipboardItemsKeys=Je);var Te=na.bf;null!=Te&&(Mc.AsyncClipboardItemsKeys=Te);var wf=na.bg;null!=wf&&(Mc.CopyPasteHandlerName=wf);var Lg=na.bh;null!=Lg&&(Mc.SucceededPopulatingSystemClipboardSync=Lg);var sg=na.bi;null!=sg&&(Mc.SucceededPopulatingSystemClipboardAsync=sg);var dg=na.bj;null!=dg&&(Mc.Location=dg);var gg=na.bk;null!=gg&&(Mc.CopyContextId=gg);var Fg=null==na.bl?null:na.bl.toString();null!=Fg&&(Mc.ServerRequestTimeInMs=Fg);var ah=null==na.bm?null:na.bm.toString();
null!=ah&&(Mc.EcsOperationDuration=ah);var Xg=null==na.bn?null:na.bn.toString();null!=Xg&&(Mc.EcsRequestDuration=Xg);var bh=null==na.bo?null:na.bo.toString();null!=bh&&(Mc.WfeRequestDuration=bh);var Th=null==na.bp?null:na.bp.toString();null!=Th&&(Mc.OriginalSourceRangesCountExceedsLimit=Th);var ii=null==na.bq?null:na.bq.toString();null!=ii&&(Mc.UploadToClipServiceAttempted=ii);var Xj=null==na.br?null:na.br.toString();null!=Xj&&(Mc.FloatingObjectType=Xj);break;case 44:Jf="Paste";var Yj=na.a;null!=
Yj&&(Mc.UserSessionId=Yj);var Zj=na.b;null!=Zj&&(Mc.Trigger=Zj);var ak=na.c;null!=ak&&(Mc.RibbonCommandName=ak);var bk=null==na.d?null:na.d.toString();null!=bk&&(Mc.PasteTypeFlagValue=bk);var ck=na.e;null!=ck&&(Mc.PasteOperationId=ck);var dk=na.f;null!=dk&&(Mc.CopyOperationId=dk);var ek=na.g;null!=ek&&(Mc.ClientSideStopwatchId=ek);var fk=na.h;null!=fk&&(Mc.OriginalDestinationRange=fk);var gk=na.i;null!=gk&&(Mc.ExpandDestinationRange=gk);var hk=na.j;null!=hk&&(Mc.SourceItem=hk);var ik=null==na.k?null:
na.k.toString();null!=ik&&(Mc.SourceRangeCellCount=ik);var jk=null==na.l?null:na.l.toString();null!=jk&&(Mc.IsSuccess=jk);var kk=null==na.m?null:na.m.toString();null!=kk&&(Mc.IsExpectedError=kk);var lk=na.n;null!=lk&&(Mc.ClipboardFormatReadTimeInMs=lk);var mk=na.o;null!=mk&&(Mc.ClipboardFormatReadStatus=mk);var nk=null==na.p?null:na.p.toString();null!=nk&&(Mc.ClipboardReadPermissionPromptShown=nk);var ok=null==na.q?null:na.q.toString();null!=ok&&(Mc.AsyncApiReadTimedOut=ok);var pk=na.r;null!=pk&&
(Mc.ExpectedErrorReason=pk);var qk=na.s;null!=qk&&(Mc.ErrorMessage=qk);var rk=null==na.t?null:na.t.toString();null!=rk&&(Mc.TotalTimeInMs=rk);var sk=null==na.u?null:na.u.toString();null!=sk&&(Mc.PlainTextPayloadSize=sk);var tk=null==na.v?null:na.v.toString();null!=tk&&(Mc.ShadowWorkbookPayloadSize=tk);var uk=null==na.w?null:na.w.toString();null!=uk&&(Mc.HtmlPayloadSize=uk);var vk=na.x;null!=vk&&(Mc.CopyPasteTargetType=vk);var wk=null==na.y?null:na.y.toString();null!=wk&&(Mc.IsLastCopyWasExternal=
wk);var xk=null==na.z?null:na.z.toString();null!=xk&&(Mc.IsClipboardDataContainShadowWorkbook=xk);var yk=null==na.ba?null:na.ba.toString();null!=yk&&(Mc.IsShadowWorkbookParsedSuccessfully=yk);var zk=na.bb;null!=zk&&(Mc.ActiveSelectionType=zk);var Ak=na.bc;null!=Ak&&(Mc.PasteResult=Ak);var Bk=null==na.bd?null:na.bd.toString();null!=Bk&&(Mc.ErrorReason=Bk);var Ck=na.be;null!=Ck&&(Mc.ErrorName=Ck);var Dk=null==na.bf?null:na.bf.toString();null!=Dk&&(Mc.IsSucceededWithAlert=Dk);var Ek=null==na.bg?null:
na.bg.toString();null!=Ek&&(Mc.IsAfterCut=Ek);var Fk=null==na.bh?null:na.bh.toString();null!=Fk&&(Mc.EncounteredDeploymentErrors=Fk);var Gk=null==na.bi?null:na.bi.toString();null!=Gk&&(Mc.IsCrossSession=Gk);var Hk=null==na.bj?null:na.bj.toString();null!=Hk&&(Mc.ShadowWorkbookSizeExceedsLimit=Hk);var Ik=null==na.bk?null:na.bk.toString();null!=Ik&&(Mc.ClipboardContainXLOPayload=Ik);var Jk=na.bl;null!=Jk&&(Mc.CopyPasteTargetName=Jk);var Kk=na.bm;null!=Kk&&(Mc.ChromeExtensionId=Kk);var Lk=na.bn;null!=
Lk&&(Mc.PayloadOrigin=Lk);var Mk=na.bo;null!=Mk&&(Mc.PayloadType=Mk);var Nk=na.bp;null!=Nk&&(Mc.CCPSliceName=Nk);var Ok=na.bq;null!=Ok&&(Mc.ClipboardItemsKeys=Ok);var Pk=na.br;null!=Pk&&(Mc.CopyPasteHandlerName=Pk);var Qk=null==na.bs?null:na.bs.toString();null!=Qk&&(Mc.IsSourceItemOriginSameSession=Qk);var Rk=na.bt;null!=Rk&&(Mc.Location=Rk);var Sk=na.bu;null!=Sk&&(Mc.ExternalAppSource=Sk);var Tk=na.bv;null!=Tk&&(Mc.PasteContextId=Tk);var Uk=null==na.bw?null:na.bw.toString();null!=Uk&&(Mc.ServerRequestTimeInMs=
Uk);var Vk=null==na.bx?null:na.bx.toString();null!=Vk&&(Mc.IndicationDisplayScheduled=Vk);var Wk=na.by;null!=Wk&&(Mc.PasteIndicationDisplayStatus=Wk);var Xk=null==na.bz?null:na.bz.toString();null!=Xk&&(Mc.PasteRecoveryUIDisplayed=Xk);var Yk=null==na.ca?null:na.ca.toString();null!=Yk&&(Mc.IsFromPasteRecoveryUI=Yk);var Zk=null==na.cb?null:na.cb.toString();null!=Zk&&(Mc.EcsOperationDuration=Zk);var $k=null==na.cc?null:na.cc.toString();null!=$k&&(Mc.EcsRequestDuration=$k);var al=null==na.cd?null:na.cd.toString();
null!=al&&(Mc.WfeRequestDuration=al);var bl=null==na.ce?null:na.ce.toString();null!=bl&&(Mc.OriginalSourceRangesCountExceedsLimit=bl);var cl=na.cf;null!=cl&&(Mc.PasteRecoveryUndoStopwatchId=cl);var dl=null==na.cg?null:na.cg.toString();null!=dl&&(Mc.PasteRecoveryUndoTimeInMs=dl);var el=null==na.ch?null:na.ch.toString();null!=el&&(Mc.PasteCSEPerformed=el);var fl=null==na.ci?null:na.ci.toString();null!=fl&&(Mc.CSEStatus=fl);var gl=null==na.cj?null:na.cj.toString();null!=gl&&(Mc.IsFromEnterShortcut=gl);
var hl=null==na.ck?null:na.ck.toString();null!=hl&&(Mc.pasteDestinationHasMergedCells=hl);break;case 45:Jf="DragDrop";var il=na.a;null!=il&&(Mc.UserSessionId=il);var jl=na.b;null!=jl&&(Mc.Trigger=jl);var kl=na.c;null!=kl&&(Mc.RibbonCommandName=kl);var ll=na.d;null!=ll&&(Mc.OperationId=ll);var ml=na.e;null!=ml&&(Mc.ClientSideStopwatchId=ml);var nl=na.f;null!=nl&&(Mc.SourceRange=nl);var ol=na.g;null!=ol&&(Mc.DestinationRange=ol);var pl=na.h;null!=pl&&(Mc.CutCopyType=pl);var ql=null==na.i?null:na.i.toString();
null!=ql&&(Mc.IsShiftKeyDown=ql);var rl=null==na.j?null:na.j.toString();null!=rl&&(Mc.IsDragInsert=rl);var sl=null==na.k?null:na.k.toString();null!=sl&&(Mc.IsSuccess=sl);var tl=null==na.l?null:na.l.toString();null!=tl&&(Mc.IsExpectedError=tl);var ul=na.m;null!=ul&&(Mc.ExpectedErrorReason=ul);var vl=na.n;null!=vl&&(Mc.ErrorMessage=vl);var wl=null==na.o?null:na.o.toString();null!=wl&&(Mc.TotalTimeInMs=wl);var xl=na.p;null!=xl&&(Mc.ErrorName=xl);var yl=null==na.q?null:na.q.toString();null!=yl&&(Mc.IsSucceededWithAlert=
yl);var zl=na.r;null!=zl&&(Mc.CopyPasteTargetType=zl);var Al=null==na.s?null:na.s.toString();null!=Al&&(Mc.EncounteredDeploymentErrors=Al);break;case 46:Jf="ClearCopyState";var Bl=na.a;null!=Bl&&(Mc.UserSessionId=Bl);var Cl=na.b;null!=Cl&&(Mc.ClientSideStopwatchId=Cl);var Dl=na.c;null!=Dl&&(Mc.Trigger=Dl);var El=null==na.d?null:na.d.toString();null!=El&&(Mc.IsClearClipboard=El);var Fl=null==na.e?null:na.e.toString();null!=Fl&&(Mc.IsExplicit=Fl);var Gl=null==na.f?null:na.f.toString();null!=Gl&&(Mc.IsSuccess=
Gl);var Hl=na.g;null!=Hl&&(Mc.ErrorMessage=Hl);var Il=na.h;null!=Il&&(Mc.ErrorName=Il);var Jl=null==na.i?null:na.i.toString();null!=Jl&&(Mc.TotalTimeInMs=Jl);var Kl=na.j;null!=Kl&&(Mc.CopyPasteTargetType=Kl);break;case 47:Jf="WebWorkerRecalcStats";var Ll=null==na.a?null:na.a.toString();null!=Ll&&(Mc.SuccessCount=Ll);var Ml=null==na.b?null:na.b.toString();null!=Ml&&(Mc.FailureCount=Ml);var Nl=null==na.c?null:na.c.toString();null!=Nl&&(Mc.ValueTypeMismatchCount=Nl);var Ol=null==na.d?null:na.d.toString();
null!=Ol&&(Mc.CellValueMismatchCount=Ol);var Pl=null==na.e?null:na.e.toString();null!=Pl&&(Mc.IfmtMismatchCount=Pl);var Ql=null==na.f?null:na.f.toString();null!=Ql&&(Mc.FormattedTextMismatchCount=Ql);var Rl=null==na.g?null:na.g.toString();null!=Rl&&(Mc.CellValueStringMismatchCount=Rl);var Sl=null==na.h?null:na.h.toString();null!=Sl&&(Mc.CellValueNumberMismatchCount=Sl);var Tl=null==na.i?null:na.i.toString();null!=Tl&&(Mc.CellValueBooleanMismatchCount=Tl);var Ul=null==na.j?null:na.j.toString();null!=
Ul&&(Mc.CellValueBlankMismatchCount=Ul);var Vl=null==na.k?null:na.k.toString();null!=Vl&&(Mc.CellValueErrorMismatchCount=Vl);var Wl=null==na.l?null:na.l.toString();null!=Wl&&(Mc.FormattedTextStringMismatchCount=Wl);var Xl=null==na.m?null:na.m.toString();null!=Xl&&(Mc.FormattedTextNumberMismatchCount=Xl);var Yl=null==na.n?null:na.n.toString();null!=Yl&&(Mc.FormattedTextBooleanMismatchCount=Yl);var Zl=null==na.o?null:na.o.toString();null!=Zl&&(Mc.FormattedTextBlankMismatchCount=Zl);var $l=null==na.p?
null:na.p.toString();null!=$l&&(Mc.FormattedTextErrorMismatchCount=$l);var am=null==na.q?null:na.q.toString();null!=am&&(Mc.StringMismatchCount=am);var bm=null==na.r?null:na.r.toString();null!=bm&&(Mc.NumericMismatchCount=bm);var cm=null==na.s?null:na.s.toString();null!=cm&&(Mc.ErrorMismatchCount=cm);var dm=null==na.t?null:na.t.toString();null!=dm&&(Mc.StringValuesCount=dm);var em=null==na.u?null:na.u.toString();null!=em&&(Mc.NumericValuesCount=em);var fm=null==na.v?null:na.v.toString();null!=fm&&
(Mc.BooleanValuesCount=fm);var gm=null==na.w?null:na.w.toString();null!=gm&&(Mc.BlankValuesCount=gm);var hm=null==na.x?null:na.x.toString();null!=hm&&(Mc.ErrorValuesCount=hm);var im=null==na.y?null:na.y.toString();null!=im&&(Mc.NumericValuesDiffAverage=im);var jm=na.z;null!=jm&&(Mc.NumericEvaluatedValuesMismatchSamples=jm);var km=na.ba;null!=km&&(Mc.NumericFormattedTextMismatchSamples=km);var lm=na.bb;null!=lm&&(Mc.NumericMismatchSamples=lm);var mm=na.bc;null!=mm&&(Mc.CellValueTypeMismatchSamples=
mm);var nm=na.bd;null!=nm&&(Mc.IfmtMismatchSamples=nm);var om=na.be;null!=om&&(Mc.BlockHashCode=om);break;case 48:Jf="DataValidationEditOpenDialog";var pm=na.a;null!=pm&&(Mc.ServerCommand=pm);var qm=null==na.b?null:na.b.toString();null!=qm&&(Mc.SubDialogOpened=qm);var rm=na.c;null!=rm&&(Mc.SubDialogButtonClicked=rm);var sm=null==na.d?null:na.d.toString();null!=sm&&(Mc.DialogOpened=sm);var tm=na.e;null!=tm&&(Mc.RuleType=tm);var um=na.f;null!=um&&(Mc.ConditionType=um);var vm=null==na.g?null:na.g.toString();
null!=vm&&(Mc.LowerBoundaryFilled=vm);var wm=null==na.h?null:na.h.toString();null!=wm&&(Mc.UpperBoundaryFilled=wm);var xm=null==na.i?null:na.i.toString();null!=xm&&(Mc.IgnoreBlank=xm);var ym=null==na.j?null:na.j.toString();null!=ym&&(Mc.InCellDropdown=ym);var zm=null==na.k?null:na.k.toString();null!=zm&&(Mc.ShowInputMessage=zm);var Am=null==na.l?null:na.l.toString();null!=Am&&(Mc.InputTitleFilled=Am);var Bm=null==na.m?null:na.m.toString();null!=Bm&&(Mc.InputMessageFilled=Bm);var Cm=null==na.n?null:
na.n.toString();null!=Cm&&(Mc.ShowErrorAlert=Cm);var Dm=null==na.o?null:na.o.toString();null!=Dm&&(Mc.AlertBlocking=Dm);var Em=null==na.p?null:na.p.toString();null!=Em&&(Mc.AlertTitleFilled=Em);var Fm=null==na.q?null:na.q.toString();null!=Fm&&(Mc.AlertMessageFilled=Fm);var Gm=na.r;null!=Gm&&(Mc.StopWatchId=Gm);break;case 49:Jf="DataValidationEditSubmitRule";var Hm=na.a;null!=Hm&&(Mc.RuleType=Hm);var Im=na.b;null!=Im&&(Mc.ConditionType=Im);var Jm=null==na.c?null:na.c.toString();null!=Jm&&(Mc.LowerBoundaryFilled=
Jm);var Km=null==na.d?null:na.d.toString();null!=Km&&(Mc.UpperBoundaryFilled=Km);var Lm=null==na.e?null:na.e.toString();null!=Lm&&(Mc.IgnoreBlank=Lm);var Mm=null==na.f?null:na.f.toString();null!=Mm&&(Mc.InCellDropdown=Mm);var Nm=null==na.g?null:na.g.toString();null!=Nm&&(Mc.ShowInputMessage=Nm);var Om=null==na.h?null:na.h.toString();null!=Om&&(Mc.InputTitleFilled=Om);var Pm=null==na.i?null:na.i.toString();null!=Pm&&(Mc.InputMessageFilled=Pm);var Qm=null==na.j?null:na.j.toString();null!=Qm&&(Mc.ShowErrorAlert=
Qm);var Rm=null==na.k?null:na.k.toString();null!=Rm&&(Mc.AlertBlocking=Rm);var Sm=null==na.l?null:na.l.toString();null!=Sm&&(Mc.AlertTitleFilled=Sm);var Tm=null==na.m?null:na.m.toString();null!=Tm&&(Mc.AlertMessageFilled=Tm);var Um=null==na.n?null:na.n.toString();null!=Um&&(Mc.ClearAllPressed=Um);var Vm=na.o;null!=Vm&&(Mc.ActionStatus=Vm);var Wm=na.p;null!=Wm&&(Mc.Error=Wm);var Xm=na.q;null!=Xm&&(Mc.StopWatchId=Xm);var Ym=null==na.r?null:na.r.toString();null!=Ym&&(Mc.InsertDropdownButton=Ym);break;
case 50:Jf="CustomSort";var Zm=na.a;null!=Zm&&(Mc.RangeType=Zm);var $m=null==na.b?null:na.b.toString();null!=$m&&(Mc.HasHeaders=$m);var an=null==na.c?null:na.c.toString();null!=an&&(Mc.SortTopToBottom=an);var bn=null==na.d?null:na.d.toString();null!=bn&&(Mc.ColumnCount=bn);var cn=null==na.e?null:na.e.toString();null!=cn&&(Mc.RowCount=cn);var dn=null==na.f?null:na.f.toString();null!=dn&&(Mc.RangeLimitExceeded=dn);var en=null==na.g?null:na.g.toString();null!=en&&(Mc.CaseSensitive=en);var fn=null==na.h?
null:na.h.toString();null!=fn&&(Mc.GetSortInfoDuration=fn);var gn=null==na.i?null:na.i.toString();null!=gn&&(Mc.LevelCount=gn);var hn=null==na.j?null:na.j.toString();null!=hn&&(Mc.SortOnValuesCount=hn);var jn=null==na.k?null:na.k.toString();null!=jn&&(Mc.SortOnCellColorCount=jn);var kn=null==na.l?null:na.l.toString();null!=kn&&(Mc.SortOnFontColorCount=kn);var ln=null==na.m?null:na.m.toString();null!=ln&&(Mc.SortOnIconCount=ln);var mn=null==na.n?null:na.n.toString();null!=mn&&(Mc.CustomOrderCount=
mn);var nn=null==na.o?null:na.o.toString();null!=nn&&(Mc.AvgCellColorCount=nn);var on=null==na.p?null:na.p.toString();null!=on&&(Mc.MaxCellColorCount=on);var pn=null==na.q?null:na.q.toString();null!=pn&&(Mc.AvgFontColorCount=pn);var qn=null==na.r?null:na.r.toString();null!=qn&&(Mc.MaxFontColorCount=qn);var rn=null==na.s?null:na.s.toString();null!=rn&&(Mc.AvgIconsCount=rn);var sn=null==na.t?null:na.t.toString();null!=sn&&(Mc.MaxIconsCount=sn);var tn=null==na.u?null:na.u.toString();null!=tn&&(Mc.Executed=
tn);break;case 51:Jf="NamedSheetViewUserAction";var un=na.a;null!=un&&(Mc.UserSessionId=un);var vn=na.b;null!=vn&&(Mc.UserActionName=vn);var wn=null==na.c?null:na.c.toString();null!=wn&&(Mc.UserActionSource=wn);var xn=na.d;null!=xn&&(Mc.UserActionData=xn);var yn=na.e;null!=yn&&(Mc.OtherData=yn);break;case 52:Jf="NamedSheetViewTeachingCallout";var zn=na.a;null!=zn&&(Mc.UserSessionId=zn);var An=null==na.b?null:na.b.toString();null!=An&&(Mc.TeachingCalloutSequence=An);var Bn=null==na.c?null:na.c.toString();
null!=Bn&&(Mc.TeachingCalloutIndex=Bn);var Cn=null==na.d?null:na.d.toString();null!=Cn&&(Mc.UserActionName=Cn);var Dn=na.e;null!=Dn&&(Mc.UserActionData=Dn);var En=null==na.f?null:na.f.toString();null!=En&&(Mc.DurationInMs=En);break;case 53:Jf="NamedSheetViewTeachingDialog";var Fn=na.a;null!=Fn&&(Mc.UserSessionId=Fn);var Gn=na.b;null!=Gn&&(Mc.UserActionName=Gn);var Hn=na.c;null!=Hn&&(Mc.ButtonClicked=Hn);var In=null==na.d?null:na.d.toString();null!=In&&(Mc.DurationInMs=In);var Jn=null==na.e?null:na.e.toString();
null!=Jn&&(Mc.IsNewTeachingDialog=Jn);break;case 54:Jf="NamedSheetViewOptionsDialog";var Kn=na.a;null!=Kn&&(Mc.UserSessionId=Kn);var Ln=null==na.b?null:na.b.toString();null!=Ln&&(Mc.OptionsAction=Ln);var Mn=na.c;null!=Mn&&(Mc.OptionsActionData=Mn);var Nn=na.d;null!=Nn&&(Mc.OptionsOtherData=Nn);var On=null==na.e?null:na.e.toString();null!=On&&(Mc.DurationInMs=On);break;case 55:Jf="NamedSheetViewTempViewSaveDialog";var Pn=na.a;null!=Pn&&(Mc.UserSessionId=Pn);var Qn=na.b;null!=Qn&&(Mc.TriggeredFrom=
Qn);var Rn=na.c;null!=Rn&&(Mc.ButtonClicked=Rn);var Sn=null==na.d?null:na.d.toString();null!=Sn&&(Mc.NameUpdated=Sn);var Tn=null==na.e?null:na.e.toString();null!=Tn&&(Mc.DurationInMs=Tn);break;case 56:Jf="TemporaryViewStartedDataRestore";var Un=na.a;null!=Un&&(Mc.UserSessionId=Un);var Vn=null==na.b?null:na.b.toString();null!=Vn&&(Mc.CountOfTempViews=Vn);break;case 57:Jf="TemporaryViewFetchedVersion";var Wn=na.a;null!=Wn&&(Mc.UserSessionId=Wn);var Xn=null==na.b?null:na.b.toString();null!=Xn&&(Mc.NumberOfBytes=
Xn);break;case 58:Jf="RaiseEventsAndGenerateBlockRequests";var Yn=null==na.a?null:na.a.toString();null!=Yn&&(Mc.ReturnContentStatus=Yn);var Zn=null==na.b?null:na.b.toString();null!=Zn&&(Mc.CacheState=Zn);var $n=null==na.c?null:na.c.toString();null!=$n&&(Mc.FromXhrCallback=$n);var ao=null==na.d?null:na.d.toString();null!=ao&&(Mc.AreGeneralErrorsPresent=ao);var bo=na.e;null!=bo&&(Mc.BlockCacheItemHash=bo);var co=na.f;null!=co&&(Mc.StopwatchId=co);var eo=na.g;null!=eo&&(Mc.BlockCacheItemProcessingStopwatchId=
eo);var fo=null==na.h?null:na.h.toString();null!=fo&&(Mc.StateId=fo);var go=null==na.i?null:na.i.toString();null!=go&&(Mc.IsHighPriority=go);var ho=null==na.j?null:na.j.toString();null!=ho&&(Mc.CalcComplete=ho);var io=null==na.k?null:na.k.toString();null!=io&&(Mc.EditedCellsUpdatedByCse=io);var jo=null==na.l?null:na.l.toString();null!=jo&&(Mc.DependentCellsUpdatedByCse=jo);var ko=null==na.m?null:na.m.toString();null!=ko&&(Mc.Revision=ko);var lo=null==na.n?null:na.n.toString();null!=lo&&(Mc.SheetProcessedDataVersion=
lo);var mo=null==na.o?null:na.o.toString();null!=mo&&(Mc.RefCount=mo);var no=null==na.p?null:na.p.toString();null!=no&&(Mc.ExistsInView=no);var oo=null==na.q?null:na.q.toString();null!=oo&&(Mc.ContentSource=oo);break;case 59:Jf="LaunchMakerCodeEditor";var po=na.a;null!=po&&(Mc.SessionId=po);var qo=na.b;null!=qo&&(Mc.Command=qo);var ro=null==na.c?null:na.c.toString();null!=ro&&(Mc.IsPreviewGallery=ro);var so=na.d;null!=so&&(Mc.MenuItemId=so);var to=na.e;null!=to&&(Mc.ScriptId=to);var uo=na.f;null!=
uo&&(Mc.ShareId=uo);var vo=null==na.g?null:na.g.toString();null!=vo&&(Mc.IsOwner=vo);var wo=null==na.h?null:na.h.toString();null!=wo&&(Mc.PublishedScriptCount=wo);var xo=null==na.i?null:na.i.toString();null!=xo&&(Mc.RecentScriptCount=xo);var yo=null==na.j?null:na.j.toString();null!=yo&&(Mc.WorkbookScriptCount=yo)}Mc.Table=Jf;var Do=Sys.Serialization.JavaScriptSerializer.serialize(Mc);Fd.call(Rc,3704927,0,50,Do)}}catch(Mc){r.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${oa} exception: ${Mc}`)}}Mbd(oa,
na,dc){if(this.Rtc){const Rc=this.TYa[oa+na];Rc&&(Rc.e=dc,this.Ped(Rc));delete this.TYa[oa+na]}}Nyd(oa,na){Yd[oa]in this.Vvf||this.gf(oa,na)}U$i(){this.Hh.appStart&&this.Zeg(Ja.MHd,this.Hh.appStart)}XJi(oa){const na={};na.a=oa.i;na.b=oa.o;na.c=oa.t;na.d=yf.a(oa.s,oa.p||this.Hh.appStart);na.e=yf.a(oa.e,oa.s);na.f=oa.c;na.g=oa.a;na.h=oa.h;this.gf(0,na,this.pxi(na.b,na.c))}pxi(oa,na){return["CommandTask","QueuedTask","Task"].includes(oa)&&!this.vIh.includes(na)?!1:!0}DC(oa,na,dc,Rc,Fd=!0){if(oa&&na){const de=
{};de.a=oa;de.b=na;de.c=dc.toString();de.d=Rc.toString();this.gf(15,de,Fd)}}Gvf(oa,na,dc,Rc){const Fd={};oa&&(Fd.c=yf.a(oa,this.Hh.appStart));Fd.b=na;Fd.a=dc;Fd.d=Rc;this.gf(17,Fd)}dispose(){this.DSa.execute(oa=>{oa.deactivate(!0);oa.Cpj(this.LKf)});this.Le&&this.Le.Pdb(this.zW);super.dispose()}cbf(){return this.Rqg=this.Rqg||new wc}VLe(oa,na,dc=null,Rc=null,Fd=null){const de={};de.o=oa;de.t=na;de.p=Fd;de.s=Rc||this.Hh.Ce;this.wqd(de,dc);return de}LHe(oa,na=null){oa&&(oa.e=na||this.Hh.Ce,oa.i=oa.i||
this.G2a.U$a(),oa.c=oa.c||this.xMe,oa.a=oa.a||this.HMe,oa.h=void 0!==oa.h&&null!==oa.h?oa.h:this.Le?this.Le.oi:!1,this.Ped(oa))}Mvf(oa){const na=oa.context;oa.duration>Ja.muh&&(na.methodName===$d.a.fzb||na.methodName===$d.a.Xwa)&&this.Bxc(1,Ja.b6h);if("GetSessionStatus"!==na.methodName){const dc={};dc.a=na.methodName;dc.b=na.stopwatch.id;dc.c=oa.Oxc;dc.d=oa.responseSize;dc.e=na.cJa;dc.f=oa.Cd?oa.Cd.StateId:$d.a.G1d;this.gf(30,dc,!0);this.DC(dc.b,oa.Cd.ServerCorrelationId,"clientWebRequests","ServerActions")}}Qfg(){if(this.Rtc){const oa=
this.TYa.LoadingUIShownSplashScreen;oa&&sc.PageLoadTrackingInfo.instance.$Fj(oa.s)}}Bxc(oa,na){this.ypg.gMb(oa,na,null)}W0f(oa,na=null){this.mHc.htj(oa,na)}V0f(oa,na,dc=null){this.mHc.gtj(oa,na,dc)}X0f(oa){this.mHc.lMb(oa,null)}Y0f(oa,na){this.mHc.gMb(oa,na,null)}yxc(oa,na,dc=null){this.nib.yxc(oa,na,dc)}Gxc(oa,na,dc=null){this.nib.Gxc(oa,na,dc)}sendDNMTraceTag(oa,na,dc,Rc,...Fd){tb.EwaSettings.ya(201)&&r.ULS.sendTraceTag.apply(null,[oa,na,dc,Rc].concat(Fd))}PNb(oa,na,dc,Rc,Fd,de,ne,...cf){this.nib.PNb(oa,
na,dc,Rc,Fd,de,ne,...cf)}RNb(oa,na,dc,Rc,Fd,de){this.nib.RNb(oa,na,dc,Rc,Fd,de)}QNb(oa,na,dc,Rc,Fd,de,...ne){this.nib.QNb(oa,na,dc,Rc,Fd,de,...ne)}SNb(oa,na,dc,Rc,Fd,de){this.ypg.SNb(oa,na,dc,Rc,Fd,de)}Izc(oa,na,dc,Rc){this.nib.Izc(oa,na,dc,Rc)}Ped(oa){this.dVj.XJi(oa)}V$i(){if(this.Rtc){Stw.swpc=null;const oa=this.Rtc;for(let na in oa)this.wqd(oa[na])}}ELh(){const oa=window[De.a.namespace];if(oa){const na=oa[De.a.PGe];na&&(delete oa[De.a.PGe],na.forEach(dc=>{this.wqd(dc);this.Ped(dc)}))}}Lyi(oa,
na){if("about:blank"===oa||"renamehandler.ashx"===na&&"2"===z.a.Pw(oa,"u"))return!0;for(oa=0;oa<this.QPd.length;oa++)if(na.endsWith(this.QPd[oa]))return!0;return!1}qHi(){this.DSa.execute(oa=>{oa.ki(Ja.eZg,0);oa.FQg(this.LKf);oa.activate()})}jHi(){const oa={};oa.a=new Date(Da.EcmaDateClock.instance.appStart.m);oa.b=this.userSessionId;oa.c=this.Hh.Hig;oa.d=Ja.goh*w.devicePixelRatio;oa.e=Zb.a.Ya.appStart.m;this.gf(14,oa,!0);this.Tma(Zb.a.Ya.appStart.m,Object(X.a)(M.a.instance,M.a.instance.Ejj,"recordAppInitStart"))}Zeg(oa,
na){this.jib=this.G2a.U$a();this.jSb=this.G2a.U$a();this.PEa=oa;this.ZCc("UserAction",oa,this.jSb,na);this.Kuf(oa,this.jib)}sXj(){const oa=window[De.a.namespace];oa&&!Ja.eKe&&(oa[De.a.aUj]=(na,dc)=>this.VLe(na,dc),oa[De.a.ywh]=na=>{this.LHe(na)},Ja.eKe=!0)}p5j(oa){const na=ag.L1g(oa.o,oa.t),dc=new ag(yf.a(oa.e,oa.s)),Rc=na in this.dZd?this.dZd[na].iah(dc):dc;this.dZd[na]=Rc;if(dc===Rc||dc.average!==Rc.average)oa=Object(gb.a)(new ug,{operation:oa.o,target:oa.t,tQi:Rc.average,sender:this}),this.raiseEvent(na,
oa)}Kuf(oa,na){const dc={};dc.a=na;dc.b=this.userSessionId;dc.c=oa;this.gf(1,dc,!0)}tmi(){this.QPd=[$d.a.lnj,$d.a.getSessionStatus,$d.a.Xwa,$d.a.W$g,$d.a.O7g,$d.a.aib,$d.a.cfc,$d.a.getObjectMetadata,$d.a.U3h,$d.a.setRichTextCell,$d.a.bxa,$d.a.w9j,$d.a.pollSessionStatus,$d.a.f9h,$d.a.j7h,$d.a.e1h]}wqd(oa,na=null){oa.i=na||this.G2a.U$a();oa.a=this.HMe;oa.c=this.xMe;oa.h=this.Le?this.Le.oi:!1}static la(oa){var na=new jf;oa.da.Ha(291,na);na=new Ja(oa.xa.UserSessionId,void 0,void 0,void 0,na,!0);na.Kuf(Ja.UAf,
na.uNe);r.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");na.qHi();na.sXj();na.U$i();na.jHi();na.ELh();na.V$i();na.tmi();Ja.KDj(oa);Yb.a.Hm.Ha(41,na)}static KDj(oa){const na=w.devicePixelRatio;1<na&&oa.nc.zx(!0,2<=na?8388608:4194304)}}Ja.UAf="UnassignedUserAction";Ja.MHd="PageLoad";Ja.Lmd="GridUpdateOperation";Ja.muh=5E3;Ja.b6h="MoreThan_5000_Ms";Ja.goh=96;Ja.eZg=30;Ja.eKe=!1;Object(h.a)(Ja,"TelemetryManager",re.a,[405,406,407,408]);var Kb=a(208),
lc=a(110);class Dc{constructor(oa,na,dc){this.Gak=oa;this.kV=na;this.name=dc}}Object(h.a)(Dc,"Validation",null,[]);class Oc{constructor(oa){this.Lab=()=>{this.XPf(this.q0e)};this.Pj=()=>{this.XPf(this.m_g)};this.$=oa;this.m_g=new Rb.a;this.q0e=new Rb.a;rc.h(this.$).Ca.vw(this.Pj);rc.h(this.$).Ca.Pse(this.Lab)}jZc(oa,na,dc,Rc,Fd){if(oa&&Rc){const de=Kb.a.Az(na,dc);this.d1b(()=>!!lc.a(oa).Hr(de),Rc.StateId,Fd)}}d1b(oa,na,dc){this.vPg(this.q0e,oa,na,dc)}vPg(oa,na,dc,Rc){oa&&na&&dc!==$d.a.ue&&oa.add(new Dc(na,
dc,Rc))}XPf(oa){if(oa){var na=new Rb.a;for(let dc of oa){if(dc.kV===this.$.ea.Ee)try{dc.Gak()||r.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${dc.name}]`)}catch(Rc){r.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${dc.name}]. Exception: [${Rc}]`)}na.add(dc)}for(let dc of na)oa.remove(dc)}else r.ULS.shipAssertTag(537151011,
0,!!oa,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){rc.h(this.$)&&rc.h(this.$).Ca&&(rc.h(this.$).Ca.sx(this.Pj),rc.h(this.$).Ca.VNd(this.Lab));this.$=null}static la(oa){const na=new Oc(oa);oa.da.Ha(277,na)}}Object(h.a)(Oc,"ValidationTelemetryManager",null,[403,2]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");n.main();Type.registerNamespace("CNT");ha.main();Type.registerNamespace("CACPU");sb.main();Type.registerNamespace("Common.App.EventsCacheManager");
Ub.main();(()=>{hc.a.Fa(oa=>{oa.da.Ha(137,new Ab(oa))})})();(()=>{hc.a.Fa(oa=>{oa.da.Ha(37,new ob(oa))})})();(()=>{hc.a.Fa(oa=>{tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||Nc.la(oa)})})();(()=>{hc.a.Fa(oa=>{tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackerAndProfilerServicesWithNewInfra",!1)||yd.la(oa)})})();(()=>{hc.a.Fa(oa=>{oa.da.Ha(40,new ie(oa,new nb.a(()=>Pc.GetServiceTaskFactory.create(oa.da,137,oa.ka,1))))})})();
(()=>{hc.a.Fa(oa=>{oa.da.Ha(276,new zb(oa))})})();(()=>{hc.a.Fa(oa=>{Yb.a.Hm.kb(135,()=>{Ja.la(oa);Zc.la(oa);Oc.la(oa);id.la(oa);Jb.la(oa);k.RenderingFidelityTracker.la(oa)})})})();String(e);String(d);String(f);String(b);window.___1680633106691_closurehack=e;window.___1680633106691_closurehack=d;window.___1680633106691_closurehack=f;window.___1680633106691_closurehack=b},721:function(t,C,a){a.d(C,"a",function(){return c});const c=(b,f,e)=>b.Aa(f)||b.Ha(f,e())},750:function(t,C,a){t=a(0);var c=a(88),
b=a(6),f=a(83),e=a(29),d=a(34),h=a(181);class r{constructor(m,n){this.message=m;this.Jva=n}}Object(t.a)(r,"CrossDocumentEventArgs",null,[]);var l=a(764),u=a(382),v=a(266),x=a(763);a.d(C,"a",function(){return w});class w{constructor(m,n,z,y){this._name="";this.$s={};this.L2=null;this.aH=[];this.SG=[];this.TG=[];this.ZG=[];this.Ysa=m;this.Wsa=n;this.yo={};this.ft={};this.XG=z;w._id++;y&&y();this.vo=this.enable()}get targetOrigin(){return this.Wsa}get NCa(){return this.Ysa}enable(){if(!v.a())return x.a.sendTraceTag(5018251,
2,"Not supported for current browser."),!1;this.sBb();x.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.vo}sBb(){x.a.debugAssertTag(5018253,!!this.XG,null);this.L2=Object(c.a)(this,this.nGb,"messageListener");this.XG.jIa(this.L2,null)}disable(){this.vo=!1;this.aH=[];this.SG=[];this.TG=[];this.ZG=[];this.Ysa=null;this.Wsa="";this.XG.lKa(this.L2);this.yo={};this.ft={}}dispose(){this.disable()}sya(m){return!!this.aH&&Array.contains(this.aH,m)||this.rya(m)}rya(m){return!!this.SG&&
Array.contains(this.SG,m)}Am(m){x.a.debugAssertTag(5018259,!!this.aH,null);Array.add(this.aH,m);x.a.sendTraceTag(5018260,2,"Allow receiving : {0}",m)}p_a(m){x.a.debugAssertTag(5018261,!!this.SG,null);Array.add(this.SG,m);x.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",m)}TCb(m){return!!this.TG&&Array.contains(this.TG,m)}o3(m){x.a.debugAssertTag(5018263,!!this.TG,null);Array.add(this.TG,m);x.a.sendTraceTag(5018264,2,"Allow free sending: {0}",m)}bDb(m){m=f.a.BK(m);return!!m&&!!this.ZG&&Array.contains(this.ZG,
m)}QP(m){x.a.debugAssertTag(5018265,!!this.ZG,null);if(m===w.SJ)return x.a.debugAssertTag(5018266,!1,null),!1;let n=f.a.BK(m);if(!n)return x.a.sendTraceTag(5018267,4,"Get origin fail:{0}",m),!1;b.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(n=d.a.Ok(n));Array.add(this.ZG,n);x.a.sendTraceTag(5018268,2,"Add origin:{0}",n);return!0}send(m,n=null){let z=this.targetOrigin;if(n){n=f.a.BK(n);if(!n)return!1;z=n}return this.w8(m,this.NCa,
z)}hi(m,n,z=""){z=z&&""!==z?z:h.a.create().toString();return this.send(this.H7(m,n,z,b.AFrameworkApplication.userSessionId))}postMessage(m){const n=h.a.create().toString();if(!b.AFrameworkApplication.fa.ra("RetryablePostMessagingIsEnabled")||!m.shouldRetry)return this.send(this.H7(m.messageId,m.values,n,m.userSessionId));if(!this.yo[m.MY]){this.Am(m.MY);const z=Object(c.a)(this,this.ackMessageHandler,"ackMessageHandler");this.Lk(m.MY,z)}this.$s[n]="";return this.IAa(m,n,1)}IAa(m,n,z){if(""!==n&&n in
this.$s&&"ACK_RECEIVED"===this.$s[n])return delete this.$s[n],!0;if(z>m.SF)return x.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',m.MY,n),delete this.$s[n],!1;x.a.sendTraceTag(40716251,1<z?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',m.SF-z,m.messageId,n);z++;window.setTimeout(()=>{this.IAa(m,n,z)},m.eYc);m.values[u.a.cYc]=!0;return this.send(this.H7(m.messageId,m.values,n,m.userSessionId))}ackMessageHandler(m){m=
m.CorrelationId;""!==m&&m in this.$s&&(x.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.$s[m],m),this.$s[m]="ACK_RECEIVED")}H7(m,n,z,y){m=new l.a(m);m.CorrelationId=z;n&&(m.Values=n);m.Values.wdUserSession=y;return m}w8(m,n,z){x.a.debugAssertTag(5018269,!!m,null);if(!this.vo)return!1;x.a.debugAssertTag(5018270,!!n,null);x.a.debugAssertTag(5018271,!!z,null);if(!n||!z)return x.a.debugAssertTag(5018272,!1,null),!1;if(z===w.SJ&&!this.TCb(m.MessageId))return x.a.sendTraceTag(5018273,
1,"Got unregistered message {0}",{["id"]:m.MessageId}),!1;m.SendTime=(new Date).getTime();let y="";try{y=Sys.Serialization.JavaScriptSerializer.serialize(m)}catch(A){return x.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:A.message}),!1}n=w.hi(n,y,z);x.a.sendTraceTag(5018275,2,"Send {0}. {1}",n?"succeeded":"failed",{["id"]:m.MessageId,["origin"]:z});return n}Lk(m,n){x.a.debugAssertTag(5018304,!!n,null);x.a.debugAssertTag(5018305,!!this.yo&&!!this.ft,null);if(!this.vo)return!1;if(!this.sya(m))return x.a.sendTraceTag(5018306,
2,"Not allow receiving {0}",{["id"]:m}),!1;this.yo[m]!==n&&(x.a.debugAssertTag(5018307,!this.yo[m]&&!this.ft[m],null),this.yo[m]=n,delete this.ft[m]);return!0}N1(m){this.vo&&(this.yo[m]&&delete this.yo[m],this.ft[m]&&delete this.ft[m])}nGb(m){const n=this.Lyb(m);if(!n)return!1;if(this.yo[n.MessageId])return this.XG.Txa(this.yo[n.MessageId],n),!0;if(this.ft[n.MessageId]){let z=this.ft[n.MessageId];m=new r(n,m);this.XG.BBb(z,m);return!0}return!1}Lyb(m){const n=new Date;this.uFb(m);if(!m.origin||!m.source||
void 0===m.data||null===m.data)return x.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const z=this.kEb(m.data);if(!z)return null;if(!this.bDb(m.origin)){if(!this.rya(z.MessageId))return x.a.sendTraceTag(5018309,1,"{0}",{["id"]:z.MessageId}),null;if(!e.a.cW&&m.source!==this.NCa)return x.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}x.a.debugAssertTag(5018311,!!z.Values,null);z.Values.m_Source=m.source;z.Values.m_Origin=
m.origin;z.Values.m_ReceivedTime=n.getTime();return z}kEb(m){if(!m)return null;let n=null;try{n=Sys.Serialization.JavaScriptSerializer.deserialize(m,!0)}catch(A){return 2>w.ura&&(x.a.sendTraceTag(5018312,2,"Deser failed"),w.ura++),null}if(!n)return x.a.debugAssertTag(5018313,!1,null),null;for(m=0;m<w.wQ.length;m++)if(!n[w.wQ[m]])return"MessageId"!==w.wQ[m]&&x.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",w.wQ[m]),null;if(n.Values)try{n.Values}catch(A){return x.a.sendTraceTag(5018314,
4,"Not a valid dictionary: {0}",A.message),null}else x.a.sendTraceTag(41502556,2,"No values in message");m=n.MessageId;if(!this.sya(m))return x.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:m}),null;const z=n.SendTime,y=(new Date).getTime()-z;if(0>z)return x.a.sendTraceTag(520435660,2,"{0}",{["t"]:z,["id"]:m}),null;6E4<y&&x.a.sendTraceTag(520435659,2,"{0}",{["t"]:z,["delta"]:y,["id"]:m});-300>y&&x.a.sendTraceTag(520435658,2,"{0}",{["t"]:z,["delta"]:y,["id"]:m});m=new l.a;m.MessageId=n.MessageId;
m.SendTime=n.SendTime;m.CorrelationId=n.CorrelationId;n.Values&&(m.Values=n.Values);x.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",m.MessageId,m.SendTime,m.CorrelationId);return m}uFb(m){x.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:m.origin,["data"]:m.data,["source"]:m.source}))}static hi(m,n,z){if(!v.a())return x.a.debugAssertTag(5018319,!1,null),!1;try{return m.postMessage(n,z),!0}catch(y){x.a.sendTraceTag(5018320,4,"{0}",
{["exception"]:y.message})}return!1}}w.wQ=["MessageId","SendTime"];w.SJ="*";w._id=0;w.ura=0;Object(t.a)(w,"CrossDocumentMessenger",null,[2,186])},754:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{static yhf(b){c.$=b;c.$.da.kb(291,f=>{c.Le=f})}static Uka(b,f){return b[Math.round((b.length-1)*f/100)]}static AD(b){return c.Le?c.Le.AD(b):!1}}c.Le=null;c.$=null;Object(t.a)(c,"SessionStatisticsManagerHelper",null,[])},763:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{static ONb(){}static Uub(){}}
c.sendTraceTag=c.ONb;c.debugAssertTag=c.Uub;Object(t.a)(c,"BULS",null,[])},764:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{constructor(b){this.MessageId=b;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(t.a)(c,"CrossDocumentMessage",null,[])},792:function(t,C,a){a.d(C,"a",function(){return c});const c=b=>{if(Object.keys)b=Object.keys(b);else{const f=[];for(let e in b)Array.add(f,e);b=f}return b}},879:function(t,C,a){t=a(0);var c=a(14),b=a(750),f=a(88),e=a(561),d=a(6),
h=a(16),r=a(113);class l{constructor(w,m,n,z=null){this.origin=w;this.data=m;this.source=n;this.Da=z}}Object(t.a)(l,"MessageEventArgs",null,[]);class u{constructor(w,m){this.g3=null;this.Pob=w;this.de=m;this.GP=null}get JX(){return this.Pob.value}get taskManager(){return this.de.value}jIa(w,m){this.GP=w;this.g3=Object(f.a)(this,this.QJb,"postMessageEventHandler");this.JX.addHandler(h.a.message,this.g3,m)}lKa(){this.GP=null;this.JX.removeHandler(h.a.message,this.g3)}Txa(w,m){const n=new r.a(0,1,1,
()=>{w(m)},7);this.taskManager.Kf(n)}BBb(w,m){const n=new r.a(0,1,1,()=>{w(m)},7);this.taskManager.Kf(n)}QJb(w){return this.GP?this.GP(new l(w.origin,w.data,w.source,w.Da)):!1}static get instance(){return u.Kka()}static Kka(){return new u(new e.a(()=>d.AFrameworkApplication.JX),new e.a(()=>d.AFrameworkApplication.ji))}}Object(t.a)(u,"MessageEventHandler",null,[161]);var v=a(763);a.d(C,"a",function(){return x});class x extends b.a{constructor(w,m,n=null){super(w,m,n||u.instance,x.jBb)}static jBb(){v.a.sendTraceTag=
x.NNb;v.a.debugAssertTag=x.Tub}static NNb(w,m,n,...z){c.ULS.sendTraceTag.apply(null,[w,204,x.uub(m),n].concat(z))}static Tub(){}static uub(w){switch(w){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}x.fKb="wdPreviousSession";x.Dub="wdUserSession";Object(t.a)(x,"CommonCrossDocumentMessenger",b.a,[])},940:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.bbd="stid";c.$ad="iid";c.abd="DynamicImageProvider.aspx";c.is1JSBundlesEnabled=
"Is1JSBundlesEnabled";Object(t.a)(c,"WebServiceConstants",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.tm.js.map/55fe5bc8b196c92dba7fd1fff5902f85/EwaDSOpt.tm.js.map
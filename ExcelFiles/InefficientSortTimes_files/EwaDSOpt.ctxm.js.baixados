'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1123:function(t,C,a){a.d(C,"a",function(){return b});var c=a(520);const b=()=>{c.a.Hi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1183:function(t,C,a){var c={};a.r(c);a.d(c,"ReactContextMenuController",function(){return Ce});var b=a(0),f=a(60),e=a(718),d=a(163),h=a(2),r=a(14),l=a(84),u=a(6),v=a(170),x=a(1122),w=a(1120),m=a(744),n=a(7),z=a(469),y=a(571),A=a(80),F=a(59),D=a(943),B=a(134),M=a(45),R=a(199),P=a(65),E=a(53),H=a(775),G=a(155),N=a(39),I=a(120),O=a(216),U=a(98),ca=a(77),Q=a(37),Y=a(32),la=a(258),ea=a(1),ha=a(197),X=a(15),T=a(69),ua=a(293),Ha=a(21),Ca=a(135),Ga=a(801),sa=a(802),bb=a(136),Ba=a(121),qa=a(36),pa=a(431);
class ya{constructor(){this.Sections=this.Id=null}}Object(b.a)(ya,"AutoFilterMenu",null,[]);class za{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(b.a)(za,"MenuItem",null,[]);class cb{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(b.a)(cb,"MenuSection",null,[]);var Pa;(function(Bb){Bb[Bb.filterOnValue=0]="filterOnValue";
Bb[Bb.filterOnCellColor=1]="filterOnCellColor";Bb[Bb.filterOnFontColor=2]="filterOnFontColor";Bb[Bb.filterOnIcon=3]="filterOnIcon"})(Pa||(Pa={}));Object(b.b)("FilterConditionType",Pa);class nb{constructor(){this.isSuccess=!1}}Object(b.a)(nb,"ApplyFilterByValueResponse",null,[]);class Ma{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(b.a)(Ma,"FilterByValueItem",null,[]);class Oa{constructor(){this.selectedFilterIcon=
this.selectedFilterFontColor=this.selectedFilterCellColor=this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(b.a)(Oa,"GetColorsAndIconsResponse",null,[]);class La{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(b.a)(La,"GetFilterByValueItemsResponse",null,[]);class ra{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(b.a)(ra,"ShowSortFilterMenuParams",
null,[]);class V{constructor(){this.focusShiftOnMenuDismiss=this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applyFilterByColorOrIconRequest=this.applySortByColorOrIconRequest=null}}Object(b.a)(V,"SortFilterControllerFactoryParams",null,[]);class ma{constructor(){this.top=this.left=0}}Object(b.a)(ma,"TargetPoint",null,[]);var W=a(109),aa=a(33),ia=a(161),ka=a(233),Xa=a(9),sb=a(157),ib=a(41),Ub=a(70);const hc=n.a.hdh;class yb extends m.a{constructor(Bb,
ac,tc,ub){super(Bb,"PopulateAutoFilterContextMenu",1675506831,1651433993,hc,!0,!1,"AutoFilterContextMenuRoot",ac,tc,!1,ub);this.S2b=this.dDa=this.sheetName=this.zub=null;this.R4a=this.kuf=!1;this.q9c=this.ccb=this.BMe=this.lRa=this.ffc=this.Rva=this.sgb=this.xRa=null;this.xW=()=>{this.HCc();this.$.ea.rn(this.xW)};this.TGf=jc=>{this.R4a||Ca.b(this.$).rd(B.a.UGf,this.Ql(),void 0,!0);var Ka={};this.$.gk(Ka);var zb=this.$.ea.isNamedObjectViewMode;const Yb=F.a.ri(this.S2b);Yb.SheetName=zb?Ka.NamedObjectName:
Ka.SheetName;Yb.NamedObjectView=zb;Ka=!!jc.searchText;zb=586;this.R4a&&(Ka&&(Yb.ItemListOptions=this.Zfh(jc.searchText),zb=597),Ca.b(this.$).rd(B.a.UGf,{["UserOperation"]:zb.toString()},void 0,!0));const oc=this.rFd(Ka),Wc=this.fZi(),vd=this.$.pa.va.ic();this.BMe=vd.RequestId;this.R4a&&this.ffc&&!this.ffc.dequeueUtcTime&&(this.$.userOperationManager.fva(this.ffc),this.U5g());jc=new R.a(zb,0,(Dd,be,se)=>this.q9c=P.n(this.$.pa.va,Yb,ua.b(Dd,oc),this.R4a?ua.a(be,Wc):be,se,null,vd),80);this.ffc=this.$.userOperationManager.Tc(jc,
null);this.ccb=this.q9c;this.lRa=this.BMe};this.onMenuItemClick=(jc,Ka,zb)=>{Ca.b(this.$).rd(B.a.W2i,this.Ql(),void 0,!0);Ka={["CommandValueId"]:Ka,["MenuItemId"]:Ka,["InputMethod"]:zb,["TopCellAddress"]:this.dDa};const Yb=new U.a(jc,zb,this.$.isEditMode?2:1,19,null);this.$.Ia.Nb(Yb,Ka);r.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${jc}, ${zb}`)};this.focusShiftOnMenuDismiss=()=>{Ha.h(this.$).focus()};this.bDf=jc=>{if(jc.checkedItems&&jc.checkedItems.length){Ca.b(this.$).rd(B.a.cDf,
this.Ql(),void 0,!0);var Ka=F.a.ri(this.S2b),zb={};this.$.gk(zb);zb.FirstRow=0;zb.FirstColumn=Ka.Column;var Yb=this.$.ea.isNamedObjectViewMode;Ka.NamedObjectView=Yb;Ka.SheetName=Yb?zb.NamedObjectName:zb.SheetName;var oc=Dd=>{if(Ga.a.cPb(Dd)){const be=Ga.a.Nxb(Dd);this.xya?Ga.a.wBa(sa.a.applyItemFilter,be.MessageIdName,Ba.a.Wta,!0,Ga.a.isSessionEndingError(be.MessageId)):r.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${be.MessageIdName}`)}la.a(Dd)||
(r.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),Ca.b(this.$).rd(B.a.MGf,this.Ql(),void 0,!0),Dd=Object(h.a)(new nb,{isSuccess:!0}),this.sgb.onApplyFilterByValueFinish(Dd),this.gP(this.dDa))},Wc=this.K7b(Ka,zb),vd=new R.a(208,0,(Dd,be,se)=>P.a(this.$.pa.va,Wc,jc.checkedItems,ua.b(Dd,oc),be,se,null,null),6,()=>new D.a(jc.checkedItems,Wc));this.Rcg(()=>{this.$.userOperationManager.Tc(vd,null)})}else r.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};
this.Bxe=jc=>{const Ka=M.o(this.dDa,this.$),zb=M.v(this.dDa,this.$);var Yb=Object(h.a)(new x.a,{SortConditionType:jc.type,RowColOffset:Ka.FirstColumn-zb.FirstColumn,SortColor:jc.color,SortIconSet:jc.icon.IconSet,SortIcon:jc.icon.Icon,IsAscending:!0});Yb=Object(h.a)(new w.a,{OperationType:1,ActiveCell:Ka,SelectedRange:zb,SortConditions:[Yb],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const oc={};oc.SortOptions=Yb;oc.SelectedRange=zb;oc.OriginalActiveCell=Ka;oc.ShouldRestoreSelection=!1;
oc.ShouldPromptNamedSheetViewTeachingDialog=!0;r.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${jc.type}`);this.$.Xc(-1089513346,A.a.Eb,19,{["CustomSortCommandData"]:oc})};this.sxe=jc=>{if(jc.color||jc.icon){Ca.b(this.$).rd(B.a.PTi,this.Ql(),void 0,!0);var Ka=F.a.ri(this.S2b),zb={};this.$.gk(zb);zb.FirstRow=0;zb.FirstColumn=Ka.Column;var Yb=this.$.ea.isNamedObjectViewMode;Ka.NamedObjectView=Yb;Ka.SheetName=Yb?zb.NamedObjectName:zb.SheetName;Ka.ColorOrIconOptions=
this.Yfh(jc);var oc=Dd=>{if(Ga.a.cPb(Dd)){const be=Ga.a.Nxb(Dd);this.xya?Ga.a.wBa(sa.a.filterByColorOrIcon,be.MessageIdName,Ba.a.Wta,!0,Ga.a.isSessionEndingError(be.MessageId)):r.ULS.sendTraceTag(512258702,0,10,"AutoFilterContextMenu::OnApplyFilterByColorOrIcon failed with AutoFilterException -{0}",be.MessageIdName)}la.a(Dd)||(r.ULS.sendTraceTag(512258701,0,50,"AutoFilterContextMenu::OnApplyFilterByColorOrIcon service call succeeded"),Ca.b(this.$).rd(B.a.EYi,this.Ql(),void 0,!0),this.gP(this.dDa))},
Wc=this.K7b(Ka,zb),vd=new R.a(266,0,(Dd,be,se)=>{var Oe=this.$.pa.va;Dd=ua.b(Dd,oc);const Me=Oe.Oa(41,null);Me.parameters=Wc;Me.autoFilterOptions=Ka;return P.g(Oe,"ApplyColorOrIconFilter",Me,Dd,be,se,null,64)},6);this.Rcg(()=>{this.$.userOperationManager.Tc(vd,null)})}else r.ULS.sendTraceTag(512258703,0,15,"AutoFilterContextMenu::applyFilterByColorOrIcon Received Zero params to apply filter on")};this.xya=Ga.a.wrd();this.tB=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get nx(){return"PopulateAutoFilterContextMenu"}get TB(){return n.a.qVf}executeCommand(Bb,
ac,tc){Bb=ac.command;switch(Bb){case 1701016594:return m.a.DIh(tc),f.Task.Ua(!0);case 966232027:const ub=new v.a;N.TaskExtensions.za(E.GetServiceTaskFactory.Sa(this.$.da,8,9,0),jc=>{this.xfi(tc,jc.result);ub.setResult(!0)},this.ka,3).continueWith(()=>{ub.setResult(!1)},5,this.ka,ka.a.instance);return ub.task;default:return ha.a(Bb)}}xfi(Bb,ac){const tc=Bb.domEvent;if(ca.e(tc.rawEvent)&&(ca.g(tc),tc.target)){var ub=new G.a(this.$.ua);if(ub.Zd(4096)||ub.Zd(2048)){var jc=F.a.ri(Bb[A.a.$f]);this.qbg(jc)&&
(this.kuf?this.oxc(tc.target,jc,ac):(this.xRa=()=>{this.qbg(jc)&&(this.Hni(),this.oxc(tc.target,jc,ac),this.R4a=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7213347_AFMenu_FilterByValueSearch"),this.kuf=!0)},this.HCc()))}}}Ac(Bb,ac,tc){switch(ac.command){case 1701016594:case 966232027:return!!tc;default:return!1}}TId(Bb){Bb.MenuSectionList.push(...this.zub)}Hni(){pa.a(()=>{ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?this.sgb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(h.a)(new V,
{getFilterByValueItemsRequest:this.TGf,applyFilterByValueRequest:this.bDf,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:yb.F1c,applySortByColorOrIconRequest:this.Bxe,applyFilterByColorOrIconRequest:this.sxe})):this.sgb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(h.a)(new V,{getFilterByValueItemsRequest:this.TGf,applyFilterByValueRequest:this.bDf,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:yb.F1c,
applySortByColorOrIconRequest:this.Bxe,applyFilterByColorOrIconRequest:this.sxe}))});this.Rva=l.a.instance.yg("Common.IExternalUICommandDefinitionMapping")||new y.a(this.$.Ib,this.$)}oxc(Bb,ac,tc){Ca.b(this.$).rd(B.a.oxc,this.Ql(),void 0,!0);if(ac){tc=this.fUh(ac,tc);var ub=Sys.UI.DomElement.getBounds(Bb);Bb=ub.x+ub.width;ub=ub.y;if(Ha.h(this.$).BD){ac.Cell||r.ULS.sendTraceTag(509220166,0,10,"AutoFilterContextMenu.renderReactAutoFilterMenu:\u00a0autoFilterData.Cell is undefined.");Bb=-1===ac.Cell.FirstRow;
ac=m.a.Lhd(this.$,ac.Cell,Bb);if(!m.a.Zrd(ac,Bb))return;ac=m.a.$hd(this.$,ac,!0,Bb);if(!ac){r.ULS.sendTraceTag(509220165,0,10,`AutoFilterContextMenu.renderReactAutoFilterMenu:\u00a0failed to get the context menu coordinates. isHeaderCommandData=${Bb}`);return}Bb=ac.x;ub=ac.y}else if(this.tB&&!ac.IsHeaderSnapped){if(!m.a.$rd(this.$,ac.Cell))return;ac=m.a.aid(this.$,ac.Cell,!0);Bb=ac.x;ub=ac.y}ac=Ha.h(this.$).rtl?new Sys.UI.Point(Bb-qa.a(this.$).UHa(yb.F1c),ub):new Sys.UI.Point(Bb,ub);ac=qa.a(this.$).gla(ac);
tc=Object(h.a)(new ra,{targetPoint:Object(h.a)(new ma,{left:ac.x,top:ac.y}),autoFilterMenu:tc});this.sgb.showSortFilterMenu(tc);this.$.Xc(-544117314,-1,0,null)}else r.ULS.shipAssertTag(537167135,0,!!ac,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}qbg(Bb){return(null===Bb||void 0===Bb?0:Bb.Cell.SheetName)?Ha.h(this.$).k6?Bb.Cell.SheetName===this.$.na.name:Bb.Cell.SheetName===this.$.na.sheetName:!0}fUh(Bb,ac){return(Bb=this.gUh(Bb,ac))?this.VSf(Bb):null}VSf(Bb){const ac=
[];for(const tc of Bb.Sections){if(Object(ia.g)(this.$)&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&tc.Title===X.a.instance.ha(1951))continue;const ub=this.bej(tc);ac.push(ub)}return Object(h.a)(new ya,{Id:Bb.Id,Sections:ac})}bej(Bb){const ac=[];for(const tc of Bb.MenuItems)if(2===tc.Identifier)this.S2b=tc.CommandData;else switch(tc.Type){case 3:case 2:ac.push(this.$dj(tc,2===tc.Type));break;case 1:ac.push(this.aej(tc))}return Object(h.a)(new cb,{MenuItems:ac,DisplayType:Bb.DisplayType,
Id:this.tRh(Bb)})}aej(Bb){let ac;({label:Ka,mNa:ac}=this.u2e(Bb));const tc=this.VSf(Bb.SubMenu),ub=this.l2e(Bb);let jc="MissingIcon_20";ac&&(jc=this.Rva.sec(ac));var Ka=Ka||Bb.Label;return Object(h.a)(new za,{Disabled:Bb.Disabled,Type:Bb.Type,Identifier:Bb.Identifier,Id:ub,CommandData:Bb.CommandData,Label:Ka,SubMenu:tc,IsChecked:Bb.IsChecked,IconName:"MissingIcon_20"===jc?null:jc})}$dj(Bb,ac){let tc,ub;({label:ac,mNa:tc,Pr:ub}=this.odc(Bb,ac&&Bb.IsChecked));const jc=this.Ugd(Bb,ac);let Ka="MissingIcon_20";
tc&&(Ka=this.Rva.sec(tc));return Object(h.a)(new za,{Disabled:Bb.Disabled,Type:Bb.Type,Identifier:Bb.Identifier,Id:jc,RibbonCommand:ub,CommandData:Bb.CommandData,Label:ac||Bb.Label,SubMenu:null,IsChecked:Bb.IsChecked,IconName:"MissingIcon_20"===Ka?null:Ka})}gUh(Bb,ac){var tc;this.dDa=tc=M.D(Bb.Cell);this.sheetName=this.$.na.sheetName;ac=ac||z.a(this.$);const ub=Ha.h(this.$).BD,jc=-1===Bb.Cell.FirstRow;if(!ub&&Bb.IsHeaderSnapped||ub&&jc)tc=ac.ecc.z0h(tc);else{ac=Ha.h(this.$).Ca.Pwa(tc);if(!ac)return this.xya?
Ga.a.wBa(sa.a.sVf,bb.a.oci,Ba.a.rrb,!0,!1):(Bb=Ha.h(this.$).view.visibleArea,r.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${tc}, visible range: ${Bb}`)),null;tc=ac.autoFilterMenu}if(!tc)return this.xya?Ga.a.wBa(sa.a.sVf,bb.a.HNi,Ba.a.rrb,!0,!1):r.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),
null;this.qvb=Bb.Cell.FirstRow+"_"+Bb.Cell.FirstColumn;return tc}HCc(){let Bb=()=>E.GetServiceTaskFactory.Sa(this.$.da,283,284,1);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7457857_DynamicScriptLoaderNewService")&&(Bb=()=>W.d(sb.a.resolve(ib.s,{rb:1})));if(this.$.ea.Bf){const ac=Bb();N.TaskExtensions.za(ac,()=>{this.xya?ac.result.ol.loadScript("sortFilter").then(()=>{this.xRa()},tc=>{T.a.Hj(tc,"AutoFilterContextMenu.SortFilterScriptLoad");Ga.a.wBa(sa.a.HCc,bb.a.GSj,Ba.a.rrb,!1,!1)}):N.TaskExtensions.za(W.d(ac.result.ol.loadScript("sortFilter")),
()=>{this.xRa()},this.$.ka,3)},this.$.ka,3)}else this.$.ea.mk(this.xW)}Zfh(Bb){const ac={};ac.SearchText=Bb;ac.Page=1;ac.DateNodeType=-1;return ac}Yfh(Bb){const ac={};ac.FilterType=Enum.toString(Pa,Bb.type);ac.FilterColor=Bb.color;ac.FilterIcon=Bb.icon.Icon;ac.FilterIconSet=Bb.icon.IconSet;return ac}U5g(){this.lRa&&(r.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.lRa}`),P.h(this.$.pa.va,
this.lRa,null,null,null),this.lRa=null);this.ccb&&(u.AFrameworkApplication.Od.gv(this.ccb.xu),this.ccb=null)}rFd(Bb){return ac=>{this.ccb=this.lRa=null;if(Ga.a.cPb(ac)){var tc=Ga.a.Nxb(ac);this.xya?Ga.a.wBa(Bb?sa.a.searchAutoFilterItemList:sa.a.getAutoFilterItemList,tc.MessageIdName,Ba.a.rrb,!0,!0):r.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${tc.MessageIdName}`)}if(!la.a(ac)){r.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");
tc=ac.Result;ac=new Q.a(!0);var ub=tc.AutoFilterDateNodes?!0:!1;tc.AutoFilterItems&&ac.add("AutoFilterItemsCount",tc.AutoFilterItems.length);ub&&ac.add("AutoFilterDateItemsCount",tc.AutoFilterDateNodes.length);ac.add("Location","contextMenu");ub=this.R4a?Object(h.a)(new La,{filterByValueItems:this.SIe(tc),hasMoreRecords:tc.ItemListMaxExceeded,searchText:tc.SearchText}):Object(h.a)(new La,{filterByValueItems:this.SIe(tc),hasMoreRecords:tc.ItemListMaxExceeded});this.sgb.onGetFilterByValueItemsFinish(ub);
Bb||(r.ULS.shipAssertTag(529063959,0,null!==tc.FontColors&&null!==tc.CellColors&&null!==tc.Icons&&null!==tc.SelectedSortFontColors&&null!==tc.SelectedSortCellColors&&null!==tc.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),ub=Object(h.a)(new Oa,{fontColors:tc.FontColors,cellColors:tc.CellColors,icons:tc.Icons,getColorName:this.getColorName,selectedSortFontColor:0<tc.SelectedSortFontColors.length?tc.SelectedSortFontColors[0]:
null,selectedSortCellColor:0<tc.SelectedSortCellColors.length?tc.SelectedSortCellColors[0]:null,selectedSortIcon:0<tc.SelectedSortIcons.length?tc.SelectedSortIcons[0]:null,selectedFilterCellColor:-1!==tc.SelectedFilterCellColor?tc.SelectedFilterCellColor:null,selectedFilterFontColor:-1!==tc.SelectedFilterFontColor?tc.SelectedFilterFontColor:null,selectedFilterIcon:null!==tc.SelectedFilterIcon?tc.SelectedFilterIcon:null}),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7573807_IsColorOrIconPresent")&&
(tc=1<tc.FontColors.length||1<tc.CellColors.length||1<tc.Icons.length)&&ac.add("AutoFilterColorOrIconPresent",tc),Ca.b(this.$).rd(B.a.rFd,ac.Qu,void 0,!0),this.sgb.onGetColorsAndIconsFinish(ub))}}}fZi(){return Bb=>{this.ccb=this.lRa=null;Bb=I.a.Ye(Bb.data);Bb=Y.a.xc(Bb);r.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${Bb}].`)}}SIe(Bb){const ac=this.Idh(Bb),tc=this.Pdh(Bb.AutoFilterItems),ub=[],jc=[];let Ka=0,zb=0;Bb.HasBlanks&&(Bb=yb.f8c(X.a.instance.ha(782),
Bb.IsBlanksSelected?1:0,n.a.fze),ub[Ka++]=Bb);for(const Yb of ac)ub[Ka++]=Yb;if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const Yb of tc)-1!==Array.indexOf(Xa.a.tcd,Yb.displayText)?jc[zb++]=Yb:ub[Ka++]=Yb;else for(const Yb of tc)ub[Ka++]=Yb;return Array.prototype.concat(jc,ub)}Idh(Bb){const ac=[];if(!Bb.AutoFilterDateNodes||!Bb.AutoFilterDateNodes.length)return ac;const tc=[this.c6a(Bb.YearKeys,Bb.YearValues),this.c6a(Bb.MonthKeys,Bb.MonthValues),this.c6a(Bb.DayKeys,
Bb.DayValues),this.c6a(Bb.HourKeys,Bb.HourValues),this.c6a(Bb.MinuteKeys,Bb.MinuteValues),this.c6a(Bb.SecondKeys,Bb.SecondValues)];let ub=!1,jc=!1,Ka=0;var zb=null;const Yb=Array(6);var oc=null;for(const Wc of Bb.AutoFilterDateNodes){Yb[0]&&(oc.Year!==Wc.Year?(ub=!0,Ka=0,zb=null):oc.Month!==Wc.Month?(jc=!0,Ka=1,zb=Yb[0]):oc.Day!==Wc.Day?(Ka=2,zb=Yb[1]):Bb.ShowTime&&(oc.Hour!==Wc.Hour?(Ka=3,zb=Yb[2]):oc.Minute!==Wc.Minute?(Ka=4,zb=Yb[3]):(Ka=5,zb=Yb[4])));for(;6>Ka;){let vd;switch(Ka){case 0:vd=Wc.Year;
oc=tc[0].getItem(vd.toString());break;case 1:vd=Wc.Month;oc=tc[1].getItem(vd.toString());break;case 2:vd=Wc.Day;oc=tc[2].getItem(vd.toString());break;case 3:vd=Wc.Hour;oc=tc[3].getItem(vd.toString());break;case 4:vd=Wc.Minute;oc=tc[4].getItem(vd.toString());break;case 5:vd=Wc.Second;oc=tc[5].getItem(vd.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}oc=yb.f8c(oc,-1!==Wc.NodeType&&Ka>=Wc.NodeType?1:0,zb?zb.key+";"+vd:n.a.G1c+vd,!1,[]);zb=zb?zb.children:ac;
zb=zb[zb.length]=oc;Yb[Ka]=oc;switch(Ka){case 5:Ka=6;break;case 2:Ka=Bb.ShowTime?Ka+1:6;break;default:Ka++}}oc=Wc}ub||(Yb[0].expanded=!0,jc||(Yb[1].expanded=!0));return ac}Pdh(Bb){const ac=[];if(!Bb)return ac;let tc=0;for(const ub of Bb)ac[tc++]=yb.f8c(ub.DisplayString,ub.Selected?1:0,n.a.H1c+ub.DisplayString);return ac}c6a(Bb,ac){const tc=new Q.a(!0);if(!Bb||!ac)return tc;const ub=Bb.length<ac.length?Bb.length:ac.length;for(let jc=0;jc<ub;jc++)tc.add(Bb[jc].toString(),ac[jc]);return tc}K7b(Bb,ac){const tc=
{};tc.Location=ac;tc.FieldId=Bb.Id.toString();tc.DataSourceIndex=-1;tc.FilterType=Bb.AutoFilterType;tc.AnchorType=0;tc.ChartId=null;tc.AnchorValue1=-1;tc.AnchorValue2=-1;tc.Property=Bb.RichProperty;return tc}gP(Bb){aa.a.vma(this.$)&&N.TaskExtensions.za(E.GetServiceTaskFactory.Sa(this.$.da,430,431,1),ac=>{ac.result.d9(Bb);r.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.ka,3)}Ql(){return{["Location"]:"contextMenu"}}getColorName(Bb){return H.a.qMa(O.a.wF(Bb))}Rcg(Bb){const ac=
Object(Ub.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?W.d(sb.a.resolve(ib.K,{rb:3})):E.GetServiceTaskFactory.Sa(this.$.da,309,310,3);N.TaskExtensions.za(ac,tc=>{tc.result.fUa().continueWith(ub=>{ub.result&&Bb()})},this.$.ka,3)}static f8c(Bb=null,ac=0,tc=null,ub=!1,jc=null){return Object(h.a)(new Ma,{displayText:Bb?m.a.rf(Bb):Bb,state:ac,key:tc,parent:null,children:jc,indentationLevel:0,expanded:ub})}}yb.F1c=268;Object(b.a)(yb,"AutoFilterContextMenu",m.a,[]);var Gb=a(739),Sa=a(89),db=a(198),
fb=a(67),ab=a(19);class wb{}wb.YZe=26;wb.Med=[228,229,0,98,0,94,93];Object(b.a)(wb,"Constants",null,[]);class kb{constructor(Bb,ac,tc,ub){this.HEg=Bb;this.fzg=ac;this.jzg=tc;this.RIg=ub}get Bwi(){return 3===this.m8b}get CAi(){return 4===this.m8b&&!!this.subMenu}get subMenu(){return this.RIg}get Tyf(){return this.HEg}get m8b(){return this.fzg}get E9c(){return this.jzg}}Object(b.a)(kb,"FiltersMenuData",null,[]);class tb extends kb{constructor(Bb,ac){super(Bb,2,0,null);this.gze=ac}}Object(b.a)(tb,"AutoFilterFiltersMenuData",
kb,[]);class hb{}hb.TXj=[new kb(99,2,0,null),new kb(100,2,1,null),new kb(0,3,0,null),new kb(170,2,2,null),new kb(172,2,4,null),new kb(0,3,0,null),new kb(174,2,6,null),new kb(175,2,7,null),new kb(0,3,0,null),new kb(107,0,0,null)];hb.fSi=[new kb(99,2,0,null),new kb(100,2,1,null),new kb(0,3,0,null),new kb(101,2,8,null),new kb(102,2,10,null),new kb(103,2,12,null),new kb(0,3,0,null),new kb(104,1,0,null),new tb(105,1),new tb(106,2),new kb(0,3,0,null),new kb(107,0,0,null)];hb.Bnh=[new kb(99,2,0,null),new kb(0,
3,0,null),new kb(111,2,10,null),new kb(112,2,8,null),new kb(103,2,12,null),new kb(0,3,0,null),new tb(109,8),new tb(108,9),new tb(110,10),new kb(0,3,0,null),new tb(114,11),new tb(113,12),new tb(115,13),new kb(0,3,0,null),new tb(116,14),new tb(117,15),new tb(118,16),new kb(0,3,0,null),new tb(119,17),new tb(120,18),new tb(121,19),new kb(0,3,0,null),new tb(122,20),new tb(123,21),new tb(124,22),new kb(0,3,0,null),new tb(125,23),new kb(126,2,12,[new tb(127,24),new tb(128,25),new tb(129,26),new tb(130,27),
new kb(0,3,0,null),new tb(131,28),new tb(132,29),new tb(133,30),new tb(134,31),new tb(135,32),new tb(136,33),new tb(137,34),new tb(138,35),new tb(139,36),new tb(140,37),new tb(141,38),new tb(142,39)]),new kb(0,3,0,null),new kb(107,0,0,null)];Object(b.a)(hb,"Constants",null,[]);var Fb=a(952),va=a(85);class jb extends m.a{constructor(Bb,ac,tc,ub){super(Bb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,jb.rKh,!0,!1,jb.SMb,ac,tc,!1,ub);this.Gm=null}get nx(){return"PopulateAutoFilterFieldListContextMenu"}get TB(){return n.a.rVf}executeCommand(Bb,
ac,tc){Bb=ac.command;switch(Bb){case -699941697:this.applyAutoFilterFieldList(ac,tc);break;case 216058793:break;case -1494291901:break;default:return ha.a(Bb)}return f.Task.Ua(!0)}Rhd(Bb,ac){return!Bb||Bb.length<=ac?(r.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(Bb[ac],10)}vKd(Bb,ac,tc,ub,jc,Ka){const zb=this.Rhd(jc,Ka);0>zb&&r.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");
switch(wb.Med[zb]){case 98:Bb=new U.a(-2058042992,ac.method,ac.mode,ac.af,ac.tabName);this.Gm.mH.ywb(this.$,ub,0,Bb);break;case 228:Bb=new U.a(504133448,ac.method,ac.mode,ac.af,ac.tabName);this.Gm.mH.ywb(this.$,ub,0,Bb);break;case 229:Bb=new U.a(-798968736,ac.method,ac.mode,ac.af,ac.tabName);this.Gm.mH.ywb(this.$,ub,0,Bb);break;case 233:Bb=new U.a(-1677817820,ac.method,ac.mode,ac.af,ac.tabName);this.Gm.mH.ywb(this.$,ub,0,Bb);break;case 94:this.oTf(Bb,ac,ub,tc,jc,Ka+1);break;case 93:this.Gm.mH.xEi(this.$,
ub)}}oTf(Bb,ac,tc,ub,jc,Ka){const zb=this.Rhd(jc,Ka);0>zb&&r.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!ub||zb>=ub.length)r.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(ub=ub[zb],ub.m8b){case 1:this.Gm.mH.QEi(this.$,tc);break;case 2:(jc=Object(Sa.a)(tb,ub))?(Bb=new U.a(-2058042992,ac.method,ac.mode,ac.af,ac.tabName),this.Gm.mH.ywb(this.$,tc,jc.gze,Bb)):this.Gm.mH.Tsf(this.$,
Bb,tc,ub.E9c);break;case 0:this.Gm.mH.Tsf(this.$,Bb,tc,ub.E9c);break;case 4:this.oTf(Bb,ac,tc,ub.subMenu,jc,Ka+1)}}applyAutoFilterFieldList(Bb,ac){var tc=ac[Gb.a.eE];if(tc)if(tc=tc.split(fb.a.YU),3>tc.length)r.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var ub=this.Rhd(tc,1),jc=this.bMa(ub),Ka=this.Oyf(ub).returnValue;Ka?this.vKd(ac,Bb,Ka,jc,tc,2):r.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
ub.toString()+fb.a.YU)}else r.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}Ac(Bb,ac){if(Bb=this.$.isEditMode)switch(ac.command){case 216058793:break;case -699941697:break;case -1494291901:Bb=!0;break;default:Bb=!1}return Bb}s1(Bb,ac,tc){this.$.isEditMode&&((this.Gm=Object(Sa.a)(336,tc))||r.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.vZ(),super.s1(Bb,
ac,null,null,!0))}X7c(){if(!this.Gm||!this.Gm.fl||1!==this.Gm.fl.length)return r.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const Bb=this.Gm.fl[0];let ac=new db.a;ac.add(X.a.instance.ha(249));ac=va.OBc(va.concat(ac,va.select(va.asEnumerable(Bb.FieldInfoDataList),tc=>tc.Name)),tc=>tc,new Fb.a);return va.toArray(ac)}fieldIndex(Bb){if(!this.Gm||!this.Gm.fl||1!==this.Gm.fl.length||!this.Gm.fl[0].FieldInfoDataList)return-1;
for(let ac=0;ac<this.Gm.fl[0].FieldInfoDataList.length;++ac)if(this.Gm.fl[0].FieldInfoDataList[ac].Name===Bb)return ac;return-1}bMa(Bb){return 0>Bb||!this.Gm||!this.Gm.fl||1!==this.Gm.fl.length||!this.Gm.fl[0].FieldInfoDataList||this.Gm.fl[0].FieldInfoDataList.length<Bb?null:this.Gm.fl[0].FieldInfoDataList[Bb].Name}vZ(){var Bb=this.X7c();if(!Bb||!Bb.length)return null;const ac=this.Xa,tc=ac.Nc();for(let zb=0;zb<Bb.length;++zb){const Yb=Bb[zb],oc=0<zb?this.fieldIndex(Yb):-1,Wc=jb.veg+oc.toString()+
fb.a.YU;let vd=null;const Dd=this.Gm.mH.rgi(0<zb?Yb:null),be=this.j8c(ac,Dd,jb.veg+oc.toString(),Yb);for(let se=0;se<wb.Med.length;++se){var ub=wb.Med[se],jc=Wc+se.toString();vd||(vd=ac.Nc());switch(ub){case 228:vd.buttons.push(ac.Wc(223,jc,-699941697,this.Gm.mH.mAi(0<zb?Yb:null)?ab.a.gbc:ab.a.XKa,8,228,!1,null));break;case 229:vd.buttons.push(ac.Wc(224,jc,-699941697,this.Gm.mH.nAi(0<zb?Yb:null)?ab.a.hbc:ab.a.YKa,8,229,!1,null));break;case 233:vd.buttons.push(ac.Wc(225,jc,-699941697,ab.a.dbc,1,233,
!1,null));break;case 98:ub=this.o2g(Yb);jc=ac.GJa(jc+(Dd?".enabled":".disabled"),ub,-699941697,null,"None",null,!Dd,void 0,!0);jc.AS("Image16by16",8,ab.a.D4a);vd.buttons.push(jc);break;case 94:var Ka=void 0;const Oe=({h_e:Ka,isChecked:ub}=this.Oyf(oc)).returnValue;if(!Oe)return null;Ka=this.j8c(ac,ub&&Dd,jc,Ka);jc=this.z2e(Ka.menu,ac,jc+fb.a.YU,Oe,ub&&Dd);Ka.menu.Cc.push(jc);vd.buttons.push(Ka);break;case 0:vd&&(be.menu.Cc.push(vd),vd=null);break;default:jc=ac.GJa(jc,X.a.instance.ha(ub),-699941697,
null,"None",null,!1,void 0,!0),this.N7f(jc,Dd&&93===ub&&this.Gm.mH.filter(),X.a.instance.ha(ub)),vd.buttons.push(jc)}}be.menu.Cc.push(vd);tc.buttons.push(be)}Bb=ac.Nq(this.menuId);Bb.Cc.push(tc);return Bb}z2e(Bb,ac,tc,ub,jc){let Ka=null;for(let vd=0;vd<ub.length;++vd){var zb=ub[vd],Yb=tc+vd.toString(),oc=!1;switch(zb.m8b){case 1:oc=jc&&this.Gm.mH.Hg.IsTop10;break;case 2:oc=Object(Sa.a)(tb,zb);oc=jc&&this.Gm.mH.Tsi(oc?oc.gze:0,zb.E9c);break;case 0:oc=jc&&this.Gm.mH.Hg.IsCustomSupportedAndNotPresent}Ka||
(Ka=ac.Nc());if(zb.Bwi)Ka&&(Bb.Cc.push(Ka),Ka=null);else if(zb.CAi){var Wc=X.a.instance.ha(zb.Tyf);Wc=this.j8c(ac,oc,Yb,Wc);Wc.menu.Cc.push(this.z2e(Wc.menu,ac,Yb+fb.a.YU,zb.subMenu,oc));Ka.buttons.push(Wc)}else zb=X.a.instance.ha(zb.Tyf),Yb=ac.GJa(Yb,zb,-699941697,null,"None",null,!1,void 0,!0),this.N7f(Yb,oc,zb),Ka.buttons.push(Yb)}return Ka}N7f(Bb,ac,tc){ac?Bb.AS("Image16by16",8,ab.a.Mva):Bb.AS("None",0,null);Bb.yS(tc);Bb.label=tc}j8c(Bb,ac,tc,ub){return ac?Bb.Y7c(tc,this.menuId,ub,798637440,8,
ab.a.Mva):Bb.Gw(tc,this.menuId,ub,798637440)}Yg(Bb){return!Bb||!Bb.length}Oyf(Bb){var ac=0>Bb?0:this.Gm.fl[0].FieldInfoDataList[Bb].MajorityDataTypeForField;var tc=null;Bb=this.Gm.mH.qgi(ac);switch(ac){case 0:tc=95;ac=hb.TXj;break;case 1:tc=94;ac=hb.fSi;break;case 2:tc=96;ac=hb.Bnh;break;default:return r.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,h_e:tc,isChecked:Bb}}tc=X.a.instance.ha(tc);return{returnValue:ac,h_e:tc,
isChecked:Bb}}o2g(Bb){return!Bb||this.Yg(Bb.trim())?X.a.instance.ha(97):Bb.length>wb.YZe?String.format(X.a.instance.qb(155),Bb.substring(0,wb.YZe)):String.format(X.a.instance.qb(156),Bb)}}jb.rKh=n.a.gdh;jb.SMb="AutoFilterFieldListContextMenuRoot";jb.veg="ApplyAutoFilterFieldList.";Object(b.a)(jb,"AutoFilterFieldListContextMenu",m.a,[]);var Ab=a(557),Qa=a(866),Z=a(12),wa=a(132),Ea=a(381);class fa extends m.a{constructor(Bb,ac,tc,ub,jc="PopulateFloatingObjectContextMenu",Ka=-2017893763,zb=1350204367,
Yb=n.a.ndh,oc=!0,Wc=!1){super(Bb,jc,Ka,zb,Yb,oc,Wc,Yb,ac,tc,!0,ub);this.floatingObject=null;this.Cb=0;this.hpc=!0}get nx(){return"PopulateFloatingObjectContextMenu"}get TB(){return n.a.zVf}executeCommand(Bb,ac,tc){Bb=Object(Sa.a)(Ab.a,tc.eventArgs);switch(ac.command){case -1372040782:tc=Ha.h(this.$).ga.Ra.oc;r.ULS.shipAssertTag(537167048,0,!!tc);tc&&(this.floatingObject=tc.floatingObject,this.Cb=ac.method,ac=this.bec(Bb),this.to(ac,!0,Bb.Cb));break;case 848910589:Bb&&(ac=[Qa.a.Y$f],Bb=new Sys.UI.Point(Bb.Da.clientX,
Bb.Da.clientY),this.showFloatie(ac,new Sys.UI.Bounds(Bb.x,Bb.y,0,0),2))}return f.Task.Ua(!0)}Ac(Bb,ac,tc){switch(ac.command){case -1372040782:return!!tc&&this.Tpf(Bb);case 848910589:return Bb=Ha.h(this.$).ga.Ra.oc,!!tc&&!!Bb&&Bb.jb;default:return!1}}Tpf(Bb){switch(Bb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}YYc(Bb,ac,tc){Ea.a(this.$)?Ha.h(this.$).lb.mj||(qa.a(this.$).uWd()?tc.buttons.push(Bb.tb(265)):tc.buttons.push(Bb.tb(264))):(this.$.isEditMode&&3===this.Cb&&!this.Hcc()&&
tc.buttons.push(Bb.tb(101)),5!==this.floatingObject.type||wa.a.ZH(this.floatingObject.Gb)||this.floatingObject.Gb.IsGroup||(this.bvd()?tc.buttons.push(Bb.tb(186)):tc.buttons.push(Bb.tb(147))),this.Hcc()||this.bvd()||tc.buttons.push(Bb.tb(146)),this.sQh(tc),this.XRh(tc),ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&tc.buttons.push(Bb.tb(287)),ea.EwaSettings.ya(155)&&0===this.floatingObject.type&&tc.buttons.push(Bb.tb(249)),5===this.floatingObject.type&&
Ha.h(this.$).ga.Ra.oc.r6()&&this.$.sma&&this.$.WP&&tc.buttons.push(Bb.tb(273)))}eMa(Bb){const ac=[];if(Ea.a(this.$))return ac;3===Bb?(Bb=!!this.$.se.get(5)&&this.floatingObject.CZd(),this.Hcc()||(this.$.isEditMode?(Bb&&ac.push(Qa.a.vNh),5===Ha.h(this.$).ga.Ra.aB.floatingObject.type&&ac.push(Qa.a.GJj)):Bb&&ac.push(Qa.a.copy)),ac.push(Qa.a.wNh)):2===Bb&&(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?Ha.h(this.$).ga.Ra.oc&&this.N7e(Ha.h(this.$).ga.Ra.oc,
ac):this.N7e(Ha.h(this.$).ga.Ra.aB,ac));return ac}vZ(){const Bb=this.Xa,ac=Bb.Nq(this.menuId);var tc=Ea.a(this.$);if(this.$.isEditMode){const ub=Bb.Nc();this.YYc(Bb,ac,ub);ac.Cc.push(ub)}this.$.se.get(5)&&this.floatingObject.CZd()&&!this.Hcc()&&!tc&&(tc=Bb.Nc(),this.KMg(Bb,tc),ac.Cc.push(tc));return ac}bec(Bb){var ac=Ha.h(this.$).ga.Ra.oc;Bb=Bb&&1!==Bb.Cb&&Bb.clientPoint?Bb.clientPoint:Sys.UI.DomElement.getLocation(ac.domElement);const tc=this.$.domElement,ub=Ha.h(this.$).rtl;(ac=Z.HelperMethods.sD(ac.Ig.domElement,
tc,ub))?(Bb.y=Math.max(Bb.y,ac.y),Bb.x=Math.max(Bb.x,ac.x)):r.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${u.AFrameworkApplication.ug}`);return Bb}bvd(){const Bb=Ha.h(this.$).ga.Ra.oc;return!!Bb&&Bb.jb}KMg(Bb,ac){if(this.$.isEditMode){ac.buttons.push(Bb.tb(42));ac.buttons.push(Bb.tb(43));const tc=this.$.da.Aa(254,!0);(tc&&2===tc.j$a()||this.bvd())&&ac.buttons.push(Bb.tb(44))}else ac.buttons.push(Bb.tb(43))}Hcc(){return ea.EwaSettings.ya(407)&&
!!Ha.h(this.$).ga.Ra.uo}N7e(Bb,ac){5===Bb.floatingObject.type?Bb.jb?ac.push(Qa.a.Y$f):ac.push(Qa.a.CJj):ac.push(m.a.o0e)}sQh(Bb){const ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(282));ac.buttons.push(this.Xa.tb(281));const tc=this.Xa.Gw("BringToFront","BringToFrontMenuId",X.a.instance.ha(822),-1777747317);tc.menu.Cc.push(ac);Bb.buttons.push(tc)}XRh(Bb){const ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(284));ac.buttons.push(this.Xa.tb(283));const tc=this.Xa.Gw("SendToBack","SendToBackMenuId",X.a.instance.ha(823),
-1777747317);tc.menu.Cc.push(ac);Bb.buttons.push(tc)}}Object(b.a)(fa,"FloatingObjectContextMenu",m.a,[]);var Ua=a(815),Aa=a(94),Ib=a(567),Pb=a(525);const Fa=n.a.jdh;class da extends fa{constructor(Bb,ac,tc,ub){super(Bb,ac,tc,ub,"PopulateChartContextMenu",-498523270,1640762262,Fa);this.isPivotChart=this.refresh=this.SZ=this.zxa=this.tCa=!1}get nx(){return"PopulateChartContextMenu"}get TB(){return n.a.tVf}executeCommand(Bb,ac,tc){const ub=this.$;this.Cb=ac.method;ac=tc[da.v4c];if(!(Bb&68)){if(!ac){if(8===
Bb)ac=Pb.a(ub).jd;else{var jc=Ha.h(ub).ga.Ra.oc;if(null===jc||void 0===jc?0:jc.floatingObject)ac=jc.floatingObject.jd}if(!ac)return f.Task.Ua(!0)}this.isPivotChart=!!(ac.Attributes&4)}if(this.isPivotChart||ub.isEditMode)if(this.refresh=this.SZ=this.zxa=this.tCa=!1,jc=Ha.h(this.$).ga.Ra.oc,r.ULS.shipAssertTag(537167107,0,!!jc),jc){this.floatingObject=jc.floatingObject;jc=Ib.a(ub);if(null===jc||void 0===jc?0:jc.UVd)this.tCa=jc=Aa.h(ub.Ue),this.zxa=!jc;jc=ub.nc;this.SZ=!!Ua.a(ub)&&!!ac&&!!(ac.Attributes&
512)&&!(Bb&8)&&jc.z3(32768);jc.allowManualDataRefresh&&jc.allowInteractivity&&(this.refresh=!0);Bb=this.bec(Object(Sa.a)(Ab.a,tc.eventArgs));this.to(Bb,!0)}return f.Task.Ua(!0)}Ac(Bb,ac,tc){return-149612405===ac.command&&!!tc&&this.Tpf(Bb)}YYc(Bb,ac,tc){this.isPivotChart&&(this.refresh&&tc.buttons.push(Bb.tb(100)),this.SZ&&tc.buttons.push(Bb.tb(99)),this.tCa?tc.buttons.push(Bb.tb(59)):this.zxa&&tc.buttons.push(Bb.tb(58)));super.YYc(Bb,ac,tc)}static get v4c(){return"chartMetaData"}}Object(b.a)(da,
"ChartContextMenu",fa,[]);var K=a(13);const xa=n.a.ldh;class rb extends m.a{constructor(Bb,ac,tc,ub){super(Bb,"PopulateFieldListContextMenu",-1045020714,-170383950,xa,!0,!1,xa,ac,tc,!1,ub);this.ML=this.Jo=null;this.EZd=this.isOlap=this.dW=this.D_=!1}get nx(){return"PopulateFieldListContextMenu"}get TB(){return n.a.HLd}executeCommand(Bb,ac,tc){Bb=ac.command;switch(Bb){case 330754562:ac=tc.domElement;this.isOlap=tc.isOlap;this.ML=tc.versionkey;this.Jo=tc.fieldItem;this.D_=tc.isChart;this.dW=tc.isPpm;
this.EZd="supportsImplicitMeasures"in tc?tc.supportsImplicitMeasures:!1;Ha.h(this.$).Xo(!0);ac=K.DOMElementExtensions.getBounds(ac);ac=new Sys.UI.Point(ac.x+ac.width,ac.y+ac.height/2);"isKeyboardInput"in tc&&tc.isKeyboardInput?this.to(ac,!1,1):this.to(ac,!1);break;case 926905850:this.EZd&&this.Jo&&5===this.Jo.TypeTag&&!this.Jo.IsCollapsible&&r.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Ib.a(this.$).nK(this.Jo,8,-1,this.ML,ac);break;case -67292059:Ib.a(this.$).nK(this.Jo,
1,-1,this.ML,ac);break;case 745182485:Ib.a(this.$).nK(this.Jo,2,-1,this.ML,ac);break;case 359279088:Ib.a(this.$).nK(this.Jo,4,-1,this.ML,ac);break;case 547535945:Ib.a(this.$).iij(this.Jo);break;default:return ha.a(Bb)}return f.Task.Ua(!0)}Ac(Bb,ac,tc){Bb=!1;switch(ac.command){case 330754562:Bb=!!tc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:Bb=!0}return Bb}vZ(){const Bb=this.Xa.Nq(this.menuId);this.zbj(Bb);this.D_||this.isOlap||this.ybj(Bb);return Bb}zbj(Bb){const ac=
this.Xa,tc=ac.Nc();let ub=!1;ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(ub=this.isOlap&&!this.dW&&this.EZd&&5===this.Jo.TypeTag&&!this.Jo.IsCollapsible);3!==this.Jo.TypeTag&&37!==this.Jo.TypeTag||this.Jo.IsSet?17===this.Jo.TypeTag||this.dW?(tc.buttons.push(ac.tb(79)),tc.buttons.push(ac.tb(this.D_?91:80)),tc.buttons.push(ac.tb(this.D_?92:81)),tc.buttons.push(ac.tb(82))):13===this.Jo.TypeTag||this.Jo.IsSet?(tc.buttons.push(ac.tb(83)),tc.buttons.push(ac.tb(this.D_?
91:80)),tc.buttons.push(ac.tb(this.D_?92:81)),tc.buttons.push(ac.tb(86))):(tc.buttons.push(ac.tb(79)),tc.buttons.push(ac.tb(this.D_?91:80)),tc.buttons.push(ac.tb(this.D_?92:81)),tc.buttons.push(ac.tb(ub?82:86))):(tc.buttons.push(ac.tb(83)),tc.buttons.push(ac.tb(this.D_?93:84)),tc.buttons.push(ac.tb(this.D_?94:85)),tc.buttons.push(ac.tb(82)));Bb.Cc.push(tc)}ybj(Bb){const ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(78));Bb.Cc.push(ac)}}Object(b.a)(rb,"FieldListContextMenu",m.a,[]);var Qb=a(425),pc=a(73);
class Lb{constructor(Bb){this.$=Bb;this.IN={}}get(Bb,ac,tc){const ub=this.wkg(Bb,"PivotFilterContextMenuCache.Get");return ub&&this.IN[ub]?this.IN[ub][Lb.ckd(ac,this.$,Bb,tc)]:null}set(Bb,ac,tc,ub){const jc=this.wkg(Bb,"PivotFilterContextMenuCache.Set");jc&&(this.IN[jc]||(this.IN[jc]={}),this.IN[jc][Lb.ckd(ac,this.$,Bb,ub)]=tc)}M$b(Bb){Bb in this.IN&&this.IN[Bb]&&(this.IN[Bb]=null)}wkg(Bb,ac){return pc.f(this.$.na)?this.$.activeItemName:(Bb=this.Y1j(Bb,ac))?Bb.ld:null}Y1j(Bb,ac){Bb=M.D(Bb);Bb=Ha.h(this.$).Ca.Kwa(Bb,
this.$.activeItemName);r.ULS.shipAssertTag(537167008,0,!!Bb,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${ac}`);return Bb}static ckd(Bb,ac,tc,ub){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===ub?ac.na.index+"_"+Bb.id+"_"+tc.FirstRow.toString()+"_"+tc.FirstColumn.toString():ac.na.index+"_"+Bb.id}}Object(b.a)(Lb,"PivotFilterContextMenuCache",null,[]);class qb{constructor(){this.cell=
null;this.dataSourceIndex=0;this.To=this.pivotName=null}}Object(b.a)(qb,"ShowPivotFilterData",null,[]);var bc=a(465),sc=a(1345),Tb=a(54);const $a=n.a.GIe;class Nb extends m.a{constructor(Bb,ac,tc,ub,jc,Ka,zb,Yb=$a){super(Bb,ac,tc,ub,Yb,!0,!1,"PivotFilterMenuRootName",jc,Ka,!1,zb);this.xqc=this.RDd=this.pivotData=this.Tob=this.Yrf=this.u8b=null;this.WY=this.B5b=this.lHb=0;this.zub=null;this.zZi=(oc,Wc)=>{if(Wc)if(la.a(oc))this.SAd(Wc,!1);else if(oc=oc.Result){this.qvb=Lb.ckd(Wc,this.$,this.pivotData.cell,
this.WY);var vd=this.Pyf(oc.MenuModel.Sections);this.zub=vd;Nb.IN.set(this.pivotData.cell,Wc,vd,this.WY);sc.a(this.$).jVj(oc);this.SAd(Wc,!0)}};this.yZi=(oc,Wc)=>{this.SAd(Wc,!1)};this.xf=(oc,Wc)=>{Nb.IN.M$b(Wc.hd.hash)};this.qn=(oc,Wc)=>{Nb.IN.M$b(Wc.hd.hash)};this.dBa=null;this.iEe=this.B5b=this.SDd=this.lHb=-1;this.Pve=this.WY=0;this.tB=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Nb.IN||(Nb.IN=new Lb(this.$),Ha.h(this.$).Ca.uu(this.xf),Ha.h(this.$).Ca.hH(this.qn),Ha.h(this.$).Ca.R$(this.xf))}Vdd(Bb,
ac){const tc=Bb.rawEvent,ub=Bb.cell,jc=Bb.requiresConfirmation,Ka=zb=>{if(zb){zb=tc?new Sys.UI.DomEvent(tc):null;this.pivotData=new qb;this.pivotData.pivotName=Bb.pivotName;this.pivotData.dataSourceIndex=Bb.dataSourceIndex;this.pivotData.cell=ub;this.pivotData.To=Bb.optionalPivotMenuAnchorParameter;if(this.pivotData.To&&0<this.pivotData.To.AnchorType){this.xqc=Bb.objectId;this.lHb=Bb.objectVersion;const Yb=this.pivotData.To.AnchorType;if(4===Yb||5===Yb||6===Yb||11===Yb||9===Yb||10===Yb||8===Yb)this.Tob=
Bb.location}else this.RDd=this.xqc=null,this.SDd=this.lHb=-1;Ha.h(this.$).Xo(!0);this.$.gk(ub);this.s1(zb,zb?zb.target:Bb.domElement,this.pivotData,ac,this.dma())}};ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void sb.a.resolve(ib.o,{rb:1}).then(zb=>{zb.ak(jc,Ka)}):bc.a(this.$).ak(jc,Ka);return!0}s1(Bb,ac,tc,ub){if(Object(Qb.a)(qb,tc)){this.pivotData=tc;this.u8b=ac;this.Yrf=Bb;this.B5b=this.pivotData.To?this.pivotData.To.AnchorValue1:-1;this.WY=
this.pivotData.To?this.pivotData.To.AnchorType:0;var jc=!1,Ka=null;Ka=Nb.IN.get(this.pivotData.cell,ac,this.WY);jc=!!Ka;var zb=!0;switch(this.WY){case 4:case 5:case 6:this.dBa=new Sys.UI.Point(this.Tob.x,this.Tob.y);zb=!1;break;case 7:var Yb=Sys.UI.DomElement.getBounds(ac);zb=Yb.x+(0<=Yb.x?0:Yb.width);Yb=Yb.y+(0<=Yb.y?0:Yb.height);this.dBa=new Sys.UI.Point(0<=zb?zb:0,0<=Yb?Yb:0);zb=!1;break;case 8:case 10:case 9:case 11:this.dBa=new Sys.UI.Point(this.Tob.x,this.Tob.y);break;default:this.dBa=null}jc&&
this.xqc===this.RDd&&this.lHb===this.SDd&&this.B5b===this.iEe&&this.WY===this.Pve?(r.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.zub=Ka,this.dBa?this.to(this.dBa,this.dma()):this.tB?ea.EwaSettings.AOa()?(Bb=m.a.Lhd(this.$,this.pivotData.cell),m.a.Zrd(Bb)&&this.to(m.a.$hd(this.$,Bb,!1),this.dma())):m.a.$rd(this.$,this.pivotData.cell)&&this.to(m.a.aid(this.$,this.pivotData.cell,!1),this.dma()):super.s1(Bb,ac,tc,
ub,this.dma())):1!==Nb.FZh(ac)&&(zb&&(ac.parentNode.menuFetchStates=1,this.VDj(ac),this.v7f(!0)),this.$.userOperationManager.Tc(new R.a(126,0,(oc,Wc,vd)=>{const Dd=this.$;return P.p(Dd.pa.va,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,Dd.domElement.id,Dd.isChromeRtl,Dd.workbookContext.NovMode,ua.b(oc,this.zZi),ua.a(Wc,this.yZi),vd,ac,this.pivotData.To)},16),ub))}}TId(Bb){Bb.MenuSectionList.push(...this.zub)}SAd(Bb,ac){Bb.parentNode.menuFetchStates=2;this.v7f(!1);if(ac){if(this.u8b!==
Bb||this.INi())this.to(this.dBa,this.dma());else if(this.tB&&!this.dBa)if(ea.EwaSettings.AOa()){Bb=m.a.Lhd(this.$,this.pivotData.cell);if(!m.a.Zrd(Bb))return;this.to(m.a.$hd(this.$,Bb,!1),this.dma())}else{if(!m.a.$rd(this.$,this.pivotData.cell))return;this.to(m.a.aid(this.$,this.pivotData.cell,!1),this.dma())}else super.s1(this.Yrf,Bb,null,null,this.dma());this.RDd=this.xqc;this.SDd=this.lHb;this.Pve=this.WY;this.iEe=this.B5b}}dma(){return 8!==this.WY&&9!==this.WY&&10!==this.WY&&11!==this.WY}INi(){switch(this.pivotData.To?
this.pivotData.To.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}v7f(Bb){const ac=this.u8b;if(ac){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var tc=K.DOMElementExtensions.$Z(ac,"ewaprevsrc","");tc=!!tc&&"null"!==tc}else tc=!!K.DOMElementExtensions.$Z(ac,"ewaprevsrc","");Bb&&tc||!Bb&&!tc||(Bb?(ac.setAttribute("ewaprevsrc",ac.src),ac.src=Tb.a.current.io(99)):(Bb=K.DOMElementExtensions.$Z(ac,"ewaprevsrc",""),ac.src=
Bb,ac.setAttribute("ewaprevsrc",null)))}}VDj(Bb){this.u8b=Bb}static FZh(Bb){const ac=Bb.parentNode.menuFetchStates;void 0===ac&&(Bb.parentNode.menuFetchStates=0);return ac}}Nb.IN=null;Object(b.a)(Nb,"PivotFilterContextMenuBase",m.a,[]);const Ra="FieldList"+n.a.GIe;class ob extends Nb{constructor(Bb,ac,tc,ub){super(Bb,"PopulateFieldListPivotMenu",-1793121409,1378457149,ac,tc,ub,Ra)}get nx(){return"PopulateFieldListPivotMenu"}get TB(){return n.a.xVf}executeCommand(Bb,ac,tc){return this.Vdd(tc,ac)?f.Task.Ua(!0):
ha.a(ac.command)}Ac(Bb,ac,tc){return-1065117584===ac.command&&!!tc}}Object(b.a)(ob,"FieldListPivotContextMenu",Nb,[]);var mb=a(232),gb=a(34),lb=a(92),Xb=a(777);class Xd{}Object(b.a)(Xd,"PivotValueFieldSettingsApplyData",null,[]);class Qd{}Qd.Zpg="valueFieldSettingTabs";Qd.gnh="dataFieldCustomLabel";Qd.RMe="dataFieldSourceLabel";Qd.DXd="showValueAsSelect";Qd.BXd="showValueAsBaseFieldSelect";Qd.CXd="showValueAsBaseItemSelect";Qd.Y3d="valueFieldsSettingsFieldName";Object(b.a)(Qd,"CssElementIds",null,
[]);var te=a(115);class Pc{constructor(Bb,ac,tc){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=Bb;this.baseFieldIndex=ac;this.baseItemIndex=tc}}Object(b.a)(Pc,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class Ne{constructor(Bb,ac,tc,ub,jc){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=Bb;this.activeCell=ac;this.pivotFieldTitle=tc;this.summarizeBy=ub;this.showAsValueParameters=
jc}getActiveCell(){return this.activeCell}}Object(b.a)(Ne,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[145]);var Hb=a(245);class pb{}Object(b.a)(pb,"PivotValueFieldShowValueAsApplyData",null,[]);var mc=a(753),Kc=a(49);const Nc=`<div id='showValueAsControlBody'><label for='${Qd.DXd}' class='${te.a.Vp} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Qd.DXd}' class='${te.a.yH}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Qd.BXd}'>{1}</label><div><select size=6 id='${Qd.BXd}' class='${te.a.yH}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Qd.CXd}'>{2}</label><div><select size=6 id='${Qd.CXd}' class='${te.a.yH}'></select></div></div></div>`;
class pd extends Hb.a{constructor(Bb,ac,tc,ub,jc,Ka,zb,Yb,oc){super(Bb);this.Sb=this.c$d=this.L7d=this.K7d=this.I3b=this.X8b=this.FD=null;this.ZEf=()=>{var Wc=parseInt(this.qba.qe.value,10);this.I5g(Wc)?(this.ZP.$k.disabled=!0,this.$P.$k.disabled=!0,this.$P.clear(),pd.Pjf(Wc)?(this.ZP.$k.disabled=!1,this.IRb(!1)):pd.Qjf(Wc)?(this.ZP.$k.disabled=!1,this.$P.$k.disabled=!1,this.IRb(!0),this.Mtf()):this.IRb(!1)):(Wc=Y.a.nd(1,0,0,1131,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Kc.a(this.$).fu([Wc]),
this.qba.K2f())};this.eUi=()=>{0>this.ZP.selectedIndex||this.$P.$k.disabled||(this.IRb(!0),this.Mtf())};this.o_i=Wc=>{this.FD.JUa();this.$P.$k.style.overflowY="scroll";if(Wc&&!la.a(Wc)){Wc=Wc.Result;this.$P.clear();for(const vd of Wc.BaseItems)this.$P.YT(vd.DisplayString,vd.Id.toString(),vd.Id===Wc.SelectedBaseItem);this.IRb(!1)}};this.get_visible=this.qla;this.set_visible=this.jpa;this.$=ac;this.cell=tc;this.To=ub;this.externalSourceIndex=jc;this.Ld=Ka;this.Gua=zb;this.Xwi=Yb;this.Sb=oc;this.E7j=
ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.Ola()}qla(){return this.isVisible}jpa(Bb){return this.isVisible=Bb}get title(){return X.a.instance.ha(1119)}get $yb(){const Bb=this.qba.qe?parseInt(this.qba.qe.value,10):-1,ac=this.ZP.qe?parseInt(this.ZP.qe.value,10):-1,tc=this.$P.qe?parseInt(this.$P.qe.value,10):-1;return Object(h.a)(new pb,{SelectedDataFormat:0<=Bb?Bb:-1,SelectedBaseField:ac,SelectedBaseItem:tc})}get ZP(){return this.K7d}get $P(){return this.L7d}get qba(){return this.c$d}setFocus(){K.DOMElementExtensions.setFocus(this.qba.$k)}render(Bb){Bb.appendChild(this.domElement)}dispose(){lb.a.wc([this.qba,
this.ZP,this.$P,this.X8b,this.I3b]);super.dispose()}MGj(Bb){lb.a.wc([this.X8b,this.I3b]);this.qba.clear();for(const ac of Bb.DataFormatTypes)this.qba.YT(pd.PXh(ac),ac.toString(),ac===Bb.SelectedDataFormat);this.X8b=this.De.ke(this.qba.domElement);this.X8b.la("change",this.ZEf);this.ZP.clear();for(const ac of Bb.BaseFieldList)this.ZP.YT(ac.DisplayString,ac.Id.toString(),ac.Id===Bb.SelectedBaseField);this.I3b=this.De.ke(this.ZP.domElement);this.I3b.la("change",this.eUi);this.FD=this.Gua.qub(this.$P.$k.parentNode,
1E3,null,"",736);this.FD.JUa();this.ZEf(null)}kN(Bb){this.qba.kN(Bb);this.ZP.kN(Bb);this.$P.kN(Bb)}Ola(){this.Sb.uh(this.domElement,String.format(Nc,X.a.instance.ha(1120),X.a.instance.ha(1121),X.a.instance.ha(1122)));this.c$d=new mc.a(K.DOMElementExtensions.getElementById(this.domElement,Qd.DXd),!1);this.K7d=new mc.a(K.DOMElementExtensions.getElementById(this.domElement,Qd.BXd),!1);this.L7d=new mc.a(K.DOMElementExtensions.getElementById(this.domElement,Qd.CXd),!1)}I5g(Bb){return this.Xwi||!pd.Pjf(Bb)&&
!pd.Qjf(Bb)?!0:!!this.ZP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Tc(new R.a(108,0,(Bb,ac,tc)=>{var ub=this.$.pa.va,jc=parseInt(this.ZP.qe.value,10);Bb=ua.b.call(null,Bb,this.o_i);const Ka=P.L(ub,this.cell,this.externalSourceIndex,this.To);Ka.selectedBaseField=jc;return P.g(ub,"GetPivotValueFieldSettingsShowValueAsBaseItems",Ka,Bb,ac,tc,null,4)},16),this.Ld)}Mtf(){this.$P.clear();this.ZP.qe&&(this.FD.DUa(),this.$P.$k.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}IRb(Bb){const ac=
document.getElementById("WACDialogActionButton");this.E7j&&ac&&(ac.disabled=Bb)}static PXh(Bb){switch(Bb){case 0:return X.a.instance.ha(1123);case 1:return X.a.instance.ha(1124);case 2:return X.a.instance.ha(1125);case 3:return X.a.instance.ha(1126);case 4:return X.a.instance.ha(1127);case 5:return X.a.instance.ha(1128);case 6:return X.a.instance.ha(1129);case 7:return X.a.instance.ha(1130);case 8:return X.a.instance.ha(1132);case 9:return X.a.instance.ha(1133);case 10:return X.a.instance.ha(1134);
case 11:return X.a.instance.ha(1135);case 12:return X.a.instance.ha(1136);case 13:return X.a.instance.ha(1137);case 14:return X.a.instance.ha(1138);default:return""}}static Pjf(Bb){return 11===Bb||12===Bb||14===Bb||13===Bb||4===Bb}static Qjf(Bb){return 1===Bb||3===Bb||2===Bb}}Object(b.a)(pd,"ShowValueAsControl",Hb.a,[372,2]);class Vd{}Object(b.a)(Vd,"PivotValueFieldSummarizeValueByApplyData",null,[]);const $d="<div id='summarizeValuesByControlBody'>"+`<label class='${te.a.Vp} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+
`<div id='${"pivotDataFieldSelectDescription"}' class='${te.a.Vp} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${te.a.yH}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${n.a.kH}='${"pivotDataFieldSelectDescription"}'></select></div>`+"</div>";class ue extends Hb.a{constructor(Bb,ac){super(Bb);this.Sb=this.vje=null;this.get_visible=this.qla;this.set_visible=this.jpa;this.Sb=ac;this.Ola()}get $yb(){const Bb=this.Dl.qe?parseInt(this.Dl.qe.value,10):-1;return Object(h.a)(new Vd,
{Aggregation:0<=Bb?Bb:-1})}qla(){return this.isVisible}jpa(Bb){return this.isVisible=Bb}get title(){return X.a.instance.ha(1118)}get enabled(){return!this.Dl.$k.disabled}set enabled(Bb){this.Dl.$k.disabled=!Bb}get Dl(){return this.vje}setFocus(){K.DOMElementExtensions.setFocus(this.Dl.$k)}render(Bb){Bb.appendChild(this.domElement)}dispose(){lb.a.Ja(this.Dl);super.dispose()}focus(){K.DOMElementExtensions.setFocus(this.Dl.$k)}LGj(Bb){this.Dl.VCc();for(const ac of Bb.AggregationTypes){const tc=ac===
Bb.SelectedAggregation;this.Dl.Z0b(ue.oTh(ac),ac.toString(),tc,"")}this.Dl.iac();this.Dl.$k.disabled=Bb.AggregationsDisabled}Kvj(){this.Dl.J2f()}Ola(){this.Sb.uh(this.domElement,String.format($d,X.a.instance.ha(1103),X.a.instance.ha(1104)));this.vje=new mc.a(K.DOMElementExtensions.getElementById(this.domElement,ue.lQf),!1)}static oTh(Bb){switch(Bb){case 0:return X.a.instance.ha(1106);case 1:return X.a.instance.ha(1107);case 2:return X.a.instance.ha(1108);case 3:return X.a.instance.ha(1109);case 4:return X.a.instance.ha(1110);
case 5:return X.a.instance.ha(1111);case 6:return X.a.instance.ha(1112);case 7:return X.a.instance.ha(1113);case 8:return X.a.instance.ha(1114);case 9:return X.a.instance.ha(1115);case 10:return X.a.instance.ha(1116);case 11:return X.a.instance.ha(1117);default:return""}}}ue.lQf="pivotDataFieldSelect";Object(b.a)(ue,"SummarizeValuesByControl",Hb.a,[372,2]);var he=a(219),Ge=a(475),Ad=a(1289);class Ie extends Xb.a{constructor(Bb,ac,tc,ub,jc,Ka,zb,Yb,oc,Wc){super(jc,X.a.instance.qb(61),!0,2,!0);this.Ybg=
!0;this.Sb=this.xWc=this.T9c=this.Nub=this.Wga=this.mUa=this.ape=null;this.TTi=vd=>{mb.a.any(vd.Errors,Dd=>-103190598===Dd.MessageId)&&this.RUa.Kvj()};this.n_i=vd=>{vd&&!la.a(vd)&&(vd=vd.Result,this.Sb.q8f(this.T9c,X.a.instance.ha(1101)+gb.a.Jh(vd.ValueFieldSourceName)),this.isOlap&&!this.dW?(this.RUa.enabled=!1,this.Wga.activeTab=this.Wga.SDc-1):(this.RUa.enabled=!0,this.Wga.activeTab=0),this.RUa.LGj(vd.PivotValueFieldSettingsSummarizeValueByInfo),this.mUa.MGj(vd.PivotValueFieldShowValueAsInitialInfo),
this.qg())};this.cell=Bb;this.To=ac;this.externalSourceIndex=tc;this.Ypg=ub;this.Ld=Ka;this.Gua=zb;this.isOlap=Yb;this.dW=oc;this.Sb=Wc}get uc(){return"ValueFieldSettingsDialog"}get IDa(){return this.ape}get HGb(){return this.Wga}get RUa(){return this.xWc}get gC(){return 560}dispose(){this.T9c=this.Nub=this.mUa=this.xWc=null;lb.a.Ja(this.Wga);this.Wga=null;super.dispose()}initialize(){let Bb="<div id='"+Qd.RMe+"' class='"+te.a.Vp+"'></div><div id='"+Qd.gnh+"' class='"+te.a.Vp+"'><label for='"+Qd.Y3d+
"'>{0}</label><input type='text' id='"+Qd.Y3d+"' value='{1}' class='"+te.a.yH+" UIFont' /></div><div id='"+Qd.Zpg+"'></div>";Bb=String.format(Bb,X.a.instance.ha(1102),gb.a.Jh(this.Ypg));this.Sb.uh(this.dc,Bb);this.Uf||(this.uta(),this.Rt());this.ape=[-103190598];this.Eai();super.initialize()}close(Bb){1===Bb&&(this.Ybg=!1);super.close(Bb)}fPe(Bb){this.isDisabled=Bb;this.domElement.disabled=Bb;const ac=["input","option","select"];for(let tc=0,ub=ac.length;tc<ub;++tc){const jc=this.domElement.getElementsByTagName(ac[tc]);
for(let Ka=0;Ka<jc.length;++Ka)jc[Ka].disabled=Bb}}Rt(){this.Nub=document.getElementById(Qd.Y3d);this.T9c=K.DOMElementExtensions.getElementById(this.dc,Qd.RMe);const Bb=K.DOMElementExtensions.getElementById(this.dc,Qd.Zpg);this.xWc=new ue(document.createElement("div"),this.Sb);this.mUa=new pd(document.createElement("div"),this.$,this.cell,this.To,this.externalSourceIndex,this.Ld,this.Gua,!this.isOlap,this.Sb);this.Wga=new Ad.a(Bb,new db.a([this.RUa,this.mUa]));this.Wga.V_f()}dJd(){const Bb=new Ie(this.cell,
this.To,this.externalSourceIndex,this.Ypg,this.$,this.Ld,this.Gua,this.isOlap,this.dW,this.Sb);Bb.initialize();Bb.qg()}vSb(){const Bb=new Ge.a;if(!this.Ybg)return Bb.isValid=!0,Bb;this.Nub.value.length?Bb.isValid=!0:(this.fPe(!0),Bb.error=Y.a.nd(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),this.isDisabled=!0,this.Uf||(this.uz.disabled=!0),Bb.isValid=!1);return Bb}vcf(){this.isDisabled=!1;this.Uf||(this.uz.disabled=!1);this.fPe(!1)}bAa(Bb){const ac=new U.a(2105621672,0,this.$.Bc,30,null);
this.$.Ia.Nb(ac);this.jA(5,Bb.Cb,"Number Format");return!0}vq(){this.$pa=String.format(X.a.instance.qb(61),null);super.vq()}setFocus(){if(this.Uf){const Bb=K.DOMElementExtensions.getElementById(this.dc,ue.lQf);he.a.A1d(Bb)}else this.Wga.setFocus()}nk(){const Bb=this.mUa.$yb,ac=new Pc(Bb.SelectedDataFormat,Bb.SelectedBaseField,Bb.SelectedBaseItem);return()=>new Ne(this.externalSourceIndex,this.cell,this.Nub.value,this.RUa.$yb.Aggregation,ac)}oH(){const Bb=Object(h.a)(new Xd,{PivotValueFieldSummarizeValueByApplyData:this.RUa.$yb,
PivotValueFieldShowValueAsApplyData:this.mUa.$yb,PivotValueFieldTitle:this.Nub.value});return(ac,tc,ub)=>{var jc=this.$.pa.va;ac=ua.b(ac,this.TTi);const Ka=P.L(jc,this.cell,this.externalSourceIndex,this.To);Ka.pivotValueFieldSettingsApplyData=Bb;return P.g(jc,"ApplyPivotValueFieldSettings",Ka,ac,tc,ub,null,0)}}kN(Bb){this.$.da.kb(40,()=>{this.mUa.kN(Bb)})}Eai(){this.$.userOperationManager.Tc(new R.a(123,0,(Bb,ac,tc)=>{var ub=this.$.pa.va;Bb=ua.b.call(null,Bb,this.n_i);const jc=P.L(ub,this.cell,this.externalSourceIndex,
this.To);return P.g(ub,"GetPivotValueFieldSettingsInitial",jc,Bb,ac,tc,null,4)},16),this.Ld)}}Object(b.a)(Ie,"ValueFieldSettingsDialog",Xb.a,[]);const me=n.a.mdh;class cc extends m.a{constructor(Bb,ac,tc,ub){super(Bb,"PopulateFieldWellContextMenu",1374696078,495005930,me,!0,!1,me,ac,tc,!1,ub);this.To=this.Jo=this.cell=null;this.j5d=this.externalSourceIndex=-1;this.zUa=0;this.JCc=-1;this.ML=null;this.Q4a=this.dW=this.isOlap=!1}get nx(){return"PopulateFieldWellContextMenu"}get TB(){return n.a.ILd}executeCommand(Bb,
ac,tc,ub){Bb=ac.command;switch(Bb){case -1453503574:ub=tc.domElement;this.Jo=tc.fieldItem;this.j5d=tc.zoneCount;this.zUa=tc.sourceAxis;this.JCc=tc.sourceAxisPos;this.To=tc.optionalPivotMenuAnchorParameter;this.ML=tc.versionkey;this.isOlap=tc.isOlap;this.dW=tc.isPpm;this.Q4a="fieldItemsupportsImplicitMeasures"in tc?tc.fieldItemsupportsImplicitMeasures:!1;this.cell=tc.cell;this.externalSourceIndex=tc.externalSourceIndex;Ha.h(this.$).Xo(!0);ub=K.DOMElementExtensions.getBounds(ub);Bb=new Sys.UI.Point(ub.x,
ub.y+ub.height);this.$.isChromeRtl&&(Bb.x+=ub.width);"isKeyboardInput"in tc&&tc.isKeyboardInput?this.to(Bb,!1,1):this.to(Bb,!1);break;case 495005930:break;case -1170196828:Ib.a(this.$).nK(this.Jo,this.zUa,this.JCc-1,this.ML,ac);break;case -889576107:Ib.a(this.$).nK(this.Jo,this.zUa,this.JCc+2,this.ML,ac);break;case 2033235475:Ib.a(this.$).nK(this.Jo,this.zUa,this.j5d,this.ML,ac);break;case 389774337:Ib.a(this.$).nK(this.Jo,this.zUa,0,this.ML,ac);break;case -96230454:Ib.a(this.$).nK(this.Jo,4,-1,this.ML,
ac);break;case 74086617:Ib.a(this.$).nK(this.Jo,1,-1,this.ML,ac);break;case 1529312473:Ib.a(this.$).nK(this.Jo,2,-1,this.ML,ac);break;case 563292088:this.Q4a&&r.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Ib.a(this.$).nK(this.Jo,8,-1,this.ML,ac);break;case -1092351914:Ib.a(this.$).nK(this.Jo,0,-1,this.ML,ac);break;case -2141589616:const jc=Object(Ub.b)("OfficeVSO:7629428_MigrateSharedUIControlsFactoryService")?Object(W.d)(sb.a.resolve(ib.X,{rb:ub.EV()})):
E.GetServiceTaskFactory.Sa(this.$.da,12,477,ub.EV()),Ka=Object(W.d)(sb.a.resolve(ib.F,{rb:ub.EV()}));return N.TaskExtensions.za(N.TaskExtensions.Pd([jc,Ka],this.$.ka),()=>{(new Ie(this.cell,this.To,this.externalSourceIndex,this.Jo.Name,this.$,ac,jc.result,this.isOlap,this.dW,Ka.result)).initialize()},this.ka);default:return ha.a(Bb)}return f.Task.Ua(!0)}Ac(Bb,ac,tc){Bb=!1;switch(ac.command){case -1453503574:Bb=!!tc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:Bb=
!0}return Bb}vZ(){const Bb=this.Xa.Nq(this.menuId);this.Gbj(Bb,this.JCc,this.j5d);this.Hbj(Bb,this.zUa);this.Ibj(Bb);8===this.zUa&&this.Ebj(Bb);return Bb}Gbj(Bb,ac,tc){const ub=this.Xa,jc=ub.Nc();ac||ac!==tc-1?!ac&&ac<tc-1?(jc.buttons.push(ub.tb(64)),jc.buttons.push(ub.tb(61)),jc.buttons.push(ub.tb(66)),jc.buttons.push(ub.tb(63))):0<ac&&ac<tc-1?(jc.buttons.push(ub.tb(60)),jc.buttons.push(ub.tb(61)),jc.buttons.push(ub.tb(62)),jc.buttons.push(ub.tb(63))):0<ac&&ac===tc-1&&(jc.buttons.push(ub.tb(60)),
jc.buttons.push(ub.tb(65)),jc.buttons.push(ub.tb(62)),jc.buttons.push(ub.tb(67))):(jc.buttons.push(ub.tb(64)),jc.buttons.push(ub.tb(65)),jc.buttons.push(ub.tb(66)),jc.buttons.push(ub.tb(67)));Bb.Cc.push(jc)}Hbj(Bb,ac){const tc=this.Xa,ub=tc.Nc(),jc=1!==ac&&(!this.isOlap||this.dW||8!==ac||this.Q4a),Ka=2!==ac&&(!this.isOlap||this.dW||8!==ac||this.Q4a),zb=8!==ac&&-2!==this.Jo.PivotTableIndex&&(!this.isOlap||this.dW||this.Q4a);ub.buttons.push(tc.tb(4===ac||this.Jo.IsSet||-2===this.Jo.PivotTableIndex||
this.isOlap&&!this.dW&&8===ac&&!this.Q4a?72:68));8===this.To.AnchorType||10===this.To.AnchorType?(ub.buttons.push(tc.tb(jc?95:97)),ub.buttons.push(tc.tb(Ka?96:98))):(ub.buttons.push(tc.tb(jc?69:73)),ub.buttons.push(tc.tb(Ka?70:74)));ub.buttons.push(tc.tb(zb?71:75));Bb.Cc.push(ub)}Ibj(Bb){const ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(76));Bb.Cc.push(ac)}Ebj(Bb){const ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(77));Bb.Cc.push(ac)}}Object(b.a)(cc,"FieldWellContextMenu",m.a,[]);var $c=a(1268);class rd extends Nb{constructor(Bb,
ac,tc,ub){super(Bb,"PopulatePivotContextMenu",2123758504,912277356,ac,tc,ub)}get nx(){return"PopulatePivotContextMenu"}get TB(){return n.a.DVf}executeCommand(Bb,ac,tc){let ub=!1;const jc=ac.command;switch(jc){case 37023044:ub=this.Vdd(tc,ac);break;case 541421805:case -569786022:ub=this.wnd(Bb,ac)}return ub?f.Task.Ua(!0):ha.a(jc)}Ac(Bb,ac,tc){Bb=!1;switch(ac.command){case 37023044:Bb=!!tc;break;case 541421805:case -569786022:Bb=!0}return Bb}wnd(Bb,ac){var tc=8===Bb,ub=this.$,jc=Pb.a(ub),Ka=Ha.h(ub).ga.Ra.oc;
let zb=Bb=null;tc&&jc?(Bb=jc.chartId,zb=jc.jd):!tc&&Ka&&(Bb=Ka.floatingObject.id,zb=Ka.floatingObject.jd);return rd.Kxe(zb,260)?(tc={},ub.gk(tc),tc.FirstColumn=tc.FirstRow=-1,ub={["rawEvent"]:null,["pivotName"]:null,["cell"]:tc,["requiresConfirmation"]:rd.Kxe(zb,64),["dataSourceIndex"]:zb.ExternalSourceIndex},Ka?(jc=Ka.floatingObject,ub.domElement=Ka.domElement,ub.objectId=jc.id,ub.objectVersion=jc.version):jc&&(ub.domElement=jc.xp,ub.objectId=jc.chartId,ub.objectVersion=jc.lEe),Ka={AnchorType:7},
Ka.ChartId=Bb,Ka.AnchorValue1=-1,Ka.AnchorValue2=-1,ub.optionalPivotMenuAnchorParameter=Ka,this.Vdd(ub,ac)):!1}static Kxe(Bb,ac){return(Bb.Attributes&ac)===ac}}Object(b.a)(rd,"PivotFilterContextMenu",Nb,[]);var Nd=a(1343),ed=a(834);const yd=(Bb,ac,tc,ub,jc,Ka,zb,Yb,oc,Wc=null)=>{Wc=Bb.Oa(41,Wc);Wc.activeCell=ac;Wc.operationType=tc;Wc.fieldCaption=ub;Wc.prevFieldCaption=jc;return P.g(Bb,"ExecutePivotTableOperation",Wc,Ka,zb,Yb,oc,0)},Ed=(Bb,ac,tc,ub,jc,Ka,zb,Yb=null)=>{Yb=Bb.Oa(41,Yb);Yb.activeCell=
ac;Yb.pivotValueFieldSettingsApplyData=tc;return P.g(Bb,"ApplyValueFieldSettingsToPivotTable",Yb,ub,jc,Ka,zb,0)};var Ud=a(162),fe=a(380),We=a(294),lf=a(31),Se=a(23);const Ae=n.a.qdh,Qe=Ae+".RemoveField",$e=Ae+".Subtotal",of=Ae+".ClearFilter",re=Ae+".LayoutSameColumn",zf=Ae+".LayoutNextColumn";class Lf extends m.a{constructor(Bb,ac,tc,ub,jc){super(Bb,"PopulatePivotTableContextMenu",-1475408662,1114549926,Ae,!0,!1,"PivotTableContextMenuRootName",ac,tc,!0,ub);this.N4d=this.activeCell=this.Tb=null;this.SZ=
this.refresh=this.expandCollapse=this.Osd=this.imc=!1;this.Acb=this.yb=this.D2a=this.xA=this.Je=null;this.Sca=!1;this.LZi=Ka=>{Ka&&!Y.a.lg(Ka.Errors)&&this.Tb&&(this.Tb.jp=Ka.Result,this.eOb());this.showPivotTableContextMenu()};this.KZi=()=>{};this.r2i=()=>{this.neb()};this.q2i=()=>{this.neb()};this.YTi=()=>{this.neb()};this.XTi=()=>{this.neb()};this.Fy=()=>{this.Y1d();this.Sca=!1};this.cr=()=>{if(this.Sca){r.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
const Ka=this.Tb;this.grid.wb.rp(this.grid.ga.qa.activeCell)!==Ka&&(this.neb(),this.Whi())}};this.Ath=new DOMParser;this.cLj=!0;this.grid=Ha.h(Bb);this.hpc=!0;this.Ev=jc}get nx(){return"PopulatePivotTableContextMenu"}get TB(){return n.a.EVf}executeCommand(Bb,ac,tc){ac=ac.command;Bb=null;this.grid=Ha.h(this.$);this.activeCell=M.o(this.grid.ga.qa.activeCell,this.$);if(this.$.isEditMode&&(this.Tb=this.grid.wb.rp(this.grid.ga.qa.activeCell),!this.Tb))return r.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),
N.TaskExtensions.mca();this.N4d=this.$.pa.va;this.D2a=Object(Sa.a)(Ab.a,tc.eventArgs);switch(ac){case 671488277:this.dNj()?this.O4h():(this.neb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case 1885005049:ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableDeleteInContextMenu",!1)&&this.performPivotTableOperation(1885005049,19);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,
10);break;case -771066011:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.LTa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.LTa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.LTa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.LTa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.LTa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;
case -1067664355:this.LTa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:tc=Number.parseInvariant(tc.MenuItemId.split(".")[2]);this.LTa(11,tc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Xc(-1556797033,A.a.Eb,8,null);break;case 1514686611:this.EEi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:tc=
Number.parseInvariant(tc.MenuItemId);this.w9g(tc);break;case 1778578888:tc=Number.parseInvariant(tc.MenuItemId);this.wWg(tc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,
16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:Bb=ha.a(ac)}return Bb||N.TaskExtensions.mca()}Ac(Bb,ac){Bb=!1;switch(ac.command){case 671488277:Bb=ed.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:Bb=!0;break;case 1600778266:Bb=!0;break;case -556893687:Bb=!0;break;case -1966978671:Bb=!0;break;case 1885005049:Bb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableDeleteInContextMenu",
!1);break;case -1951357930:Bb=!0;break;case -1390365353:case -1457478532:Bb=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:Bb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:Bb=!0;break;case -1007663920:case 234234584:case 1194992911:Bb=!0;break;
case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:Bb=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:Bb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return Bb}dNj(){if(!this.$.isEditMode||this.Tb.Tjc)return!1;let Bb=this.Oag(!1);return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.Tb.isOlap||Bb:!this.Tb.Ykc()||Bb}Oc(Bb,ac){let tc=!1;switch(ac){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:tc=this.cJ();break;case 1885005049:tc=!ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableDeleteInContextMenu",
!1)||this.cJ();break;case -1007663920:case 234234584:tc=this.vLj()||this.cJ();break;case 1194992911:tc=this.wLj()||this.cJ();break;case 1217404289:tc=!Nd.j(this.yb.LabelOrDateFilterType)||this.cJ();break;case -743135194:tc=!Nd.m(this.yb.ValueFilterType)&&!Nd.l(this.yb.ValueFilterType)||this.cJ();break;case 771421327:tc=0===this.yb.LabelOrDateFilterType&&0===this.yb.ValueFilterType&&!this.yb.HasManualFilter||this.cJ();break;case 1015867427:tc=!Nd.i(this.yb.LabelOrDateFilterType)||this.cJ();break;case 1105960559:tc=
!Nd.k(this.yb.LabelOrDateFilterType)||this.cJ()}return tc||super.Oc(Bb,ac)}neb(){this.Acb=this.yb=this.Je=null}nZd(){this.grid.cU(this.cr);this.$.Ia.G_a(this.Fy)}Y1d(){this.grid.pO(this.cr);this.$.Ia.KLb(this.Fy)}eOb(){if(this.Tb&&this.Tb.jp){this.Je=this.Tb.jp;this.yb=this.Tb.fec();if(this.Ibg()){const Bb=this.Tb.tL[4===this.Je.CellType?this.Tb.V9c-1:this.Je.CurrentFieldIndex-1];Bb&&(this.Acb=-2===Bb.Index?this.Tb.WMe:Bb.Caption)}this.Kli();this.yb&&8===this.Je.CellArea&&(this.xA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
this.yb.DataFieldAggregationType,this.xA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.yb.DataFieldFormatType,this.xA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.yb.BaseFieldIndex,this.xA.PivotValueFieldTitle=this.yb.Caption)}}Oag(Bb){return this.Tb?this.Tb.isOlap&&!this.Tb.UOa(!Bb):!1}ELj(){const Bb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.yb.MeasureType&&(!this.Tb.Eof||Bb&&2===this.yb.MeasureType)}vZ(){const Bb=
this.Xa.Nq(this.menuId),ac=this.Xa.Nc(),tc=Ha.h(this.$).Ob(null);if(this.Tb)this.Je&&this.Tb.jp&&this.Je!==this.Tb.jp&&r.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.yb&&this.yb!==this.Tb.fec()&&r.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return Bb;this.wQh(Bb);if(this.$.isEditMode){this.refresh&&this.PRh(Bb);if(this.Je&&this.yb){var ub=this.Xa.Nc();this.gSh(ub);this.MQh(ub);
Bb.Cc.push(ub)}this.SZ&&ac.buttons.push(this.Xa.tb(99));this.Je&&this.yb&&this.lRh(Bb);if(this.expandCollapse){ub=this.Xa.Gw("ContextMenu.PivotExpandCollapse",null,X.a.instance.ha(1167),589118293);const jc=this.Xa.Nc();jc.buttons.push(this.Xa.tb(243));jc.buttons.push(this.Xa.tb(244));jc.buttons.push(this.Xa.tb(245));jc.buttons.push(this.Xa.tb(246));ub.menu.Cc.push(jc);ub&&0<jc.buttons.length&&ac.buttons.push(ub)}this.Je&&(ub=this.Xa.Nc(),ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&this.wRh(ub),ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableDeleteInContextMenu",!1)&&this.FQh(ub),this.QRh(ub),0<ub.buttons.length&&Bb.Cc.push(ub));this.Je&&this.yb&&8===this.Je.CellArea&&8!==this.Je.CellType&&(ub=this.Xa.Nc(),this.ELj()&&this.iSh(ub),3!==this.Je.CellType&&this.bSh(ub),Bb.Cc.push(ub));!this.Tb.Ykc()&&""!==(null===tc||void 0===tc?void 0:tc.text)&&this.Je&&0===this.Je.CellType&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",
!1)&&this.aSh(Bb);this.Jxi()?ac.buttons.push(this.Xa.tb(257)):ac.buttons.push(this.Xa.tb(258));this.Osd?ac.buttons.push(this.Xa.tb(59)):ac.buttons.push(this.Xa.tb(58))}Bb.Cc.push(ac);return Bb}aUa(){return this.yb&&this.yb.Caption?20<this.yb.Caption.length:!1}cMa(Bb){return this.yb&&this.yb.Caption?Bb?this.yb.Caption.substring(0,20)+"...":this.yb.Caption:""}Lwa(Bb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?Se.a.hashCode(Bb).toString():Bb}gSh(Bb){if(this.Je&&
this.yb&&4!==this.Je.CellArea){var ac=this.Ika(this.JH("PivotTableContextMenu.Sort",this.Lwa(this.yb.Caption)),-1777747317,0,0!==this.yb.SortInfo,X.a.instance.ha(227)),tc=this.Xa.Nc();tc.buttons.push(this.$d("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.yb.SortInfo,X.a.instance.ha(228)));tc.buttons.push(this.$d("PivotTableContextMenu.SortDescending",234234584,0,2===this.yb.SortInfo,X.a.instance.ha(229)));1!==this.Je.CellArea&&2!==this.Je.CellArea||tc.buttons.push(this.$d("PivotTableContextMenu.SortByValue",
1194992911,0,3===this.yb.SortInfo||4===this.yb.SortInfo,X.a.instance.ha(153)));ac.menu.Cc.push(tc);ac&&0<tc.buttons.length&&Bb.buttons.push(ac)}}MQh(Bb){if(this.Je&&this.yb&&(1===this.Je.CellArea||2===this.Je.CellArea)){var ac=this.cNj();const Ka=this.Ika(this.JH("PivotTableContextMenu.Filter",this.Lwa(this.yb.Caption)),-1777747317,0,ac,X.a.instance.ha(651)),zb=this.Xa.Nc();var tc="",ub=this.aUa(),jc=String.format(X.a.instance.qb(156),this.cMa(ub));ub&&(tc=String.format(X.a.instance.qb(156),this.yb.Caption));
ac=this.Lwa(this.yb.Caption)+"."+(ac?"enabled":"disabled");tc=this.$d(this.JH(of,ac),771421327,0,!1,jc,"0",tc,8,ab.a.D4a);ac=this.Lwa(this.yb.Caption)+"."+this.yb.LabelOrDateFilterType.toString();this.yb.IsDateField?(jc=this.Ika(this.JH("PivotTableContextMenu.DateFilter",ac),-1777747317,0,0!==this.yb.LabelOrDateFilterType,X.a.instance.ha(96)),this.zQh(jc.menu)):(jc=this.Ika(this.JH("PivotTableContextMenu.LabelFilter",ac),-1777747317,0,0!==this.yb.LabelOrDateFilterType,X.a.instance.ha(649)),this.kRh(jc.menu));
ac=this.Lwa(this.yb.Caption)+"."+this.yb.ValueFilterType.toString();ac=this.Ika(this.JH("PivotTableContextMenu.ValueFilter",ac),-1777747317,0,0!==this.yb.ValueFilterType,X.a.instance.ha(650));this.uSh(ac.menu);ub=this.Xa.Nc();ub.buttons.push(this.$d("PivotTableContextMenu.ManualFilter",1514686611,0,this.yb.HasManualFilter,X.a.instance.ha(93)));zb.buttons.push(tc);zb.buttons.push(jc);zb.buttons.push(ac);Ka.menu.Cc.push(zb);Ka.menu.Cc.push(ub);Ka&&0<zb.buttons.length&&Bb.buttons.push(Ka)}}zQh(Bb){Bb.Cc.push(this.Aec(!0,
!1));Bb.Cc.push(this.TXh());Bb.Cc.push(this.SXh());Bb.Cc.push(this.LZh());Bb.Cc.push(this.OZh());Bb.Cc.push(this.MZh());Bb.Cc.push(this.NZh());Bb.Cc.push(this.PZh());Bb.Cc.push(this.QZh());Bb.Cc.push(this.GXh())}nQh(Bb){Bb.Cc.push(this.Aec(!0,!0));Bb.Cc.push(this.O5h());Bb.Cc.push(this.S2h())}kRh(Bb){Bb.Cc.push(this.Aec(!0,!1));Bb.Cc.push(this.A5e(!0));Bb.Cc.push(this.lUh());Bb.Cc.push(this.UWh());Bb.Cc.push(this.A4e(!0));Bb.Cc.push(this.w3e(!0))}uSh(Bb){Bb.Cc.push(this.Aec(!1,!1));Bb.Cc.push(this.A5e(!1));
Bb.Cc.push(this.A4e(!1));Bb.Cc.push(this.w3e(!1));Bb.Cc.push(this.x$h())}x$h(){const Bb=this.Xa.Nc();Bb.buttons.push(this.$d("PivotTableContextMenu.Top10",-1611233597,0,Nd.l(this.yb.ValueFilterType),X.a.instance.ha(104)));return Bb}UWh(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.Contains",786260386,0,10===this.yb.LabelOrDateFilterType,X.a.instance.ha(652),"10")),Bb.buttons.push(this.$d("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.yb.LabelOrDateFilterType,
X.a.instance.ha(653),"11")));return Bb}lUh(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.BeginsWith",786260386,0,6===this.yb.LabelOrDateFilterType,X.a.instance.ha(654),"6")),Bb.buttons.push(this.$d("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.yb.LabelOrDateFilterType,X.a.instance.ha(655),"7")),Bb.buttons.push(this.$d("PivotTableContextMenu.EndsWith",786260386,0,8===this.yb.LabelOrDateFilterType,X.a.instance.ha(656),"8")),Bb.buttons.push(this.$d("PivotTableContextMenu.DoesNotEndWith",
786260386,0,9===this.yb.LabelOrDateFilterType,X.a.instance.ha(657),"9")));return Bb}A5e(Bb){const ac=this.Xa.Nc();if(this.yb){const tc=Bb?Nd.c:Nd.f;ac.buttons.push(this.$d(this.JH("PivotTableContextMenu.Equals",tc),786260386,0,Bb?4===this.yb.LabelOrDateFilterType:18===this.yb.ValueFilterType,X.a.instance.ha(99),Bb?"4":"18"));ac.buttons.push(this.$d(this.JH("PivotTableContextMenu.DoesNotEqual",tc),786260386,0,Bb?5===this.yb.LabelOrDateFilterType:19===this.yb.ValueFilterType,X.a.instance.ha(100),Bb?
"5":"19"))}return ac}A4e(Bb){const ac=this.Xa.Nc();if(this.yb){const tc=Bb?Nd.c:Nd.f;ac.buttons.push(this.$d(this.JH("PivotTableContextMenu.GreaterThan",tc),786260386,0,Bb?12===this.yb.LabelOrDateFilterType:20===this.yb.ValueFilterType,X.a.instance.ha(101),Bb?"12":"20"));ac.buttons.push(this.$d(this.JH("PivotTableContextMenu.GreaterThanOrEqualTo",tc),786260386,0,Bb?13===this.yb.LabelOrDateFilterType:21===this.yb.ValueFilterType,X.a.instance.ha(658),Bb?"13":"21"));ac.buttons.push(this.$d(this.JH("PivotTableContextMenu.LessThan",
tc),786260386,0,Bb?14===this.yb.LabelOrDateFilterType:22===this.yb.ValueFilterType,X.a.instance.ha(102),Bb?"14":"22"));ac.buttons.push(this.$d(this.JH("PivotTableContextMenu.LessThanOrEqualTo",tc),786260386,0,Bb?15===this.yb.LabelOrDateFilterType:23===this.yb.ValueFilterType,X.a.instance.ha(659),Bb?"15":"23"))}return ac}w3e(Bb){const ac=this.Xa.Nc();if(this.yb){const tc=Bb?Nd.c:Nd.f;ac.buttons.push(this.$d(this.JH("PivotTableContextMenu.Between",tc),786260386,0,Bb?16===this.yb.LabelOrDateFilterType:
24===this.yb.ValueFilterType,X.a.instance.ha(103),Bb?"16":"24"));ac.buttons.push(this.$d(this.JH("PivotTableContextMenu.NotBetween",tc),786260386,0,Bb?17===this.yb.LabelOrDateFilterType:25===this.yb.ValueFilterType,X.a.instance.ha(660),Bb?"17":"25"))}return ac}Aec(Bb,ac){const tc=this.Xa.Nc();if(this.yb){var ub=X.a.instance.ha(97);const Ka=Bb?this.yb.LabelOrDateFilterType.toString():this.yb.ValueFilterType.toString();var jc=["PivotTableContextMenu.ClearFilter",this.Lwa(this.yb.Caption),Ka];Bb=Bb?
this.yb.IsDateField?ac?1015867427:1105960559:1217404289:-743135194;jc.push(Bb.toString());jc=jc.join(".");ub=this.$d(jc,Bb,0,!1,ub,Ka,ub,8,ab.a.D4a);tc.buttons.push(ub)}return tc}TXh(){const Bb=this.Xa.Nc();this.yb&&Bb.buttons.push(this.$d(this.JH("PivotTableContextMenu.Equals",Nd.d),786260386,0,26===this.yb.LabelOrDateFilterType,X.a.instance.ha(99),"26"));return Bb}SXh(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.Before",786260386,0,27===this.yb.LabelOrDateFilterType,
X.a.instance.ha(111),"27")),Bb.buttons.push(this.$d("PivotTableContextMenu.After",786260386,0,28===this.yb.LabelOrDateFilterType,X.a.instance.ha(112),"28")),Bb.buttons.push(this.$d("PivotTableContextMenu.Between",786260386,0,29===this.yb.LabelOrDateFilterType,X.a.instance.ha(103),"29")));return Bb}LZh(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.yb.LabelOrDateFilterType,X.a.instance.ha(109),"30")),Bb.buttons.push(this.$d("PivotTableContextMenu.Today",
1778578888,0,31===this.yb.LabelOrDateFilterType,X.a.instance.ha(108),"31")),Bb.buttons.push(this.$d("PivotTableContextMenu.Yesterday",1778578888,0,32===this.yb.LabelOrDateFilterType,X.a.instance.ha(110),"32")));return Bb}OZh(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.NextWeek",1778578888,0,33===this.yb.LabelOrDateFilterType,X.a.instance.ha(114),"33")),Bb.buttons.push(this.$d("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.yb.LabelOrDateFilterType,X.a.instance.ha(113),
"34")),Bb.buttons.push(this.$d("PivotTableContextMenu.LastWeek",1778578888,0,35===this.yb.LabelOrDateFilterType,X.a.instance.ha(115),"35")));return Bb}MZh(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.NextMonth",1778578888,0,36===this.yb.LabelOrDateFilterType,X.a.instance.ha(116),"36")),Bb.buttons.push(this.$d("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.yb.LabelOrDateFilterType,X.a.instance.ha(117),"37")),Bb.buttons.push(this.$d("PivotTableContextMenu.LastMonth",
1778578888,0,38===this.yb.LabelOrDateFilterType,X.a.instance.ha(118),"38")));return Bb}NZh(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.yb.LabelOrDateFilterType,X.a.instance.ha(119),"39")),Bb.buttons.push(this.$d("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.yb.LabelOrDateFilterType,X.a.instance.ha(120),"40")),Bb.buttons.push(this.$d("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.yb.LabelOrDateFilterType,
X.a.instance.ha(121),"41")));return Bb}PZh(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.NextYear",1778578888,0,42===this.yb.LabelOrDateFilterType,X.a.instance.ha(122),"42")),Bb.buttons.push(this.$d("PivotTableContextMenu.ThisYear",1778578888,0,43===this.yb.LabelOrDateFilterType,X.a.instance.ha(123),"43")),Bb.buttons.push(this.$d("PivotTableContextMenu.LastYear",1778578888,0,44===this.yb.LabelOrDateFilterType,X.a.instance.ha(124),"44")));return Bb}QZh(){const Bb=
this.Xa.Nc();if(this.yb){Bb.buttons.push(this.$d("PivotTableContextMenu.YearToDate",1778578888,0,45===this.yb.LabelOrDateFilterType,X.a.instance.ha(125),"45"));const ac=this.Ika("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Nd.i(this.yb.LabelOrDateFilterType),X.a.instance.ha(126));this.nQh(ac.menu);Bb.buttons.push(ac)}return Bb}GXh(){const Bb=this.Xa.Nc();this.yb&&Bb.buttons.push(this.$d("PivotTableContextMenu.CustomFilter",786260386,0,this.ZMj(this.yb.LabelOrDateFilterType),X.a.instance.ha(107),
"26"));return Bb}O5h(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.Quarter1",1778578888,0,46===this.yb.LabelOrDateFilterType,X.a.instance.ha(127),"46")),Bb.buttons.push(this.$d("PivotTableContextMenu.Quarter2",1778578888,0,47===this.yb.LabelOrDateFilterType,X.a.instance.ha(128),"47")),Bb.buttons.push(this.$d("PivotTableContextMenu.Quarter3",1778578888,0,48===this.yb.LabelOrDateFilterType,X.a.instance.ha(129),"48")),Bb.buttons.push(this.$d("PivotTableContextMenu.Quarter4",
1778578888,0,49===this.yb.LabelOrDateFilterType,X.a.instance.ha(130),"49")));return Bb}S2h(){const Bb=this.Xa.Nc();this.yb&&(Bb.buttons.push(this.$d("PivotTableContextMenu.January",1778578888,0,50===this.yb.LabelOrDateFilterType,X.a.instance.ha(131),"50")),Bb.buttons.push(this.$d("PivotTableContextMenu.February",1778578888,0,51===this.yb.LabelOrDateFilterType,X.a.instance.ha(132),"51")),Bb.buttons.push(this.$d("PivotTableContextMenu.March",1778578888,0,52===this.yb.LabelOrDateFilterType,X.a.instance.ha(133),
"52")),Bb.buttons.push(this.$d("PivotTableContextMenu.April",1778578888,0,53===this.yb.LabelOrDateFilterType,X.a.instance.ha(134),"53")),Bb.buttons.push(this.$d("PivotTableContextMenu.May",1778578888,0,54===this.yb.LabelOrDateFilterType,X.a.instance.ha(135),"54")),Bb.buttons.push(this.$d("PivotTableContextMenu.June",1778578888,0,55===this.yb.LabelOrDateFilterType,X.a.instance.ha(136),"55")),Bb.buttons.push(this.$d("PivotTableContextMenu.July",1778578888,0,56===this.yb.LabelOrDateFilterType,X.a.instance.ha(137),
"56")),Bb.buttons.push(this.$d("PivotTableContextMenu.August",1778578888,0,57===this.yb.LabelOrDateFilterType,X.a.instance.ha(138),"57")),Bb.buttons.push(this.$d("PivotTableContextMenu.September",1778578888,0,58===this.yb.LabelOrDateFilterType,X.a.instance.ha(139),"58")),Bb.buttons.push(this.$d("PivotTableContextMenu.October",1778578888,0,59===this.yb.LabelOrDateFilterType,X.a.instance.ha(140),"59")),Bb.buttons.push(this.$d("PivotTableContextMenu.November",1778578888,0,60===this.yb.LabelOrDateFilterType,
X.a.instance.ha(141),"60")),Bb.buttons.push(this.$d("PivotTableContextMenu.December",1778578888,0,61===this.yb.LabelOrDateFilterType,X.a.instance.ha(142),"61")));return Bb}lRh(Bb){const ac=this.Xa.Nc();if(this.Ibg()){var tc=this.Tb.tL[4===this.Je.CellType?this.Tb.V9c-1:this.Je.CurrentFieldIndex-1];if(tc&&this.Acb){var ub=this.Xa.Gw("ContextMenu.PivotTableLayout",null,X.a.instance.ha(647),-1777747317);var jc=this.Xa.Nc();const Ka=String.format(X.a.instance.qb(169),this.Acb),zb=String.format(X.a.instance.qb(170),
this.Acb);jc.buttons.push(this.$d(zf,-1457478532,0,!tc.IsCompactLayout,Ka));jc.buttons.push(this.$d(re,-1390365353,0,tc.IsCompactLayout,zb));ub.menu.Cc.push(jc);ub&&ac.buttons.push(ub)}}if(1===this.Je.CellArea||2===this.Je.CellArea)this.yb.Caption&&(tc="",jc=this.aUa(),ub=String.format(X.a.instance.qb(159),this.cMa(jc)),jc&&(tc=String.format(X.a.instance.qb(159),this.yb.Caption)),1===this.Je.CellArea?(tc=this.Ika("ContextMenu.PivotTableSubtotal",1801458190,0,this.yb.ShowSubtotal,ub),ub=this.Xa.Nc(),
ub.buttons.push(this.Xa.tb(259)),ub.buttons.push(this.$d("ContextMenu.PivotTableSubtotalOnTop",671485366,639,this.yb.ShowSubtotal&&this.yb.ShowSubtotalAtTop)),ub.buttons.push(this.$d("ContextMenu.PivotTableSubtotalOnBottom",772221736,640,this.yb.ShowSubtotal&&!this.yb.ShowSubtotalAtTop)),tc.menu.Cc.push(ub),tc&&0<ub.buttons.length&&ac.buttons.push(tc)):(jc=jc?this.JH($e,this.Lwa(ub)):$e,ac.buttons.push(this.$d(jc,1801458190,0,this.yb.ShowSubtotal,ub,null,tc)))),ac.buttons.push(this.$d("ContextMenu.RepeatItemLabels",
-556893687,642,this.yb.RepeatItemLabels));1===this.Je.CellArea&&ac.buttons.push(this.$d("ContextMenu.PivotBlankLineAfterEachItem",1600778266,641,this.yb.ShowBlankLineAfterEachItem));Bb.Cc.push(ac)}aSh(Bb){const ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(247));Bb.Cc.push(ac)}wRh(Bb){if(this.$.isEditMode&&this.grid){var ac=this.grid.ga.qa.activeRange;if(ac.top===ac.bottom&&ac.left===ac.right&&0!==this.Je.MoveItemsMenuState){ac=this.Ika("PivotTableContextMenu.Move",-1777747317,0,!1,X.a.instance.ha(73));
var tc=this.Xa.Nc();this.lwa(tc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(X.a.instance.qb(162),this.Je.MoveItemName),0===(this.Je.MoveItemsMenuState&1));this.lwa(tc,"PivotTableContextMenu.MoveUp",713270357,String.format(X.a.instance.qb(163),this.Je.MoveItemName),0===(this.Je.MoveItemsMenuState&2));this.lwa(tc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(X.a.instance.qb(160),this.Je.MoveItemName),0===(this.Je.MoveItemsMenuState&4));this.lwa(tc,"PivotTableContextMenu.MoveToEnd",
2054968064,String.format(X.a.instance.qb(161),this.Je.MoveItemName),0===(this.Je.MoveItemsMenuState&8));ac.menu.Cc.push(tc);tc=this.Xa.Nc();this.lwa(tc,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(X.a.instance.qb(167),this.cMa(this.aUa())),0===(this.Je.MoveItemsMenuState&16));this.lwa(tc,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(X.a.instance.qb(164),this.cMa(this.aUa())),0===(this.Je.MoveItemsMenuState&32));this.lwa(tc,"PivotTableContextMenu.MoveDataItemDown",
833996216,String.format(X.a.instance.qb(165),this.cMa(this.aUa())),0===(this.Je.MoveItemsMenuState&64));this.lwa(tc,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(X.a.instance.qb(166),this.cMa(this.aUa())),0===(this.Je.MoveItemsMenuState&128));ac.menu.Cc.push(tc);Bb.buttons.push(ac)}}}FQh(Bb){const ac=this.$d("ContextMenu.DeletePivotTable",1885005049,2292,!1);Bb.buttons.push(ac)}QRh(Bb){var ac="";let tc="";var ub=!1;3===this.Je.CellType?ac=X.a.instance.ha(644):8===this.Je.CellType?
this.Tb&&(ac=String.format(X.a.instance.qb(168),this.Tb.WMe)):this.yb&&((ub=this.aUa())&&(tc=String.format(X.a.instance.qb(168),this.yb.Caption)),ac=String.format(X.a.instance.qb(168),this.cMa(ub)));ac&&(ub=ub?this.JH(Qe,this.Lwa(ac)):Qe,ac=this.$d(ub,-1951357930,0,!1,ac,null,tc,8,ab.a.rdd),Bb.buttons.push(ac))}wQh(Bb){const ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(43));this.yb&&this.Je&&this.$.isEditMode&&(0===this.Je.CellType||4===this.Je.CellType)&&ac.buttons.push(this.Xa.tb(136));if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&
ea.EwaSettings.ya(102)&&this.grid&&this.grid.ga){const tc=this.grid.ga.qa.selectedRanges;tc&&1===tc.length&&(tc[0].isSingle||this.grid.wb.Dya(tc[0]))&&this.grid.wb.Cya(tc[0])&&!this.grid.wb.GBb(tc[0])&&ac.buttons.push(this.Xa.tb(this.grid.wb.ekf(tc[0])?217:216))}Bb.Cc.push(ac)}PRh(Bb){const ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(100));Bb.Cc.push(ac)}iSh(Bb){const ac=2===this.yb.MeasureType&&!this.yb.IsNumeric,tc=this.Xa.Gw("ContextMenu.SummarizeValuesBy",null,X.a.instance.ha(645),-249874296),
ub=this.Xa.Nc();ub.buttons.push(this.$d("ContextMenu.SummarizeValuesBySum",-1255320719,1106,0===this.yb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,ac));ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByCount",1746132849,1107,1===this.yb.DataFieldAggregationType));ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByAverage",-771066011,1108,2===this.yb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,ac));ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByMax",835007294,
1109,3===this.yb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,ac));ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByMin",929115636,1110,4===this.yb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,ac));ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByProduct",1935475057,1111,5===this.yb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.Oag(!0)||ac));2!==this.yb.MeasureType&&(ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByCountNumbers",1475494885,
1112,6===this.yb.DataFieldAggregationType)),ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByStdDeviation",588680636,1113,7===this.yb.DataFieldAggregationType)),ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1114,8===this.yb.DataFieldAggregationType)),ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByVariant",1668427539,1115,9===this.yb.DataFieldAggregationType)),ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1116,
10===this.yb.DataFieldAggregationType)));this.Tb&&this.Tb.Ykc()&&ub.buttons.push(this.$d("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1117,11===this.yb.DataFieldAggregationType));tc.menu.Cc.push(ub);Bb.buttons.push(tc)}bSh(Bb){const ac=this.Xa.Gw("ContextMenu.ShowValuesAs",null,X.a.instance.ha(646),-1128612833),tc=this.Xa.Nc();tc.buttons.push(this.$d("ContextMenu.ShowValuesAsNoCalculation",-841863025,1123,0===this.yb.DataFieldFormatType));tc.buttons.push(this.$d("ContextMenu.ShowValuesAsPercentOfGrandTotal",
-178796371,1130,7===this.yb.DataFieldFormatType));tc.buttons.push(this.$d("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1129,6===this.yb.DataFieldFormatType));tc.buttons.push(this.$d("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1128,5===this.yb.DataFieldFormatType));tc.buttons.push(this.$d("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1133,9===this.yb.DataFieldFormatType));tc.buttons.push(this.$d("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1134,10===this.yb.DataFieldFormatType));
if(this.Tb&&this.Tb.tL&&0<this.Tb.tL.length||this.Tb.Saa&&0<this.Tb.Saa.length){const ub=this.Ika("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1135,11===this.yb.DataFieldFormatType),jc=this.Xa.Nc(),Ka=this.hSh();for(let zb=0;zb<Ka.length;zb++){const Yb=Ka[zb];jc.buttons.push(this.$d("ContextMenu.ShowValuesAsPercentOfParentTotal."+Yb.Caption,-2031744961,1135,11===this.yb.DataFieldFormatType&&this.yb.BaseFieldIndex===Yb.Index,Yb.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+
Yb.Index))}ub.menu.Cc.push(jc);tc.buttons.push(ub)}ac.menu.Cc.push(tc);Bb.buttons.push(ac)}showPivotTableContextMenu(){this.Osd=!0;this.expandCollapse=this.SZ=this.refresh=!1;var Bb=this.$,ac=Ha.h(Bb),tc=ea.EwaSettings.Xw()?this.Ev.r5():bc.a(Bb).r5();if(tc){var ub=Ib.a(Bb);if(null===ub||void 0===ub?0:ub.UVd)this.Osd=Aa.h(Bb.Ue);ub=Bb.nc;this.SZ=tc.supportsBIExplore&&!!Ua.a(Bb)&&ub.z3(32768);ub.allowInteractivity&&(Bb=ac.Ob(null),(null===Bb||void 0===Bb?0:Bb.cell)&&(Bb.cell.w3c||Bb.cell.Fbg)&&(this.expandCollapse=
!0),ub.allowManualDataRefresh&&(this.refresh=!0))}Bb=null;tc=1;this.D2a&&1!==this.D2a.Cb?(Bb=new Sys.UI.Point(this.D2a.clientPoint.x,this.D2a.clientPoint.y),tc=this.D2a.Cb):(ac=ed.e(ac,this.$))&&(Bb=new Sys.UI.Point(ac.x+(this.$.isChromeRtl?0:ac.width),ac.y+ac.height));A.a.Eb=tc;this.imc=3===tc;this.to(Bb,!0,tc);this.Sca=!0;this.nZd()}Whi(){const Bb=new U.a(1114549926,0,this.$.Bc,19,null);this.$.Ia.Nb(Bb)}O4h(){if(this.Tb&&this.Tb.jp){var Bb=this.Tb.jp.CurrentCol;if(this.Tb.jp.CurrentRow===this.activeCell.FirstRow&&
Bb===this.activeCell.FirstColumn){this.eOb();this.showPivotTableContextMenu();return}}Bb=new R.a(228,0,(ac,tc,ub)=>We.l(this.$.pa.va,this.activeCell,ua.b(ac,this.LZi),ua.a(tc,this.KZi),ub,null),16);this.$.userOperationManager.Tc(Bb,null)}Jxi(){if(aa.a.Md()){var Bb=this.$.da.Aa(441);if(Bb)return Bb.ls}else if(Bb=this.$.da.Aa(346))return Bb.ls;return!1}JH(Bb,ac){return Bb+"."+ac}performPivotTableOperation(Bb,ac){const tc=lf.a.Ya.kc;if(!this.Tb||!this.yb&&this.Je&&3!==this.Je.CellType)this.Ij();else{var ub=
this.Tb.isOlap,jc=Ka=>{Ka&&this.$.Tc(Bb,(zb,Yb,oc)=>yd(this.N4d,this.activeCell,ac,this.yb?this.yb.Caption:null,this.Acb,ua.b(zb,this.r2i),ua.a(Yb,this.q2i),oc,null,this.$.pa.va.ic()),tc,0,4,229)};ea.EwaSettings.Xw()?this.Ev.ak(ub,jc):ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void sb.a.resolve(ib.o,{rb:1}).then(Ka=>{Ka.ak(ub,jc)}):bc.a(this.$).ak(ub,jc)}}applyValueFieldSettingsToPivotTable(Bb,ac=!1){const tc=lf.a.Ya.kc;if(this.Tb&&this.yb){ac&&
2===this.yb.MeasureType&&r.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu.");var ub=this.Tb.isOlap,jc=Ka=>{Ka&&this.$.Tc(Bb,(zb,Yb,oc)=>Ed(this.N4d,this.activeCell,this.xA,ua.b(zb,this.YTi),ua.a(Yb,this.XTi),oc,null,this.$.pa.va.ic()),tc,0,4,231)};ea.EwaSettings.Xw()?this.Ev.ak(ub,jc):ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataRefreshManagerPhase1",!1)?void sb.a.resolve(ib.o,{rb:1}).then(Ka=>{Ka.ak(ub,jc)}):
bc.a(this.$).ak(ub,jc)}else this.Ij()}$d(Bb,ac,tc,ub,jc=null,Ka=null,zb=null,Yb=8,oc=null,Wc=!1){ub&&(Bb+=".Checked");Wc&&(Bb+=".Disabled");this.Xa.Grd(Bb)&&this.Xa.rNd(Bb);tc=jc||X.a.instance.ha(tc);Bb=this.Xa.GJa(Bb,tc,ac,null,"None",Ka,Wc,null);Bb.iAc(null);zb&&Bb.yS(zb);ub?Bb.AS("Image16by16",3,ab.a.Jba):oc?Bb.AS("Image16by16",Yb,oc):Bb.X5b();return Bb}Ika(Bb,ac,tc,ub,jc=null){tc=jc||X.a.instance.ha(tc);this.Xa.Grd(Bb)?this.Xa.rNd(Bb):this.Xa.rNd(Bb+".Checked");ub&&(Bb+=".Checked");this.cLj&&
(tc=this.Ath.parseFromString(tc,"text/html").body.innerText);Bb=this.Xa.Y7c(Bb,null,tc,ac,3,ab.a.Jba);Bb.Ogf=ub;!ub&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&Bb.X5b();return Bb}Kli(){this.xA=Object(h.a)(new Xd,{PivotValueFieldSummarizeValueByApplyData:Object(h.a)(new Vd,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(h.a)(new pb,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}LTa(Bb,
ac){this.xA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=Bb;this.xA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=ac;this.xA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}hSh(){const Bb=[];if(this.Tb&&this.Tb.Saa&&0<this.Tb.Saa.length)for(const ac of this.Tb.Saa)ac&&Bb.push(ac);if(this.Tb&&this.Tb.tL&&0<this.Tb.tL.length)for(const ac of this.Tb.tL)ac&&Bb.push(ac);Bb.sort((ac,tc)=>ac.Index-tc.Index);return Bb}Ibg(){if(!this.Je||!this.Tb||!this.Tb.tL)return!1;const Bb=1===
this.Je.CellArea||4===this.Je.CellType&&this.Je.IsRowAxis,ac=4===this.Je.CellType?0<this.Tb.V9c:0<this.Je.CurrentFieldIndex;return 1<this.Tb.tL.length&&Bb&&ac}eMa(Bb){const ac=[];3===Bb?this.$.isEditMode?ac.push(...[Qa.a.nQf,Qa.a.pQf,Qa.a.jaj]):ac.push(...[Qa.a.copy]):2===Bb&&ac.push(Qa.a.KDe);return ac}Ij(){const Bb=Y.a.nd(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");Kc.a(this.$).Ij(Bb)}cNj(){return this.yb?0!==this.yb.LabelOrDateFilterType||0!==this.yb.ValueFilterType||this.yb.HasManualFilter:
!1}ZMj(Bb){return 62<=Bb&&65>=Bb}EEi(){if(this.activeCell&&this.yb&&this.Tb){var Bb={};Bb.cell=this.activeCell;Bb.dataSourceIndex=this.Tb.externalSourceIndex;Bb.fieldId=this.yb.Index.toString();Bb.isOlap=this.Tb.isOlap;Bb.confirmationRequired=this.Tb.confirmationRequiredForDataOps;var ac={};ac.showPivotFilterDialogCommandData=Bb;this.$.Xc(492140419,A.a.Eb,19,ac)}}w9g(Bb){this.activeCell&&this.yb&&this.Tb&&this.$.userOperationManager.Tc(new R.a(153,0,(ac,tc,ub)=>P.A(this.$.pa.va,this.activeCell,this.Tb.externalSourceIndex,
this.yb.Index.toString(),Bb,ac,tc,ub,null,null)),null)}wWg(Bb){!(30>Bb||61<Bb)&&this.activeCell&&this.yb&&this.Tb&&this.$.userOperationManager.Tc(new R.a(152,0,(ac,tc,ub)=>P.e(this.$.pa.va,this.activeCell,this.Tb.externalSourceIndex,this.yb.Index.toString(),Bb,ac,tc,ub,null,null)),null)}applyPivotSort(Bb){if(this.Tb&&this.yb&&this.activeCell&&this.Je){var ac=1===this.Je.CellArea||2===this.Je.CellArea;8===this.Je.CellArea?fe.a(this.$.userOperationManager,(tc,ub,jc)=>We.b(this.$.pa.va,this.activeCell,
Bb,this.yb.Caption,tc,ub,jc,null),tc=>new R.a(1015,0,tc,void 0,null),null):ac&&(ac=1===this.Je.CellArea?1:2,ea.EwaSettings.ya(600)?Ud.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tb.externalSourceIndex,this.yb.Index.toString(),this.yb.Caption,this.Tb.isOlap?"":this.yb.Caption,ac,1===Bb):Ud.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tb.externalSourceIndex,this.yb.Index.toString(),1===Bb))}}cJ(){return!this.Tb||!this.Tb.isActionable}vLj(){return(this.Je||
this.Tb)&&4!==this.Je.CellType&&(0!==this.Je.CellType||8!==this.Je.CellArea||this.Tb.Saa&&this.Tb.Saa.length||this.Tb.tL&&this.Tb.tL.length)?!1:!0}wLj(){return this.Je&&this.Tb&&(1===this.Je.CellArea||2===this.Je.CellArea)&&this.Tb.zSb&&this.Tb.zSb.length?!1:!0}lwa(Bb,ac,tc,ub,jc){Bb.buttons.push(this.$d(ac,tc,0,!1,ub,null,null,8,null,jc))}}Object(b.a)(Lf,"PivotTableContextMenu",m.a,[]);class Ze{compare(Bb,ac){return(Bb||"").localeCompare(ac||"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(b.a)(Ze,
"DigitsAsNumberComparer",null,[359]);var ec=a(1100),Lc=a(167),Da=a(355),Cb=a(276),Zb=a(25),yc=a(154);const Vc=n.a.sdh;class jd extends m.a{constructor(Bb,ac,tc,ub){super(Bb,"PopulateTableFieldListContextMenu",-751848458,-1085236154,Vc,!0,!1,"TableFieldListContextMenuRoot",ac,tc,!1,ub);this.z8b=null;this.IDd=0;this.uGa=null;this.grid=Ha.h(Bb)}get nx(){return"PopulateTableFieldListContextMenu"}get TB(){return n.a.GVf}get hL(){this.uGa||(this.uGa=this.$.da.Aa(261));return this.uGa}executeCommand(Bb,
ac,tc){Bb=ac.command;switch(Bb){case 639960842:this.applyTableFieldList(tc);this.hL.Sea();break;case -1085236154:r.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.IDd}`);this.hL.Sea();break;case 1833782813:this.hL.showCallout();break;default:return ha.a(Bb)}return f.Task.Ua(!0)}applyTableFieldList(Bb){var ac=Bb.MenuItemId.toString();ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(ac=
ac.replace("'","''"),ac=ac.replace("[","'["),ac=ac.replace("]","']"));var tc=Object(Sa.a)(String,Bb.SourceControlId);const ub={};ub.PulloutField=ac;ub.PulloutCardPath=Bb.SourceCardKeyPath;ub.PulloutCardSourceRow=Bb.SourceCardRow;ub.PulloutCardSourceColumn=Bb.SourceCardColumn;if(this.hL.BN){r.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");ub.ParameterType=2;Bb=Bb.ColumnIndex;if(void 0===Bb||null===Bb){if(void 0===tc||null===tc){r.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}Bb=0<=this.hL.HTf?this.hL.HTf:parseInt(tc.substring(20+ac.length+1,tc.length),10);if(isNaN(Bb)){r.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${tc}`);return}}ub.PulloutRichColumnSourceIndex=Bb;if(this.uGa.QTg){this.EUg(ac,ub);return}}else r.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),ub.ParameterType=4,tc=this.hL.selectedRange.right,aa.a.$Bb()&&this.uGa.bya&&(ub.ParameterType=8,Bb=this.hL.ona.top,Bb=
Zb.Range.HM(tc)+Bb,ac==ec.d?(ac="=DAYS("+Bb+", TODAY())",yc.a("DateFormulaPulledOut_DaysFromToday")):ac==ec.g?(ac="=IF(TODAY() < "+Bb+", DATEDIF(TODAY(), "+Bb+', "Y"), DATEDIF('+Bb+', TODAY(), "Y"))',yc.a("DateFormulaPulledOut_YearsFromToday")):ac==ec.c?(ac="=TEXT("+Bb+', "dddd")',yc.a("DateFormulaPulledOut_DayOfWeek")):ac==ec.f?(ac="=TEXT("+Bb+', "mmmm")',yc.a("DateFormulaPulledOut_MonthOfYear")):ac==ec.e?(ac="EOMONTH("+Bb+", 0)",ac="=DATE(YEAR("+ac+"), MONTH("+ac+"), DAY("+ac+"))",yc.a("DateFormulaPulledOut_EndOfMonth")):
ac==ec.b&&(ac="="+Bb+" + 1",yc.a("DateFormulaPulledOut_AddOneDay"))),void 0!==ub.PulloutCardSourceColumn&&null!==ub.PulloutCardSourceColumn&&(tc=ub.PulloutCardSourceColumn+1),ub.PulloutRichColumnSourceIndex=tc;this.HTd(ac,ub)}HTd(Bb,ac,tc=0){r.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.IDd}, SelectedColumnIndex, ${ac.PulloutRichColumnSourceIndex}`);Bb=Object(h.a)(new Cb.a,{Text:Bb});this.grid.setCell(Bb,this.hL.ona,0,127,ac,tc);this.grid.focus();
this.z8b=null;this.hL.Sea();this.hL.Kuj()}Ac(Bb,ac,tc){if(Bb=this.$.isEditMode&&ea.EwaSettings.ya(128)&&!!this.hL)switch(ac.command){case -1085236154:break;case 639960842:Bb=!!tc;break;case 1833782813:Bb=this.hL.Uxa&&this.hL.WEb;break;default:Bb=!1}return Bb}s1(Bb,ac,tc){this.$.isEditMode&&(this.z8b=this.rRh(Object(Sa.a)(335,tc)),super.s1(Bb,ac,null,null,!1))}vZ(){return this.z8b}X7c(Bb){if(!this.hL||!Bb||!Bb.fl)return r.ULS.shipAssertTag(537166994,0,!!this.hL,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
r.ULS.shipAssertTag(537166993,0,!!Bb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),Bb&&r.ULS.shipAssertTag(537166992,0,!!Bb.fl,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let ac=new db.a;for(const ub of Bb.fl){Bb=new db.a;Bb.add(ub.ColumnName);Bb.add(ub.ColumnIndex.toString());let jc=new db.a;var tc=null;aa.a.$Bb()&&this.uGa.bya?jc=va.toList(va.select(va.asEnumerable(ub.FieldInfoDataList),Ka=>Ka.Name)):(tc=
ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Ze:new Fb.a,jc=va.OBc(va.concat(jc,va.select(va.asEnumerable(ub.FieldInfoDataList),Ka=>Ka.Name)),Ka=>Ka,tc));tc=new db.a;tc.add(va.toArray(va.concat(Bb,jc)));ac=va.toList(va.concat(ac,tc))}return va.toArray(ac)}rRh(Bb){var ac=this.X7c(Bb);if(!ac||!ac.length)return this.z8b=null;Bb=this.Xa;const tc=Bb.Nq(this.menuId);let ub=Bb.Nc();const jc=1<ac.length,Ka=aa.a.$Bb()&&this.uGa.bya;this.IDd=ac.length;
for(const zb of ac){Ka?ub.title="Calculate Date Information":jc||(ub.title=zb[0]);ac=Bb.Nc();for(let Yb=2,oc=zb.length;Yb<oc;++Yb)!Ka||zb[Yb]!=ec.d&&zb[Yb]!=ec.e||(tc.Cc.push(ub),ub=Bb.Nc()),(jc?ac.buttons:ub.buttons).push(Bb.GJa("ApplyTableFieldList."+zb[Yb]+"."+zb[1],zb[Yb],639960842,null,"None",zb[Yb],!1,void 0,!0));if(jc){const Yb=Bb.Gw("ApplyTableFieldList."+zb[0],this.menuId,zb[0],798637440);Yb.menu.Cc.push(ac);ub.buttons.push(Yb)}}tc.Cc.push(ub);return tc}EUg(Bb,ac){const tc=Y.a.nd(12,1,0,
900,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(ea.EwaSettings.By()){const ub=new Da.a(this.$,tc);ub.oM(()=>{2===ub.returnValue&&this.HTd(Bb,ac,8)})}else{const ub=new Lc.ErrorDialog(this.$,tc);ub.oM(()=>{2===ub.returnValue&&this.HTd(Bb,ac,8)});ub.qg()}}}Object(b.a)(jd,"PulloutFieldListContextMenu",m.a,[]);const ld=n.a.IVf;class Bd extends m.a{constructor(Bb,ac,tc,ub){super(Bb,"PopulateRichTextContextMenu",679816325,1151222423,ld,!0,!1,ld,ac,tc,!0,ub);this.grid=Ha.h(Bb)}get nx(){return"PopulateRichTextContextMenu"}get TB(){return n.a.IVf}Ac(Bb,
ac,tc){return-1687037502===ac.command&&!!tc&&this.grid.jb}executeCommand(Bb,ac,tc){this.showRichTextFloatie(tc);return f.Task.Ua(!0)}eMa(){return[Qa.a.V6g]}showRichTextFloatie(Bb){var ac=Object(Sa.a)(Ab.a,Bb.eventArgs);ac&&(Bb=this.eMa(ac.Cb),ac=new Sys.UI.Point(ac.Da.clientX,ac.Da.clientY),this.showFloatie(Bb,new Sys.UI.Bounds(ac.x,ac.y,0,0),2))}}Object(b.a)(Bd,"RichTextContextMenu",m.a,[]);var Td=a(106),Jd=a(432);const ce=n.a.rdh;class ie extends m.a{constructor(Bb,ac,tc,ub){super(Bb,"PopulateSheetOpsContextMenu",
274207288,-1497523576,ce,!0,!1,"SheetTabContextMenuRootName",ac,tc,!1,ub);this.amc=this.ukc=!1}get nx(){return"PopulateSheetOpsContextMenu"}get TB(){return n.a.JVf}executeCommand(Bb,ac,tc){if(Ea.a(this.$))return f.Task.Ua(!0);this.$.isEditMode&&(Bb=tc[n.a.oag],Bb=Bb.x&&Bb.y?new Sys.UI.Point(Bb.x+(this.$.isChromeRtl?10:-10),Bb.y):K.DOMElementExtensions.getLocation(tc[n.a.pag]),this.to(Bb,!1));return f.Task.Ua(!0)}Ac(Bb,ac,tc){return-1075099431===ac.command&&!!tc}vZ(){const Bb=this.Xa.Nq(this.menuId),
ac=this.$.isEditMode;this.B8j();this.fRh(Bb,ac);this.VQh(Bb);this.$Rh(Bb);return Bb}g1b(Bb,ac,tc,ub){Bb.push(this.Xa.tb(ac?tc:ub))}fRh(Bb,ac){var tc=this.Xa;const ub=tc.Nc();ub.buttons.push(tc.tb(54));this.g1b(ub.buttons,this.amc,127,56);ub.buttons.push(tc.tb(55));ac&&this.g1b(ub.buttons,this.amc,126,125);ub.buttons.push(tc.tb(158));ac=this.$.ua.na;ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.MF&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
ac&&ac.Be&&(ac.Be.wB||ac.Be.CN||ub.buttons.push(tc.tb(299)));this.$.ea.POb&&u.AFrameworkApplication.ADb(Jd.b)&&(ac=Object(Sa.a)(Td.a,this.$.na))&&pc.p(ac)&&this.$.isEditMode&&(ub.buttons.push(tc.tb(277)),ac.isLockPausedInSession?ub.buttons.push(tc.tb(279)):ac.di&&ub.buttons.push(tc.tb(278)));ac=tc.Gw("ContextMenu.TabColor",null,X.a.instance.ha(518),1841703919);tc=tc.V7c(467002767,1549407384,541,-221093529,this.TB);ac.menu.Cc.push(tc);ub.buttons.push(ac);Bb.Cc.push(ub)}VQh(Bb){const ac=this.Xa.Nc();
this.g1b(ac.buttons,this.amc,114,112);this.g1b(ac.buttons,!this.ukc,115,113);Bb.Cc.push(ac)}$Rh(Bb){if(ea.EwaSettings.ya(418)&&!pc.e(this.$.ua.na)){var ac=this.Xa,tc=ac.Nc();tc.buttons.push(ac.tb(263));Bb.Cc.push(tc)}}B8j(){let Bb,ac;({H7c:Bb,xJe:ac}=this.$.G7c());this.amc=1===Bb;this.ukc=0<ac}}Object(b.a)(ie,"SheetOpsContextMenu",m.a,[]);var we=a(526);class zc extends m.a{constructor(Bb,ac,tc,ub){super(Bb,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",
ac,tc,!0,ub)}get nx(){return"PopulateSlicerContextMenu"}get TB(){return n.a.KVf}Oc(Bb,ac){var tc=!0;switch(ac){case -231711729:tc=!1;break;case -1909381757:tc=this.zfc();tc=!!tc&&tc.lui;break;case 1312363469:tc=!0}return!tc||super.Oc(Bb,ac)}executeCommand(Bb,ac,tc){if(!this.$.isEditMode)return N.TaskExtensions.mca();Bb=ac.command;ac=this.zfc();let ub=null;switch(Bb){case 2108047455:ac&&ac.KFe();break;case -231711729:r.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;
case -1909381757:ac&&ac.e6b();break;case 1312363469:this.showSlicerContextMenu(tc);break;default:ub=ha.a(Bb)}return ub||N.TaskExtensions.mca()}Ac(Bb,ac,tc){Bb=!1;switch(ac.command){case -231711729:case 2108047455:case -1909381757:Bb=!0;break;case 1312363469:Bb=!!tc}return Bb}vZ(){const Bb=this.Xa.Nq(this.menuId);var ac=this.Xa.Nc();ac.buttons.push(this.Xa.tb(252));ac.buttons.push(this.Xa.tb(253));ac.buttons.push(this.Xa.tb(254));Bb.Cc.push(ac);ac=this.Xa.Nc();this.gAi()?ac.buttons.push(this.Xa.tb(266)):
ac.buttons.push(this.Xa.tb(267));Bb.Cc.push(ac);return Bb}gAi(){if(aa.a.Md()){var Bb=this.$.da.Aa(439);if(Bb)return Bb.ls}else if(Bb=this.$.da.Aa(371))return Bb.ls;return!1}showSlicerContextMenu(Bb){var ac=Object(Sa.a)(Ab.a,Bb.eventArgs);Bb=this.bec(Object(Sa.a)(Ab.a,Bb.eventArgs));ac=ac.Cb;A.a.Eb=ac;this.to(Bb,!1,ac)}y2e(Bb){const ac=this.Xa.Nc(),tc=this.Xa.Nc();tc.buttons.push(this.Xa.tb(255));tc.buttons.push(this.Xa.tb(256));const ub=this.Xa.Y7c("ContextMenu.SlicerSort",null,X.a.instance.ha(2179),
-814639094,0,ab.a.mWe);ub.menu.Cc.push(tc);ac.buttons.push(ub);Bb.Cc.push(ac)}tNj(Bb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&Bb.Vb.className===ab.a.bdd||ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===Bb.Cb}bec(Bb){var ac=Ha.h(this.$).ga.Ra.oc;let tc=Bb&&1!==Bb.Cb&&Bb.clientPoint?Bb.clientPoint:Sys.UI.DomElement.getLocation(ac.domElement);if(this.tNj(Bb)){var ub=this.zfc();
ub&&(Bb.Vb.className===ab.a.bdd&&(tc=Z.HelperMethods.Rdc(Bb.Da)),1===Bb.Cb&&(tc=qa.a(this.$).gla(K.DOMElementExtensions.getLocation(ub.frame))))}else if(Bb=this.zfc())Bb=this.K_h(Bb.frame),(ub=Z.HelperMethods.sD(this.$.Df,this.$.domElement,Ha.h(this.$).rtl,!1))?(Bb.x=qa.a(this.$).Ph(Bb.x-ub.x)+ub.x,Bb.y=qa.a(this.$).Ph(Bb.y-ub.y)+ub.y):r.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),tc.y+=Bb.y,tc.x+=Bb.x;Bb=this.$.domElement;ub=Ha.h(this.$).rtl;ac=Z.HelperMethods.sD(ac.Ig.domElement,
Bb,ub);tc.y=Math.max(tc.y,ac.y);tc.x=Math.max(tc.x,ac.x);return tc}zfc(){const Bb=Ha.h(this.$).ga.Ra.oc;r.ULS.shipAssertTag(537166988,0,!!Bb);return we.a(this.$).QH(Bb.floatingObject.id)}K_h(Bb){let ac=new Sys.UI.Point(Bb.offsetParent.offsetLeft,Bb.offsetParent.offsetTop);var tc=Ha.h(this.$);if(!tc)return ac;const ub=Ha.h(this.$).rtl;ac=Z.HelperMethods.sD(Bb,this.$.Qp.ownerDocument.body,ub);tc.pJe(ac);ac.x=ub?this.$.Qp.clientWidth-ac.x-Bb.clientWidth:ac.x;Bb=tc.view.Krb;tc=ub?-tc.uS.Fda(Bb.x):Bb.x;
ac.x-=tc;ac.y-=Bb.y;return ac}}Object(b.a)(zc,"SlicerContextMenu",m.a,[]);class Sc{constructor(Bb,ac,tc){this.type=Bb;this.pdh=ac;this.Pr=tc}}Object(b.a)(Sc,"TimeSlicerRibbonButtonParameter",null,[]);class td extends m.a{constructor(Bb,ac,tc,ub){super(Bb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,td.TYj,!0,!1,td.SMb,ac,tc,!1,ub);this.$2a=0;this.wRe=this.pMa=this.mua=null}get nx(){return"PopulateTimeSlicerLevelMenu"}get TB(){return n.a.NVf}executeCommand(Bb,ac,tc){Bb=ac.command;switch(Bb){case 2000085697:Bb=
tc.DOMElement;this.mua=tc.ChangeLevelCallback;this.pMa=tc.GetLevelLabelCallback;this.$2a=tc.CurrentLevel;const ub=tc.DomEvent;ca.g(ub);const jc=tc.location;tc=tc.levelLabelText;this.wRe=K.DOMElementExtensions.Mz(document.activeElement,"iframe")&&tc?tc.parentNode:null;tc=Sys.UI.DomElement.getBounds(tc);tc.x=jc.x;tc.y=jc.y;this.s1(ub,Bb,tc,ac,!0);break;case -649826274:this.mua(0);break;case 149600865:this.mua(1);break;case -2012435159:this.mua(2);break;case -1979934975:this.mua(3);break;case 1634477200:K.DOMElementExtensions.setFocus(this.wRe);
break;default:return ha.a(Bb)}return f.Task.Ua(!0)}Ac(Bb,ac,tc){Bb=!1;switch(ac.command){case 2000085697:Bb=!!tc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:Bb=!0}return Bb}s1(Bb,ac,tc){Bb=Sys.UI.DomElement.getBounds(ac);tc.x=qa.a(this.$).Ph(tc.x);tc.y=qa.a(this.$).Ph(tc.y);Bb.x=qa.a(this.$).Ph(Bb.x);Bb.y=qa.a(this.$).Ph(Bb.y);Bb=new Sys.UI.Point(Bb.x+tc.x,Bb.y+tc.y);this.showContextMenu(new Sys.UI.Bounds(Bb.x,Bb.y-tc.height,tc.width,tc.height))}vZ(){const Bb=
this.Xa,ac=Bb.Nq(this.menuId),tc=Bb.Nc();for(let jc=0;3>=jc;jc++){const Ka=this.pMa(jc);var ub=td.bVh(jc);ub=Bb.ufh(ub.pdh,ub.Pr,this.$2a===jc,td.KEe);ub.label=Ka;ub.yS(Ka);this.$2a===jc?ub.AS("Image16by16",8,td.KEe):ub.X5b();tc.buttons.push(ub)}ac.Cc.push(tc);return ac}static bVh(Bb){let ac=null;switch(Bb){case 0:ac=new Sc(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:ac=new Sc(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:ac=new Sc(89,"ContextMenu.TimeSlicerLevelMonth",
-2012435159);break;case 3:ac=new Sc(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return ac}}td.TYj=n.a.tdh;td.SMb="TimeSlicerLevelMenuRootName";td.KEe=ab.a.Mva;Object(b.a)(td,"TimeSlicerLevelMenu",m.a,[]);var Md=a(327),wd=a(5),Ta=a(55);class Vb extends e.a{constructor(Bb){super(Bb)}Fd(){const Bb=this.$,ac=ka.a.T2a(Ta.b(),this.ka,"Task","IRootUser"),tc=d.a(Bb);let ub=null;ub=(Yb,oc)=>{tc.w_f(ub);ac.setResult(oc.o7b)};tc.Tte(ub);tc.A8e();const jc=E.GetServiceTaskFactory.create(Bb.da,102,Bb.ka,this.Na),
Ka=Object(Ub.b)("OfficeVSO:7624897_MigrateContextMenuController")?Object(W.d)(sb.a.resolve(ib.k,{rb:this.Na})):E.GetServiceTaskFactory.Sa(Bb.da,342,338,this.Na),zb=ea.EwaSettings.Xw()?Object(W.d)(sb.a.resolve(ib.o,{rb:this.Na})):f.Task.Ua(null);N.TaskExtensions.za(N.TaskExtensions.Pd([ac.task,jc,Ka,zb],this.ka),()=>{const Yb=jc.result,oc=ac.task.result,Wc=Ka.result,vd=zb.result;this.qd([new yb(Bb,oc,Yb,Wc),new da(Bb,oc,Yb,Wc),new rb(Bb,oc,Yb,Wc),new ob(Bb,oc,Yb,Wc),new cc(Bb,oc,Yb,Wc),new fa(Bb,oc,
Yb,Wc),new $c.GridContextMenu(Bb,oc,Yb,Wc,vd),new rd(Bb,oc,Yb,Wc),new ie(Bb,oc,Yb,Wc),new td(Bb,oc,Yb,Wc),new jd(Bb,oc,Yb,Wc),new jb(Bb,oc,Yb,Wc),new Lf(Bb,oc,Yb,Wc,vd),new zc(Bb,oc,Yb,Wc),new Bd(Bb,oc,Yb,Wc)])},Bb.ka,3)}static initData(){const Bb=Md.a.N$;Bb(2000085697,20479,0,0);Bb(-227942804,wd.a.tc|24576,0,0);Bb(1634477200,wd.a.tc|131072,0,0);Bb(-649826274,4095,0,0);Bb(149600865,4095,0,0);Bb(-2012435159,4095,0,0);Bb(-1979934975,4095,0,0);Bb(1247109494,wd.a.tc|24576,0,0);Bb(-2064931494,wd.a.tc|
131072,0,0);Bb(-1396319072,wd.a.Ga,128,0);Bb(-425234874,wd.a.Ga,128,0);Bb(-1253126584,wd.a.Ga,0,0);Bb(274207288,wd.a.tc|24576,0,0);Bb(-1497523576,wd.a.tc|131072,0,0);Bb(-498523270,wd.a.tc|24576,64,0);Bb(1640762262,wd.a.tc|131072,64,0);Bb(-2017893763,wd.a.tc|24576,0,0);Bb(1350204367,wd.a.tc|131072,0,0);Bb(-889576107,wd.a.Dw,128,0);Bb(-1170196828,wd.a.Dw,128,0);Bb(389774337,wd.a.Dw,128,0);Bb(1529312473,wd.a.Dw,128,0);Bb(2033235475,wd.a.Dw,128,0);Bb(-96230454,wd.a.Dw,128,0);Bb(74086617,wd.a.Dw,128,0);
Bb(563292088,wd.a.Dw,128,0);Bb(-1092351914,wd.a.Dw,128,0);Bb(-2141589616,wd.a.Dw|16384,128,0);Bb(745182485,wd.a.Dw,0,0);Bb(359279088,wd.a.Dw,128,0);Bb(-67292059,wd.a.Dw,128,0);Bb(926905850,wd.a.Dw,128,0);Bb(547535945,wd.a.Dw,128,0);Bb(1374696078,wd.a.tc|24576,0,0);Bb(495005930,wd.a.tc|212992,0,0);Bb(-1045020714,wd.a.tc|24576,0,0);Bb(-170383950,wd.a.tc|212992,0,0);Bb(324156914,wd.a.Ga,0,0);Bb(-1085236154,wd.a.xv,0,0);Bb(-751848458,wd.a.sl|16384,0,0);Bb(216058793,wd.a.xv,0,0);Bb(474690375,wd.a.sl|16384,
0,0);Bb(-1920954846,wd.a.tc|24576,0,0);Bb(723126814,wd.a.tc|131072,0,0);Bb(2108047455,128,128,0);Bb(-231711729,128,128,0);Bb(-1909381757,128,128,0);Bb(-814639094,128,128,0);Bb(1701016594,wd.a.tc|3072,128,0);Bb(-1475408662,wd.a.tc|24576,0,0);Bb(1114549926,wd.a.tc|131072,32,0)}static la(Bb){e.a.Yd(10,new Vb(Bb))}}Object(b.a)(Vb,"ContextMenuCommandHandlerFactory",e.a,[]);var qc=a(228),Ic=a(159),gd=a(1471),Kd=a(100),oe=a(149);let Ce=class{constructor(Bb,ac){this.Itb=ac;this.$=Bb}dispose(){}vba(){this.Itb.x4()}kD(){this.Itb.kD()}QWd(Bb,
ac,tc){ed.i(this.$,ed.b);this.Itb.showContextMenu(Object(h.a)(new gd.a,{x:ac.x,y:ac.y}),tc,Bb);Kd.EventHandlerManager.instance.Zfd()}XBc(Bb,ac,tc){ed.i(this.$,ed.b);this.Itb.showFloatie(Object(h.a)(new gd.a,{x:ac.x,y:ac.y}),Bb,tc);oe.a(()=>{Kd.EventHandlerManager.instance.Zfd()},this.$.ka)}PWd(Bb,ac,tc,ub){ed.i(this.$,ed.b);this.Itb.PWd(Object(h.a)(new gd.a,{x:ac.x,y:ac.y}),Bb,tc,ub)}};Ce=Object(Ic.b)([Object(sb.d)(ib.k),Object(Ic.c)(0,Object(ib.u)()),Object(Ic.c)(1,Object(ib.S)())],Ce);Object(b.a)(Ce,
"ReactContextMenuController",null,[316,2]);class ze extends qc.a{constructor(Bb){super();this.xhf=!1;this.cqd=()=>{let ac;(ac=this.$.da.Aa(342))?this.vb(ac):this.$.Fz(tc=>{tc.hic().then(ub=>{(ac=this.$.da.Aa(342))?this.vb(ac):(ac=new Ce(this.$,ub),this.vb(this.$.da.Ha(342,ac)))})})};this.$=Bb;this.Mb()}dispose(){this.xhf&&this.$&&this.$.ea.rn(this.cqd);super.dispose()}create(){this.$.ea.Bf?(r.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.Bf}`),
this.cqd(null,null)):(this.xhf=!0,this.$.ea.mk(this.cqd))}static la(Bb){Object(Ub.b)("OfficeVSO:7624897_MigrateContextMenuController")||Bb.da.Ha(338,new ze(Bb))}}Object(b.a)(ze,"ContextMenuControllerFactory",qc.a,[]);var af=a(169);class Za{constructor(){this.dictionary=this.Ld=null}}Object(b.a)(Za,"RibbonCommandParams",null,[]);class Rb{constructor(){this.menuModel=null;this.lMe=0}}Object(b.a)(Rb,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class rc{constructor(){this.dhc={}}oVh(Bb){return(Bb=
this.dhc[Bb.toString()])?Bb.menuModel:null}$3g(Bb,ac){this.dhc[ac.toString()]=Object(h.a)(new Rb,{menuModel:Bb,lMe:Z.HelperMethods.Pb()})}M$b(Bb){this.dhc[Bb.toString()]=null}o$h(Bb){return(Bb=this.dhc[Bb.toString()])?Bb.lMe:-1}}Object(b.a)(rc,"FilterMenuCache",null,[]);var Jc=a(16),Sb=a(190),Cc=a(229);class cd{constructor(){this.ld=this.ize=this.cell=null}}Object(b.a)(cd,"AutoFilterEventRegistrationArgs",null,[]);class Wd{constructor(Bb){this.M0a=null;this.kWd=!1;this.YEb=0;this.Gcd=1;this.OTe=0;
this.VHb=ac=>{this.eUf(ac.domElement,ac.hashCode)};this.aYf=ac=>{let tc=0;for(;window.performance.now()-ac<this.syh&&0<this.M0a.length;)this.Wre(this.M0a.shift()),tc++;r.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.Gcd}, Events Registered in this frame: ${tc}, Events in queue: ${this.M0a.length}`);0<this.M0a.length?this.YEb=window.requestAnimationFrame(this.aYf):(ac=window.performance.now()-this.OTe,r.ULS.sendTraceTag(537167051,1,50,
`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.Gcd}, Total time in MS: ${ac}`),this.Gcd++,this.YEb=0)};this.onPointerDown=ac=>{Ud.a.slim(ac.Da.rawEvent);return!1};this.$=Bb;this.gridView=Ha.h(this.$);this.Nki();this.syh=10}dispose(){window.cancelAnimationFrame(this.YEb);this.gridView&&this.gridView.jOd(this.VHb);this.gridView=null}Nki(){if(this.kWd=Z.HelperMethods.Z8a)this.M0a=[];this.eOg();this.gridView.XZc(this.VHb)}eOg(){for(const Bb of this.gridView.Un){const ac=
Bb.KDa;for(let tc in ac){const ub=ac[tc];this.eUf(ub.domElement,ub.hashCode)}}}eUf(Bb,ac){if(Ha.h(this.$).Ca.nm.L3a(ac))if(Bb){Bb=Bb.querySelectorAll('[id^="'+n.a.a_e+'"]');for(let jc=0;jc<Bb.length;jc++){var tc=Bb[jc],ub=tc.getAttribute(n.a.vLh);const Ka=tc.getAttribute(n.a.nLh);r.ULS.shipAssertTag(537167053,0,!!ub&&!!Ka,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${tc.id}, BlockHash: ${ac}`);ub=Zb.Range.Lc(parseInt(ub,
10),parseInt(Ka,10));tc=Object(h.a)(new cd,{cell:ub,ize:tc,ld:ac});this.kWd?(this.M0a.push(tc),this.YEb||(this.OTe=window.performance.now(),this.YEb=window.requestAnimationFrame(this.aYf))):this.Wre(tc)}}else r.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${ac}`);else r.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${ac}`)}Wre(Bb){const ac=
this.gridView.Ca.Pwa(Bb.cell,Bb.ld);ac?this.dOg(Bb.ize,ac):r.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${Bb.ld}, AutoFilter Cell: ${Bb.cell}`)}dOg(Bb,ac){ac.hasAutoFilter?this.dMg(Bb,ac.Iwb):ac.z5?this.bOg(Bb,ac.Iwb,ac.jud):r.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");af.a.instance.ta(Jc.a.Cf,
Bb,this.onPointerDown);Sb.a.instance.ta(Jc.a.Jza,Bb,this.onPointerDown)}dMg(Bb,ac){Cc.a.instance.ta(Jc.a.click,Bb,tc=>{ac&&Ud.a.hrc(tc.Da.rawEvent,966232027,ac,null);return!0})}bOg(Bb,ac,tc){const ub=F.a.ri(ac);Cc.a.instance.ta(Jc.a.click,Bb,jc=>{tc?Ud.a.spf(document.getElementById(ub.EwaElementId),ub.Cell,ub.DataSourceIndex,ub.FieldId,ub.IsOlap,ub.RequiresConfirmation,jc.Da.rawEvent,ub.OptionalPivotMenuAnchor):Ud.a.spfm(jc.Da.rawEvent,ub.RequiresConfirmation,ub.Cell,ub.DataSourceIndex,ub.PivotName,
ub.OptionalPivotMenuAnchor);return!1})}}Object(b.a)(Wd,"FilterMenuPointerEventsManager",null,[2]);class je{constructor(Bb){this.c_e=null;this.$=Bb;this.$$a=new rc;ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.c_e=new Wd(this.$))}dispose(){ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.c_e.dispose();
this.$=null}z0h(Bb){if(!Ha.h(this.$).BD){const ac=Ha.h(this.$).Ca.uia(Bb,this.$.activeItemName);if(ac&&ac.blockPresentInViewportTimeStamp>this.$$a.o$h(Bb.left))return ac.us(Bb).autoFilterMenu}return this.$$a.oVh(Bb.left)}x_i(Bb,ac,tc){this.$$a&&(Bb=Ha.h(this.$).BD?Bb.hze[ac].Menu:Bb.menuModel[ac],this.$$a.$3g(Bb,tc))}y_i(Bb){this.$$a&&this.$$a.M$b(Bb)}}Object(b.a)(je,"FilterMenuManager",null,[328,2]);var Ee=a(211),Ue=a(178);class gf{constructor(Bb,ac,tc){this.xCc={};this.Ud=!1;this.gm=(ub,jc=null)=>
{this.showContextMenu(jc)};this.REf=(ub,jc)=>{jc.LNi===gf.gci&&Ha.h(this.$).focus()};this.Ey=(ub,jc)=>{ub=this.$.Ia.m5(jc.Ld.command);(null===ub||void 0===ub?0:ub.dismissesContextualUI)&&this.x4()};this.i7=()=>{Object(Ub.b)("OfficeVSO:7624897_MigrateContextMenuController")?sb.a.remove(ib.k):this.$.da.TU(342);N.TaskExtensions.za(Object(Ub.b)("OfficeVSO:7624897_MigrateContextMenuController")?Object(W.d)(sb.a.resolve(ib.k,{rb:3})):E.GetServiceTaskFactory.create(this.$.da,338,this.$.ka,3),ub=>{ub=ub.result;
for(let jc of this.xCc)jc.JXf(ub)},this.$.ka)};this.$=Bb;this.contextMenuController=tc;this.Tae=new je(this.$);Bb.da.Ha(8,this);for(tc=0;tc<ac.length;tc++)this.xCc[gf.udh[tc]]=ac[tc];this.ga=Ha.h(Bb).ga;this.ga.v1b(this.gm);this.$.Ia.G_a(this.REf);af.a.instance.QHj();ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ia.Xha(this.Ey);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.u3(this.i7)}get ecc(){return this.Tae}Zhd(Bb){return Q.a.Mc(this.xCc,
Bb)}dispose(){this.Ud?r.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ud=!0,this.$&&(this.$.lm(gf.yd),this.$.da.TU(8),this.ga&&this.ga.Iwc(this.gm),this.$.Ia.KLb(this.REf),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ia&&this.$.Ia.Jea(this.Ey),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.d8(this.i7)),this.$=this.ga=
null,this.ecc.dispose(),this.xCc=this.Tae=null)}showContextMenu(Bb,ac=null,tc=null){this.YMj(Bb)&&(ed.i(this.$,ed.j),Bb=this.Jgh(Bb,ac,tc),this.$.Ia.Nb(Bb.Ld,Bb.dictionary))}x4(){this.contextMenuController?this.contextMenuController.vba():r.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}YMj(Bb){return Kc.a(this.$).iq()?(r.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
Kc.a(this.$).XW(Ue.a.grid,Ee.a.showContextMenu),!1):!this.$.Ia.XIh&&(!Bb||Bb.Vb!==Ha.h(this.$).domElement&&!Se.a.equals(Bb.Vb.tagName,"INPUT",!0))}Jgh(Bb,ac=null,tc=null){tc={["eventArgs"]:Bb,["creationParams"]:tc};Bb=Bb?Bb.Cb:-1;const ub=this.ga.Ra.oc;let jc=1441131127;ub?(ac=ub.floatingObject,r.ULS.shipAssertTag(537167059,0,!!ac,"floatingObj shouldn't be null."),gf.vvd(ac)?jc=1312363469:gf.isPivotChart(ac)?(tc[da.v4c]=ac?ac.jd:null,jc=-149612405):jc=-1372040782):gf.eof(ac)?(tc[da.v4c]=ac,jc=-149612405):
!ed.h(this.$)&&ed.f(Ha.h(this.$))&&(jc=671488277);ac=new U.a(jc,Bb,this.$.Bc,30,null);return Object(h.a)(new Za,{Ld:ac,dictionary:tc})}static la(Bb){Bb.rl(gf.yd)}static isPivotChart(Bb){return!!Bb&&0===Bb.type&&gf.eof(Bb.jd)}static vvd(Bb){return!!Bb&&2===Bb.type}static eof(Bb){return!!Bb&&!!(Bb.Attributes&4)}}gf.udh="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
gf.gci="GridContextMenu";gf.yd=Bb=>{(Bb=Object(Sa.a)(7,Bb))&&E.GetServiceTaskFactory.create(Bb.da,9,Bb.ka,0)};Object(b.a)(gf,"ContextMenuManager",null,[317,2]);class rf extends qc.a{constructor(Bb){super();this.$=Bb;this.Mb()}create(){const Bb=this.$,ac=Bb.nc;if(ac.allowSelection||ac.allowEdits||ac.allowFiltering||ac.allowSorting||ac.allowPivotSpecificOperations){const tc=E.GetServiceTaskFactory.create(Bb.da,10,Bb.ka,this.Na),ub=Object(Ub.b)("OfficeVSO:7624897_MigrateContextMenuController")?Object(W.d)(sb.a.resolve(ib.k,
{rb:this.Na})):E.GetServiceTaskFactory.Sa(Bb.da,342,338,this.Na);N.TaskExtensions.za(N.TaskExtensions.Pd([tc,ub],this.ka),()=>{this.vb(z.a(Bb)||new gf(Bb,tc.result,ub.result))},this.$.ka,3)}else r.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),Bb.da.TU(8),this.vb(null)}static la(Bb){Bb.da.Ha(9,new rf(Bb))}}Object(b.a)(rf,"ContextMenuManagerFactory",qc.a,[]);var xf=a(10);a.d(C,"a",function(){return Vf});
const Vf=()=>{Vb.initData();xf.a.Fa(Bb=>{ze.la(Bb);rf.la(Bb);Vb.la(Bb);gf.la(Bb)})};String(c);window.___1680633003685_closurehack=c},1268:function(t,C,a){a.r(C);t=a(0);var c=a(14),b=a(289),f=a(100),e=a(43),d=a(232),h=a(557),r=a(6),l=a(89),u=a(425),v=a(744),x=a(9),w=a(35),m=a(19),n=a(66),z=a(7),y=a(815),A=a(1124),F=a(866),D=a(15),B=a(33);class M{constructor(fb,ab,wb,kb,tb,hb,Fb,va){this.$=ab;this.Xa=wb;this.El=kb;this.selectedRanges=tb;this.grid=hb;this.Ry=va;this.P5=Fb;this.eia=d.a.all(tb,jb=>jb.isRow);
this.Fta=d.a.all(tb,jb=>jb.Ng);this.XGb=d.a.all(tb,jb=>!jb.isRow&&!jb.Ng);ab=hb.wb.Ild(tb);this.eub=!!ab;this.A0f=!!ab&&ab.hasActiveFilter;this.menuSection=wb.Nc();fb.Cc.push(this.menuSection);this.Gca=this.eia||this.Fta?this.menuSection:wb.Nc();this.eva=this.eia||this.Fta?this.menuSection:wb.Nc()}Ogd(){this.bRh();this.DQh();const fb=this.Ry.Vlc(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Xa.tb(fb?149:148))}hRh(){let fb=0;this.eub?this.P5.Jm(942362098)?fb=this.Ry.Jm(this.El,
942362098,this.selectedRanges,this.grid)?161:169:this.A0f&&(fb=this.Ry.Jm(this.El,-1113896058,this.selectedRanges,this.grid)?177:181):this.P5.Jm(-1113896058)&&(fb=this.eia?this.Ry.Jm(this.El,-1113896058,this.selectedRanges,this.grid)?49:116:this.Ry.Jm(this.El,-1113896058,this.selectedRanges,this.grid)?177:181);0!==fb&&this.Gca.buttons.push(this.Xa.tb(fb))}gRh(){let fb;!this.eub&&this.P5.Jm(-1113896058)&&(fb=this.eia?this.Ry.Jm(this.El,-1113896058,this.selectedRanges,this.grid)?295:296:this.Ry.Jm(this.El,
-1113896058,this.selectedRanges,this.grid)?297:298,this.Gca.buttons.push(this.Xa.tb(fb)))}cRh(){let fb=0;this.eub?this.P5.Jm(622604322)&&(fb=this.grid.rtl?this.Ry.Jm(this.El,622604322,this.selectedRanges,this.grid)?191:192:this.Ry.Jm(this.El,622604322,this.selectedRanges,this.grid)?162:170):this.P5.Jm(1415868706)&&(fb=this.Fta?this.Ry.Jm(this.El,1415868706,this.selectedRanges,this.grid)?50:117:this.Ry.Jm(this.El,1415868706,this.selectedRanges,this.grid)?178:182);0!==fb&&this.Gca.buttons.push(this.Xa.tb(fb))}aRh(){this.P5.Jm(1035996630)&&
(this.Ry.Jm(this.El,1035996630,this.selectedRanges,this.grid)?(this.Gca.buttons.push(this.Xa.tb(this.grid.rtl?187:165)),this.Gca.buttons.push(this.Xa.tb(166))):(this.Gca.buttons.push(this.Xa.tb(this.grid.rtl?188:173)),this.Gca.buttons.push(this.Xa.tb(174))))}bRh(){const {GridContextMenu:fb}=a(1268);let ab=null;this.XGb&&(ab=this.Xa.Gw("ContextMenu.InsertCells",null,D.a.instance.ha(345),1896159024),ab.menu.Cc.push(this.Gca));fb.dRh(this.Gca,this.Xa,this.$);this.hRh();r.AFrameworkApplication.Fs("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");
B.a.rtd()&&this.gRh();this.cRh();this.aRh();ab&&0<this.Gca.buttons.length&&this.menuSection.buttons.push(ab)}GQh(){let fb=0;this.eub?this.P5.Jm(1405456548)?fb=this.Ry.Jm(this.El,1405456548,this.selectedRanges,this.grid)?163:171:this.A0f&&(fb=this.Ry.Jm(this.El,1554436520,this.selectedRanges,this.grid)?179:183):this.P5.Jm(1554436520)&&(fb=this.eia?this.Ry.Jm(this.El,1554436520,this.selectedRanges,this.grid)?51:118:this.Ry.Jm(this.El,1554436520,this.selectedRanges,this.grid)?179:183);0!==fb&&this.eva.buttons.push(this.Xa.tb(fb))}EQh(){let fb=
0;this.eub?this.P5.Jm(284490184)&&(fb=this.Ry.Jm(this.El,284490184,this.selectedRanges,this.grid)?164:172):this.P5.Jm(674605324)&&(fb=this.Fta?this.Ry.Jm(this.El,674605324,this.selectedRanges,this.grid)?52:119:this.Ry.Jm(this.El,674605324,this.selectedRanges,this.grid)?180:184);0!==fb&&this.eva.buttons.push(this.Xa.tb(fb))}CQh(){this.P5.Jm(1035996630)&&(this.Ry.Jm(this.El,1035996630,this.selectedRanges,this.grid)?(this.eva.buttons.push(this.Xa.tb(this.grid.rtl?189:167)),this.eva.buttons.push(this.Xa.tb(168))):
(this.eva.buttons.push(this.Xa.tb(this.grid.rtl?190:175)),this.eva.buttons.push(this.Xa.tb(176))))}DQh(){let fb=null;this.XGb&&(fb=this.Xa.Gw("ContextMenu.DeleteCells",null,D.a.instance.ha(409),-1554384558),fb.menu.Cc.push(this.eva));this.GQh();this.EQh();this.CQh();fb&&0<this.eva.buttons.length&&this.menuSection.buttons.push(fb)}}Object(t.a)(M,"CellsContextMenuGenerator",null,[]);var R=a(834);class P{constructor(fb){this.ranges=null;this.ranges=fb}}Object(t.a)(P,"MacroRecorderRangeHyperlinkRemovedPayload",
null,[145]);var E=a(535),H=a(25),G=a(94),N=a(80),I=a(82),O=a(45),U=a(199),ca=a(65),Q=a(620),Y=a(155),la=a(39),ea=a(465),ha=a(567),X=a(1),T=a(197),ua=a(21),Ha=a(381),Ca=a(36),Ga=a(53),sa=a(218),bb=a(23),Ba=a(34),qa=a(1121),pa=a(943),ya=a(134),za=a(380),cb=a(294),Pa=a(184),nb=a(167),Ma=a(355),Oa=a(98),La=a(32),ra=a(258),V=a(293),ma=a(135),W=a(157),aa=a(41);const ia=fb=>X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?W.a.jo(aa.db):fb.da.Aa(66);var ka=a(801),Xa=a(802),
sb=a(121),ib=a(42),Ub=a(60),hc;(function(fb){fb[fb.none=0]="none";fb[fb.once=1]="once";fb[fb.twice=2]="twice"})(hc||(hc={}));Object(t.b)("ToggleState",hc);class yb{constructor(fb,ab,wb,kb){this.B0c=this.fhb=this.hhb=0;this.$=fb;this.gridView=ua.h(this.$);this.namedSheetViewPublic=ab;this.eg=wb;this.instantaneousSupportInformationManager=kb;this.xya=ka.a.wrd()}Msh(){var fb=this.wV();fb={["CommandValueId"]:ib.c(fb)};const ab=new Oa.a(-2058042992,2,this.$.Bc,19,null);c.ULS.sendTraceTag(527500302,0,50,
"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ia.Nb(ab,fb)}cth(){const fb=new Oa.a(644342024,2,this.$.Bc,19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ia.Nb(fb)}Rsh(){const fb=this.gridView.ga.qa.activeCell,ab=ia(this.$).lj,wb=ia(this.$).Oxb(fb);return ab||wb?this.Tsh(ab,wb,fb):this.Ssh(fb)}Tsh(fb,ab,wb){if(this.H7g(fb,ab,wb))return c.ULS.sendTraceTag(527500300,
0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Ub.Task.Ua(!1);if(null!=fb&&fb.hasAutoFilter||null!=ab&&ab.FIa.every(kb=>0!=kb.length))return this.hhb=hc.none,this.A0c();this.hhb=hc.once;return this.s$b(hc.once)}Ssh(fb){var ab=O.v(this.gridView.ga.qa.gd,this.$);ab=this.gridView.$.ua.getItemByName(ab.SheetName);const wb=O.E(ab.DS);if(this.G7g(wb,fb))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),
Ub.Task.Ua(!1);if(ab.hasAutoFilter){if(wb&&wb.contains(this.gridView.ga.qa.activeCell))return this.hhb=hc.none,this.A0c();this.hhb=hc.twice;return this.s$b(hc.twice)}this.hhb=hc.once;return this.s$b(hc.once)}s$b(fb){const ab=O.v(this.gridView.ga.qa.gd,this.$);if(!ab)return Ub.Task.Ua(!1);this.fhb||(this.fhb=Date.now());const wb=new Oa.a(368460465,2,this.$.Bc,19,null),kb=this.$.pa.va.ic(),tb=()=>new qa.a(ab),hb=Fb=>{ra.a(Fb)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):
(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),fb===hc.twice?this.s$b(hc.once):this.A0c())};return za.a(this.$.userOperationManager,(Fb,va,jb)=>cb.B(this.$.pa.va,ab,V.b(Fb,hb),va,jb,null,kb),Fb=>new U.a(516,0,Fb,64,tb),wb)}H7g(fb,ab,wb){return null!=fb&&Pa.d(fb)&&wb.top===fb.usedRange.top||null!=ab&&ab.Ala&&wb.top===ab.top?(this.ivc(this.$,223),!0):null!=fb&&Pa.g(fb)&&wb.top===fb.usedRange.bottom?(this.ivc(this.$,224),!0):!1}G7g(fb,ab){if(fb&&fb.contains(ab)&&
ab.top===fb.top||!fb&&this.H6g(ab.top,ab.left))return this.ivc(this.$,225),!0;if(fb&&fb.contains(ab))return!1;fb=new H.Range(1<ab.top?ab.top-1:ab.top,1<ab.left?ab.left-1:ab.left,ab.top<x.a.Fg?ab.top+1:ab.top,ab.left<x.a.Eg?ab.left+1:ab.left,!1,!1);return this.gridView.wb.wma(fb)?(this.ivc(this.$,226),!0):!1}ivc(fb,ab){ab=La.a.nd(1,1,751,ab,0,147079615,"ContextMenuFilterByCellValueError");X.EwaSettings.By()?new Ma.a(fb,ab):(fb=new nb.ErrorDialog(fb,ab),fb.initialize(),fb.qg())}A0c(){this.B0c=Date.now();
const fb=this.Fai();if(!fb)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Ub.Task.Ua(!1);const ab=this.wV(),wb={FirstRow:0};wb.FirstColumn=ab.Column;wb.SheetName=ab.SheetName;ma.b(this.$).rd(ya.a.cDf,this.Ql(),void 0,!0);const kb=this.K7b(ab,wb),tb=Fb=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.hhb,["ApplyFilterTime"]:this.B0c?
Date.now()-this.B0c:-1,["ToggleAndApplyFilterTime"]:this.fhb?Date.now()-this.fhb:-1,["FilterByValueType"]:ab.AutoFilterType})}`);this.fhb&&(this.fhb=0);if(ka.a.cPb(Fb)){const va=ka.a.Nxb(Fb);this.xya?ka.a.wBa(Xa.a.filterByCellValue,va.MessageIdName,sb.a.Wta,!0,ka.a.isSessionEndingError(va.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${va.MessageIdName}`)}ra.a(Fb)?(Fb=La.a.xc(Fb.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${Fb}`)):
(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),ma.b(this.$).rd(ya.a.MGf,this.Ql(),void 0,!0),Fb={},Fb.FirstRow=this.TZh(),Fb.FirstColumn=ab.Column,-1!==Fb.FirstRow&&(Fb=O.D(Fb),this.gP(Fb)))},hb=new U.a(208,0,(Fb,va,jb)=>ca.a(this.$.pa.va,kb,fb,V.b(Fb,tb),va,jb,null,null),6,()=>new pa.a(fb,kb));this.namedSheetViewPublic?this.namedSheetViewPublic.fUa().continueWith(Fb=>{Fb.result&&this.$.userOperationManager.Tc(hb,null)}):this.$.userOperationManager.Tc(hb,
null);return Ub.Task.Ua(!0)}gP(fb){B.a.vma(this.$)&&la.TaskExtensions.za(Ga.GetServiceTaskFactory.Sa(this.$.da,430,431,1),ab=>{ab.result.d9(fb);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.ka,3)}Ql(){return{["Location"]:"contextMenu"}}wV(){var fb=0,ab=this.gridView.ga.qa.activeCell;var wb=ia(this.$).lj;const kb=ia(this.$).Oxb(ab);if(wb){var tb="Table";fb=wb.objectId}else kb?(tb="Table",fb=kb.id):
tb="Sheet";wb=ab.left;ab={};ab.AutoFilterType=tb;ab.Column=wb;ab.Id=fb;tb={};this.$.gk(tb);tb.FirstRow=0;tb.FirstColumn=ab.Column;fb=this.$.ea.isNamedObjectViewMode;ab.NamedObjectView=fb;ab.SheetName=fb?tb.NamedObjectName:tb.SheetName;ab.ItemListOptions=null;return ab}H6g(fb,ab){fb=H.Range.Lc(fb,ab);return this.gridView.Ca.uia(fb,this.$.na.name)&&(fb=this.gridView.Ca.Pwa(fb))&&fb.autoFilterMenu?!0:!1}Fai(){var fb=null;const ab=this.gridView.Ob(this.gridView.ga.qa.activeCell);if(!ab)return null;const wb=
ab.cell.SCc;let kb;({category:kb}=this.instantaneousSupportInformationManager.jqa(wb,!1));if(1===ab.Xr.type)if(3===kb){if(!ab.cell.iQa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${kb}. NumFmt is null. `),null;fb=(ab.cell.iQa.Start+ab.cell.iQa.End).trim()}else if(!kb&&(bb.a.B2a(ab.Xr.value,"E")||bb.a.B2a(ab.originalText,"E"))){fb=this.eg.k1e(ab.Xr.value,wb,1,Number.POSITIVE_INFINITY,ab.cell.rja);if(!fb.success)return c.ULS.sendTraceTag(527500289,
0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${kb}. Failed to acquire formatted value`),null;fb=fb.iB}fb||(fb=ab.originalText);return Ba.a.GEe(fb)?["[Blanks]"]:["i"+fb.trim()]}TZh(){const fb=this.gridView.ga.qa.activeCell;var ab=ia(this.$).lj;const wb=ia(this.$).Oxb(fb);if(ab)return ab.usedRange.top;if(null!=wb)return wb.top;ab=this.$.ua.getItemByName(this.$.na.sheetName);return(ab=O.E(ab.DS))&&ab.contains(fb)?ab.top:-1}K7b(fb,ab){const wb={};wb.Location=ab;wb.FieldId=fb.Id.toString();
wb.DataSourceIndex=-1;wb.FilterType=fb.AutoFilterType;wb.AnchorType=0;wb.ChartId=null;wb.AnchorValue1=-1;wb.AnchorValue2=-1;wb.Property=fb.RichProperty;return wb}}Object(t.a)(yb,"GridContextMenuFilter",null,[]);var Gb=a(109),Sa=a(70);a.d(C,"GridContextMenu",function(){return db});class db extends v.a{constructor(fb,ab,wb,kb,tb){super(fb,"PopulateGridContextMenu",1247109494,-2064931494,db.nci,!0,!1,db.SMb,ab,wb,!0,kb);this.imc=this.expandCollapse=this.refresh=this.SZ=this.zxa=this.tCa=!1;this.XKe=
!0;this.grid=ua.h(fb);this.hpc=!0;if(this.Cjc=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const hb=Object(Sa.b)("OfficeVSO:7629405_namedSheetViewPublic_Migration")?Object(Gb.d)(W.a.resolve(aa.K,{rb:3})):Ga.GetServiceTaskFactory.Sa(this.$.da,309,310,3);let Fb;Fb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatCellsActionNewService",!1)?Object(Gb.d)(W.a.resolve(aa.x,{rb:3})):Ga.GetServiceTaskFactory.create(this.$.da,18,this.ka,3);
la.TaskExtensions.za(la.TaskExtensions.Pd([hb,Fb],this.ka),()=>{this.$.da.kb(268,va=>{this.K6a=new yb(fb,hb.result,Fb.result,va)})},this.ka,3)}this.Ev=tb}get nx(){return"PopulateGridContextMenu"}get TB(){return z.a.BVf}dispose(){super.dispose();this.grid=null}Oc(fb,ab){fb=!this.Qud(fb,ab);if(!fb)switch(ab){case -1977666927:fb=this.jLj();break;case 1549396389:fb=!this.bsi();break;case -425234874:fb=this.nLj()}return fb}Qud(fb,ab){const wb=this.grid.ga.qa.selectedRanges;return(new Y.a(this.$.ua)).Jm(fb,
ab,wb,this.grid)}executeCommand(fb,ab,wb){const kb=ab.command;fb=null;switch(kb){case -1396319072:if(ab=this.grid.Ob(null))b.a.instance.G3c(!0),f.EventHandlerManager.instance.Zfd(),db.w7i(ab);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ga.qa.selectedRanges,ab);break;case 324156914:fb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(wb);break;case -1977666927:null!=this.K6a?fb=this.K6a.Msh():this.Xyd();break;case 1549396389:null!=this.K6a?fb=this.K6a.cth():
this.Xyd();break;case 1803952894:null!=this.K6a?fb=this.K6a.Rsh():this.Xyd();break;default:fb=T.a(kb)}return fb||la.TaskExtensions.mca()}Ac(fb,ab,wb){fb=!1;switch(ab.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:fb=!0;break;case 1441131127:fb=!!wb}return fb}Xyd(){c.ULS.sendTraceTag(509645913,0,10,"GridContextMenu:ExecuteCommand() - GridContextMenuFilter is null")}vZ(fb=!1){let ab=!1,wb=!1,kb=0;X.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&
(kb=e.a.ee());const tb=this.Xa.Nq(this.menuId);var hb=this.grid.ga.qa;const Fb=hb.ph,va=Fb&&hb.gd.Ng,jb=Fb&&hb.gd.isRow;hb=hb.selectedRanges;const Ab=d.a.all(hb,Ea=>Ea.Ng),Qa=d.a.all(hb,Ea=>Ea.isRow),Z=O.P(hb),wa=O.Q(hb);this.fof(va,jb)?(ab=!0,this.KRh(tb)):this.$.isEditMode?Ha.a(this.$)?this.MRh(tb,va,jb):(this.HQh(tb,!(jb||va||!this.imc)),this.eRh(tb,hb,fb),this.UQh(tb,Ab,Qa,Z,wa),this.y2e(tb,Fb,va,jb),this.fSh(tb),this.d2e(tb,va,jb),this.ARh(tb,Fb,va,jb,hb),this.KQh(tb),this.IQh(tb,hb),this.mRh(tb),
this.ZRh(tb,Fb),X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.ZQh(tb)):(wb=!0,Ha.a(this.$)?this.t2e(tb):this.vSh(tb,Fb,va,jb,hb));X.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(fb=e.a.ee()-kb,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${fb}, isPivotMenu: ${ab}, isViewMenu: ${wb}, firstTimeEntry: ${this.XKe}`));this.XKe=!1;return tb}eMa(fb){const ab=[];if(Ha.a(this.$))return ab;
if(3===fb){fb=this.grid.ga.qa;const kb=fb.ph,tb=kb&&fb.gd.Ng,hb=kb&&fb.gd.isRow;let Fb=!1;var wb=!1;let va=!1;this.$.isMobileMode&&(wb=fb.selectedRanges,Fb=O.P(wb),wb=O.Q(wb));if(kb){const jb=ua.f(this.grid);jb&&jb.range.contains(fb.gd)&&this.bW(jb)&&(va=!0)}this.$.isEditMode?this.fof(tb,hb)?ab.push(...[F.a.nQf,F.a.pQf]):tb||hb?(ab.push(F.a.clipboard),hb?ab.push(F.a.dxj):tb&&ab.push(F.a.dah)):(ab.push(...[F.a.edit,F.a.clipboard]),va?ab.push(F.a.hyperlink):ab.push(F.a.color),kb&&ab.push(F.a.ZYg)):
(ab.push(F.a.copy),va&&ab.push(F.a.openHyperlink),!hb||this.$.isMobileMode&&wb?!tb||this.$.isMobileMode&&Fb||ab.push(F.a.mbk):ab.push(F.a.nbk));ab.push(F.a.fci)}else 2===fb&&ab.push(F.a.KDe);return ab}fof(fb,ab){return(this.tCa||this.zxa||this.SZ||this.refresh||this.expandCollapse)&&!(fb||ab)}showGridContextMenu(fb){this.expandCollapse=this.refresh=this.SZ=this.zxa=this.tCa=!1;var ab=this.$,wb=X.EwaSettings.Xw()?this.Ev.r5():ea.a(ab).r5(),kb=this.grid.ga.qa;const tb=kb.ph;var hb=tb&&kb.gd.Ng;kb=tb&&
kb.gd.isRow;if(wb&&!hb&&!kb){hb=ha.a(ab);if(null===hb||void 0===hb?0:hb.UVd)this.tCa=hb=G.h(ab.Ue),this.zxa=!hb;hb=ab.nc;this.SZ=wb.supportsBIExplore&&!!y.a(ab)&&hb.z3(32768);hb.allowInteractivity&&(ab=this.grid.Ob(null),(null===ab||void 0===ab?0:ab.cell)&&(ab.cell.w3c||ab.cell.Fbg)&&(this.expandCollapse=!0),hb.allowManualDataRefresh&&(this.refresh=!0))}ab=null;wb=1;hb=Object(l.a)(h.a,fb.eventArgs);fb=Object(l.a)(A.a,fb.creationParams);kb=this.YWh();fb?(ab=fb.clientPoint,wb=fb.inputMethod):hb&&1!==
hb.Cb?(ab=new Sys.UI.Point(hb.clientPoint.x,hb.clientPoint.y),wb=hb.Cb):kb&&(ab=new Sys.UI.Point(kb.x+(this.$.isChromeRtl?0:kb.width),kb.y+kb.height));N.a.Eb=wb;this.imc=3===wb;fb=w.a.uwb;this.to(ab,!hb||hb.Da.target.className!==fb,wb)}removeHyperlinksFromRange(fb,ab){if(!X.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.wt(fb,!0)){var wb=O.r(fb,this.$),kb=this.$.pa.va.ic();this.$.userOperationManager.Tc(new U.a(125,0,(tb,hb,Fb)=>{this.$.Oy();
return ca.b(this.$.pa.va,wb,"","",!0,!1,127,tb,hb,Fb,null,kb)},void 0,()=>new P(wb)),ab);this.grid.Wg.CM(!1)}}YWh(){var fb=this.grid.Ob(null);if((null===fb||void 0===fb?0:fb.cell.qk)&&this.mnf(fb))return this.grid.getCellBounds(fb.cell);fb=this.grid.ga.qa.activeCell;return(fb=this.qcc(new H.Range(fb.top,fb.left,x.a.Fg,fb.left,!1,!1),2,!0)||this.qcc(new H.Range(1,fb.left,fb.top,fb.left,!1,!1),2,!1)||this.qcc(new H.Range(fb.top,fb.right,fb.top,x.a.Eg,!1,!1),1,!0)||this.qcc(new H.Range(fb.top,1,fb.top,
fb.right,!1,!1),1,!1)||null)&&fb.qk?this.grid.getCellBounds(fb):Sys.UI.DomElement.getBounds(this.grid.txa.rc)}mnf(fb){var ab=this.grid.rtl,wb=this.$.isChromeRtl;fb=fb.cell;var kb=ua.h(this.$).wK(fb);return kb?(kb=kb.topLeft,ab=kb.x+=ab===wb?fb.offsetWidth:0,wb=kb.y+=fb.offsetHeight,this.grid.view.visibleArea.contains(new n.a(ab,wb,0,0))):!1}qcc(fb,ab,wb){fb=this.grid.dk("GridContextMenu.FindFirstCellInViewportArea",fb,ab,wb);try{for(fb.$$rst();fb.$$mn();){const kb=fb.$$cu();if(kb&&this.mnf(kb))return kb.cell}}finally{fb&&
fb.dispose()}return null}KRh(fb){const ab=this.Xa,wb=ab.Nc();this.refresh&&wb.buttons.push(ab.tb(100));this.SZ&&wb.buttons.push(ab.tb(99));this.tCa?wb.buttons.push(ab.tb(59)):this.zxa&&wb.buttons.push(ab.tb(58));if(this.expandCollapse){let kb;kb=ab.Gw("ContextMenu.PivotExpandCollapse",null,D.a.instance.ha(1167),589118293);const tb=ab.Nc();tb.buttons.push(ab.tb(243));tb.buttons.push(ab.tb(244));tb.buttons.push(ab.tb(245));tb.buttons.push(ab.tb(246));kb.menu.Cc.push(tb);kb&&0<tb.buttons.length&&wb.buttons.push(kb)}fb.Cc.push(wb)}y2e(fb,
ab,wb,kb){if(ab&&!wb&&!kb){ab=this.Xa.Nc();this.Cjc&&!this.$.MF&&this.Sgd(ab);this.$gd(ab);this.jSh(ab);if(X.EwaSettings.ya(417)&&ua.h(this.$).ga.qa.mN()&&ua.h(this.$).ga.qa.Q_)switch(X.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:ab.buttons.push(this.Xa.tb(237));break;case 2:ab.buttons.push(this.Xa.tb(238));break;default:ab.buttons.push(this.Xa.tb(236))}fb.Cc.push(ab)}}$gd(fb){if(this.$.nc.allowSorting&&(!this.$.isMobileMode||
(new Y.a(this.$.ua)).Zd(2048))){var ab=this.Xa.Nc();ab.buttons.push(this.Xa.tb(223));ab.buttons.push(this.Xa.tb(224));ab.buttons.push(this.Xa.tb(292));ab.buttons.push(this.Xa.tb(293));ab.buttons.push(this.Xa.tb(294));this.$.isMobileMode||ab.buttons.push(this.Xa.tb(225));var wb=this.Xa.Gw("ContextMenu.sort",null,D.a.instance.ha(227),-864298118);wb.menu.Cc.push(ab);fb.buttons.push(wb)}}Sgd(fb){const ab=this.Xa.Gw("ContextMenu.filter",null,D.a.instance.ha(1970),2045563128),wb=this.Xa.Nc();var kb=this.w0h();
const tb=this.Xa.tb(234);tb.label=kb;wb.buttons.push(tb);wb.buttons.push(this.Xa.tb(235));kb=this.Xa.Nc();kb.buttons.push(this.Xa.tb(233));ab.menu.Cc.push(wb);ab.menu.Cc.push(kb);fb.buttons.push(ab)}jSh(fb){if(ua.h(this.$).ga.qa.mN()){const ab=this.Xa.Nc();ab.buttons.push(this.Xa.tb(232));ab.buttons.push(this.Xa.tb(285));ab.buttons.push(this.Xa.tb(286));this.JCe()&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7750143_EnableTableShareFromContextMenu")&&ab.buttons.push(this.Xa.tb(276));const wb=this.Xa.Gw("ContextMenu.table",
null,D.a.instance.ha(1969),-697806646);wb.menu.Cc.push(ab);fb.buttons.push(wb)}}o2e(fb,ab,wb,kb,tb){if(ab){const Fb=O.L(tb);var hb=ua.f(this.grid);if(hb&&!wb&&!kb){wb=new Y.a(this.$.ua);if(hb.range.contains(Fb)&&this.bW(hb)){(ab=!hb.mma&&!wb.di)&&this.$.isEditMode&&fb.buttons.push(this.Xa.tb(45));hb.rca&&fb.buttons.push(this.Xa.tb(53));ab&&this.$.isEditMode&&fb.buttons.push(this.Xa.tb(47));return}!hb.mma&&this.$.isEditMode&&(hb=wb.Zd(128),fb.buttons.push(this.Xa.tb(hb?46:121)))}}this.Nhj(tb)&&fb.buttons.push(this.Xa.tb(48));
ab&&this.JCe()&&(ab=O.L(tb),this.Mhj(ab)?fb.buttons.push(this.Xa.tb(276)):ab.Ng||ab.isRow||fb.buttons.push(this.Xa.tb(275)))}Nhj(fb){for(const ab of fb){fb=this.grid.getRangeInformation(ab);for(let wb=0;wb<fb.length;wb++)if(Object(u.a)(E.HyperlinkRange,fb[wb])){const kb=this.grid.Ob(fb[wb]);if(kb&&this.bW(kb)&&!kb.mma)return!0}}return!1}Mhj(fb){if(ua.h(this.$).ga.qa.mN()){const ab=ua.h(this.$).wb.mh(fb);if(ab&&ab.usedRange.equals(fb))return!0}return!1}JCe(){var fb=this.$.ua.na;return fb&&fb.Be&&(fb=
fb.Be.wB||fb.Be.CN,!this.$.MF&&X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&R.g(this.$)&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&!fb)?!0:!1}d2e(fb,ab,wb){var kb,tb;if(1===ua.h(this.$).ga.Se&&!ab&&!wb){ab=Ha.a(this.$);wb=this.Xa;var hb=wb.Nc(),Fb=this.$.da.Aa(65);(null===(kb=null===Fb||void 0===Fb?void 0:Fb.nn)||void 0===kb?0:kb.AF)&&!ab&&hb.buttons.push(wb.tb(227));Fb&&Fb.isCommentOperationEnabled(3)&&hb.buttons.push(wb.tb(221));(null===(tb=null===
Fb||void 0===Fb?void 0:Fb.nn)||void 0===tb?0:tb.Wnd)&&!ab&&hb.buttons.push(wb.tb(228));(null===Fb||void 0===Fb?0:Fb.hasCommentAtActiveCell)?Fb.XC.isResolved||hb.buttons.push(wb.tb(159)):Fb&&Fb.hasCommentAtActiveCell||(Fb&&Fb.nn&&Fb.nn.AF?ab||(hb.buttons.push(wb.tb(229)),hb.buttons.push(wb.tb(230))):(hb.buttons.push(wb.tb(160)),ab||hb.buttons.push(wb.tb(226))));fb.Cc.push(hb)}}fSh(fb){if(X.EwaSettings.ya(127)){const ab=this.Xa,wb=ab.Nc();wb.buttons.push(ab.tb(250));fb.Cc.push(wb)}}eRh(fb,ab,wb){if(!wb){wb=
this.$.Ia.LH();var kb=new Y.a(this.$.ua),tb=new Q.a(wb,ab,this.grid);(new M(fb,this.$,this.Xa,wb,ab,this.grid,tb,kb)).Ogd()}}UQh(fb,ab,wb,kb,tb){const hb=(new Y.a(this.$.ua)).Zd(8),Fb=this.Xa,va=Fb.Nc();ab&&va.buttons.push(Fb.tb(hb?152:153));wb&&va.buttons.push(Fb.tb(hb?150:151));ab&&(kb||va.buttons.push(Fb.tb(hb?109:155)),va.buttons.push(Fb.tb(hb?111:157)));wb&&(tb||va.buttons.push(Fb.tb(hb?108:154)),va.buttons.push(Fb.tb(hb?110:156)));fb.Cc.push(va)}HQh(fb,ab){const wb=this.Xa,kb=wb.Nc();fb.Cc.push(kb);
ab&&kb.buttons.push(wb.tb(102));kb.buttons.push(wb.tb(42));kb.buttons.push(wb.tb(43));ab=this.HRh(wb);fb.Cc.push(ab)}HRh(fb){const ab=fb.Nc();ab.title=D.a.instance.ha(1147);ab.Ddg=!1;ab.Cdg=!1;ab.Jig=!1;let wb=5;const kb=B.a.rwd(this.$);kb&&(wb=6);fb=fb.dD("PasteOptionsGallery",wb,"Size24by24",ab.title);ab.buttons.push(fb);fb.tu("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"Paste_24",1,m.a.zEh);fb.tu("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",
1149,void 0,"PasteValues_24",1,m.a.EEh);fb.tu("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1150,void 0,"PasteFormulas_24",1,m.a.BEh);fb.tu("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1151,void 0,"PasteTranspose_24",1,m.a.DEh);fb.tu("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1152,void 0,"PasteFormatting_24",1,m.a.AEh);kb&&fb.tu("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",
1153,void 0,"PasteLink_24",1,m.a.CEh);return ab}vSh(fb,ab,wb,kb,tb){var hb;const Fb=this.Xa;var va=Fb.Nc();va.buttons.push(Fb.tb(43));fb.Cc.push(va);this.Cjc&&!this.$.MF&&(va=this.Xa.Nc(),this.Sgd(va),fb.Cc.push(va));X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.nc.isMobileMode&&this.$.ea.nc.isReadOnlyEditMode&&!this.$.xa.IsMeetingLiveSession||(va=this.Xa.Nc(),this.$gd(va),fb.Cc.push(va),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));
va=this.$.da.Aa(65);if(null===(hb=null===va||void 0===va?void 0:va.nn)||void 0===hb?0:hb.AF)hb=this.Xa.Nc(),hb.buttons.push(Fb.tb(229)),fb.Cc.push(hb);hb=this.Xa.Nc();this.o2e(hb,ab,wb,kb,tb);fb.Cc.push(hb);r.AFrameworkApplication.isMobileMode&&!I.a(this.$.xa,29)&&(ab=Fb.Nc(),ab.buttons.push(Fb.tb(272)),fb.Cc.push(ab))}ARh(fb,ab,wb,kb,tb){const hb=this.Xa.Nc();B.a.Wsd()?this.OQh(hb):this.BRh(hb);this.o2e(hb,ab,wb,kb,tb);0<hb.buttons.length&&fb.Cc.push(hb)}BRh(fb){fb.buttons.push(this.Xa.tb(135))}OQh(fb){fb.buttons.push(this.Xa.tb(300))}ZQh(fb){const ab=
this.Xa.Nc();ab.buttons.push(this.Xa.tb(185));fb.Cc.push(ab)}ZRh(fb,ab){X.EwaSettings.ya(418)&&ab&&(ab=this.Xa.Nc(),ab.buttons.push(this.Xa.tb(262)),fb.Cc.push(ab))}mRh(fb){var ab=this.grid.ga.qa.selectedRanges;if(ab&&ab.length){var wb=!1;for(var kb=0;kb<ab.length;kb++)if(this.grid.wb.Cya(ab[kb])){wb=!0;break}if(wb){wb=!1;for(kb=0;kb<ab.length;kb++){var tb=this.grid.wb.R4h(ab[kb]);if(null!=tb&&null!=tb[0]){for(var hb=0;hb<tb.length;hb++)if(this.grid.wb.Cya(tb[hb])){wb=!0;break}if(wb)break}}hb=this.Xa;
kb=hb.Nc();tb=hb.Nc();var Fb=1===ab.length&&(ab[0].isSingle||this.grid.wb.Dya(ab[0])),va=!1,jb=!1,Ab=!1,Qa=!1;for(let Z=0;Z<ab.length&&!(va&&Ab&&jb&&Qa);Z++)!va&&this.grid.wb.gxi(ab[Z])&&(va=!0),!Ab&&this.grid.wb.cnf(ab[Z],!1)&&(Ab=!0),!jb&&this.grid.wb.xlc(ab[Z])&&(jb=!0),!Qa&&this.grid.wb.ekf(ab[Z])&&(Qa=!0);X.EwaSettings.ya(102)&&Fb&&!this.grid.wb.GBb(ab[0])&&(Qa?kb.buttons.push(hb.tb(217)):kb.buttons.push(hb.tb(216)));Qa=va;Qa=!(new Y.a(this.$.ua)).di&&Qa;Ab&&!wb&&(X.EwaSettings.ya(123)&&G.n(this.$.Ue)&&
(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?tb.buttons.push(hb.tb(220)):tb.buttons.push(hb.tb(Qa?220:271)),jb&&tb.buttons.push(hb.tb(Qa?218:269)),Fb&&(this.grid.wb.xlc(ab[0])||this.grid.wb.GBb(ab[0]))&&tb.buttons.push(hb.tb(Qa?219:270))),tb.buttons.push(hb.tb(Qa?215:268)));0<tb.buttons.length&&(ab=hb.Gw(va?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,D.a.instance.ha(1783),798637440),ab.menu.Cc.push(tb),
kb.buttons.push(ab));0<kb.buttons.length&&fb.Cc.push(kb)}}}IQh(fb,ab){this.grid.wb.qlf(ab)&&(ab=this.Xa.Nc(),this.grid.ga.qa.Xca()?(ab.buttons.push(this.Xa.tb(241)),ab.buttons.push(this.Xa.tb(239))):ab.buttons.push(this.Xa.tb(240)),fb.Cc.push(ab))}bW(fb){return fb.cell.hasHyperlink}t2e(fb){this.NRh(fb);var ab=this.Xa.Nc();this.$gd(ab);fb.Cc.push(ab);this.Cjc&&(ab=this.Xa.Nc(),this.Sgd(ab),fb.Cc.push(ab))}MRh(fb,ab,wb){this.t2e(fb);this.d2e(fb,ab,wb)}NRh(fb){if(this.grid.ga.qa.ph&&!this.grid.lb.mj){var ab=
this.Xa,wb=ab.Nc();Ca.a(this.$).uWd()?wb.buttons.push(ab.tb(265)):wb.buttons.push(ab.tb(264));fb.Cc.push(wb)}}static w7i(fb){const ab=fb.lMa(db.lpd);ab&&ab.Vqd&db.lpd&&fb.invoke(db.lpd,null)}static dRh(fb,ab,wb){(wb=wb.da.Aa(254))?(wb.ykc()&&wb.tsf()&&fb.buttons.push(ab.tb(212)),wb.ykc()&&wb.fnc()&&fb.buttons.push(ab.tb(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}jLj(){const fb=(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",
!1)?W.a.jo(aa.db):this.$.da.Aa(66)).lj,ab=this.grid.ga.qa.activeCell;return null!=fb&&!fb.hasActiveFilter||sa.c(this.$,ab)||!this.csi(ab)}csi(fb){const ab=fb.left;var wb=this.Jld();if(null!=wb&&null!=wb.fcc&&wb.fcc.includes(ab-1))return!0;wb=this.sld();return null!=wb&&O.E(wb).contains(fb)&&null!=wb.FilteredColumns&&wb.FilteredColumns.includes(ab-1)?!0:!1}bsi(){var fb=(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?W.a.jo(aa.db):this.$.da.Aa(66)).lj;const ab=
this.Jld();if(null!=fb)return fb.hasAutoFilter&&fb.hasActiveFilter;if(null!=ab)return null!=ab.fcc&&0<ab.fcc.length;fb=this.sld();return null!=fb&&O.E(fb).contains(this.grid.ga.qa.activeCell)&&null!=fb.FilteredColumns&&0<fb.FilteredColumns.length}Jld(){const fb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?W.a.jo(aa.db):this.$.da.Aa(66);fb.aq(this.grid.ga.qa.activeCell);return fb.Oxb(this.grid.ga.qa.activeCell)}sld(){return this.$.ua.getItemByName(this.$.na.sheetName).DS}w0h(){var fb=
this.grid.ga.qa.activeCell,ab=0,wb=!1,kb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableManager",!1)?W.a.jo(aa.db):this.$.da.Aa(66),tb=this.Jld();kb=kb.lj;null!=kb?(ab=kb.usedRange.top,wb=!0):null!=tb?(ab=tb.top,wb=!0):(tb=this.sld(),null!=tb&&O.E(tb).contains(fb)&&(ab=tb.FirstRow+1,wb=!0));return wb?(fb=fb.left,ab=H.Range.Lc(ab,fb),ab=this.grid.Ob(ab),wb="",null!=ab&&(wb=ab.text),this.e1g(wb,fb)):D.a.instance.ha(220)}e1g(fb,ab){return null==fb||bb.a.Yg(fb.trim())?String.format(D.a.instance.qb(157),
H.Range.HM(ab)):fb.length>db.T5d?String.format(D.a.instance.qb(155),fb.substring(0,db.T5d)):String.format(D.a.instance.qb(156),fb)}nLj(){const fb=this.grid.ga.qa.selectedRanges;if(!fb||!fb.length)return!0;for(let ab=0;ab<fb.length;ab++)if(!this.grid.wb.wma(fb[ab]))return!1;return!0}}db.SMb="GridContextMenuRootName";db.nci=z.a.FIe;db.lpd=192;db.T5d=26;Object(t.a)(db,"GridContextMenu",v.a,[])},1473:function(t,C,a){a.r(C);t=a(1183);a=a(1123);Object(a.a)();Object(t.a)()},744:function(t,C,a){a.d(C,"a",
function(){return I});t=a(0);var c=a(2),b=a(14),f=a(573),e=a(92),d=a(569),h=a(383),r=a(594),l=a(576),u=a(117),v=a(232),x=a(84),w=a(425),m=a(1465);C=a(86);var n=a(19),z=a(7),y=a(834),A=a(80),F=a(45),D=a(61),B=a(155),M=a(119),R=a(1),P=a(12),E=a(23),H=a(15),G=a(21),N=a(36);class I extends C.a{constructor(O,U,ca,Q,Y,la,ea,ha,X,T,ua,Ha){super();this.hpc=!1;this.OKc=this.ANc=this.contextMenuController=null;this.Tsd=!1;this.ryc=this.qvb=null;this.kD=()=>{this.contextMenuController?this.contextMenuController.kD():
b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.Ulg()};this.pb=O;this.Syf=Y;this.IUc=T;this.KQf=la;this.populateOnlyOnce=ea;this.sgi=ua;this.JXf(Ha)}get contextMenuRoot(){return this.ryc}get $(){return this.pb}get Xa(){return this.IUc}get menuId(){return this.$.Ib+this.Syf}get sxb(){this.ANc||(this.ANc=M.a(this.$));return this.ANc}get Asb(){this.OKc||(this.OKc=G.h(this.$).hc);return this.OKc}Oc(O,
U){O=!0;switch(U){case 1651433993:case 1675506831:case 966232027:O=this.Zd(4096)||this.Zd(2048);break;case 2045563128:O=this.Zd(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:O=this.Zd(8192)}return!O}Vc(O,U,ca){ca.IsShadowMenuOpen||y.i(this.$,y.d);O=!1;U===this.nx&&(ca.IsShadowMenuOpen||y.i(this.$,y.a),U=Object(c.a)(new f.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.TId(U,ca.IsShadowMenuOpen),ca.MenuItems=U,ca.IsShadowMenuOpen||y.i(this.$,
y.c),O=!0);O&&this.hpc&&P.HelperMethods.j4b&&!ca.IsShadowMenuOpen&&y.k(this.$);return O}TId(O,U){(U=this.vZ(U))?(this.igf(U),O.MenuSectionList.push(...U.VE().MenuSectionList),this.hOg(O)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}vZ(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null}s1(O,U,ca,Q,Y){O=
Sys.UI.DomElement.getBounds(U);U=new Sys.UI.Point(O.x,O.y+O.height);this.$.isChromeRtl&&(U.x+=O.width);this.to(U,Y)}to(O,U,ca=0){U&&(O=N.a(this.$).gla(O));U=!0;if(this.sgi){let Q;3===ca?(Q=this.eMa(3))&&0<Q.length?(U=!1,this.showFloatie(Q,new Sys.UI.Bounds(O.x,O.y,0,0),ca)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===ca&&this.$.isEditMode&&((Q=this.eMa(2))&&
0<Q.length?Q[0]!==I.o0e?(U=!1,this.RWd(Q,new Sys.UI.Bounds(O.x,O.y,0,0),ca)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}U&&this.showContextMenu(new Sys.UI.Bounds(O.x,O.y,0,0),ca)}eMa(){return null}Okd(O,U=null){let ca=
"";3===O?ca="touch":2===O&&(ca="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!D.a.Ag&&D.a.Ag.LK,["IsReactMLR"]:!!D.a.Ag&&D.a.Ag.fW,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:ca,["FloatieGroups"]:JSON.stringify(U)}}showContextMenu(O,U=0){const ca=this.Okd(U);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(ca)}`);this.contextMenuController?this.TB!==z.a.HLd&&this.TB!==z.a.ILd||0===U?this.contextMenuController.QWd(this.TB,
O,A.a.Eb):this.contextMenuController.QWd(this.TB,O,U):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(O,U,ca){const Q=this.Okd(ca,O);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(Q)}`);this.contextMenuController?(this.RXf(),this.contextMenuController.XBc(O,U,ca)):(O=JSON.stringify(O),b.ULS.sendTraceTag(537167071,0,
10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${O}.`))}RWd(O,U,ca){var Q=this.Okd(ca,O);Q=JSON.stringify(Q);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${Q}`);this.contextMenuController?(this.RXf(),this.contextMenuController.PWd(O,U,ca,this.TB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}JXf(O){this.contextMenuController=
O}dispose(){this.$&&this.$.Ia.Jdb(this);this.pb=null;this.Ulg();this.ryc&&(e.a.Ja(this.ryc),this.ryc=null);super.dispose()}KQh(O){var U=this.$.da.Aa(204);U&&(U=U.sRh(this.Syf))&&O.Cc.push(U)}Zd(O){return(new B.a(this.$.ua)).Zd(O)}igf(O){for(const U of O.Cc)if(Object(w.a)(355,U)){O=U;O.title&&(O.title=I.rf(O.title));for(const ca of O.buttons)Object(w.a)(356,ca)?(O=ca,O.label=I.rf(O.label),O.yS(I.rf(O.alt))):Object(w.a)(357,ca)&&this.igf(ca.menu)}}Pyf(O,U=!1){const ca=[];for(const Q of O)ca.push(this.uQ(Q,
U));return ca}uQ(O){const U=[];for(const ca of O.MenuItems)switch(ca.Type){case 3:U.push(this.hgh(ca));break;case 2:U.push(this.Plh(ca));break;case 1:U.push(this.Ghh(ca))}return Object(c.a)(new d.a,{ControlList:U,Title:O.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Ugd(O,U){U=[this.qvb,O.RibbonCommand.toString(),U?this.y6e(U):this.y6e(O.Label),O.Disabled?O.Disabled.toString():"False"];let ca=O.CommandData;ca=E.a.hashCode(ca).toString();
U.push(ca,O.Identifier.toString());U=U.join("_");O.IsChecked&&(U+="_Checked");return U}tRh(O){const U=[this.qvb,E.a.hashCode(O.Title).toString()];for(const ca of O.MenuItems)U.push(ca.RibbonCommand.toString());return U.join("_")}l2e(O){var U=O.Label;U=E.a.hashCode(U).toString();U=[this.qvb,U];R.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&O.Id&&U.push(E.a.hashCode(O.Id).toString());U=U.join("_");O.IsChecked&&(U+="_Checked");return U}hgh(O){let U,
ca,Q;({label:ca,mNa:Q,Pr:U}=this.odc(O,!1));const Y=this.Ugd(O,ca);return Object(c.a)(new h.a,{Command:O.Disabled?(-251203935).toString():U.toString(),ExternalId:Y,Id:Y,Image16by16Class:Q,LabelText:ca||O.Label,MenuItemId:O.CommandData,CommandValueId:O.CommandData})}Plh(O){let U,ca,Q;({label:ca,mNa:Q,Pr:U}=this.odc(O,O.IsChecked));const Y=this.Ugd(O,ca);return Object(c.a)(new r.a,{Command:O.Disabled?(-251203935).toString():U.toString(),ExternalId:Y,Id:Y,Image16by16Class:Q,LabelText:ca||O.Label,MenuItemId:O.CommandData,
CommandValueId:O.CommandData,IsChecked:O.IsChecked})}Ghh(O){let U;var ca;({label:U,mNa:ca}=this.u2e(O));const Q=Object(c.a)(new f.a,{MenuSectionList:[],UpdateDynamically:!0});Q.MenuSectionList.push(...this.Pyf(O.SubMenu.Sections,!0));const Y=this.l2e(O);O=U||O.Label;return Object(c.a)(new l.a,{ExternalId:Y,Id:Y,LabelText:O,PopulateOnlyOnce:!1,Menu:Q,Image16by16Class:ca,ImageIsVisible:!!ca})}u2e(O){let U,ca;({label:O,mNa:U,Pr:ca}=this.odc(O,!0));return{label:O,mNa:U,Pr:ca}}odc(O,U){let ca;switch(O.Identifier){case 26:ca=
912804500;U=n.a.tXe;O=H.a.instance.ha(1951);break;case 3:ca=-1902148570;U=U?n.a.Jba:null;O=H.a.instance.ha(1911);break;case 4:ca=-1902148570;U=U?n.a.Jba:null;O=H.a.instance.ha(1912);break;case 5:ca=-1902148570;U=U?n.a.Jba:null;O=null;break;case 1:ca=-1677817820;U=n.a.dbc;O=H.a.instance.ha(233);break;case 2:ca=-1649376918;U=O.IsChecked?n.a.Mva:null;O=H.a.instance.ha(2122);break;case 23:ca=1701016594;U=O.IsChecked?n.a.Mva:null;O=H.a.instance.ha(2122);break;case 6:ca=-87741481;U=null;O=H.a.instance.ha(2123);
break;case 7:ca=1948650742;U=n.a.fWe;O=H.a.instance.ha(1949);break;case 8:ca=1933713114;U=n.a.eWe;O=H.a.instance.ha(1950);break;case 14:ca=504133448;U=n.a.XKa;O=H.a.instance.ha(144);break;case 30:ca=504133448;U=n.a.XKa;O=H.a.instance.Va(744);break;case 32:ca=504133448;U=n.a.XKa;O=H.a.instance.ha(148);break;case 34:ca=504133448;U=n.a.XKa;O=H.a.instance.ha(150);break;case 27:ca=1701016594;U=U?n.a.gbc:n.a.XKa;O=H.a.instance.ha(144);break;case 15:ca=-798968736;U=n.a.YKa;O=H.a.instance.ha(146);break;case 31:ca=
-798968736;U=n.a.YKa;O=H.a.instance.Va(745);break;case 33:ca=-798968736;U=n.a.YKa;O=H.a.instance.ha(149);break;case 35:ca=-798968736;U=n.a.YKa;O=H.a.instance.ha(151);break;case 28:ca=1701016594;U=U?n.a.hbc:n.a.YKa;O=H.a.instance.ha(146);break;case 21:ca=-2058042992;U=n.a.D4a;O=null;break;case 29:ca=1701016594;U=n.a.D4a;O=null;break;case 9:ca=1701016594;O=U=null;break;case 11:ca=-1494291901;O=U=null;break;case 25:ca=-1045020714;U=O.IsChecked?n.a.Mva:null;O=null;break;case 13:ca=1701016594;U=O.IsChecked?
n.a.Mva:null;O=H.a.instance.ha(153);break;case 16:ca=1701016594;U=n.a.Vac;O=H.a.instance.ha(1082);break;case 17:ca=1701016594;U=n.a.C4a;O=null;break;case 18:ca=1701016594;U=n.a.B4a;O=null;break;case 19:ca=1701016594;U=n.a.Xac;O=H.a.instance.ha(1087);break;case 20:ca=1701016594;U=n.a.$cd;O=H.a.instance.ha(1088);break;case 24:ca=1675506831;O=U=null;break;case 22:ca=O.RibbonCommand;U=O.IsChecked?n.a.Jba:null;O=null;break;case 36:ca=1461300262;U=null;O=H.a.instance.ha(152);break;case 38:ca=O.RibbonCommand;
U=n.a.qdd;O=H.a.instance.ha(1822);break;case 37:ca=1461300262;U=null;O=H.a.instance.ha(155);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(O)}`),ca=1461300262,O=U=null}return{label:O,mNa:U,Pr:ca}}y6e(O){return E.a.hashCode(O+P.HelperMethods.PCj).toString()}hOg(O){if(!this.$.ea.amIAlone){var U=this.$.da.Aa(25);if(U&&!u.a.isEmpty(U.xqa)&&(U=U.Rai(),!v.a.Yg(U))){var ca=[];x.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").gkh(U,ca);O.MenuSectionList.push(...ca)}}}RXf(){this.Tsd||
(this.sxb&&this.sxb.F1b(this.kD),this.Asb&&this.Asb.F1b(this.kD),this.Tsd=!!this.sxb||!!this.Asb)}Ulg(){this.sxb&&this.sxb.Rwc(this.kD);this.Asb&&this.Asb.Rwc(this.kD);this.Tsd=!1}static Lhd(O,U,ca){U=F.D(U);O=G.h(O);return ca?O.Kwb(U.left):O.Ca.Pwa(U)}static $rd(O,U){U=F.D(U);O=G.h(O).Ca.Pwa(U);return!(null===O||void 0===O||!O.qk)}static Zrd(O,U){return U?!!O:!(null===O||void 0===O||!O.qk)}static aid(O,U,ca){U=F.D(U);var Q=G.h(O).Ca.Pwa(U);U=G.h(O).getCellBounds(Q);const Y=Q.I1c;Q=Q.E1c;let la=U.x+
Y.x;U=U.y+Y.y;ca&&R.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(G.h(O).rtl||(la+=Q),U-=Q);return new Sys.UI.Point(la,U)}static $hd(O,U,ca,Q){if(U){var Y=G.h(O);Q=Q?Y.t0h(U):Y.getCellBounds(U);Y=U.I1c;U=U.E1c;var la=Q.x+Y.x;Q=Q.y+Y.y;ca&&R.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(G.h(O).rtl||(la+=U),Q-=U);return new Sys.UI.Point(la,Q)}b.ULS.sendTraceTag(509220164,0,15,`ContextMenuBase.getContextMenuCoordinates:\u00a0cellProxy is undefined, isHeaderCommandData=${Q}`)}static DIh(O){try{Object(m.a)(O.CommandValueId)}catch(U){}}static rf(O){const U=
I.N3a.parseFromString(O,"text/html");return U?U.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),O)}}I.N3a=new DOMParser;I.o0e="Unsupported";Object(t.a)(I,"ContextMenuBase",C.a,[233,358,2])},834:function(t,C,a){a.d(C,"j",function(){return"ContextMenuPerf.A"});a.d(C,"b",function(){return"ContextMenuPerf.B"});a.d(C,"d",function(){return"ContextMenuPerf.C1"});a.d(C,"a",function(){return"ContextMenuPerf.C2"});a.d(C,"c",function(){return"ContextMenuPerf.D"});a.d(C,
"e",function(){return u});a.d(C,"f",function(){return w});a.d(C,"h",function(){return m});a.d(C,"i",function(){return n});a.d(C,"k",function(){return z});a.d(C,"g",function(){return A});var c=a(14),b=a(330),f=a(9),e=a(66),d=a(25),h=a(12),r=a(21),l=a(1);const u=(F,D)=>{var B=F.Ob(null);if((null===B||void 0===B?0:B.cell.qk)&&v(B,F,D))return F.getCellBounds(B.cell);B=F.ga.qa.activeCell;return(D=x(new d.Range(B.top,B.left,f.a.Fg,B.left,!1,!1),2,!0,F,D)||x(new d.Range(1,B.left,B.top,B.left,!1,!1),2,!1,
F,D)||x(new d.Range(B.top,B.right,B.top,f.a.Eg,!1,!1),1,!0,F,D)||x(new d.Range(B.top,1,B.top,B.right,!1,!1),1,!1,F,D)||null)&&D.qk?F.getCellBounds(D):Sys.UI.DomElement.getBounds(F.txa.rc)},v=(F,D,B)=>{var M=D.rtl,R=B.isChromeRtl;F=F.cell;return(B=r.h(B).wK(F))?(B=B.topLeft,M=B.x+=M===R?F.offsetWidth:0,R=B.y+=F.offsetHeight,D.view.visibleArea.contains(new e.a(M,R,0,0))):!1},x=(F,D,B,M,R)=>{F=M.dk("ContextMenuHelper.FindFirstCellInViewportArea",F,D,B);try{for(F.$$rst();F.$$mn();){const P=F.$$cu();if(P&&
v(P,M,R))return P.cell}}finally{F&&F.dispose()}return null},w=F=>F.wb.o6(F.ga.qa.activeCell),m=F=>{F=r.h(F).ga.qa;return F.ph&&(F.gd.isRow||F.gd.Ng)},n=(F,D)=>{h.HelperMethods.B2c&&window.performance.mark(D)},z=()=>{if(b.a.Lrb){const F=y("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),D=y("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),B=y("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${F}], PrepInfraWork=[${D}], EWAPopulation =[${B}]`)}},
y=(F,D,B)=>{window.performance.measure(F,D,B);D=window.performance.getEntriesByName(F);D.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${F}] returned no measures.`);return D[D.length-1]?D[D.length-1].duration:-1},A=F=>l.EwaSettings.isChangeGateEnabled("OfficeVSO:7214067_CheckShareModeCapability")?F.Nd&33554432?!0:!1:!0},866:function(t,C,a){a.d(C,"a",function(){return c});t=a(0);class c{}c.edit="Edit";c.clipboard="Clipboard";c.copy="Copy";c.color="Color";c.ZYg=
"AutoFill";c.dxj="RowOperations";c.dah="ColumnOperations";c.nbk="ViewModeRowOperations";c.mbk="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.GJj="ShapeStyle";c.vNh="FloatingObjectClipboard";c.nQf="PivotTableCopyDelete";c.pQf="PivotTableFieldListActions";c.KDe="CellFloatie";c.CJj="ShapeFloatie";c.contextMenu="ContextMenu";c.fci="GridContextMenu";c.jaj="PivotTableContextMenu";c.wNh="FloatingObjectContextMenu";c.V6g="CellRTEFloatie";c.Y$f="ShapeRTEFloatie";Object(t.a)(c,
"FloatieGroupIdentifiers",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSOpt.ctxm.js.map/7085b754acaa8d9108d64e1a96abcef4/EwaDSOpt.ctxm.js.map